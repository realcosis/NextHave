<Router AppAssembly="@typeof(Program).Assembly">
    <Found Context="routeData">
        <RouteView RouteData="@routeData" DefaultLayout="@typeof(Layout.MainLayout)" />
    </Found>
</Router>

<BlazoredToasts @rendermode="InteractiveServer" Position="ToastPosition.TopRight"
                ShowProgressBar="true"
                PauseProgressOnHover="true"
                ShowCloseButton="false"
                IconType="IconType.Material"
                SuccessIcon="check_circle"
                ErrorIcon="bug_report"
                WarningIcon="priority_high"
                InfoIcon="info"
                Timeout="10" />

@using Microsoft.AspNetCore.Authentication;
@using System.Security.Claims
@using Microsoft.AspNetCore.Components.Authorization
@using NextHave.Nitro.Authentications

@inject NextHaveAuthenticationStateProvider authenticationStateProvider
@inject NavigationManager navigation

@code {
    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        var authState = await authenticationStateProvider.GetAuthenticationStateAsync();
        var user = authState.User;

        if (user.Identity is { IsAuthenticated: true })
            navigation.NavigateTo("/game/nitro");
        else
            navigation.NavigateTo("/login");
    }
}