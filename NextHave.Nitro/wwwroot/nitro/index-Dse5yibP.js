import{i as xC,B as HE,F as nS,A as fj,a as Qp,C as mj,P as wt,R as Or,S as ms,T as Es,b as Ej,c as kn,s as WE,d as PN,H as pj,M as Ij,e as MC,f as sr,g as UN,h as lo,G as lg,j as Tj,k as Rj,E as Sj,l as Oj,I as Cj,m as Aj,n as Nj,o as xj,p as Mj,q as yj,r as Jp,t as Dj,u as bj,v as Hc,w as _,x as r,y as aS,z as oS,D as vj,J as zr,K as lS,L as No,N as Al,O as Lj,Q as Pj,U as Ts,V as Uj,W as cS,X as jj,Y as jN,Z as Js,_ as wj,$ as Fj,a0 as Gj,a1 as pr,a2 as Ir,a3 as YE,a4 as p_,a5 as wN,a6 as FN,a7 as GN,a8 as Bj,a9 as kj,aa as BN,ab as Vj,ac as Hj,ad as kN,ae as Sc,af as uS,ag as Wj,ah as Yj,ai as hS,aj as $p,ak as zj,al as Kj,am as Xj,an as qj,ao as Qj,ap as dS,aq as _S,ar as Jj,as as $j,at as Zj,au as tw,av as yC,aw as ew,ax as sw,ay as v_,az as L_,aA as P_,aB as iw}from"./vendor-DHw_dofZ.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function e(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(i){if(i.ep)return;i.ep=!0;const n=e(i);fetch(i.href,n)}})();const Ul=class Ul{static log(...t){this.LOG_DEBUG&&console.log(this.logPrefix(),...t)}static warn(...t){this.LOG_WARN&&console.warn(this.logPrefix(),...t)}static error(...t){this.LOG_ERROR&&console.error(this.logPrefix(),...t)}static events(...t){this.LOG_EVENTS&&console.log(this.logPrefix(),...t)}static packets(...t){this.LOG_PACKETS&&console.log(this.logPrefix(),...t)}static logPrefix(){return"[Nitro]"}};Ul.LOG_DEBUG=!1,Ul.LOG_WARN=!1,Ul.LOG_ERROR=!1,Ul.LOG_EVENTS=!1,Ul.LOG_PACKETS=!1;let dt=Ul;class hs{constructor(t=null){if(this._length=0,this._dictionary=new Map,this._array=[],this._keys=[],t)for(const[e,s]of t.entries())this.add(e,s)}get length(){return this._length}get disposed(){return!this._dictionary}dispose(){if(!this._dictionary){for(const t of this._dictionary.keys())this._dictionary.delete(t);this._dictionary=null}this._length=0,this._array=null,this._keys=null}reset(){for(const t of this._dictionary.keys())this._dictionary.delete(t);this._length=0,this._array=[],this._keys=[]}unshift(t,e){return this._dictionary.get(t)!==null?!1:(this._dictionary.set(t,e),this._array.unshift(e),this._keys.unshift(t),this._length++,!0)}add(t,e){return this._dictionary.get(t)!==void 0?!1:(this._dictionary.set(t,e),this._array[this._length]=e,this._keys[this._length]=t,this._length++,!0)}remove(t){const e=this._dictionary.get(t);if(!e)return null;const s=this._array.indexOf(e);return s>=0&&(this._array.splice(s,1),this._keys.splice(s,1),this._length--),this._dictionary.delete(t),e}getWithIndex(t){return t<0||t>=this._length?null:this._array[t]}getKey(t){return t<0||t>=this._length?null:this._keys[t]}getKeys(){return this._keys.slice()}hasKey(t){return this._keys.indexOf(t)>-1}getValue(t){return this._dictionary.get(t)}getValues(){return this._array.slice()}hasValue(t){return this._array.indexOf(t)>-1}indexOf(t){return this._array.indexOf(t)}concatenate(t){for(const e of t._keys)this.add(e,t.getValue(e))}clone(){const t=new hs;return t.concatenate(this),t}}const VN=a=>{let t="";const e=new Uint8Array(a),s=e.byteLength;for(let i=0;i<s;i++)t+=String.fromCharCode(e[i]);return window.btoa(t)};class zE{constructor(t){this._position=0,this._dataView=new DataView(t)}readBytes(t){const e=new zE(this._dataView.buffer.slice(this._position,this._position+t));return this._position+=t,e}readByte(){const t=this._dataView.getInt8(this._position);return this._position++,t}readShort(){const t=this._dataView.getInt16(this._position);return this._position+=2,t}readInt(){const t=this._dataView.getInt32(this._position);return this._position+=4,t}readFloat(){const t=this._dataView.getFloat32(this._position);return this._position+=4,t}readDouble(){const t=this._dataView.getFloat64(this._position);return this._position+=8,t}remaining(){return this._dataView.byteLength-this._position}toString(t){return new TextDecoder().decode(this._dataView.buffer)}toArrayBuffer(){return this._dataView.buffer}}class DC{constructor(){this._buffer=new Uint8Array,this._position=0}writeByte(t){const e=new Uint8Array(1);return e[0]=t,this.appendArray(e),this}writeBytes(t){const e=new Uint8Array(t);return this.appendArray(e),this}writeShort(t){const e=new Uint8Array(2);return e[0]=t>>8,e[1]=t&255,this.appendArray(e),this}writeInt(t){const e=new Uint8Array(4);return e[0]=t>>24,e[1]=t>>16,e[2]=t>>8,e[3]=t&255,this.appendArray(e),this}writeString(t,e=!0){const s=new TextEncoder().encode(t);return e?(this.writeShort(s.length),this.appendArray(s)):this.appendArray(s),this}appendArray(t){if(!t)return;const e=new Uint8Array(this.position+t.length>this._buffer.length?this.position+t.length:this._buffer.length);e.set(this._buffer),e.set(t,this.position),this._buffer=e,this.position+=t.length}getBuffer(){return this._buffer.buffer}get position(){return this._position}set position(t){this._position=t}toString(t){return new TextDecoder(t).decode(this._buffer)}}const jf=class jf{constructor(t){this._jsonFile=null,this._image=null,this._imageData=null,this._baseTexture=null,this.parse(t)}parse(t){const e=new zE(t);let s=e.readShort();for(;s>0;){const i=e.readShort(),n=e.readBytes(i).toString(),o=e.readInt(),l=e.readBytes(o);if(n.endsWith(".json")){const c=xC(l.toArrayBuffer());this._jsonFile=JSON.parse(jf.TEXT_DECODER.decode(c))}else{const c=xC(l.toArrayBuffer()),u=VN(c);this._baseTexture=new HE("data:image/png;base64,"+u)}s--}}get jsonFile(){return this._jsonFile}get baseTexture(){return this._baseTexture}};jf.TEXT_DECODER=new TextDecoder("utf-8");let cg=jf;class HN extends nS{constructor(t){super(`attribute vec2 aVertexPosition;
            attribute vec2 aTextureCoord;
            
            uniform mat3 projectionMatrix;
            
            varying vec2 vTextureCoord;
            
            void main(void)
            {
                gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
                vTextureCoord = aTextureCoord;
            }`,`varying vec2 vTextureCoord;
            uniform sampler2D uSampler;
            
            uniform float gamma;
            uniform float contrast;
            uniform float saturation;
            uniform float brightness;
            uniform float red;
            uniform float green;
            uniform float blue;
            uniform float alpha;
            
            void main(void)
            {
                vec4 c = texture2D(uSampler, vTextureCoord);
            
                if (c.a > 0.0) {
                    c.rgb /= c.a;
            
                    vec3 rgb = pow(c.rgb, vec3(1. / gamma));
                    rgb = mix(vec3(.5), mix(vec3(dot(vec3(.2125, .7154, .0721), rgb)), rgb, saturation), contrast);
                    rgb.r *= red;
                    rgb.g *= green;
                    rgb.b *= blue;
                    c.rgb = rgb * brightness;
            
                    c.rgb *= c.a;
                }
            
                gl_FragColor = c * alpha;
            }`),this.gamma=1,this.saturation=1,this.contrast=1,this.brightness=1,this.red=1,this.green=1,this.blue=1,this.alpha=1,Object.assign(this,t)}apply(t,e,s,i){this.uniforms.gamma=Math.max(this.gamma,1e-4),this.uniforms.saturation=this.saturation,this.uniforms.contrast=this.contrast,this.uniforms.brightness=this.brightness,this.uniforms.red=this.red,this.uniforms.green=this.green,this.uniforms.blue=this.blue,this.uniforms.alpha=this.alpha,t.applyFilter(this,e,s,i)}}const rw=`
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
uniform mat3 projectionMatrix;
varying vec2 vTextureCoord;
void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,nw=`
varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform sampler2D mask;
uniform int fromChannel;
uniform int toChannel;

void main(void) {
    vec4 maskColor = texture2D(mask, vTextureCoord);
    vec4 currentColor = texture2D(uSampler, vTextureCoord);
    vec4 adjusted = currentColor;

    if(maskColor.r == 0.0 && maskColor.g == 0.0 && maskColor.b == 0.0)
    {
        adjusted.a = 0.0;
    }

    gl_FragColor = vec4(adjusted.r, adjusted.g, adjusted.b, adjusted.a);
}`,au=class au extends nS{constructor(t,e,s){super(rw,nw,{mask:t.castToBaseTexture(),fromChannel:e,toChannel:s})}};au.CHANNEL_RED=0,au.CHANNEL_GREEN=1,au.CHANNEL_BLUE=2,au.CHANNEL_ALPHA=3;let bC=au;const Fh=class Fh extends fj{constructor(t){super(t),Fh.INSTANCE||(Fh.INSTANCE=this)}static get instance(){return this.INSTANCE||null}};Fh.INSTANCE=null;let ws=Fh;const fi=()=>{var a;return((a=ws.instance)==null?void 0:a.ticker)||null},aw=()=>{var a;return((a=fi())==null?void 0:a.FPS)||0},Pt=()=>{var a;return((a=fi())==null?void 0:a.lastTime)||0};class ow extends Qp{}class lw extends HE{}class hn extends mj{}class WN extends nS{}class ei extends wt{}class YN extends Or{}class Xe extends ms{}class gS extends Es{}class cw extends Ej{}const uw=`
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
uniform mat3 projectionMatrix;
varying vec2 vTextureCoord;
void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,hw=`
varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform sampler2D lut;
uniform int channel;

void main(void) {
    vec4 currentColor = texture2D(uSampler, vTextureCoord);
    vec4 adjusted = currentColor;

    if(currentColor.a > 0.0)
    {
        if(channel == 0)
        {
            adjusted = texture2D(lut, vec2((currentColor.r * 255.0 + 0.5) / 256.0, 0.5));
        } else if(channel == 1) {
            adjusted = texture2D(lut, vec2((currentColor.g * 255.0 + 0.5) / 256.0, 0.5));
        } else if(channel == 2) {
            adjusted = texture2D(lut, vec2((currentColor.b * 255.0 + 0.5) / 256.0, 0.5));
        } else if(channel == 3) {
            adjusted = texture2D(lut, vec2((currentColor.a * 255.0 + 0.5) / 256.0, 0.5));
        }
    }

    gl_FragColor = vec4(adjusted.r, adjusted.g, adjusted.b, currentColor.a);
}`,Tn=class Tn extends WN{constructor(t,e=Tn.CHANNEL_RED){super(uw,hw),this._channel=e;let s=[];s=this.getLutForPalette(t),this._lut=lw.fromBuffer(Uint8Array.from(s),s.length/4,1,{mipmap:0,scaleMode:0}),this.uniforms.lut=this._lut,this.uniforms.channel=this._channel}getLutForPalette(t){const e=[];for(let s=0;s<t.length;s++)e[s*4+Tn.CHANNEL_RED]=t[s]>>16&255,e[s*4+Tn.CHANNEL_GREEN]=t[s]>>8&255,e[s*4+Tn.CHANNEL_BLUE]=t[s]&255,e[s*4+Tn.CHANNEL_ALPHA]=t[s]>>24&255;return e}get lut(){return this._lut}get channel(){return this._channel}};Tn.CHANNEL_RED=0,Tn.CHANNEL_GREEN=1,Tn.CHANNEL_BLUE=2,Tn.CHANNEL_ALPHA=3;let ug=Tn;const wf=class wf{constructor(){this.RENDER_TEXTURE_POOL=new Map,this.RENDER_TEXTURE_CACHE=[]}clearCache(){this.RENDER_TEXTURE_POOL.forEach(t=>t==null?void 0:t.destroy(!0)),this.RENDER_TEXTURE_POOL.clear(),this.RENDER_TEXTURE_CACHE=[]}clearRenderTexture(t){return t?this.writeToRenderTexture(new ms(Es.EMPTY),t):null}getTextureIdentifier(t,e,s){return`${s??wf.DEFAULT_PLANE_ID}:${t}:${e}`}createRenderTexture(t,e,s=null){if(t<0||e<0)return null;if(!s){const n=kn.create({width:t,height:e});return this.RENDER_TEXTURE_CACHE.push(n),n}s=this.getTextureIdentifier(t,e,s);let i=this.RENDER_TEXTURE_POOL.get(s);return i||(i=kn.create({width:t,height:e}),this.RENDER_TEXTURE_CACHE.push(i),this.RENDER_TEXTURE_POOL.set(s,i)),i}createAndFillRenderTexture(t,e,s=null,i=16777215){if(t<0||e<0)return null;const n=this.createRenderTexture(t,e,s);return this.clearAndFillRenderTexture(n,i)}createAndWriteRenderTexture(t,e,s,i=null,n=null){if(t<0||e<0)return null;const o=this.createRenderTexture(t,e,i);return this.writeToRenderTexture(s,o,!0,n)}clearAndFillRenderTexture(t,e=16777215){if(!t)return null;const s=new ms(Es.WHITE);return s.tint=e,s.width=t.width,s.height=t.height,this.writeToRenderTexture(s,t)}writeToRenderTexture(t,e,s=!0,i=null){return!t||!e?null:(this.getRenderer().render(t,{renderTexture:e,clear:s,transform:i}),e)}getPixels(t,e=null){return this.getExtractor().pixels(t)}getRenderer(){return ws.instance.renderer}getExtractor(){return this.getRenderer().plugins.extract}};wf.DEFAULT_PLANE_ID="DEFAULT";let Zp=wf;class Ee{static generateTexture(t,e=null,s=null,i=1){return t?(s===null&&(s=WE.SCALE_MODE),this.getRenderer().generateTexture(t,{scaleMode:s,resolution:i,region:e})):null}static generateTextureFromImage(t){return t?Es.from(t):null}static generateImage(t){return t?this.getExtractor().image(t):null}static generateImageUrl(t){return t?this.getExtractor().base64(t):null}static generateCanvas(t){return t?this.getExtractor().canvas(t):null}static clearRenderTexture(t){return t?this.writeToRenderTexture(new ms(Es.EMPTY),t):null}static createRenderTexture(t,e){return t<0||e<0?null:kn.create({width:t,height:e})}static createAndFillRenderTexture(t,e,s=16777215){if(t<0||e<0)return null;const i=this.createRenderTexture(t,e);return this.clearAndFillRenderTexture(i,s)}static createAndWriteRenderTexture(t,e,s,i=null){if(t<0||e<0)return null;const n=this.createRenderTexture(t,e);return this.writeToRenderTexture(s,n,!0,i)}static clearAndFillRenderTexture(t,e=16777215){if(!t)return null;const s=new ms(Es.WHITE);return s.tint=e,s.width=t.width,s.height=t.height,this.writeToRenderTexture(s,t)}static writeToRenderTexture(t,e,s=!0,i=null){return!t||!e?null:(this.getRenderer().render(t,{renderTexture:e,clear:s,transform:i}),e)}static getPixels(t,e=null){return this.getExtractor().pixels(t)}static getRenderer(){return ws.instance.renderer}static getExtractor(){return this.getRenderer().plugins.extract}}const jl=class jl{static createAsset(t,e,s,i,n,o=!1,l=!1,c=!1){const u=jl.GRAPHIC_POOL.length?jl.GRAPHIC_POOL.pop():new jl;return u._name=t,u._source=e||null,s?(u._texture=s,u._initialized=!1):(u._texture=null,u._initialized=!0),u._usesPalette=c,u._x=i,u._y=n,u._flipH=o,u._flipV=l,u._rectangle=null,u}recycle(){this._texture=null,jl.GRAPHIC_POOL.push(this)}initialize(){this._initialized||!this._texture||(this._width=this._texture.width,this._height=this._texture.height,this._initialized=!0)}getImageUrl(){return Ee.generateImageUrl(new ms(this._texture))}get name(){return this._name}get source(){return this._source}get texture(){return this._texture}get usesPalette(){return this._usesPalette}get x(){return this._x}get y(){return this._y}get width(){return this.initialize(),this._width}get height(){return this.initialize(),this._height}get offsetX(){return this._flipH?-this._x:this._x}get offsetY(){return this._flipV?-this._y:this._y}get flipH(){return this._flipH}get flipV(){return this._flipV}get rectangle(){return this._rectangle||(this._rectangle=new Or(0,0,this.width,this.height)),this._rectangle}};jl.GRAPHIC_POOL=[];let tI=jl;class dw{constructor(t,e,s){for(this._palette=t;this._palette.length<256;)this._palette.push([0,0,0]);this._primaryColor=e,this._secondaryColor=s}dispose(){}applyPalette(t){var o,l;const e=Ee.createAndWriteRenderTexture(t.width,t.height,new ms(t)),s=Ee.getPixels(e);for(let c=0;c<s.length;c+=4){let u=this._palette[s[c+1]];u===void 0&&(u=[0,0,0]),s[c]=u[0],s[c+1]=u[1],s[c+2]=u[2]}const i=(o=e.baseTexture._glTextures[1])==null?void 0:o.texture,n=(l=ws.instance.renderer)==null?void 0:l.gl;return n.bindTexture(n.TEXTURE_2D,i),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,e.width,e.height,0,n.RGBA,n.UNSIGNED_BYTE,s),n.bindTexture(n.TEXTURE_2D,null),e}get primaryColor(){return this._primaryColor}get secondaryColor(){return this._secondaryColor}}const Gh=class Gh{constructor(t,e){if(!t)throw new Error("invalid_collection");this._name=t.name,this._baseTexture=e&&e.baseTexture||null,this._data=t,this._textures=new Map,this._assets=new Map,this._palettes=new Map,this._paletteAssetNames=[],e&&this.addLibraryAsset(e.textures),this.define(t)}static removeFileExtension(t){return t.substring(0,t.lastIndexOf("."))||t}dispose(){if(this._palettes){for(const t of this._palettes.values())t.dispose();this._palettes.clear()}if(this._paletteAssetNames&&(this.disposePaletteAssets(),this._paletteAssetNames=null),this._assets){for(const t of this._assets.values())t.recycle();this._assets.clear()}}addReference(){this._referenceCount++,this._referenceTimestamp=Pt()}removeReference(){this._referenceCount--,this._referenceCount<=0&&(this._referenceCount=0,this._referenceTimestamp=Pt(),this.disposePaletteAssets(!1))}define(t){const e=t.assets,s=t.palettes;e&&this.defineAssets(e),s&&this.definePalettes(s)}defineAssets(t){if(t)for(const e in t){const s=t[e];if(!s)continue;const i=-s.x||0,n=-s.y||0;let o=!1;const l=!1,c=s.usesPalette||!1;let u=s.source||"";s.flipH&&u.length&&(o=!0),u.length||(u=e);const h=this.getLibraryAsset(u);if(!h)continue;let d=this.createAsset(e,u,h,o,l,i,n,c);if(!d){const g=this.getAsset(e);g&&g.name!==g.source&&(d=this.replaceAsset(e,u,h,o,l,i,n,c))}}}definePalettes(t){if(t)for(const e in t){const s=t[e];if(!s)continue;const i=s.id.toString();if(this._palettes.get(i))continue;let n=16777215,o=16777215,l=s.color1;l&&l.length>0&&(n=parseInt(l,16)),l=s.color2,l&&l.length>0&&(o=parseInt(l,16)),this._palettes.set(i,new dw(s.rgb,n,o))}}createAsset(t,e,s,i,n,o,l,c){if(this._assets.get(t))return!1;const u=tI.createAsset(t,e,s,o,l,i,n,c);return this._assets.set(t,u),!0}replaceAsset(t,e,s,i,n,o,l,c){const u=this._assets.get(t);return u&&(this._assets.delete(t),u.recycle()),this.createAsset(t,e,s,i,n,o,l,c)}getAsset(t){if(!t)return null;const e=this._assets.get(t);return e||null}getAssetWithPalette(t,e){const s=t+"@"+e;let i=this.getAsset(s);if(!i){if(i=this.getAsset(t),!i||!i.usesPalette)return i;const n=this.getPalette(e);if(n){const o=n.applyPalette(i.texture);o&&(this._paletteAssetNames.push(s),this.createAsset(s,i.source+"@"+e,o,i.flipH,i.flipV,i.x,i.y,!1),i=this.getAsset(s))}}return i}getTexture(t){return this._textures.get(t)}getPaletteNames(){return Array.from(this._palettes.keys())}getPaletteColors(t){const e=this.getPalette(t);return e?[e.primaryColor,e.secondaryColor]:null}getPalette(t){if(!t)return null;const e=this._palettes.get(t);return e||null}addAsset(t,e,s,i=0,n=0,o=!1,l=!1){if(!t||!e)return!1;const c=this.getLibraryAsset(t);return c?s?(c.baseTexture=e.baseTexture,c.frame=e.frame,c.trim=e.trim,c.updateUvs(),!0):!1:(this._textures.set(t,e),this.createAsset(t,t,e,o,l,i,n,!1))}disposeAsset(t){const e=this._assets.get(t);if(!e)return;this._assets.delete(t);const s=this.getLibraryAsset(e.source);s&&(this._textures.delete(e.source),s.destroy(!0)),e.recycle()}getLibraryAsset(t){if(!t)return null;t=this._name+"_"+t;const e=this._textures.get(t);return e||null}addLibraryAsset(t){if(t)for(const e in t){const s=t[e];s&&this._textures.set(Gh.removeFileExtension(e),s)}}disposePaletteAssets(t=!0){if(this._paletteAssetNames&&(t||this._paletteAssetNames.length>Gh.PALETTE_ASSET_DISPOSE_THRESHOLD)){for(const e of this._paletteAssetNames)this.disposeAsset(e);this._paletteAssetNames=[]}}get referenceCount(){return this._referenceCount}get referenceTimestamp(){return this._referenceTimestamp}get name(){return this._name}get baseTexture(){return this._baseTexture}get data(){return this._data}get textures(){return this._textures}get assets(){return this._assets}};Gh.PALETTE_ASSET_DISPOSE_THRESHOLD=10;let hg=Gh;const Ff=class Ff{constructor(){this._textures=new Map,this._collections=new Map}getTexture(t){if(!t)return null;const e=this._textures.get(t);return e||null}setTexture(t,e){!t||!e||this._textures.set(t,e)}getAsset(t){if(!t)return null;for(const e of this._collections.values()){if(!e)continue;const s=e.getAsset(t);if(s)return s}return null}getCollection(t){if(!t)return null;const e=this._collections.get(t);return e||null}createCollection(t,e){if(!t)return null;const s=new hg(t,e);if(s){for(const[i,n]of s.textures.entries())this.setTexture(i,n);this._collections.set(s.name,s)}return s}async downloadAsset(t){return await this.downloadAssets([t])}async downloadAssets(t){if(!t||!t.length)return Promise.resolve(!0);try{for(const e of t){const s=await fetch(e);if(s.status!==200)continue;let i="application/octet-stream";switch(s.headers.has("Content-Type")&&(i=s.headers.get("Content-Type")),i){case"application/octet-stream":{const n=await s.arrayBuffer(),o=new cg(n);await this.processAsset(o.baseTexture,o.jsonFile);break}case"image/png":case"image/jpeg":case"image/gif":{const n=await s.arrayBuffer(),o=VN(n),l=HE.from(`data:${i};base64,${o}`),c=async()=>{const u=new Es(l);this.setTexture(e,u)};l.valid?await c():await new Promise((u,h)=>{l.once("update",async()=>(await c(),u()))});break}}}return Promise.resolve(!0)}catch(e){return dt.error(e),Promise.resolve(!1)}}async processAsset(t,e){const s=e.spritesheet;if(!t||!s||!Object.keys(s).length){this.createCollection(e,null);return}const i=async()=>{const n=new PN(t,s);await n.parse(),this.createCollection(e,n)};t.valid?await i():await new Promise((n,o)=>{t.once("update",async()=>(await i(),n()))})}get collections(){return this._collections}};Ff._INSTANCE=new Ff;let eI=Ff;const Rr=()=>eI._INSTANCE;class _w{constructor(t,e,s){this.name=t,this.textures=e,this.durations=s}}const Gf=class Gf{};Gf.UNKNOWN=0,Gf.BROWSER=1;let sI=Gf;const Bh=class Bh{};Bh.UNKNOWN=0,Bh.FLASH=1,Bh.HTML5=2;let iI=Bh;const ou=class ou{};ou.CONNECTION_OPENED="open",ou.CONNECTION_CLOSED="close",ou.CONNECTION_ERROR="error",ou.CONNECTION_MESSAGE="message";let Kn=ou;const kh=class kh{static parseConfiguration(t,e=!1){if(!t)return!1;try{const s=new RegExp(/\${(.*?)}/g);for(const i in t){let n=t[i];typeof n=="string"&&(n=this.interpolate(n,s)),this._definitions.has(i)?e&&this.setValue(i,n):this.setValue(i,n)}return!0}catch(s){return dt.error(s.stack),!1}}static interpolate(t,e=null){e||(e=new RegExp(/\${(.*?)}/g));const s=t.match(e);if(s&&s.length)for(const i of s){const n=this._definitions.get(this.removeInterpolateKey(i));n&&(t=t.replace(i,n))}return t}static removeInterpolateKey(t){return t.replace("${","").replace("}","")}static getValue(t,e=null){let s=this._definitions.get(t);if(s===void 0){if(this._missingKeys.indexOf(t)>=0)return e;this._missingKeys.push(t),dt.warn(`Missing configuration key: ${t}`),s=e}return s}static setValue(t,e){const s=t.split(".");let i=this._config;for(let n=0;n<s.length;n++){const o=s[n].toString();if(n!==s.length-1){i[o]||(i[o]={}),i=i[o];continue}i[o]=e}this._definitions.set(t,e)}static get definitions(){return this._definitions}};kh._definitions=new Map,kh._config={},kh._missingKeys=[];let Dt=kh;const gt=class gt{static getExpressionTimeout(t){switch(t=parseInt(t),t){case 1:return 5e3;case 2:return 1400;case 3:return 2e3;case 4:return 2e3;case 5:return 0;case 6:return 700;case 7:return 2e3;case 8:return 1500;case 9:return 1500;case 10:return 1500;default:return 0}}static getExpressionId(t){return gt.EXPRESSION_MAP.indexOf(t)}static getExpression(t){return t>gt.EXPRESSION_MAP.length?null:gt.EXPRESSION_MAP[t]}static getGestureId(t){return gt.GESTURE_MAP.indexOf(t)}static getGesture(t){return t>gt.GESTURE_MAP.length?null:gt.GESTURE_MAP[t]}static idToAvatarActionState(t){return t==="Lay"?"lay":t==="Float"?"float":t==="Swim"?"swim":t==="Sit"?"sit":t==="Respect"?"respect":t==="Wave"?"wave":t==="Idle"?"idle":t==="Dance"?"dance":t==="UseItem"?"usei":t==="CarryItem"?"cri":t==="Talk"?"talk":t==="Sleep"?"Sleep":t==="Move"?"mv":"std"}};gt.CARRY_OBJECT="cri",gt.DANCE="dance",gt.EFFECT="fx",gt.EXPRESSION="expression",gt.EXPRESSION_BLOW_A_KISS="blow",gt.EXPRESSION_CRY="cry",gt.EXPRESSION_IDLE="idle",gt.EXPRESSION_LAUGH="laugh",gt.EXPRESSION_RESPECT="respect",gt.EXPRESSION_RIDE_JUMP="ridejump",gt.EXPRESSION_SNOWBOARD_OLLIE="sbollie",gt.EXPRESSION_SNOWBORD_360="sb360",gt.EXPRESSION_WAVE="wave",gt.GESTURE="gest",gt.GESTURE_AGGRAVATED="agr",gt.GESTURE_SAD="sad",gt.GESTURE_SMILE="sml",gt.GESTURE_SURPRISED="srp",gt.GUIDE_STATUS="guide",gt.MUTED="muted",gt.PET_GESTURE_BLINK="eyb",gt.PET_GESTURE_CRAZY="crz",gt.PET_GESTURE_JOY="joy",gt.PET_GESTURE_MISERABLE="mis",gt.PET_GESTURE_PUZZLED="puz",gt.PET_GESTURE_TONGUE="tng",gt.PLAYING_GAME="playing_game",gt.POSTURE="posture",gt.POSTURE_FLOAT="float",gt.POSTURE_LAY="lay",gt.POSTURE_SIT="sit",gt.POSTURE_STAND="std",gt.POSTURE_SWIM="swim",gt.POSTURE_WALK="mv",gt.SIGN="sign",gt.SLEEP="sleep",gt.SNOWWAR_DIE_BACK="swdieback",gt.SNOWWAR_DIE_FRONT="swdiefront",gt.SNOWWAR_PICK="swpick",gt.SNOWWAR_RUN="swrun",gt.SNOWWAR_THROW="swthrow",gt.TALK="talk",gt.BLINK="blink",gt.TYPING="typing",gt.USE_OBJECT="usei",gt.VOTE="vote",gt.GESTURE_MAP=["",gt.GESTURE_SMILE,gt.GESTURE_AGGRAVATED,gt.GESTURE_SURPRISED,gt.GESTURE_SAD,gt.PET_GESTURE_JOY,gt.PET_GESTURE_CRAZY,gt.PET_GESTURE_TONGUE,gt.PET_GESTURE_BLINK,gt.PET_GESTURE_MISERABLE,gt.PET_GESTURE_PUZZLED],gt.EXPRESSION_MAP=["",gt.EXPRESSION_WAVE,gt.EXPRESSION_BLOW_A_KISS,gt.EXPRESSION_LAUGH,gt.EXPRESSION_CRY,gt.EXPRESSION_IDLE,gt.DANCE,gt.EXPRESSION_RESPECT,gt.EXPRESSION_SNOWBOARD_OLLIE,gt.EXPRESSION_SNOWBORD_360,gt.EXPRESSION_RIDE_JUMP];let mt=gt;const lu=class lu{};lu.DIRECTION_TO_ANGLE=[45,90,135,180,225,270,315,0],lu.DIRECTION_IS_FLIPPED=[!1,!1,!1,!1,!0,!0,!0,!1],lu.MIN_DIRECTION=0,lu.MAX_DIRECTION=7;let _n=lu;const Ya=class Ya{};Ya.GENERIC="hd",Ya.HEAD="head",Ya.TORSO="torso",Ya.LEGS="legs",Ya.HOTLOOKS="hotlooks",Ya.WARDROBE="wardrobe",Ya.EFFECTS="effects";let Pn=Ya;const cu=class cu{};cu.OWN_AVATAR_EDITOR=0,cu.FURNITURE_AVATAR_EDITOR=1,cu.BOT_EDITOR=2,cu.DEV_TOOL_EDITOR=3;let vC=cu;const ae=class ae{};ae.BODY="bd",ae.SHOES="sh",ae.LEGS="lg",ae.CHEST="ch",ae.WAIST_ACCESSORY="wa",ae.CHEST_ACCESSORY="ca",ae.HEAD="hd",ae.HAIR="hr",ae.FACE_ACCESSORY="fa",ae.EYE_ACCESSORY="ea",ae.HEAD_ACCESSORY="ha",ae.HEAD_ACCESSORY_EXTRA="he",ae.COAT_CHEST="cc",ae.CHEST_PRINT="cp",ae.LEFT_HAND_ITEM="li",ae.LEFT_HAND="lh",ae.LEFT_SLEEVE="ls",ae.RIGHT_HAND="rh",ae.RIGHT_SLEEVE="rs",ae.FACE="fc",ae.EYES="ey",ae.HAIR_BIG="hrb",ae.RIGHT_HAND_ITEM="ri",ae.LEFT_COAT_SLEEVE="lc",ae.RIGHT_COAT_SLEEVE="rc",ae.FIGURE_SETS=[ae.SHOES,ae.LEGS,ae.CHEST,ae.WAIST_ACCESSORY,ae.CHEST_ACCESSORY,ae.HEAD,ae.HAIR,ae.FACE_ACCESSORY,ae.EYE_ACCESSORY,ae.HEAD_ACCESSORY,ae.HEAD_ACCESSORY_EXTRA,ae.COAT_CHEST,ae.CHEST_PRINT];let Kt=ae;const Vh=class Vh{};Vh.NONE=0,Vh.GUIDE=1,Vh.REQUESTER=2;let Ia=Vh;const Bf=class Bf{};Bf.LARGE="h",Bf.SMALL="sh";let kr=Bf;const Hh=class Hh{};Hh.FULL="full",Hh.HEAD="head",Hh.BODY="body";let si=Hh;const wl=class wl{};wl.VERTICAL="vertical",wl.SITTING="sitting",wl.HORIZONTAL="horizontal",wl.SWIM="swim",wl.SNOWWARS_HORIZONTAL="swhorizontal";let Mo=wl;const uu=class uu{};uu.TOOL="tool",uu.COMPONENT="component",uu.ONLINE_TOOL="online_tool",uu.LOCAL_ONLY="local_only";let LC=uu;const Ie=class Ie{};Ie.DOG=0,Ie.CAT=1,Ie.CROCODILE=2,Ie.TERRIER=3,Ie.BEAR=4,Ie.PIG=5,Ie.LION=6,Ie.RHINO=7,Ie.SPIDER=8,Ie.TURTLE=9,Ie.CHICKEN=10,Ie.FROG=11,Ie.DRAGON=12,Ie.MONSTER=13,Ie.MONKEY=14,Ie.HORSE=15,Ie.MONSTERPLANT=16,Ie.BUNNY=17,Ie.BUNNYEVIL=18,Ie.BUNNYDEPRESSED=19,Ie.BUNNYLOVE=20,Ie.PIGEONGOOD=21,Ie.PIGEONEVIL=22,Ie.DEMONMONKEY=23,Ie.BABYBEAR=24,Ie.BABYTERRIER=25,Ie.GNOME=26,Ie.LEPRECHAUN=27,Ie.KITTENBABY=28,Ie.PUPPYBABY=29,Ie.PIGLETNBABY=30,Ie.HALOOMPA=31,Ie.FOOLS=32,Ie.PTEROSAUR=33,Ie.VELOCIRAPTOR=34;let xs=Ie;const bo=class bo{};bo.NONE=0,bo.HEART=1,bo.SMILE=2,bo.BOBBA=3,bo.RELATIONSHIP_TYPES=[0,1,2,3],bo.RELATIONSHIP_NAMES=["None","Heart","Smile","Bobba"];let Tr=bo;const za=class za{};za.HOTEL_VIEW="hotel_view",za.HOME_ROOM="home_room",za.NAVIGATOR="navigator",za.CATALOG="catalog",za.INVENTORY="inventory",za.ME_MENU="me_menu",za.FRIEND_LIST="friendlist";let dg=za;const Fl=class Fl{};Fl.LOVE_LOCK=0,Fl.CARVE_A_TREE=1,Fl.FRIENDS_PORTRAIT=2,Fl.WILD_WEST_WANTED=3,Fl.HABBOWEEN=4;let _g=Fl;const kf=class kf{};kf.CATALOG="catalog",kf.INVENTORY="inventory";let hl=kf;const Q=class Q{};Q.OBJECT_ROOM_ID="object_room_id",Q.OBJECT_ACCURATE_Z_VALUE="object_accurate_z_value",Q.TILE_CURSOR_HEIGHT="tile_cursor_height",Q.FIGURE="figure",Q.GENDER="gender",Q.OWN_USER="own_user",Q.FIGURE_CAN_STAND_UP="figure_can_stand_up",Q.FIGURE_VERTICAL_OFFSET="figure_vertical_offset",Q.FIGURE_TALK="figure_talk",Q.FIGURE_DANCE="figure_dance",Q.FIGURE_SLEEP="figure_sleep",Q.FIGURE_BLINK="figure_blink",Q.FIGURE_EFFECT="figure_effect",Q.FIGURE_CARRY_OBJECT="figure_carry_object",Q.FIGURE_USE_OBJECT="figure_use_object",Q.FIGURE_GESTURE="figure_gesture",Q.FIGURE_POSTURE="figure_posture",Q.FIGURE_POSTURE_PARAMETER="figure_posture_parameter",Q.FIGURE_HIGHLIGHT_ENABLE="figure_highlight_enable",Q.FIGURE_HIGHLIGHT="figure_highlight",Q.FURNITURE_PURCHASER_NAME="furniture_purchaser_name",Q.FURNITURE_PURCHASER_FIGURE="furniture_purchaser_figure",Q.STD="std",Q.FIGURE_SIGN="figure_sign",Q.FIGURE_FLAT_CONTROL="figure_flat_control",Q.FIGURE_IS_TYPING="figure_is_typing",Q.FIGURE_IS_MUTED="figure_is_muted",Q.FIGURE_GAINED_EXPERIENCE="figure_gained_experience",Q.FIGURE_EXPERIENCE_TIMESTAMP="figure_experience_timestamp",Q.FIGURE_NUMBER_VALUE="figure_number_value",Q.FIGURE_IS_PLAYING_GAME="figure_is_playing_game",Q.FIGURE_GUIDE_STATUS="figure_guide_status",Q.FIGURE_EXPRESSION="figure_expression",Q.HEAD_DIRECTION="head_direction",Q.FURNITURE_CUSTOM_VARIABLES="furniture_custom_variables",Q.FURNITURE_AUTOMATIC_STATE_INDEX="furniture_automatic_state_index",Q.FURNITURE_ALWAYS_STACKABLE="furniture_always_stackable",Q.FURNITURE_DISABLE_PICKING_ANIMATION="furniture_disable_picking_animation",Q.FURNITURE_DATA_FORMAT="furniture_data_format",Q.FURNITURE_UNIQUE_SERIAL_NUMBER="furniture_unique_serial_number",Q.FURNITURE_UNIQUE_EDITION_SIZE="furniture_unique_edition_size",Q.FURNITURE_CRACKABLE_STATE="furniture_crackable_state",Q.FURNITURE_CRACKABLE_HITS="furniture_crackable_hits",Q.FURNITURE_CRACKABLE_TARGET="furniture_crackable_target",Q.FURNITURE_CREDIT_VALUE="furniture_credit_value",Q.FURNITURE_DATA="furniture_data",Q.FURNITURE_ITEMDATA="furniture_itemdata",Q.FURNITURE_COLOR="furniture_color",Q.FURNITURE_LIFT_AMOUNT="furniure_lift_amount",Q.FURNITURE_GUILD_CUSTOMIZED_GUILD_ID="furniture_guild_customized_guild_id",Q.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME="furniture_guild_customized_asset_name",Q.FURNITURE_GUILD_CUSTOMIZED_COLOR_1="furniture_guild_customized_color_1",Q.FURNITURE_GUILD_CUSTOMIZED_COLOR_2="furniture_guild_customized_color_2",Q.FURNITURE_STATE_UPDATE_TIME="furniture_state_update_time",Q.FURNITURE_SELECTION_DISABLED="furniture_selection_disabled",Q.FURNITURE_SIZE_X="furniture_size_x",Q.FURNITURE_SIZE_Y="furniture_size_y",Q.FURNITURE_SIZE_Z="furniture_size_z",Q.FURNITURE_CENTER_X="furniture_center_x",Q.FURNITURE_CENTER_Y="furniture_center_y",Q.FURNITURE_CENTER_Z="furniture_center_z",Q.FURNITURE_ALLOWED_DIRECTIONS="furniture_allowed_directions",Q.FURNITURE_AD_URL="furniture_ad_url",Q.FURNITURE_TYPE_ID="furniture_type_id",Q.FURNITURE_EXTRAS="furniture_extras",Q.FURNITURE_EXPIRY_TIME="furniture_expiry_time",Q.FURNITURE_EXPIRTY_TIMESTAMP="furniture_expiry_timestamp",Q.FURNITURE_REAL_ROOM_OBJECT="furniture_real_room_object",Q.FURNITURE_IS_STICKIE="furniture_is_stickie",Q.FURNITURE_BRANDING_IMAGE_STATUS="furniture_branding_image_status",Q.FURNITURE_BRANDING_IMAGE_URL="furniture_branding_image_url",Q.FURNITURE_BRANDING_URL="furniture_branding_url",Q.FURNITURE_BRANDING_OFFSET_X="furniture_branding_offset_x",Q.FURNITURE_BRANDING_OFFSET_Y="furniture_branding_offset_y",Q.FURNITURE_BRANDING_OFFSET_Z="furniture_branding_offset_z",Q.FURNITURE_BRANDING_IS_ANIMATED="furniture_branding_is_animated",Q.FURNITURE_BADGE_IMAGE_STATUS="furniture_badge_image_status",Q.FURNITURE_BADGE_ASSET_NAME="furniture_badge_asset_name",Q.FURNITURE_BADGE_VISIBLE_IN_STATE="furniture_badge_visible_in_state",Q.FURNITURE_ALPHA_MULTIPLIER="furniture_alpha_multiplier",Q.FURNITURE_USAGE_POLICY="furniture_usage_policy",Q.FURNITURE_RARE_VALUE="furniture_rare_value",Q.FURNITURE_VALID_RARE="furniture_valid_rare",Q.FURNITURE_WIN_REASON="furniture_rare_win_reason",Q.FURNITURE_OWNER_ID="furniture_owner_id",Q.FURNITURE_OWNER_NAME="furniture_owner_name",Q.FURNITURE_ROOM_BACKGROUND_COLOR_HUE="furniture_room_background_color_hue",Q.FURNITURE_ROOM_BACKGROUND_COLOR_SATURATION="furniture_room_background_color_saturation",Q.FURNITURE_ROOM_BACKGROUND_COLOR_LIGHTNESS="furniture_room_background_color_lightness",Q.FURNITURE_USES_PLANE_MASK="furniture_uses_plane_mask",Q.FURNITURE_PLANE_MASK_TYPE="furniture_plane_mask_type",Q.FURNITURE_IS_VARIABLE_HEIGHT="furniture_is_variable_height",Q.FURNITURE_VOTE_MAJORITY_RESULT="furniture_vote_majority_result",Q.FURNITURE_VOTE_COUNTER_COUNT="furniture_vote_counter_count",Q.FURNITURE_SOUNDBLOCK_RELATIVE_ANIMATION_SPEED="furniture_soundblock_relative_animation_speed",Q.FURNITURE_MANNEQUIN_NAME="furniture_mannequin_name",Q.FURNITURE_MANNEQUIN_GENDER="furniture_mannequin_gender",Q.FURNITURE_MANNEQUIN_FIGURE="furniture_mannequin_figure",Q.FURNITURE_HIGHSCORE_SCORE_TYPE="furniture_highscore_score_type",Q.FURNITURE_HIGHSCORE_CLEAR_TYPE="furniture_highscore_clear_type",Q.FURNITURE_HIGHSCORE_DATA_ENTRY_COUNT="furniture_highscore_data_entry_count",Q.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_USERS_="furniture_highscore_data_entry_base_users_",Q.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_SCORE_="furniture_highscore_data_entry_base_score_",Q.FURNITURE_INTERNAL_LINK="furniture_internal_link",Q.FURNITURE_CLOTHING_BOY="furniture_clothing_boy",Q.FURNITURE_CLOTHING_GIRL="furniture_clothing_girl",Q.FURNITURE_PLANETSYSTEM_DATA="furniture_planetsystem_data",Q.FURNITURE_FIREWORKS_DATA="furniture_fireworks_data",Q.PET_PALETTE_INDEX="pet_palette_index",Q.PET_COLOR="pet_color",Q.PET_HEAD_ONLY="pet_head_only",Q.PET_CUSTOM_LAYER_IDS="pet_custom_layer_ids",Q.PET_CUSTOM_PARTS_IDS="pet_custom_part_ids",Q.PET_CUSTOM_PALETTE_IDS="pet_custom_palette_ids",Q.PET_IS_RIDING="pet_is_riding",Q.PET_TYPE="pet_type",Q.PET_ALLOWED_DIRECTIONS="pet_allowed_directions",Q.RACE="race",Q.ROOM_MAP_DATA="room_map_data",Q.ROOM_PLANE_MASK_XML="room_plane_mask_xml",Q.ROOM_FLOOR_TYPE="room_floor_type",Q.ROOM_WALL_TYPE="room_wall_type",Q.ROOM_LANDSCAPE_TYPE="room_landscape_type",Q.ROOM_WALL_THICKNESS="room_wall_thickness",Q.ROOM_FLOOR_THICKNESS="room_floor_thickness",Q.ROOM_FLOOR_HOLE_UPDATE_TIME="room_floor_hole_update_time",Q.ROOM_FLOOR_VISIBILITY="room_floor_visibility",Q.ROOM_WALL_VISIBILITY="room_wall_visibility",Q.ROOM_LANDSCAPE_VISIBILITY="room_landscape_visibility",Q.ROOM_DOOR_X="room_door_x",Q.ROOM_DOOR_Y="room_door_y",Q.ROOM_DOOR_Z="room_door_z",Q.ROOM_DOOR_DIR="room_door_dir",Q.ROOM_BACKGROUND_COLOR="room_background_color",Q.ROOM_COLORIZE_BG_ONLY="room_colorize_bg_only",Q.ROOM_RANDOM_SEED="room_random_seed",Q.ROOM_WORLD_TYPE="room_world_type",Q.ROOM_SELECTED_X="room_selected_x",Q.ROOM_SELECTED_Y="room_selected_y",Q.ROOM_SELECTED_Z="room_selected_z",Q.ROOM_SELECTED_PLANE="room_selected_plane",Q.IMAGE_QUERY_SCALE="image_query_scale",Q.FURNITURE_FRIENDFURNI_ENGRAVING="furniture_friendfurni_engraving_type",Q.SESSION_URL_PREFIX="session_url_prefix",Q.SESSION_CURRENT_USER_ID="session_current_user_id";let C=Q;const KO=class KO{};KO.UNIQUE_SET=256;let rI=KO;class fl{constructor(){this._flags=0,this._uniqueNumber=0,this._uniqueSeries=0}parseWrapper(t){(this._flags&rI.UNIQUE_SET)>0&&(this._uniqueNumber=t.readInt(),this._uniqueSeries=t.readInt())}initializeFromRoomObjectModel(t){this._uniqueNumber=t.getValue(C.FURNITURE_UNIQUE_SERIAL_NUMBER),this._uniqueSeries=t.getValue(C.FURNITURE_UNIQUE_EDITION_SIZE)}writeRoomObjectModel(t){t&&(t.setValue(C.FURNITURE_UNIQUE_SERIAL_NUMBER,this._uniqueNumber),t.setValue(C.FURNITURE_UNIQUE_EDITION_SIZE,this._uniqueSeries))}getLegacyString(){return""}compare(t){return!1}get state(){const t=parseInt(this.getLegacyString());return isNaN(t)?0:t}get isUnique(){return this._uniqueSeries>0}get uniqueNumber(){return this._uniqueNumber}set uniqueNumber(t){this._uniqueNumber=t}get uniqueSeries(){return this._uniqueSeries}set uniqueSeries(t){this._uniqueSeries=t}get rarityLevel(){return-1}get flags(){return this._flags}set flags(t){this._flags=t}}const Jn=class Jn{};Jn.LEGACY_KEY=0,Jn.MAP_KEY=1,Jn.STRING_KEY=2,Jn.VOTE_KEY=3,Jn.EMPTY_KEY=4,Jn.NUMBER_KEY=5,Jn.HIGHSCORE_KEY=6,Jn.CRACKABLE_KEY=7;let ba=Jn;const Vf=class Vf extends fl{constructor(){super(),this._state="",this._hits=0,this._target=0}parseWrapper(t){t&&(this._state=t.readString(),this._hits=t.readInt(),this._target=t.readInt(),super.parseWrapper(t))}initializeFromRoomObjectModel(t){super.initializeFromRoomObjectModel(t),this._state=t.getValue(C.FURNITURE_CRACKABLE_STATE),this._hits=t.getValue(C.FURNITURE_CRACKABLE_HITS),this._target=t.getValue(C.FURNITURE_CRACKABLE_TARGET)}writeRoomObjectModel(t){super.writeRoomObjectModel(t),t.setValue(C.FURNITURE_DATA_FORMAT,Vf.FORMAT_KEY),t.setValue(C.FURNITURE_CRACKABLE_STATE,this._state),t.setValue(C.FURNITURE_CRACKABLE_HITS,this._hits),t.setValue(C.FURNITURE_CRACKABLE_TARGET,this._target)}getLegacyString(){return this._state}compare(t){return!0}get hits(){return this._hits}get target(){return this._target}};Vf.FORMAT_KEY=ba.CRACKABLE_KEY;let gg=Vf;const Hf=class Hf extends fl{parseWrapper(t){t&&(this._state="",super.parseWrapper(t))}writeRoomObjectModel(t){super.writeRoomObjectModel(t),t.setValue(C.FURNITURE_DATA_FORMAT,Hf.FORMAT_KEY)}getLegacyString(){return this._state}compare(t){return super.compare(t)}};Hf.FORMAT_KEY=ba.EMPTY_KEY;let fg=Hf;class PC{constructor(){this._score=-1,this._users=[]}get score(){return this._score}set score(t){this._score=t}get users(){return this._users}set users(t){this._users=t}addUsername(t){this._users.push(t)}}const Wf=class Wf extends fl{constructor(){super(),this._state="",this._scoreType=-1,this._clearType=-1,this._entries=[]}parseWrapper(t){if(!t)return;this._state=t.readString(),this._scoreType=t.readInt(),this._clearType=t.readInt();let e=t.readInt();for(;e>0;){const s=new PC;s.score=t.readInt();let i=t.readInt();for(;i>0;)s.addUsername(t.readString()),i--;this._entries.push(s),e--}super.parseWrapper(t)}initializeFromRoomObjectModel(t){this._scoreType=t.getValue(C.FURNITURE_HIGHSCORE_SCORE_TYPE),this._clearType=t.getValue(C.FURNITURE_HIGHSCORE_CLEAR_TYPE),this._entries=[];const e=t.getValue(C.FURNITURE_HIGHSCORE_DATA_ENTRY_COUNT);let s=0;for(;s<e;){const i=new PC;i.score=t.getValue(C.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_SCORE_+s),i.users=t.getValue(C.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_USERS_+s),this._entries.push(i),s++}super.initializeFromRoomObjectModel(t)}writeRoomObjectModel(t){if(super.writeRoomObjectModel(t),t.setValue(C.FURNITURE_DATA_FORMAT,Wf.FORMAT_KEY),t.setValue(C.FURNITURE_HIGHSCORE_SCORE_TYPE,this._scoreType),t.setValue(C.FURNITURE_HIGHSCORE_CLEAR_TYPE,this._clearType),this._entries){t.setValue(C.FURNITURE_HIGHSCORE_DATA_ENTRY_COUNT,this._entries.length);let e=0;for(;e<this._entries.length;){const s=this._entries[e];t.setValue(C.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_SCORE_+e,s.score),t.setValue(C.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_USERS_+e,s.users),e++}}}getLegacyString(){return this._state}get entries(){return this._entries}get clearType(){return this._clearType}get scoreType(){return this._scoreType}};Wf.FORMAT_KEY=ba.HIGHSCORE_KEY;let mg=Wf;const Yf=class Yf extends fl{constructor(){super(),this._data=""}parseWrapper(t){t&&(this._data=t.readString(),super.parseWrapper(t))}initializeFromRoomObjectModel(t){super.initializeFromRoomObjectModel(t),this._data=t.getValue(C.FURNITURE_DATA)}writeRoomObjectModel(t){super.writeRoomObjectModel(t),t.setValue(C.FURNITURE_DATA_FORMAT,Yf.FORMAT_KEY),t.setValue(C.FURNITURE_DATA,this._data)}getLegacyString(){return this._data}compare(t){return this._data===t.getLegacyString()}setString(t){this._data=t}};Yf.FORMAT_KEY=ba.LEGACY_KEY;let wi=Yf;const vo=class vo extends fl{constructor(){super(),this._data={}}parseWrapper(t){if(!t)return;this._data={};const e=t.readInt();if(e)for(let s=0;s<e;s++)this._data[t.readString()]=t.readString();super.parseWrapper(t)}initializeFromRoomObjectModel(t){super.initializeFromRoomObjectModel(t),this._data=t.getValue(C.FURNITURE_DATA)||{}}writeRoomObjectModel(t){super.writeRoomObjectModel(t),t.setValue(C.FURNITURE_DATA_FORMAT,vo.FORMAT_KEY),t.setValue(C.FURNITURE_DATA,this._data)}getLegacyString(){if(!this._data)return"";const t=this._data[vo.STATE];return t??""}compare(t){return!1}getValue(t){return this._data[t]}get rarityLevel(){if(!this._data)return-1;const t=this._data[vo.RARITY];return t==null?-1:parseInt(t)}get data(){return this._data}};vo.FORMAT_KEY=ba.MAP_KEY,vo.STATE="state",vo.RARITY="rarity";let Oc=vo;const Gl=class Gl extends fl{constructor(){super(),this._data=[]}parseWrapper(t){if(!t)return;this._data=[];const e=t.readInt();if(e)for(let s=0;s<e;s++)this._data.push(t.readInt());super.parseWrapper(t)}initializeFromRoomObjectModel(t){super.initializeFromRoomObjectModel(t),this._data=t.getValue(C.FURNITURE_DATA)}writeRoomObjectModel(t){super.writeRoomObjectModel(t),t.setValue(C.FURNITURE_DATA_FORMAT,Gl.FORMAT_KEY),t.setValue(C.FURNITURE_DATA,this._data)}getLegacyString(){return!this._data||!this._data.length?"":this._data[Gl.STATE].toString()}compare(t){if(!(t instanceof Gl))return!1;let e=0;for(;e<this._data.length;){if(e!==0){if(this._data[e]!==t.getValue(e))return!1}e++}return!0}getValue(t){if(!this._data||!this._data.length)return-1;const e=this._data[t];return e??-1}};Gl.FORMAT_KEY=ba.NUMBER_KEY,Gl.STATE=0;let jd=Gl;const Bl=class Bl extends fl{constructor(){super(),this._data=[]}parseWrapper(t){if(!t)return;this._data=[];const e=t.readInt();if(e)for(let s=0;s<e;s++)this._data.push(t.readString());super.parseWrapper(t)}initializeFromRoomObjectModel(t){super.initializeFromRoomObjectModel(t),this._data=t.getValue(C.FURNITURE_DATA)}writeRoomObjectModel(t){super.writeRoomObjectModel(t),t.setValue(C.FURNITURE_DATA_FORMAT,Bl.FORMAT_KEY),t.setValue(C.FURNITURE_DATA,this._data)}getLegacyString(){return!this._data||!this._data.length?"":this._data[Bl.STATE]}compare(t){if(!(t instanceof Bl))return!1;let e=0;for(;e<this._data.length;){if(e!==0){if(this._data[e]!==t.getValue(e))return!1}e++}return!0}getValue(t){return this._data[t]||""}setValue(t){this._data=t}};Bl.FORMAT_KEY=ba.STRING_KEY,Bl.STATE=0;let Vn=Bl;const zf=class zf extends fl{constructor(){super(),this._state="",this._result=0}parseWrapper(t){t&&(this._state=t.readString(),this._result=t.readInt(),super.parseWrapper(t))}writeRoomObjectModel(t){super.writeRoomObjectModel(t),t.setValue(C.FURNITURE_DATA_FORMAT,zf.FORMAT_KEY);const e={};e.S=this._state,e.R=this._result.toString(),t.setValue(C.FURNITURE_DATA,e)}getLegacyString(){return this._state}compare(t){return!0}setString(t){this._state=t}get result(){return this._result}};zf.FORMAT_KEY=ba.VOTE_KEY;let wd=zf;class Aa{static getData(t){let e=null;switch(t&255){case gg.FORMAT_KEY:e=new gg;break;case fg.FORMAT_KEY:e=new fg;break;case mg.FORMAT_KEY:e=new mg;break;case wi.FORMAT_KEY:e=new wi;break;case Oc.FORMAT_KEY:e=new Oc;break;case jd.FORMAT_KEY:e=new jd;break;case Vn.FORMAT_KEY:e=new Vn;break;case wd.FORMAT_KEY:e=new wd;break}return e?(e.flags=t&65280,e):null}}const Lo=class Lo{};Lo.MINIMUM=-2,Lo.ROOM=0,Lo.FLOOR=10,Lo.WALL=20,Lo.UNIT=100,Lo.CURSOR=200;let W=Lo;const Tt=class Tt{};Tt.FURNITURE_BASIC="furniture_basic",Tt.FURNITURE_MULTISTATE="furniture_multistate",Tt.FURNITURE_MULTIHEIGHT="furniture_multiheight",Tt.FURNITURE_RANDOMSTATE="furniture_randomstate",Tt.FURNITURE_PLACEHOLDER="furniture_placeholder",Tt.FURNITURE_CREDIT="furniture_credit",Tt.FURNITURE_STICKIE="furniture_stickie",Tt.FURNITURE_PRESENT="furniture_present",Tt.FURNITURE_TROPHY="furniture_trophy",Tt.FURNITURE_ECOTRON_BOX="furniture_ecotron_box",Tt.FURNITURE_DICE="furniture_dice",Tt.FURNITURE_HOCKEY_SCORE="furniture_hockey_score",Tt.FURNITURE_HABBOWHEEL="furniture_habbowheel",Tt.FURNITURE_ONE_WAY_DOOR="furniture_one_way_door",Tt.FURNITURE_PLANET_SYSTEM="furniture_planet_system",Tt.FURNITURE_WINDOW="furniture_window",Tt.FURNITURE_EXTERNAL_IMAGE_WALLITEM="furniture_external_image_wallitem",Tt.FURNITURE_ROOMDIMMER="furniture_roomdimmer",Tt.FURNITURE_SOUND_MACHINE="furniture_sound_machine",Tt.FURNITURE_JUKEBOX="furniture_jukebox",Tt.FURNITURE_CRACKABLE="furniture_crackable",Tt.FURNITURE_PUSHABLE="furniture_pushable",Tt.FURNITURE_CLOTHING_CHANGE="furniture_clothing_change",Tt.FURNITURE_COUNTER_CLOCK="furniture_counter_clock",Tt.FURNITURE_SCORE="furniture_score",Tt.FURNITURE_ES="furniture_es",Tt.FURNITURE_FIREWORKS="furniture_fireworks",Tt.FURNITURE_SONG_DISK="furniture_song_disk",Tt.FURNITURE_BB="furniture_bb",Tt.FURNITURE_BG="furniture_bg",Tt.FURNITURE_WELCOME_GIFT="furniture_welcome_gift",Tt.FURNITURE_FLOOR_HOLE="furniture_floor_hole",Tt.FURNITURE_MANNEQUIN="furniture_mannequin",Tt.FURNITURE_GUILD_CUSTOMIZED="furniture_guild_customized",Tt.FURNITURE_GROUP_FORUM_TERMINAL="furniture_group_forum_terminal",Tt.FURNITURE_PET_CUSTOMIZATION="furniture_pet_customization",Tt.FURNITURE_CUCKOO_CLOCK="furniture_cuckoo_clock",Tt.FURNITURE_VOTE_COUNTER="furniture_vote_counter",Tt.FURNITURE_VOTE_MAJORITY="furniture_vote_majority",Tt.FURNITURE_SOUNDBLOCK="furniture_soundblock",Tt.FURNITURE_RANDOM_TELEPORT="furniture_random_teleport",Tt.FURNITURE_MONSTERPLANT_SEED="furniture_monsterplant_seed",Tt.FURNITURE_PURCHASABLE_CLOTHING="furniture_purchasable_clothing",Tt.FURNITURE_BACKGROUND_COLOR="furniture_background_color",Tt.FURNITURE_MYSTERYBOX="furniture_mysterybox",Tt.FURNITURE_EFFECTBOX="furniture_effectbox",Tt.FURNITURE_MYSTERYTROPHY="furniture_mysterytrophy",Tt.FURNITURE_ACHIEVEMENT_RESOLUTION="furniture_achievement_resolution",Tt.FURNITURE_LOVELOCK="furniture_lovelock",Tt.FURNITURE_WILDWEST_WANTED="furniture_wildwest_wanted",Tt.FURNITURE_HWEEN_LOVELOCK="furniture_hween_lovelock",Tt.FURNITURE_BADGE_DISPLAY="furniture_badge_display",Tt.FURNITURE_HIGH_SCORE="furniture_high_score",Tt.FURNITURE_INTERNAL_LINK="furniture_internal_link",Tt.FURNITURE_CUSTOM_STACK_HEIGHT="furniture_custom_stack_height",Tt.FURNITURE_YOUTUBE="furniture_youtube",Tt.FURNITURE_RENTABLE_SPACE="furniture_rentable_space",Tt.FURNITURE_CHANGE_STATE_WHEN_STEP_ON="furniture_change_state_when_step_on",Tt.FURNITURE_VIMEO="furniture_vimeo",Tt.FURNITURE_EDITABLE_INTERNAL_LINK="furniture_editable_internal_link",Tt.FURNITURE_EDITABLE_ROOM_LINK="furniture_editable_room_link",Tt.FURNITURE_CRAFTING_GIZMO="furniture_crafting_gizmo",Tt.ROOM="room",Tt.USER="user",Tt.BOT="bot",Tt.RENTABLE_BOT="rentable_bot",Tt.PET="pet",Tt.TILE_CURSOR="tile_cursor",Tt.SELECTION_ARROW="selection_arrow",Tt.GAME_SNOWBALL="game_snowball",Tt.GAME_SNOWSPLASH="game_snowsplash";let Nt=Tt;const or=class or{};or.OBJECT_UNDEFINED="OBJECT_UNDEFINED",or.OBJECT_MOVE="OBJECT_MOVE",or.OBJECT_PLACE="OBJECT_PLACE",or.OBJECT_ROTATE_POSITIVE="OBJECT_ROTATE_POSITIVE",or.OBJECT_ROTATE_NEGATIVE="OBJECT_ROTATE_NEGATIVE",or.OBJECT_MOVE_TO="OBJECT_MOVE_TO",or.OBJECT_PLACE_TO="OBJECT_PLACE_TO",or.OBJECT_PICKUP="OBJECT_PICKUP",or.OBJECT_PICKUP_BOT="OBJECT_PICKUP_BOT",or.OBJECT_PICKUP_PET="OBJECT_PICKUP_PET",or.OBJECT_EJECT="OBJECT_EJECT",or.OBJECT_SAVE_STUFF_DATA="OBJECT_SAVE_STUFF_DATA";let Ft=or;const hu=class hu{};hu.USER=1,hu.PET=2,hu.BOT=3,hu.RENTABLE_BOT=4;let be=hu;const lr=class lr{static getTypeNumber(t){return lr.AVATAR_TYPES[t]}static getTypeString(t){for(const e in lr.AVATAR_TYPES)if(e&&lr.AVATAR_TYPES[e]===t)return e;return null}static getRealType(t){switch(t){case lr.BOT:case lr.RENTABLE_BOT:return lr.USER;default:return t}}};lr.USER="user",lr.PET="pet",lr.BOT="bot",lr.RENTABLE_BOT="rentable_bot",lr.MONSTER_PLANT="monsterplant",lr.AVATAR_TYPES={user:1,pet:2,bot:3,rentable_bot:4};let me=lr;const he=class he{};he.FURNITURE_STATIC="furniture_static",he.FURNITURE_ANIMATED="furniture_animated",he.FURNITURE_RESETTING_ANIMATED="furniture_resetting_animated",he.FURNITURE_POSTER="furniture_poster",he.FURNITURE_EXTERNAL_IMAGE="furniture_external_image",he.FURNITURE_HABBOWHEEL="furniture_habbowheel",he.FURNITURE_VAL_RANDOMIZER="furniture_val_randomizer",he.FURNITURE_BOTTLE="furniture_bottle",he.FURNITURE_PLANET_SYSTEM="furniture_planet_system",he.FURNITURE_QUEUE_TILE="furniture_queue_tile",he.FURNITURE_PARTY_BEAMER="furniture_party_beamer",he.FURNITURE_CUBOID="furniture_cuboid",he.FURNITURE_GIFT_WRAPPED="furniture_gift_wrapped",he.FURNITURE_GIFT_WRAPPED_FIREWORKS="furniture_gift_wrapped_fireworks",he.FURNITURE_COUNTER_CLOCK="furniture_counter_clock",he.FURNITURE_WATER_AREA="furniture_water_area",he.FURNITURE_SCORE_BOARD="furniture_score_board",he.FURNITURE_FIREWORKS="furniture_fireworks",he.FURNITURE_BB="furniture_bb",he.FURNITURE_ISOMETRIC_BB="furniture_isometric_bb",he.FURNITURE_BG="furniture_bg",he.FURNITURE_STICKIE="furniture_stickie",he.FURNITURE_MANNEQUIN="furniture_mannequin",he.FURNITURE_GUILD_CUSTOMIZED="furniture_guild_customized",he.FURNITURE_GUILD_ISOMETRIC_BADGE="furniture_guild_isometric_badge",he.FURNITURE_VOTE_COUNTER="furniture_vote_counter",he.FURNITURE_VOTE_MAJORITY="furniture_vote_majority",he.FURNITURE_SOUNDBLOCK="furniture_soundblock",he.FURNITURE_BADGE_DISPLAY="furniture_badge_display",he.FURNITURE_YOUTUBE="furniture_youtube",he.FURNITURE_BUILDER_PLACEHOLDER="furniture_builder_placeholder",he.ROOM="room",he.USER="user",he.PET_ANIMATED="pet_animated",he.BOT="bot",he.RENTABLE_BOT="rentable_bot",he.TILE_CURSOR="tile_cursor";let ht=he;const Kf=class Kf{constructor(t,e,s,i=null){this._id=t,this._location=e,this._targetLocation=s,this._movementType=i}get id(){return this._id}get location(){return this._location}get targetLocation(){return this._targetLocation}get movementType(){return this._movementType}};Kf.MOVE="mv",Kf.SLIDE="sld";let ao=Kf;const Xf=class Xf{};Xf.KICKED_OUT_OF_ROOM=4008,Xf.STRIP_LOCKED_FOR_TRADING=-13001;let nI=Xf;const Wh=class Wh{};Wh.OLD_IDENTITY=0,Wh.NEW_IDENTITY=1,Wh.REAL_NOOB=2;let xh=Wh;const Po=class Po{};Po.NONE=0,Po.GUEST=1,Po.GUILD_MEMBER=2,Po.GUILD_ADMIN=3,Po.ROOM_OWNER=4,Po.MODERATOR=5;let Oe=Po;const Uo=class Uo{static getLocalizationKey(t){switch(t){case Uo.FREE_TRADING:return"${trading.mode.free}";case Uo.ROOM_CONTROLLER_REQUIRED:return"${trading.mode.controller}";case Uo.NO_TRADING:return"${trading.mode.not.allowed}"}return""}};Uo.NO_TRADING=0,Uo.ROOM_CONTROLLER_REQUIRED=1,Uo.FREE_TRADING=2;let qu=Uo;const Qr=class Qr{};Qr.SUPER_USER=9,Qr.ADMINISTRATOR=8,Qr.COMMUNITY=7,Qr.PLAYER_SUPPORT=6,Qr.MODERATOR=5,Qr.EMPLOYEE=4,Qr.BUS_PARTNER=3,Qr.PARTNER=2,Qr.CELEBRITY=1,Qr.NONE=0;let Cc=Qr;var oc=(a=>(a.FLOOR="S",a.WALL="I",a.EFFECT="E",a.BADGE="B",a.ROBOT="R",a.HABBO_CLUB="H",a.PET="P",a))(oc||{});const Yh=class Yh{};Yh.MATCH_ALL_PIXELS=-1,Yh.MATCH_OPAQUE_PIXELS=128,Yh.MATCH_NOTHING=256;let Fn=Yh;const du=class du{};du.DEFAULT=1,du.ROOM_PLANE=2,du.AVATAR=3,du.AVATAR_OWN=4;let Gr=du;class zN{}class j{constructor(t=0,e=0,s=0){this._x=t,this._y=e,this._z=s,this._length=NaN}static sum(t,e){return!t||!e?null:new j(t.x+e.x,t.y+e.y,t.z+e.z)}static dif(t,e){return!t||!e?null:new j(t.x-e.x,t.y-e.y,t.z-e.z)}static product(t,e){return t?new j(t.x*e,t.y*e,t.z*e):null}static dotProduct(t,e){return!t||!e?0:t.x*e.x+t.y*e.y+t.z*e.z}static crossProduct(t,e){return!t||!e?null:new j(t.y*e.z-t.z*e.y,t.z*e.x-t.x*e.z,t.x*e.y-t.y*e.x)}static scalarProjection(t,e){if(!t||!e)return-1;const s=e.length;return s>0?(t.x*e.x+t.y*e.y+t.z*e.z)/s:-1}static cosAngle(t,e){if(!t||!e)return 0;const s=t.length*e.length;return s?j.dotProduct(t,e)/s:0}static isEqual(t,e){return!(!t||!e||t.x!==e.x||t.y!==e.y||t.z!==e.z)}negate(){this._x=-this._x,this._y=-this._y,this._z=-this._z}add(t){t&&(this._x+=t.x,this._y+=t.y,this._z+=t.z,this._length=NaN)}subtract(t){t&&(this._x-=t.x,this._y-=t.y,this._z-=t.z,this._length=NaN)}multiply(t){this._x*=t,this._y*=t,this._z*=t,this._length=NaN}divide(t){t&&(this._x/=t,this._y/=t,this._z/=t,this._length=NaN)}assign(t){t&&(this._x=t.x,this._y=t.y,this._z=t.z,this._length=NaN)}get x(){return this._x}set x(t){this._x=t,this._length=NaN}get y(){return this._y}set y(t){this._y=t,this._length=NaN}get z(){return this._z}set z(t){this._z=t,this._length=NaN}get length(){return isNaN(this._length)&&(this._length=Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z)),this._length}toString(){return`[Vector3d: ${this._x}, ${this._y}, ${this._z}]`}}const Rn=class Rn{};Rn.MOUSE_CLICK="click",Rn.DOUBLE_CLICK="double_click",Rn.MOUSE_MOVE="mousemove",Rn.MOUSE_DOWN="mousedown",Rn.MOUSE_DOWN_LONG="mousedown_long",Rn.MOUSE_UP="mouseup",Rn.ROLL_OVER="mouseover",Rn.ROLL_OUT="mouseout",Rn.RIGHT_CLICK="contextmenu";let at=Rn;const kl=class kl{};kl.TOUCH_START="touchstart",kl.TOUCH_MOVE="touchmove",kl.TOUCH_CANCEL="touchcancel",kl.TOUCH_END="touchend",kl.TOUCH_LONG="touchlong";let Zi=kl;const ai=class ai{constructor(t){this._ordinal=t}get ordinal(){return this._ordinal}equals(t){return t&&t._ordinal==this._ordinal}};ai.NONE=new ai(0),ai.WAVE=new ai(1),ai.BLOW=new ai(2),ai.LAUGH=new ai(3),ai.CRY=new ai(4),ai.IDLE=new ai(5),ai.JUMP=new ai(6),ai.RESPECT=new ai(7);let cn=ai;const Sn=class Sn{};Sn.DUMMY="DUMMY",Sn.FRIEND_FURNITURE="FRIEND_FURNITURE",Sn.MONSTERPLANT_SEED="MONSTERPLANT_SEED",Sn.MYSTERY_BOX="MYSTERY_BOX",Sn.EFFECT_BOX="EFFECT_BOX",Sn.MYSTERY_TROPHY="MYSTERY_TROPHY",Sn.RANDOM_TELEPORT="RANDOM_TELEPORT",Sn.PURCHASABLE_CLOTHING="PURCHASABLE_CLOTHING",Sn.GENERIC_USABLE="GENERIC_USABLE";let ts=Sn;const Vl=class Vl{};Vl.LOVE_LOCK=0,Vl.CARVE_A_TREE=1,Vl.FRIENDS_PORTRAIT=2,Vl.WILD_WEST_WANTED=3,Vl.HABBOWEEN=4;let UC=Vl;const Lt=class Lt{};Lt.CHAT_WIDGET="RWE_CHAT_WIDGET",Lt.INFOSTAND="RWE_INFOSTAND",Lt.ME_MENU="RWE_ME_MENU",Lt.CHAT_INPUT_WIDGET="RWE_CHAT_INPUT_WIDGET",Lt.FURNI_PLACEHOLDER="RWE_FURNI_PLACEHOLDER",Lt.FURNI_CREDIT_WIDGET="RWE_FURNI_CREDIT_WIDGET",Lt.FURNI_STICKIE_WIDGET="RWE_FURNI_STICKIE_WIDGET",Lt.FURNI_TROPHY_WIDGET="RWE_FURNI_TROPHY_WIDGET",Lt.FURNI_LOVELOCK_WIDGET="RWE_FURNI_LOVELOCK_WIDGET",Lt.FURNI_PRESENT_WIDGET="RWE_FURNI_PRESENT_WIDGET",Lt.FURNI_ECOTRONBOX_WIDGET="RWE_FURNI_ECOTRONBOX_WIDGET",Lt.FURNI_PET_PACKAGE_WIDGET="RWE_FURNI_PET_PACKAGE_WIDGET",Lt.PLAYLIST_EDITOR_WIDGET="RWE_PLAYLIST_EDITOR_WIDGET",Lt.DOORBELL="RWE_DOORBELL",Lt.LOADINGBAR="RWE_LOADINGBAR",Lt.ROOM_QUEUE="RWE_ROOM_QUEUE",Lt.ROOM_POLL="RWE_ROOM_POLL",Lt.ROOM_VOTE="RWE_ROOM_VOTE",Lt.USER_CHOOSER="RWE_USER_CHOOSER",Lt.FURNI_CHOOSER="RWE_FURNI_CHOOSER",Lt.ROOM_DIMMER="RWE_ROOM_DIMMER",Lt.FRIEND_REQUEST="RWE_FRIEND_REQUEST",Lt.CLOTHING_CHANGE="RWE_CLOTHING_CHANGE",Lt.CONVERSION_TRACKING="RWE_CONVERSION_TRACKING",Lt.USER_NOTIFICATION="RWE_USER_NOTIFICATION",Lt.FRIENDS_BAR="RWE_FRIENDS_BAR",Lt.PURSE_WIDGET="RWE_PURSE_WIDGET",Lt.AVATAR_INFO="RWE_AVATAR_INFO",Lt.WELCOME_GIFT="RWE_WELCOME_GIFT",Lt.SPAMWALL_POSTIT_WIDGET="RWE_SPAMWALL_POSTIT_WIDGET",Lt.EFFECTS="RWE_EFFECTS",Lt.MANNEQUIN="RWE_MANNEQUIN",Lt.FURNITURE_CONTEXT_MENU="RWE_FURNITURE_CONTEXT_MENU",Lt.LOCATION_WIDGET="RWE_LOCATION_WIDGET",Lt.CAMERA="RWE_CAMERA",Lt.ROOM_THUMBNAIL_CAMERA="RWE_ROOM_THUMBNAIL_CAMERA",Lt.ROOM_BACKGROUND_COLOR="RWE_ROOM_BACKGROUND_COLOR",Lt.CUSTOM_USER_NOTIFICATION="RWE_CUSTOM_USER_NOTIFICATION",Lt.FURNI_ACHIEVEMENT_RESOLUTION_ENGRAVING="RWE_FURNI_ACHIEVEMENT_RESOLUTION_ENGRAVING",Lt.FRIEND_FURNI_CONFIRM="RWE_FRIEND_FURNI_CONFIRM",Lt.FRIEND_FURNI_ENGRAVING="RWE_FRIEND_FURNI_ENGRAVING",Lt.HIGH_SCORE_DISPLAY="RWE_HIGH_SCORE_DISPLAY",Lt.INTERNAL_LINK="RWE_INTERNAL_LINK",Lt.CUSTOM_STACK_HEIGHT="RWE_CUSTOM_STACK_HEIGHT",Lt.YOUTUBE="RWE_YOUTUBE",Lt.RENTABLESPACE="RWE_RENTABLESPACE",Lt.VIMEO="RWE_VIMEO",Lt.ROOM_TOOLS="RWE_ROOM_TOOLS",Lt.EXTERNAL_IMAGE="RWE_EXTERNAL_IMAGE",Lt.WORD_QUIZZ="RWE_WORD_QUIZZ",Lt.UI_HELP_BUBBLE="RWE_UI_HELP_BUBBLE",Lt.ROOM_LINK="RWE_ROOM_LINK",Lt.CRAFTING="RWE_CRAFTING",Lt.ROOMGAME_CHECKERS="RWE_GAME_CHECKERS";let Fd=Lt;const Ka=class Ka{};Ka.INFOSTAND_EXTRA_PARAM="RWEIEP_INFOSTAND_EXTRA_PARAM",Ka.JUKEBOX="RWEIEP_JUKEBOX",Ka.USABLE_PRODUCT="RWEIEP_USABLE_PRODUCT",Ka.SONGDISK="RWEIEP_SONGDISK",Ka.CRACKABLE_FURNI="RWEIEP_CRACKABLE_FURNI",Ka.BRANDING_OPTIONS="RWEIEP_BRANDING_OPTIONS",Ka.USABLE="RWEIEP_USABLE";let Ms=Ka;const zh=class zh{};zh.NOBODY=0,zh.CONTROLLER=1,zh.EVERYBODY=2;let Eg=zh;const Kh=class Kh{};Kh.NORMAL=0,Kh.GENERIC=1,Kh.BOT=2;let Jo=Kh;class Ar{constructor(){this._isDisposed=!1,this._isDisposing=!1}dispose(){this._isDisposed||this._isDisposing||(this._isDisposing=!0,this.onDispose(),this._isDisposed=!0,this._isDisposing=!1)}onDispose(){}get disposed(){return this._isDisposed}get isDisposing(){return this._isDisposing}}class nr extends Ar{constructor(){super(),this._listeners=new Map}onDispose(){this.removeAllListeners(),super.onDispose()}addEventListener(t,e){if(!t||!e)return;const s=this._listeners.get(t);if(!s){this._listeners.set(t,[e]);return}s.push(e)}removeEventListener(t,e){if(!t||!e)return;const s=this._listeners.get(t);if(!(!s||!s.length)){for(const[i,n]of s.entries())if(!(!n||n!==e)){s.splice(i,1),s.length||this._listeners.delete(t);return}}}dispatchEvent(t){return t?(dt.events("Dispatched Event",t.type),this.processEvent(t),!0):!1}processEvent(t){const e=this._listeners.get(t.type);if(!e||!e.length)return;const s=[];for(const i of e)i&&s.push(i);for(;s.length;){const i=s.shift();try{i(t)}catch(n){dt.error(n.stack);return}}}removeAllListeners(){this._listeners.clear()}}class Fa extends Ar{constructor(){super(),this._events=new nr,this._isLoaded=!1,this._isLoading=!1}init(){this._isLoaded||this._isLoading||this.isDisposing||(this._isLoading=!0,this.onInit(),this._isLoaded=!0,this._isLoading=!1)}onInit(){}onDispose(){this._events&&this._events.dispose(),super.onDispose()}reload(){this.dispose(),this.init()}get events(){return this._events}get isLoaded(){return this._isLoaded}get isLoading(){return this._isLoading}}class gw{constructor(t){this._value=t}get value(){return this._value}}class fw{constructor(t,e){this._header=t,this._buffer=e}readBytes(t){return this._buffer?this._buffer.readBytes(t):null}readByte(){return this._buffer?this._buffer.readByte():-1}readBoolean(){return this.readByte()===1}readShort(){return this._buffer?this._buffer.readShort():-1}readInt(){return this._buffer?this._buffer.readInt():-1}readFloat(){return this._buffer?this._buffer.readFloat():-1}readDouble(){return this._buffer?this._buffer.readDouble():-1}readString(){const t=this.readShort();return this._buffer.readBytes(t).toString("utf8")}get header(){return this._header}get bytesAvailable(){return this._buffer&&this._buffer.remaining()>0}}class mw{constructor(t){this._value=t}get value(){return this._value}}class KN{encode(t,e){const s=new DC;s.writeShort(t);for(const n of e){let o=typeof n;switch(o==="object"&&(n===null?o="null":n instanceof gw?o="byte":n instanceof mw?o="short":n instanceof ArrayBuffer&&(o="arraybuffer")),o){case"undefined":case"null":s.writeShort(0);break;case"byte":s.writeByte(n.value);break;case"short":s.writeShort(n.value);break;case"number":s.writeInt(n);break;case"boolean":s.writeByte(n?1:0);break;case"string":n?s.writeString(n,!0):s.writeShort(0);break;case"arraybuffer":s.writeBytes(n);break}}const i=s.getBuffer();return i?new DC().writeInt(i.byteLength).writeBytes(i):null}decode(t){if(!t||!t.dataBuffer||!t.dataBuffer.byteLength)return null;const e=[];for(;t.dataBuffer.byteLength&&!(t.dataBuffer.byteLength<4);){const s=new zE(t.dataBuffer),i=s.readInt();if(i>t.dataBuffer.byteLength-4)break;const n=s.readBytes(i);e.push(new fw(n.readShort(),n)),t.dataBuffer=t.dataBuffer.slice(i+4)}return e}}class v{constructor(t,e){this._callBack=t,this._parserClass=e,this._parser=null,this._connection=null}dispose(){this._callBack=null,this._parserClass=null,this._parser=null,this._connection=null}get callBack(){return this._callBack}get parserClass(){return this._parserClass}get parser(){return this._parser}set parser(t){this._parser=t}get connection(){return this._connection}set connection(t){this._connection=t}}class kt{constructor(t){this._type=t}get type(){return this._type}}const _u=class _u extends kt{constructor(t,e,s){super(t),this._connection=e,this._originalEvent=event}get connection(){return this._connection}get originalEvent(){return this._originalEvent}};_u.CONNECTION_OPENED="SCE_OPEN",_u.CONNECTION_CLOSED="SCE_CLOSED",_u.CONNECTION_ERROR="SCE_ERROR",_u.CONNECTION_MESSAGE="SCE_MESSAGE";let fs=_u;const XO=class XO extends kt{constructor(t,e){super(t),this._library=e}get library(){return this._library}};XO.DOWNLOAD_COMPLETE="ARELE_DOWNLOAD_COMPLETE";let lc=XO;const qO=class qO{};qO.AVATAR_RENDER_READY="AVATAR_RENDER_READY";let Gd=qO;const QO=class QO extends kt{constructor(t,e){super(t),this._library=e}get library(){return this._library}};QO.DOWNLOAD_COMPLETE="ARLE_DOWNLOAD_COMPLETE";let cc=QO;const JO=class JO extends kt{constructor(t){super(t)}};JO.INITIALIZED="RCWM_INITIALIZED";let Bd=JO;const Xa=class Xa extends kt{constructor(t,e){super(t),this._connection=e}get connection(){return this._connection}};Xa.CONNECTION_ESTABLISHED="NCE_ESTABLISHED",Xa.CONNECTION_CLOSED="NCE_CLOSED",Xa.CONNECTION_ERROR="NCE_ERROR",Xa.CONNECTION_HANDSHAKING="NCE_HANDSHAKING",Xa.CONNECTION_HANDSHAKED="NCE_HANDSHAKED",Xa.CONNECTION_HANDSHAKE_FAILED="NCE_HANDSHAKE_FAILED",Xa.CONNECTION_AUTHENTICATED="NCE_AUTHENTICATED";let Us=Xa;const qf=class qf extends kt{constructor(t){super(t)}};qf.LOADED="NLE_LOADED",qf.FAILED="NLE_FAILED";let $o=qf;const Xh=class Xh extends kt{constructor(){super(Xh.SETTINGS_UPDATED)}clone(){const t=new Xh;return t._volumeSystem=this._volumeSystem,t._volumeFurni=this._volumeFurni,t._volumeTrax=this._volumeTrax,t._volumeSoundboard=this._volumeSoundboard,t._oldChat=this._oldChat,t._roomInvites=this._roomInvites,t._cameraFollow=this._cameraFollow,t._flags=this._flags,t._chatType=this._chatType,t}get volumeSystem(){return this._volumeSystem}set volumeSystem(t){this._volumeSystem=t}get volumeFurni(){return this._volumeFurni}get volumeSoundboard(){return this._volumeSoundboard}set volumeSoundboard(t){this._volumeSoundboard=t}set volumeFurni(t){this._volumeFurni=t}get volumeTrax(){return this._volumeTrax}set volumeTrax(t){this._volumeTrax=t}get oldChat(){return this._oldChat}set oldChat(t){this._oldChat=t}get roomInvites(){return this._roomInvites}set roomInvites(t){this._roomInvites=t}get cameraFollow(){return this._cameraFollow}set cameraFollow(t){this._cameraFollow=t}get flags(){return this._flags}set flags(t){this._flags=t}get chatType(){return this._chatType}set chatType(t){this._chatType=t}};Xh.SETTINGS_UPDATED="NSE_SETTINGS_UPDATED";let il=Xh;const Qf=class Qf extends kt{constructor(t,e){super(t),this._sampleCode=e}get sampleCode(){return this._sampleCode}};Qf.PLAY_SOUND="NSOE_PLAY_SOUND",Qf.PLAY_SOUNDBOARD="BOBBA_PLAY_SOUNDBOARD";let un=Qf;const Jf=class Jf extends kt{constructor(t){super(t)}get iconId(){return this._iconId}set iconId(t){this._iconId=t}get iconName(){return this._iconName}set iconName(t){this._iconName=t}};Jf.TOOLBAR_CLICK="NTE_TOOLBAR_CLICK",Jf.SELECT_OWN_AVATAR="NTE_SELECT_OWN_AVATAR";let aI=Jf;const $f=class $f extends aI{constructor(t,e,s){super($f.ANIMATE_ICON),this._image=t,this._x=e,this._y=s}get image(){return this._image}get x(){return this._x}get y(){return this._y}};$f.ANIMATE_ICON="NTAIE_ANIMATE_ICON";let kd=$f;const qa=class qa extends kt{constructor(t,e){super(t),this._roomId=e}get roomId(){return this._roomId}};qa.INITIALIZED="REE_INITIALIZED",qa.ENGINE_INITIALIZED="REE_ENGINE_INITIALIZED",qa.OBJECTS_INITIALIZED="REE_OBJECTS_INITIALIZED",qa.NORMAL_MODE="REE_NORMAL_MODE",qa.GAME_MODE="REE_GAME_MODE",qa.ROOM_ZOOMED="REE_ROOM_ZOOMED",qa.DISPOSED="REE_DISPOSED";let te=qa;const Zf=class Zf extends te{constructor(t,e,s,i){super(Zf.ROOM_COLOR,t),this._color=e,this._brightness=s,this._bgOnly=i}get color(){return this._color}get brightness(){return this._brightness}get bgOnly(){return this._bgOnly}};Zf.ROOM_COLOR="REE_ROOM_COLOR";let pg=Zf;const qh=class qh extends kt{constructor(t,e){super(t),this._contentType=e}get contentType(){return this._contentType}};qh.RCLE_SUCCESS="RCLE_SUCCESS",qh.RCLE_FAILURE="RCLE_FAILURE",qh.RCLE_CANCEL="RCLE_CANCEL";let co=qh;const tm=class tm extends te{constructor(t,e,s){super(tm.ROOM_DRAG,t),this._offsetX=e,this._offsetY=s}get offsetX(){return this._offsetX}get offsetY(){return this._offsetY}};tm.ROOM_DRAG="RDE_ROOM_DRAG";let Ig=tm;const em=class em extends te{constructor(t,e,s,i,n,o){super(em.ROOM_COLOR,t),this._state=e,this._presetId=s,this._effectId=i,this._color=n,this._brightness=o}get state(){return this._state}get presetId(){return this._presetId}get effectId(){return this._effectId}get color(){return this._color}get brightness(){return this._brightness}};em.ROOM_COLOR="REDSE_ROOM_COLOR";let Tg=em;const Vi=class Vi extends te{constructor(t,e,s,i){super(t,e),this._objectId=s,this._category=i}get objectId(){return this._objectId}get category(){return this._category}};Vi.SELECTED="REOE_SELECTED",Vi.DESELECTED="REOE_DESELECTED",Vi.ADDED="REOE_ADDED",Vi.REMOVED="REOE_REMOVED",Vi.PLACED="REOE_PLACED",Vi.PLACED_ON_USER="REOE_PLACED_ON_USER",Vi.CONTENT_UPDATED="REOE_CONTENT_UPDATED",Vi.REQUEST_MOVE="REOE_REQUEST_MOVE",Vi.REQUEST_ROTATE="REOE_REQUEST_ROTATE",Vi.REQUEST_MANIPULATION="REOE_REQUEST_MANIPULATION",Vi.MOUSE_ENTER="REOE_MOUSE_ENTER",Vi.MOUSE_LEAVE="REOE_MOUSE_LEAVE",Vi.DOUBLE_CLICK="REOE_DOUBLE_CLICK";let Rt=Vi;class oI extends Rt{constructor(t,e,s,i,n,o,l,c,u,h,d,g,E){super(t,e,s,i),this._wallLocation="",this._x=0,this._y=0,this._z=0,this._direction=0,this._placedInRoom=!1,this._placedOnFloor=!1,this._placedOnWall=!1,this._instanceData=null,this._wallLocation=n,this._x=o,this._y=l,this._z=c,this._direction=u,this._placedInRoom=h,this._placedOnFloor=d,this._placedOnWall=g,this._instanceData=E}get wallLocation(){return this._wallLocation}get x(){return this._x}get y(){return this._y}get z(){return this._z}get direction(){return this._direction}get placedInRoom(){return this._placedInRoom}get placedOnFloor(){return this._placedOnFloor}get placedOnWall(){return this._placedOnWall}get instanceData(){return this._instanceData}}class Ew extends Rt{constructor(t,e,s,i,n,o){super(t,e,s,i),this._droppedObjectId=n,this._droppedObjectCategory=o}get droppedObjectId(){return this._droppedObjectId}get droppedObjectCategory(){return this._droppedObjectCategory}}const sm=class sm extends Rt{constructor(t,e,s,i,n,o=1){super(t,e,s,i),this._soundId=n,this._pitch=o}get soundId(){return this._soundId}get pitch(){return this._pitch}};sm.PLAY_SOUND="REOPSE_PLAY_SOUND",sm.PLAY_SOUND_AT_PITCH="REOPSE_PLAY_SOUND_AT_PITCH";let Qc=sm;const gu=class gu extends Rt{};gu.FURNI_CLICK="RERAE_FURNI_CLICK",gu.FURNI_DOUBLE_CLICK="RERAE_FURNI_DOUBLE_CLICK",gu.TOOLTIP_SHOW="RERAE_TOOLTIP_SHOW",gu.TOOLTIP_HIDE="RERAE_TOOLTIP_HIDE";let Na=gu;const fu=class fu extends Rt{constructor(t,e,s,i,n,o=1){super(t,e,s,i),this._sampleId=n,this._pitch=o}get sampleId(){return this._sampleId}get pitch(){return this._pitch}};fu.ROOM_OBJECT_INITIALIZED="ROPSPE_ROOM_OBJECT_INITIALIZED",fu.ROOM_OBJECT_DISPOSED="ROPSPE_ROOM_OBJECT_DISPOSED",fu.PLAY_SAMPLE="ROPSPE_PLAY_SAMPLE",fu.CHANGE_PITCH="ROPSPE_CHANGE_PITCH";let wr=fu;const Re=class Re extends Rt{constructor(t,e,s,i,n=null){super(t,e,s,i),this._widget=n}get widget(){return this._widget}get contextMenu(){return this._widget}};Re.OPEN_WIDGET="RETWE_OPEN_WIDGET",Re.CLOSE_WIDGET="RETWE_CLOSE_WIDGET",Re.OPEN_FURNI_CONTEXT_MENU="RETWE_OPEN_FURNI_CONTEXT_MENU",Re.CLOSE_FURNI_CONTEXT_MENU="RETWE_CLOSE_FURNI_CONTEXT_MENU",Re.REQUEST_PLACEHOLDER="RETWE_REQUEST_PLACEHOLDER",Re.REQUEST_CREDITFURNI="RETWE_REQUEST_CREDITFURNI",Re.REQUEST_STACK_HEIGHT="RETWE_REQUEST_STACK_HEIGHT",Re.REQUEST_EXTERNAL_IMAGE="RETWE_REQUEST_EXTERNAL_IMAGE",Re.REQUEST_STICKIE="RETWE_REQUEST_STICKIE",Re.REQUEST_PRESENT="RETWE_REQUEST_PRESENT",Re.REQUEST_TROPHY="RETWE_REQUEST_TROPHY",Re.REQUEST_TEASER="RETWE_REQUEST_TEASER",Re.REQUEST_ECOTRONBOX="RETWE_REQUEST_ECOTRONBOX",Re.REQUEST_DIMMER="RETWE_REQUEST_DIMMER",Re.REMOVE_DIMMER="RETWE_REMOVE_DIMMER",Re.REQUEST_CLOTHING_CHANGE="RETWE_REQUEST_CLOTHING_CHANGE",Re.REQUEST_PLAYLIST_EDITOR="RETWE_REQUEST_PLAYLIST_EDITOR",Re.REQUEST_MANNEQUIN="RETWE_REQUEST_MANNEQUIN",Re.REQUEST_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG="ROWRE_REQUEST_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG",Re.REQUEST_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG="ROWRE_REQUEST_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG",Re.REQUEST_BACKGROUND_COLOR="RETWE_REQUEST_BACKGROUND_COLOR",Re.REQUEST_MYSTERYBOX_OPEN_DIALOG="RETWE_REQUEST_MYSTERYBOX_OPEN_DIALOG",Re.REQUEST_EFFECTBOX_OPEN_DIALOG="RETWE_REQUEST_EFFECTBOX_OPEN_DIALOG",Re.REQUEST_MYSTERYTROPHY_OPEN_DIALOG="RETWE_REQUEST_MYSTERYTROPHY_OPEN_DIALOG",Re.REQUEST_ACHIEVEMENT_RESOLUTION_ENGRAVING="RETWE_REQUEST_ACHIEVEMENT_RESOLUTION_ENGRAVING",Re.REQUEST_ACHIEVEMENT_RESOLUTION_FAILED="RETWE_REQUEST_ACHIEVEMENT_RESOLUTION_FAILED",Re.REQUEST_FRIEND_FURNITURE_CONFIRM="RETWE_REQUEST_FRIEND_FURNITURE_CONFIRM",Re.REQUEST_FRIEND_FURNITURE_ENGRAVING="RETWE_REQUEST_FRIEND_FURNITURE_ENGRAVING",Re.REQUEST_BADGE_DISPLAY_ENGRAVING="RETWE_REQUEST_BADGE_DISPLAY_ENGRAVING",Re.REQUEST_HIGH_SCORE_DISPLAY="RETWE_REQUEST_HIGH_SCORE_DISPLAY",Re.REQUEST_HIDE_HIGH_SCORE_DISPLAY="RETWE_REQUEST_HIDE_HIGH_SCORE_DISPLAY",Re.REQUEST_INTERNAL_LINK="RETWE_REQUEST_INTERNAL_LINK",Re.REQUEST_ROOM_LINK="RETWE_REQUEST_ROOM_LINK",Re.REQUEST_YOUTUBE="RETWE_REQUEST_YOUTUBE";let nt=Re;const im=class im extends Rt{constructor(t,e,s,i,n=-1,o=-1){super(t,e,s,i),this._inventoryStripId=n,this._furnitureTypeId=o}get inventoryStripId(){return this._inventoryStripId}get furnitureTypeId(){return this._furnitureTypeId}};im.USE_PRODUCT_FROM_ROOM="REUPE_USE_PRODUCT_FROM_ROOM",im.USE_PRODUCT_FROM_INVENTORY="REUPE_USE_PRODUCT_FROM_INVENTORY";let sh=im;class mn extends kt{constructor(t,e){super(t),this._object=e}get object(){return this._object}get objectId(){return this._object?this._object.id:-1}get objectType(){return this._object?this._object.type:null}}const $O=class $O extends mn{constructor(t,e,s,i=!0){super(t,e),this._badgeId=s,this._groupBadge=i}get badgeId(){return this._badgeId}get groupBadge(){return this._groupBadge}};$O.LOAD_BADGE="ROBAE_LOAD_BADGE";let Gn=$O;const rm=class rm extends mn{constructor(t,e){super(t,e)}};rm.RODRE_CURRENT_USER_ID="RODRE_CURRENT_USER_ID",rm.RODRE_URL_PREFIX="RODRE_URL_PREFIX";let gn=rm;const nm=class nm extends mn{constructor(t,e,s,i,n,o){super(nm.DIMMER_STATE,t),this._state=e,this._presetId=s,this._effectId=i,this._color=n,this._brightness=o}get state(){return this._state}get presetId(){return this._presetId}get effectId(){return this._effectId}get color(){return this._color}get brightness(){return this._brightness}};nm.DIMMER_STATE="RODSUE_DIMMER_STATE";let mc=nm;const am=class am extends mn{constructor(t,e){super(t,e)}};am.ADD_HOLE="ROFHO_ADD_HOLE",am.REMOVE_HOLE="ROFHO_REMOVE_HOLE";let Mi=am;const pi=class pi extends mn{};pi.DICE_OFF="ROFCAE_DICE_OFF",pi.DICE_ACTIVATE="ROFCAE_DICE_ACTIVATE",pi.USE_HABBOWHEEL="ROFCAE_USE_HABBOWHEEL",pi.STICKIE="ROFCAE_STICKIE",pi.ENTER_ONEWAYDOOR="ROFCAE_ENTER_ONEWAYDOOR",pi.SOUND_MACHINE_INIT="ROFCAE_SOUND_MACHINE_INIT",pi.SOUND_MACHINE_START="ROFCAE_SOUND_MACHINE_START",pi.SOUND_MACHINE_STOP="ROFCAE_SOUND_MACHINE_STOP",pi.SOUND_MACHINE_DISPOSE="ROFCAE_SOUND_MACHINE_DISPOSE",pi.JUKEBOX_INIT="ROFCAE_JUKEBOX_INIT",pi.JUKEBOX_START="ROFCAE_JUKEBOX_START",pi.JUKEBOX_MACHINE_STOP="ROFCAE_JUKEBOX_MACHINE_STOP",pi.JUKEBOX_DISPOSE="ROFCAE_JUKEBOX_DISPOSE",pi.MOUSE_BUTTON="ROFCAE_MOUSE_BUTTON",pi.MOUSE_ARROW="ROFCAE_MOUSE_ARROW";let lt=pi;const ZO=class ZO extends te{constructor(t,e,s,i,n,o){super(t,e),this._enable=s,this._hue=i,this._saturation=n,this._lightness=o}get enable(){return this._enable}get hue(){return this._hue}get saturation(){return this._saturation}get lightness(){return this._lightness}};ZO.ROOM_BACKGROUND_COLOR="ROHSLCEE_ROOM_BACKGROUND_COLOR";let Vd=ZO;const tC=class tC extends mn{constructor(t,e,s,i,n,o){super(t,e),this._enable=s,this._hue=i,this._saturation=n,this._lightness=o}get enable(){return this._enable}get hue(){return this._hue}get saturation(){return this._saturation}get lightness(){return this._lightness}};tC.ROOM_BACKGROUND_COLOR="ROHSLCEE_ROOM_BACKGROUND_COLOR";let oo=tC;const $n=class $n extends mn{constructor(t,e,s,i=!1,n=!1,o=!1,l=!1){super(t,e),this._eventId="",this._eventId=s,this._altKey=i,this._ctrlKey=n,this._shiftKey=o,this._buttonDown=l}get eventId(){return this._eventId}get altKey(){return this._altKey}get ctrlKey(){return this._ctrlKey}get shiftKey(){return this._shiftKey}get buttonDown(){return this._buttonDown}get localX(){return this._localX}set localX(t){this._localX=t}get localY(){return this._localY}set localY(t){this._localY=t}get spriteOffsetX(){return this._spriteOffsetX}set spriteOffsetX(t){this._spriteOffsetX=t}get spriteOffsetY(){return this._spriteOffsetY}set spriteOffsetY(t){this._spriteOffsetY=t}};$n.CLICK="ROE_MOUSE_CLICK",$n.DOUBLE_CLICK="ROE_MOUSE_DOUBLE_CLICK",$n.MOUSE_MOVE="ROE_MOUSE_MOVE",$n.MOUSE_DOWN="ROE_MOUSE_DOWN",$n.MOUSE_DOWN_LONG="ROE_MOUSE_DOWN_LONG",$n.MOUSE_UP="ROE_MOUSE_UP",$n.MOUSE_ENTER="ROE_MOUSE_ENTER",$n.MOUSE_LEAVE="ROE_MOUSE_LEAVE";let Gt=$n;const om=class om extends mn{constructor(t,e){super(t,e)}};om.POSITION_CHANGED="ROME_POSITION_CHANGED",om.OBJECT_REMOVED="ROME_OBJECT_REMOVED";let Ui=om;const lm=class lm extends lt{constructor(t,e,s,i=1){super(t,e),this._soundId=s,this._pitch=i}get soundId(){return this._soundId}get pitch(){return this._pitch}};lm.PLAY_SOUND="ROPSIE_PLAY_SOUND",lm.PLAY_SOUND_AT_PITCH="ROPSIE_PLAY_SOUND_AT_PITCH";let uo=lm;const Hl=class Hl extends mn{constructor(t,e,s="",i=""){super(t,e),this._imageUrl="",this._clickUrl="",this._imageUrl=s,this._clickUrl=i}get imageUrl(){return this._imageUrl}get clickUrl(){return this._clickUrl}};Hl.ROOM_AD_LOAD_IMAGE="RORAE_ROOM_AD_LOAD_IMAGE",Hl.ROOM_AD_FURNI_CLICK="RORAE_ROOM_AD_FURNI_CLICK",Hl.ROOM_AD_FURNI_DOUBLE_CLICK="RORAE_ROOM_AD_FURNI_DOUBLE_CLICK",Hl.ROOM_AD_TOOLTIP_SHOW="RORAE_ROOM_AD_TOOLTIP_SHOW",Hl.ROOM_AD_TOOLTIP_HIDE="RORAE_ROOM_AD_TOOLTIP_HIDE";let Ze=Hl;const mu=class mu extends mn{constructor(t,e,s,i=1){super(t,e),this._sampleId=s,this._pitch=i}get sampleId(){return this._sampleId}get pitch(){return this._pitch}};mu.ROOM_OBJECT_INITIALIZED="ROPSPE_ROOM_OBJECT_INITIALIZED",mu.ROOM_OBJECT_DISPOSED="ROPSPE_ROOM_OBJECT_DISPOSED",mu.PLAY_SAMPLE="ROPSPE_PLAY_SAMPLE",mu.CHANGE_PITCH="ROPSPE_CHANGE_PITCH";let vs=mu;const Zn=class Zn extends Rt{};Zn.SOUND_MACHINE_INIT="ROSM_SOUND_MACHINE_INIT",Zn.SOUND_MACHINE_SWITCHED_ON="ROSM_SOUND_MACHINE_SWITCHED_ON",Zn.SOUND_MACHINE_SWITCHED_OFF="ROSM_SOUND_MACHINE_SWITCHED_OFF",Zn.SOUND_MACHINE_DISPOSE="ROSM_SOUND_MACHINE_DISPOSE",Zn.JUKEBOX_INIT="ROSM_JUKEBOX_INIT",Zn.JUKEBOX_SWITCHED_ON="ROSM_JUKEBOX_SWITCHED_ON",Zn.JUKEBOX_SWITCHED_OFF="ROSM_JUKEBOX_SWITCHED_OFF",Zn.JUKEBOX_DISPOSE="ROSM_JUKEBOX_DISPOSE";let us=Zn;const cm=class cm extends mn{constructor(t,e,s=0){super(t,e),this._state=s}get state(){return this._state}};cm.STATE_CHANGE="ROSCE_STATE_CHANGE",cm.STATE_RANDOM="ROSCE_STATE_RANDOM";let _e=cm;class Ha extends Gt{constructor(t,e,s,i,n,o,l=!1,c=!1,u=!1,h=!1){super(t,e,s,l,c,u,h),this._tileX=i,this._tileY=n,this._tileZ=o}get tileX(){return this._tileX}get tileY(){return this._tileY}get tileZ(){return this._tileZ}get tileXAsInt(){return Math.trunc(this._tileX+.499)}get tileYAsInt(){return Math.trunc(this._tileY+.499)}get tileZAsInt(){return Math.trunc(this._tileZ+.499)}}class Xc extends Gt{constructor(t,e,s,i,n,o,l,c,u,h=!1,d=!1,g=!1,E=!1){super(t,e,s,h,d,g,E),this._wallLocation=new j,this._wallWd=new j,this._wallHt=new j,this._wallLocation.assign(i),this._wallWd.assign(n),this._wallHt.assign(o),this._x=l,this._y=c,this._direction=u}get wallLocation(){return this._wallLocation}get wallWidth(){return this._wallWd}get wallHeight(){return this._wallHt}get x(){return this._x}get y(){return this._y}get direction(){return this._direction}}const de=class de extends mn{constructor(t,e){super(t,e)}};de.OPEN_WIDGET="ROWRE_OPEN_WIDGET",de.CLOSE_WIDGET="ROWRE_CLOSE_WIDGET",de.OPEN_FURNI_CONTEXT_MENU="ROWRE_OPEN_FURNI_CONTEXT_MENU",de.CLOSE_FURNI_CONTEXT_MENU="ROWRE_CLOSE_FURNI_CONTEXT_MENU",de.PLACEHOLDER="ROWRE_PLACEHOLDER",de.CREDITFURNI="ROWRE_CREDITFURNI",de.STACK_HEIGHT="ROWRE_STACK_HEIGHT",de.EXTERNAL_IMAGE="ROWRE_EXTERNAL_IMAGE",de.STICKIE="ROWRE_STICKIE",de.PRESENT="ROWRE_PRESENT",de.TROPHY="ROWRE_TROPHY",de.TEASER="ROWRE_TEASER",de.ECOTRONBOX="ROWRE_ECOTRONBOX",de.DIMMER="ROWRE_DIMMER",de.WIDGET_REMOVE_DIMMER="ROWRE_WIDGET_REMOVE_DIMMER",de.CLOTHING_CHANGE="ROWRE_CLOTHING_CHANGE",de.JUKEBOX_PLAYLIST_EDITOR="ROWRE_JUKEBOX_PLAYLIST_EDITOR",de.MANNEQUIN="ROWRE_MANNEQUIN",de.PET_PRODUCT_MENU="ROWRE_PET_PRODUCT_MENU",de.GUILD_FURNI_CONTEXT_MENU="ROWRE_GUILD_FURNI_CONTEXT_MENU",de.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG="ROWRE_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG",de.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG="ROWRE_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG",de.BACKGROUND_COLOR="ROWRE_BACKGROUND_COLOR",de.MYSTERYBOX_OPEN_DIALOG="ROWRE_MYSTERYBOX_OPEN_DIALOG",de.EFFECTBOX_OPEN_DIALOG="ROWRE_EFFECTBOX_OPEN_DIALOG",de.MYSTERYTROPHY_OPEN_DIALOG="ROWRE_MYSTERYTROPHY_OPEN_DIALOG",de.ACHIEVEMENT_RESOLUTION_OPEN="ROWRE_ACHIEVEMENT_RESOLUTION_OPEN",de.ACHIEVEMENT_RESOLUTION_ENGRAVING="ROWRE_ACHIEVEMENT_RESOLUTION_ENGRAVING",de.ACHIEVEMENT_RESOLUTION_FAILED="ROWRE_ACHIEVEMENT_RESOLUTION_FAILED",de.FRIEND_FURNITURE_CONFIRM="ROWRE_FRIEND_FURNITURE_CONFIRM",de.FRIEND_FURNITURE_ENGRAVING="ROWRE_FRIEND_FURNITURE_ENGRAVING",de.BADGE_DISPLAY_ENGRAVING="ROWRE_BADGE_DISPLAY_ENGRAVING",de.HIGH_SCORE_DISPLAY="ROWRE_HIGH_SCORE_DISPLAY",de.HIDE_HIGH_SCORE_DISPLAY="ROWRE_HIDE_HIGH_SCORE_DISPLAY",de.INERNAL_LINK="ROWRE_INTERNAL_LINK",de.ROOM_LINK="ROWRE_ROOM_LINK",de.YOUTUBE="ROWRE_YOUTUBE";let X=de;class pw{constructor(t,e,s,i,n,o,l=0,c=0,u=!1,h=!1,d=!1,g=!1){this._type=t,this._eventId=e,this._canvasId=s,this._spriteTag=i,this._screenX=n,this._screenY=o,this._localX=l,this._localY=c,this._ctrlKey=u,this._altKey=h,this._shiftKey=d,this._buttonDown=g,this._spriteOffsetX=0,this._spriteOffsetY=0}get type(){return this._type}get eventId(){return this._eventId}get canvasId(){return this._canvasId}get spriteTag(){return this._spriteTag}get screenX(){return this._screenX}get screenY(){return this._screenY}get localX(){return this._localX}get localY(){return this._localY}get ctrlKey(){return this._ctrlKey}get altKey(){return this._altKey}get shiftKey(){return this._shiftKey}get buttonDown(){return this._buttonDown}get spriteOffsetX(){return this._spriteOffsetX}set spriteOffsetX(t){this._spriteOffsetX=t}get spriteOffsetY(){return this._spriteOffsetY}set spriteOffsetY(t){this._spriteOffsetY=t}}class Iw extends kt{constructor(t){super(t)}}const eC=class eC extends Iw{constructor(t,e){super(t),this._targetLocation=e}get targetLocation(){return this._targetLocation}};eC.ROAME_MOVE_TO="ROAME_MOVE_TO";let ih=eC;const um=class um extends te{constructor(t,e,s=!1,i=!1){super(um.ROOM_ZOOM,t),this._level=e,this._forceFlip=s,this._asDelta=i}get level(){return this._level}get forceFlip(){return this._forceFlip}get asDelta(){return this._asDelta}};um.ROOM_ZOOM="REE_ROOM_ZOOM";let Ac=um;const hm=class hm extends kt{constructor(t,e){super(hm.IMAGE_READY),this._badgeId=t,this._image=e}get badgeId(){return this._badgeId}get image(){return this._image}};hm.IMAGE_READY="BIME_BADGE_IMAGE_READY";let Eo=hm;const dm=class dm extends kt{constructor(t,e){super(dm.MYSTERY_BOX_KEYS_UPDATE),this._boxColor=t,this._keyColor=e}get boxColor(){return this._boxColor}get keyColor(){return this._keyColor}};dm.MYSTERY_BOX_KEYS_UPDATE="mbke_update";let Rg=dm;const _m=class _m extends kt{constructor(){super(_m.PERKS_UPDATED)}};_m.PERKS_UPDATED="PUE_perks_updated";let jC=_m;const Eu=class Eu extends kt{constructor(t,e,s=!0){super(t),this._session=e,this._openLandingView=s}get session(){return this._session}get openLandingView(){return this._openLandingView}};Eu.CREATED="RSE_CREATED",Eu.STARTED="RSE_STARTED",Eu.ENDED="RSE_ENDED",Eu.ROOM_DATA="RSE_ROOM_DATA";let Mt=Eu;const Hi=class Hi extends Mt{constructor(t,e,s,i,n,o=0,l=null,c=-1){super(t,e),this._objectId=s,this._message=i,this._chatType=n,this._links=l,this._extraParam=c,this._style=o}get objectId(){return this._objectId}get message(){return this._message}get chatType(){return this._chatType}get links(){return this._links}get extraParam(){return this._extraParam}get style(){return this._style}};Hi.CHAT_EVENT="RSCE_CHAT_EVENT",Hi.FLOOD_EVENT="RSCE_FLOOD_EVENT",Hi.CHAT_TYPE_SPEAK=0,Hi.CHAT_TYPE_WHISPER=1,Hi.CHAT_TYPE_SHOUT=2,Hi.CHAT_TYPE_RESPECT=3,Hi.CHAT_TYPE_PETRESPECT=4,Hi.CHAT_TYPE_HAND_ITEM_RECEIVED=5,Hi.CHAT_TYPE_PETTREAT=6,Hi.CHAT_TYPE_PETREVIVE=7,Hi.CHAT_TYPE_PET_REBREED_FERTILIZE=8,Hi.CHAT_TYPE_PET_SPEED_FERTILIZE=9,Hi.CHAT_TYPE_MUTE_REMAINING=10;let ue=Hi;const gm=class gm extends Mt{constructor(t,e,s,i,n,o){super(gm.CONFIRM_PET_BREEDING,t),this._nestId=e,this._pet1=s,this._pet2=i,this._rarityCategories=n,this._resultPetTypeId=o}get nestId(){return this._nestId}get pet1(){return this._pet1}get pet2(){return this._pet2}get rarityCategories(){return this._rarityCategories}get resultPetTypeId(){return this._resultPetTypeId}};gm.CONFIRM_PET_BREEDING="RSPFUE_CONFIRM_PET_BREEDING";let lI=gm;const fm=class fm extends Mt{constructor(t,e,s){super(fm.RSPFUE_CONFIRM_PET_BREEDING_RESULT,t),this._breedingNestStuffId=e,this._result=s}get breedingNestStuffId(){return this._breedingNestStuffId}get result(){return this._result}};fm.RSPFUE_CONFIRM_PET_BREEDING_RESULT="RSPFUE_CONFIRM_PET_BREEDING_RESULT";let cI=fm;const mm=class mm extends Mt{constructor(t,e,s){super(mm.RSDE_DANCE,t),this._roomIndex=e,this._danceId=s}get roomIndex(){return this._roomIndex}get danceId(){return this._danceId}};mm.RSDE_DANCE="RSDE_DANCE";let Sg=mm;class Tw{constructor(t,e,s,i){this._id=t,this._type=e,this._color=s,this._brightness=i}get id(){return this._id}get type(){return this._type}get color(){return this._color}get brightness(){return this._brightness}}const sC=class sC extends Mt{constructor(t,e){super(t,e),this._selectedPresetId=0,this._presets=[]}storePreset(t,e,s,i){this._presets[t-1]=new Tw(t,e,s,i)}getPreset(t){return t<0||t>=this._presets.length?null:this._presets[t]}get presetCount(){return this._presets.length}get selectedPresetId(){return this._selectedPresetId}set selectedPresetId(t){this._selectedPresetId=t}};sC.ROOM_DIMMER_PRESETS="RSDPE_PRESETS";let Hd=sC;const Qh=class Qh extends Mt{constructor(t,e,s){super(t,e),this._userName="",this._userName=s}get userName(){return this._userName}};Qh.DOORBELL="RSDE_DOORBELL",Qh.RSDE_REJECTED="RSDE_REJECTED",Qh.RSDE_ACCEPTED="RSDE_ACCEPTED";let jn=Qh;const cr=class cr extends Mt{constructor(t,e,s=null){super(t,e),this._message=s}get message(){return this._message}};cr.RSEME_KICKED="RSEME_KICKED",cr.RSEME_PETS_FORBIDDEN_IN_HOTEL="RSEME_PETS_FORBIDDEN_IN_HOTEL",cr.RSEME_PETS_FORBIDDEN_IN_FLAT="RSEME_PETS_FORBIDDEN_IN_FLAT",cr.RSEME_MAX_PETS="RSEME_MAX_PETS",cr.RSEME_MAX_NUMBER_OF_OWN_PETS="RSEME_MAX_NUMBER_OF_OWN_PETS",cr.RSEME_NO_FREE_TILES_FOR_PET="RSEME_NO_FREE_TILES_FOR_PET",cr.RSEME_SELECTED_TILE_NOT_FREE_FOR_PET="RSEME_SELECTED_TILE_NOT_FREE_FOR_PET",cr.RSEME_BOTS_FORBIDDEN_IN_HOTEL="RSEME_BOTS_FORBIDDEN_IN_HOTEL",cr.RSEME_BOTS_FORBIDDEN_IN_FLAT="RSEME_BOTS_FORBIDDEN_IN_FLAT",cr.RSEME_BOT_LIMIT_REACHED="RSEME_BOT_LIMIT_REACHED",cr.RSEME_SELECTED_TILE_NOT_FREE_FOR_BOT="RSEME_SELECTED_TILE_NOT_FREE_FOR_BOT",cr.RSEME_BOT_NAME_NOT_ACCEPTED="RSEME_BOT_NAME_NOT_ACCEPTED";let le=cr;const Em=class Em extends Mt{constructor(t,e,s,i,n){super(Em.FAVOURITE_GROUP_UPDATE,t),this._roomIndex=e,this._habboGroupId=s,this._habboGroupName=n,this._status=i}get roomIndex(){return this._roomIndex}get habboGroupId(){return this._habboGroupId}get habboGroupName(){return this._habboGroupName}get status(){return this._status}};Em.FAVOURITE_GROUP_UPDATE="RSFGUE_FAVOURITE_GROUP_UPDATE";let Og=Em;const pm=class pm extends Mt{constructor(t,e,s,i){super(pm.RSFRE_FRIEND_REQUEST,t),this._requestId=0,this._userId=0,this._requestId=e,this._userId=s,this._userName=i}get requestId(){return this._requestId}get userId(){return this._userId}get userName(){return this._userName}};pm.RSFRE_FRIEND_REQUEST="RSFRE_FRIEND_REQUEST";let uI=pm;const Im=class Im extends Mt{constructor(t,e,s){super(Im.NEST_BREEDING_SUCCESS,t),this._petId=e,this._rarityCategory=s}get rarityCategory(){return this._rarityCategory}get petId(){return this._petId}};Im.NEST_BREEDING_SUCCESS="RSPFUE_NEST_BREEDING_SUCCESS";let hI=Im;const Tm=class Tm extends Mt{constructor(t,e,s,i){super(Tm.PET_BREEDING,t),this._state=e,this._ownPetId=s,this._otherPetId=i}get state(){return this._state}get ownPetId(){return this._ownPetId}get otherPetId(){return this._otherPetId}};Tm.PET_BREEDING="RSPFUE_PET_BREEDING";let dI=Tm;const Rm=class Rm extends Mt{constructor(t,e,s){super(Rm.PET_BREEDING_RESULT,t),this._resultData=e,this._otherResultData=s}get resultData(){return this._resultData}get otherResultData(){return this._otherResultData}};Rm.PET_BREEDING_RESULT="RSPFUE_PET_BREEDING_RESULT";let _I=Rm;const Sm=class Sm extends Mt{constructor(t,e,s,i){super(Sm.PET_COMMANDS,t),this._petId=e,this._allCommandIds=s,this._enabledCommandIds=i}get id(){return this._petId}get commands(){return this._allCommandIds}get enabledCommands(){return this._enabledCommandIds}};Sm.PET_COMMANDS="RSPIUE_ENABLED_PET_COMMANDS";let wC=Sm;const Om=class Om extends Mt{constructor(t,e,s){super(Om.PET_FIGURE_UPDATE,t),this._petId=e,this._figure=s}get id(){return this._petId}get figure(){return this._figure}};Om.PET_FIGURE_UPDATE="RSPFUE_PET_FIGURE_UPDATE";let gI=Om;const Cm=class Cm extends Mt{constructor(t,e){super(Cm.PET_INFO,t),this._petInfo=e}get petInfo(){return this._petInfo}};Cm.PET_INFO="RSPIUE_PET_INFO";let Cg=Cm;const Am=class Am extends Mt{constructor(t,e,s){super(Am.PET_LEVEL_UPDATE,t),this._petId=e,this._level=s}get petId(){return this._petId}get level(){return this._level}};Am.PET_LEVEL_UPDATE="RSPLUE_PET_LEVEL_UPDATE";let fI=Am;const Nm=class Nm extends Mt{constructor(t,e,s,i,n,o){super(t,e),this._objectId=-1,this._nameValidationStatus=0,this._nameValidationInfo=null,this._objectId=s,this._figureData=i,this._nameValidationStatus=n,this._nameValidationInfo=o}get objectId(){return this._objectId}get figureData(){return this._figureData}get nameValidationStatus(){return this._nameValidationStatus}get nameValidationInfo(){return this._nameValidationInfo}};Nm.RSOPPE_OPEN_PET_PACKAGE_REQUESTED="RSOPPE_OPEN_PET_PACKAGE_REQUESTED",Nm.RSOPPE_OPEN_PET_PACKAGE_RESULT="RSOPPE_OPEN_PET_PACKAGE_RESULT";let Zo=Nm;const xm=class xm extends Mt{constructor(t,e,s,i,n,o){super(xm.PET_STATUS_UPDATE,t),this._petId=e,this._canBreed=s,this._canHarvest=i,this._canRevive=n,this._hasBreedingPermission=o}get petId(){return this._petId}get canBreed(){return this._canBreed}get canHarvest(){return this._canHarvest}get canRevive(){return this._canRevive}get hasBreedingPermission(){return this._hasBreedingPermission}};xm.PET_STATUS_UPDATE="RSPFUE_PET_STATUS_UPDATE";let Ag=xm;const Jh=class Jh extends Mt{constructor(t,e,s){super(t,e),this._id=-1,this._numQuestions=0,this._startMessage="",this._endMessage="",this._questionArray=null,this._npsPoll=!1,this._id=s}get id(){return this._id}get headline(){return this._headline}set headline(t){this._headline=t}get summary(){return this._summary}set summary(t){this._summary=t}get numQuestions(){return this._numQuestions}set numQuestions(t){this._numQuestions=t}get startMessage(){return this._startMessage}set startMessage(t){this._startMessage=t}get endMessage(){return this._endMessage}set endMessage(t){this._endMessage=t}get questionArray(){return this._questionArray}set questionArray(t){this._questionArray=t}get npsPoll(){return this._npsPoll}set npsPoll(t){this._npsPoll=t}};Jh.OFFER="RSPE_POLL_OFFER",Jh.ERROR="RSPE_POLL_ERROR",Jh.CONTENT="RSPE_POLL_CONTENT";let vn=Jh;const iC=class iC extends Mt{constructor(t,e,s,i,n,o,l,c,u){super(t,e),this._classId=0,this._itemType="",this._placedItemId=0,this._placedItemType="",this._classId=s,this._itemType=i,this._productCode=n,this._placedItemId=o,this._placedItemType=l,this._placedInRoom=c,this._petFigureString=u}get classId(){return this._classId}get itemType(){return this._itemType}get productCode(){return this._productCode}get placedItemId(){return this._placedItemId}get placedInRoom(){return this._placedInRoom}get placedItemType(){return this._placedItemType}get petFigureString(){return this._petFigureString}};iC.RSPE_PRESENT_OPENED="RSPE_PRESENT_OPENED";let Wd=iC;const rC=class rC extends Mt{constructor(t,e){super(t,e)}};rC.RSDUE_ALLOW_PETS="RSDUE_ALLOW_PETS";let Ng=rC;const jo=class jo extends Mt{constructor(t,e,s,i=!1){super(jo.QUEUE_STATUS,t),this._name=e,this._target=s,this._queues=new Map,this._isActive=i}get isActive(){return this._isActive}get queueSetName(){return this._name}get queueSetTarget(){return this._target}get queueTypes(){return Array.from(this._queues.keys())}getQueueSize(t){return this._queues.get(t)}addQueue(t,e){this._queues.set(t,e)}};jo.QUEUE_STATUS="RSQE_QUEUE_STATUS",jo.QUEUE_TYPE_CLUB="c",jo.QUEUE_TYPE_NORMAL="d",jo.QUEUE_TARGET_VISITOR=2,jo.QUEUE_TARGET_SPECTATOR=1;let FC=jo;const nC=class nC extends Mt{constructor(t,e){super(t,e)}};nC.SPECTATOR_MODE="RSSME_SPECTATOR_MODE";let xg=nC;const Mm=class Mm extends Mt{constructor(t,e,s){super(Mm.RSUBE_BADGES,t),this._userId=0,this._badges=[],this._userId=e,this._badges=s}get userId(){return this._userId}get badges(){return this._badges}};Mm.RSUBE_BADGES="RSUBE_BADGES";let Mg=Mm;const ym=class ym extends Mt{constructor(t,e){super(ym.USER_DATA_UPDATED,t),this._addedUsers=e}get addedUsers(){return this._addedUsers}};ym.USER_DATA_UPDATED="RMUDUE_USER_DATA_UPDATED";let yg=ym;const Dm=class Dm extends Mt{constructor(t,e,s,i,n,o){super(Dm.USER_FIGURE,t),this._roomIndex=0,this._figure="",this._gender="",this._customInfo="",this._roomIndex=e,this._figure=s,this._gender=i,this._customInfo=n,this._achievementScore=o}get roomIndex(){return this._roomIndex}get figure(){return this._figure}get gender(){return this._gender}get customInfo(){return this._customInfo}get activityPoints(){return this._achievementScore}};Dm.USER_FIGURE="RSUBE_FIGURE";let Dg=Dm;const bm=class bm extends kt{constructor(t,e){super(bm.UTRE_USER_TAGS_RECEIVED),this._userId=t,this._tags=e}get userId(){return this._userId}get tags(){return this._tags}};bm.UTRE_USER_TAGS_RECEIVED="UTRE_USER_TAGS_RECEIVED";let GC=bm;const vm=class vm extends Mt{constructor(t,e,s,i,n=null,o=0){super(t,e),this._question="",this._SafeStr_7654=0,this._choices=[],this._SafeStr_7651=[],this._question=s,this._choices=i,this._SafeStr_7651=n,this._SafeStr_7651==null&&(this._SafeStr_7651=[]),this._SafeStr_7654=o}get question(){return this._question}get choices(){return this._choices.slice()}get _SafeStr_4173(){return this._SafeStr_7651.slice()}get _SafeStr_4174(){return this._SafeStr_7654}};vm.VOTE_QUESTION="RSPE_VOTE_QUESTION",vm.VOTE_RESULT="RSPE_VOTE_RESULT";let Jc=vm;const $h=class $h extends Mt{constructor(t,e,s=-1){super(t,e),this._id=-1,this._pollType=null,this._pollId=-1,this._questionId=-1,this._duration=-1,this._question=null,this._userId=-1,this._id=s}get id(){return this._id}get pollType(){return this._pollType}set pollType(t){this._pollType=t}get pollId(){return this._pollId}set pollId(t){this._pollId=t}get questionId(){return this._questionId}set questionId(t){this._questionId=t}get duration(){return this._duration}set duration(t){this._duration=t}get question(){return this._question}set question(t){this._question=t}get userId(){return this._userId}set userId(t){this._userId=t}get value(){return this._value}set value(t){this._value=t}get answerCounts(){return this._answerCounts}set answerCounts(t){this._answerCounts=t}};$h.QUESTION="RWPUW_NEW_QUESTION",$h.FINISHED="RWPUW_QUESION_FINSIHED",$h.ANSWERED="RWPUW_QUESTION_ANSWERED";let Ln=$h;const Lm=class Lm extends kt{constructor(t){super(Lm.UPDATED),this._uiFlags=t}get uiFlags(){return this._uiFlags}};Lm.UPDATED="APUE_UPDATED";let mI=Lm;const Pm=class Pm extends kt{constructor(t){super(Pm.UNUE_NAME_UPDATED),this._name=t}get name(){return this._name}};Pm.UNUE_NAME_UPDATED="unue_name_updated";let bg=Pm;class XN{constructor(){this._messageIdByEvent=new Map,this._messageIdByComposer=new Map,this._messageInstancesById=new Map}dispose(){this._messageIdByEvent.clear(),this._messageIdByComposer.clear(),this._messageInstancesById.clear()}registerMessages(t){for(const[e,s]of t.events)this.registerMessageEventClass(e,s);for(const[e,s]of t.composers)this.registerMessageComposerClass(e,s)}registerMessageEventClass(t,e){!t||!e||this._messageIdByEvent.set(e,t)}registerMessageComposerClass(t,e){!t||!e||this._messageIdByComposer.set(e,t)}registerMessageEvent(t){if(!t)return;const e=this.getEventId(t);if(!e)return;let s=this._messageInstancesById.get(e);(!s||!s.length)&&(s=[],this._messageInstancesById.set(e,s)),s.push(t)}removeMessageEvent(t){if(!t)return;const e=this.getEventId(t);if(!e)return;const s=this._messageInstancesById.get(e);if(s){for(const[i,n]of s.entries())if(n&&n===t){s.splice(i,1),s.length===0&&this._messageInstancesById.delete(e),n.dispose();return}}}getEvents(t){if(!t)return;const e=this._messageInstancesById.get(t);if(e)return e}getEventId(t){if(!t)return-1;const e=t instanceof v?t.constructor:t,s=this._messageIdByEvent.get(e);return s||-1}getComposerId(t){if(!t)return-1;const e=this._messageIdByComposer.get(t.constructor);return e||-1}}class Rw extends nr{constructor(){super(),this._socket=null,this._messages=new XN,this._codec=new KN,this._dataBuffer=null,this._isReady=!1,this._pendingClientMessages=[],this._pendingServerMessages=[],this._isAuthenticated=!1,this.onOpen=this.onOpen.bind(this),this.onClose=this.onClose.bind(this),this.onError=this.onError.bind(this),this.onMessage=this.onMessage.bind(this)}init(t){this._socket=new pj().withUrl(t).withHubProtocol(new Ij).withAutomaticReconnect().build(),this._socket.onclose(e=>this.onClose()),this._socket.on("ReceiveBinary",e=>this.onMessage(e)),this._socket.start().then(()=>this.onOpen()).catch(e=>this.onError())}onDispose(){super.onDispose(),this.destroySocket(),this._messages=null,this._codec=null,this._dataBuffer=null}onReady(){this._isReady||(this._isReady=!0,this._pendingServerMessages&&this._pendingServerMessages.length&&this.processWrappers(...this._pendingServerMessages),this._pendingClientMessages&&this._pendingClientMessages.length&&this.send(...this._pendingClientMessages),this._pendingServerMessages=[],this._pendingClientMessages=[])}destroySocket(){this._socket&&this._socket.state===MC.Connected&&this._socket.stop().then(t=>this._socket=null)}onOpen(){this.dispatchConnectionEvent(fs.CONNECTION_OPENED,new Event(fs.CONNECTION_OPENED))}onClose(){this.dispatchConnectionEvent(fs.CONNECTION_CLOSED,new Event(fs.CONNECTION_CLOSED))}onError(){this.dispatchConnectionEvent(fs.CONNECTION_ERROR,new Event(fs.CONNECTION_ERROR))}onMessage(t){if(!t)return;const e=new Uint8Array(t),s=new FileReader;s.readAsArrayBuffer(new Blob([e])),s.onloadend=()=>{this._dataBuffer=this.concatArrayBuffers(this._dataBuffer,s.result),this.processReceivedData()}}dispatchConnectionEvent(t,e){this.dispatchEvent(new fs(t,this,e))}authenticated(){this._isAuthenticated=!0}send(...t){if(this.disposed||!t)return!1;if(t=[...t],this._isAuthenticated&&!this._isReady)return this._pendingClientMessages||(this._pendingClientMessages=[]),this._pendingClientMessages.push(...t),!1;for(const e of t){if(!e)continue;const s=this._messages.getComposerId(e);if(s===-1){dt.packets("Unknown Composer",e.constructor.name);continue}const i=e.getMessageArray(),n=this._codec.encode(s,i);if(!n){dt.packets("Encoding Failed",e.constructor.name);continue}dt.packets("OutgoingComposer",s,e.constructor.name,i),this.write(n.getBuffer())}return!0}write(t){this._socket.state===MC.Connected&&this._socket.invoke("ReceiveBinary",Array.from(new Uint8Array(t)))}processReceivedData(){try{this.processData()}catch(t){dt.error(t)}}processData(){const t=this.splitReceivedMessages();if(!(!t||!t.length)){if(this._isAuthenticated&&!this._isReady){this._pendingServerMessages||(this._pendingServerMessages=[]),this._pendingServerMessages.push(...t);return}this.processWrappers(...t)}}processWrappers(...t){if(!(!t||!t.length))for(const e of t){if(!e)continue;const s=this.getMessagesForWrapper(e);!s||!s.length||(dt.packets("IncomingMessage",e.header,s[0].constructor.name,s[0].parser),this.handleMessages(...s))}}splitReceivedMessages(){return!this._dataBuffer||!this._dataBuffer.byteLength?null:this._codec.decode(this)}concatArrayBuffers(t,e){if(!t&&!e)return new ArrayBuffer(0);if(!t)return e;if(!e)return t;const s=new Uint8Array(t.byteLength+e.byteLength);return s.set(new Uint8Array(t),0),s.set(new Uint8Array(e),t.byteLength),s.buffer}getMessagesForWrapper(t){if(!t)return null;const e=this._messages.getEvents(t.header);if(!e||!e.length){dt.packets("IncomingMessage",t.header,"UNREGISTERED",t);return}try{const s=new e[0].parserClass;if(!s||!s.flush()||!s.parse(t))return null;for(const i of e)i.parser=s}catch(s){return dt.error("Error parsing message",s,e[0].constructor.name),null}return e}handleMessages(...t){t=[...t];for(const e of t)e&&(e.connection=this,e.callBack&&e.callBack(e))}registerMessages(t){t&&this._messages.registerMessages(t)}addMessageEvent(t){!t||!this._messages||this._messages.registerMessageEvent(t)}removeMessageEvent(t){!t||!this._messages||this._messages.removeMessageEvent(t)}get isAuthenticated(){return this._isAuthenticated}get dataBuffer(){return this._dataBuffer}set dataBuffer(t){this._dataBuffer=t}}class Sw extends nr{constructor(t,e){super(),this._communicationManager=t,this._stateListener=e,this._socket=null,this._messages=new XN,this._codec=new KN,this._dataBuffer=null,this._isReady=!1,this._pendingClientMessages=[],this._pendingServerMessages=[],this._isAuthenticated=!1,this.onOpen=this.onOpen.bind(this),this.onClose=this.onClose.bind(this),this.onError=this.onError.bind(this),this.onMessage=this.onMessage.bind(this)}init(t){this._stateListener&&this._stateListener.connectionInit(t),this.createSocket(t)}onDispose(){super.onDispose(),this.destroySocket(),this._communicationManager=null,this._stateListener=null,this._messages=null,this._codec=null,this._dataBuffer=null}onReady(){this._isReady||(this._isReady=!0,this._pendingServerMessages&&this._pendingServerMessages.length&&this.processWrappers(...this._pendingServerMessages),this._pendingClientMessages&&this._pendingClientMessages.length&&this.send(...this._pendingClientMessages),this._pendingServerMessages=[],this._pendingClientMessages=[])}createSocket(t){t&&(this.destroySocket(),this._dataBuffer=new ArrayBuffer(0),this._socket=new WebSocket(t),this._socket.addEventListener(Kn.CONNECTION_OPENED,this.onOpen),this._socket.addEventListener(Kn.CONNECTION_CLOSED,this.onClose),this._socket.addEventListener(Kn.CONNECTION_ERROR,this.onError),this._socket.addEventListener(Kn.CONNECTION_MESSAGE,this.onMessage))}destroySocket(){this._socket&&(this._socket.removeEventListener(Kn.CONNECTION_OPENED,this.onOpen),this._socket.removeEventListener(Kn.CONNECTION_CLOSED,this.onClose),this._socket.removeEventListener(Kn.CONNECTION_ERROR,this.onError),this._socket.removeEventListener(Kn.CONNECTION_MESSAGE,this.onMessage),this._socket.readyState===WebSocket.OPEN&&this._socket.close(),this._socket=null)}onOpen(t){this.dispatchConnectionEvent(fs.CONNECTION_OPENED,t)}onClose(t){this.dispatchConnectionEvent(fs.CONNECTION_CLOSED,t)}onError(t){this.dispatchConnectionEvent(fs.CONNECTION_ERROR,t)}onMessage(t){if(!t)return;const e=new FileReader;e.readAsArrayBuffer(t.data),e.onloadend=()=>{this._dataBuffer=this.concatArrayBuffers(this._dataBuffer,e.result),this.processReceivedData()}}dispatchConnectionEvent(t,e){this.dispatchEvent(new fs(t,this,e))}authenticated(){this._isAuthenticated=!0}send(...t){if(this.disposed||!t)return!1;if(t=[...t],this._isAuthenticated&&!this._isReady)return this._pendingClientMessages||(this._pendingClientMessages=[]),this._pendingClientMessages.push(...t),!1;for(const e of t){if(!e)continue;const s=this._messages.getComposerId(e);if(s===-1){dt.packets("Unknown Composer",e.constructor.name);continue}const i=e.getMessageArray(),n=this._codec.encode(s,i);if(!n){dt.packets("Encoding Failed",e.constructor.name);continue}dt.packets("OutgoingComposer",s,e.constructor.name,i),this.write(n.getBuffer())}return!0}write(t){this._socket.readyState===WebSocket.OPEN&&this._socket.send(t)}processReceivedData(){try{this.processData()}catch(t){dt.error(t)}}processData(){const t=this.splitReceivedMessages();if(!(!t||!t.length)){if(this._isAuthenticated&&!this._isReady){this._pendingServerMessages||(this._pendingServerMessages=[]),this._pendingServerMessages.push(...t);return}this.processWrappers(...t)}}processWrappers(...t){if(!(!t||!t.length))for(const e of t){if(!e)continue;const s=this.getMessagesForWrapper(e);!s||!s.length||(dt.packets("IncomingMessage",e.header,s[0].constructor.name,s[0].parser),this.handleMessages(...s))}}splitReceivedMessages(){return!this._dataBuffer||!this._dataBuffer.byteLength?null:this._codec.decode(this)}concatArrayBuffers(t,e){const s=new Uint8Array(t.byteLength+e.byteLength);return s.set(new Uint8Array(t),0),s.set(new Uint8Array(e),t.byteLength),s.buffer}getMessagesForWrapper(t){if(!t)return null;const e=this._messages.getEvents(t.header);if(!e||!e.length){dt.packets("IncomingMessage",t.header,"UNREGISTERED",t);return}try{const s=new e[0].parserClass;if(!s||!s.flush()||!s.parse(t))return null;for(const i of e)i.parser=s}catch(s){return dt.error("Error parsing message",s,e[0].constructor.name),null}return e}handleMessages(...t){t=[...t];for(const e of t)e&&(e.connection=this,e.callBack&&e.callBack(e))}registerMessages(t){t&&this._messages.registerMessages(t)}addMessageEvent(t){!t||!this._messages||this._messages.registerMessageEvent(t)}removeMessageEvent(t){!t||!this._messages||this._messages.removeMessageEvent(t)}get isAuthenticated(){return this._isAuthenticated}get dataBuffer(){return this._dataBuffer}set dataBuffer(t){this._dataBuffer=t}}class Ow extends Ar{constructor(){super(),this._connections=[]}onDispose(){if(!(!this._connections||!this._connections.length))for(const t of this._connections.values())t&&t.dispose()}createConnection(t=null){if(Dt.getValue("socket.enabled",!1)){const e=new Sw(this,t);return e?(this._connections.push(e),e):void 0}if(Dt.getValue("signalr.enabled",!1)){const e=new Rw;return e?(this._connections.push(e),e):void 0}}update(t){let e=0;for(;e<this._connections.length;){const s=this._connections[e];if(s.processReceivedData(),this.disposed)return;s.disposed?this._connections.splice(e,1):e++}}}const Um=class Um extends kt{constructor(t){super(t)}};Um.LOADED="NCE_LOADED",Um.FAILED="NCE_FAILED";let dn=Um;class Cw extends Fa{constructor(){super(),this._definitions=new Map,this._config=[],this._pendingUrls=[],this._missingKeys=[],this.onConfigurationLoaded=this.onConfigurationLoaded.bind(this)}onInit(){Dt.parseConfiguration(this.getDefaultConfig(),!0),this._pendingUrls=Dt.getValue("config.urls").slice(),this.loadNextConfiguration()}loadNextConfiguration(){if(!this._pendingUrls.length){this.dispatchConfigurationEvent(dn.LOADED);return}this.loadConfigurationFromUrl(this._pendingUrls[0])}loadConfigurationFromUrl(t){if(!t||t===""){this.dispatchConfigurationEvent(dn.FAILED);return}fetch(t).then(e=>e.json()).then(e=>this.onConfigurationLoaded(e,t)).catch(e=>this.onConfigurationFailed(e))}onConfigurationLoaded(t,e){if(t){if(Dt.parseConfiguration(t)){const s=this._pendingUrls.indexOf(e);s>=0&&this._pendingUrls.splice(s,1),this.loadNextConfiguration();return}this.dispatchConfigurationEvent(dn.FAILED)}}onConfigurationFailed(t){this.dispatchConfigurationEvent(dn.FAILED)}dispatchConfigurationEvent(t){this.events&&this.events.dispatchEvent(new dn(t))}getDefaultConfig(){return NitroConfig}}const wo=class wo{static sayHello(){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){const t=[`
 %c %c %c Nitro ${wo.UI_VERSION} - Renderer ${wo.RENDERER_VERSION} %c %c %c https://discord.nitrodev.co %c %c 

`,"background: #ffffff; padding:5px 0;","background: #ffffff; padding:5px 0;","color: #ffffff; background: #000000; padding:5px 0;","background: #ffffff; padding:5px 0;","background: #ffffff; padding:5px 0;","background: #000000; padding:5px 0;","background: #ffffff; padding:5px 0;","background: #ffffff; padding:5px 0;"];self.console.log(...t)}else self.console&&self.console.log(`Nitro ${wo.UI_VERSION} - Renderer ${wo.RENDERER_VERSION} `)}};wo.RENDERER_VERSION="1.6.6",wo.UI_VERSION="";let rh=wo;class Aw extends Ar{constructor(){super(),rh.sayHello(),this._configuration=new Cw,this._communication=new Ow}onDispose(){this._communication&&(this._communication.dispose(),this._communication=null)}get configuration(){return this._configuration}get communication(){return this._communication}}class Nw{constructor(t){this._id=parseInt(t.id),this._value=parseInt(t.id),this._prevents=t.prevents||[],this._preventHeadTurn=t.preventHeadTurn||!1,this._isAnimated=!0,t.animated!==void 0&&t.animated===!1&&(this._isAnimated=!1)}get id(){return this._id}get value(){return this._value}get prevents(){return this._prevents}get preventHeadTurn(){return this._preventHeadTurn}get isAnimated(){return this._isAnimated}}class xw{constructor(t){if(this._id=t.id,this._state=t.state,this._precedence=t.precedence,this._activePartSet=t.activePartSet,this._assetPartDefinition=t.assetPartDefinition,this._lay=t.lay,this._geometryType=t.geometryType,this._isMain=t.main||!1,this._isDefault=t.isDefault||!1,this._isAnimation=t.animation||!1,this._startFromFrameZero=t.startFromFrameZero||!1,this._prevents=t.prevents||[],this._preventHeadTurn=t.preventHeadTurn||!1,this._types=new Map,this._params=new Map,this._defaultParameterValue="",this._canvasOffsets=null,t.params&&t.params.length>0)for(const e of t.params)e&&(e.id==="default"?this._defaultParameterValue=e.value:this._params.set(e.id,e.value));if(t.types&&t.types.length>0)for(const e of t.types){if(!e)continue;const s=new Nw(e);this._types.set(s.id,s)}}setOffsets(t,e,s){this._canvasOffsets||(this._canvasOffsets=new Map);let i=this._canvasOffsets.get(t);i||(i=new Map,this._canvasOffsets.set(t,i)),i.set(e,s)}getOffsets(t,e){if(!this._canvasOffsets)return null;const s=this._canvasOffsets.get(t);return s?s.get(e):null}getType(t){if(!t)return null;const e=this._types.get(parseInt(t));return e||null}getParameterValue(t){if(!t)return"";const e=this._params.get(t);return e||this._defaultParameterValue}getPrevents(t){return this._prevents.concat(this.getTypePrevents(t))}getTypePrevents(t){if(!t)return[];const e=this._types.get(parseInt(t));return e?e.prevents:[]}getPreventHeadTurn(t){if(!t)return this._preventHeadTurn;const e=this.getType(t);return e?e.preventHeadTurn:this._preventHeadTurn}isAnimated(t){if(!t)return!0;const e=this.getType(t);return e?e.isAnimated:!0}get id(){return this._id}get state(){return this._state}get precedence(){return this._precedence}get activePartSet(){return this._activePartSet}get assetPartDefinition(){return this._assetPartDefinition}get lay(){return this._lay}get geometryType(){return this._geometryType}get isMain(){return this._isMain}get isDefault(){return this._isDefault}get isAnimation(){return this._isAnimation}get startFromFrameZero(){return this._startFromFrameZero}get prevents(){return this._prevents}get preventHeadTurn(){return this._preventHeadTurn}get params(){return this._params}}class EI{constructor(t,e="",s=0){this._actionType=t||"",this._actionParameter=e||"",this._definition=null,this._startFrame=s||0,this._overridingAction=null}dispose(){this._actionType=null,this._actionParameter=null,this._definition=null}get id(){return this._definition?this._definition.id+"_"+this._actionParameter:""}get actionType(){return this._actionType}get actionParameter(){return this._actionParameter}set actionParameter(t){this._actionParameter=t}get definition(){return this._definition}set definition(t){this._definition=t}get startFrame(){return this._startFrame}get overridingAction(){return this._overridingAction}set overridingAction(t){this._overridingAction=t}}class Mw{constructor(t,e){this._assets=t,this._actions=new Map,this._defaultAction=null,this.updateActions(e)}updateActions(t){if(t){for(const e of t.actions){if(!e||!e.state)continue;const s=new xw(e);this._actions.set(s.state,s)}t.actionOffsets&&this.parseActionOffsets(t.actionOffsets)}}parseActionOffsets(t){if(!(!t||!t.length))for(const e of t){const s=this._actions.get(e.action);if(s)for(const i of e.offsets){const n=i.size||"",o=i.direction;if(n===""||o===void 0)continue;const l=i.x||0,c=i.y||0,u=i.z||0;s.setOffsets(n,o,[l,c,u])}}}getActionDefinition(t){if(!t)return null;for(const e of this._actions.values())if(!(!e||e.id!==t))return e;return null}getActionDefinitionWithState(t){const e=this._actions.get(t);return e||null}getDefaultAction(){if(this._defaultAction)return this._defaultAction;for(const t of this._actions.values())if(!(!t||!t.isDefault))return this._defaultAction=t,t;return null}getCanvasOffsets(t,e,s){let i=[];for(const n of t){if(!n)continue;const o=this._actions.get(n.actionType),l=o&&o.getOffsets(e,s);l&&(i=l)}return i}sortActions(t){if(!t)return null;t=this.filterActions(t);const e=[];for(const s of t){if(!s)continue;const i=this._actions.get(s.actionType);i&&(s.definition=i,e.push(s))}return e.sort(this.sortByPrecedence),e}filterActions(t){let e=[];const s=[];for(const i of t){if(!i)continue;const n=this._actions.get(i.actionType);n&&(e=e.concat(n.getPrevents(i.actionParameter)))}for(const i of t){if(!i)continue;let n=i.actionType;i.actionType==="fx"&&(n=n+("."+i.actionParameter)),!(e.indexOf(n)>=0)&&s.push(i)}return s}sortByPrecedence(t,e){if(!t||!e)return 0;const s=t.definition.precedence,i=e.definition.precedence;return s<i?1:s>i?-1:0}}class yw{constructor(t,e){this._name=t,this._link=e.link,this._flipH=e.flipH,this._flipV=e.flipV}get name(){return this._name}get link(){return this._link}get flipH(){return this._flipH}get flipV(){return this._flipV}}class Dw{constructor(t,e){this._avatarRenderManager=t,this._aliases=new Map,this._assets=e,this._missingAssetNames=[]}dispose(){this._assets=null,this._aliases=null}reset(){this.init()}init(){for(const t of this._assets.collections.values()){if(!t)continue;const e=t.data&&t.data.aliases;if(e)for(const s in e){const i=e[s];i&&this._aliases.set(s,new yw(s,i))}}}hasAlias(t){return!!this._aliases.get(t)}getAssetName(t){let e=t,s=5;for(;this.hasAlias(e)&&s>=0;)e=this._aliases.get(e).link,s--;return e}getAsset(t){if(!this._assets)return null;t=this.getAssetName(t);const e=this._assets.getAsset(t);return e||null}}class bw{constructor(t){this._id=t.id||"",this._align=t.align||"",this._base=t.base||"",this._ink=t.ink||0,this._blend=0;const e=t.blend;e&&e.length>0&&(this._blend=parseInt(e),this._blend>1&&(this._blend=this._blend/100))}get id(){return this._id}get align(){return this._align}get base(){return this._base}get ink(){return this._ink}get blend(){return this._blend}get isBlended(){return this._blend!==1}}const jm=class jm{constructor(t,e,s){if(this._id=t.id,this._animationFrame=t.frame||0,this._dx=t.dx||0,this._dy=t.dy||0,this._dz=t.dz||0,this._directionOffset=t.dd||0,this._type=e,this._base=t.base||"",this._items=new Map,t.items)for(const i of t.items)this._items.set(i.id,i.base);this._base!==""&&this.baseAsInt().toString(),s&&(this._action=new EI(s.state,this.base),this._action.definition=s)}get items(){return this._items}baseAsInt(){let t=0,e=0;for(;e<this._base.length;)t=t+this._base.charCodeAt(e),e++;return t}get id(){return this._id}get animationFrame(){return this._animationFrame}get dx(){return this._dx}get dy(){return this._dy}get dz(){return this._dz}get dd(){return this._directionOffset}get type(){return this._type}get base(){return this._base}get action(){return this._action}};jm.BODYPART="bodypart",jm.FX="fx";let bn=jm;class vw{constructor(t){this._ink=t.ink;let e=t.foreground,s=t.background;e=e.replace("#",""),s=s.replace("#",""),this._foreGround=parseInt(e,16),this._backGround=parseInt(s,16),this._colorTransform=null,this._rgb=parseInt(e,16),this._r=this._rgb>>16&255,this._g=this._rgb>>8&255,this._b=this._rgb>>0&255,this._redMultiplier=this._r/255*1,this._greenMultiplier=this._g/255*1,this._blueMultiplier=this._b/255*1,this._alphaMultiplier=1,this._paletteIsGrayscale=!0,this._ink===37&&(this._alphaMultiplier=.5,this._paletteIsGrayscale=!1),this._colorTransform=new HN({red:this._r/255,green:this._g/255,blue:this._b/255,alpha:this._alphaMultiplier}),this._colorMap=this.generatePaletteMapForGrayscale(this._backGround,this._foreGround)}get ink(){return this._ink}get colorTransform(){return this._colorTransform}get reds(){return this._colorMap.get("reds")}get greens(){return this._colorMap.get("greens")}get blues(){return this._colorMap.get("blues")}get alphas(){return this._colorMap.get("alphas")}get paletteIsGrayscale(){return this._paletteIsGrayscale}generatePaletteMapForGrayscale(t,e){const s=t>>24&255,i=t>>16&255,n=t>>8&255,o=t>>0&255,l=e>>24&255,c=e>>16&255,u=e>>8&255,h=e>>0&255,d=(l-s)/255,g=(c-i)/255,E=(u-n)/255,m=(h-o)/255,I=new Map,p=[],T=[],R=[];let S=s,b=i,N=n,P=o;for(let B=0;B<256;B++)b==i&&N==n&&P==o&&(S=0),S=S+d,b=b+g,N=N+E,P=P+m,p.push(S<<24|b<<16|N<<8|P),T.push(S<<24|b<<16|N<<8|P),R.push(S<<24|b<<16|N<<8|P);return I.set("alphas",p),I.set("reds",p),I.set("greens",T),I.set("blues",R),I}}class Lw{constructor(t){this._offset=t.offset}get offset(){return this._offset}}class Pw{constructor(t,e){this._animation=t,this._id=e.id,this._ink=e.ink,this._member=e.member,this._hasStaticY=!!e.staticY,this._hasDirections=!!e.directions,this._dx=[],this._dy=[],this._dz=[];const s=e.directionList;if(s&&s.length)for(const i of s){const n=i.id;n!==void 0&&(this._dx[n]=i.dx||0,this._dy[n]=i.dy||0,this._dz[n]=i.dz||0)}}getDirectionOffsetX(t){return t<this._dx.length?this._dx[t]:0}getDirectionOffsetY(t){return t<this._dy.length?this._dy[t]:0}getDirectionOffsetZ(t){return t<this._dz.length?this._dz[t]:0}get animation(){return this._animation}get id(){return this._id}get ink(){return this._ink}get member(){return this._member}get hasDirections(){return this._hasDirections}get hasStaticY(){return this._hasStaticY}}const pu=class pu{constructor(t,e){if(this._id=e.name,this._description=this._id,this._frames=[],this._spriteData=null,this._avatarData=null,this._directionData=null,this._removeData=null,this._addData=null,this._overriddenActions=null,this._overrideFrames=null,this._resetOnToggle=e.resetOnToggle||!1,e.sprites&&e.sprites.length){this._spriteData=[];for(const s of e.sprites)this._spriteData.push(new Pw(this,s))}if(e.avatars&&e.avatars.length&&(this._avatarData=new vw(e.avatars[0])),e.directions&&e.directions.length&&(this._directionData=new Lw(e.directions[0])),e.removes&&e.removes.length){this._removeData=[];for(const s of e.removes)this._removeData.push(s.id)}if(e.adds&&e.adds.length){this._addData=[];for(const s of e.adds)this._addData.push(new bw(s))}if(e.overrides&&e.overrides.length){this._overrideFrames=new Map,this._overriddenActions=new Map;for(const s of e.overrides){const i=s.name,n=s.override;this._overriddenActions.set(n,i);const o=[];this.parseFrames(o,s.frames,t),this._overrideFrames.set(i,o)}}this.parseFrames(this._frames,e.frames,t)}parseFrames(t,e,s){if(!(!e||!e.length))for(const i of e){let n=1;i.repeats&&i.repeats>1&&(n=i.repeats);let o=0;for(;o<n;){const l=[];if(i.bodyparts&&i.bodyparts.length)for(const c of i.bodyparts){const u=s.getActionDefinition(c.action),h=new bn(c,bn.BODYPART,u);l.push(h)}if(i.fxs&&i.fxs.length)for(const c of i.fxs){const u=s.getActionDefinition(c.action),h=new bn(c,bn.FX,u);l.push(h)}t.push(l),o++}}}frameCount(t=null){if(!t)return this._frames.length;if(this._overrideFrames){const e=this._overrideFrames.get(t);if(e)return e.length}return 0}hasOverriddenActions(){return this._overriddenActions?this._overriddenActions.size>0:!1}overriddenActionNames(){if(!this._overriddenActions)return null;const t=[];for(const e of this._overriddenActions.keys())t.push(e);return t}overridingAction(t){return this._overriddenActions?this._overriddenActions.get(t):null}getFrame(t,e=null){t<0&&(t=0);let s=[];if(!e)this._frames.length>0&&(s=this._frames[t%this._frames.length]);else{const i=this._overrideFrames.get(e);i&&i.length>0&&(s=i[t%i.length])}return s}getAnimatedBodyPartIds(t,e=null){const s=[];for(const i of this.getFrame(t,e))if(i.type===bn.BODYPART)s.push(i.id);else if(i.type===bn.FX&&this._addData&&this._addData.length)for(const n of this._addData)n.id===i.id&&s.push(n.align);return s}getLayerData(t,e,s=null){for(const i of this.getFrame(t,s)){if(i.id===e)return i;if(i.type===bn.FX&&this._addData&&this._addData.length){for(const n of this._addData)if(n.align===e&&n.id===i.id)return i}}return null}hasAvatarData(){return this._avatarData!==null}hasDirectionData(){return this._directionData!==null}hasAddData(){return this._addData!==null}getAddData(t){if(this._addData){for(const e of this._addData)if(e.id===t)return e}return null}get id(){return this._id}get spriteData(){return this._spriteData||pu.EMPTY_ARRAY}get avatarData(){return this._avatarData}get directionData(){return this._directionData}get removeData(){return this._removeData||pu.EMPTY_ARRAY}get addData(){return this._addData||pu.EMPTY_ARRAY}toString(){return this._description}get resetOnToggle(){return this._resetOnToggle}};pu.EMPTY_ARRAY=[];let pI=pu;class Uw{constructor(){this._animations=new Map}registerAnimation(t,e){if(!e)return!1;const s=e[Object.keys(e)[0]],i=new pI(t,s);return this._animations.set(s.name,i),!0}getAnimation(t){const e=this._animations.get(t);return e||null}getLayerData(t,e,s){const i=this.getAnimation(t);return i?i.getLayerData(e,s):null}get animations(){return this._animations}}const ur=class ur extends nr{constructor(t,e,s,i){super(),this._state=ur.NOT_LOADED,this._libraryName=t,this._revision=e,this._downloadUrl=i,this._assets=s,this._downloadUrl=this._downloadUrl.replace(/%libname%/gi,this._libraryName),this._downloadUrl=this._downloadUrl.replace(/%revision%/gi,this._revision),this._assets.getCollection(this._libraryName)&&(this._state=ur.LOADED)}async downloadAsset(){if(!this._assets||this._state===ur.LOADING||this._state===ur.LOADED)return;if(this._assets.getCollection(this._libraryName)){this._state=ur.LOADED,this.dispatchEvent(new cc(cc.DOWNLOAD_COMPLETE,this));return}this._state=ur.LOADING,await this._assets.downloadAsset(this._downloadUrl)&&(this._state=ur.LOADED,this.dispatchEvent(new cc(cc.DOWNLOAD_COMPLETE,this)))}get libraryName(){return this._libraryName}get isLoaded(){return this._state===ur.LOADED}};ur.DOWNLOAD_COMPLETE="AADL_DOWNLOAD_COMPLETE",ur.NOT_LOADED=0,ur.LOADING=1,ur.LOADED=2;let II=ur;const Wl=class Wl extends nr{constructor(t,e){super(),this._assets=t,this._structure=e,this._missingMandatoryLibs=Dt.getValue("avatar.mandatory.libraries"),this._figureMap=new Map,this._pendingContainers=[],this._figureListeners=new Map,this._incompleteFigures=new Map,this._pendingDownloadQueue=[],this._currentDownloads=[],this._libraryNames=[],this._isReady=!1,this.onLibraryLoaded=this.onLibraryLoaded.bind(this),this.onAvatarRenderReady=this.onAvatarRenderReady.bind(this),this.loadFigureMap(),this._structure.renderManager.events.addEventListener(Gd.AVATAR_RENDER_READY,this.onAvatarRenderReady)}loadFigureMap(){const t=new XMLHttpRequest;try{t.open("GET",Dt.getValue("avatar.figuremap.url")),t.send(),t.onloadend=e=>{if(t.responseText){const s=JSON.parse(t.responseText);this.processFigureMap(s.libraries),this.processMissingLibraries(),this._isReady=!0,this.dispatchEvent(new kt(Wl.DOWNLOADER_READY))}},t.onerror=e=>{throw new Error("invalid_avatar_figure_map")}}catch(e){dt.error(e)}}processFigureMap(t){if(t)for(const e of t){if(!e)continue;const s=e.id,i=e.revision||"";if(this._libraryNames.indexOf(s)>=0)continue;this._libraryNames.push(s);const n=new II(s,i,this._assets,Dt.getValue("avatar.asset.url"));n.addEventListener(cc.DOWNLOAD_COMPLETE,this.onLibraryLoaded);for(const o of e.parts){const l=o.id,u=o.type+":"+l;let h=this._figureMap.get(u);h||(h=[]),h.push(n),this._figureMap.set(u,h)}}}onAvatarRenderReady(t){if(t){for(const[e,s]of this._pendingContainers)this.downloadAvatarFigure(e,s);this._pendingContainers=[]}}onLibraryLoaded(t){if(!t||!t.library)return;const e=[];for(const[i,n]of this._incompleteFigures.entries()){let o=!0;for(const l of n)if(!(!l||l.isLoaded)){o=!1;break}if(o){e.push(i);const l=this._figureListeners.get(i);if(l)for(const c of l)!c||c.disposed||c.resetFigure(i);this._figureListeners.delete(i),this.dispatchEvent(new kt(Wl.LIBRARY_LOADED))}}for(const i of e)i&&this._incompleteFigures.delete(i);let s=0;for(;s<this._currentDownloads.length;){const i=this._currentDownloads[s];i&&i.libraryName===t.library.libraryName&&this._currentDownloads.splice(s,1),s++}}processMissingLibraries(){const t=this._missingMandatoryLibs.slice();for(const e of t){if(!e)continue;const s=this._figureMap.get(e);if(s)for(const i of s)i&&this.downloadLibrary(i)}}isAvatarFigureContainerReady(t){return!this._isReady||!this._structure.renderManager.isReady?!1:!this.getAvatarFigurePendingLibraries(t).length}getAvatarFigurePendingLibraries(t){const e=[];if(!t||!this._structure)return e;const s=this._structure.figureData;if(!s)return e;const i=t.getPartTypeIds();for(const n of i){const o=s.getSetType(n);if(!o)continue;const l=o.getPartSet(t.getPartSetId(n));if(l)for(const c of l.parts){if(!c)continue;const u=c.type+":"+c.id,h=this._figureMap.get(u);if(h!==void 0)for(const d of h)!d||d.isLoaded||e.indexOf(d)>=0||e.push(d)}}return e}downloadAvatarFigure(t,e){if(!this._isReady||!this._structure.renderManager.isReady){this._pendingContainers.push([t,e]);return}const s=t.getFigureString(),i=this.getAvatarFigurePendingLibraries(t);if(i&&i.length){if(e&&!e.disposed){let n=this._figureListeners.get(s);n||(n=[],this._figureListeners.set(s,n)),n.push(e)}this._incompleteFigures.set(s,i);for(const n of i)n&&this.downloadLibrary(n)}else e&&!e.disposed&&e.resetFigure(s)}downloadLibrary(t){!t||t.isLoaded||this._pendingDownloadQueue.indexOf(t)>=0||this._currentDownloads.indexOf(t)>=0||(this._pendingDownloadQueue.push(t),this.processDownloadQueue())}processDownloadQueue(){for(;this._pendingDownloadQueue.length;)this._pendingDownloadQueue[0].downloadAsset(),this._currentDownloads.push(this._pendingDownloadQueue.shift())}};Wl.DOWNLOADER_READY="AADM_DOWNLOADER_READY",Wl.LIBRARY_LOADED="AADM_LIBRARY_LOADED",Wl.MAX_DOWNLOADS=2;let yl=Wl;class Mh{constructor(t){this._parts=new Map,this.parseFigure(t)}getPartTypeIds(){return this.partSets().keys()}hasPartType(t){return!!this.partSets().get(t)}getPartSetId(t){const e=this.partSets().get(t);return e?e.get("setid"):0}getPartColorIds(t){const e=this.partSets().get(t);return e?e.get("colorids"):null}updatePart(t,e,s){const i=new Map;i.set("type",t),i.set("setid",e),i.set("colorids",s);const n=this.partSets();n.delete(t),n.set(t,i)}removePart(t){this.partSets().delete(t)}getFigureString(){const t=[];for(const e of this.partSets().keys()){if(!e)continue;let s=[];s.push(e),s.push(this.getPartSetId(e)),s=s.concat(this.getPartColorIds(e)),t.push(s.join("-"))}return t.join(".")}partSets(){return this._parts||(this._parts=new Map),this._parts}parseFigure(t){t||(t="");for(const e of t.split(".")){const s=e.split("-");if(s.length>=2){const i=s[0],n=parseInt(s[1]),o=[];let l=2;for(;l<s.length;)o.push(parseInt(s[l])),l++;this.updatePart(i,n,o)}}}}class jw{constructor(){this._cache=new Map,this.setLastAccessTime(Pt())}dispose(){if(this.debugInfo("[dispose]"),!!this._cache){for(const t of this._cache.values())t&&t.dispose();this._cache.clear()}}getDirectionCache(t){const e=this._cache.get(t.toString());return e||null}updateDirectionCache(t,e){this._cache.set(t.toString(),e)}setLastAccessTime(t){this._lastAccessTime=t}getLastAccessTime(){return this._lastAccessTime}debugInfo(t){}}class BC{constructor(){this._cache=new Map}setAction(t,e){this._currentAction||(this._currentAction=t);const s=this.getActionCache(this._currentAction);s&&s.setLastAccessTime(e),this._currentAction=t}dispose(){if(!this._disposed){if(!this._cache)return;this.disposeActions(0,2147483647),this._cache.clear(),this._cache=null,this._disposed=!0}}disposeActions(t,e){if(!(!this._cache||this._disposed))for(const[s,i]of this._cache.entries()){if(!i)continue;const n=i.getLastAccessTime();e-n>=t&&(i.dispose(),this._cache.delete(s))}}getAction(){return this._currentAction}setDirection(t){this._currentDirection=t}getDirection(){return this._currentDirection}getActionCache(t=null){return this._currentAction?(t||(t=this._currentAction),t.overridingAction?this._cache.get(t.overridingAction):this._cache.get(t.id)):null}updateActionCache(t,e){t.overridingAction?this._cache.set(t.overridingAction,e):this._cache.set(t.id,e)}debugInfo(t){}}class ww{constructor(t,e,s){this._image=t,this._regPoint=e,this._offset=new wt(0,0),this._regPoint=e,this._isCacheable=s,this.cleanPoints()}dispose(){this._image&&this._image.destroy({children:!0}),this._image=null,this._regPoint=null,this._offset=null}cleanPoints(){}setRegPoint(t){this._regPoint=t,this.cleanPoints()}get image(){return this._image}set image(t){this._image&&this._image!==t&&this._image.destroy({children:!0}),this._image=t}get regPoint(){const t=this._regPoint.clone();return t.x+=this._offset.x,t.y+=this._offset.y,t}set offset(t){this._offset=t,this.cleanPoints()}get isCacheable(){return this._isCacheable}}class Fw{constructor(t){this._partList=t,this._images=new Map}dispose(){for(const t of this._images.values())t&&t.dispose();this._images=null}getPartList(){return this._partList}getImageContainer(t){const e=this._images.get(this.getCacheKey(t));return e||null}updateImageContainer(t,e){const s=this.getCacheKey(e),i=this._images.get(s);i&&i.dispose(),this._images.set(s,t)}getCacheKey(t){let e="";for(const s of this._partList)e+=s.getCacheableKey(t)+"/";return e}debugInfo(t){}}class kC{constructor(t,e,s,i,n,o=null){this._texture=t,this._container=o,this._rect=e,this._regPoint=s,this._flipH=i,this._colorTransform=n,i&&(this._regPoint.x=-this._regPoint.x+e.width)}dispose(){this._texture=null,this._regPoint=null,this._colorTransform=null}get texture(){return this._texture}get container(){return this._container}get rect(){return this._rect}get regPoint(){return this._regPoint}get flipH(){return this._flipH}get colorTransform(){return this._colorTransform}get offsetRect(){return new Or(-this._regPoint.x,-this._regPoint.y,this._rect.width,this._rect.height)}}const aC=class aC{constructor(t,e,s,i){this._structure=t,this._avatar=e,this._assets=s,this._scale=i,this._cache=new Map,this._canvas=null,this._disposed=!1,this._unionImages=[],this._matrix=new sr,this._serverRenderData=[]}dispose(){if(!this._disposed){if(this._structure=null,this._avatar=null,this._assets=null,this._canvas=null,this._disposed=!0,this._cache){for(const t of this._cache.values())t&&t.dispose();this._cache=null}if(this._unionImages){for(const t of this._unionImages)t&&t.dispose();this._unionImages=[]}}}disposeInactiveActions(t=6e4){const e=Pt();if(this._cache)for(const s of this._cache.values())s&&s.disposeActions(t,e)}resetBodyPartCache(t){if(this._cache)for(const e of this._cache.values())e&&e.setAction(t,0)}setDirection(t,e){const s=this._structure.getBodyPartsUnordered(t);if(s)for(const i of s){const n=this.getBodyPartCache(i);n&&n.setDirection(e)}}setAction(t,e){const s=this._structure.getActiveBodyPartIds(t,this._avatar);for(const i of s){const n=this.getBodyPartCache(i);n&&n.setAction(t,e)}}setGeometryType(t){if(this._geometryType!==t){if(this._geometryType===Mo.SITTING&&t===Mo.VERTICAL||this._geometryType===Mo.VERTICAL&&t===Mo.SITTING||this._geometryType===Mo.SNOWWARS_HORIZONTAL&&(t=Mo.SNOWWARS_HORIZONTAL)){this._geometryType=t,this._canvas=null;return}this.disposeInactiveActions(0),this._geometryType=t,this._canvas=null}}getImageContainer(t,e,s=!1){let i=this.getBodyPartCache(t);i||(i=new BC,this._cache.set(t,i));let n=i.getDirection(),o=i.getAction(),l=e;o.definition.startFromFrameZero&&(l-=o.startFrame);let c=o,u=[],h=new Map;const d=new wt;if(!(!o||!o.definition)&&o.definition.isAnimation){let p=n;const T=this._structure.getAnimation(o.definition.state+"."+o.actionParameter),R=e-o.startFrame;if(T){const S=T.getLayerData(R,t,o.overridingAction);S&&(p=n+S.dd,S.dd<0?p<0?p=8+p:p>7&&(p=8-p):p<0?p=p+8:p>7&&(p=p-8),this._scale===kr.LARGE?(d.x=S.dx,d.y=S.dy):(d.x=S.dx/2,d.y=S.dy/2),l=S.animationFrame,S.action&&(o=S.action),S.type===bn.BODYPART?(S.action!=null&&(c=S.action),n=p):S.type===bn.FX&&(n=p),h=S.items),u=T.removeData}}let g=i.getActionCache(c);(!g||s)&&(g=new jw,i.updateActionCache(c,g));let E=g.getDirectionCache(n);if(!E||s){const p=this._structure.getParts(t,this._avatar.getFigure(),c,this._geometryType,n,u,this._avatar,h);E=new Fw(p),g.updateDirectionCache(n,E)}let m=E.getImageContainer(l);if(!m||s){const p=E.getPartList();if(m=this.renderBodyPart(n,p,l,o,s),m&&!s)m.isCacheable&&E.updateImageContainer(m,l);else return null}const I=this._structure.getFrameBodyPartOffset(c,n,l,t);return d.x+=I.x,d.y+=I.y,m.offset=d,m}getServerRenderData(){return this._serverRenderData=[],this._serverRenderData}getBodyPartCache(t){let e=this._cache.get(t);return e||(e=new BC,this._cache.set(t,e)),e}renderBodyPart(t,e,s,i,n=!1){if(!e||!e.length||!this._canvas&&(this._canvas=this._structure.getCanvas(this._scale,this._geometryType),!this._canvas))return null;const o=_n.DIRECTION_IS_FLIPPED[t]||!1;let l=i.definition.assetPartDefinition,c=!0,u=e.length-1;for(;u>=0;){const m=e[u];let I=16777215;if(!(t==7&&(m.partType==="fc"||m.partType==="ey"))&&!(m.partType==="ri"&&!m.partId)){const p=m.partId,T=m.getFrameDefinition(s);let R=m.partType,S=0;T?(S=T.number,T.assetPartDefinition&&T.assetPartDefinition!==""&&(l=T.assetPartDefinition)):S=m.getFrameIndex(s);let b=t,N=!1;o&&(l==="wav"&&(R===Kt.LEFT_HAND||R===Kt.LEFT_SLEEVE||R===Kt.LEFT_COAT_SLEEVE)||l==="drk"&&(R===Kt.RIGHT_HAND||R===Kt.RIGHT_SLEEVE||R===Kt.RIGHT_COAT_SLEEVE)||l==="blw"&&R===Kt.RIGHT_HAND||l==="sig"&&R===Kt.LEFT_HAND||l==="respect"&&R===Kt.LEFT_HAND||R===Kt.RIGHT_HAND_ITEM||R===Kt.LEFT_HAND_ITEM||R===Kt.CHEST_PRINT?N=!0:(t===4?b=2:t===5?b=1:t===6&&(b=0),m.flippedPartType!==R&&(R=m.flippedPartType)));let P=this._scale+"_"+l+"_"+R+"_"+p+"_"+b+"_"+S,B=this._assets.getAsset(P);if(B||(P=this._scale+"_std_"+R+"_"+p+"_"+b+"_0",B=this._assets.getAsset(P)),B){const F=B.texture;if(!F||!F.valid||!F.baseTexture)c=!1;else{m.isColorable&&m.color&&(I=m.color.rgb);const w=new wt(-B.x,-B.y);if(N&&(w.x=w.x+(this._scale===kr.LARGE?65:31)),n){const U=new zN;U.name=this._assets.getAssetName(P),U.x=-w.x-33,U.y=-w.y,U.z=this._serverRenderData.length*-1e-4,U.width=B.rectangle.width,U.height=B.rectangle.height,U.flipH=N,l==="lay"&&(U.x=U.x+53),o&&(U.flipH=!U.flipH,U.flipH?U.x=-U.x-F.width:U.x=U.x+65),m.isColorable&&(U.color=`${I}`),this._serverRenderData.push(U)}this._unionImages.push(new kC(F,B.rectangle,w,N,I))}}}u--}if(!this._unionImages.length)return null;const h=this.createUnionImage(this._unionImages,o),d=this._scale===kr.LARGE?this._canvas.height-16:this._canvas.height-8,g=new wt(-h.regPoint.x,d-h.regPoint.y);o&&l!=="lay"&&(g.x=g.x+(this._scale===kr.LARGE?67:31));let E=this._unionImages.length-1;for(;E>=0;){const m=this._unionImages.pop();m&&m.dispose(),E--}return new ww(h.container,g,c)}convertColorToHex(t){let e=(t*255).toString(16);return e.length<2&&(e="0"+e),e}createUnionImage(t,e){const s=new Or;for(const l of t)l&&s.enlarge(l.offsetRect);const i=new wt(-s.x,-s.y),n=new hn,o=new Xe(Es.EMPTY);o.width=s.width,o.height=s.height,n.addChild(o);for(const l of t){if(!l)continue;const c=l.texture,u=l.colorTransform,h=!(e&&l.flipH)&&(e||l.flipH),d=i.clone();d.x-=l.regPoint.x,d.y-=l.regPoint.y,e&&(d.x=n.width-(d.x+l.rect.width)),h?(this._matrix.a=-1,this._matrix.tx=l.rect.x+l.rect.width+d.x,this._matrix.ty=d.y-l.rect.y):(this._matrix.a=1,this._matrix.tx=d.x-l.rect.x,this._matrix.ty=d.y-l.rect.y);const g=new Xe(c);g.tint=u,g.transform.setFromMatrix(this._matrix),n.addChild(g)}return new kC(null,n.getLocalBounds(),i,e,null,n)}};aC.DEFAULT_MAX_CACHE_STORAGE_TIME_MS=6e4;let TI=aC;const $s=class $s{constructor(t,e,s,i,n,o=null){this._frameCounter=0,this._directionOffset=0,this._isAnimating=!1,this._animationHasResetOnToggle=!1,this._actionsSorted=!1,this._fullImageCacheSize=5,this._isCachedImage=!1,this._useFullImageCache=!1,this._effectIdInUse=-1,this._cachedBodyPartsDirection=-1,this._cachedBodyPartsGeometryType=null,this._cachedBodyPartsAvatarSet=null,this._canvasOffsets=[],this._actions=[],this._cachedBodyParts=[],this._changes=!0,this._disposed=!1,this._effectManager=n,this._structure=t,this._assets=e,this._scale=i,this._effectListener=o,this._scale==null&&(this._scale=kr.LARGE),s==null&&(s=new Mh("hr-893-45.hd-180-2.ch-210-66.lg-270-82.sh-300-91.wa-2007-.ri-1-")),this._figure=s,this._cache=new TI(this._structure,this,this._assets,this._scale),this.setDirection($s.DEFAULT_AVATAR_SET,$s.DEFAULT_DIRECTION),this._actions=[],this._defaultAction=new EI(mt.POSTURE_STAND),this._defaultAction.definition=this._structure.getActionDefinition($s.DEFAULT_ACTION),this.resetActions(),this._fullImageCache=new hs,this._animationFrameCount=0}getServerRenderData(){return this.getAvatarPartsForCamera(si.FULL),this._cache.getServerRenderData()}dispose(){if(!this._disposed){if(this._structure=null,this._assets=null,this._mainAction=null,this._figure=null,this._avatarSpriteData=null,this._actions=null,this._image&&(this._image.destroy(),this._image=null),this._cache&&(this._cache.dispose(),this._cache=null),this._fullImageCache){for(const t of this._fullImageCache.getValues())t&&t.destroy();this._fullImageCache=null}this._image=null,this._canvasOffsets=null,this._disposed=!0}}get disposed(){return this._disposed}getFigure(){return this._figure}getScale(){return this._scale}getPartColor(t){return this._structure.getPartColor(this._figure,t)}setDirection(t,e){e=e+this._directionOffset,e<_n.MIN_DIRECTION&&(e=_n.MAX_DIRECTION+(e+1)),e>_n.MAX_DIRECTION&&(e=e-(_n.MAX_DIRECTION+1)),this._structure.isMainAvatarSet(t)&&(this._mainDirection=e),(t===si.HEAD||t===si.FULL)&&(t===si.HEAD&&this.isHeadTurnPreventedByAction()&&(e=this._mainDirection),this._headDirection=e),this._cache.setDirection(t,e),this._changes=!0}setDirectionAngle(t,e){this.setDirection(t,Math.floor(e/45))}getSprites(){return this._sprites}getCanvasOffsets(){return this._canvasOffsets}getLayerData(t){return this._structure.getBodyPartData(t.animation.id,this._frameCounter,t.id)}updateAnimationByFrames(t=1){this._frameCounter+=t,this._changes=!0}resetAnimationFrameCounter(){this._frameCounter=0,this._changes=!0}getFullImageCacheKey(){if(!this._useFullImageCache)return null;if(this._sortedActions.length==1&&this._mainDirection==this._headDirection)return this._mainDirection+this._currentActionsString+this._frameCounter%4;if(this._sortedActions.length==2)for(const t of this._sortedActions){if(t.actionType=="fx"&&(t.actionParameter=="33"||t.actionParameter=="34"||t.actionParameter=="35"||t.actionParameter=="36"))return this._mainDirection+this._currentActionsString+0;if(t.actionType=="fx"&&(t.actionParameter=="38"||t.actionParameter=="39"))return this._mainDirection+"_"+this._headDirection+this._currentActionsString+this._frameCounter%11;if(t.actionType==="dance"&&(t.actionParameter==="1"||t.actionParameter==="2"||t.actionParameter==="3"||t.actionParameter==="4")){let e=this._frameCounter%8;return t.actionParameter==="3"&&(e=this._frameCounter%10),t.actionParameter==="4"&&(e=this._frameCounter%16),this._mainDirection+t.actionType+t.actionParameter+e}}return null}getBodyParts(t,e,s){return(s!=this._cachedBodyPartsDirection||e!=this._cachedBodyPartsGeometryType||t!=this._cachedBodyPartsAvatarSet)&&(this._cachedBodyPartsDirection=s,this._cachedBodyPartsGeometryType=e,this._cachedBodyPartsAvatarSet=t,this._cachedBodyParts=this._structure.getBodyParts(t,e,s)),this._cachedBodyParts}getAvatarPartsForCamera(t){let e;if(this._mainAction==null||this._structure.getCanvas(this._scale,this._mainAction.definition.geometryType)==null)return;const i=this.getBodyParts(t,this._mainAction.definition.geometryType,this._mainDirection);let n=i.length-1;for(;n>=0;)e=i[n],this._cache.getImageContainer(e,this._frameCounter,!0),n--}getImage(t,e,s=1,i=!0){if(!this._changes)return this._image;if(!this._mainAction)return null;this._actionsSorted||this.endActionAppends();const n=this._structure.getCanvas(this._scale,this._mainAction.definition.geometryType);if(!n)return null;this._image&&(this._image.width!==n.width||this._image.height!==n.height)&&(this._reusableTexture&&(this._reusableTexture.destroy(!0),this._reusableTexture=null),this._image=null,this._isCachedImage=!1);const o=this.getBodyParts(t,this._mainAction.definition.geometryType,this._mainDirection);this._image=null;const l=new hn;let c=!0,u=o.length-1;for(;u>=0;){const h=o[u],d=this._cache.getImageContainer(h,this._frameCounter);if(d){const g=d.image;if(!g)return l.destroy({children:!0}),null;c=c&&d.isCacheable;const E=d.regPoint.clone();if(E){E.x+=n.offset.x,E.y+=n.offset.y,E.x+=n.regPoint.x,E.y+=n.regPoint.y;const m=new hn;m.addChild(g),m&&(m.position.set(E.x,E.y),l.addChild(m))}}u--}return this._avatarSpriteData&&(l.filters||(l.filters=[]),this._avatarSpriteData.colorTransform&&l.filters.push(this._avatarSpriteData.colorTransform),this._avatarSpriteData.paletteIsGrayscale&&(this.convertToGrayscale(l),l.filters.push(new ug(this._avatarSpriteData.reds,ug.CHANNEL_RED)))),i?(this._reusableTexture?(ws.instance.renderer.render(l,{renderTexture:this._reusableTexture,clear:!0}),this._reusableTexture.baseTexture.hitMap=null):this._reusableTexture=Ee.generateTexture(l,new Or(0,0,n.width,n.height)),this._reusableTexture?(this._image=this._reusableTexture,this._changes=!1,this._image):null):Ee.generateTexture(l,new Or(0,0,n.width,n.height))}applyPalette(t,e=[],s=[],i=[]){const n=Ee.generateCanvas(t),o=n.getContext("2d"),l=o.getImageData(0,0,n.width,n.height),c=l.data;for(let h=0;h<c.length;h+=4){if(e.length==256){let d=e[c[h]];d===void 0&&(d=0),c[h]=d>>16&255,c[h+1]=d>>8&255,c[h+2]=d&255}if(s.length==256){let d=s[c[h+1]];d===void 0&&(d=0),c[h]=d>>16&255,c[h+1]=d>>8&255,c[h+2]=d&255}if(i.length==256){let d=s[c[h+2]];d===void 0&&(d=0),c[h]=d>>16&255,c[h+1]=d>>8&255,c[h+2]=d&255}}o.putImageData(l,0,0);const u=new ms(Es.from(n));return ws.instance.renderer.render(u,{renderTexture:t,clear:!0}),t}getImageAsSprite(t,e=1){if(!this._mainAction)return null;this._actionsSorted||this.endActionAppends();const s=this._structure.getCanvas(this._scale,this._mainAction.definition.geometryType);if(!s)return null;const i=this.getBodyParts(t,this._mainAction.definition.geometryType,this._mainDirection),n=new Xe,o=new Xe(Es.EMPTY);o.width=s.width,o.height=s.height,n.addChild(o);let l=i.length-1;for(;l>=0;){const c=i[l],u=this._cache.getImageContainer(c,this._frameCounter);if(u){const h=u.image;if(!h)return n.destroy({children:!0}),null;const d=u.regPoint.clone();if(d){d.x+=s.offset.x,d.y+=s.offset.y,d.x+=s.regPoint.x,d.y+=s.regPoint.y;const g=new hn;g.addChild(h),g.position.set(d.x,d.y),n.addChild(g)}}l--}return n}getCroppedImage(t,e=1){if(!this._mainAction)return null;this._actionsSorted||this.endActionAppends();const s=this._structure.getCanvas(this._scale,this._mainAction.definition.geometryType);if(!s)return null;const i=this.getBodyParts(t,this._mainAction.definition.geometryType,this._mainDirection),n=new hn;let o=i.length-1;for(;o>=0;){const u=i[o],h=this._cache.getImageContainer(u,this._frameCounter);if(h){const d=h.image;if(!d)return n.destroy({children:!0}),null;const g=h.regPoint.clone();if(g){g.x+=s.offset.x,g.y+=s.offset.y,g.x+=s.regPoint.x,g.y+=s.regPoint.y;const E=new hn;E.addChild(d),E&&(E.position.set(g.x,g.y),n.addChild(E))}}o--}const l=Ee.generateTexture(n,new Or(0,0,s.width,s.height)),c=Ee.generateImage(l);return c||null}getFullImage(t){const e=this._fullImageCache.getValue(t);return e?(e.valid||(this._fullImageCache.remove(t),e.destroy(!0)),e):null}cacheFullImage(t,e){const s=this._fullImageCache.getValue(t);if(s&&(this._fullImageCache.remove(t),s.destroy(!0)),this._fullImageCache.length===this._fullImageCacheSize){const i=this._fullImageCache.getKey(0);i&&this._fullImageCache.remove(i).destroy(!0)}this._fullImageCache.add(t,e)}getAsset(t){return this._assets.getAsset(t)}getDirection(){return this._mainDirection}initActionAppends(){this._actions=[],this._actionsSorted=!1,this._currentActionsString="",this._useFullImageCache=!1}endActionAppends(){if(this.sortActions()){for(const t of this._sortedActions)t.actionType===mt.EFFECT&&(this._effectManager.isAvatarEffectReady(parseInt(t.actionParameter))||this._effectManager.downloadAvatarEffect(parseInt(t.actionParameter),this));this.resetActions(),this.setActionsToParts()}}appendAction(t,...e){let s="";switch(this._actionsSorted=!1,e&&e.length>0&&(s=e[0]),s!=null&&(s=s.toString()),t){case mt.POSTURE:switch(s){case mt.POSTURE_LAY:case mt.POSTURE_WALK:case mt.POSTURE_STAND:case mt.POSTURE_SWIM:case mt.POSTURE_FLOAT:case mt.POSTURE_SIT:case mt.SNOWWAR_RUN:case mt.SNOWWAR_DIE_FRONT:case mt.SNOWWAR_DIE_BACK:case mt.SNOWWAR_PICK:case mt.SNOWWAR_THROW:(s===mt.POSTURE_LAY||s===mt.POSTURE_LAY||s===mt.POSTURE_LAY)&&(s===mt.POSTURE_LAY&&(this._mainDirection==0?this.setDirection(si.FULL,4):this.setDirection(si.FULL,2)),this._useFullImageCache=!0,this._useFullImageCache=!0),this.addActionData(s);break}break;case mt.GESTURE:switch(s){case mt.GESTURE_AGGRAVATED:case mt.GESTURE_SAD:case mt.GESTURE_SMILE:case mt.GESTURE_SURPRISED:this.addActionData(s);break}break;case mt.EFFECT:case mt.DANCE:case mt.TALK:case mt.EXPRESSION_WAVE:case mt.SLEEP:case mt.SIGN:case mt.EXPRESSION_RESPECT:case mt.EXPRESSION_BLOW_A_KISS:case mt.EXPRESSION_LAUGH:case mt.EXPRESSION_CRY:case mt.EXPRESSION_IDLE:case mt.EXPRESSION_SNOWBOARD_OLLIE:case mt.EXPRESSION_SNOWBORD_360:case mt.EXPRESSION_RIDE_JUMP:s===mt.EFFECT&&(s==="33"||s==="34"||s==="35"||s==="36"||s==="38"||s==="39")&&(this._useFullImageCache=!0),this.addActionData(t,s);break;case mt.CARRY_OBJECT:case mt.USE_OBJECT:{const i=this._structure.getActionDefinitionWithState(t);i&&(s=i.getParameterValue(s)),this.addActionData(t,s);break}}return!0}addActionData(t,e=""){let s;this._actions||(this._actions=[]);let i=0;for(;i<this._actions.length;){if(s=this._actions[i],s.actionType==t&&s.actionParameter==e)return;i++}this._actions.push(new EI(t,e,this._frameCounter))}isAnimating(){return this._isAnimating||this._animationFrameCount>1}resetActions(){return this._animationHasResetOnToggle=!1,this._isAnimating=!1,this._sprites=[],this._avatarSpriteData=null,this._directionOffset=0,this._structure.removeDynamicItems(this),this._mainAction=this._defaultAction,this._mainAction.definition=this._defaultAction.definition,this.resetBodyPartCache(this._defaultAction),!0}isHeadTurnPreventedByAction(){let t,e;if(this._sortedActions==null)return!1;for(const s of this._sortedActions)t=this._structure.getActionDefinitionWithState(s.actionType),t!=null&&t.getPreventHeadTurn(s.actionParameter)&&(e=!0);return e}sortActions(){let t,e,s;if(this._currentActionsString="",this._sortedActions=this._structure.sortActions(this._actions),this._animationFrameCount=this._structure.maxFrames(this._sortedActions),!this._sortedActions)this._canvasOffsets=[0,0,0],this._lastActionsString!==""&&(s=!0,this._lastActionsString="");else{this._canvasOffsets=this._structure.getCanvasOffsets(this._sortedActions,this._scale,this._mainDirection);for(const i of this._sortedActions)if(this._currentActionsString=this._currentActionsString+(i.actionType+i.actionParameter),i.actionType===mt.EFFECT){const n=parseInt(i.actionParameter);this._effectIdInUse!==n&&(t=!0),this._effectIdInUse=n,e=!0}e||(this._effectIdInUse>-1&&(t=!0),this._effectIdInUse=-1),t&&this._cache.disposeInactiveActions(0),this._lastActionsString!=this._currentActionsString&&(s=!0,this._lastActionsString=this._currentActionsString)}return this._actionsSorted=!0,s}setActionsToParts(){if(!this._sortedActions==null)return;const t=Pt(),e=[];for(const s of this._sortedActions)e.push(s.actionType);for(const s of this._sortedActions)if(s&&s.definition&&s.definition.isAnimation){const i=this._structure.getAnimation(s.definition.state+"."+s.actionParameter);if(i&&i.hasOverriddenActions()){const n=i.overriddenActionNames();if(n)for(const o of n)e.indexOf(o)>=0&&(s.overridingAction=i.overridingAction(o))}i&&i.resetOnToggle&&(this._animationHasResetOnToggle=!0)}for(const s of this._sortedActions)if(!(!s||!s.definition)&&(s.definition.isAnimation&&s.actionParameter===""&&(s.actionParameter="1"),this.setActionToParts(s,t),s.definition.isAnimation)){this._isAnimating=s.definition.isAnimated(s.actionParameter);const i=this._structure.getAnimation(s.definition.state+"."+s.actionParameter);i&&(this._sprites=this._sprites.concat(i.spriteData),i.hasDirectionData()&&(this._directionOffset=i.directionData.offset),i.hasAvatarData()&&(this._avatarSpriteData=i.avatarData))}}setActionToParts(t,e){t==null||t.definition==null||t.definition.assetPartDefinition!=""&&(t.definition.isMain&&(this._mainAction=t,this._cache.setGeometryType(t.definition.geometryType)),this._cache.setAction(t,e),this._changes=!0)}resetBodyPartCache(t){t&&t.definition.assetPartDefinition!==""&&(t.definition.isMain&&(this._mainAction=t,this._cache.setGeometryType(t.definition.geometryType)),this._cache.resetBodyPartCache(t),this._changes=!0)}get avatarSpriteData(){return this._avatarSpriteData}convertToGrayscale(t,e="CHANNELS_EQUAL"){let s=.33,i=.33,n=.33;switch(e){case $s.CHANNELS_UNIQUE:s=.3,i=.59,n=.11;break;case $s.CHANNELS_RED:s=1,i=0,n=0;break;case $s.CHANNELS_GREEN:s=0,i=1,n=0;break;case $s.CHANNELS_BLUE:s=0,i=0,n=1;break;case $s.CHANNELS_DESATURATED:s=.3086,i=.6094,n=.082;break}const o=new UN;return o.matrix=[s,i,n,0,0,s,i,n,0,0,s,i,n,0,0,0,0,0,1,0],t.filters.push(o),t}errorThis(t){}logThis(t){}isPlaceholder(){return!1}forceActionUpdate(){this._lastActionsString=""}get animationHasResetOnToggle(){return this._animationHasResetOnToggle}get mainAction(){return this._mainAction.actionType}resetEffect(t){t===this._effectIdInUse&&(this.resetActions(),this.setActionsToParts(),this._animationHasResetOnToggle=!0,this._changes=!0,this._effectListener&&this._effectListener.resetEffect(t))}};$s.CHANNELS_EQUAL="CHANNELS_EQUAL",$s.CHANNELS_UNIQUE="CHANNELS_UNIQUE",$s.CHANNELS_RED="CHANNELS_RED",$s.CHANNELS_GREEN="CHANNELS_GREEN",$s.CHANNELS_BLUE="CHANNELS_BLUE",$s.CHANNELS_DESATURATED="CHANNELS_DESATURATED",$s.DEFAULT_ACTION="Default",$s.DEFAULT_DIRECTION=2,$s.DEFAULT_AVATAR_SET=si.FULL;let vg=$s;class rg{constructor(t){this._number=t.number,this._assetPartDefinition=t.assetPartDefinition||null}get number(){return this._number}get assetPartDefinition(){return this._assetPartDefinition}}class Gw{constructor(t){if(this._frames=[],t.frames&&t.frames.length>0)for(const e of t.frames){if(!e)continue;this._frames.push(new rg(e));let s=e.repeats||0;if(s>1)for(;--s>0;)this._frames.push(this._frames[this._frames.length-1])}}get frames(){return this._frames}}const Iu=class Iu{constructor(t){if(this._id=t.id,this._actionParts=new Map,this._bodyPartOffsets=new Map,this._frameCount=0,this._frameIndexes=[],t.parts&&t.parts.length>0)for(const e of t.parts){if(!e)continue;const s=new Gw(e);this._actionParts.set(e.setType,s),this._frameCount=Math.max(this._frameCount,s.frames.length)}if(t.offsets&&t.offsets.frames&&t.offsets.frames.length>0)for(const e of t.offsets.frames){if(!e)continue;const s=e.id;this._frameCount=Math.max(this._frameCount,s);const i=new Map;if(this._bodyPartOffsets.set(s,i),e.directions&&e.directions.length>0)for(const n of e.directions){if(!n)continue;const o=n.id,l=new Map;if(i.set(o,l),n.bodyParts&&n.bodyParts.length>0)for(const c of n.bodyParts){if(!c)continue;const u=c.id;let h=0,d=0;c.dx!==void 0&&(h=c.dx),c.dy!==void 0&&(d=c.dy),l.set(u,new wt(h,d))}}if(this._frameIndexes.push(s),e.repeats!==void 0){let n=e.repeats||0;if(n>1)for(;--n>0;)this._frameIndexes.push(s)}}}getPart(t){if(!t)return null;const e=this._actionParts.get(t);return e||null}getFrameBodyPartOffset(t,e,s){const i=e%this._frameIndexes.length,n=this._frameIndexes[i],o=this._bodyPartOffsets.get(n);if(!o)return Iu.DEFAULT_OFFSET;const l=o.get(t);if(!l)return Iu.DEFAULT_OFFSET;const c=l.get(s);return c||Iu.DEFAULT_OFFSET}get id(){return this._id}get parts(){return this._actionParts}get frameCount(){return this._frameCount}};Iu.DEFAULT_OFFSET=new wt(0,0);let Yd=Iu;class Bw{constructor(){this._actions=new Map}parse(t){if(t&&t.length>0)for(const e of t){if(!e)continue;const s=new Yd(e);this._actions.set(s.id,s)}return!0}appendJSON(t){for(const e of t.action)this._actions.set(e.id,new Yd(e));return!0}getAction(t){const e=this._actions.get(t.id);return e||null}getFrameCount(t){const e=this.getAction(t);return e?e.frameCount:0}}class kw{constructor(t,e){this._id=t.id,this._width=t.width,this._height=t.height,this._offset=new wt(t.dx,t.dy),e==kr.LARGE?this._regPoint=new wt((this._width-64)/2,0):this._regPoint=new wt((this._width-32)/2,0)}get width(){return this._width}get height(){return this._height}get offset(){return this._offset}get id(){return this._id}get regPoint(){return this._regPoint}}const wm=class wm extends nr{constructor(t,e){super(),this._dataReceiver=e,this.download(t)}download(t){const e=new XMLHttpRequest;try{e.open("GET",t),e.send(),e.onloadend=s=>{const i=e.responseText;if(!i||!i.length)throw new Error("invalid_figure_data");this._dataReceiver&&this._dataReceiver.appendJSON(JSON.parse(i)),this.dispatchEvent(new kt(wm.AVATAR_STRUCTURE_DONE))},e.onerror=s=>{throw new Error("invalid_avatar_figure_data")}}catch(s){dt.error(s)}}};wm.AVATAR_STRUCTURE_DONE="AVATAR_STRUCTURE_DONE";let Lg=wm;class Vw{constructor(t){if(!t)throw new Error("invalid_data");this._id=t.id,this._type=t.type,this._index=t.index,this._colorLayerIndex=t.colorindex,this._paletteMapId=-1,this._breed=-1}dispose(){}get id(){return this._id}get type(){return this._type}get breed(){return this._breed}get index(){return this._index}get colorLayerIndex(){return this._colorLayerIndex}get paletteMap(){return this._paletteMapId}}class Hw{constructor(t,e){if(!t||!e)throw new Error("invalid_data");this._id=e.id,this._type=t,this._gender=e.gender,this._clubLevel=e.club,this._isColorable=e.colorable,this._isSelectable=e.selectable,this._parts=[],this._hiddenLayers=[],this._isPreSelectable=e.preselectable,this._isSellable=e.sellable;for(const s of e.parts){const i=new Vw(s),n=this.getPartIndex(i);n!==-1?this._parts.splice(n,0,i):this._parts.push(i)}if(e.hiddenLayers)for(const s of e.hiddenLayers)this._hiddenLayers.push(s.partType)}dispose(){for(const t of this._parts)t.dispose();this._parts=null,this._hiddenLayers=null}getPartIndex(t){const e=this._parts.length;if(!e)return-1;for(let s=0;s<e;s++){const i=this._parts[s];if(i&&!(i.type!==t.type||i.index>t.index))return s}return-1}getPart(t,e){for(const s of this._parts)if(!(s.type!==t||s.id!==e))return s;return null}get id(){return this._id}get type(){return this._type}get gender(){return this._gender}get clubLevel(){return this._clubLevel}get isColorable(){return this._isColorable}get isSelectable(){return this._isSelectable}get parts(){return this._parts}get hiddenLayers(){return this._hiddenLayers}get isPreSelectable(){return this._isPreSelectable}get isSellable(){return this._isSellable}}class Ww{constructor(t){if(!t)throw new Error("invalid_data");this._id=t.id,this._index=t.index,this._clubLevel=t.club||0,this._isSelectable=t.selectable,this._rgb=parseInt("0x"+t.hexCode,16)}get id(){return this._id}get index(){return this._index}get clubLevel(){return this._clubLevel}get isSelectable(){return this._isSelectable}get rgb(){return this._rgb}}class VC{constructor(t){if(!t)throw new Error("invalid_data");this._id=t.id,this._colors=new hs,this.append(t)}append(t){for(const e of t.colors){const s=new Ww(e);this._colors.add(e.id.toString(),s)}}getColor(t){return t===void 0||t<0?null:this._colors.getValue(t.toString())||null}get id(){return this._id}get colors(){return this._colors}}class Tp{constructor(t){if(!t)throw new Error("invalid_data");this._type=t.type,this._paletteId=t.paletteId,this._isMandatory={},this._isMandatory.F=[t.mandatory_f_0,t.mandatory_f_1],this._isMandatory.M=[t.mandatory_m_0,t.mandatory_m_1],this._partSets=new hs,this.append(t)}dispose(){for(const t of this._partSets.getValues())t.dispose();this._partSets=null}cleanUp(t){for(const e of t.sets){const s=e.id.toString(),i=this._partSets.getValue(s);i&&(i.dispose(),this._partSets.remove(s))}}append(t){if(!(!t||!t.sets))for(const e of t.sets)this._partSets.add(e.id.toString(),new Hw(this._type,e))}getDefaultPartSet(t){for(const e of this._partSets.getValues())if(e&&e.clubLevel===0&&(e.gender===t||e.gender==="U"))return e;return null}getPartSet(t){return this._partSets.getValue(t.toString())}get type(){return this._type}get paletteID(){return this._paletteId}isMandatory(t,e){return this._isMandatory[t.toUpperCase()][Math.min(e,1)]}optionalFromClubLevel(t){return this._isMandatory[t.toUpperCase()].indexOf(!1)}get partSets(){return this._partSets}}class Yw{constructor(){this._palettes=new Map,this._setTypes=new Map}dispose(){}parse(t){if(!t)return!1;for(const e of t.palettes){const s=new VC(e);s&&this._palettes.set(s.id.toString(),s)}for(const e of t.setTypes){const s=new Tp(e);s&&this._setTypes.set(s.type,s)}return!0}injectJSON(t){for(const e of t.setTypes){const s=this._setTypes.get(e.type);s?s.cleanUp(e):this._setTypes.set(e.type,new Tp(e))}this.appendJSON(t)}appendJSON(t){if(!t)return!1;for(const e of t.palettes){const s=e.id.toString(),i=this._palettes.get(s);i?i.append(e):this._palettes.set(s,new VC(e))}for(const e of t.setTypes){const s=e.type,i=this._setTypes.get(s);i?i.append(e):this._setTypes.set(s,new Tp(e))}return!1}getMandatorySetTypeIds(t,e){const s=[];for(const i of this._setTypes.values())!i||!i.isMandatory(t,e)||s.push(i.type);return s}getDefaultPartSet(t,e){const s=this._setTypes.get(t);return s?s.getDefaultPartSet(e):null}getSetType(t){return this._setTypes.get(t)||null}getPalette(t){return this._palettes.get(t.toString())||null}getFigurePartSet(t){for(const e of this._setTypes.values()){const s=e.getPartSet(t);if(s)return s}return null}}class HC{constructor(t){if(this._id=t.id,this._parts=[],t.activeParts&&t.activeParts.length>0)for(const e of t.activeParts)e&&this._parts.push(e.setType)}get parts(){return this._parts}}class Rp{constructor(t){if(!t)throw new Error("invalid_data");this._setType=t.setType,this._flippedSetType=t.flippedSetType||null,this._removeSetType=t.removeSetType||null,this._appendToFigure=!1,this._staticId=-1}hasStaticId(){return this._staticId>=0}get staticId(){return this._staticId}set staticId(t){this._staticId=t}get setType(){return this._setType}get flippedSetType(){return this._flippedSetType}set flippedSetType(t){this._flippedSetType=t}get removeSetType(){return this._removeSetType}get appendToFigure(){return this._appendToFigure}set appendToFigure(t){this._appendToFigure=t}}class zw{constructor(){this._parts=new Map,this._activePartSets=new Map}parse(t){if(t.partSet&&t.partSet.length>0)for(const e of t.partSet)e&&this._parts.set(e.setType,new Rp(e));if(t.activePartSets&&t.activePartSets.length>0)for(const e of t.activePartSets)e&&this._activePartSets.set(e.id,new HC(e));return!0}appendJSON(t){if(t.partSet&&t.partSet.length>0)for(const e of t.partSet)e&&this._parts.set(e.setType,new Rp(e));if(t.activePartSets&&t.activePartSets.length>0)for(const e of t.activePartSets)e&&this._activePartSets.set(e.id,new HC(e));return!1}getActiveParts(t){const e=this._activePartSets.get(t.activePartSet);return e?e.parts:[]}getPartDefinition(t){const e=this._parts.get(t);return e||null}addPartDefinition(t){const e=t.setType;let s=this._parts.get(e);return s||(s=new Rp(t),this._parts.set(e,s)),s}getActivePartSet(t){const e=this._activePartSets.get(t.activePartSet);return e||null}get parts(){return this._parts}get activePartSets(){return this._activePartSets}}class Sp{constructor(t,e,s,i,n,o,l,c,u="",h=!1,d=1){this._bodyPartId=t,this._partType=e,this._partId=s,this._color=i,this._frames=n,this._action=o,this._isColorable=l,this._paletteMapId=c,this._flippedPartType=u,this._isBlendable=h,this._blendTransform=null,this._partType==="ey"&&(this._isColorable=!1)}getFrameIndex(t){if(!this._frames||!this._frames.length)return 0;const e=t%this._frames.length;return this._frames[e]instanceof rg?this._frames[e].number:e}getFrameDefinition(t){const e=t%this._frames.length;return this._frames&&this._frames.length>e&&this._frames[e]instanceof rg?this._frames[e]:null}getCacheableKey(t){const e=t%this._frames.length;if(this._frames&&this._frames.length>e&&this._frames[e]instanceof rg){const s=this._frames[e];return this.partId+":"+s.assetPartDefinition+":"+s.number}return this.partId+":"+e}get bodyPartId(){return this._bodyPartId}get partType(){return this._partType}get partId(){return this._partId}get color(){return this._color}get action(){return this._action}get isColorable(){return this._isColorable}set isColorable(t){this._isColorable=t}get paletteMapId(){return this._paletteMapId}get flippedPartType(){return this._flippedPartType}get isBlendable(){return this._isBlendable}toString(){return[this._bodyPartId,this._partType,this._partId].join(":")}}const Vt=class Vt{constructor(){this._gender="M",this._avatarEffectType=-1}loadAvatarData(t,e){this._data=new Map,this._colors=new Map,this._gender=e,this.parseFigureString(t)}dispose(){this._data=null,this._colors=null,this._isDisposed=!0}get disposed(){return this._isDisposed}parseFigureString(t){if(t)for(const e of t.split(".")){const s=e.split("-");if(s.length>0){const i=s[0],n=parseInt(s[1]),o=[];let l=2;for(;l<s.length;)o.push(parseInt(s[l])),l++;o.length||o.push(0),this.savePartSetId(i,n,!1),this.savePartSetColourId(i,o,!1)}}}hasSetType(t){return!!this._data.get(t)}getPartSetId(t){return this.hasSetType(t)?this._data.get(t):-1}getColourIds(t){return this._colors.get(t)?this._colors.get(t):[]}getFigureString(){let t="";const e=[];for(const[i,n]of this._data.entries()){let o=i+"-"+n;const l=this._colors.get(i);if(l)for(const c of l)o=o+("-"+c);e.push(o)}let s=0;for(;s<e.length;)t=t+e[s],s<e.length-1&&(t=t+"."),s++;return t}savePartData(t,e,s,i=!1){this.savePartSetId(t,e,i),this.savePartSetColourId(t,s,i)}savePartSetId(t,e,s=!0){switch(t){case Vt.HD:case Vt.HAIR:case Vt.HAT:case Vt.HEAD_ACCESSORIES:case Vt.EYE_ACCESSORIES:case Vt.FACE_ACCESSORIES:case Vt.SHIRT:case Vt.JACKET:case Vt.CHEST_ACCESSORIES:case Vt.CHEST_PRINTS:case Vt.TROUSERS:case Vt.SHOES:case Vt.TROUSER_ACCESSORIES:e>=0?this._data.set(t,e):this._data.delete(t)}}savePartSetColourId(t,e,s=!0){switch(t){case Vt.HD:case Vt.HAIR:case Vt.HAT:case Vt.HEAD_ACCESSORIES:case Vt.EYE_ACCESSORIES:case Vt.FACE_ACCESSORIES:case Vt.SHIRT:case Vt.JACKET:case Vt.CHEST_ACCESSORIES:case Vt.CHEST_PRINTS:case Vt.TROUSERS:case Vt.SHOES:case Vt.TROUSER_ACCESSORIES:this._colors.set(t,e);return}}getFigureStringWithFace(t){const e=[Vt.HD];let s="";const i=[];for(const o of e){const l=this._colors.get(o);if(l){let c=this._data.get(o);o===Vt.HD&&(c=t);let u=o+"-"+c;if(c>=0){let h=0;for(;h<l.length;)u=u+("-"+l[h]),h++}i.push(u)}}let n=0;for(;n<i.length;)s=s+i[n],n<i.length-1&&(s=s+"."),n++;return s}get gender(){return this._gender}};Vt.MALE="M",Vt.FEMALE="F",Vt.UNISEX="U",Vt.SCALE="h",Vt.STD="std",Vt.DEFAULT_FRAME="0",Vt.HD="hd",Vt.HAIR="hr",Vt.HAT="ha",Vt.HEAD_ACCESSORIES="he",Vt.EYE_ACCESSORIES="ea",Vt.FACE_ACCESSORIES="fa",Vt.JACKET="cc",Vt.SHIRT="ch",Vt.CHEST_ACCESSORIES="ca",Vt.CHEST_PRINTS="cp",Vt.TROUSERS="lg",Vt.SHOES="sh",Vt.TROUSER_ACCESSORIES="wa",Vt.BLOCKED_FX_TYPES=[28,29,30,33,34,35,36,37,38,39,40,41,42,43,68];let RI=Vt;class Kw{constructor(t){this._data=[],this._maxSize=t,this._index=0}reset(){this._data=[],this._index=0}addValue(t){this._data.length<this._maxSize?this._data.push(t):this._data[this._index]=t,this._index=(this._index+1)%this._maxSize}getMax(){let t=Number.MIN_VALUE,e=0;for(;e<this._maxSize;)this._data[e]>t&&(t=this._data[e]),e++;return t}getMin(){let t=Number.MAX_VALUE,e=0;for(;e<this._maxSize;)this._data[e]<t&&(t=this._data[e]),e++;return t}}class Ys{constructor(t,e){this._location=t,this._direction=e}get location(){return this._location}get direction(){return this._direction}}class KE extends Ar{constructor(){super(),this._object=null,this._events=null,this._time=0}initialize(t){}onDispose(){this._object=null}update(t){this._time=t}processUpdateMessage(t){!t||!this._object||(this._object.setLocation(t.location),this._object.setDirection(t.direction))}getEventTypes(){return[]}mergeTypes(t,e){const s=t.concat();for(const i of e)!i||s.indexOf(i)>=0||s.push(i);return s}mouseEvent(t,e){}useObject(){}setObject(t){if(this._object!==t){if(this._object&&this._object.setLogic(null),!t){this.dispose(),this._object=null;return}this._object=t,this._object.setLogic(this)}}tearDown(){}get object(){return this._object}get eventDispatcher(){return this._events}set eventDispatcher(t){this._events=t}get widget(){return null}get contextMenu(){return null}get time(){return this._time}}class qN{constructor(){this._map=new Map,this._updateCounter=0}dispose(){this._map.clear(),this._updateCounter=0}getValue(t){return this._map.get(t)}setValue(t,e){this._map.has(t)&&this._map.get(t)===e||(this._map.set(t,e),this._updateCounter++)}removeKey(t){t&&(this._map.delete(t),this._updateCounter++)}get updateCounter(){return this._updateCounter}}const Fm=class Fm extends Ar{constructor(t,e,s){super(),this._id=t,this._instanceId=Fm.OBJECT_COUNTER++,this._type=s,this._model=new qN,this._location=new j,this._direction=new j,this._states=[],this._visualization=null,this._logic=null,this._pendingLogicMessages=[],this._updateCounter=0,this._isReady=!1;let i=e-1;for(;i>=0;)this._states[i]=0,i--}onDispose(){this._pendingLogicMessages=[],this.setVisualization(null),this.setLogic(null),this._model&&this._model.dispose(),super.onDispose()}getLocation(){return this._location}setLocation(t){t&&(t.x===this._location.x&&t.y===this._location.y&&t.z===this._location.z||(this._location.x=t.x,this._location.y=t.y,this._location.z=t.z,this._updateCounter++))}getDirection(){return this._direction}setDirection(t){t&&(t.x===this._direction.x&&t.y===this._direction.y&&t.z===this._direction.z||(this._direction.x=(t.x%360+360)%360,this._direction.y=(t.y%360+360)%360,this._direction.z=(t.z%360+360)%360,this._updateCounter++))}getState(t=0){return t>=0&&t<this._states.length?this._states[t]:-1}setState(t,e=0){return e>=0&&e<this._states.length?(this._states[e]!==t&&(this._states[e]=t,this._updateCounter++),!0):!1}setVisualization(t){this._visualization!==t&&(this._visualization&&this._visualization.dispose(),this._visualization=t,this._visualization&&(this._visualization.object=this))}setLogic(t){if(this._logic===t)return;const e=this._logic;if(e&&(this._logic=null,e.setObject(null)),this._logic=t,this._logic)for(this._logic.setObject(this);this._pendingLogicMessages.length;){const s=this._pendingLogicMessages.shift();this._logic.processUpdateMessage(s)}}processUpdateMessage(t){if(this._logic)return this._logic.processUpdateMessage(t);this._pendingLogicMessages.push(t)}tearDown(){this._logic&&this._logic.tearDown()}get id(){return this._id}get instanceId(){return this._instanceId}get type(){return this._type}get model(){return this._model}get visualization(){return this._visualization}get mouseHandler(){return this._logic}get logic(){return this._logic}get location(){return this._location}get direction(){return this._direction}get updateCounter(){return this._updateCounter}set updateCounter(t){this._updateCounter=t}get isReady(){return this._isReady}set isReady(t){this._isReady=t}};Fm.OBJECT_COUNTER=0;let SI=Fm;const Gm=class Gm{constructor(){this._id=Gm.SPRITE_COUNTER++,this._name="",this._type="",this._spriteType=Gr.DEFAULT,this._texture=null,this._container=null,this._width=0,this._height=0,this._offsetX=0,this._offsetY=0,this._flipH=!1,this._flipV=!1,this._direction=0,this._alpha=255,this._blendMode=lo.NORMAL,this._color=16777215,this._relativeDepth=0,this._varyingDepth=!1,this._libraryAssetName="",this._clickHandling=!1,this._visible=!0,this._tag="",this._posture=null,this._alphaTolerance=Fn.MATCH_OPAQUE_PIXELS,this._filters=[],this._updateCounter=0,this._updateContainer=!1}dispose(){this._texture=null,this._width=0,this._height=0}get id(){return this._id}set id(t){this._id=t}get name(){return this._name}set name(t){this._name!==t&&(this._name=t,this._updateCounter++)}get type(){return this._type}set type(t){this._type=t}get spriteType(){return this._spriteType}set spriteType(t){this._spriteType=t}get texture(){return this._texture}set texture(t){this._texture!==t&&(t&&(this._width=t.width,this._height=t.height),this._texture=t,this._updateCounter++)}get container(){return this._container}set container(t){this._container!==t&&(this.texture=Es.EMPTY,t&&(this._width=t.width,this._height=t.height),this._container=t,this._updateCounter++,this._updateContainer=!0)}get width(){return this._width}get height(){return this._height}get offsetX(){return this._offsetX}set offsetX(t){this._offsetX!==t&&(this._offsetX=t,this._updateCounter++)}get offsetY(){return this._offsetY}set offsetY(t){this._offsetY!==t&&(this._offsetY=t,this._updateCounter++)}get flipH(){return this._flipH}set flipH(t){this._flipH!==t&&(this._flipH=t,this._updateCounter++)}get flipV(){return this._flipV}set flipV(t){this._flipV!==t&&(this._flipV=t,this._updateCounter++)}get direction(){return this._direction}set direction(t){this._direction=t}get alpha(){return this._alpha}set alpha(t){t=t&255,this._alpha!==t&&(this._alpha=t,this._updateCounter++)}get blendMode(){return this._blendMode}set blendMode(t){this._blendMode!==t&&(this._blendMode=t,this._updateCounter++)}get color(){return this._color}set color(t){t=t&16777215,this._color!==t&&(this._color=t,this._updateCounter++)}get relativeDepth(){return this._relativeDepth}set relativeDepth(t){this._relativeDepth!==t&&(this._relativeDepth=t,this._updateCounter++)}get varyingDepth(){return this._varyingDepth}set varyingDepth(t){t!==this._varyingDepth&&(this._varyingDepth=t,this._updateCounter++)}get libraryAssetName(){return this._libraryAssetName}set libraryAssetName(t){this._libraryAssetName=t}get clickHandling(){return this._clickHandling}set clickHandling(t){this._clickHandling=t}get visible(){return this._visible}set visible(t){this._visible!==t&&(this._visible=t,this._updateCounter++)}get tag(){return this._tag}set tag(t){this._tag!==t&&(this._tag=t,this._updateCounter++)}get posture(){return this._posture}set posture(t){this._posture!==t&&(this._posture=t,this._updateCounter++)}get alphaTolerance(){return this._alphaTolerance}set alphaTolerance(t){this._alphaTolerance!==t&&(this._alphaTolerance=t,this._updateCounter++)}get filters(){return this._filters}set filters(t){this._filters=t,this._updateCounter++}get updateCounter(){return this._updateCounter}get updateContainer(){return this._updateContainer}set updateContainer(t){this._updateContainer=t}};Gm.SPRITE_COUNTER=0;let Pg=Gm;const Bm=class Bm{constructor(){this._id=Bm.VISUALIZATION_COUNTER++,this._object=null,this._asset=null,this._sprites=[],this._scale=-1,this._updateObjectCounter=-1,this._updateModelCounter=-1,this._updateSpriteCounter=-1}initialize(t){return!1}update(t,e,s,i){}reset(){this._scale=-1}dispose(){if(this._sprites){for(;this._sprites.length;){const t=this._sprites[0];t&&t.dispose(),this._sprites.pop()}this._sprites=null}this._object=null,this._asset=null}getSprite(t){return t>=0&&t<this._sprites.length?this._sprites[t]:null}getSpriteList(){return null}createSprite(){return this.createSpriteAtIndex(this._sprites.length)}createSpriteAtIndex(t){const e=new Pg;return t>=this._sprites.length?this._sprites.push(e):this._sprites.splice(t,0,e),e}createSprites(t){for(;this._sprites.length>t;){const e=this._sprites[this._sprites.length-1];e&&e.dispose(),this._sprites.pop()}for(;this._sprites.length<t;)this._sprites.push(new Pg)}get image(){return this.getImage(0,-1)}getImage(t,e){const s=this.getBoundingRectangle();if(s.width*s.height===0)return null;const i=this.totalSprites,n=[];let o=0;for(;o<i;){const u=this.getSprite(o);u&&u.visible&&u.texture&&n.push(u),o++}n.sort((u,h)=>h.relativeDepth-u.relativeDepth);const l=new hn;for(o=0;o<n.length;){const u=n[o],h=u.texture;if(h){const d=new Xe(h);d.alpha=u.alpha/255,d.tint=u.color,d.x=u.offsetX,d.y=u.offsetY,d.blendMode=u.blendMode,d.filters=u.filters,u.flipH&&(d.scale.x=-1),u.flipV&&(d.scale.y=-1),l.addChild(d)}o++}const c=Ee.generateTexture(l);return c||null}getBoundingRectangle(){const t=this.totalSprites,e=new Or;let s=0;for(;s<t;){const i=this.getSprite(s);if(i&&i.texture&&i.visible){const n=i.flipH?-i.width+i.offsetX:i.offsetX,o=i.flipV?-i.height+i.offsetY:i.offsetY,l=new wt(n,o);s===0?(e.x=l.x,e.y=l.y,e.width=i.width,e.height=i.height):(l.x<e.x&&(e.x=l.x),l.y<e.y&&(e.y=l.y),l.x+i.width>e.right&&(e.width=l.x+i.width-e.x),l.y+i.height>e.bottom&&(e.height=l.y+i.height-e.y))}s++}return e}get instanceId(){return this._id}get object(){return this._object}set object(t){this._object=t}get asset(){return this._asset}set asset(t){this._asset&&this._asset.removeReference(),this._asset=t,this._asset&&this._asset.addReference()}get sprites(){return this._sprites}get totalSprites(){return this._sprites.length}get updateObjectCounter(){return this._updateObjectCounter}set updateObjectCounter(t){this._updateObjectCounter=t}get updateModelCounter(){return this._updateModelCounter}set updateModelCounter(t){this._updateModelCounter=t}get updateSpriteCounter(){return this._updateSpriteCounter}set updateSpriteCounter(t){this._updateSpriteCounter=t}get spriteCount(){return this._sprites.length}};Bm.VISUALIZATION_COUNTER=0;let nh=Bm;class Xw{constructor(t){this._roomObjectVariableAccurateZ=t||"",this._location=new j,this._screenLocation=new j,this._locationChanged=!1,this._geometryUpdateId=-1,this._objectUpdateId=-1}dispose(){this._screenLocation=null}updateLocation(t,e){if(!t||!e)return null;let s=!1;const i=t.getLocation();if((e.updateId!==this._geometryUpdateId||t.updateCounter!==this._objectUpdateId)&&(this._objectUpdateId=t.updateCounter,(e.updateId!==this._geometryUpdateId||i.x!==this._location.x||i.y!==this._location.y||i.z!==this._location.z)&&(this._geometryUpdateId=e.updateId,this._location.assign(i),s=!0)),this._locationChanged=s,this._locationChanged){const n=e.getScreenPosition(i);if(!n)return null;const o=t.model.getValue(this._roomObjectVariableAccurateZ);if(isNaN(o)||o===0){const l=new j(Math.round(i.x),Math.round(i.y),i.z);if(l.x!==i.x||l.y!==i.y){const c=e.getScreenPosition(l);this._screenLocation.assign(n),c&&(this._screenLocation.z=c.z)}else this._screenLocation.assign(n)}else this._screenLocation.assign(n);this._screenLocation.x=Math.round(this._screenLocation.x),this._screenLocation.y=Math.round(this._screenLocation.y)}return this._screenLocation}get locationChanged(){return this._locationChanged}}class qw{constructor(){this._sprites=[],this._updateId1=-1,this._updateId2=-1,this._isEmpty=!1}get spriteCount(){return this._sprites.length}get isEmpty(){return this._isEmpty}dispose(){this.setSpriteCount(0)}addSprite(t){this._sprites.push(t)}getSprite(t){return this._sprites[t]}get sprites(){return this._sprites}needsUpdate(t,e){return t===this._updateId1&&e===this._updateId2?!1:(this._updateId1=t,this._updateId2=e,!0)}setSpriteCount(t){if(t<this._sprites.length){let e=t;for(;e<this._sprites.length;){const s=this._sprites[e];s&&s.dispose(),e++}this._sprites.splice(t,this._sprites.length-t)}this._isEmpty=!this._sprites.length}}class Qw{constructor(t){this._location=new Xw(t),this._sprites=new qw}get location(){return this._location}get sprites(){return this._sprites}dispose(){this._location&&(this._location.dispose(),this._location=null),this._sprites&&(this._sprites.dispose(),this._sprites=null)}get objectId(){return this._objectId}set objectId(t){this._objectId=t}}const Zh=class Zh{constructor(t){this._data=new Map,this._roomObjectVariableAccurateZ=t}dispose(){if(this._data){for(const[t,e]of this._data.entries())e&&(this._data.delete(t),e.dispose());this._data=null}}getObjectCache(t){let e=this._data.get(t);return e||(e=new Qw(this._roomObjectVariableAccurateZ),this._data.set(t,e)),e}removeObjectCache(t){const e=this._data.get(t);e&&(this._data.delete(t),e.dispose())}getSortableSpriteList(){const t=[];for(const e of this._data.values()){if(!e)continue;const s=e.sprites&&e.sprites.sprites;if(!(!s||!s.length)){for(const i of s)if(i&&i.sprite.spriteType!==Gr.ROOM_PLANE&&i.sprite.name!==""){const n=new zN;n.objectId=e.objectId,n.x=i.x,n.y=i.y,n.z=i.z,n.name=i.sprite.name||"",n.flipH=i.sprite.flipH,n.alpha=i.sprite.alpha,n.color=i.sprite.color.toString(),n.blendMode=i.sprite.blendMode.toString(),n.width=i.sprite.width,n.height=i.sprite.height,n.type=i.sprite.type,n.posture=i.sprite.posture;const o=this.isSkewedSprite(i.sprite);o&&(n.skew=i.sprite.direction%4===0?-.5:.5),(o||i.name.indexOf("%image.library.url%")>=0||i.name.indexOf("%group.badge.url%")>=0)&&n.width<=Zh.MAX_SIZE_FOR_AVG_COLOR&&n.height<=Zh.MAX_SIZE_FOR_AVG_COLOR&&i.sprite.name.indexOf("external_image_wallitem")===0&&(n.frame=!0),t.push(n)}}}return!t||!t.length?null:t}isSkewedSprite(t){return t.type?t.type.indexOf("external_image_wallitem")===0&&t.tag==="THUMBNAIL"||t.type.indexOf("guild_forum")===0&&t.tag==="THUMBNAIL":!1}getPlaneSortableSprites(){const t=[];for(const e of this._data.values())for(const s of e.sprites.sprites)s.sprite.spriteType===Gr.ROOM_PLANE&&t.push(s);return t}};Zh.MAX_SIZE_FOR_AVG_COLOR=200;let OI=Zh;const ta=class ta{static hex2rgb(t,e=[]){return e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(t&255)/255,e}static hex2rgba(t,e=[]){return e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(t&255)/255,e[3]=t&255,e}static rgb2hex(t){return(t[0]*255<<16)+(t[1]*255<<8)+(t[2]*255|0)}static rgba2hex(t){return(t[0]*255<<16)+(t[1]*255<<8)+(t[2]*255|0)+(t[3]|0)}static rgbStringToHex(t){const e=t.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);return"#"+ta.getHex(e[1])+ta.getHex(e[2])+ta.getHex(e[3])}static getHex(t){return isNaN(t)?"00":ta.HEX_DIGITS[(t-t%16)/16]+ta.HEX_DIGITS[t%16]}static int2rgb(t){t>>>=0;const e=t&255,s=(t&65280)>>>8;return"rgba("+[(t&16711680)>>>16,s,e,1].join(",")+")"}static rgbToHSL(t){const e=(t>>16&255)/255,s=(t>>8&255)/255,i=(t&255)/255,n=Math.max(e,s,i),o=Math.min(e,s,i),l=n-o;let c=0,u=0,h=0;l==0?c=0:n==e?s>i?c=60*(s-i)/l:c=60*(s-i)/l+360:n==s?c=60*(i-e)/l+120:n==i&&(c=60*(e-s)/l+240),u=.5*(n+o),l==0?h=0:u<=.5?h=l/u*.5:h=l/(1-u)*.5;const d=Math.round(c/360*255),g=Math.round(h*255),E=Math.round(u*255);return(d<<16)+(g<<8)+E}static hslToRGB(t){let e,s,i,n,o;const l=(t>>16&255)/255,c=(t>>8&255)/255,u=(t&255)/255;let h=0,d=0,g=0;c>0?(e=0,s=0,u<.5?e=u*(1+c):e=u+c-u*c,s=2*u-e,i=l+1/3,n=l,o=l-1/3,i<0?i=i+1:i>1&&i--,n<0?n=n+1:n>1&&n--,o<0?o=o+1:o>1&&o--,i*6<1?h=s+(e-s)*6*i:i*2<1?h=e:i*3<2?h=s+(e-s)*6*(2/3-i):h=s,n*6<1?d=s+(e-s)*6*n:n*2<1?d=e:n*3<2?d=s+(e-s)*6*(2/3-n):d=s,o*6<1?g=s+(e-s)*6*o:o*2<1?g=e:o*3<2?g=s+(e-s)*6*(2/3-o):g=s):(h=u,d=u,g=u);const E=Math.round(h*255),m=Math.round(d*255),I=Math.round(g*255);return(E<<16)+(m<<8)+I}static rgb2xyz(t){let e=(t>>16&255)/255,s=(t>>8&255)/255,i=(t>>0&255)/255;return e>.04045?e=Math.pow((e+.055)/1.055,2.4):e=e/12.92,s>.04045?s=Math.pow((s+.055)/1.055,2.4):s=s/12.92,i>.04045?i=Math.pow((i+.055)/1.055,2.4):i=i/12.92,e=e*100,s=s*100,i=i*100,new j(e*.4124+s*.3576+i*.1805,e*.2126+s*.7152+i*.0722,e*.0193+s*.1192+i*.9505)}static xyz2CieLab(t){let e=t.x/95.047,s=t.y/100,i=t.z/108.883;return e>.008856?e=Math.pow(e,1/3):e=7.787*e+16/116,s>.008856?s=Math.pow(s,1/3):s=7.787*s+16/116,i>.008856?i=Math.pow(i,1/3):i=7.787*i+16/116,new j(116*s-16,500*(e-s),200*(s-i))}static rgb2CieLab(t){return ta.xyz2CieLab(ta.rgb2xyz(t))}static colorize(t,e){if(e===4294967295)return t;let s=e>>16&255,i=e>>8&255,n=e&255;return s=(t>>16&255)*s/255,i=(t>>8&255)*i/255,n=(t&255)*n/255,(t&&4278190080)|s<<16|i<<8|n}};ta.HEX_DIGITS=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];let ii=ta;class WC{constructor(t){t<0&&(t=0),this._reservedNumbers=[],this._freeNumbers=[];let e=0;for(;e<t;)this._freeNumbers.push(e),e++}dispose(){this._reservedNumbers=null,this._freeNumbers=null}reserveNumber(){if(this._freeNumbers.length>0){const t=this._freeNumbers.pop();return this._reservedNumbers.push(t),t}return-1}freeNumber(t){const e=this._reservedNumbers.indexOf(t);e>=0&&(this._reservedNumbers.splice(e,1),this._freeNumbers.push(t))}}class Jw{static getFlipHBitmapData(t){if(!t)return null;const e=Ee.createRenderTexture(t.width,t.height),s=new sr;return s.scale(-1,1),s.translate(t.width,0),ws.instance.renderer.render(new ms(t),{renderTexture:e,clear:!0,transform:s}),e}static getFlipVBitmapData(t){if(!t)return null;const e=new sr;e.scale(1,-1),e.translate(0,t.height);const s=new lg;return s.beginTextureFill({texture:t,matrix:e}).drawRect(0,0,t.width,t.height).endFill(),Ee.generateTexture(s)}static getFlipHVBitmapData(t){if(!t)return null;const e=new sr;e.scale(-1,-1),e.translate(t.width,t.height);const s=new lg;return s.beginTextureFill({texture:t,matrix:e}).drawRect(0,0,t.width,t.height).endFill(),Ee.generateTexture(s)}}const zt=class zt{static init(t,e){zt._currentDelta=0,zt._startDelayMs=t,zt._effectDurationMs=e,zt._initializationTimeMs=Pt(),zt._state=zt.STATE_START_DELAY}static turnVisualizationOn(){if(zt._state===zt.STATE_NOT_INITIALIZED||zt._state===zt.STATE_OVER)return;const t=Pt()-zt._initializationTimeMs;if(t>zt._startDelayMs+zt._effectDurationMs){zt._state=zt.STATE_OVER;return}if(zt._visualizationOn=!0,t<zt._startDelayMs){zt._state=zt.STATE_START_DELAY;return}zt._state=zt.STATE_RUNNING,zt._currentDelta=(t-zt._startDelayMs)/zt._effectDurationMs}static turnVisualizationOff(){zt._visualizationOn=!1}static isVisualizationOn(){return zt._visualizationOn&&zt.isRunning()}static isRunning(){return zt._state===zt.STATE_START_DELAY||zt._state===zt.STATE_RUNNING}static getDelta(t=0,e=1){return Math.min(Math.max(zt._currentDelta,t),e)}static get totalRunningTime(){return zt._startDelayMs+zt._effectDurationMs}};zt.STATE_NOT_INITIALIZED=0,zt.STATE_START_DELAY=1,zt.STATE_RUNNING=2,zt.STATE_OVER=3,zt._state=zt.STATE_NOT_INITIALIZED,zt._visualizationOn=!1,zt._currentDelta=0,zt._initializationTimeMs=0,zt._startDelayMs=20*1e3,zt._effectDurationMs=2e3;let Br=zt;const ea=class ea{constructor(t,e,s,i=null){this._updateId=0,this._scale=1,this._x_scale=1,this._y_scale=1,this._z_scale=1,this._x_scale_internal=1,this._y_scale_internal=1,this._z_scale_internal=1,this._clipNear=-500,this._clipFar=500,this._displacements=null,this.scale=t,this._x=new j,this._y=new j,this._z=new j,this._directionAxis=new j,this._location=new j,this._direction=new j,this._depth=new j,this._x_scale_internal=1,this._y_scale_internal=1,this.x_scale=1,this.y_scale=1,this._z_scale_internal=Math.sqrt(1/2)/Math.sqrt(3/4),this.z_scale=1,this.location=new j(s.x,s.y,s.z),this.direction=new j(e.x,e.y,e.z),i!=null?this.setDepthVector(i):this.setDepthVector(e),this._displacements=new Map}static getIntersectionVector(t,e,s,i){const n=j.dotProduct(e,i);if(Math.abs(n)<1e-5)return null;const o=j.dif(t,s),l=-j.dotProduct(i,o)/n;return j.sum(t,j.product(e,l))}get updateId(){return this._updateId}get scale(){return this._scale/Math.sqrt(.5)}set scale(t){t<=1&&(t=1),t=t*Math.sqrt(.5),t!=this._scale&&(this._scale=t,this._updateId++)}get directionAxis(){return this._directionAxis}get location(){return this._location.assign(this._loc),this._location.x=this._location.x*this._x_scale,this._location.y=this._location.y*this._y_scale,this._location.z=this._location.z*this._z_scale,this._location}set location(t){if(t==null)return;this._loc==null&&(this._loc=new j);const e=this._loc.x,s=this._loc.y,i=this._loc.z;this._loc.assign(t),this._loc.x=this._loc.x/this._x_scale,this._loc.y=this._loc.y/this._y_scale,this._loc.z=this._loc.z/this._z_scale,(this._loc.x!=e||this._loc.y!=s||this._loc.z!=i)&&this._updateId++}get direction(){return this._direction}set direction(t){let e,s,i,n,o;if(t==null)return;this._dir==null&&(this._dir=new j);const l=this._dir.x,c=this._dir.y,u=this._dir.z;this._dir.assign(t),this._direction.assign(t),(this._dir.x!=l||this._dir.y!=c||this._dir.z!=u)&&this._updateId++;const h=new j(0,1,0),d=new j(0,0,1),g=new j(1,0,0),E=t.x/180*Math.PI,m=t.y/180*Math.PI,I=t.z/180*Math.PI,p=Math.cos(E),T=Math.sin(E),R=j.sum(j.product(h,p),j.product(g,-T)),S=new j(d.x,d.y,d.z),b=j.sum(j.product(h,T),j.product(g,p)),N=Math.cos(m),P=Math.sin(m),B=new j(R.x,R.y,R.z),F=j.sum(j.product(S,N),j.product(b,P)),w=j.sum(j.product(S,-P),j.product(b,N));I!=0?(e=Math.cos(I),s=Math.sin(I),i=j.sum(j.product(B,e),j.product(F,s)),n=j.sum(j.product(B,-s),j.product(F,e)),o=new j(w.x,w.y,w.z),this._x.assign(i),this._y.assign(n),this._z.assign(o),this._directionAxis.assign(this._z)):(this._x.assign(B),this._y.assign(F),this._z.assign(w),this._directionAxis.assign(this._z))}set x_scale(t){this._x_scale!=t*this._x_scale_internal&&(this._x_scale=t*this._x_scale_internal,this._updateId++)}set y_scale(t){this._y_scale!=t*this._y_scale_internal&&(this._y_scale=t*this._y_scale_internal,this._updateId++)}set z_scale(t){this._z_scale!=t*this._z_scale_internal&&(this._z_scale=t*this._z_scale_internal,this._updateId++)}dispose(){this._x=null,this._y=null,this._z=null,this._loc=null,this._dir=null,this._directionAxis=null,this._location=null,this._displacements!=null&&(this._displacements.clear(),this._displacements=null)}setDisplacement(t,e){let s,i;t==null||e==null||this._displacements!=null&&(s=Math.trunc(Math.round(t.x))+"_"+Math.trunc(Math.round(t.y))+"_"+Math.trunc(Math.round(t.z)),this._displacements.delete(s),i=new j,i.assign(e),this._displacements.set(s,i),this._updateId++)}getDisplacenent(t){let e;return this._displacements!=null?(e=Math.trunc(Math.round(t.x))+"_"+Math.trunc(Math.round(t.y))+"_"+Math.trunc(Math.round(t.z)),this._displacements.get(e)):null}setDepthVector(t){let e,s,i;const n=new j(0,1,0),o=new j(0,0,1),l=new j(1,0,0),c=t.x/180*Math.PI,u=t.y/180*Math.PI,h=t.z/180*Math.PI,d=Math.cos(c),g=Math.sin(c),E=j.sum(j.product(n,d),j.product(l,-g)),m=new j(o.x,o.y,o.z),I=j.sum(j.product(n,g),j.product(l,d)),p=Math.cos(u),T=Math.sin(u),R=new j(E.x,E.y,E.z),S=j.sum(j.product(m,p),j.product(I,T)),b=j.sum(j.product(m,-T),j.product(I,p));h!=0?(e=Math.cos(h),s=Math.sin(h),j.sum(j.product(R,e),j.product(S,s)),j.sum(j.product(R,-s),j.product(S,e)),i=new j(b.x,b.y,b.z),this._depth.assign(i)):this._depth.assign(b),this._updateId++}adjustLocation(t,e){if(t==null||this._z==null)return;const s=j.product(this._z,-e),i=new j(t.x+s.x,t.y+s.y,t.z+s.z);this.location=i}getCoordinatePosition(t){if(t==null)return null;const e=j.scalarProjection(t,this._x),s=j.scalarProjection(t,this._y),i=j.scalarProjection(t,this._z);return new j(e,s,i)}getScreenPosition(t){let e=j.dif(t,this._loc);e.x=e.x*this._x_scale,e.y=e.y*this._y_scale,e.z=e.z*this._z_scale;let s=j.scalarProjection(e,this._depth);if(s<this._clipNear||s>this._clipFar)return null;let i=j.scalarProjection(e,this._x),n=-j.scalarProjection(e,this._y);i=i*this._scale,n=n*this._scale;const o=this.getDisplacenent(t);return o!=null&&(e=j.dif(t,this._loc),e.add(o),e.x=e.x*this._x_scale,e.y=e.y*this._y_scale,e.z=e.z*this._z_scale,s=j.scalarProjection(e,this._depth)),e.x=i,e.y=n,e.z=s,e}getScreenPoint(t){const e=this.getScreenPosition(t);return e==null?null:new wt(e.x,e.y)}getPlanePosition(t,e,s,i){let n,o;const l=t.x/this._scale,c=-t.y/this._scale,u=j.product(this._x,l);u.add(j.product(this._y,c));const h=new j(this._loc.x*this._x_scale,this._loc.y*this._y_scale,this._loc.z*this._z_scale);h.add(u);const d=this._z,g=new j(e.x*this._x_scale,e.y*this._y_scale,e.z*this._z_scale),E=new j(s.x*this._x_scale,s.y*this._y_scale,s.z*this._z_scale),m=new j(i.x*this._x_scale,i.y*this._y_scale,i.z*this._z_scale),I=j.crossProduct(E,m),p=new j;return p.assign(ea.getIntersectionVector(h,d,g,I)),p!=null?(p.subtract(g),n=j.scalarProjection(p,s)/E.length*s.length,o=j.scalarProjection(p,i)/m.length*i.length,new wt(n,o)):null}performZoom(){this.isZoomedIn()?this.scale=ea.SCALE_ZOOMED_OUT:this.scale=ea.SCALE_ZOOMED_IN}isZoomedIn(){return this.scale==ea.SCALE_ZOOMED_IN}performZoomOut(){this.scale=ea.SCALE_ZOOMED_OUT}performZoomIn(){this.scale=ea.SCALE_ZOOMED_IN}};ea.SCALE_ZOOMED_IN=64,ea.SCALE_ZOOMED_OUT=32;let dl=ea;const td=class td{static makeRoomPreviewerId(t){return(t&65535)+td.PREVIEW_ROOM_ID_BASE}static isRoomPreviewerId(t){return t>=td.PREVIEW_ROOM_ID_BASE}};td.PREVIEW_ROOM_ID_BASE=2147418112;let wn=td;const Jr=class Jr{static init(t,e){this._SafeStr_4513=0,this._SafeStr_4515=t,this._SafeStr_4516=e,this._SafeStr_4514=Pt(),this._SafeStr_448=1}static turnVisualizationOn(){if(this._SafeStr_448===0||this._SafeStr_448===3)return;this._SafeStr_4524||(this._SafeStr_4524=setTimeout(()=>this.turnVisualizationOff(),this._SafeStr_4516));const t=Pt()-this._SafeStr_4514;if(t>this._SafeStr_4515+this._SafeStr_4516){this._SafeStr_448=3;return}if(this._SafeStr_4512=!0,t<this._SafeStr_4515){this._SafeStr_448=1;return}this._SafeStr_448=2,this._SafeStr_4513=(t-this._SafeStr_4515)/this._SafeStr_4516}static turnVisualizationOff(){this._SafeStr_4512=!1,clearTimeout(this._SafeStr_4524),this._SafeStr_4524=null}static isVisualizationOn(){return this._SafeStr_4512&&this.isRunning()}static isRunning(){return this._SafeStr_448===1||this._SafeStr_448===2}};Jr.STATE_NOT_INITIALIZED=0,Jr.STATE_START_DELAY=1,Jr.STATE_RUNNING=2,Jr.STATE_OVER=3,Jr._SafeStr_448=0,Jr._SafeStr_4512=!1,Jr._SafeStr_4513=0,Jr._SafeStr_4514=0,Jr._SafeStr_4515=2e4,Jr._SafeStr_4516=5e3;let zd=Jr;const On=class On{static init(t,e){this._SafeStr_4513=0,this._SafeStr_4515=t,this._SafeStr_4516=e,this._SafeStr_4514=Pt(),this._SafeStr_448=1}static turnVisualizationOn(){if(this._SafeStr_448===0||this._SafeStr_448===3)return;this._SafeStr_4524||(this._SafeStr_4524=setTimeout(()=>this.turnVisualizationOff(),this._SafeStr_4516));const t=Pt()-this._SafeStr_4514;if(t>this._SafeStr_4515+this._SafeStr_4516){this._SafeStr_448=3;return}if(this._SafeStr_4512=!0,t<this._SafeStr_4515){this._SafeStr_448=1;return}this._SafeStr_448=2,this._SafeStr_4513=(t-this._SafeStr_4515)/this._SafeStr_4516}static turnVisualizationOff(){this._SafeStr_4512=!1,clearTimeout(this._SafeStr_4524),this._SafeStr_4524=null}static isVisualizationOn(){return this._SafeStr_4512&&this.isRunning()}static isRunning(){return this._SafeStr_448===1||this._SafeStr_448===2}};On.STATE_NOT_INITIALIZED=0,On.STATE_START_DELAY=1,On.STATE_RUNNING=2,On.STATE_OVER=3,On._SafeStr_448=0,On._SafeStr_4512=!1,On._SafeStr_4514=0,On._SafeStr_4515=2e4,On._SafeStr_4516=5e3;let ah=On;class $w{static hex2int(t){return parseInt(t,16)}static inkToBlendMode(t){return t=="ADD"||t==33?lo.ADD:t=="SUBTRACT"?lo.SUBTRACT:t=="DARKEN"?lo.DARKEN:lo.NORMAL}}class Ug extends ms{constructor(t=null){super(t),this._offsetX=0,this._offsetY=0,this._tag="",this._alphaTolerance=128,this._varyingDepth=!1,this._clickHandling=!1,this._pairedSpriteId=-1,this._pairedSpriteUpdateCounter=-1}needsUpdate(t,e){return this._pairedSpriteId===t&&this._pairedSpriteUpdateCounter===e?!1:(this._pairedSpriteId=t,this._pairedSpriteUpdateCounter=e,!0)}calculateVertices(){this.texture.orig&&super.calculateVertices()}setTexture(t){t||(t=Es.EMPTY),t!==this.texture&&(t===Es.EMPTY&&(this._pairedSpriteId=-1,this._pairedSpriteUpdateCounter=-1),this.texture=t)}containsPoint(t){return Ug.containsPoint(this,t)}static containsPoint(t,e){if(!t||!e||t.alphaTolerance>255||!(t instanceof ms))return!1;if(t.texture===Es.EMPTY||t.blendMode!==lo.NORMAL)return;const s=t.texture,i=s.baseTexture;if(!s||!i||!i.valid)return!1;const n=e.x*t.scale.x,o=e.y*t.scale.y;if(!t.getLocalBounds().contains(n,o)||!i.hitMap&&!Ug.generateHitMap(i))return!1;const l=i.hitMap;let c=n+s.frame.x,u=o+s.frame.y;s.trim&&(c-=s.trim.x,u-=s.trim.y),c=Math.round(c)*i.resolution,u=Math.round(u)*i.resolution;const h=c+u*i.realWidth,d=h%32,g=h/32|0;return(l[g]&1<<d)!==0}static generateHitMap(t){if(!t)return!1;const e=new Es(t),s=new ms(e),i=Ee.getPixels(s),n=t.width,o=t.height,l=new Uint32Array(Math.ceil(n*o/32)),c=Fn.MATCH_OPAQUE_PIXELS;for(let u=0;u<n*o;u++){const h=u%32,d=u/32|0;i[u*4+3]>=c&&(l[d]=l[d]|1<<h)}return t.hitMap=l,s.destroy(),e.destroy(),!0}get offsetX(){return this._offsetX}set offsetX(t){this._offsetX=t}get offsetY(){return this._offsetY}set offsetY(t){this._offsetY=t}get tag(){return this._tag}set tag(t){this._tag=t}get alphaTolerance(){return this._alphaTolerance}set alphaTolerance(t){this._alphaTolerance=t}get varyingDepth(){return this._varyingDepth}set varyingDepth(t){this._varyingDepth=t}get clickHandling(){return this._clickHandling}set clickHandling(t){this._clickHandling=t}}class Zw{constructor(){this._objectId="",this._spriteTag=""}get objectId(){return this._objectId}set objectId(t){this._objectId=t}get spriteTag(){return this._spriteTag}set spriteTag(t){this._spriteTag=t}}const km=class km{constructor(){this._name="",this._sprite=null,this._x=0,this._y=0,this._z=0}dispose(){this._z=-km.Z_INFINITY,this._sprite=null}get name(){return this._name}set name(t){this._name=t}get sprite(){return this._sprite}set sprite(t){this._sprite=t}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}get z(){return this._z}set z(t){this._z=t}};km.Z_INFINITY=1e8;let CI=km;class t1{constructor(t,e,s,i,n){this._SafeStr_4507=!1,this._rotation=0,this._rotationOrigin=null,this._rotationRodLength=0,this._SafeStr_795=0,this._id=e,this._container=t,this._geometry=new dl(n,new j(-135,30,0),new j(11,11,5),new j(-135,.5,0)),this._animationFPS=Et.instance.getConfiguration("system.fps.animation",24),this._renderTimestamp=0,this._totalTimeRunning=0,this._lastFrame=0,this._master=null,this._display=null,this._mask=null,this._sortableSprites=[],this._spriteCount=0,this._activeSpriteCount=0,this._spritePool=[],this._skipObjectUpdate=!1,this._runningSlow=!1,this._width=0,this._height=0,this._renderedWidth=0,this._renderedHeight=0,this._screenOffsetX=0,this._screenOffsetY=0,this._mouseLocation=new wt,this._mouseOldX=0,this._mouseOldY=0,this._mouseCheckCount=0,this._mouseSpriteWasHit=!1,this._mouseActiveObjects=new Map,this._eventCache=new Map,this._eventId=0,this._scale=1,this._restrictsScaling=!1,this._noSpriteVisibilityChecking=!1,this._usesExclusionRectangles=!1,this._usesMask=!0,this._canvasUpdated=!1,this._objectCache=new OI(this._container.roomObjectVariableAccurateZ),this._mouseListener=null,this.setupCanvas(),this.initialize(s,i)}setupCanvas(){if(this._master||(this._master=new Xe,this._master.interactiveChildren=!1),!this._display){const t=new hn;this._master.addChild(t),this._display=t}}dispose(){if(this.cleanSprites(0,!0),this._geometry&&(this._geometry.dispose(),this._geometry=null),this._mask&&(this._mask=null),this._objectCache&&(this._objectCache.dispose(),this._objectCache=null),this._master){for(;this._master.children.length;)this._master.removeChildAt(0).destroy();this._master.parent&&this._master.parent.removeChild(this._master),this._master.destroy(),this._master=null}if(this._display=null,this._sortableSprites=[],this._mouseActiveObjects&&(this._mouseActiveObjects.clear(),this._mouseActiveObjects=null),this._spritePool){for(const t of this._spritePool)this.cleanSprite(t,!0);this._spritePool=[]}this._eventCache&&(this._eventCache.clear(),this._eventCache=null),this._mouseListener=null}initialize(t,e){if(t=t<1?1:t,e=e<1?1:e,this._usesMask&&(this._mask?this._mask.clear().beginFill(16711680).drawRect(0,0,t,e).endFill():(this._mask=new lg().beginFill(16711680).drawRect(0,0,t,e).endFill(),this._master&&(this._master.addChild(this._mask),this._display&&(this._display.mask=this._mask)))),this._master){if(this._master.hitArea){const s=this._master.hitArea;s.width=t,s.height=e}else this._master.hitArea=new Or(0,0,t,e);if(this._master.filterArea){const s=this._master.filterArea;s.width=t,s.height=e}else this._master.filterArea=new Or(0,0,t,e)}this._width=t,this._height=e}setMask(t){t&&!this._usesMask?(this._usesMask=!0,this._mask&&this._mask.parent!==this._master&&(this._master.addChild(this._mask),this._display.mask=this._mask)):!t&&this._usesMask&&(this._usesMask=!1,this._mask&&this._mask.parent===this._master&&(this._master.removeChild(this._mask),this._display.mask=null))}setScale(t,e=null,s=null,i=!1,n=!1){!this._master||!this._display||this._restrictsScaling&&!i||(e||(e=new wt(this._width/2,this._height/2)),s||(s=e),e=this._display.toLocal(e),n?this._scale*=t:this._scale=t,this.screenOffsetX=s.x-e.x*this._scale,this.screenOffsetY=s.y-e.y*this._scale)}render(t,e=!1){if(this._canvasUpdated=!1,this._totalTimeRunning+=fi().deltaTime,this._totalTimeRunning===this._renderTimestamp||(t===-1&&(t=this._renderTimestamp+1),!this._container||!this._geometry))return;(this._width!==this._renderedWidth||this._height!==this._renderedHeight)&&(e=!0),(this._display.x!==this._screenOffsetX||this._display.y!==this._screenOffsetY)&&(this._display.position.set(this._screenOffsetX,this._screenOffsetY),e=!0),this._display.scale.x!==this._scale&&(this._display.scale.set(this._scale),e=!0),this.doMagic();const s=Math.round(this._totalTimeRunning/(60/this._animationFPS));let i=!1;s!==this._lastFrame&&(this._lastFrame=s,i=!0);let n=0;const o=this._container.objects;if(o.size)for(const c of o.values())c&&(n=n+this.renderObject(c,c.instanceId.toString(),t,e,i,n));this._sortableSprites.sort((c,u)=>u.z-c.z),n<this._sortableSprites.length&&this._sortableSprites.splice(n);let l=0;for(;l<n;){const c=this._sortableSprites[l];c&&c.sprite&&this.renderSprite(l,c),l++}this.cleanSprites(n),(e||i)&&(this._canvasUpdated=!0),this._renderTimestamp=this._totalTimeRunning,this._renderedWidth=this._width,this._renderedHeight=this._height}skipSpriteVisibilityChecking(){this._noSpriteVisibilityChecking=!0,this.render(-1,!0)}resumeSpriteVisibilityChecking(){this._noSpriteVisibilityChecking=!1}getSortableSpriteList(){return this._objectCache.getSortableSpriteList()}getPlaneSortableSprites(){return this._objectCache.getPlaneSortableSprites()}removeFromCache(t){this._objectCache.removeObjectCache(t)}renderObject(t,e,s,i,n,o){if(!t)return 0;const l=t.visualization;if(!l)return this.removeFromCache(e),0;const c=this.getCacheItem(e);c.objectId=t.instanceId;const u=c.location,h=c.sprites,d=u.updateLocation(t,this._geometry);if(!d)return this.removeFromCache(e),0;if(n&&l.update(this._geometry,s,!h.isEmpty||i,this._skipObjectUpdate&&this._runningSlow),u.locationChanged&&(i=!0),!h.needsUpdate(l.instanceId,l.updateSpriteCounter)&&!i)return h.spriteCount;let g=d.x,E=d.y,m=d.z;g>0?m=m+g*12e-8:m=m+-g*12e-8,g=g+Math.trunc(this._width/2),E=E+Math.trunc(this._height/2);let I=0;for(const p of l.sprites.values()){if(!p||!p.visible)continue;const T=p.texture,R=T&&T.baseTexture;if(!T||!R)continue;const S=g+p.offsetX+this._screenOffsetX,b=E+p.offsetY+this._screenOffsetY;if(p.flipH){const P=g+-(T.width+-p.offsetX)+this._screenOffsetX;if(!this.isSpriteVisible(P,b,T.width,T.height))continue}else if(p.flipV){const P=E+-(T.height+-p.offsetY)+this._screenOffsetY;if(!this.isSpriteVisible(S,P,T.width,T.height))continue}else if(!this.isSpriteVisible(S,b,T.width,T.height))continue;let N=h.getSprite(I);N||(N=new CI,h.addSprite(N),this._sortableSprites.push(N),N.name=e),N.sprite=p,(p.spriteType===Gr.AVATAR||p.spriteType===Gr.AVATAR_OWN)&&(N.sprite.libraryAssetName="avatar_"+t.id),N.x=S-this._screenOffsetX,N.y=b-this._screenOffsetY,N.z=m+p.relativeDepth+37e-12*o,I++,o++}return h.setSpriteCount(I),this._canvasUpdated=!0,I}getExtendedSprite(t){if(t<0||t>=this._spriteCount)return null;const e=this._display.getChildAt(t);return e||null}getExtendedSpriteIdentifier(t){return t?t.name:""}renderSprite(t,e){if(t>=this._spriteCount)return this.createAndAddSprite(e),!0;if(!e)return!1;const s=e.sprite,i=this.getExtendedSprite(t);if(!s||!i)return!1;if(i.varyingDepth!==s.varyingDepth)return i.varyingDepth&&!s.varyingDepth?(this._display.removeChildAt(t),this._spritePool.push(i),this.renderSprite(t,e)):(this.createAndAddSprite(e,t),!0);if(i.needsUpdate(s.id,s.updateCounter)||Br.isVisualizationOn()){i.tag=s.tag,i.alphaTolerance=s.alphaTolerance,i.name=e.name,i.varyingDepth=s.varyingDepth,i.clickHandling=s.clickHandling,i.filters=s.filters;const n=s.alpha/255;i.alpha!==n&&(i.alpha=n),i.tint!==s.color&&(i.tint=s.color),i.blendMode!==s.blendMode&&(i.blendMode=s.blendMode),i.texture!==s.texture&&i.setTexture(s.texture),s.updateContainer&&(i.children.length===1&&i.removeChildAt(0),i.addChild(s.container),s.updateContainer=!1),s.flipH?i.scale.x!==-1&&(i.scale.x=-1):i.scale.x!==1&&(i.scale.x=1),s.flipV?i.scale.y!==-1&&(i.scale.y=-1):i.scale.y!==1&&(i.scale.y=1),this.updateEnterRoomEffect(i,s)}return i.x!==e.x&&(i.x=e.x),i.y!==e.y&&(i.y=e.y),i.offsetX=s.offsetX,i.offsetY=s.offsetY,!0}createAndAddSprite(t,e=-1){const s=t.sprite;if(!s)return;let i=null;this._spritePool.length>0&&(i=this._spritePool.pop()),i||(i=new Ug),i.children.length&&i.removeChildren(),i.tag=s.tag,i.alphaTolerance=s.alphaTolerance,i.alpha=s.alpha/255,i.tint=s.color,i.x=t.x,i.y=t.y,i.offsetX=s.offsetX,i.offsetY=s.offsetY,i.name=s.name,i.varyingDepth=s.varyingDepth,i.clickHandling=s.clickHandling,i.blendMode=s.blendMode,i.filters=s.filters,i.setTexture(s.texture),s.updateContainer&&(i.addChild(s.container),s.updateContainer=!1),s.flipH&&(i.scale.x=-1),s.flipV&&(i.scale.y=-1),this.updateEnterRoomEffect(i,s),e<0||e>=this._spriteCount?(this._display.addChild(i),this._spriteCount++):this._display.addChildAt(i,e),this._activeSpriteCount++}cleanSprites(t,e=!1){if(this._display){if(t<0&&(t=0),t<this._activeSpriteCount||!this._activeSpriteCount){let s=this._spriteCount-1;for(;s>=t;)this.cleanSprite(this.getExtendedSprite(s),e),s--}this._activeSpriteCount=t}}updateEnterRoomEffect(t,e){if(!(!Br.isVisualizationOn()||!e))switch(e.spriteType){case Gr.AVATAR_OWN:return;case Gr.ROOM_PLANE:t.alpha=Br.getDelta(.9);return;case Gr.AVATAR:t.alpha=Br.getDelta(.5);return;default:t.alpha=Br.getDelta(.1)}}cleanSprite(t,e){t&&(e?(t.parent&&t.parent.removeChild(t),t.destroy({children:!0})):t.setTexture(null))}update(){this._mouseCheckCount,this._mouseCheckCount=0,this._eventId++}setMouseListener(t){this._mouseListener=t}getCacheItem(t){return this._objectCache.getObjectCache(t)}isSpriteVisible(t,e,s,i){return!!(this._noSpriteVisibilityChecking||(t=(t-this._screenOffsetX)*this._scale+this._screenOffsetX,e=(e-this._screenOffsetY)*this._scale+this._screenOffsetY,s=s*this._scale,i=i*this._scale,t<this._width&&t+s>=0&&e<this._height&&e+i>=0&&!this._usesExclusionRectangles))}handleMouseEvent(t,e,s,i,n,o,l){return t=t-this._screenOffsetX,e=e-this._screenOffsetY,this._mouseLocation.x=t/this._scale,this._mouseLocation.y=e/this._scale,this._mouseCheckCount>0&&s==at.MOUSE_MOVE?this._mouseSpriteWasHit:(this._mouseSpriteWasHit=this.checkMouseHits(Math.trunc(t/this._scale),Math.trunc(e/this._scale),s,i,n,o,l),this._mouseCheckCount++,this._mouseSpriteWasHit)}checkMouseHits(t,e,s,i=!1,n=!1,o=!1,l=!1){const c=[];let u=!1,h=null,d=this._activeSpriteCount-1;for(;d>=0;){const m=this.getExtendedSprite(d);if(m&&m.containsPoint(new wt(t-m.x,e-m.y))&&!(m.clickHandling&&(s===at.MOUSE_CLICK||s===at.DOUBLE_CLICK))){const I=this.getExtendedSpriteIdentifier(m);if(c.indexOf(I)===-1){const p=m.tag;let T=this._mouseActiveObjects.get(I);T&&T.spriteTag!==p&&(h=this.createMouseEvent(0,0,0,0,at.ROLL_OUT,T.spriteTag,i,n,o,l),this.bufferMouseEvent(h,I)),s===at.MOUSE_MOVE&&(!T||T.spriteTag!==p)?h=this.createMouseEvent(t,e,t-m.x,e-m.y,at.ROLL_OVER,p,i,n,o,l):(h=this.createMouseEvent(t,e,t-m.x,e-m.y,s,p,i,n,o,l),h.spriteOffsetX=m.offsetX,h.spriteOffsetY=m.offsetY),T||(T=new Zw,T.objectId=I,this._mouseActiveObjects.set(I,T)),T.spriteTag=p,(s!==at.MOUSE_MOVE||t!==this._mouseOldX||e!==this._mouseOldY)&&this.bufferMouseEvent(h,I),c.push(I)}u=!0}d--}const g=[];for(const m of this._mouseActiveObjects.keys())m&&g.push(m);let E=0;for(;E<g.length;){const m=g[E];c.indexOf(m)>=0&&(g[E]=null),E++}for(E=0;E<g.length;){const m=g[E];if(m!==null){const I=this._mouseActiveObjects.get(m);I&&this._mouseActiveObjects.delete(m);const p=this.createMouseEvent(0,0,0,0,at.ROLL_OUT,I.spriteTag,i,n,o,l);this.bufferMouseEvent(p,m)}E++}return this.processMouseEvents(),this._mouseOldX=t,this._mouseOldY=e,u}createMouseEvent(t,e,s,i,n,o,l,c,u,h){const d=t-this._width/2,g=e-this._height/2,E=`canvas_${this._id}`;return new pw(n,E+"_"+this._eventId,E,o,d,g,s,i,c,l,u,h)}bufferMouseEvent(t,e){!t||!this._eventCache||(this._eventCache.delete(e),this._eventCache.set(e,t))}processMouseEvents(){if(!(!this._container||!this._eventCache)){for(const[t,e]of this._eventCache.entries()){if(!this._eventCache)return;if(!e)continue;const s=this._container.getRoomObject(parseInt(t));if(s)if(this._mouseListener)this._mouseListener.processRoomCanvasMouseEvent(e,s,this._geometry);else{const i=s.mouseHandler;i&&i.mouseEvent(e,this._geometry)}}this._eventCache&&this._eventCache.clear()}}getDisplayAsTexture(){this._noSpriteVisibilityChecking=!0;const t=this._scale,e=this._screenOffsetX,s=this._screenOffsetY;this.setScale(1,null,null,!0),this._screenOffsetX=0,this._screenOffsetY=0,this.render(-1,!0),this._display.mask=null;const i=this._display.getBounds(),n=kn.create({width:this._display.width,height:this._display.height});return ws.instance.renderer.render(this._display,{renderTexture:n,clear:!0,transform:new sr(1,0,0,1,-i.x,-i.y)}),this._display.mask=this._mask,this._noSpriteVisibilityChecking=!1,this.setScale(t,null,null,!0),this._screenOffsetX=e,this._screenOffsetY=s,n}doMagic(){const t=this.geometry;if(this._rotation!==0){let e=this._effectDirection;t.direction=new j(e.x+this._rotation,e.y,e.z),e=t.direction,t.setDepthVector(new j(e.x,e.y,5));const s=new j;s.assign(this._rotationOrigin),s.x=s.x+this._rotationRodLength*Math.cos((e.x+180)/180*3.14159265358979)*Math.cos(e.y/180*3.14159265358979),s.y=s.y+this._rotationRodLength*Math.sin((e.x+180)/180*3.14159265358979)*Math.cos(e.y/180*3.14159265358979),s.z=s.z+this._rotationRodLength*Math.sin(e.y/180*3.14159265358979),t.location=s,this._effectLocation=new j,this._effectLocation.assign(s),this._effectDirection=new j,this._effectDirection.assign(t.direction)}if(ah.isVisualizationOn()&&!this._SafeStr_4507?this.changeShaking():!ah.isVisualizationOn()&&this._SafeStr_4507&&this.changeShaking(),zd.isVisualizationOn()&&this.changeRotation(),this._SafeStr_4507){this._SafeStr_795++;const e=this._effectDirection,s=j.sum(e,new j(Math.sin(this._SafeStr_795*5/180*3.14159265358979)*2,Math.sin(this._SafeStr_795/180*3.14159265358979)*5,Math.sin(this._SafeStr_795*10/180*3.14159265358979)*2));t.direction=s}else this._SafeStr_795=0,t.direction=this._effectDirection}changeShaking(){if(this._SafeStr_4507=!this._SafeStr_4507,this._SafeStr_4507){const t=this.geometry.direction;this._effectDirection=new j(t.x,t.y,t.z)}}changeRotation(){if(this._SafeStr_4507)return;const t=this.geometry;if(t){if(this._rotation===0){const e=t.location,s=t.directionAxis;this._effectLocation=new j,this._effectLocation.assign(e),this._effectDirection=new j,this._effectDirection.assign(t.direction);const i=dl.getIntersectionVector(e,s,new j(0,0,0),new j(0,0,1));i!==null&&(this._rotationOrigin=new j(i.x,i.y,i.z),this._rotationRodLength=j.dif(i,e).length,this._rotation=1);return}this._rotation=0,t.location=this._effectLocation,t.direction=this._effectDirection,t.setDepthVector(new j(this._effectDirection.x,this._effectDirection.y,5))}}moveLeft(){if(this._rotation!==0){this._rotation===1?this._rotation=-1:this._rotation=this._rotation-1;return}const t=this.geometry,e=(t.direction.x-90)/180*3.14159265358979;t.location=j.sum(t.location,new j(Math.cos(e)*Math.sqrt(2),Math.sin(e)*Math.sqrt(2)))}moveRight(){if(this._rotation!==0){this._rotation===-1?this._rotation=1:this._rotation=this._rotation+1;return}const t=this.geometry,e=(t.direction.x+90)/180*3.14159265358979;t.location=j.sum(t.location,new j(Math.cos(e)*Math.sqrt(2),Math.sin(e)*Math.sqrt(2)))}moveUp(){if(this._rotation!==0)return;const t=this.geometry,e=t.direction.x/180*3.14159265358979;t.location=j.sum(t.location,new j(Math.cos(e)*Math.sqrt(2),Math.sin(e)*Math.sqrt(2)))}moveDown(){if(this._rotation!==0)return;const t=this.geometry,e=(t.direction.x+180)/180*3.14159265358979;t.location=j.sum(t.location,new j(Math.cos(e)*Math.sqrt(2),Math.sin(e)*Math.sqrt(2)))}get id(){return this._id}get geometry(){return this._geometry}get master(){return this._master}get display(){return this._display}get screenOffsetX(){return this._screenOffsetX}set screenOffsetX(t){t=Math.trunc(t),this._mouseLocation.x=this._mouseLocation.x-(t-this._screenOffsetX),this._screenOffsetX=t}get screenOffsetY(){return this._screenOffsetY}set screenOffsetY(t){t=Math.trunc(t),this._mouseLocation.y=this._mouseLocation.y-(t-this._screenOffsetY),this._screenOffsetY=t}get scale(){return this._scale}get width(){return this._width*this._scale}get height(){return this._height*this._scale}get restrictsScaling(){return this._restrictsScaling}set restrictsScaling(t){this._restrictsScaling=t}get canvasUpdated(){return this._canvasUpdated}set canvasUpdated(t){this._canvasUpdated=t}}class e1{constructor(){this._objects=new Map,this._canvases=new Map,this._disposed=!1,this._roomObjectVariableAccurateZ=null}dispose(){if(!this._disposed){if(this._canvases){for(const[t,e]of this._canvases.entries())this._canvases.delete(t),e&&e.dispose();this._canvases=null}this._objects&&(this._objects=null),this._disposed=!0}}reset(){this._objects.clear()}getInstanceId(t){return t?t.instanceId:-1}getRoomObject(t){return this._objects.get(t)}addObject(t){t&&this._objects.set(this.getInstanceId(t),t)}removeObject(t){const e=this.getInstanceId(t);this._objects.delete(e);for(const s of this._canvases.values()){if(!s)continue;s.removeFromCache(e.toString())}}render(t,e=!1){if(!(!this._canvases||!this._canvases.size))for(const s of this._canvases.values())s&&s.render(t,e)}update(t,e=!1){if(!(!this._canvases||!this._canvases.size)){this.render(t,e);for(const s of this._canvases.values())s&&s.update()}}getCanvas(t){const e=this._canvases.get(t);return e||null}createCanvas(t,e,s,i){const n=this._canvases.get(t);if(n)return n.initialize(e,s),n.geometry&&(n.geometry.scale=i),n;const o=this.createSpriteCanvas(t,e,s,i);if(o)return this._canvases.set(t,o),o}createSpriteCanvas(t,e,s,i){return new t1(this,t,e,s,i)}removeCanvas(t){const e=this._canvases.get(t);e&&(this._canvases.delete(t),e.dispose())}get objects(){return this._objects}get disposed(){return this._disposed}get roomObjectVariableAccurateZ(){return this._roomObjectVariableAccurateZ}set roomObjectVariableAccurateZ(t){this._roomObjectVariableAccurateZ=t}}class s1{createRenderer(){return new e1}}class i1 extends Ar{constructor(t,e){super(),this._id=t,this._container=e,this._renderer=null,this._managers=new Map,this._updateCategories=[],this._model=new qN}onDispose(){this.removeAllManagers(),this.destroyRenderer(),this._container=null,this._model.dispose()}setRenderer(t){if(t!==this._renderer&&(this._renderer&&this.destroyRenderer(),this._renderer=t,!!this._renderer&&(this._renderer.reset(),this._managers.size)))for(const e of this._managers.values()){if(!e)continue;const s=e.objects;if(s.length)for(const i of s.getValues())i&&this._renderer.addObject(i)}}destroyRenderer(){this._renderer&&(this._renderer.dispose(),this._renderer=null)}getManager(t){const e=this._managers.get(t);return e||null}getManagerOrCreate(t){let e=this.getManager(t);return e||(e=this._container.createRoomObjectManager(t),e?(this._managers.set(t,e),e):null)}getTotalObjectsForManager(t){const e=this.getManager(t);return e?e.totalObjects:0}getRoomObject(t,e){const s=this.getManager(e);if(!s)return null;const i=s.getObject(t);return i||null}getRoomObjectsForCategory(t){const e=this.getManager(t);return e?e.objects.getValues():[]}getRoomObjectByIndex(t,e){const s=this.getManager(e);if(!s)return null;const i=s.getObjectByIndex(t);return i||null}createRoomObject(t,e,s,i){const n=this.getManagerOrCreate(i);if(!n)return null;const o=n.createObject(t,e,s);return o?(this._renderer&&this._renderer.addObject(o),o):null}createRoomObjectAndInitalize(t,e,s){return this._container?this._container.createRoomObjectAndInitalize(this._id,t,e,s):null}removeRoomObject(t,e){const s=this.getManager(e);if(!s)return;const i=s.getObject(t);i&&(i.tearDown(),this._renderer&&this._renderer.removeObject(i),s.removeObject(t))}removeAllManagers(){for(const t of this._managers.values())if(t){if(this._renderer){const e=t.objects;if(e.length)for(const s of e.getValues())s&&this._renderer.removeObject(s)}t.dispose()}this._managers.clear()}addUpdateCategory(t){this._updateCategories.indexOf(t)>=0||this._updateCategories.push(t)}removeUpdateCategory(t){const e=this._updateCategories.indexOf(t);e!==-1&&this._updateCategories.splice(e,1)}update(t,e=!1){for(const s of this._updateCategories){const i=this.getManager(s);if(!i)continue;const n=i.objects;if(n.length)for(const o of n.getValues()){if(!o)continue;const l=o.logic;l&&l.update(t)}}this._renderer&&this._renderer.update(t,e)}hasUninitializedObjects(){for(const t of this._managers.values())if(t){for(const e of t.objects.getValues())if(e&&!e.isReady)return!0}return!1}get id(){return this._id}get container(){return this._container}get renderer(){return this._renderer}get managers(){return this._managers}get model(){return this._model}}const ed=class ed{constructor(t,e,s,i,n,o,l){this._layerTags=[],this._primaryColor=t&16777215,this._secondaryColor=e&16777215,this._breed=s,this._tag=i>-1&&i<ed.COLOR_TAGS.length?ed.COLOR_TAGS[i]:"",this._id=n,this._isMaster=o,this._layerTags=l}get primaryColor(){return this._primaryColor}get secondaryColor(){return this._secondaryColor}get breed(){return this._breed}get tag(){return this._tag}get id(){return this._id}get isMaster(){return this._isMaster}get layerTags(){return this._layerTags}};ed.COLOR_TAGS=["Null","Black","White","Grey","Red","Orange","Pink","Green","Lime","Blue","Light-Blue","Dark-Blue","Yellow","Brown","Dark-Brown","Beige","Cyan","Purple","Gold"];let AI=ed;const Se=class Se{constructor(){this._stateEvents=null,this._sessionDataManager=null,this._waitingForSessionDataManager=!1,this._iconListener=null,this._collections=new Map,this._gifCollections=new Map,this._images=new Map,this._events=new Map,this._activeObjects={},this._activeObjectTypes=new Map,this._activeObjectTypeIds=new Map,this._objectTypeAdUrls=new Map,this._wallItems={},this._wallItemTypes=new Map,this._wallItemTypeIds=new Map,this._furniRevisions=new Map,this._pets={},this._petColors=new Map,this._objectAliases=new Map,this._objectOriginalNames=new Map,this._pendingContentTypes=[],this._dataInitialized=!1}initialize(t){this._stateEvents=t,this.setFurnitureData();for(const[e,s]of Dt.getValue("pet.types").entries())this._pets[s]=e}dispose(){}setSessionDataManager(t){this._sessionDataManager=t,this._waitingForSessionDataManager&&(this._waitingForSessionDataManager=!1,this.setFurnitureData())}loadFurnitureData(){this.setFurnitureData()}setFurnitureData(){if(!this._sessionDataManager){this._waitingForSessionDataManager=!0;return}const t=this._sessionDataManager.getAllFurnitureData(this);t&&(this._sessionDataManager.removePendingFurniDataListener(this),this.processFurnitureData(t),this._stateEvents.dispatchEvent(new kt(Se.LOADER_READY)))}processFurnitureData(t){if(t)for(const e of t){if(!e)continue;const s=e.id;let i=e.className;e.hasIndexedColor&&(i=i+"*"+e.colorIndex);const n=e.revision,o=e.adUrl;o&&o.length>0&&this._objectTypeAdUrls.set(i,o);let l=e.className;e.type===oc.FLOOR?(this._activeObjectTypes.set(s,i),this._activeObjectTypeIds.set(i,s),this._activeObjects[l]||(this._activeObjects[l]=1)):e.type===oc.WALL&&(l==="post.it"&&(i="post_it",l="post_it"),l==="post.it.vd"&&(i="post_it_vd",l="post_id_vd"),this._wallItemTypes.set(s,i),this._wallItemTypeIds.set(i,s),this._wallItems[l]||(this._wallItems[l]=1));const c=this._furniRevisions.get(l);n>c&&(this._furniRevisions.delete(l),this._furniRevisions.set(l,n))}}getFurnitureFloorNameForTypeId(t){const e=this._activeObjectTypes.get(t);return this.removeColorIndex(e)}getFurnitureWallNameForTypeId(t,e=null){let s=this._wallItemTypes.get(t);return s==="poster"&&e!==null&&(s=s+e),this.removeColorIndex(s)}getFurnitureFloorColorIndex(t){const e=this._activeObjectTypes.get(t);return e?this.getColorIndexFromName(e):-1}getFurnitureWallColorIndex(t){const e=this._wallItemTypes.get(t);return e?this.getColorIndexFromName(e):-1}getColorIndexFromName(t){if(!t)return-1;const e=t.indexOf("*");return e===-1?0:parseInt(t.substr(e+1))}removeColorIndex(t){if(!t)return null;const e=t.indexOf("*");return e===-1?t:t.substr(0,e)}getRoomObjectAdUrl(t){const e=this._objectTypeAdUrls.get(t);return e||""}getPetColorResult(t,e){const s=this._petColors.get(t);return s?s.get(e):null}getPetColorResultsForTag(t,e){const s=this._petColors.get(t),i=[];if(s)for(const n of s.values())n.tag===e&&i.push(n);return i}getCollection(t){if(!t)return null;const e=this._collections.get(t);if(!e){const s=Rr().getCollection(t);return s?(this._collections.set(t,s),s):null}return e}getGifCollection(t){return t&&this._gifCollections.get(t)||null}getImage(t){if(!t)return null;const e=this._images.get(t);if(!e)return null;const s=new Image;return s.src=e.src,s}addAssetToCollection(t,e,s,i=!0){const n=this.getCollection(t);return n?n.addAsset(e,s,i,0,0,!1,!1):!1}createGifCollection(t,e,s){if(!t||!e||!s)return null;const i=new _w(t,e,s);return this._gifCollections.set(t,i),i}createCollection(t,e){if(!t||!e)return null;const s=new hg(t,e);this._collections.set(s.name,s);const i=this._pets[s.name];if(i!==void 0){const n=s.getPaletteNames(),o=new Map;for(const l of n){const c=s.getPalette(l),u=t.palettes[l],h=c.primaryColor,d=c.secondaryColor,g=u.breed!==void 0?u.breed:0,E=u.colorTag!==void 0?u.colorTag:-1,m=u.master!==void 0?u.master:!1,I=u.tags!==void 0?u.tags:[];o.set(parseInt(l),new AI(h,d,g,E,l,m,I))}this._petColors.set(i,o)}}getPlaceholderName(t){switch(this.getCategoryForType(t)){case W.FLOOR:return Se.PLACE_HOLDER;case W.WALL:return Se.PLACE_HOLDER_WALL;default:return this._pets[t]!==void 0?Se.PLACE_HOLDER_PET:Se.PLACE_HOLDER_DEFAULT}}getCategoryForType(t){return t?this._activeObjects[t]!==void 0?W.FLOOR:this._wallItems[t]!==void 0?W.WALL:this._pets[t]!==void 0?W.UNIT:t.indexOf("poster")===0?W.WALL:t==="room"?W.ROOM:t===me.USER||t===me.PET||t===me.BOT||t===me.RENTABLE_BOT?W.UNIT:t===Se.TILE_CURSOR||t===Se.SELECTION_ARROW?W.CURSOR:W.MINIMUM:W.MINIMUM}getPetNameForType(t){return Dt.getValue("pet.types")[t]||null}isLoaderType(t){return t=me.getRealType(t),t!==ht.USER}downloadImage(t,e,s,i=null){let n=null,o=[];if(e&&e.indexOf(",")>=0&&(n=e,e=n.split(",")[0]),n?o=this.getAssetUrls(n,s,!0):o=this.getAssetUrls(e,s,!0),o&&o.length){const l=o[0],c=new Image;return c.src=l,c.onload=()=>{c.onerror=null,this._images.set([e,s].join("_"),c),this._iconListener.onRoomContentLoaded(t,[e,s].join("_"),!0)},c.onerror=()=>{c.onload=null,dt.error("Failed to download asset",l),this._iconListener.onRoomContentLoaded(t,[e,s].join("_"),!1)},!0}return!1}async downloadAsset(t,e){var i;const s=(i=this.getAssetUrls(t))==null?void 0:i[0];if(!(!s||!s.length)&&!(this._pendingContentTypes.indexOf(t)>=0||this.getOrRemoveEventDispatcher(t))){this._pendingContentTypes.push(t),this._events.set(t,e);try{const n=await fetch(s);let o="application/octet-stream";switch(n.headers.has("Content-Type")&&(o=n.headers.get("Content-Type")),o){case"application/octet-stream":{const l=new cg(await n.arrayBuffer());await this.processAsset(l.baseTexture,l.jsonFile);const c=this._events.get(t);if(!c)return;c.dispatchEvent(new co(co.RCLE_SUCCESS,t));break}default:throw new Error}}catch{e.dispatchEvent(new co(co.RCLE_FAILURE,t))}}}async processAsset(t,e){const s=e.spritesheet;if(!t||!s||!Object.keys(s).length){this.createCollection(e,null);return}const i=async()=>{const n=new PN(t,s);await n.parse(),this.createCollection(e,n)};t.valid?await i():await new Promise((n,o)=>{t.once("update",async()=>(await i(),n()))})}setAssetAliasName(t,e){this._objectAliases.set(t,e),this._objectOriginalNames.set(e,t)}getAssetAliasName(t){const e=this._objectAliases.get(t);return e||t}getAssetOriginalName(t){const e=this._objectOriginalNames.get(t);return e||t}getAssetUrls(t,e=null,s=!1){switch(t){case Se.PLACE_HOLDER:return[this.getAssetUrlWithGenericBase(Se.PLACE_HOLDER)];case Se.PLACE_HOLDER_WALL:return[this.getAssetUrlWithGenericBase(Se.PLACE_HOLDER_WALL)];case Se.PLACE_HOLDER_PET:return[this.getAssetUrlWithGenericBase(Se.PLACE_HOLDER_PET)];case Se.ROOM:return[this.getAssetUrlWithGenericBase("room")];case Se.TILE_CURSOR:return[this.getAssetUrlWithGenericBase(Se.TILE_CURSOR)];case Se.SELECTION_ARROW:return[this.getAssetUrlWithGenericBase(Se.SELECTION_ARROW)];default:{const i=this.getCategoryForType(t);if(i===W.FLOOR||i===W.WALL){const n=this.getAssetAliasName(t);let o=s?this.getAssetUrlWithFurniIconBase(n):this.getAssetUrlWithFurniBase(t);if(s){const l=e&&e!==""&&this._activeObjectTypeIds.has(n+"*"+e);o=o.replace(/%param%/gi,l?"_"+e:"")}return[o]}return i===W.UNIT?[this.getAssetUrlWithPetBase(t)]:null}}}getAssetIconUrl(t,e){let s=null,i=[];return t&&t.indexOf(",")>=0&&(s=t,t=s.split(",")[0]),s?i=this.getAssetUrls(s,e,!0):i=this.getAssetUrls(t,e,!0),i&&i.length?i[0]:null}getAssetUrlWithGenericBase(t){return Dt.getValue("generic.asset.url").replace(/%libname%/gi,t)}getAssetUrlWithFurniBase(t){return Dt.getValue("furni.asset.url").replace(/%libname%/gi,t)}getAssetUrlWithFurniIconBase(t){return Dt.getValue("furni.asset.icon.url").replace(/%libname%/gi,t)}getAssetUrlWithPetBase(t){return Dt.getValue("pet.asset.url").replace(/%libname%/gi,t)}setRoomObjectRoomId(t,e){const s=t&&t.model;s&&s.setValue(C.OBJECT_ROOM_ID,e)}getOrRemoveEventDispatcher(t,e=!1){const s=this._events.get(t);return e&&this._events.delete(t),s}setIconListener(t){this._iconListener=t}};Se.PLACE_HOLDER="place_holder",Se.PLACE_HOLDER_WALL="place_holder_wall",Se.PLACE_HOLDER_PET="place_holder_pet",Se.PLACE_HOLDER_DEFAULT=Se.PLACE_HOLDER,Se.ROOM="room",Se.TILE_CURSOR="tile_cursor",Se.SELECTION_ARROW="selection_arrow",Se.LOADER_READY="RCL_LOADER_READY",Se.MANDATORY_LIBRARIES=[Se.PLACE_HOLDER,Se.PLACE_HOLDER_WALL,Se.PLACE_HOLDER_PET,Se.ROOM,Se.TILE_CURSOR,Se.SELECTION_ARROW];let Qu=Se;class r1{constructor(){this._objects=new hs,this._objectsPerType=new hs}dispose(){this.removeAllObjects()}getObject(t){const e=this._objects.getValue(t);return e||null}getObjectByIndex(t){const e=this._objects.getWithIndex(t);return e||null}createObject(t,e,s){const i=new SI(t,e,s);return this.addObject(t,s,i)}addObject(t,e,s){if(this._objects.getValue(t))return s.dispose(),null;this._objects.add(t,s);const i=this.getTypeMap(e);return i&&i.add(t,s),s}removeObject(t){const e=this._objects.remove(t);if(e){const s=this.getTypeMap(e.type);s&&s.remove(e.id),e.dispose()}}removeAllObjects(){let t=0;for(;t<this._objects.length;){const e=this._objects.getWithIndex(t);e&&e.dispose(),t++}for(this._objects.reset(),t=0;t<this._objectsPerType.length;){const e=this._objectsPerType.getWithIndex(t);e&&e.dispose(),t++}this._objectsPerType.reset()}getTypeMap(t,e=!0){let s=this._objectsPerType.getValue(t);return!s&&e&&(s=new hs,this._objectsPerType.add(t,s)),s}get objects(){return this._objects}get totalObjects(){return this._objects.length}}const Wi=class Wi extends Fa{constructor(t,e,s){super(),this._state=Wi.ROOM_MANAGER_LOADED,this._rooms=new Map,this._contentLoader=null,this._updateCategories=[],this._listener=t,this._visualizationFactory=e,this._logicFactory=s,this._initialLoadList=[],this._pendingContentTypes=[],this._skipContentProcessing=!1,this._disposed=!1,this.onRoomContentLoadedEvent=this.onRoomContentLoadedEvent.bind(this),this.events.addEventListener(co.RCLE_SUCCESS,this.onRoomContentLoadedEvent),this.events.addEventListener(co.RCLE_FAILURE,this.onRoomContentLoadedEvent),this.events.addEventListener(co.RCLE_CANCEL,this.onRoomContentLoadedEvent)}onInit(){if(this._state>=Wi.ROOM_MANAGER_INITIALIZING||!this._contentLoader)return;const t=Qu.MANDATORY_LIBRARIES;for(const e of t)e&&this._initialLoadList.indexOf(e)===-1&&(this._contentLoader.downloadAsset(e,this.events),this._initialLoadList.push(e));this._state=Wi.ROOM_MANAGER_INITIALIZING}getRoomInstance(t){const e=this._rooms.get(t);return e||null}createRoomInstance(t){if(this._rooms.get(t))return null;const e=new i1(t,this);if(this._rooms.set(e.id,e),this._updateCategories.length)for(const s of this._updateCategories)e.addUpdateCategory(s);return e}removeRoomInstance(t){const e=this._rooms.get(t);return e?(this._rooms.delete(t),e.dispose(),!0):!1}createRoomObjectAndInitalize(t,e,s,i){const n=this.getRoomInstance(t);if(!n)return null;let o=s,l=s,c=s,u=null,h=!1;if(this._contentLoader.isLoaderType(s)){if(u=this._contentLoader.getCollection(s),!u&&(h=!0,this._contentLoader.downloadAsset(s,this.events),c=this._contentLoader.getPlaceholderName(s),u=this._contentLoader.getCollection(c),!u))return null;o=u.data.visualizationType,l=u.data.logicType}const d=n.createRoomObject(e,1,s,i);if(!d)return null;if(this._visualizationFactory){const g=this._visualizationFactory.getVisualization(o);if(!g)return n.removeRoomObject(e,i),null;g.asset=u;const E=this._visualizationFactory.getVisualizationData(c,o,u&&u.data||null);if(!E||!g.initialize(E))return n.removeRoomObject(e,i),null;d.setVisualization(g)}if(this._logicFactory){const g=this._logicFactory.getLogic(l);d.setLogic(g),g&&g.initialize(u&&u.data||null)}return h||(d.isReady=!0),this._contentLoader.setRoomObjectRoomId(d,t),d}reinitializeRoomObjectsByType(t){if(!t||!this._contentLoader||!this._visualizationFactory||!this._logicFactory)return;const e=this._contentLoader.getCollection(t);if(!e)return;const s=e.data.visualizationType,i=e.data.logicType,n=this._visualizationFactory.getVisualizationData(t,s,e.data);for(const o of this._rooms.values())if(o){for(const[l,c]of o.managers.entries())if(c)for(const u of c.objects.getValues()){if(!u||u.type!==t)continue;const h=this._visualizationFactory.getVisualization(s);if(h)if(h.asset=e,!n||!h.initialize(n))c.removeObject(u.id);else{u.setVisualization(h);const d=this._logicFactory.getLogic(i);u.setLogic(d),d&&d.initialize(e.data),u.isReady=!0,this._listener&&this._listener.objectInitialized(o.id,u.id,l)}else c.removeObject(u.id)}}}addUpdateCategory(t){if(!(this._updateCategories.indexOf(t)>=0)&&(this._updateCategories.push(t),!!this._rooms.size))for(const s of this._rooms.values())s&&s.addUpdateCategory(t)}removeUpdateCategory(t){const e=this._updateCategories.indexOf(t);if(e!==-1&&(this._updateCategories.splice(e,1),!!this._rooms.size))for(const s of this._rooms.values())s&&s.removeUpdateCategory(t)}setContentLoader(t){this._contentLoader&&this._contentLoader.dispose(),this._contentLoader=t}processPendingContentTypes(t){if(this._skipContentProcessing){this._skipContentProcessing=!1;return}for(;this._pendingContentTypes.length;){const e=this._pendingContentTypes.shift();if(!this._contentLoader.getCollection(e)){this._listener&&this._listener.initalizeTemporaryObjectsByType(e,!1),dt.log("Invalid Collection",e);continue}this.reinitializeRoomObjectsByType(e),this._listener&&this._listener.initalizeTemporaryObjectsByType(e,!0),this._initialLoadList.length>0&&this.removeFromInitialLoad(e)}}removeFromInitialLoad(t){if(!(!t||this._state===Wi.ROOM_MANAGER_ERROR))if(this._contentLoader||(this._state=Wi.ROOM_MANAGER_ERROR),this._contentLoader.getCollection(t)){const e=this._initialLoadList.indexOf(t);e>=0&&this._initialLoadList.splice(e,1),this._initialLoadList.length||(this._state=Wi.ROOM_MANAGER_INITIALIZED,this._listener&&this._listener.onRoomEngineInitalized(!0))}else this._state=Wi.ROOM_MANAGER_ERROR,this._listener&&this._listener.onRoomEngineInitalized(!1)}onRoomContentLoadedEvent(t){if(!this._contentLoader)return;const e=t.contentType;this._pendingContentTypes.indexOf(e)>=0||this._pendingContentTypes.push(e)}update(t,e=!1){if(this.processPendingContentTypes(t),!!this._rooms.size)for(const s of this._rooms.values())s&&s.update(t,e)}createRoomObjectManager(t){return new r1}get rooms(){return this._rooms}get disposed(){return this._disposed}};Wi.ROOM_MANAGER_ERROR=-1,Wi.ROOM_MANAGER_LOADING=0,Wi.ROOM_MANAGER_LOADED=1,Wi.ROOM_MANAGER_INITIALIZING=2,Wi.ROOM_MANAGER_INITIALIZED=3,Wi.CONTENT_PROCESSING_TIME_LIMIT_MILLISECONDS=40;let NI=Wi;class n1{constructor(t,e=-1,s=null,i=null,n=null){this._minLevel=-1,this._texture=null,this._colorMatrix=null,this._blendMode=null,this._name=t,this._minLevel=e,this._texture=s,this._colorMatrix=i,this._blendMode=n}get name(){return this._name}get texture(){return this._texture}set texture(t){this._texture=t}get colorMatrix(){return this._colorMatrix}set colorMatrix(t){this._colorMatrix=t}get blendMode(){return this._blendMode}set blendMode(t){this._blendMode=t}get minLevel(){return this._minLevel}}class a1{constructor(){this._effects=new Map,this._events=new nr,this._isLoaded=!1}init(){if(this._isLoaded)return;this._isLoaded=!0;const t=Dt.getValue("image.library.url")+"Habbo-Stories/",e=Dt.getValue("camera.available.effects");for(const s of e){if(!s.enabled)continue;const i=new n1(s.name,s.minLevel);s.colorMatrix.length?i.colorMatrix=s.colorMatrix:(i.texture=Es.from(t+s.name+".png"),i.blendMode=s.blendMode),this._effects.set(i.name,i)}this.events.dispatchEvent(new Bd(Bd.INITIALIZED))}applyEffects(t,e,s){const i=new hn,n=new Xe(t);i.addChild(n),s&&n.scale.set(2);for(const o of e){const l=o.effect;if(l)if(l.colorMatrix){const c=new UN;c.matrix=l.colorMatrix,c.alpha=o.alpha,n.filters||(n.filters=[]),n.filters.push(c)}else{const c=new Xe(l.texture);c.alpha=o.alpha,c.blendMode=l.blendMode,i.addChild(c)}}return Ee.generateImage(i)}get effects(){return this._effects}get events(){return this._events}get isLoaded(){return this._isLoaded}}class Op{constructor(t,e){this._effect=t,this._alpha=e}get effect(){return this._effect}get alpha(){return this._alpha}}class o1{}class l1{flush(){return this._categories=[],!0}parse(t){if(!t)return!1;for(var e=t.readInt();e!=0;){const i=t.readInt(),n=t.readString(),o=t.readInt(),l=t.readString();var s=new o1;s.id=i,s.name=n,s.type=o,s.icon=l,this._categories.push(s),e--}return!0}get soundCategories(){return this._categories}}class c1{}class u1{flush(){return this._sounds=[],!0}parse(t){if(!t)return!1;for(var e=t.readInt();e!=0;){const i=t.readInt(),n=t.readString(),o=t.readString(),l=t.readString(),c=t.readInt();var s=new c1;s.id=i,s.name=n,s.icon=o,s.soundUrl=l,s.categoryId=c,this._sounds.push(s),e--}return!0}get sounds(){return this._sounds}}class h1{flush(){return this._soundUrl="",!0}parse(t){return t?(this._soundUrl=t.readString(),!0):!1}get soundUrl(){return this._soundUrl}}class d1{flush(){return this._isVip=!1,!0}parse(t){return t?(this._isVip=t.readBoolean(),!0):!1}get isVip(){return this._isVip}}class _1{}class g1{flush(){return this._languages=[],!0}parse(t){if(!t)return!1;for(var e=t.readInt();e!=0;){var s=new _1;s.id=t.readInt(),s.name=t.readString(),this._languages.push(s),e--}return!0}get languages(){return this._languages}}class f1{flush(){return this._canShowInterstitial=!1,!0}parse(t){return t?(this._canShowInterstitial=t.readBoolean(),!0):!1}get canShowInterstitial(){return this._canShowInterstitial}}class m1{flush(){return this._errorCode=0,this._filteredText=null,!0}parse(t){return t?(this._errorCode=t.readInt(),this._filteredText=t.readString(),!0):!1}get errorCode(){return this._errorCode}get filteredText(){return this._filteredText}}class E1{flush(){return this._isOpen=!1,this._onShutdown=!1,this._isAuthenticUser=!1,!0}parse(t){return t?(this._isOpen=t.readBoolean(),this._onShutdown=t.readBoolean(),t.bytesAvailable&&(this._isAuthenticUser=t.readBoolean()),!0):!1}get isOpen(){return this._isOpen}get onShutdown(){return this._onShutdown}get isAuthenticUser(){return this._isAuthenticUser}}class p1{flush(){return this._isOpen=!1,this._minutesUntilChange=0,!0}parse(t){return t?(this._isOpen=t.readInt()>0,this._minutesUntilChange=t.readInt(),!0):!1}get isOpen(){return this._isOpen}get minutesUntilChange(){return this._minutesUntilChange}}class I1{flush(){return this._openHour=0,this._openMinute=0,!0}parse(t){return t?(this._openHour=t.readInt(),this._openMinute=t.readInt(),!0):!1}get openHour(){return this._openHour}get openMinute(){return this._openMinute}}class T1{flush(){return this._openHour=0,this._openMinute=0,this._userThrownOutAtClose=!1,!0}parse(t){return t?(this._openHour=t.readInt(),this._openMinute=t.readInt(),this._userThrownOutAtClose=t.readBoolean(),!0):!1}get openHour(){return this._openHour}get openMinute(){return this._openMinute}get userThrowOutAtClose(){return this._userThrownOutAtClose}}class R1{flush(){return this._minutes=0,!0}parse(t){return t?(this._minutes=t.readInt(),!0):!1}get openMinute(){return this._minutes}}class S1{flush(){return this._isInMaintenance=!1,this._minutesUntilMaintenance=0,this._duration=15,!0}parse(t){return t?(this._isInMaintenance=t.readBoolean(),this._minutesUntilMaintenance=t.readInt(),t.bytesAvailable&&(this._duration=t.readInt()),!0):!1}get isInMaintenance(){return this._isInMaintenance}get minutesUntilMaintenance(){return this._minutesUntilMaintenance}get duration(){return this._duration}}class O1{flush(){return this._resultCode=-1,this._name="",this._nameSuggestions=[],!0}parse(t){if(!t)return!1;this._resultCode=t.readInt(),this._name=t.readString();let e=t.readInt();for(;e>0;)this._nameSuggestions.push(t.readString()),e--;return!0}get resultCode(){return this._resultCode}get name(){return this._name}get nameSuggestions(){return this._nameSuggestions}}class C1{flush(){return this._resultCode=-1,this._name="",this._nameSuggestions=[],!0}parse(t){if(!t)return!1;this._resultCode=t.readInt(),this._name=t.readString();let e=t.readInt();for(;e>0;)this._nameSuggestions.push(t.readString()),e--;return!0}get resultCode(){return this._resultCode}get name(){return this._name}get nameSuggestions(){return this._nameSuggestions}}class A1{flush(){return this._figure="",this._gender="",!0}parse(t){return t?(this._figure=t.readString(),this._gender=t.readString(),this._gender&&(this._gender=this._gender.toUpperCase()),!0):!1}get figure(){return this._figure}get gender(){return this._gender}}class N1{constructor(t){this._slotId=t.readInt(),this._figureString=t.readString(),this._gender=t.readString()}get slotId(){return this._slotId}get figureString(){return this._figureString}get gender(){return this._gender}}class x1{flush(){return this._state=0,this._outfits=[],!0}parse(t){if(!t)return!1;this._state=t.readInt();let e=t.readInt();for(;e>0;)this._outfits.push(new N1(t)),e--;return!0}get state(){return this._state}get outfits(){return this._outfits}}class fS{constructor(t){if(!t)throw new Error("invalid_parser");this._id=t.readInt(),this._name=t.readString(),this._motto=t.readString(),this._gender=t.readString(),this._figure=t.readString()}get id(){return this._id}get name(){return this._name}get motto(){return this._motto}get figure(){return this._figure}get gender(){return this._gender}}class M1{flush(){return this._item=null,this._openInventory=!1,!0}parse(t){return t?(this._item=new fS(t),this._openInventory=t.readBoolean(),!0):!1}get item(){return this._item}openInventory(){return this._openInventory}}class y1{flush(){return this._items=null,!0}parse(t){this._items=new Map;let e=t.readInt();for(;e>0;){const s=new fS(t);this._items.set(s.id,s),e--}return!0}get items(){return this._items}}class D1{flush(){return this._boughtAsGift=!1,this._item=null,!0}parse(t){return t?(this._boughtAsGift=t.readBoolean(),this._item=new fS(t),!0):!1}get boughtAsGift(){return this._boughtAsGift}get item(){return this._item}}class b1{flush(){return this._itemId=0,!0}parse(t){return t?(this._itemId=t.readInt(),!0):!1}get itemId(){return this._itemId}}class v1{constructor(t){this._name=t.readString(),this._id=t.readInt(),this._consequence=t.readString()}get name(){return this._name}get id(){return this._id}get consequence(){return this._consequence}}class L1{constructor(t){this._topics=[],this._name=t.readString();let e=t.readInt();for(;e>0;)this._topics.push(new v1(t)),e--}dispose(){this._disposed||(this._disposed=!0,this._topics=null)}get disposed(){return this._disposed}get name(){return this._name}get topics(){return this._topics}}class P1{constructor(t){this._tradeLockInfo="",this._machineBanInfo="",this._name=t.readString(),this._sanctionLengthInHours=t.readInt(),this._probationDays=t.readInt(),this._avatarOnly=t.readBoolean(),t.bytesAvailable&&(this._tradeLockInfo=t.readString()),t.bytesAvailable&&(this._machineBanInfo=t.readString())}get name(){return this._name}get sanctionLengthInHours(){return this._sanctionLengthInHours}get avatarOnly(){return this._avatarOnly}get tradeLockInfo(){return this._tradeLockInfo}get machineBanInfo(){return this._machineBanInfo}}class U1{flush(){return this._issueId=-1,this._accountId=1,this._sanctionType=null,!0}parse(t){return t?(this._issueId=t.readInt(),this._accountId=t.readInt(),this._sanctionType=new P1(t),!0):!1}get issueId(){return this._issueId}get accountId(){return this._accountId}get sanctionType(){return this._sanctionType}}class j1{flush(){return this._callForHelpCategories=null,!0}parse(t){if(!t)return!1;this._callForHelpCategories=[];let e=t.readInt();for(;e>0;)this._callForHelpCategories.push(new L1(t)),e--;return!0}get callForHelpCategories(){return this._callForHelpCategories}}class w1{flush(){return this._isSanctionNew=!1,this._isSanctionActive=!1,this._sanctionName=null,this._sanctionLengthHours=0,this._sanctionReason=null,this._sanctionCreationTime=null,this._probationHoursLeft=0,this._nextSanctionName=null,this._nextSanctionLengthHours=0,this._hasCustomMute=!1,this._tradeLockExpiryTime=null,!0}parse(t){return t?(this._isSanctionNew=t.readBoolean(),this._isSanctionActive=t.readBoolean(),this._sanctionName=t.readString(),this._sanctionLengthHours=t.readInt(),t.readInt(),this._sanctionReason=t.readString(),this._sanctionCreationTime=t.readString(),this._probationHoursLeft=t.readInt(),this._nextSanctionName=t.readString(),this._nextSanctionLengthHours=t.readInt(),t.readInt(),this._hasCustomMute=t.readBoolean(),t.bytesAvailable&&(this._tradeLockExpiryTime=t.readString()),!0):!1}get isSanctionNew(){return this._isSanctionNew}get isSanctionActive(){return this._isSanctionActive}get sanctionName(){return this._sanctionName}get sanctionLengthHours(){return this._sanctionLengthHours}get sanctionReason(){return this._sanctionReason}get sanctionCreationTime(){return this._sanctionCreationTime}get probationHoursLeft(){return this._probationHoursLeft}get nextSanctionName(){return this._nextSanctionName}get nextSanctionLengthHours(){return this._nextSanctionLengthHours}get hasCustomMute(){return this._hasCustomMute}get tradeLockExpiryTime(){return this._tradeLockExpiryTime}}class F1{constructor(){this._ok=!1,this._secondsToWait=0}flush(){return this._ok=!1,this._secondsToWait=0,this._extraDataId=null,!0}parse(t){return t?(this._ok=t.readBoolean(),this._secondsToWait=t.readInt(),this._ok&&t.bytesAvailable&&(this._extraDataId=t.readString()),!0):!1}get ok(){return this._ok}get secondsToWait(){return this._secondsToWait}get extraDataId(){return this._extraDataId}}class G1{flush(){return!0}parse(t){return!!t}}class B1{flush(){return this._roomType=null,this._roomId=-1,!0}parse(t){return t?(this._roomType=t.readString(),this._roomId=t.readInt(),!0):!1}get roomType(){return this._roomType}get roomId(){return this._roomId}}class k1{flush(){return this._url="",!0}parse(t){return t?(this._url=t.readString(),!0):!1}get url(){return this._url}}class V1{constructor(){this._ok=!1,this._errorReason=null}flush(){return this._ok=!1,this._errorReason=null,!0}parse(t){return t?(this._ok=t.readBoolean(),this._errorReason=t.readString(),!0):!1}get ok(){return this._ok}get errorReason(){return this._errorReason}}class H1{constructor(){this._creditPrice=0,this._ducketPrice=0,this._publishDucketPrice=0}flush(){return this._creditPrice=0,this._ducketPrice=0,this._publishDucketPrice=0,!0}parse(t){return t?(this._creditPrice=t.readInt(),this._ducketPrice=t.readInt(),t.bytesAvailable&&(this._publishDucketPrice=t.readInt()),!0):!1}get creditPrice(){return this._creditPrice}get ducketPrice(){return this._ducketPrice}get publishDucketPrice(){return this._publishDucketPrice}}class W1{constructor(){this._ok=!0,this._renderLimitHit=!1}flush(){return this._ok=!0,this._renderLimitHit=!1,!0}parse(t){return t?(t.bytesAvailable&&(this._ok=t.readBoolean(),this._renderLimitHit=t.readBoolean()),!0):!1}get ok(){return this._ok}get isRenderLimitHit(){return this._renderLimitHit}}class mS{parse(t){if(!t)return!1;this._campaignName=t.readString(),this._campaignImage=t.readString(),this._currentDay=t.readInt(),this._campaignDays=t.readInt(),this._openedDays=[];let e=t.readInt();for(let s=0;s<e;s++)this._openedDays.push(t.readInt());this._missedDays=[],e=t.readInt();for(let s=0;s<e;s++)this._missedDays.push(t.readInt());return!0}clone(){const t=new mS;return t.campaignDays=this._campaignDays,t.campaignImage=this._campaignImage,t.campaignName=this._campaignName,t.currentDay=this._currentDay,t.missedDays=this._missedDays,t.openedDays=this._openedDays,t}get campaignName(){return this._campaignName}set campaignName(t){this._campaignName=t}get campaignImage(){return this._campaignImage}set campaignImage(t){this._campaignImage=t}get currentDay(){return this._currentDay}set currentDay(t){this._currentDay=t}get campaignDays(){return this._campaignDays}set campaignDays(t){this._campaignDays=t}get openedDays(){return this._openedDays}set openedDays(t){this._openedDays=t}get missedDays(){return this._missedDays}set missedDays(t){this._missedDays=t}}class Y1{flush(){return this._calendarData=null,!0}parse(t){return t?(this._calendarData=new mS,this._calendarData.parse(t),!0):!1}get calendarData(){return this._calendarData}}class z1{flush(){return this._doorOpened=!1,this._productName=null,this._customImage=null,this._furnitureClassName=null,!0}parse(t){return t?(this._doorOpened=t.readBoolean(),this._productName=t.readString(),this._customImage=t.readString(),this._furnitureClassName=t.readString(),!0):!1}get doorOpened(){return this._doorOpened}get productName(){return this._productName}get customImage(){return this._customImage}get furnitureClassName(){return this._furnitureClassName}}class K1{flush(){return this._totalCoinsForBonus=-1,this._coinsStillRequiredToBuy=-1,this._productType="",this._productClassId=-1,!0}parse(t){return t?(this._productType=t.readString(),this._productClassId=t.readInt(),this._totalCoinsForBonus=t.readInt(),this._coinsStillRequiredToBuy=t.readInt(),!0):!1}get totalCoinsForBonus(){return this._totalCoinsForBonus}get coinsStillRequiredToBuy(){return this._coinsStillRequiredToBuy}get productType(){return this._productType}get productClassId(){return this._productClassId}}class X1{flush(){return this._furniCount=0,!0}parse(t){return t?(this._furniCount=t.readInt(),!0):!1}get furniCount(){return this._furniCount}}class q1{flush(){return this._secondsLeft=0,this._furniLimit=0,this._maxFurniLimit=0,this._secondsLeftWithGrace=0,!0}parse(t){return t?(this._secondsLeft=t.readInt(),this._furniLimit=t.readInt(),this._maxFurniLimit=t.readInt(),t.bytesAvailable?this._secondsLeftWithGrace=t.readInt():this._secondsLeftWithGrace=this._secondsLeft,!0):!1}get secondsLeft(){return this._secondsLeft}get furniLimit(){return this._furniLimit}get maxFurniLimit(){return this._maxFurniLimit}get secondsLeftWithGrace(){return this._secondsLeftWithGrace}}class Q1{constructor(t){this._maxPurchaseSize=t.readInt(),this._bundleSize=t.readInt(),this._bundleDiscountSize=t.readInt(),this._bonusThreshold=t.readInt(),this._additionalBonusDiscountThresholdQuantities=[];let e=t.readInt();for(;e>0;)this._additionalBonusDiscountThresholdQuantities.push(t.readInt()),e--}get maxPurchaseSize(){return this._maxPurchaseSize}get bundleSize(){return this._bundleSize}get bundleDiscountSize(){return this._bundleDiscountSize}get bonusThreshold(){return this._bonusThreshold}get additionalBonusDiscountThresholdQuantities(){return this._additionalBonusDiscountThresholdQuantities}}class J1{flush(){return this._bundleDiscountRuleset=null,!0}parse(t){return t?(this._bundleDiscountRuleset=new Q1(t),!0):!1}get bundleDiscountRuleset(){return this._bundleDiscountRuleset}}class ES{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._visible=!1,this._icon=0,this._pageId=-1,this._pageName=null,this._localization=null,this._children=[],this._offerIds=[],!0}parse(t){if(!t)return!1;this._visible=t.readBoolean(),this._icon=t.readInt(),this._pageId=t.readInt(),this._pageName=t.readString(),this._localization=t.readString();let e=t.readInt();for(;e>0;)this._offerIds.push(t.readInt()),e--;let s=t.readInt();for(;s>0;)this._children.push(new ES(t)),s--;return!0}get visible(){return this._visible}get icon(){return this._icon}get pageId(){return this._pageId}get pageName(){return this._pageName}get localization(){return this._localization}get children(){return this._children}get offerIds(){return this._offerIds}}class $1{flush(){return this._root=null,!0}parse(t){return t?(this._root=new ES(t),this._newAdditionsAvailable=t.readBoolean(),this._catalogType=t.readString(),!0):!1}get root(){return this._root}get newAdditionsAvailable(){return this._newAdditionsAvailable}get catalogType(){return this._catalogType}}class Z1{constructor(t){this._images=[],this._texts=[];let e=t.readInt();for(;e>0;)this._images.push(t.readString()),e--;let s=t.readInt();for(;s>0;)this._texts.push(t.readString()),s--}get images(){return this._images}get texts(){return this._texts}}class tF{flush(){return this._pageName=null,this._pageId=0,this._secondsToExpiry=0,this._image=null,!0}parse(t){return t?(this._pageId=t.readInt(),this._pageName=t.readString(),this._secondsToExpiry=t.readInt(),this._image=t.readString(),!0):!1}get pageName(){return this._pageName}get pageId(){return this._pageId}get secondsToExpiry(){return this._secondsToExpiry}get image(){return this._image}}const Yl=class Yl{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._productType=null,this._furniClassId=-1,this._extraParam=null,this._productCount=0,this._uniqueLimitedItem=!1,this._uniqueLimitedItemSeriesSize=0,this._uniqueLimitedItemsLeft=0,!0}parse(t){switch(this._productType=t.readString(),this._productType){case Yl.B:return this._extraParam=t.readString(),this._productCount=1,!0;default:return this._furniClassId=t.readInt(),this._extraParam=t.readString(),this._productCount=t.readInt(),this._uniqueLimitedItem=t.readBoolean(),this._uniqueLimitedItem&&(this._uniqueLimitedItemSeriesSize=t.readInt(),this._uniqueLimitedItemsLeft=t.readInt()),!0}}get productType(){return this._productType}get furniClassId(){return this._furniClassId}get extraParam(){return this._extraParam}get productCount(){return this._productCount}get uniqueLimitedItem(){return this._uniqueLimitedItem}get uniqueLimitedSeriesSize(){return this._uniqueLimitedItemSeriesSize}get uniqueLimitedItemsLeft(){return this._uniqueLimitedItemsLeft}};Yl.I="i",Yl.S="s",Yl.E="e",Yl.B="b";let Un=Yl;class XE{constructor(t){this._offerId=t.readInt(),this._localizationId=t.readString(),this._rent=t.readBoolean(),this._priceCredits=t.readInt(),this._priceActivityPoints=t.readInt(),this._priceActivityPointsType=t.readInt(),this._giftable=t.readBoolean(),this._products=[];let e=t.readInt();for(;e>0;)this._products.push(new Un(t)),e--;this._clubLevel=t.readInt(),this._bundlePurchaseAllowed=t.readBoolean(),this._isPet=t.readBoolean(),this._previewImage=t.readString()}get offerId(){return this._offerId}get localizationId(){return this._localizationId}get rent(){return this._rent}get priceCredits(){return this._priceCredits}get priceActivityPoints(){return this._priceActivityPoints}get priceActivityPointsType(){return this._priceActivityPointsType}get clubLevel(){return this._clubLevel}get giftable(){return this._giftable}get bundlePurchaseAllowed(){return this._bundlePurchaseAllowed}get isPet(){return this._isPet}get previewImage(){return this._previewImage}get products(){return this._products}}const Fo=class Fo{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._type=-1,this._position=null,this._itemName=null,this._itemPromoImage=null,this._catalogPageLocation=null,this._productCode=null,this._productOfferId=0,this._expirationTime=0,!0}parse(t){if(!t)return!1;switch(this._position=t.readInt(),this._itemName=t.readString(),this._itemPromoImage=t.readString(),this._type=t.readInt(),this._type){case Fo.ITEM_CATALOGUE_PAGE:this._catalogPageLocation=t.readString();break;case Fo.ITEM_PRODUCT_OFFER:this._productOfferId=t.readInt();break;case Fo.ITEM_IAP:this._productCode=t.readString();break}const e=t.readInt();return this._expirationTime=e>0?e*1e3+Pt():0,!0}get type(){return this._type}get position(){return this._position}get itemName(){return this._itemName}get itemPromoImage(){return this._itemPromoImage}get catalogPageLocation(){return this._catalogPageLocation}get productCode(){return this._productCode}get productOfferId(){return this._productOfferId}get expirationTime(){return this._expirationTime}};Fo.ITEM_CATALOGUE_PAGE=0,Fo.ITEM_PRODUCT_OFFER=1,Fo.ITEM_IAP=2;let Kd=Fo;class eF{flush(){return this._pageId=-1,this._catalogType=null,this._layoutCode=null,this._localization=null,this._offers=[],this._offerId=-1,this._acceptSeasonCurrencyAsCredits=!1,this._frontPageItems=[],!0}parse(t){if(!t)return!1;this._pageId=t.readInt(),this._catalogType=t.readString(),this._layoutCode=t.readString(),this._localization=new Z1(t);let e=t.readInt();for(;e>0;)this._offers.push(new XE(t)),e--;if(this._offerId=t.readInt(),this._acceptSeasonCurrencyAsCredits=t.readBoolean(),t.bytesAvailable){let s=t.readInt();for(;s>0;)this._frontPageItems.push(new Kd(t)),s--}return!0}get pageId(){return this._pageId}get catalogType(){return this._catalogType}get layoutCode(){return this._layoutCode}get localization(){return this._localization}get offers(){return this._offers}get offerId(){return this._offerId}get acceptSeasonCurrencyAsCredits(){return this._acceptSeasonCurrencyAsCredits}get frontPageItems(){return this._frontPageItems}}class sF{flush(){return this._pageName=null,this._secondsToExpiry=0,this._image=null,!0}parse(t){return t?(this._pageName=t.readString(),this._secondsToExpiry=t.readInt(),this._image=t.readString(),!0):!1}get pageName(){return this._pageName}get secondsToExpiry(){return this._secondsToExpiry}get image(){return this._image}}class iF{flush(){return this._instantlyRefreshCatalogue=!1,this._newFurniDataHash=null,!0}parse(t){return t?(this._instantlyRefreshCatalogue=t.readBoolean(),t.bytesAvailable&&(this._newFurniDataHash=t.readString()),!0):!1}get instantlyRefreshCatalogue(){return this._instantlyRefreshCatalogue}get newFurniDataHash(){return this._newFurniDataHash}}class rF{constructor(t){this._offerId=t.readInt(),this._isVip=t.readBoolean(),this._daysRequired=t.readInt(),this._isSelectable=t.readBoolean()}get offerId(){return this._offerId}get isVip(){return this._isVip}get isSelectable(){return this._isSelectable}get daysRequired(){return this._daysRequired}}class nF{flush(){return!0}parse(t){if(!t)return!1;this._offers=[],this._giftData=new Map,this._daysUntilNextGift=t.readInt(),this._giftsAvailable=t.readInt();const e=t.readInt();for(let i=0;i<e;i++)this._offers.push(new XE(t));const s=t.readInt();for(let i=0;i<s;i++){const n=new rF(t);this._giftData.set(n.offerId,n)}return!0}get offers(){return this._offers}get daysUntilNextGift(){return this._daysUntilNextGift}get giftsAvailable(){return this._giftsAvailable}set giftsAvailable(t){this._giftsAvailable=t}getOfferExtraData(t){return t?this._giftData.get(t):null}get giftData(){return this._giftData}}class aF{flush(){return this._productCode=null,this._products=[],!0}parse(t){if(!t)return!1;this._productCode=t.readString();let e=t.readInt();for(;e>0;)this._products.push(new Un(t)),e--;return!0}get productCode(){return this._productCode}get products(){return this._products}}class QN{constructor(t){if(!t)throw new Error("invalid_wrapper");this._offerId=t.readInt(),this._productCode=t.readString(),t.readBoolean(),this._priceCredits=t.readInt(),this._priceActivityPoints=t.readInt(),this._priceActivityPointsType=t.readInt(),this._vip=t.readBoolean(),this._months=t.readInt(),this._extraDays=t.readInt(),this._giftable=t.readBoolean(),this._daysLeftAfterPurchase=t.readInt(),this._year=t.readInt(),this._month=t.readInt(),this._day=t.readInt()}get offerId(){return this._offerId}get productCode(){return this._productCode}get priceCredits(){return this._priceCredits}get priceActivityPoints(){return this._priceActivityPoints}get priceActivityPointsType(){return this._priceActivityPointsType}get vip(){return this._vip}get months(){return this._months}get extraDays(){return this._extraDays}get daysLeftAfterPurchase(){return this._daysLeftAfterPurchase}get year(){return this._year}get month(){return this._month}get day(){return this._day}get giftable(){return this._giftable}}class oF extends QN{constructor(t){super(t),this._originalPrice=t.readInt(),this._originalActivityPointPrice=t.readInt(),this._originalActivityPointType=t.readInt(),this._subscriptionDaysLeft=t.readInt()}get originalPrice(){return this._originalPrice*this.months}get originalActivityPointPrice(){return this._originalActivityPointPrice*this.months}get originalActivityPointType(){return this._originalActivityPointType}get discountCreditAmount(){return this._originalPrice*this.months-this.priceCredits}get discountActivityPointAmount(){return this.originalActivityPointPrice*this.months-this.priceActivityPoints}get subscriptionDaysLeft(){return this._subscriptionDaysLeft}}class lF{flush(){return this._available=!1,this._pricePointUrl=null,this._market=null,this._lengthInDays=0,!0}parse(t){return t?(this._pricePointUrl=t.readString(),this._pricePointUrl!==""&&(this._available=!0),this._market=t.readString(),this._lengthInDays=t.readInt(),!0):!1}get available(){return this._available}get pricePointUrl(){return this._pricePointUrl}get market(){return this._market}get lengthInDays(){return this._lengthInDays}}class cF{constructor(t){this._stuffId=t.readInt(),this._charges=t.readInt(),this._SafeStr_6935=t.readInt(),this._SafeStr_6936=t.readInt(),this._SafeStr_6518=t.readInt(),this._SafeStr_7875=t.readInt()}get stuffId(){return this._stuffId}get charges(){return this._charges}get _SafeStr_5946(){return this._SafeStr_6935}get _SafeStr_5944(){return this._SafeStr_6936}get _SafeStr_7876(){return this._SafeStr_7875}get _SafeStr_5945(){return this._SafeStr_6518}}class uF{flush(){return this._fireworkChargeData=null,!0}parse(t){return t?(this._fireworkChargeData=new cF(t),!0):!1}get fireworkChargeData(){return this._fireworkChargeData}}class hF{flush(){return!0}parse(t){return!!t}}class dF{constructor(){this._isEnabled=!1,this._price=null,this._giftWrappers=null,this._boxTypes=null,this._ribbonTypes=null,this._giftFurnis=null}flush(){return this._boxTypes=null,this._giftFurnis=null,this._giftWrappers=null,this._ribbonTypes=null,this._isEnabled=null,this._price=null,!0}parse(t){if(!t)return!1;const e=[],s=[],i=[],n=[];this._isEnabled=t.readBoolean(),this._price=t.readInt();let o=t.readInt(),l=0;for(;l<o;)e.push(t.readInt()),l++;for(o=t.readInt(),l=0;l<o;)s.push(t.readInt()),l++;for(o=t.readInt(),l=0;l<o;)i.push(t.readInt()),l++;for(o=t.readInt(),l=0;l<o;)n.push(t.readInt()),l++;return this._giftWrappers=e,this._ribbonTypes=i,this._giftFurnis=n,this._boxTypes=s,!0}get giftWrappers(){return this._giftWrappers}get ribbonTypes(){return this._ribbonTypes}get giftFurnis(){return this._giftFurnis}get boxTypes(){return this._boxTypes}get isEnabled(){return this._isEnabled}get price(){return this._price}}class _F{flush(){return this._offer=null,!0}parse(t){return t?(this._offer=new oF(t),!0):!1}get offer(){return this._offer}}class gF{flush(){return this._offers=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._offers.push(new QN(t)),e--;return!0}get offers(){return this._offers}}class fF{flush(){return this._offerId=0,this._isGiftable=!1,!0}parse(t){return t?(this._offerId=t.readInt(),this._isGiftable=t.readBoolean(),!0):!1}get offerId(){return this._offerId}get isGiftable(){return this._isGiftable}}class mF{flush(){return!0}parse(t){return!!t}}class EF{flush(){return this._appearsInSeconds=-1,this._pageId=-1,this._offerId=-1,this._productType="",!0}parse(t){return t?(this._appearsInSeconds=t.readInt(),this._pageId=t.readInt(),this._offerId=t.readInt(),this._productType=t.readString(),!0):!1}get appearsInSeconds(){return this._appearsInSeconds}get pageId(){return this._pageId}get offerId(){return this._offerId}get productType(){return this._productType}}class pF{constructor(){this._notEnoughCredits=!1,this._notEnoughActivityPoints=!1,this._activityPointType=0}flush(){return this._notEnoughCredits=!1,this._notEnoughActivityPoints=!1,this._activityPointType=0,!0}parse(t){return t?(this._notEnoughCredits=t.readBoolean(),this._notEnoughActivityPoints=t.readBoolean(),t.bytesAvailable&&(this._activityPointType=t.readInt()),!0):!1}get notEnoughCredits(){return this._notEnoughCredits}get notEnoughActivityPoints(){return this._notEnoughActivityPoints}get activityPointType(){return this._activityPointType}}class IF{flush(){return this._offer=null,!0}parse(t){return t?(this._offer=new XE(t),!0):!1}get offer(){return this._offer}}class TF{flush(){return this._code=0,!0}parse(t){return t?(this._code=t.readInt(),!0):!1}get code(){return this._code}}class RF{flush(){return this._code=0,!0}parse(t){return t?(this._code=t.readInt(),!0):!1}get code(){return this._code}}class SF{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._offerId=-1,this._localizationId=null,this._rent=!1,this._priceCredits=0,this._priceActivityPoints=0,this._priceActivityPointsType=0,this._clubLevel=0,this._giftable=!1,this._bundlePurchaseAllowed=!1,this._products=[],!0}parse(t){if(!t)return!1;this._offerId=t.readInt(),this._localizationId=t.readString(),this._rent=t.readBoolean(),this._priceCredits=t.readInt(),this._priceActivityPoints=t.readInt(),this._priceActivityPointsType=t.readInt(),this._giftable=t.readBoolean();let e=t.readInt();for(;e>0;)this._products.push(new Un(t)),e--;return this._clubLevel=t.readInt(),this._bundlePurchaseAllowed=t.readBoolean(),!0}get offerId(){return this._offerId}get localizationId(){return this._localizationId}get rent(){return this._rent}get priceCredits(){return this._priceCredits}get priceActivityPoints(){return this._priceActivityPoints}get priceActivityPointsType(){return this._priceActivityPointsType}get clubLevel(){return this._clubLevel}get giftable(){return this._giftable}get bundlePurchaseAllowed(){return this._bundlePurchaseAllowed}get products(){return this._products}}class OF{flush(){return this._offer=null,!0}parse(t){return t?(this._offer=new SF(t),!0):!1}get offer(){return this._offer}}class CF{flush(){return this._clubLevel=0,this._securityLevel=0,this._isAmbassador=!1,!0}parse(t){return t?(this._clubLevel=t.readInt(),this._securityLevel=t.readInt(),this._isAmbassador=t.readBoolean(),!0):!1}get clubLevel(){return this._clubLevel}get securityLevel(){return this._securityLevel}get isAmbassador(){return this._isAmbassador}}const Vm=class Vm{flush(){return!0}parse(t){return t?(this._status=t.readInt(),!0):!1}get status(){return this._status}};Vm.SAFETY_LOCK_STATUS_LOCKED=0,Vm.SAFETY_LOCK_STATUS_UNLOCKED=1;let jg=Vm;class AF{flush(){return this._result=-1,this._validationInfo="",!0}parse(t){return t?(this._result=t.readInt(),this._validationInfo=t.readString(),!0):!1}get result(){return this._result}get validationInfo(){return this._validationInfo}}const oC=class oC{flush(){return this._result=-1,!0}parse(t){return t?(this._result=t.readInt(),!0):!1}get result(){return this._result}};oC.EMAIL_STATUS_OK=0;let xI=oC;class NF{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._relationshipStatusType=Tr.NONE,this._friendCount=0,this._randomFriendId=0,this._randomFriendFigure=null,this._randomFriendName=null,!0}parse(t){return t?(this._relationshipStatusType=t.readInt(),this._friendCount=t.readInt(),this._randomFriendId=t.readInt(),this._randomFriendName=t.readString(),this._randomFriendFigure=t.readString(),!0):!1}get relationshipStatusType(){return this._relationshipStatusType}get friendCount(){return this._friendCount}get randomFriendId(){return this._randomFriendId}get randomFriendName(){return this._randomFriendName}get randomFriendFigure(){return this._randomFriendFigure}}class xF{flush(){return this._userId=0,this._relationshipStatusMap=null,!0}parse(t){if(!t)return!1;this._userId=t.readInt(),this._relationshipStatusMap=new hs;const e=t.readInt();for(let s=0;s<e;s++){const i=new NF(t);this._relationshipStatusMap.add(i.relationshipStatusType,i)}return!0}get userId(){return this._userId}get relationshipStatusMap(){return this._relationshipStatusMap}}class MF{flush(){return this._userId=null,this._badges=[],!0}parse(t){if(!t)return!1;this._userId=t.readInt();let e=t.readInt();for(;e>0;){t.readInt();const s=t.readString();this._badges.push(s),e--}return!0}get userId(){return this._userId}get badges(){return this._badges}}class yF{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._userId=0,this._username=null,this._figure=null,this._gender=null,this._motto=null,this._realName=null,this._directMail=!1,this._respectsReceived=0,this._respectsRemaining=0,this._respectsPetRemaining=0,this._streamPublishingAllowed=!1,this._lastAccessDate=null,this._canChangeName=!1,this._safetyLocked=!1,!0}parse(t){return t?(this._userId=t.readInt(),this._username=t.readString(),this._figure=t.readString(),this._gender=t.readString(),this._motto=t.readString(),this._realName=t.readString(),this._directMail=t.readBoolean(),this._respectsReceived=t.readInt(),this._respectsRemaining=t.readInt(),this._respectsPetRemaining=t.readInt(),this._streamPublishingAllowed=t.readBoolean(),this._lastAccessDate=t.readString(),this._canChangeName=t.readBoolean(),this._safetyLocked=t.readBoolean(),!0):!1}get userId(){return this._userId}get username(){return this._username}get figure(){return this._figure}get gender(){return this._gender}get motto(){return this._motto}get realName(){return this._realName}get directMail(){return this._directMail}get respectsReceived(){return this._respectsReceived}get respectsRemaining(){return this._respectsRemaining}get respectsPetRemaining(){return this._respectsPetRemaining}get streamPublishingAllowed(){return this._streamPublishingAllowed}get lastAccessedDate(){return this._lastAccessDate}get canChangeName(){return this._canChangeName}get safetyLocked(){return this._safetyLocked}}class DF{flush(){return this._userInfo=null,!0}parse(t){return!(!t||(this._userInfo=new yF(t),!this._userInfo))}get userInfo(){return this._userInfo}}class bF{flush(){return this._webId=-1,this._id=-1,this._newName="",!0}parse(t){return t?(this._webId=t.readInt(),this._id=t.readInt(),this._newName=t.readString(),!0):!1}get webId(){return this._webId}get id(){return this._id}get newName(){return this._newName}}class JN{constructor(t){this._groupId=t.readInt(),this._groupName=t.readString(),this._badgeCode=t.readString(),this._colorA=t.readString(),this._colorB=t.readString(),this._favourite=t.readBoolean(),this._ownerId=t.readInt(),this._hasForum=t.readBoolean()}get groupId(){return this._groupId}get groupName(){return this._groupName}get badgeCode(){return this._badgeCode}get colorA(){return this._colorA}get colorB(){return this._colorB}get favourite(){return this._favourite}get ownerId(){return this._ownerId}get hasForum(){return this._hasForum}}class vF{flush(){return this._id=0,this._username=null,this._figure=null,this._motto=null,this._registration=null,this._achievementPoints=0,this._friendsCount=0,this._isMyFriend=!1,this._requestSent=!1,this._isOnline=!1,this._groups=[],this._secondsSinceLastVisit=0,this._openProfileWindow=!1,!0}parse(t){if(!t)return!1;this._id=t.readInt(),this._username=t.readString(),this._figure=t.readString(),this._motto=t.readString(),this._registration=t.readString(),this._achievementPoints=t.readInt(),this._friendsCount=t.readInt(),this._isMyFriend=t.readBoolean(),this._requestSent=t.readBoolean(),this._isOnline=t.readBoolean();const e=t.readInt();for(let s=0;s<e;s++)this._groups.push(new JN(t));return this._secondsSinceLastVisit=t.readInt(),this._openProfileWindow=t.readBoolean(),!0}get id(){return this._id}get username(){return this._username}get figure(){return this._figure}get motto(){return this._motto}get registration(){return this._registration}get achievementPoints(){return this._achievementPoints}get friendsCount(){return this._friendsCount}get isMyFriend(){return this._isMyFriend}get requestSent(){return this._requestSent}get isOnline(){return this._isOnline}get groups(){return this._groups}get secondsSinceLastVisit(){return this._secondsSinceLastVisit}get openProfileWindow(){return this._openProfileWindow}}class LF{flush(){return this._volumeSystem=0,this._volumeFurni=0,this._volumeTrax=0,this._volumeSoundboard=0,this._oldChat=!1,this._roomInvites=!1,this._cameraFollow=!1,this._flags=0,this._chatType=0,!0}parse(t){return t?(this._volumeSystem=t.readInt(),this._volumeFurni=t.readInt(),this._volumeTrax=t.readInt(),this._volumeSoundboard=t.readInt(),this._oldChat=t.readBoolean(),this._roomInvites=t.readBoolean(),this._cameraFollow=t.readBoolean(),this._flags=t.readInt(),this._chatType=t.readInt(),!0):!1}get volumeSystem(){return this._volumeSystem}get volumeFurni(){return this._volumeFurni}get volumeTrax(){return this._volumeTrax}get volumeSoundboard(){return this._volumeSoundboard}get oldChat(){return this._oldChat}get roomInvites(){return this._roomInvites}get cameraFollow(){return this._cameraFollow}get flags(){return this._flags}get chatType(){return this._chatType}}class PF{flush(){return this._roomUnitId=-1,this._tags=[],!0}parse(t){if(!t)return!1;this._roomUnitId=t.readInt();let e=t.readInt();for(;e>0;)this._tags.push(t.readString()),e--;return!0}get roomUnitId(){return this._roomUnitId}get tags(){return this._tags}}class UF{flush(){return this._email=null,this._isVerified=!1,this._allowChange=!1,!0}parse(t){return t?(this._email=t.readString(),this._isVerified=t.readBoolean(),this._allowChange=t.readBoolean(),!0):!1}get email(){return this._email}get isVerified(){return this._isVerified}get allowChange(){return this._allowChange}}class jF{flush(){return this._userId=-1,!0}parse(t){return t?(this._userId=t.readInt(),!0):!1}get userId(){return this._userId}}class wF{flush(){return this._groupId=-1,!0}parse(t){return t?(this._groupId=t.readInt(),!0):!1}get groupId(){return this._groupId}}class FF{flush(){return this._groupId=-1,this._requester=null,!0}parse(t){return t?(this._groupId=t.readInt(),this._requester=new DT(t),!0):!1}get groupId(){return this._groupId}get requester(){return this._requester}}const lC=class lC{flush(){return this._reason=-1,!0}parse(t){return t?(this._reason=t.readInt(),!0):!1}get reason(){return this._reason}};lC.INSUFFICIENT_SUBSCRIPTION_LEVEL=2;let MI=lC;class GF{flush(){return this._guildId=-1,this._reason=-1,!0}parse(t){return t?(this._guildId=t.readInt(),this._reason=t.readInt(),!0):!1}get guildId(){return this._guildId}get reason(){return this._reason}}class BF{flush(){return this._groups=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._groups.push(new JN(t)),e--;return!0}get groups(){return this._groups}}class kF{flush(){return this._badges=new Map,!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;){const s=t.readInt(),i=t.readString();this._badges.set(s,i),e--}return!0}get badges(){return this._badges}}const cC=class cC{flush(){return this._reason=-1,!0}parse(t){return t?(this._reason=t.readInt(),!0):!1}get reason(){return this._reason}};cC.INSUFFICIENT_SUBSCRIPTION_LEVEL=4;let yI=cC;class VF{flush(){return this._ignoredUsers=[],!0}parse(t){if(!t)return!1;this._ignoredUsers=[];let e=t.readInt();for(;e>0;)this._ignoredUsers.push(t.readString()),e--;return!0}get ignoredUsers(){return this._ignoredUsers}}class HF{flush(){return this._result=-1,this._name=null,!0}parse(t){return t?(this._result=t.readInt(),this._name=t.readString(),!0):!1}get result(){return this._result}get name(){return this._name}}class WF{flush(){return this._link=null,!0}parse(t){return t?(this._link=t.readString(),!0):!1}get link(){return this._link}}class YF{flush(){return this._credits=null,!0}parse(t){return t?(this._credits=t.readString(),!0):!1}get credits(){return this._credits}}class zF{flush(){return this._currencies=new Map,!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._currencies.set(t.readInt(),t.readInt()),e--;return!0}get currencies(){return this._currencies}}const Tu=class Tu{flush(){return this._productName=null,this._daysToPeriodEnd=0,this._memberPeriods=0,this._periodsSubscribedAhead=0,this._responseType=0,this._hasEverBeenMember=!1,this._isVip=!1,this._pastClubDays=0,this._pastVipDays=0,this._minutesUntilExpiration=0,this._minutesSinceLastModified=0,!0}parse(t){return t?(this._productName=t.readString(),this._daysToPeriodEnd=t.readInt(),this._memberPeriods=t.readInt(),this._periodsSubscribedAhead=t.readInt(),this._responseType=t.readInt(),this._hasEverBeenMember=t.readBoolean(),this._isVip=t.readBoolean(),this._pastClubDays=t.readInt(),this._pastVipDays=t.readInt(),this._minutesUntilExpiration=t.readInt(),t.bytesAvailable&&(this._minutesSinceLastModified=t.readInt()),!0):!1}get productName(){return this._productName}get daysToPeriodEnd(){return this._daysToPeriodEnd}get memberPeriods(){return this._memberPeriods}get periodsSubscribedAhead(){return this._periodsSubscribedAhead}get responseType(){return this._responseType}get hasEverBeenMember(){return this._hasEverBeenMember}get isVip(){return this._isVip}get pastClubDays(){return this._pastClubDays}get pastVipDays(){return this._pastVipDays}get minutesUntilExpiration(){return this._minutesUntilExpiration}get minutesSinceLastModified(){return this._minutesSinceLastModified}};Tu.RESPONSE_TYPE_LOGIN=1,Tu.RESPONSE_TYPE_PURCHASE=2,Tu.RESPONSE_TYPE_DISCOUNT_AVAILABLE=3,Tu.RESPONSE_TYPE_CITIZENSHIP_DISCOUNT=4;let wg=Tu;const Ru=class Ru{constructor(t){if(this._unseen=0,!t)throw new Error("invalid_parser");this._achievementId=t.readInt(),this._level=t.readInt(),this._badgeId=t.readString(),this._scoreAtStartOfLevel=t.readInt(),this._scoreLimit=Math.max(1,t.readInt()),this._levelRewardPoints=t.readInt(),this._levelRewardPointType=t.readInt(),this._currentPoints=t.readInt(),this._finalLevel=t.readBoolean(),this._category=t.readString(),this._subCategory=t.readString(),this._levelCount=t.readInt(),this._displayMethod=t.readInt()}get achievementId(){return this._achievementId}get badgeId(){return this._badgeId}get level(){return this._level}get scoreAtStartOfLevel(){return this._scoreAtStartOfLevel}get scoreLimit(){return this._scoreLimit-this._scoreAtStartOfLevel}get levelRewardPoints(){return this._levelRewardPoints}get levelRewardPointType(){return this._levelRewardPointType}get currentPoints(){return this._currentPoints-this._scoreAtStartOfLevel}get finalLevel(){return this._finalLevel}get category(){return this._category}get subCategory(){return this._subCategory}get levelCount(){return this._levelCount}get firstLevelAchieved(){return this._level>1||this._finalLevel}setMaxProgress(){this._currentPoints=this._scoreLimit}get displayMethod(){return this._displayMethod}get progress(){return this._currentPoints}get toNextProgress(){return this._scoreLimit}set unseen(t){this._unseen=t}get unseen(){return this._unseen}reset(t){this._achievementId=t._achievementId,this._level=t._level,this._badgeId=t._badgeId,this._scoreAtStartOfLevel=t._scoreAtStartOfLevel,this._scoreLimit=t._scoreLimit,this._levelRewardPoints=t._levelRewardPoints,this._levelRewardPointType=t._levelRewardPointType,this._currentPoints=t._currentPoints,this._finalLevel=t._finalLevel,this._category=t.category,this._subCategory=t._subCategory,this._levelCount=t._levelCount,this._displayMethod=t._displayMethod}};Ru.DISPLAY_METHOD_OBSOLETE=-1,Ru.DISPLAY_METHOD_SHOW_LEVEL_PROGRESS=0,Ru.DISPLAY_METHOD_NEVER_SHOW_PROGRESS=1,Ru.DISPLAY_METHOD_SHOW_TOTAL_PROGRESS=2;let Fg=Ru;class KF{flush(){return this._achievement=null,!0}parse(t){return t?(this._achievement=new Fg(t),!0):!1}get achievement(){return this._achievement}}const Hm=class Hm{constructor(t){this._achievementId=t.readInt(),this._level=t.readInt(),this._badgeId=t.readString(),this._requiredLevel=t.readInt(),this._state=t.readInt()}dispose(){this._achievementId=0,this._level=0,this._badgeId="",this._requiredLevel=0}get achievementId(){return this._achievementId}get level(){return this._level}get badgeId(){return this._badgeId}get requiredLevel(){return this._requiredLevel}get enabled(){return this._state===Hm.STATE_SELECTABLE}get state(){return this._state}};Hm.STATE_SELECTABLE=0;let DI=Hm;class XF{flush(){return this._achievements=[],this._defaultCategory=null,!0}parse(t){if(!t)return!1;this._achievements=[];let e=t.readInt();for(;e>0;)this._achievements.push(new Fg(t)),e--;return this._defaultCategory=t.readString(),!0}get achievements(){return this._achievements}get defaultCategory(){return this._defaultCategory}}class qF{flush(){return this._score=0,!0}parse(t){return t?(this._score=t.readInt(),!0):!1}get score(){return this._score}}class QF{get type(){return this._type}set type(t){this._type=t}get subType(){return this._subType}set subType(t){this._subType=t}get duration(){return this._duration}set duration(t){this._duration=t}get inactiveEffectsInInventory(){return this._inactiveEffectsInInventory}set inactiveEffectsInInventory(t){this._inactiveEffectsInInventory=t}get secondsLeftIfActive(){return this._secondsLeftIfActive}set secondsLeftIfActive(t){this._secondsLeftIfActive=t}get isPermanent(){return this._permanent}set isPermanent(t){this._permanent=t}}class JF{flush(){return this._type=0,this._duration=0,this._isPermanent=!1,!0}parse(t){return t?(this._type=t.readInt(),this._duration=t.readInt(),this._isPermanent=t.readBoolean(),!0):!1}get type(){return this._type}get duration(){return this._duration}get isPermanent(){return this._isPermanent}}class $F{flush(){return this._type=0,this._subType=0,this._duration=0,this._permanent=!1,!0}parse(t){return t?(this._type=t.readInt(),this._subType=t.readInt(),this._duration=t.readInt(),this._permanent=t.readBoolean(),!0):!1}get type(){return this._type}get subType(){return this._subType}get duration(){return this._duration}get isPermanent(){return this._permanent}}class ZF{flush(){return this._type=0,!0}parse(t){return t?(this._type=t.readInt(),!0):!1}get type(){return this._type}}class tG{flush(){return this._type=0,!0}parse(t){return t?(this._type=t.readInt(),!0):!1}get type(){return this._type}}class eG{flush(){return this._effects=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;){const s=new QF;s.type=t.readInt(),s.subType=t.readInt(),s.duration=t.readInt(),s.inactiveEffectsInInventory=t.readInt(),s.secondsLeftIfActive=t.readInt(),s.isPermanent=t.readBoolean(),this._effects.push(s),e--}return!0}get effects(){return this._effects}}class sG{constructor(t,e){if(!e)throw new Error("invalid_parser");this._badgeId="ACH_"+t+e.readInt(),this._limit=e.readInt()}get badgeId(){return this._badgeId}get limit(){return this._limit}}class iG{flush(){return this._data=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;){const s=t.readString(),i=t.readInt();let n=0;for(;n<i;)this._data.push(new sG(s,t)),n++;e--}return!0}get data(){return this._data}}class rG{flush(){return this._badgeId=0,this._badgeCode=null,!0}parse(t){return t?(this._badgeId=t.readInt(),this._badgeCode=t.readString(),!0):!1}get badgeId(){return this._badgeId}get badgeCode(){return this._badgeCode}}class nG{flush(){return this._allBadgeCodes=[],this._activeBadgeCodes=null,this._badgeIds=null,!0}parse(t){if(!t)return!1;this._allBadgeCodes=[],this._activeBadgeCodes=[],this._badgeIds=new hs;let e=t.readInt();for(;e>0;){const s=t.readInt(),i=t.readString();this._badgeIds.add(i,s),this._allBadgeCodes.push(i),e--}for(e=t.readInt();e>0;){t.readInt();const s=t.readString();this._activeBadgeCodes.push(s),e--}return!0}getBadgeId(t){return this._badgeIds.getValue(t)}getAllBadgeCodes(){return this._allBadgeCodes}getActiveBadgeCodes(){return this._activeBadgeCodes}}class aG{flush(){return!0}parse(t){return t?(this._requestCode=t.readString(),this._fulfilled=t.readBoolean(),!0):!1}get requestCode(){return this._requestCode}get fulfilled(){return this._fulfilled}}class oG{flush(){return this._figureSetIds=[],this._boundFurnitureNames=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._figureSetIds.push(t.readInt()),e--;let s=t.readInt();for(;s>0;)this._boundFurnitureNames.push(t.readString()),s--;return!0}get figureSetIds(){return this._figureSetIds}get boundsFurnitureNames(){return this._boundFurnitureNames}}const Su=class Su{flush(){return this._reason=0,this._parameter="",!0}parse(t){return t?(this._reason=t.readInt(),this._parameter=t.readString(),!0):!1}get reason(){return this._reason}get parameter(){return this._parameter}};Su.REASON_FULL=1,Su.REASON_CLOSED=2,Su.REASON_QUEUE_ERROR=3,Su.REASON_BANNED=4;let Ju=Su;class lG{flush(){return this._userName=null,!0}parse(t){return t?(this._userName=t.readString(),!0):!1}get userName(){return this._userName}}class cG{flush(){return!0}parse(t){return!!t}}class uG{flush(){return!0}parse(t){return!!t}}class hG{flush(){return this._controllerLevel=Oe.NONE,!0}parse(t){return t?(this._controllerLevel=t.readInt(),!0):!1}get controllerLevel(){return this._controllerLevel}}class dG{flush(){return!0}parse(t){return!!t}}class _G{flush(){return this._roomId=0,!0}parse(t){return t?(this._roomId=t.readInt(),!0):!1}get roomId(){return this._roomId}}class gG{flush(){return this._botId=-1,this._commandId=-1,this._data="",!0}parse(t){return t?(this._botId=t.readInt(),this._commandId=t.readInt(),this._data=t.readString(),!0):!1}get botId(){return this._botId}get commandId(){return this._commandId}get data(){return this._data}}class fG{flush(){return this._botId=-1,!0}parse(t){return t?(this._botId=t.readInt(),!0):!1}get botId(){return this._botId}}class mG{constructor(t){this._id=t.readInt(),this._data=t.readString()}get id(){return this._id}get data(){return this._data}}class EG{flush(){return this._botId=-1,this._skillList=[],!0}parse(t){if(!t)return!1;this._botId=t.readInt();let e=t.readInt();for(;e>0;)this._skillList.push(new mG(t)),e--;return!0}get botId(){return this._botId}get skillList(){return this._skillList}}class pG{constructor(t){this._userId=t.readInt(),this._userName=t.readString()}get userId(){return this._userId}get userName(){return this._userName}}class IG{flush(){return this._roomId=0,this._bannedUsers=[],!0}parse(t){if(!t)return!1;this._roomId=t.readInt();let e=t.readInt();for(;e>0;)this._bannedUsers.push(new pG(t)),e--;return!0}get roomId(){return this._roomId}get bannedUsers(){return this._bannedUsers}}class TG{constructor(t){this._userId=t.readInt(),this._userName=t.readString()}get userId(){return this._userId}get userName(){return this._userName}get selected(){return this._selected}set selected(t){this._selected=t}}class RG{flush(){return this._roomId=0,this._data=null,!0}parse(t){return t?(this._roomId=t.readInt(),this._data=new TG(t),!0):!1}get roomId(){return this._roomId}get data(){return this._data}}class SG{flush(){return this._roomId=0,this._userId=0,!0}parse(t){return t?(this._roomId=t.readInt(),this._userId=t.readInt(),!0):!1}get roomId(){return this._roomId}get userId(){return this._userId}}class OG{flush(){return this._roomId=0,this._users=new Map,!0}parse(t){if(!t)return!1;this._roomId=t.readInt();let e=t.readInt();for(;e>0;){const s=t.readInt(),i=t.readString();this._users.set(s,i),e--}return!0}get roomId(){return this._roomId}get users(){return this._users}}class CG{flush(){return!0}parse(t){return t?(this._isMuted=t.readBoolean(),!0):!1}get isMuted(){return this._isMuted}}class AG{flush(){return this._roomId=0,!0}parse(t){return t?(this._roomId=t.readInt(),!0):!1}get roomId(){return this._roomId}}const Dr=class Dr{constructor(t){if(!t)throw new Error("invalid_wrapper");this._mode=t.readInt(),this._weight=t.readInt(),this._speed=t.readInt(),this._distance=t.readInt(),this._protection=t.readInt()}get mode(){return this._mode}get weight(){return this._weight}get speed(){return this._speed}get distance(){return this._distance}get protection(){return this._protection}};Dr.CHAT_MODE_FREE_FLOW=0,Dr.CHAT_MODE_LINE_BY_LINE=1,Dr.CHAT_BUBBLE_WIDTH_WIDE=0,Dr.CHAT_BUBBLE_WIDTH_NORMAL=1,Dr.CHAT_BUBBLE_WIDTH_THIN=2,Dr.CHAT_SCROLL_SPEED_FAST=0,Dr.CHAT_SCROLL_SPEED_NORMAL=1,Dr.CHAT_SCROLL_SPEED_SLOW=2,Dr.FLOOD_FILTER_STRICT=0,Dr.FLOOD_FILTER_NORMAL=1,Dr.FLOOD_FILTER_LOOSE=2;let ns=Dr;const sd=class sd{constructor(t){this._allowMute=t.readInt(),this._allowKick=t.readInt(),this._allowBan=t.readInt()}get allowMute(){return this._allowMute}get allowKick(){return this._allowKick}get allowBan(){return this._allowBan}};sd.MODERATION_LEVEL_NONE=0,sd.MODERATION_LEVEL_USER_WITH_RIGHTS=1,sd.MODERATION_LEVEL_ALL=2;let tr=sd;const oi=class oi{constructor(){this._roomId=-1,this._name=null,this._description=null,this._doorMode=oi.DOORMODE_OPEN,this._categoryId=-1,this._maximumVisitors=0,this._maximumVisitorsLimit=0,this._tags=[],this._tradeMode=oi.TRADEMODE_NOT_ALLOWED,this._allowPets=!1,this._allowFoodConsume=!1,this._allowWalkThrough=!1,this._hideWalls=!1,this._wallThickness=0,this._floorThickness=0,this._controllersById=new Map,this._controllerList=null,this._highlightedUserId=-1,this._bannedUsersById=new Map,this._bannedUsersList=null,this._roomModerationSettings=null,this._chatSettings=null,this._allowNavigatorDynamicCats=!1}static from(t){const e=new oi;return e._roomId=t._roomId,e._name=t._name,e._description=t._description,e._doorMode=t._doorMode,e._categoryId=t._categoryId,e._maximumVisitors=t._maximumVisitors,e._maximumVisitorsLimit=t._maximumVisitorsLimit,e._tags=t._tags,e._tradeMode=t._tradeMode,e._allowPets=t._allowPets,e._allowFoodConsume=t._allowFoodConsume,e._allowWalkThrough=t._allowWalkThrough,e._hideWalls=t._hideWalls,e._wallThickness=t._wallThickness,e._floorThickness=t._floorThickness,e._controllersById=t._controllersById,e._controllerList=t._controllerList,e._highlightedUserId=t._highlightedUserId,e._bannedUsersById=t._bannedUsersById,e._bannedUsersList=t._bannedUsersList,e._roomModerationSettings=t._roomModerationSettings,e._chatSettings=t._chatSettings,e._allowNavigatorDynamicCats=t._allowNavigatorDynamicCats,e}static getDoorModeLocalizationKey(t){switch(t){case oi.DOORMODE_OPEN:return"${navigator.door.mode.open}";case oi.DOORMODE_CLOSED:return"${navigator.door.mode.closed}";case oi.DOORMODE_PASSWORD:return"${navigator.door.mode.password}";case oi.DOORMODE_INVISIBLE:return"${navigator.door.mode.invisible}";case oi.DOORMODE_NOOBS_ONLY:return"${navigator.door.mode.noobs_only}"}return""}get tradeMode(){return this._tradeMode}set tradeMode(t){this._tradeMode=t}get allowPets(){return this._allowPets}set allowPets(t){this._allowPets=t}get allowFoodConsume(){return this._allowFoodConsume}set allowFoodConsume(t){this._allowFoodConsume=t}get allowWalkThrough(){return this._allowWalkThrough}set allowWalkThrough(t){this._allowWalkThrough=t}get hideWalls(){return this._hideWalls}set hideWalls(t){this._hideWalls=t}get wallThickness(){return this._wallThickness}set wallThickness(t){this._wallThickness=t}get floorThickness(){return this._floorThickness}set floorThickness(t){this._floorThickness=t}get roomId(){return this._roomId}set roomId(t){this._roomId=t}get name(){return this._name}set name(t){this._name=t}get description(){return this._description}set description(t){this._description=t}get doorMode(){return this._doorMode}set doorMode(t){this._doorMode=t}get categoryId(){return this._categoryId}set categoryId(t){this._categoryId=t}get maximumVisitors(){return this._maximumVisitors}set maximumVisitors(t){this._maximumVisitors=t}get maximumVisitorsLimit(){return this._maximumVisitorsLimit}set maximumVisitorsLimit(t){this._maximumVisitorsLimit=t}get tags(){return this._tags}set tags(t){this._tags=t}setFlatController(t,e){this._controllersById.set(t,e),this._controllerList=null,this._highlightedUserId=t}get roomModerationSettings(){return this._roomModerationSettings}set roomModerationSettings(t){this._roomModerationSettings=t}get controllersById(){return this._controllersById}set controllersById(t){this._controllersById=t}get controllerList(){if(!this._controllerList){this._controllerList=[];for(const t of this._controllersById.values())this._controllerList.push(t);this._controllerList.sort((t,e)=>t.userName.localeCompare(e.userName))}return this._controllerList}get highlightedUserId(){return this._highlightedUserId}setBannedUser(t,e){this._bannedUsersById.set(t,e),this._bannedUsersList=null}get bannedUsersById(){return this._bannedUsersById}get bannedUsersList(){if(!this._bannedUsersList){this._bannedUsersList=[];for(const t of this._bannedUsersById.values())this._bannedUsersList.push(t);this._bannedUsersList.sort((t,e)=>t.userName.localeCompare(e.userName))}return this._bannedUsersList}get chatSettings(){return this._chatSettings}set chatSettings(t){this._chatSettings=t}get allowNavigatorDynamicCats(){return this._allowNavigatorDynamicCats}set allowNavigatorDynamicCats(t){this._allowNavigatorDynamicCats=t}};oi.DOORMODE_OPEN=0,oi.DOORMODE_CLOSED=1,oi.DOORMODE_PASSWORD=2,oi.DOORMODE_INVISIBLE=3,oi.DOORMODE_NOOBS_ONLY=4,oi.TRADEMODE_NOT_ALLOWED=0,oi.TRADEMODE_WITH_CONTROLLER=1,oi.TRADEMODE_ALLOWED=2;let bI=oi;class NG{flush(){return this._roomSettingsData=null,!0}parse(t){if(!t)return!1;this._roomSettingsData=new bI,this._roomSettingsData.roomId=t.readInt(),this._roomSettingsData.name=t.readString(),this._roomSettingsData.description=t.readString(),this._roomSettingsData.doorMode=t.readInt(),this._roomSettingsData.categoryId=t.readInt(),this._roomSettingsData.maximumVisitors=t.readInt(),this._roomSettingsData.maximumVisitorsLimit=t.readInt(),this._roomSettingsData.tags=[];let e=t.readInt();for(;e>0;)this._roomSettingsData.tags.push(t.readString()),e--;return this._roomSettingsData.tradeMode=t.readInt(),this._roomSettingsData.allowPets=t.readInt()===1,this._roomSettingsData.allowFoodConsume=t.readInt()===1,this._roomSettingsData.allowWalkThrough=t.readInt()===1,this._roomSettingsData.hideWalls=t.readInt()===1,this._roomSettingsData.wallThickness=t.readInt(),this._roomSettingsData.floorThickness=t.readInt(),this._roomSettingsData.chatSettings=new ns(t),this._roomSettingsData.allowNavigatorDynamicCats=t.readBoolean(),this._roomSettingsData.roomModerationSettings=new tr(t),!0}get data(){return this._roomSettingsData}}class xG{flush(){return this._roomId=0,this._code=0,!0}parse(t){return t?(this._roomId=t.readInt(),this._code=t.readInt(),!0):!1}get roomId(){return this._roomId}get code(){return this._code}}class MG{flush(){return this._roomId=0,!0}parse(t){return t?(this._roomId=t.readInt(),!0):!1}get roomId(){return this._roomId}}const Yi=class Yi{flush(){return this._roomId=0,this._code=0,this._message=null,!0}parse(t){return t?(this._roomId=t.readInt(),this._code=t.readInt(),this._message=t.readString(),!0):!1}get roomId(){return this._roomId}get code(){return this._code}get message(){return this._message}};Yi.ERROR_ROOM_NOT_FOUND=1,Yi.ERROR_NOT_OWNER=2,Yi.ERROR_INVALID_DOOR_MODE=3,Yi.ERROR_INVALID_USER_LIMIT=4,Yi.ERROR_INVALID_PASSWORD=5,Yi.ERROR_INVALID_CATEGORY=6,Yi.ERROR_INVALID_NAME=7,Yi.ERROR_UNACCEPTABLE_NAME=8,Yi.ERROR_INVALID_DESCRIPTION=9,Yi.ERROR_UNACCEPTABLE_DESCRIPTION=10,Yi.ERROR_INVALID_TAG=11,Yi.ERROR_NON_USER_CHOOSABLE_TAG=12,Yi.ERROR_TOO_MANY_CHARACTERS_IN_TAG=13;let Xd=Yi;class yG{flush(){return this._selectionType=0,!0}parse(t){return t?(this._selectionType=t.readInt(),!0):!1}get selectionType(){return this._selectionType}}class DG{flush(){return this._roomId=0,this._userId=0,!0}parse(t){return t?(this._roomId=t.readInt(),this._userId=t.readInt(),!0):!1}get roomId(){return this._roomId}get userId(){return this._userId}}class bG{flush(){return this._chat=null,!0}parse(t){return t?(this._chat=new ns(t),!0):!1}get chat(){return this._chat}}const Zs=class Zs{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._roomId=0,this._roomName=null,this._ownerId=0,this._ownerName=null,this._doorMode=0,this._userCount=0,this._maxUserCount=0,this._description=null,this._tradeMode=2,this._score=0,this._ranking=0,this._categoryId=0,this._totalStars=0,this._groupId=0,this._groupName=null,this._groupBadge=null,this._tags=[],this._bitMask=0,this._thumbnail=null,this._allowPets=!1,this._showOwner=!0,this._displayAd=!1,this._adName=null,this._adDescription=null,this._adExpiresIn=0,this._allInRoomMuted=!1,this._canMute=!1,this._officialRoomPicRef=null,!0}parse(t){return t?(this._roomId=t.readInt(),this._roomName=t.readString(),this._ownerId=t.readInt(),this._ownerName=t.readString(),this._doorMode=t.readInt(),this._userCount=t.readInt(),this._maxUserCount=t.readInt(),this._description=t.readString(),this._tradeMode=t.readInt(),this._score=t.readInt(),this._ranking=t.readInt(),this._categoryId=t.readInt(),this.parseTags(t),this.parseBitMask(t),!0):!1}parseTags(t){if(!t)return!1;this._tags=[];let e=t.readInt();for(;e>0;)this._tags.push(t.readString()),e--;return!0}parseBitMask(t){return t?(this._bitMask=t.readInt(),this._bitMask&Zs.THUMBNAIL_BITMASK&&(this._officialRoomPicRef=t.readString()),this._bitMask&Zs.GROUPDATA_BITMASK&&(this._groupId=t.readInt(),this._groupName=t.readString(),this._groupBadge=t.readString()),this._bitMask&Zs.ROOMAD_BITMASK&&(this._adName=t.readString(),this._adDescription=t.readString(),this._adExpiresIn=t.readInt()),this._showOwner=(this._bitMask&Zs.SHOWOWNER_BITMASK)>0,this._allowPets=(this._bitMask&Zs.ALLOW_PETS_BITMASK)>0,this._displayAd=(this._bitMask&Zs.DISPLAY_ROOMAD_BITMASK)>0,this._thumbnail=null,!0):!1}get roomId(){return this._roomId}get roomName(){return this._roomName}set roomName(t){this._roomName=t}get ownerId(){return this._ownerId}get ownerName(){return this._ownerName}get doorMode(){return this._doorMode}get userCount(){return this._userCount}get maxUserCount(){return this._maxUserCount}get description(){return this._description}get tradeMode(){return this._tradeMode}get score(){return this._score}get ranking(){return this._ranking}get categoryId(){return this._categoryId}get tags(){return this._tags}get officialRoomPicRef(){return this._officialRoomPicRef}get habboGroupId(){return this._groupId}get groupName(){return this._groupName}get groupBadgeCode(){return this._groupBadge}get roomAdName(){return this._adName}get roomAdDescription(){return this._adDescription}get roomAdExpiresInMin(){return this._adExpiresIn}get showOwner(){return this._showOwner}get allowPets(){return this._allowPets}get displayRoomEntryAd(){return this._displayAd}get canMute(){return this._canMute}set canMute(t){this._canMute=t}get allInRoomMuted(){return this._allInRoomMuted}set allInRoomMuted(t){this._allInRoomMuted=t}};Zs.THUMBNAIL_BITMASK=1,Zs.GROUPDATA_BITMASK=2,Zs.ROOMAD_BITMASK=4,Zs.SHOWOWNER_BITMASK=8,Zs.ALLOW_PETS_BITMASK=16,Zs.DISPLAY_ROOMAD_BITMASK=32,Zs.OPEN_STATE=0,Zs.DOORBELL_STATE=1,Zs.PASSWORD_STATE=2,Zs.INVISIBLE_STATE=3,Zs.NOOB_STATE=4;let De=Zs;class vG{flush(){return this._roomId=0,this._isOwner=!1,!0}parse(t){return t?(this._roomId=t.readInt(),this._isOwner=t.readBoolean(),!0):!1}get roomId(){return this._roomId}get isOwner(){return this._isOwner}}class LG{flush(){return this._totalLikes=0,this._canLike=!1,!0}parse(t){return t?(this._totalLikes=t.readInt(),this._canLike=t.readBoolean(),!0):!1}get totalLikes(){return this._totalLikes}get canLike(){return this._canLike}}class PG{flush(){return this._roomIndex=-1,this._groupId=-1,this._status=0,this._groupName=null,!0}parse(t){return t?(this._roomIndex=t.readInt(),this._groupId=t.readInt(),this._status=t.readInt(),this._groupName=t.readString(),!0):!1}get roomIndex(){return this._roomIndex}get groupId(){return this._groupId}get status(){return this._status}get groupName(){return this._groupName}}class UG{constructor(t,e,s){this._id=0,this._state=0,this._id=t,this._state=e,this._data=s}get id(){return this._id}get state(){return this._state}get data(){return this._data}}class jG{flush(){return this._code=0,!0}parse(t){return t?(this._code=t.readInt(),!0):!1}get count(){return this._code}}class wG{flush(){return this._itemId=0,this._value=0,!0}parse(t){return t?(this._itemId=t.readInt(),this._value=t.readInt(),!0):!1}get itemId(){return this._itemId}get value(){return this._value}}class To{flush(){return this._itemId=0,this._data=null,!0}parse(t){return t?(this._itemId=parseInt(t.readString()),this._data=To.parseObjectData(t),!0):!1}static parseObjectData(t){if(!t)return null;const e=Aa.getData(t.readInt());return e?(e.parseWrapper(t),e):null}get furnitureId(){return this._itemId}get objectData(){return this._data}}class pS{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._itemId=0,this._spriteId=0,this._spriteName=null,this._x=0,this._y=0,this._direction=0,this._z=0,this._stackHeight=0,this._extra=0,this._data=null,this._state=0,this._expires=0,this._usagePolicy=0,this._userId=0,this._username=null,this._rareValue=0,this._validRare=!1,this._winReason=null,!0}parse(t){return t?(this._itemId=t.readInt(),this._spriteId=t.readInt(),this._x=t.readInt(),this._y=t.readInt(),this._direction=t.readInt()%8*45,this._z=parseFloat(t.readString()),this._stackHeight=parseFloat(t.readString()),this._extra=t.readInt(),this._data=To.parseObjectData(t),this._state=parseFloat(this._data&&this._data.getLegacyString())||0,this._expires=t.readInt(),this._usagePolicy=t.readInt(),this._userId=t.readInt(),this._username=null,this._spriteId<0&&(this._spriteName=t.readString()),this._rareValue=t.readInt(),this._validRare=t.readBoolean(),this._winReason=t.readString(),!0):!1}get winReason(){return this._winReason}get validRare(){return this._validRare}get rareValue(){return this._rareValue}get itemId(){return this._itemId}get spriteId(){return this._spriteId}get x(){return this._x}get y(){return this._y}get direction(){return this._direction}get z(){return isNaN(this._z)?0:this._z}get stackHeight(){return isNaN(this._stackHeight)?0:this._stackHeight}get extra(){return this._extra}get data(){return this._data}get state(){return this._state}get expires(){return this._expires}get usagePolicy(){return this._usagePolicy}get userId(){return this._userId}get username(){return this._username}set username(t){this._username=t}get spriteName(){return this._spriteName}set spriteName(t){this._spriteName=t}}class FG{flush(){return this._item=null,!0}parse(t){return t?(this._item=new pS(t),this._item.username=t.readString(),!0):!1}get item(){return this._item}}class GG{flush(){return this._owners=new Map,this._items=[],!0}parse(t){if(!t||!this.parseOwners(t))return!1;let e=t.readInt();for(;e>0;){const s=new pS(t);if(!s)continue;const i=this._owners.get(s.userId);i&&(s.username=i),this._items.push(s),e--}return!0}parseOwners(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._owners.set(t.readInt(),t.readString()),e--;return!0}get owners(){return this._owners}get items(){return this._items}}class BG{flush(){return this._itemId=0,this._isExpired=!0,this._userId=0,this._delay=0,!0}parse(t){return t?(this._itemId=parseInt(t.readString()),this._isExpired=t.readBoolean(),this._userId=t.readInt(),this._delay=t.readInt(),!0):!1}get itemId(){return this._itemId}get isExpired(){return this._isExpired}get userId(){return this._userId}get delay(){return this._delay}}class kG{flush(){return this._item=null,!0}parse(t){return t?(this._item=new pS(t),!0):!1}get item(){return this._item}}class VG{flush(){return this._isWallItem=!1,this._furniTypeName=null,this._buyout=!1,this._priceInCredits=-1,this._priceInActivityPoints=-1,this._activityPointType=-1,!0}parse(t){return t?(this._isWallItem=t.readBoolean(),this._furniTypeName=t.readString(),this._buyout=t.readBoolean(),this._priceInCredits=t.readInt(),this._priceInActivityPoints=t.readInt(),this._activityPointType=t.readInt(),!0):!1}get isWallItem(){return this._isWallItem}get furniTypeName(){return this._furniTypeName}get buyout(){return this._buyout}get priceInCredits(){return this._priceInCredits}get priceInActivityPoints(){return this._priceInActivityPoints}get activityPointType(){return this._activityPointType}}class HG{flush(){return this._aliases=new Map,!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._aliases.set(t.readString(),t.readString()),e--;return!0}get aliases(){return this._aliases}}class WG{flush(){return this._furniId=-1,this._height=0,!0}parse(t){return t?(this._furniId=t.readInt(),this._height=t.readInt()/100,!0):!1}get furniId(){return this._furniId}get height(){return this._height}}class YG{flush(){return this._objectId=0,this._guildId=0,this._guildName=null,this._guildHomeRoomId=0,this._userIsMember=!1,this._guildHasReadableForum=!1,!0}parse(t){return t?(this._objectId=t.readInt(),this._guildId=t.readInt(),this._guildName=t.readString(),this._guildHomeRoomId=t.readInt(),this._userIsMember=t.readBoolean(),this._guildHasReadableForum=t.readBoolean(),!0):!1}get objectId(){return this._objectId}get guildId(){return this._guildId}get guildName(){return this._guildName}get guildHomeRoomId(){return this._guildHomeRoomId}get userIsMember(){return this._userIsMember}get guildHasReadableForum(){return this._guildHasReadableForum}}class zG{flush(){return this._itemId=0,this._data="",!0}parse(t){return t?(this._itemId=parseInt(t.readString()),this._data=t.readString(),!0):!1}get furnitureId(){return this._itemId}get data(){return this._data}}class KG{get furniId(){return this._furniId}flush(){return this._furniId=-1,!0}parse(t){return this._furniId=t.readInt(),!0}}class XG{get furniId(){return this._furniId}flush(){return this._furniId=-1,!0}parse(t){return this._furniId=t.readInt(),!0}}class qG{get furniId(){return this._furniId}get start(){return this._start}flush(){return this._furniId=-1,this._start=!1,!0}parse(t){return this._furniId=t.readInt(),this._start=t.readBoolean(),!0}}class QG{flush(){return this._itemId=0,this._state=0,!0}parse(t){return t?(this._itemId=t.readInt(),this._state=t.readInt(),!0):!1}get itemId(){return this._itemId}get state(){return this._state}}class JG{flush(){return!0}parse(t){return t?(this._reason=t.readInt(),!0):!1}get reason(){return this._reason}}class $G{flush(){return!0}parse(t){return t?(this._expiryTime=t.readInt(),!0):!1}get expiryTime(){return this._expiryTime}}const $r=class $r{flush(){return this._rented=!1,this._renterId=-1,this._renterName=null,this._canRent=!1,this._canRentErrorCode=-1,this._timeRemaining=-1,this._price=-1,!0}parse(t){return t?(this._rented=t.readBoolean(),this._canRentErrorCode=t.readInt(),this._canRent=this._canRentErrorCode===0,this._renterId=t.readInt(),this._renterName=t.readString(),this._timeRemaining=t.readInt(),this._price=t.readInt(),this._rented||(this._renterId=-1,this._renterName=""),!0):!1}get rented(){return this._rented}get renterId(){return this._renterId}get renterName(){return this._renterName}get canRent(){return this._canRent}get price(){return this._price}get timeRemaining(){return this._timeRemaining}get canRentErrorCode(){return this._canRentErrorCode}};$r.SPACE_ALREADY_RENTED=100,$r.SPACE_EXTEND_NOT_RENTED=101,$r.SPACE_EXTEND_NOT_RENTED_BY_YOU=102,$r.CAN_RENT_ONLY_ONE_SPACE=103,$r.NOT_ENOUGH_CREDITS=200,$r.NOT_ENOUGH_PIXELS=201,$r.CANT_RENT_NO_PERMISSION=202,$r.CANT_RENT_NO_HABBO_CLUB=203,$r.CANT_RENT=300,$r.CANT_RENT_GENERIC=400;let vI=$r;class ZG{flush(){return this._itemId=-1,this._location="",!0}parse(t){return t?(this._itemId=t.readInt(),this._location=t.readString(),!0):!1}get itemId(){return this._itemId}get location(){return this._location}}class tB{constructor(t,e,s,i){this.id=t,this.type=e,this.color=s,this.brightness=i}}class eB{constructor(){this._selectedPresetId=0,this._presets=[]}flush(){return this._presets=[],!0}parse(t){const e=t.readInt();this._selectedPresetId=t.readInt();for(let s=0;s<e;s++){const i=t.readInt(),n=t.readInt(),o=parseInt(t.readString().substr(1),16),l=t.readInt();this._presets.push(new tB(i,n,o,l))}return!0}getPreset(t){return t<0||t>=this.presetCount?null:this._presets[t]}get presetCount(){return this._presets.length}get selectedPresetId(){return this._selectedPresetId}}class sB{flush(){return this._roomId=-1,this._roomName=null,this._messageCount=-1,!0}parse(t){return t?(this._roomId=t.readInt(),this._roomName=t.readString(),this._messageCount=t.readInt(),!0):!1}get roomId(){return this._roomId}get roomName(){return this._roomName}get messageCount(){return this._messageCount}}class IS{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._itemId=0,this._spriteId=0,this._location=null,this._stuffData=null,this._state=0,this._secondsToExpiration=0,this._usagePolicy=-1,this._userId=0,this._username=null,this._rareValue=0,this._data=null,this._width=0,this._height=0,this._localX=0,this._localY=0,this._y=0,this._z=0,this._direction=null,this._isOldFormat=!1,this._validRare=!1,this._winReason=null,!0}parse(t){if(!t)return!1;this._itemId=parseInt(t.readString()),this._spriteId=t.readInt(),this._location=t.readString(),this._stuffData=t.readString(),this._secondsToExpiration=t.readInt(),this._usagePolicy=t.readInt(),this._userId=t.readInt(),this._rareValue=t.readInt(),this._validRare=t.readBoolean(),this._winReason=t.readString(),this._data=To.parseObjectData(t),this._username=null;const e=parseFloat(this._stuffData);if(isNaN(e)||(this._state=Math.trunc(e)),this._location.indexOf(":")===0){this._isOldFormat=!1;let s=this._location.split(" ");if(s.length>=3){let i=s[0],n=s[1];const o=s[2];if(i.length>3&&n.length>2&&(i=i.substr(3),n=n.substr(2),s=i.split(","),s.length>=2)){const l=parseInt(s[0]),c=parseInt(s[1]);if(s=n.split(","),s.length>=2){const u=parseInt(s[0]),h=parseInt(s[1]);this._width=l,this._height=c,this._localX=u,this._localY=h,this._direction=o}}}}else this._isOldFormat=!0;return!0}get winReason(){return this._winReason}get validRare(){return this._validRare}get rareValue(){return this._rareValue}get itemId(){return this._itemId}get spriteId(){return this._spriteId}get wallPosition(){return this._location}get stuffData(){return this._stuffData}get state(){return this._state}get secondsToExpiration(){return this._secondsToExpiration}get usagePolicy(){return this._usagePolicy}get userId(){return this._userId}get username(){return this._username}set username(t){this._username=t}get width(){return this._width}get height(){return this._height}get localX(){return this._localX}get localY(){return this._localY}get direction(){return this._direction}get isOldFormat(){return this._isOldFormat}get data(){return this._data}}class iB{flush(){return this._item=null,!0}parse(t){return t?(this._item=new IS(t),this._item.username=t.readString(),!0):!1}get item(){return this._item}}class rB{flush(){return this._owners=new Map,this._items=[],!0}parse(t){if(!t||!this.parseOwners(t))return!1;let e=t.readInt();for(;e>0;){const s=new IS(t);if(!s)continue;const i=this._owners.get(s.userId);i&&(s.username=i),this._items.push(s),e--}return!0}parseOwners(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._owners.set(t.readInt(),t.readString()),e--;return!0}get owners(){return this._owners}get items(){return this._items}}class nB{flush(){return this._itemId=0,this._userId=0,!0}parse(t){return t?(this._itemId=parseInt(t.readString()),this._userId=t.readInt(),!0):!1}get itemId(){return this._itemId}get userId(){return this._userId}}class aB{flush(){return this._item=null,!0}parse(t){return t?(this._item=new IS(t),!0):!1}get item(){return this._item}}class oB{flush(){return this._email=null,this._isVerified=!1,this._allowChange=!1,this._furniId=-1,this._requestedByUser=!1,!0}parse(t){return t?(this._email=t.readString(),this._isVerified=t.readBoolean(),this._allowChange=t.readBoolean(),this._furniId=t.readInt(),this._requestedByUser=t.readBoolean(),!0):!1}get email(){return this._email}get isVerified(){return this._isVerified}get allowChange(){return this._allowChange}get furniId(){return this._furniId}get requestedByUser(){return this._requestedByUser}}class lB{parse(t){return this._furniId=t.readInt(),this._commandId=t.readInt(),!0}flush(){return this._furniId=-1,this._commandId=-1,!0}get furniId(){return this._furniId}get commandId(){return this._commandId}}class cB{constructor(t,e,s){this._video=t,this._title=e,this._description=s}get video(){return this._video}get title(){return this._title}get description(){return this._description}}class uB{flush(){return this._furniId=-1,this._playlists=null,this._selectedPlaylistId=null,!0}parse(t){this._furniId=t.readInt();const e=t.readInt();this._playlists=[];for(let s=0;s<e;s++)this._playlists.push(new cB(t.readString(),t.readString(),t.readString()));return this._selectedPlaylistId=t.readString(),!0}get furniId(){return this._furniId}get playlists(){return this._playlists}get selectedPlaylistId(){return this._selectedPlaylistId}}class hB{flush(){return!0}parse(t){return this._furniId=t.readInt(),this._videoId=t.readString(),this._startAtSeconds=t.readInt(),this._endAtSeconds=t.readInt(),this._state=t.readInt(),!0}get furniId(){return this._furniId}get videoId(){return this._videoId}get state(){return this._state}get startAtSeconds(){return this._startAtSeconds}get endAtSeconds(){return this._endAtSeconds}}class dB{flush(){return this._objects=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;){const s=t.readInt(),i=To.parseObjectData(t),n=parseFloat(i.getLegacyString());this._objects.push(new UG(s,n,i)),e--}return!0}get objects(){return this._objects}}class _B{flush(){return this._rollerId=0,this._itemsRolling=[],this._unitRolling=null,!0}parse(t){if(!t)return!1;const e=t.readInt(),s=t.readInt(),i=t.readInt(),n=t.readInt();let o=t.readInt();for(;o>0;){const d=t.readInt(),g=parseFloat(t.readString()),E=parseFloat(t.readString()),m=new ao(d,new j(e,s,g),new j(i,n,E));this._itemsRolling.push(m),o--}if(this._rollerId=t.readInt(),!t.bytesAvailable)return!0;const l=t.readInt(),c=t.readInt(),u=parseFloat(t.readString()),h=parseFloat(t.readString());switch(l){case 0:break;case 1:this._unitRolling=new ao(c,new j(e,s,u),new j(i,n,h),ao.MOVE);break;case 2:this._unitRolling=new ao(c,new j(e,s,u),new j(i,n,h),ao.SLIDE);break}return!0}get rollerId(){return this._rollerId}get itemsRolling(){return this._itemsRolling}get unitRolling(){return this._unitRolling}}const id=class id{flush(){return this._model=null,this._width=0,this._height=0,this._wallHeight=-1,this._heightMap=[],this._scale=64,this._model=null,!0}parse(t){if(!t)return!1;const e=t.readBoolean(),s=t.readInt(),i=t.readString();return this.parseExplicitly(i,s,e)}parseModel(t,e,s=!0){return this.parseExplicitly(t,e,s)}parseExplicitly(t,e,s=!0){this._scale=s?32:64,this._wallHeight=e,this._model=t;const i=this._model.split("\r"),n=i.length;let o=0,l=0;for(;l<n;){const c=i[l];c.length>o&&(o=c.length),l++}for(this._heightMap=[],l=0;l<n;){const c=[];let u=0;for(;u<o;)c.push(id.TILE_BLOCKED),u++;this._heightMap.push(c),l++}for(this._width=o,this._height=n,l=0;l<n;){const c=this._heightMap[l],u=i[l];if(u.length>0){let h=0;for(;h<u.length;){const d=u.charAt(h);let g=id.TILE_BLOCKED;d!=="x"&&d!=="X"&&(g=parseInt(d,36)),c[h]=g,h++}}l++}return!0}getHeight(t,e){if(t<0||t>=this._width||e<0||e>=this._height)return-110;const s=this._heightMap[e];if(s===void 0)return-110;const i=s[t];return i===void 0?-110:i}get model(){return this._model}get width(){return this._width}get height(){return this._height}get heightMap(){return this._heightMap}get wallHeight(){return this._wallHeight}get scale(){return this._scale}};id.TILE_BLOCKED=-110;let Gg=id;class gB{flush(){return this._x=0,this._y=0,this._direction=0,!0}parse(t){return t?(this._x=t.readInt(),this._y=t.readInt(),this._direction=t.readInt(),!0):!1}get x(){return this._x}get y(){return this._y}get direction(){return this._direction}}class rl{static decodeTileHeight(t){return t<0?-1:(t&16383)/256}static decodeIsStackingBlocked(t){return!!(t&16384)}static decodeIsRoomTile(t){return t>=0}getTileHeight(t,e){return t<0||t>=this._width||e<0||e>=this._height?-1:rl.decodeTileHeight(this._heights[e*this._width+t])}getStackingBlocked(t,e){return t<0||t>=this._width||e<0||e>=this._height?!0:rl.decodeIsStackingBlocked(this._heights[e*this._width+t])}isRoomTile(t,e){return t<0||t>=this._width||e<0||e>=this._height?!1:rl.decodeIsRoomTile(this._heights[e*this._width+t])}flush(){return this._width=0,this._height=0,this._heights=[],!0}parse(t){if(!t)return!1;this._width=t.readInt();const e=t.readInt();this._height=e/this._width;let s=0;for(;s<e;)this._heights[s]=t.readShort(),s++;return!0}get width(){return this._width}get height(){return this._height}get heights(){return this._heights}}class fB{flush(){return this._wrapper=null,this._count=0,this._x=0,this._y=0,this._value=0,!0}tileHeight(){return rl.decodeTileHeight(this._value)}isStackingBlocked(){return rl.decodeIsStackingBlocked(this._value)}isRoomTile(){return rl.decodeIsRoomTile(this._value)}next(){return this._count?(this._count--,this._x=this._wrapper.readByte(),this._y=this._wrapper.readByte(),this._value=this._wrapper.readShort(),!0):!1}parse(t){return t?(this._wrapper=t,this._count=t.readByte(),!0):!1}get x(){return this._x}get y(){return this._y}get height(){return this._value}}class mB{flush(){return this._blockedTilesMap=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;){const s=t.readInt(),i=t.readInt();this._blockedTilesMap[i]||(this._blockedTilesMap[i]=[]),this._blockedTilesMap[i][s]=!0,e--}return!0}get blockedTilesMap(){return this._blockedTilesMap}}class EB{flush(){return this._floorType=null,this._wallType=null,this._landscapeType=null,this._landscapeAnimation=null,!0}parse(t){if(!t)return!1;const e=t.readString(),s=t.readString();switch(e){case"floor":this._floorType=s;break;case"wallpaper":this._wallType=s;break;case"landscape":this._landscapeType=s;break;case"landscapeanim":this._landscapeAnimation=s;break}return!0}get floorType(){return this._floorType}get wallType(){return this._wallType}get landscapeType(){return this._landscapeType}get landscapeAnimation(){return this._landscapeAnimation}}class pB{flush(){return this._name=null,this._roomId=0,!0}parse(t){return t?(this._name=t.readString(),this._roomId=t.readInt(),!0):!1}get name(){return this._name}get roomId(){return this._roomId}}class IB{flush(){return this._hideWalls=!1,this._thicknessWall=0,this._thicknessFloor=0,!0}parse(t){if(!t)return!1;this._hideWalls=t.readBoolean();let e=t.readInt(),s=t.readInt();return e=e<-2?-2:e>1?1:e,s=s<-2?-2:s>1?1:s,this._thicknessWall=Math.pow(2,e),this._thicknessFloor=Math.pow(2,s),!0}get hideWalls(){return this._hideWalls}get thicknessWall(){return this._thicknessWall}get thicknessFloor(){return this._thicknessFloor}}class YC{constructor(t){if(!t)throw new Error("invalid_wrapper");this._webId=t.readInt(),this._name=t.readString(),this._level=t.readInt(),this._figure=t.readString(),this._owner=t.readString()}dispose(){this._webId=0,this._name="",this._level=0,this._figure="",this._owner=""}get webId(){return this._webId}get name(){return this._name}get level(){return this._level}get figure(){return this._figure}get owner(){return this._owner}}class zC{constructor(t){this._stuffId=t.readInt(),this._classId=t.readInt(),this._productCode=t.readString(),this._userId=t.readInt(),this._userName=t.readString(),this._rarityLevel=t.readInt(),this._hasMutation=t.readBoolean()}get stuffId(){return this._stuffId}get classId(){return this._classId}get productCode(){return this._productCode}get userId(){return this._userId}get userName(){return this._userName}get rarityLevel(){return this._rarityLevel}get hasMutation(){return this._hasMutation}}class TB{flush(){return this._resultData=null,this._otherResultData=null,!0}parse(t){return t?(this._resultData=new zC(t),this._otherResultData=new zC(t),!0):!1}get resultData(){return this._resultData}get otherResultData(){return this._otherResultData}}class RB{flush(){return this._petId=-1,this._roomIndex=-1,this._gainedExperience=0,!0}parse(t){return t?(this._petId=t.readInt(),this._roomIndex=t.readInt(),this._gainedExperience=t.readInt(),!0):!1}get petId(){return this._petId}get roomIndex(){return this._roomIndex}get gainedExperience(){return this._gainedExperience}}class SB{flush(){return!0}parse(t){return t?(this._roomIndex=t.readInt(),this._petId=t.readInt(),this._figureData=new RS(t),this._hasSaddle=t.readBoolean(),this._isRiding=t.readBoolean(),!0):!1}get roomIndex(){return this._roomIndex}get petId(){return this._petId}get figureData(){return this._figureData}get hasSaddle(){return this._hasSaddle}get isRiding(){return this._isRiding}}class OB{flush(){return this._id=-1,this._skillThresholds=[],!0}parse(t){if(!t)return!1;this._id=t.readInt(),this._name=t.readString(),this._level=t.readInt(),this._maximumLevel=t.readInt(),this._experience=t.readInt(),this._levelExperienceGoal=t.readInt(),this._energy=t.readInt(),this._maximumEnergy=t.readInt(),this._happyness=t.readInt(),this._maximumHappyness=t.readInt(),this._respect=t.readInt(),this._ownerId=t.readInt(),this._age=t.readInt(),this._ownerName=t.readString(),this._rarityLevel=t.readInt(),this._saddle=t.readBoolean(),this._rider=t.readBoolean();let e=t.readInt();for(;e>0;)this._skillThresholds.push(t.readInt()),e--;return this._skillThresholds.sort(),this._publiclyRideable=t.readInt(),this._breedable=t.readBoolean(),this._fullyGrown=t.readBoolean(),this._dead=t.readBoolean(),this._unknownRarity=t.readInt(),this._maximumTimeToLive=t.readInt(),this._remainingTimeToLive=t.readInt(),this._remainingGrowTime=t.readInt(),this._publiclyBreedable=t.readBoolean(),!0}get id(){return this._id}get name(){return this._name}get level(){return this._level}get maximumLevel(){return this._maximumLevel}get experience(){return this._experience}get energy(){return this._energy}get happyness(){return this._happyness}get levelExperienceGoal(){return this._levelExperienceGoal}get maximumEnergy(){return this._maximumEnergy}get maximumHappyness(){return this._maximumHappyness}get respect(){return this._respect}get ownerId(){return this._ownerId}get ownerName(){return this._ownerName}get age(){return this._age}get rarityLevel(){return this._rarityLevel}get saddle(){return this._saddle}get rider(){return this._rider}get breedable(){return this._breedable}get fullyGrown(){return this._fullyGrown}get dead(){return this._dead}get maximumTimeToLive(){return this._maximumTimeToLive}get remainingTimeToLive(){return this._remainingTimeToLive}get remainingGrowTime(){return this._remainingGrowTime}get skillTresholds(){return this._skillThresholds}get publiclyRideable(){return this._publiclyRideable}get unknownRarity(){return this._unknownRarity}get publiclyBreedable(){return this._publiclyBreedable}}class CB{flush(){return this._roomIndex=-1,this._petId=-1,this._canBreed=!1,this._canHarvest=!1,this._canRevive=!1,this._hasBreedingPermission=!1,!0}parse(t){return t?(this._roomIndex=t.readInt(),this._petId=t.readInt(),this._canBreed=t.readBoolean(),this._canHarvest=t.readBoolean(),this._canRevive=t.readBoolean(),this._hasBreedingPermission=t.readBoolean(),!0):!1}get roomIndex(){return this._roomIndex}get petId(){return this._petId}get canBreed(){return this._canBreed}get canHarvest(){return this._canHarvest}get canRevive(){return this._canRevive}get hasBreedingPermission(){return this._hasBreedingPermission}}class AB{constructor(t){if(!t)throw new Error("invalid_wrapper");this._chance=t.readInt(),this._breeds=[];let e=t.readInt();for(;e>0;)this._breeds.push(t.readInt()),e--}dispose(){this._chance=-1,this._breeds=[]}get chance(){return this._chance}get breeds(){return this._breeds}}class NB{flush(){return this._isPlaying=!1,!0}parse(t){return t?(this._isPlaying=t.readBoolean(),!0):!1}get isPlaying(){return this._isPlaying}}class xB{flush(){return!0}parse(t){return!0}}class MB{flush(){return this._seconds=0,!0}parse(t){return t?(this._seconds=t.readInt(),!0):!1}get seconds(){return this._seconds}}class yB{flush(){return this._seconds=0,!0}parse(t){return t?(this._seconds=t.readInt(),!0):!1}get seconds(){return this._seconds}}class TS{flush(){return this._roomIndex=null,this._message=null,this._gesture=0,this._bubble=0,this._urls=[],this._messageLength=0,!0}parse(t){return t?(this._roomIndex=t.readInt(),this._message=t.readString(),this._gesture=t.readInt(),this._bubble=t.readInt(),this.parseUrls(t),this._messageLength=t.readInt(),!0):!1}parseUrls(t){if(!t)return!1;this._urls=[];let e=t.readInt();for(;e>0;)this._urls.push(t.readString()),e--;return!0}get roomIndex(){return this._roomIndex}get message(){return this._message}get gesture(){return this._gesture}get bubble(){return this._bubble}get urls(){return this._urls}get messageLength(){return this._messageLength}}class DB{flush(){return this._unitId=null,this._isTyping=!1,!0}parse(t){return t?(this._unitId=t.readInt(),this._isTyping=t.readInt()===1,!0):!1}get unitId(){return this._unitId}get isTyping(){return this._isTyping}}class bB{flush(){return this._unitId=null,this._danceId=0,!0}parse(t){return t?(this._unitId=t.readInt(),this._danceId=t.readInt(),!0):!1}get unitId(){return this._unitId}get danceId(){return this._danceId}}class vB{flush(){return this._unitId=null,this._effectId=0,this._delay=0,!0}parse(t){return t?(this._unitId=t.readInt(),this._effectId=t.readInt(),this._delay=t.readInt(),!0):!1}get unitId(){return this._unitId}get effectId(){return this._effectId}get delay(){return this._delay}}class LB{flush(){return this._unitId=null,this._expression=0,!0}parse(t){return t?(this._unitId=t.readInt(),this._expression=t.readInt(),!0):!1}get unitId(){return this._unitId}get expression(){return this._expression}}class PB{flush(){return this._unitId=null,this._handId=0,!0}parse(t){return t?(this._unitId=t.readInt(),this._handId=t.readInt(),!0):!1}get unitId(){return this._unitId}get handId(){return this._handId}}class UB{flush(){return this._giverUserId=-1,this._handItemType=-1,!0}parse(t){return t?(this._giverUserId=t.readInt(),this._handItemType=t.readInt(),!0):!1}get giverUserId(){return this._giverUserId}get handItemType(){return this._handItemType}}class jB{flush(){return this._unitId=null,this._isIdle=!1,!0}parse(t){return t?(this._unitId=t.readInt(),this._isIdle=t.readBoolean(),!0):!1}get unitId(){return this._unitId}get isIdle(){return this._isIdle}}class wB{flush(){return this._unitId=null,this._figure=null,this._gender="M",this._motto=null,this._achievementScore=0,!0}parse(t){return t?(this._unitId=t.readInt(),this._figure=t.readString(),this._gender=t.readString().toLocaleUpperCase(),this._motto=t.readString(),this._achievementScore=t.readInt(),!0):!1}get unitId(){return this._unitId}get figure(){return this._figure}get gender(){return this._gender}get motto(){return this._motto}get achievementScore(){return this._achievementScore}}class FB{flush(){return this._unitId=null,this._value=0,!0}parse(t){return t?(this._unitId=t.readInt(),this._value=t.readInt(),!0):!1}get unitId(){return this._unitId}get value(){return this._value}}const Wm=class Wm{constructor(t){this._roomIndex=0,this._x=0,this._y=0,this._z=0,this._dir=0,this._name="",this._userType=0,this._sex="",this._figure="",this._custom="",this._activityPoints=0,this._webID=0,this._groupID=0,this._groupStatus=0,this._groupName="",this._subType="",this._ownerId=0,this._ownerName="",this._rarityLevel=0,this._hasSaddle=!1,this._isRiding=!1,this._canBreed=!1,this._canHarvest=!1,this._canRevive=!1,this._hasBreedingPermission=!1,this._petLevel=0,this._petPosture="",this._botSkills=[],this._isModerator=!1,this._isReadOnly=!1,this._roomIndex=t}setReadOnly(){this._isReadOnly=!0}get roomIndex(){return this._roomIndex}get x(){return this._x}set x(t){this._isReadOnly||(this._x=t)}get y(){return this._y}set y(t){this._isReadOnly||(this._y=t)}get z(){return this._z}set z(t){this._isReadOnly||(this._z=t)}get dir(){return this._dir}set dir(t){this._isReadOnly||(this._dir=t)}get name(){return this._name}set name(t){this._isReadOnly||(this._name=t)}get userType(){return this._userType}set userType(t){this._isReadOnly||(this._userType=t)}get sex(){return this._sex}set sex(t){this._isReadOnly||(this._sex=t)}get figure(){return this._figure}set figure(t){this._isReadOnly||(this._figure=t)}get custom(){return this._custom}set custom(t){this._isReadOnly||(this._custom=t)}get activityPoints(){return this._activityPoints}set activityPoints(t){this._isReadOnly||(this._activityPoints=t)}get webID(){return this._webID}set webID(t){this._isReadOnly||(this._webID=t)}get groupID(){return this._groupID}set groupID(t){this._isReadOnly||(this._groupID=t)}get groupName(){return this._groupName}set groupName(t){this._isReadOnly||(this._groupName=t)}get groupStatus(){return this._groupStatus}set groupStatus(t){this._isReadOnly||(this._groupStatus=t)}get subType(){return this._subType}set subType(t){this._isReadOnly||(this._subType=t)}get ownerId(){return this._ownerId}set ownerId(t){this._isReadOnly||(this._ownerId=t)}get ownerName(){return this._ownerName}set ownerName(t){this._isReadOnly||(this._ownerName=t)}get rarityLevel(){return this._rarityLevel}set rarityLevel(t){this._isReadOnly||(this._rarityLevel=t)}get hasSaddle(){return this._hasSaddle}set hasSaddle(t){this._isReadOnly||(this._hasSaddle=t)}get isRiding(){return this._isRiding}set isRiding(t){this._isReadOnly||(this._isRiding=t)}get canBreed(){return this._canBreed}set canBreed(t){this._isReadOnly||(this._canBreed=t)}get canHarvest(){return this._canHarvest}set canHarvest(t){this._isReadOnly||(this._canHarvest=t)}get canRevive(){return this._canRevive}set canRevive(t){this._isReadOnly||(this._canRevive=t)}get hasBreedingPermission(){return this._hasBreedingPermission}set hasBreedingPermission(t){this._isReadOnly||(this._hasBreedingPermission=t)}get petLevel(){return this._petLevel}set petLevel(t){this._isReadOnly||(this._petLevel=t)}get petPosture(){return this._petPosture}set petPosture(t){this._isReadOnly||(this._petPosture=t)}get botSkills(){return this._botSkills}set botSkills(t){this._botSkills=t}get isModerator(){return this._isModerator}set isModerator(t){this._isReadOnly||(this._isModerator=t)}};Wm.M="M",Wm.F="F";let $c=Wm;class GB{flush(){return this._users=[],!0}parse(t){if(!t)return!1;this._users=[];const e=t.readInt();let s=0;for(;s<e;){const i=t.readInt(),n=t.readString(),o=t.readString();let l=t.readString();const c=t.readInt(),u=t.readInt(),h=t.readInt(),d=parseFloat(t.readString()),g=t.readInt(),E=t.readInt(),m=new $c(c);if(m.dir=g,m.name=n,m.custom=o,m.x=u,m.y=h,m.z=d,this._users.push(m),E===1){m.webID=i,m.userType=be.USER,m.sex=this.resolveSex(t.readString()),m.groupID=t.readInt(),m.groupStatus=t.readInt(),m.groupName=t.readString();const I=t.readString();I!==""&&(l=this.convertSwimFigure(I,l,m.sex)),m.figure=l,m.activityPoints=t.readInt(),m.isModerator=t.readBoolean()}else if(E===2)m.userType=be.PET,m.figure=l,m.webID=i,m.subType=t.readInt().toString(),m.ownerId=t.readInt(),m.ownerName=t.readString(),m.rarityLevel=t.readInt(),m.hasSaddle=t.readBoolean(),m.isRiding=t.readBoolean(),m.canBreed=t.readBoolean(),m.canHarvest=t.readBoolean(),m.canRevive=t.readBoolean(),m.hasBreedingPermission=t.readBoolean(),m.petLevel=t.readInt(),m.petPosture=t.readString();else if(E===3)m.userType=be.BOT,m.webID=c*-1,l.indexOf("/")===-1?m.figure=l:m.figure="hr-100-.hd-180-1.ch-876-66.lg-270-94.sh-300-64",m.sex=$c.M;else if(E===4){m.userType=be.RENTABLE_BOT,m.webID=i,m.sex=this.resolveSex(t.readString()),m.figure=l,m.ownerId=t.readInt(),m.ownerName=t.readString();const I=t.readInt();if(I){const p=[];let T=0;for(;T<I;)p.push(t.readShort()),T++;m.botSkills=p}}s++}return!0}resolveSex(t){return t.substr(0,1).toLowerCase()==="f"?$c.F:$c.M}convertSwimFigure(t,e,s){const i=e.split(".");let n=1,o=1,l=1;const c=1e4;let u=0;for(;u<i.length;){const E=i[u].split("-");E.length>2&&E[0]==="hd"&&(n=parseInt(E[2])),u++}const h=["238,238,238","250,56,49","253,146,160","42,199,210","53,51,44","239,255,146","198,255,152","255,146,90","157,89,126","182,243,255","109,255,51","51,120,201","255,182,49","223,161,233","249,251,50","202,175,143","197,198,197","71,98,61","138,131,97","255,140,51","84,198,39","30,108,153","152,79,136","119,200,255","255,192,142","60,75,135","124,44,71","215,255,227","143,63,28","255,99,147","31,155,121","253,255,51"],d=t.split("=");if(d.length>1){const g=d[1].split("/");g[0];const E=g[1];s==="F"?l=10010:l=10011;const m=h.indexOf(E);o=c+m+1}return e+(".bds-10001-"+n+".ss-"+l+"-"+o)}get users(){return this._users}}class BB{flush(){return this._unitId=null,!0}parse(t){return t?(this._unitId=parseInt(t.readString()),!0):!1}get unitId(){return this._unitId}}class kB{constructor(t,e){this._action=t,this._value=e}get action(){return this._action}get value(){return this._value}}class VB{constructor(t,e,s,i,n,o,l,c=0,u=0,h=0,d,g,E){this._id=t,this._x=e,this._y=s,this._z=i,this._height=n,this._headDirection=o,this._direction=l,this._targetX=c,this._targetY=u,this._targetZ=h,this._didMove=d,this._canStandUp=g,this._actions=E||[]}get id(){return this._id}get x(){return this._x}get y(){return this._y}get z(){return this._z}get height(){return this._height}get headDirection(){return this._headDirection}get direction(){return this._direction}get targetX(){return this._targetX}get targetY(){return this._targetY}get targetZ(){return this._targetZ}get didMove(){return this._didMove}get canStandUp(){return this._canStandUp}get actions(){return this._actions}}class HB{flush(){return this._statuses=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;){const s=this.parseStatus(t);if(!s){e--;continue}this._statuses.push(s),e--}return!0}parseStatus(t){if(!t)return null;const e=t.readInt(),s=t.readInt(),i=t.readInt(),n=parseFloat(t.readString()),o=t.readInt()%8*45,l=t.readInt()%8*45,c=t.readString();let u=0,h=0,d=0,g=0,E=!1,m=!1;if(c){const I=c.split("/"),p=[];for(const T of I){const R=T.split(" ");if(R[0]!==""&&R.length>=2){switch(R[0]){case"mv":{const S=R[1].split(",");S.length>=3&&(u=parseInt(S[0]),h=parseInt(S[1]),d=parseFloat(S[2]),m=!0);break}case"sit":{const S=parseFloat(R[1]);R.length>=3&&(E=R[2]==="1"),g=S;break}case"lay":{const S=parseFloat(R[1]);g=Math.abs(S);break}}p.push(new kB(R[0],R[1]))}}this._statuses.push(new VB(e,s,i,n,g,o,l,u,h,d,m,E,p))}}get statuses(){return this._statuses}}const Ou=class Ou{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._rentable=!1,this._itemId=0,this._furniType=null,this._ref=0,this._spriteId=0,this._category=0,this._stuffData=null,this._isGroupable=!1,this._isRecyclable=!1,this._tradable=!1,this._sellable=!1,this._secondsToExpiration=0,this._extra=0,this._flatId=0,this._isWallItem=!1,this._hasRentPeriodStarted=!1,this._expirationTimeStamp=0,this._slotId="",this._songId=-1,!0}parse(t){return t?(this._itemId=t.readInt(),this._furniType=t.readString(),this._ref=t.readInt(),this._spriteId=t.readInt(),this._category=t.readInt(),this._stuffData=To.parseObjectData(t),this._isRecyclable=t.readBoolean(),this._tradable=t.readBoolean(),this._isGroupable=t.readBoolean(),this._sellable=t.readBoolean(),this._secondsToExpiration=t.readInt(),this._expirationTimeStamp=Pt(),this.secondsToExpiration>-1?this._rentable=!0:(this._rentable=!1,this._secondsToExpiration=-1),this._hasRentPeriodStarted=t.readBoolean(),this._flatId=t.readInt(),this._isWallItem=this._furniType===Ou.WALL_ITEM,this._furniType===Ou.FLOOR_ITEM&&(this._slotId=t.readString(),this._extra=t.readInt()),!0):!1}get itemId(){return this._itemId}get furniType(){return this._furniType}get ref(){return this._ref}get spriteId(){return this._spriteId}get category(){return this._category}get stuffData(){return this._stuffData}get isGroupable(){return this._isGroupable}get isRecycleable(){return this._isRecyclable}get tradable(){return this._tradable}get sellable(){return this._sellable}get secondsToExpiration(){return this._secondsToExpiration}get flatId(){return this._flatId}get slotId(){return this._slotId}get songId(){return this._songId}get extra(){return this._extra}get rentable(){return this._rentable}get isWallItem(){return this._isWallItem}get hasRentPeriodStarted(){return this._hasRentPeriodStarted}get expirationTimeStamp(){return this._expirationTimeStamp}get creationDay(){return 0}get creationMonth(){return 0}get creationYear(){return 0}get isExternalImageFurni(){return this._furniType.indexOf("external_image")!==-1}};Ou.WALL_ITEM="I",Ou.FLOOR_ITEM="S";let Bg=Ou;class WB{flush(){return this._items=[],!0}parse(t){return t?(this._items.push(new Bg(t)),!0):!1}get items(){return this._items}}class YB{flush(){return!0}parse(t){return!!t}}class zB{flush(){return this._totalFragments=0,this._fragmentNumber=0,this._fragment=new Map,!0}parse(t){if(!t)return!1;this._totalFragments=t.readInt(),this._fragmentNumber=t.readInt();let e=t.readInt();for(;e>0;){const s=new Bg(t);s&&this._fragment.set(s.itemId,s),e--}return!0}get totalFragments(){return this._totalFragments}get fragmentNumber(){return this._fragmentNumber}get fragment(){return this._fragment}}class KB{flush(){return this._itemId=0,!0}parse(t){return t?(this._itemId=t.readInt(),!0):!1}get itemId(){return this._itemId}}class XB{flush(){return this._itemId=0,this._itemsLeft=0,!0}parse(t){return t?(this._itemId=t.readInt(),this._itemsLeft=t.readInt(),!0):!1}get itemId(){return this._itemId}get itemsLeft(){return this._itemsLeft}}class qB{flush(){return this._itemType="",this._classId=0,this._productCode="",!0}parse(t){return t?(this._itemType=t.readString(),this._classId=t.readInt(),this._productCode=t.readString(),this._placedItemId=t.readInt(),this._placedItemType=t.readString(),this._placedInRoom=t.readBoolean(),this._petFigureString=t.readString(),!0):!1}get itemType(){return this._itemType}get classId(){return this._classId}get productCode(){return this._productCode}get placedItemId(){return this._placedItemId}get placedItemType(){return this._placedItemType}get placedInRoom(){return this._placedInRoom}get petFigureString(){return this._petFigureString}}class QB{flush(){this._nestId=0,this._pet1&&(this._pet1.dispose(),this._pet1=null),this._pet2&&(this._pet2.dispose(),this._pet2=null);for(const t of this._rarityCategories)t&&t.dispose();return this._rarityCategories=[],!0}parse(t){if(!t)return!1;this._nestId=t.readInt(),this._pet1=new YC(t),this._pet2=new YC(t);let e=t.readInt();for(;e>0;)this._rarityCategories.push(new AB(t)),e--;return this._resultPetType=t.readInt(),!0}get nestId(){return this._nestId}get pet1(){return this._pet1}get pet2(){return this._pet2}get rarityCategories(){return this._rarityCategories}get resultPetType(){return this._resultPetType}}class JB{flush(){return this._breedingNestStuffId=0,this._result=0,!0}parse(t){return t?(this._breedingNestStuffId=t.readInt(),this._result=t.readInt(),!0):!1}get breedingNestStuffId(){return this._breedingNestStuffId}get result(){return this._result}}class $B{flush(){return this._petId=-1,this._rarityCategory=-1,!0}parse(t){return this._petId=t.readInt(),this._rarityCategory=t.readInt(),!0}get rarityCategory(){return this._rarityCategory}get petId(){return this._petId}}class RS{constructor(t){this._typeId=t.readInt(),this._paletteId=t.readInt(),this._color=t.readString(),this._breedId=t.readInt(),this._customParts=[],this._customPartCount=t.readInt();let e=0;for(;e<this._customPartCount;)this._customParts.push(t.readInt()),this._customParts.push(t.readInt()),this._customParts.push(t.readInt()),e++}get typeId(){return this._typeId}get paletteId(){return this._paletteId}get color(){return this._color}get breedId(){return this._breedId}get figuredata(){let t=this.typeId+" "+this.paletteId+" "+this.color;t=t+(" "+this.custompartCount);for(const e of this.customParts)t=t+(" "+e);return t}get customParts(){return this._customParts}get custompartCount(){return this._customPartCount}}class qE{constructor(t){if(!t)throw new Error("invalid_wrapper");this._id=t.readInt(),this._name=t.readString(),this._figureData=new RS(t),this._level=t.readInt()}get id(){return this._id}get name(){return this._name}get typeId(){return this._figureData.typeId}get paletteId(){return this._figureData.paletteId}get color(){return this._figureData.color}get breedId(){return this._figureData.breedId}get customPartCount(){return this._figureData.custompartCount}get figureString(){return this._figureData.figuredata}get figureData(){return this._figureData}get level(){return this._level}}class ZB{flush(){return this._pet=null,this._boughtAsGift=!1,!0}parse(t){return this._pet=new qE(t),this._boughtAsGift=t.readBoolean(),!0}get pet(){return this._pet}get boughtAsGift(){return this._boughtAsGift}}const rd=class rd{flush(){return this._state=0,this._ownPetId=0,this._otherPetId=0,!0}parse(t){return t?(this._state=t.readInt(),this._ownPetId=t.readInt(),this._otherPetId=t.readInt(),!0):!1}get state(){return this._state}get ownPetId(){return this._ownPetId}get otherPetId(){return this._otherPetId}};rd.STATE_CANCEL=1,rd.STATE_ACCEPT=2,rd.STATE_REQUEST=3;let LI=rd;class tk{flush(){return this._fragment=null,!0}parse(t){this._totalFragments=t.readInt(),this._fragmentNumber=t.readInt();let e=t.readInt();for(this._fragment=new Map;e>0;){const s=new qE(t);this._fragment.set(s.id,s),e--}return!0}get totalFragments(){return this._totalFragments}get fragmentNumber(){return this._fragmentNumber}get fragment(){return this._fragment}}class ek{flush(){return this._boughtAsGift=!1,this._pet=null,!0}parse(t){return this._boughtAsGift=t.readBoolean(),this._pet=new qE(t),!0}get boughtAsGift(){return this._boughtAsGift}get pet(){return this._pet}}class sk{flush(){return!0}parse(t){return t?(this._petId=t.readInt(),!0):!1}get petId(){return this._petId}}class ik{constructor(t){this._itemId=t.readInt(),this._furniType=t.readString().toUpperCase(),this._ref=t.readInt(),this._spriteId=t.readInt(),this._category=t.readInt(),this._isGroupable=t.readBoolean(),this._stuffData=To.parseObjectData(t),this._secondsToExpiration=-1,this._expirationTimeStamp=Pt(),this._hasRentPeriodStarted=!1,this._creationDay=t.readInt(),this._creationMonth=t.readInt(),this._creationYear=t.readInt(),this._extra=this.furniType==="S"?t.readInt():-1,this._flatId=-1,this._rentable=!1,this._isWallItem=this._furniType==="I"}get itemId(){return this._itemId}get furniType(){return this._furniType}get ref(){return this._ref}get spriteId(){return this._spriteId}get category(){return this._category}get stuffData(){return this._stuffData}get extra(){return this._extra}get secondsToExpiration(){return this._secondsToExpiration}get creationDay(){return this._creationDay}get creationMonth(){return this._creationMonth}get creationYear(){return this._creationYear}get isGroupable(){return this._isGroupable}get songId(){return this._extra}get flatId(){return this._flatId}get rentable(){return this._rentable}get isWallItem(){return this._isWallItem}get hasRentPeriodStarted(){return this._hasRentPeriodStarted}get expirationTimeStamp(){return this._expirationTimeStamp}get isRecycleable(){return!0}get tradable(){return!0}get sellable(){return!0}get slotId(){return null}get isExternalImageFurni(){return this._furniType.indexOf("external_image")!==-1}}class rk{flush(){return this._userID=-1,this._userAccepts=!1,!0}parse(t){return t?(this._userID=t.readInt(),this._userAccepts=t.readInt()>0,!0):!1}get userID(){return this._userID}get userAccepts(){return this._userAccepts}}const uC=class uC{flush(){return!0}parse(t){return t?(this._userId=t.readInt(),this._reason=t.readInt(),!0):!1}get userID(){return this._userId}get reason(){return this._reason}};uC.ERROR_WHILE_COMMIT=1;let kg=uC;class nk{flush(){return!0}parse(t){return!!t}}class ak{flush(){return!0}parse(t){return!!t}}class ok{flush(){return this._firstUserID=-1,this._firstUserItemArray=null,this._firstUserNumItems=0,this._firstUserNumCredits=0,this._secondUserID=-1,this._secondUserItemArray=null,this._secondUserNumItems=0,this._secondUserNumCredits=0,!0}parse(t){return!t||(this._firstUserID=t.readInt(),this._firstUserItemArray=[],!this.parseItems(t,this._firstUserItemArray))||(this._firstUserNumItems=t.readInt(),this._firstUserNumCredits=t.readInt(),this._secondUserID=t.readInt(),this._secondUserItemArray=[],!this.parseItems(t,this._secondUserItemArray))?!1:(this._secondUserNumItems=t.readInt(),this._secondUserNumCredits=t.readInt(),!0)}parseItems(t,e){let s=t.readInt();for(;s>0;)e.push(new ik(t)),s--;return!0}get firstUserID(){return this._firstUserID}get firstUserItemArray(){return this._firstUserItemArray}get firstUserNumItems(){return this._firstUserNumItems}get firstUserNumCredits(){return this._firstUserNumCredits}get secondUserID(){return this._secondUserID}get secondUserItemArray(){return this._secondUserItemArray}get secondUserNumItems(){return this._secondUserNumItems}get secondUserNumCredits(){return this._secondUserNumCredits}}class lk{flush(){return!0}parse(t){return!!t}}class ck{flush(){return!0}parse(t){return!!t}}const Ym=class Ym{flush(){return!0}parse(t){return t?(this._reason=t.readInt(),this._otherUserName=t.readString(),!0):!1}get reason(){return this._reason}get otherUserName(){return this._otherUserName}};Ym.REASON_YOU_ARE_ALREADY_TRADING=7,Ym.REASON_OTHER_USER_ALREADY_TRADING=8;let PI=Ym;class uk{flush(){return this._userId=-1,this._userCanTrade=!1,this._otherUserId=-1,this._otherUserCanTrade=!1,!0}parse(t){return t?(this._userId=t.readInt(),this._userCanTrade=t.readInt()===1,this._otherUserId=t.readInt(),this._otherUserCanTrade=t.readInt()===1,!0):!1}get userID(){return this._userId}get userCanTrade(){return this._userCanTrade}get otherUserID(){return this._otherUserId}get otherUserCanTrade(){return this._otherUserCanTrade}}class hk{flush(){return!0}parse(t){return!!t}}class dk{flush(){return!0}parse(t){return!!t}}class _k{flush(){return this._respect=0,this._petOwnerId=0,this._petData=null,!0}parse(t){return t?(this._respect=t.readInt(),this._petOwnerId=t.readInt(),this._petData=new qE(t),!0):!1}get respect(){return this._respect}get petOwnerId(){return this._petOwnerId}get petData(){return this._petData}get isTreat(){return this._petData.typeId===xs.MONSTERPLANT}}class gk{flush(){return this._petId=0,this._userId=0,this._supplementType=0,!0}parse(t){return t?(this._petId=t.readInt(),this._userId=t.readInt(),this._supplementType=t.readInt(),!0):!1}get petId(){return this._petId}get userId(){return this._userId}get supplementType(){return this._supplementType}}const zl=class zl{};zl.WATER=0,zl.LIGHT=1,zl.REVIVE=2,zl.REBREED_FERTILIZER=3,zl.SPEED_FERTILIZER=4;let yh=zl;class fk{flush(){return this._userId=0,this._respectsReceived=0,!0}parse(t){return t?(this._userId=t.readInt(),this._respectsReceived=t.readInt(),!0):!1}get userId(){return this._userId}get respectsReceived(){return this._respectsReceived}}class mk{constructor(t,e,s){this._hasControllers=!1,this._roomId=t,this._roomName=e,this._hasControllers=s}get roomId(){return this._roomId}get roomName(){return this._roomName}get hasControllers(){return this._hasControllers}}class Ek{constructor(t){this._currentHcStreak=t.readInt(),this._firstSubscriptionDate=t.readString(),this._kickbackPercentage=t.readDouble(),this._totalCreditsMissed=t.readInt(),this._totalCreditsRewarded=t.readInt(),this._totalCreditsSpent=t.readInt(),this._creditRewardForStreakBonus=t.readInt(),this._creditRewardForMonthlySpent=t.readInt(),this._timeUntilPayday=t.readInt()}get currentHcStreak(){return this._currentHcStreak}get firstSubscriptionDate(){return this._firstSubscriptionDate}get kickbackPercentage(){return this._kickbackPercentage}get totalCreditsMissed(){return this._totalCreditsMissed}get totalCreditsRewarded(){return this._totalCreditsRewarded}get totalCreditsSpent(){return this._totalCreditsSpent}get creditRewardForStreakBonus(){return this._creditRewardForStreakBonus}get creditRewardForMonthlySpent(){return this._creditRewardForMonthlySpent}get timeUntilPayday(){return this._timeUntilPayday}}class pk{flush(){return this._data=null,!0}parse(t){return this._data=new Ek(t),!0}get data(){return this._data}}class Ik{flush(){return this._looks=new Map,!0}parse(t){if(!t)return!1;t.readInt();let e=t.readInt();for(;e>0;){const s=t.readInt(),i=t.readString(),n=t.readString();this._looks.set(s,[i,n]),e--}return!0}get looks(){return this._looks}}class Tk{flush(){return this._result=-1,!0}parse(t){return t?(this._result=t.readInt(),!0):!1}get result(){return this._result}}class Rk{flush(){return this._isVip=!1,this._rooms=[],!0}parse(t){if(!t)return!1;this._isVip=t.readBoolean();let e=t.readInt();for(;e>0;)this._rooms.push(new mk(t.readInt(),t.readString(),t.readBoolean())),e--;return!0}get isVip(){return this._isVip}get rooms(){return this._rooms}}class Sk{flush(){return this._pageId=-1,this._data=null,!0}parse(t){return t?(this._pageId=t.readInt(),this._data=new XE(t),!0):!1}get pageId(){return this._pageId}get data(){return this._data}}class Ok{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._type=-1,this._breedId=-1,this._paletteId=-1,this._sellable=!1,this._rare=!1,!0}parse(t){return t?(this._type=t.readInt(),this._breedId=t.readInt(),this._paletteId=t.readInt(),this._sellable=t.readBoolean(),this._rare=t.readBoolean(),!0):!1}get type(){return this._type}get breedId(){return this._breedId}get paletteId(){return this._paletteId}get sellable(){return this._sellable}get rare(){return this._rare}}class Ck{flush(){return this._productCode="",this._palettes=[],!0}parse(t){if(!t)return!1;this._productCode=t.readString();let e=t.readInt();for(;e>0;)this._palettes.push(new Ok(t)),e--;return!0}get productCode(){return this._productCode}get palettes(){return this._palettes}}class Ak{constructor(t){this._trackingState=t.readInt(),this._id=t.readInt(),this._identifier=t.readString(),this._productCode=t.readString(),this._priceInCredits=t.readInt(),this._priceInActivityPoints=t.readInt(),this._activityPointType=t.readInt(),this._purchaseLimit=t.readInt();const e=t.readInt();this._expirationTime=e>0?e*1e3+Date.now():0,this._title=t.readString(),this._description=t.readString(),this._imageUrl=t.readString(),this._iconImageUrl=t.readString(),this._type=t.readInt(),this._subProductCodes=[];let s=t.readInt();for(;s>0;)this._subProductCodes.push(t.readString()),s--;return this}populate(t){t&&(this._id=t.id,this._identifier=t.identifier,this._type=t.type,this._title=t.title,this._description=t.description,this._imageUrl=t.imageUrl,this._iconImageUrl=t.iconImageUrl,this._productCode=t.productCode,this._purchaseLimit=t.purchaseLimit,this._expirationTime=t.expirationTime,this._priceInCredits=t.priceInCredits,this._priceInActivityPoints=t.priceInActivityPoints,this._activityPointType=t.activityPointType,this._subProductCodes=t.subProductCodes,this._trackingState=t.trackingState)}purchase(t){this._purchaseLimit=this._purchaseLimit-t}get id(){return this._id}get identifier(){return this._identifier}get type(){return this._type}get title(){return this._title}get description(){return this._description}get imageUrl(){return this._imageUrl}get iconImageUrl(){return this._iconImageUrl}get productCode(){return this._productCode}get purchaseLimit(){return this._purchaseLimit}get expirationTime(){return this._expirationTime}get priceInCredits(){return this._priceInCredits}get priceInActivityPoints(){return this._priceInActivityPoints}get activityPointType(){return this._activityPointType}get subProductCodes(){return this._subProductCodes}get trackingState(){return this._trackingState}}class Nk{flush(){return!0}parse(t){return!!t}}class xk{flush(){return this._data=null,!0}parse(t){return t?(this._data=new Ak(t),!0):!1}get data(){return this._data}}class Mk{constructor(){this._errorCode=""}flush(){return this._errorCode="",!0}parse(t){return t?(this._errorCode=t.readString(),!0):!1}get errorCode(){return this._errorCode}}class yk{constructor(){this._productName="",this._productDescription=""}flush(){return this._productDescription="",this._productName="",!0}parse(t){return t?(this._productDescription=t.readString(),this._productName=t.readString(),!0):!1}get productName(){return this._productName}get productDescription(){return this._productDescription}}class Dk{flush(){return!0}parse(t){return!!t}}const Qa=class Qa{flush(){return this._goalId=0,this._goalCode=null,this._result=0,this._requiredFurnis=null,this._missingFurnis=null,!0}parse(t){this._goalId=t.readInt(),this._goalCode=t.readString(),this._result=t.readInt(),this._requiredFurnis=[];let e=t.readInt();for(;e>0;)this._requiredFurnis.push(t.readString()),e--;for(e=t.readInt();e>0;)this._missingFurnis[t.readString()]="",e--;return!0}get goalId(){return this._goalId}get goalCode(){return this._goalCode}get result(){return this._result}get requiredFurnis(){return this._requiredFurnis}isMissing(t){return!!this._missingFurnis[t]}};Qa.SUBMITTED=0,Qa.ASK_FOR_SUBMIT=1,Qa.ASK_FOR_CONFIRM=2,Qa.PREREQUISITES_NOT_MET=3,Qa.ROOM_DOOR_NOT_OPEN=4,Qa.ROOM_TOO_OLD=5,Qa.ASK_FOR_ACCEPT_RULES=6;let UI=Qa;const nd=class nd{};nd.ALLOWED=0,nd.REQUIRED_PERK_MISSING=1,nd.REQUIRED_BADGE_MISSING=2;let jI=nd;class bk{flush(){return this._goalId=0,this._goalCode=null,this._resultCode=0,this._votesRemaining=0,!0}parse(t){return this._goalId=t.readInt(),this._goalCode=t.readString(),this._resultCode=t.readInt(),this._votesRemaining=t.readInt(),!0}get goalId(){return this._goalId}get goalCode(){return this._goalCode}get isVotingAllowedForUser(){return this._resultCode===jI.ALLOWED}get votesRemaining(){return this._votesRemaining}get resultCode(){return this._resultCode}}class vk{flush(){return this._schedulingStr=null,this._code=null,!0}parse(t){return this._schedulingStr=t.readString(),this._code=t.readString(),!0}get schedulingStr(){return this._schedulingStr}get code(){return this._code}}class Lk{flush(){return this._isPartOf=!1,this._targetId=0,!0}parse(t){return this._isPartOf=t.readBoolean(),this._targetId=t.readInt(),!0}get isPartOf(){return this._isPartOf}get targetId(){return this._targetId}}class Pk{flush(){return!0}parse(t){return!0}}class Uk{flush(){return this._timeStr=null,this._secondsUntil=0,!0}parse(t){return this._timeStr=t.readString(),this._secondsUntil=t.readInt(),!0}get timeStr(){return this._timeStr}get secondsUntil(){return this._secondsUntil}}class $N{constructor(t){this._recipeName=t.readString(),this._itemName=t.readString()}get recipeName(){return this._recipeName}get itemName(){return this._itemName}}class jk{constructor(){this._recipes=[],this._ingredients=[]}flush(){return this._recipes=[],this._ingredients=[],!0}parse(t){if(!t)return!1;const e=t.readInt();for(let i=0;i<e;i++)this._recipes.push(new $N(t));const s=t.readInt();for(let i=0;i<s;i++)this._ingredients.push(t.readString());return!0}get recipes(){return this._recipes}get ingredients(){return this._ingredients}isActive(){return this._recipes.length>0||this._ingredients.length>0}}class wk{constructor(t){this._count=t.readInt(),this._itemName=t.readString()}get count(){return this._count}get itemName(){return this._itemName}}class Fk{constructor(){this._ingredients=[]}parse(t){if(!t)return!1;const e=t.readInt();for(let s=0;s<e;s++)this._ingredients.push(new wk(t));return!0}flush(){return this._ingredients=[],!0}get ingredients(){return this._ingredients}}class Gk{parse(t){return t?(this._count=t.readInt(),this._hasRecipes=t.readBoolean(),!0):!1}flush(){return this._count=0,this._hasRecipes=!1,!0}get count(){return this._count}get hasRecipes(){return this._hasRecipes}}class Bk{parse(t){return t?(this._success=t.readBoolean(),this._success&&(this._result=new $N(t)),!0):!1}flush(){return this._success=!1,!0}get success(){return this._success}get result(){return this._result}}class kk{flush(){return!0}parse(t){return!!t}}class Vk{constructor(t){if(!t)throw new Error("invalid_wrapper");this._senderId=t.readInt(),this._errorCode=t.readInt()}get senderId(){return this._senderId}get errorCode(){return this._errorCode}}class Hk{flush(){return this._failuers=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._failuers.push(new Vk(t)),e--;return!0}get failures(){return this._failuers}}class Wk{flush(){return this._success=!1,!0}parse(t){return t?(this._success=t.readBoolean(),!0):!1}get success(){return this._success}}class Yk{flush(){return this._errorCode=0,!0}parse(t){return t?(this._errorCode=t.readInt(),!0):!1}get errorCode(){return this._errorCode}}class ZN{constructor(t){if(!t)throw new Error("invalid_wrapper");this._id=t.readInt(),this._name=t.readString()}get id(){return this._id}get name(){return this._name}}class wI{constructor(t){if(!t)throw new Error("invalid_wrapper");this._id=t.readInt(),this._name=t.readString(),this._gender=t.readInt(),this._online=t.readBoolean(),this._followingAllowed=t.readBoolean(),this._figure=t.readString(),this._categoryId=t.readInt(),this._motto=t.readString(),this._realName=t.readString(),this._lastAccess=t.readString(),this._persistedMessageUser=t.readBoolean(),this._vipMember=t.readBoolean(),this._pocketHabboUser=t.readBoolean(),this._relationshipStatus=t.readShort()}get id(){return this._id}get name(){return this._name}get gender(){return this._gender}get online(){return this._online}get followingAllowed(){return this._followingAllowed}get figure(){return this._figure}get categoryId(){return this._categoryId}get motto(){return this._motto}get lastAccess(){return this._lastAccess}get realName(){return this._realName}get persistedMessageUser(){return this._persistedMessageUser}get vipMember(){return this._vipMember}get pocketHabboUser(){return this._pocketHabboUser}get relationshipStatus(){return this._relationshipStatus}}class zk{flush(){return this._totalFragments=0,this._fragmentNumber=0,this._fragment=[],!0}parse(t){if(!t)return!1;this._totalFragments=t.readInt(),this._fragmentNumber=t.readInt();let e=t.readInt();for(;e>0;)this._fragment.push(new wI(t)),e--;return!0}get totalFragments(){return this._totalFragments}get fragmentNumber(){return this._fragmentNumber}get fragment(){return this._fragment}}class Kk{flush(){return this._categories=[],this._removedFriendIds=[],this._addedFriends=[],this._updatedFriends=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._categories.push(new ZN(t)),e--;let s=t.readInt();for(;s>0;){const i=t.readInt();i===-1?this._removedFriendIds.push(t.readInt()):i===0?this._updatedFriends.push(new wI(t)):i===1&&this._addedFriends.push(new wI(t)),s--}return!0}get categories(){return this._categories}get removedFriendIds(){return this._removedFriendIds}get addedFriends(){return this._addedFriends}get updatedFriends(){return this._updatedFriends}}class Xk{flush(){return this._typeCode=-1,this._avatarId=0,this._message=null,!0}parse(t){return t?(this._typeCode=t.readInt(),this._avatarId=t.readInt(),this._message=t.readString(),!0):!1}get typeCode(){return this._typeCode}get avatarId(){return this._avatarId}get message(){return this._message}}class tx{constructor(t){if(!t)throw new Error("invalid_wrapper");this._requestId=t.readInt(),this._requesterName=t.readString(),this._figureString=t.readString(),this._requesterUserId=this._requestId}get requestId(){return this._requestId}get requesterName(){return this._requesterName}get requesterUserId(){return this._requesterUserId}get figureString(){return this._figureString}}class qk{flush(){return this._totalRequests=0,this._requests=[],!0}parse(t){if(!t)return!1;this._totalRequests=t.readInt();let e=t.readInt();for(;e>0;)this._requests.push(new tx(t)),e--;return!0}get totalRequests(){return this._totalRequests}get requests(){return this._requests}}class KC{constructor(t){if(!t)throw new Error("invalid_wrapper");this._avatarId=t.readInt(),this._avatarName=t.readString(),this._avatarMotto=t.readString(),this._isAvatarOnline=t.readBoolean(),this._canFollow=t.readBoolean(),this._lastOnlineData=t.readString(),this._avatarGender=t.readInt(),this._avatarFigure=t.readString(),this._realName=t.readString()}get avatarId(){return this._avatarId}get avatarName(){return this._avatarName}get avatarMotto(){return this._avatarMotto}get isAvatarOnline(){return this._isAvatarOnline}get canFollow(){return this._canFollow}get avatarGender(){return this._avatarGender}get avatarFigure(){return this._avatarFigure}get lastOnlineData(){return this._lastOnlineData}get realName(){return this._realName}}class Qk{flush(){return this._friends=[],this._others=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._friends.push(new KC(t)),e--;let s=t.readInt();for(;s>0;)this._others.push(new KC(t)),s--;return!0}get friends(){return this._friends}get others(){return this._others}}class Jk{flush(){return this._errorCode=0,this._userId=0,this._message=null,!0}parse(t){return t?(this._errorCode=t.readInt(),this._userId=t.readInt(),this._message=t.readString(),!0):!1}get errorCode(){return this._errorCode}get userId(){return this._userId}get message(){return this._message}}class $k{flush(){return this._clientMessageId=0,this._errorCode=0,!0}parse(t){return t?(this._clientMessageId=t.readInt(),this._errorCode=t.readInt(),!0):!1}get clientMessageId(){return this._clientMessageId}get errorCode(){return this._errorCode}}class Zk{flush(){return this._userFriendLimit=0,this._normalFriendLimit=0,this._extendedFriendLimit=0,this._categories=[],!0}parse(t){if(!t)return!1;this._userFriendLimit=t.readInt(),this._normalFriendLimit=t.readInt(),this._extendedFriendLimit=t.readInt();let e=t.readInt();for(;e>0;)this._categories.push(new ZN(t)),e--;return!0}get userFriendLimit(){return this._userFriendLimit}get normalFriendLimit(){return this._normalFriendLimit}get extendedFriendLimit(){return this._extendedFriendLimit}get categories(){return this._categories}}class tV{flush(){return!0}parse(t){return!!t}}class eV{flush(){return this._count=0,!0}parse(t){return t?(this._count=t.readInt(),!0):!1}get count(){return this._count}}class sV{flush(){return this._senderId=0,this._messageText=null,this._secondsSinceSent=0,this._extraData=null,!0}parse(t){return t?(this._senderId=t.readInt(),this._messageText=t.readString(),this._secondsSinceSent=t.readInt(),t.bytesAvailable&&(this._extraData=t.readString()),!0):!1}get senderId(){return this._senderId}get messageText(){return this._messageText}get secondsSinceSent(){return this._secondsSinceSent}get extraData(){return this._extraData}}class iV{flush(){return this._request=null,!0}parse(t){return t?(this._request=new tx(t),!0):!1}get request(){return this._request}}class rV{flush(){return this._errorCode=0,this._failedRecipients=[],!0}parse(t){if(!t)return!1;this._errorCode=t.readInt();let e=t.readInt();for(;e>0;)this._failedRecipients.push(t.readInt()),e--;return!0}get errorCode(){return this._errorCode}get failedRecipients(){return this._failedRecipients}}class nV{flush(){return this._senderId=0,this._messageText=null,!0}parse(t){return t?(this._senderId=t.readInt(),this._messageText=t.readString(),!0):!1}get senderId(){return this._senderId}get messageText(){return this._messageText}}class aV{flush(){return!0}parse(t){return t?(this._gameTypeId=t.readInt(),this._freeGamesLeft=t.readInt(),this._gamesPlayedTotal=t.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}get freeGamesLeft(){return this._freeGamesLeft}get gamesPlayedTotal(){return this._gamesPlayedTotal}get hasUnlimitedGames(){return this._freeGamesLeft==-1}}const Cu=class Cu{flush(){return this._status=-1,this._blockLength=-1,this._gamesPlayed=-1,this._freeGamesLeft=-1,!0}parse(t){return t?(this._status=t.readInt(),this._blockLength=t.readInt(),this._gamesPlayed=t.readInt(),this._freeGamesLeft=t.readInt(),!0):!1}get status(){return this._status}get blockLength(){return this._blockLength}get gamesPlayed(){return this._gamesPlayed}get freeGamesLeft(){return this._freeGamesLeft}get hasUnlimitedGames(){return this._freeGamesLeft==-1}};Cu.STATUS_OK=0,Cu.STATUS_FAILED_REASON_UNKNOWN=1,Cu.STATUS_FAILED_REASON_GAME_DIRECTORY_IS_NOT_AVAILABLE=2,Cu.STATUS_FAILED_REASON_HOTEL_IS_CLOSED=3;let FI=Cu;class oV{flush(){return this._position=-1,!0}parse(t){return t?(this._position=t.readInt(),!0):!1}get position(){return this._position}}const sa=class sa{flush(){return this._reason=-1,!0}parse(t){return t?(this._reason=t.readInt(),!0):!1}get reason(){return this._reason}};sa.KICKED=1,sa.DUPLICATE_MACHINEID=2,sa.INVITATION_REQUIRED=3,sa.NO_SPACE_IN_TEAM=4,sa.TEAM_NOT_FOUND=5,sa.USER_HAS_ACTIVE_INSTANCE=6,sa.USER_HAS_PENDING_INSTANCE_REQUEST=7,sa.USER_HAS_NO_FREE_GAMES_LEFT=8;let GI=sa;const zm=class zm{flush(){return this._reason=-1,!0}parse(t){return t?(this._reason=t.readInt(),!0):!1}get reason(){return this._reason}};zm.NOT_ENOUGH_PLAYERS=1,zm.GAME_HAS_NO_OWNER=2;let BI=zm;class lV{flush(){return!0}parse(t){return!!t}}class cV{flush(){return this._userId=-1,!0}parse(t){return t?(this._userId=t.readInt(),!0):!1}get userId(){return this._userId}}class uV{flush(){return!0}parse(t){return t?(this._stuffCode=t.readString(),this._badgeCode=t.readString(),!0):!1}get stuffCode(){return this._stuffCode}get badgeCode(){return this._badgeCode}}class hV{flush(){return this._stuffId=-1,this._achievementId=0,this._requiredLevelBadgeCode="",this._userProgress=0,this._totalProgress=0,this._endTime=0,!0}parse(t){return t?(this._stuffId=t.readInt(),this._achievementId=t.readInt(),this._requiredLevelBadgeCode=t.readString(),this._userProgress=t.readInt(),this._totalProgress=t.readInt(),this._endTime=t.readInt(),!0):!1}get stuffId(){return this._stuffId}get achievementId(){return this._achievementId}get requiredLevelBadgeCode(){return this._requiredLevelBadgeCode}get userProgress(){return this._userProgress}get totalProgress(){return this._totalProgress}get endTime(){return this._endTime}}class dV{flush(){return!0}parse(t){if(!t)return!1;this._stuffId=t.readInt();const e=t.readInt();let s=0;for(;s<e;)this._achievements.push(new DI(t)),s++;return this._endTime=t.readInt(),!0}get stuffId(){return this._stuffId}get achievements(){return this._achievements}get endTime(){return this._endTime}}class _V{constructor(t,e,s,i){this._gameTypeId=t,this._achievementId=e,this._achievementName=s,this._levels=i}get gameTypeId(){return this._gameTypeId}get achievementId(){return this._achievementId}get achievementName(){return this._achievementName}get levels(){return this._levels}}class gV{flush(){return!0}parse(t){if(!t)return!1;this._achievements=[];const e=t.readInt();let s=0;for(;s<e;){const i=t.readInt(),n=t.readInt();let o=0;for(;o<n;){const l=t.readInt(),c=t.readString(),u=t.readInt();this._achievements.push(new _V(i,l,c,u)),o++}s++}return!0}get achievements(){return this._achievements}}class fV{constructor(t,e,s,i,n,o){this._gameId=t,this._gameNameId=e,this._bgColor=s,this._textColor=i,this._assetUrl=n,this._supportUrl=o}get gameId(){return this._gameId}get gameNameId(){return this._gameNameId}get bgColor(){return this._bgColor}get textColor(){return this._textColor}get assetUrl(){return this._assetUrl}get supportUrl(){return this._supportUrl}}class mV{flush(){return!0}parse(t){return t?(this._gameTypeId=t.readInt(),this._inviterId=t.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}get inviterId(){return this._inviterId}}class EV{flush(){return!0}parse(t){if(!t)return!1;this._games=[];const e=t.readInt();for(let s=0;s<e;s++){const i=t.readInt(),n=t.readString(),o=t.readString();let l=parseInt(o,16);l=l|4278190080;const c=t.readString();let u=parseInt(c,16);u=u|4278190080;const h=t.readString(),d=t.readString();this._games.push(new fV(i,n,l,u,h,d))}return!0}get games(){return this._games}}const Au=class Au{flush(){return!0}parse(t){return t?(this._gameTypeId=t.readInt(),this._status=t.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}get isOk(){return this._status==Au.OK}get isInMaintenance(){return this._status==Au.MAINTENANCE}};Au.OK=0,Au.MAINTENANCE=1;let kI=Au;class pV{flush(){return!0}parse(t){return t?(this._gameTypeId=t.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}}const hC=class hC{flush(){return!0}parse(t){return t?(this._gameTypeId=t.readInt(),this._reason=t.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}get reason(){return this._reason}};hC.DUPLICATE_MACHINEID=1;let VI=hC;class IV{flush(){return!0}parse(t){return t?(this._gameTypeId=t.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}}class TV{flush(){return!0}parse(t){if(!t)return!1;this._gameTypeId=t.readInt(),this._gameClientId=t.readString(),this._url=t.readString(),this._quality=t.readString(),this._scaleMode=t.readString(),this._frameRate=t.readInt(),this._minMajorVersion=t.readInt(),this._minMinorVersion=t.readInt(),this._params=new Map;const e=t.readInt();let s=0;for(;s<e;)this._params.set(t.readString(),t.readString()),s++;return!0}get gameTypeId(){return this._gameTypeId}get url(){return this._url}get quality(){return this._quality}get scaleMode(){return this._scaleMode}get frameRate(){return this._frameRate}get minMajorVersion(){return this._minMajorVersion}get minMinorVersion(){return this._minMinorVersion}get params(){return this._params}get gameClientId(){return this._gameClientId}}class RV{flush(){return this._gameTypeId=0,this._url=null,this._gameClientId=null,!0}parse(t){return t?(this._gameTypeId=t.readInt(),this._gameClientId=t.readString(),this._url=t.readString(),!0):!1}get gameTypeId(){return this._gameTypeId}get url(){return this._url}get gameClientId(){return this._gameClientId}}class SV{flush(){return!0}parse(t){return t?(this._gameTypeId=t.readInt(),this._gameClientId=t.readString(),!0):!1}get gameTypeId(){return this._gameTypeId}get gameClientId(){return this._gameClientId}}class OV{flush(){return!0}parse(t){return!!t}}class QE{flush(){return this._year=-1,this._week=-1,this._maxOffset=-1,this._currentOffset=-1,this._minutesUntilReset=-1,!0}parse(t){return t?(this._year=t.readInt(),this._week=t.readInt(),this._maxOffset=t.readInt(),this._currentOffset=t.readInt(),this._minutesUntilReset=t.readInt(),!0):!1}get year(){return this._year}get week(){return this._week}get maxOffset(){return this._maxOffset}get currentOffset(){return this._currentOffset}get minutesUntilReset(){return this._minutesUntilReset}}class CV{constructor(t){this._name=t.readString(),this._figure=t.readString(),this._gender=t.readString(),this._rank=t.readInt(),this._score=t.readInt()}get name(){return this._name}get figure(){return this._figure}get gender(){return this._gender}get rank(){return this._rank}get score(){return this._score}}class AV{flush(){return this._gameTypeId=-1,this._products=[],this._minutesUntilNextWeek=0,this._rewardingOn=!0,!0}parse(t){if(!t)return!1;this._gameTypeId=t.readInt();let e=t.readInt();for(;e>0;)this._products.push(new Un(t)),e--;return this._minutesUntilNextWeek=t.readInt(),this._rewardingOn=t.readBoolean(),!0}get gameTypeId(){return this._gameTypeId}get products(){return this._products}get minutesUntilNextWeek(){return this._minutesUntilNextWeek}get rewardingOn(){return this._rewardingOn}}class NV{flush(){return this._gameTypeId=-1,this._winners=[],!0}parse(t){if(!t)return!1;this._gameTypeId=t.readInt();let e=t.readInt();for(;e>0;)this._winners.push(new CV(t)),e--;return!0}get gameTypeId(){return this._gameTypeId}get winners(){return this._winners}}class xV{flush(){return this._errorCode=0,!0}parse(t){return t?(this._errorCode=t.readInt(),!0):!1}get errorCode(){return this._errorCode}}class MV{flush(){return this._phoneStatusCode=-1,this._millisecondsToAllowProcessReset=-1,!0}parse(t){return t?(this._phoneStatusCode=t.readInt(),this._collectionStatusCode=t.readInt(),this._millisecondsToAllowProcessReset=t.readInt(),!0):!1}get phoneStatusCode(){return this._phoneStatusCode}get collectionStatusCode(){return this._collectionStatusCode}get millisecondsToAllowProcessReset(){return this._millisecondsToAllowProcessReset}}class yV{flush(){return this._resultCode=-1,!0}parse(t){return t?(this._resultCode=t.readInt(),this._millisToAllowProcessReset=t.readInt(),!0):!1}get resultCode(){return this._resultCode}get millisToAllowProcessReset(){return this._millisToAllowProcessReset}}class DV{flush(){return this._resultCode=-1,this._millisecondsToAllowProcessReset=-1,!0}parse(t){return t?(this._resultCode=t.readInt(),this._millisecondsToAllowProcessReset=t.readInt(),!0):!1}get resultCode(){return this._resultCode}get millisToAllowProcessReset(){return this._millisecondsToAllowProcessReset}}class bV{flush(){return this._bases=new Map,this._symbols=new Map,this._partColors=new Map,this._colorsA=new Map,this._colorsB=new Map,!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;){const l=t.readInt(),c=t.readString(),u=t.readString();this._bases.set(l,[c,u]),e--}let s=t.readInt();for(;s>0;){const l=t.readInt(),c=t.readString(),u=t.readString();this._symbols.set(l,[c,u]),s--}let i=t.readInt();for(;i>0;){const l=t.readInt(),c=t.readString();this._partColors.set(l,c),i--}let n=t.readInt();for(;n>0;){const l=t.readInt(),c=t.readString();this._colorsA.set(l,c),n--}let o=t.readInt();for(;o>0;){const l=t.readInt(),c=t.readString();this._colorsB.set(l,c),o--}return!0}get bases(){return this._bases}get symbols(){return this._symbols}get partColors(){return this._partColors}get colorsA(){return this._colorsA}get colorsB(){return this._colorsB}}class vV{flush(){return this._groupCost=0,this._availableRooms=new Map,!0}parse(t){if(!t)return!1;this._groupCost=t.readInt();let e=t.readInt();for(;e>0;){const s=t.readInt(),i=t.readString();t.readBoolean(),this._availableRooms.set(s,i),e--}return!0}get groupCost(){return this._groupCost}get availableRooms(){return this._availableRooms}}class LV{flush(){return this._userId=0,this._furnitureCount=0,!0}parse(t){return t?(this._userId=t.readInt(),this._furnitureCount=t.readInt(),!0):!1}get userId(){return this._userId}get furnitureCount(){return this._furnitureCount}}class PV{flush(){return this._id=0,this._type=0,this._title=null,this._description=null,this._badge=null,this._roomId=0,this._roomName=null,this._membershipType=0,this._membersCount=0,this._isFavorite=!1,this._createdAt=null,this._isOwner=!1,this._isAdmin=!1,this._ownerName=null,this._flag=!1,this._canMembersDecorate=!1,this._pendingRequestsCount=0,!0}parse(t){return t?(this._id=t.readInt(),t.readBoolean(),this._type=t.readInt(),this._title=t.readString(),this._description=t.readString(),this._badge=t.readString(),this._roomId=t.readInt(),this._roomName=t.readString(),this._membershipType=t.readInt(),this._membersCount=t.readInt(),this._isFavorite=t.readBoolean(),this._createdAt=t.readString(),this._isOwner=t.readBoolean(),this._isAdmin=t.readBoolean(),this._ownerName=t.readString(),this._flag=t.readBoolean(),this._canMembersDecorate=t.readBoolean(),this._pendingRequestsCount=t.readInt(),!0):!1}get id(){return this._id}get type(){return this._type}get title(){return this._title}get description(){return this._description}get badge(){return this._badge}get roomId(){return this._roomId}get roomName(){return this._roomName}get membershipType(){return this._membershipType}get membersCount(){return this._membersCount}get isFavorite(){return this._isFavorite}get createdAt(){return this._createdAt}get isOwner(){return this._isOwner}get isAdmin(){return this._isAdmin}get ownerName(){return this._ownerName}get flag(){return this._flag}get canMembersDecorate(){return this._canMembersDecorate}get pendingRequestsCount(){return this._pendingRequestsCount}}class UV{constructor(t){this.isBase=t,this.key=0,this.color=0,this.position=4}get code(){return this.key===0?null:(this.isBase?"b":"s")+(this.key<100?"0":"")+(this.key<10?"0":"")+this.key+(this.color<10?"0":"")+this.color+this.position}}const Kl=class Kl{};Kl.OWNER=0,Kl.ADMIN=1,Kl.MEMBER=2,Kl.REQUESTED=3,Kl.DELETED=4;let Ei=Kl;class jV{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._rank=-1,this._id=0,this._name=null,this._figure=null,this._joinedAt=null,!0}parse(t){return t?(this._rank=t.readInt(),this._id=t.readInt(),this._name=t.readString(),this._figure=t.readString(),this._joinedAt=t.readString(),!0):!1}get id(){return this._id}get name(){return this._name}get figure(){return this._figure}get rank(){return this._rank}get joinedAt(){return this._joinedAt}}class wV{flush(){return this._groupId=0,this._groupTitle=null,this._roomId=0,this._badge=null,this._totalMembersCount=0,this._result=[],this._admin=!1,this._pageSize=0,this._pageIndex=0,this._level=0,this._query=null,!0}parse(t){if(!t)return!1;this._groupId=t.readInt(),this._groupTitle=t.readString(),this._roomId=t.readInt(),this._badge=t.readString(),this._totalMembersCount=t.readInt();let e=t.readInt();for(;e>0;)this._result.push(new jV(t)),e--;return this._admin=t.readBoolean(),this._pageSize=t.readInt(),this._pageIndex=t.readInt(),this._level=t.readInt(),this._query=t.readString(),!0}get groupId(){return this._groupId}get groupTitle(){return this._groupTitle}get roomId(){return this._roomId}get badge(){return this._badge}get totalMembersCount(){return this._totalMembersCount}get result(){return this._result}get admin(){return this._admin}get pageSize(){return this._pageSize}get pageIndex(){return this._pageIndex}get level(){return this._level}get query(){return this._query}}class FV{flush(){return this._roomId=0,this._groupId=0,!0}parse(t){return t?(this._roomId=t.readInt(),this._groupId=t.readInt(),!0):!1}get roomId(){return this._roomId}get guildId(){return this._groupId}}class GV{flush(){return this._roomId=0,this._roomName=null,this._id=0,this._title=null,this._description=null,this._colorA=0,this._colorB=0,this._state=0,this._canMembersDecorate=!1,this._badgeParts=new Map,this._badgeCode=null,this._membersCount=0,!0}parse(t){if(!t)return!1;t.readInt()===1&&(this._roomId=t.readInt(),this._roomName=t.readString(),t.readBoolean()),t.readBoolean(),this._id=t.readInt(),this._title=t.readString(),this._description=t.readString(),t.readInt(),this._colorA=t.readInt(),this._colorB=t.readInt(),this._state=t.readInt(),this._canMembersDecorate=t.readInt()===0,t.readBoolean(),t.readString();const s=t.readInt();for(let i=0;i<s;i++){const n=new UV(i===0);n.key=t.readInt(),n.color=t.readInt(),n.position=t.readInt(),n.key===0&&(n.position=4),this._badgeParts.set(i,n)}return this._badgeCode=t.readString(),this._membersCount=t.readInt(),!0}get roomId(){return this._roomId}get roomName(){return this._roomName}get id(){return this._id}get title(){return this._title}get description(){return this._description}get colorA(){return this._colorA}get colorB(){return this._colorB}get state(){return this._state}get canMembersDecorate(){return this._canMembersDecorate}get badgeParts(){return this._badgeParts}get badgeCode(){return this._badgeCode}get membersCount(){return this._membersCount}}class BV{flush(){return!0}parse(t){return this._groupId=t.readInt(),!0}get groupId(){return this._groupId}}class qd{static parse(t){return this.fillFromMessage(new qd,t)}static fillFromMessage(t,e){return t._groupId=e.readInt(),t._name=e.readString(),t._description=e.readString(),t._icon=e.readString(),t._totalThreads=e.readInt(),t._leaderboardScore=e.readInt(),t._totalMessages=e.readInt(),t._unreadMessages=e.readInt(),t._lastMessageId=e.readInt(),t._lastMessageAuthorId=e.readInt(),t._lastMessageAuthorName=e.readString(),t._lastMessageTimeAsSecondsAgo=e.readInt(),t}get groupId(){return this._groupId}get name(){return this._name}get description(){return this._description}get icon(){return this._icon}get totalThreads(){return this._totalThreads}get leaderboardScore(){return this._leaderboardScore}get totalMessages(){return this._totalMessages}get unreadMessages(){return this._unreadMessages}get lastMessageId(){return this._lastMessageId}get lastMessageAuthorId(){return this._lastMessageAuthorId}get lastMessageAuthorName(){return this._lastMessageAuthorName}get lastMessageTimeAsSecondsAgo(){return this._lastMessageTimeAsSecondsAgo}updateFrom(t){this._totalThreads=t._totalThreads,this._totalMessages=t._totalMessages,this._unreadMessages=t._unreadMessages,this._lastMessageAuthorId=t._lastMessageAuthorId,this._lastMessageAuthorName=t._lastMessageAuthorName,this._lastMessageId=t._lastMessageId,this._lastMessageTimeAsSecondsAgo=t._lastMessageTimeAsSecondsAgo}get lastReadMessageId(){return this._totalMessages-this._unreadMessages}set lastReadMessageId(t){this._unreadMessages=this._totalMessages-t,this._unreadMessages<0&&(this._unreadMessages=0)}addNewThread(t){this._lastMessageAuthorId=t.lastUserId,this._lastMessageAuthorName=t.lastUserName,this._lastMessageId=t.lastMessageId,this._lastMessageTimeAsSecondsAgo=t.lastCommentTime,this._totalThreads++,this._totalMessages++,this._unreadMessages=0}}class SS extends qd{static parse(t){const e=new SS;return qd.fillFromMessage(e,t),e._readPermissions=t.readInt(),e._postMessagePermissions=t.readInt(),e._postThreadPermissions=t.readInt(),e._moderatePermissions=t.readInt(),e._readPermissionError=t.readString(),e._postMessagePermissionError=t.readString(),e._postThreadPermissionError=t.readString(),e._moderatePermissionError=t.readString(),e._reportPermissionError=t.readString(),e._canChangeSettings=t.readBoolean(),e._isStaff=t.readBoolean(),e}get readPermissions(){return this._readPermissions}get postMessagePermissions(){return this._postMessagePermissions}get postThreadPermissions(){return this._postThreadPermissions}get moderatePermissions(){return this._moderatePermissions}get hasReadPermissionError(){return this._readPermissionError.length===0}get canReport(){return!0}get hasPostMessagePermissionError(){return this._postMessagePermissionError.length===0}get hasPostThreadPermissionError(){return this._postThreadPermissionError.length===0}get hasModeratePermissionError(){return this._moderatePermissionError.length===0}get canChangeSettings(){return this._canChangeSettings}get isStaf(){return this._isStaff}get readPermissionError(){return this._readPermissionError}get postMessagePermissionError(){return this._postMessagePermissionError}get postThreadPermissionError(){return this._postThreadPermissionError}get moderatePermissionError(){return this._moderatePermissionError}get reportPermissionError(){return this._reportPermissionError}}class kV{flush(){return this._extendedForumData=null,!0}parse(t){return t?(this._extendedForumData=SS.parse(t),!0):!1}get extendedForumData(){return this._extendedForumData}}class VV{flush(){return this._listCode=-1,this._totalAmount=0,this._startIndex=-1,this._amount=0,this._forums=[],!0}parse(t){if(!t)return!1;this._listCode=t.readInt(),this._totalAmount=t.readInt(),this._startIndex=t.readInt(),this._amount=t.readInt(),this._forums=[];let e=0;for(;e<this._amount;)this._forums.push(qd.parse(t)),e++;return!0}get listCode(){return this._listCode}get totalAmount(){return this._totalAmount}get startIndex(){return this._startIndex}get amount(){return this._amount}get forums(){return this._forums}}class I_{static parse(t){const e=new I_;return e._threadId=t.readInt(),e._authorId=t.readInt(),e._authorName=t.readString(),e._header=t.readString(),e._isPinned=t.readBoolean(),e._isLocked=t.readBoolean(),e._creationTimeAsSecondsAgo=t.readInt(),e._totalMessages=t.readInt(),e._unreadMessagesCount=t.readInt(),e._lastMessageId=t.readInt(),e._lastUserId=t.readInt(),e._lastUserName=t.readString(),e._lastCommentTime=t.readInt(),e._state=t.readByte(),e._adminId=t.readInt(),e._adminName=t.readString(),e._adminOperationTimeAsSecondsAgo=t.readInt(),e}get adminOperationTimeAsSecondsAgo(){return this._adminOperationTimeAsSecondsAgo}set adminOperationTimeAsSecondsAgo(t){this._adminOperationTimeAsSecondsAgo=t}get lastCommentTime(){return this._lastCommentTime}set lastCommentTime(t){this._lastCommentTime=t}get threadId(){return this._threadId}set threadId(t){this._threadId=t}get authorId(){return this._authorId}set authorId(t){this._authorId=t}get authorName(){return this._authorName}set authorName(t){this._authorName=t}get creationTimeAsSecondsAgo(){return this._creationTimeAsSecondsAgo}set creationTimeAsSecondsAgo(t){this._creationTimeAsSecondsAgo=t}get header(){return this._header}set header(t){this._header=t}get lastMessageId(){return this._lastMessageId}set lastMessageId(t){this._lastMessageId=t}get lastUserId(){return this._lastUserId}set lastUserId(t){this._lastUserId=t}get lastUserName(){return this._lastUserName}set lastUserName(t){this._lastUserName=t}get totalMessages(){return this._totalMessages}set totalMessages(t){this._totalMessages=t}get unreadMessagesCount(){return this._unreadMessagesCount}set unreadMessagesCount(t){this._unreadMessagesCount=t}get state(){return this._state}set state(t){this._state=t}get adminId(){return this._adminId}set adminId(t){this._adminId=t}get adminName(){return this._adminName}set adminName(t){this._adminName=t}get isPinned(){return this._isPinned}set isPinned(t){this._isPinned=t}get isLocked(){return this._isLocked}set isLocked(t){this._isLocked=t}}class HV{flush(){return this._groupId=-1,this._startIndex=-1,this._amount=0,this._threads=[],!0}parse(t){if(!t)return!1;this._groupId=t.readInt(),this._startIndex=t.readInt(),this._amount=t.readInt(),this._threads=[];let e=0;for(;e<this._amount;)this._threads.push(I_.parse(t)),e++;return!0}get groupId(){return this._groupId}get startIndex(){return this._startIndex}get amount(){return this._amount}get threads(){return this._threads}}class T_{static parse(t){const e=new T_;return e._messageId=t.readInt(),e._messageIndex=t.readInt(),e._authorId=t.readInt(),e._authorName=t.readString(),e._authorFigure=t.readString(),e._creationTime=t.readInt(),e._messageText=t.readString(),e._state=t.readByte(),e._adminId=t.readInt(),e._adminName=t.readString(),e._adminOperationTimeAsSeccondsAgo=t.readInt(),e._authorPostCount=t.readInt(),e}get state(){return this._state}set state(t){this._state=t}get adminId(){return this._adminId}set adminId(t){this._adminId=t}get adminName(){return this._adminName}set adminName(t){this._adminName=t}get adminOperationTimeAsSeccondsAgo(){return this._adminOperationTimeAsSeccondsAgo}set adminOperationTimeAsSeccondsAgo(t){this._adminOperationTimeAsSeccondsAgo=t}get messageId(){return this._messageId}set messageId(t){this._messageId=t}get creationTime(){return this._creationTime}set creationTime(t){this._creationTime=t}get authorName(){return this._authorName}set authorName(t){this._authorName=t}get authorFigure(){return this._authorFigure}set authorFigure(t){this._authorFigure=t}get threadId(){return this._threadId}set threadId(t){this._threadId=t}get messageIndex(){return this._messageIndex}set messageIndex(t){this._messageIndex=t}set groupID(t){this._groupId=t}get groupId(){return this._groupId}get authorId(){return this._authorId}set authorId(t){this._authorId=t}get messageText(){return this._messageText}set messageText(t){this._messageText=t}get authorPostCount(){return this._authorPostCount}set authorPostCount(t){this._authorPostCount=t}}class WV{flush(){return this._groupId=-1,this._threadId=-1,this._message=null,!0}parse(t){return t?(this._groupId=t.readInt(),this._threadId=t.readInt(),this._message=T_.parse(t),!0):!1}get groupId(){return this._groupId}get threadId(){return this._threadId}get message(){return this._message}}class YV{flush(){return this._groupId=-1,this._thread=null,!0}parse(t){return t?(this._groupId=t.readInt(),this._thread=I_.parse(t),!0):!1}get groupId(){return this._groupId}get thread(){return this._thread}}class zV{flush(){return this._groupId=-1,this._threadId=-1,this._startIndex=-1,this._amount=0,this._messages=[],!0}parse(t){if(!t)return!1;this._groupId=t.readInt(),this._threadId=t.readInt(),this._startIndex=t.readInt(),this._amount=t.readInt(),this._messages=[];let e=0;for(;e<this._amount;){const s=T_.parse(t);s.groupID=this._groupId,s.threadId=this._threadId,this._messages.push(s),e++}return!0}get groupId(){return this._groupId}get threadId(){return this._threadId}get startIndex(){return this._startIndex}get amount(){return this._amount}get messages(){return this._messages}}class KV{flush(){return this._count=0,!0}parse(t){return t?(this._count=t.readInt(),!0):!1}get count(){return this._count}}class XV{flush(){return this._groupId=-1,this._threadId=-1,this._message=null,!0}parse(t){return t?(this._groupId=t.readInt(),this._threadId=t.readInt(),this._message=T_.parse(t),!0):!1}get groupId(){return this._groupId}get threadId(){return this._threadId}get message(){return this._message}}class qV{flush(){return this._groupId=-1,this._thread=null,!0}parse(t){return t?(this._groupId=t.readInt(),this._thread=I_.parse(t),!0):!1}get groupId(){return this._groupId}get thread(){return this._thread}}class QV{constructor(){this._encryptedPublicKey=null,this._serverClientEncryption=!1}flush(){return!0}parse(t){return t?(this._encryptedPublicKey=t.readString(),t.bytesAvailable&&(this._serverClientEncryption=t.readBoolean()),!0):!1}get encryptedPublicKey(){return this._encryptedPublicKey}get serverClientEncryption(){return this._serverClientEncryption}}class JV{flush(){return this._reason=-1,!0}parse(t){return t?(this._reason=0,t.bytesAvailable&&(this._reason=t.readInt()),!0):!1}get reason(){return this._reason}}class $V{flush(){return this._accounts&&(this._accounts=new Map),!0}parse(t){if(!t)return!1;this._accounts=new Map;let e=t.readInt();for(;e>0;)this._accounts.set(t.readInt(),t.readString()),e--;return!0}get accounts(){return this._accounts}}class ZV{flush(){return!0}parse(t){return t?(this._encryptedPrime=t.readString(),this._encryptedGenerator=t.readString(),!0):!1}get encryptedPrime(){return this._encryptedPrime}get encryptedGenerator(){return this._encryptedGenerator}}class t2{flush(){return this._noobnessLevel=0,!0}parse(t){return t?(this._noobnessLevel=t.readInt(),!0):!1}get noobnessLevel(){return this._noobnessLevel}}class e2{flush(){return!0}parse(t){return t?(this._infoUrl=t.readString(),!0):!1}get infoUrl(){return this._infoUrl}}class s2{flush(){return!0}parse(t){return!0}}class i2{flush(){return this._calls=[],!0}parse(t){this._calls=[];const e=t.readInt();for(let s=0;s<e;s++){const i=t.readString(),n=t.readString(),o=t.readString();this._calls.push({callId:i,timeStamp:n,message:o})}return!0}get pendingCalls(){return this._calls}get count(){return this._calls.length}}class r2{flush(){return this._message=null,!0}parse(t){return this._message=t.readString(),!0}get message(){return this._message}}class n2{flush(){return this._resultType=0,this._messageText=null,!0}parse(t){return t?(this._resultType=t.readInt(),this._messageText=t.readString(),!0):!1}get resultType(){return this._resultType}get messageText(){return this._messageText}}class a2{flush(){return!0}parse(t){return!0}}class o2{flush(){return this._acceptanceTimeout=-1,!0}parse(t){return this._acceptanceTimeout=t.readInt(),!0}get acceptanceTimeout(){return this._acceptanceTimeout}}class l2{flush(){return this._winningVoteCode=-1,this._ownVoteCode=-1,this._finalStatus=null,!0}parse(t){this._finalStatus=[],this._winningVoteCode=t.readInt(),this._ownVoteCode=t.readInt();const e=t.readInt();for(let s=0;s<e;s++)this._finalStatus.push(t.readInt());return!0}get winningVoteCode(){return this._winningVoteCode}get ownVoteCode(){return this._ownVoteCode}get finalStatus(){return this._finalStatus}}class c2{flush(){return!0}parse(t){return this._votingTimeout=t.readInt(),this._chatRecord=t.readString(),!0}get votingTimeout(){return this._votingTimeout}get chatRecord(){return this._chatRecord}}const Go=class Go{flush(){return this._status=null,!0}parse(t){this._status=[];const e=t.readInt();for(let s=0;s<e;s++)this._status.push(t.readInt());return!0}get status(){return this._status}};Go.AWAITING_VOTE=0,Go.VOTED_OK=1,Go.VOTED_BAD=2,Go.VOTED_VERY_BAD=3,Go.NO_VOTE=4,Go.FINDING_NEW_VOTER=5;let HI=Go;class u2{flush(){return this._onDuty=!1,this._guidesOnDuty=0,this._helpersOnDuty=0,this._guardiansOnDuty=0,!0}parse(t){return t?(this._onDuty=t.readBoolean(),this._guidesOnDuty=t.readInt(),this._helpersOnDuty=t.readInt(),this._guardiansOnDuty=t.readInt(),!0):!1}get onDuty(){return this._onDuty}get guidesOnDuty(){return this._guidesOnDuty}get helpersOnDuty(){return this._helpersOnDuty}get guardiansOnDuty(){return this._guardiansOnDuty}}class h2{constructor(t,e,s,i,n,o,l){this._type=t,this._secondsAgo=e,this._isGuide=s,this._otherPartyName=i,this._otherPartyFigure=n,this._description=o,this._roomName=l}get type(){return this._type}set type(t){this._type=t}get secondsAgo(){return this._secondsAgo}set secondsAgo(t){this._secondsAgo=t}get isGuide(){return this._isGuide}set isGuide(t){this._isGuide=t}get otherPartyName(){return this._otherPartyName}set otherPartyName(t){this._otherPartyName=t}get otherPartyFigure(){return this._otherPartyFigure}set otherPartyFigure(t){this._otherPartyFigure=t}get description(){return this._description}set description(t){this._description=t}get roomName(){return this._roomName}set roomName(t){this._roomName=t}}const Nu=class Nu{flush(){return this._statusCode=0,this._pendingTicket=null,!0}parse(t){return t?(this._statusCode=t.readInt(),this._pendingTicket=new h2(t.readInt(),t.readInt(),t.readBoolean(),t.readString(),t.readString(),t.readString(),t.readString()),!0):!1}get statusCode(){return this._statusCode}get pendingTicket(){return this._pendingTicket}};Nu.GUIDE_REPORTING_STATUS_OK=0,Nu.GUIDE_REPORTING_STATUS_PENDING_TICKET=1,Nu.GUIDE_REPORTING_STATUS_ABUSIVE=2,Nu.GUIDE_REPORTING_STATUS_REPORTING_TOO_QUICKLY=3;let WI=Nu;class d2{flush(){return this._asGuide=!1,this._helpRequestType=0,this._helpRequestDescription=null,this._roleSpecificWaitTime=0,!0}parse(t){return t?(this._asGuide=t.readBoolean(),this._helpRequestType=t.readInt(),this._helpRequestDescription=t.readString(),this._roleSpecificWaitTime=t.readInt(),!0):!1}get asGuide(){return this._asGuide}get helpRequestType(){return this._helpRequestType}get helpRequestDescription(){return this._helpRequestDescription}get roleSpecificWaitTime(){return this._roleSpecificWaitTime}}class _2{flush(){return!0}parse(t){return!!t}}class g2{flush(){return this._endReason=0,!0}parse(t){return t?(this._endReason=t.readInt(),!0):!1}get endReason(){return this._endReason}}const Xl=class Xl{flush(){return this._errorCode=0,!0}parse(t){return t?(this._errorCode=t.readInt(),!0):!1}get errorCode(){return this._errorCode}};Xl.ERROR_GENERIC=0,Xl.ERROR_GUIDES_REJECT=1,Xl.ERROR_NOT_ENOUGH_GUIDES=2,Xl.ERROR_NOT_ENOUGH_VOTES=3,Xl.ERROR_NO_CHATLOG_FOUND=4;let YI=Xl;class f2{flush(){return this._roomId=0,this._roomName=null,!0}parse(t){return t?(this._roomId=t.readInt(),this._roomName=t.readString(),!0):!1}get roomId(){return this._roomId}get roomName(){return this._roomName}}class m2{flush(){return this._chatMessage=null,this._senderId=0,!0}parse(t){return t?(this._chatMessage=t.readString(),this._senderId=t.readInt(),!0):!1}get chatMessage(){return this._chatMessage}get senderId(){return this._senderId}}class E2{flush(){return this._isTyping=!1,!0}parse(t){return t?(this._isTyping=t.readBoolean(),!0):!1}get isTyping(){return this._isTyping}}class p2{flush(){return this._requesterRoomId=0,!0}parse(t){return t?(this._requesterRoomId=t.readInt(),!0):!1}get requesterRoomId(){return this._requesterRoomId}}class I2{flush(){return this._requesterUserId=0,this._requesterName=null,this._requesterFigure=null,this._guideUserId=0,this._guideName=null,this._guideFigure=null,!0}parse(t){return t?(this._requesterUserId=t.readInt(),this._requesterName=t.readString(),this._requesterFigure=t.readString(),this._guideUserId=t.readInt(),this._guideName=t.readString(),this._guideFigure=t.readString(),!0):!1}get requesterUserId(){return this._requesterUserId}get requesterName(){return this._requesterName}get requesterFigure(){return this._requesterFigure}get guideUserId(){return this._guideUserId}get guideName(){return this._guideName}get guideFigure(){return this._guideFigure}}const xu=class xu{flush(){return this._result=0,!0}parse(t){return t?(this._result=t.readInt(),!0):!1}get result(){return this._result}};xu.CREATION_RESULT_OK=0,xu.CREATION_RESULT_UNABLE_TO_REPORT=1,xu.CREATION_RESULT_NO_CHATLOG_FOUND=2,xu.CREATION_RESULT_BULLY_ALREADY_REPORTED=3;let zI=xu;const ad=class ad{flush(){return this._resolution=0,!0}parse(t){return t?(this._resolution=t.readInt(),!0):!1}get resolution(){return this._resolution}};ad.RESOLUTION_GUARDIANS_TOOK_ACTION=0,ad.RESOLUTION_FORWARDED_TO_MODERATORS=1,ad.RESOLUTION_REPORTER_IS_ABUSIVE=2;let KI=ad;class T2{flush(){return!0}parse(t){return!!t}}class R2{flush(){return this._closeReason=0,this._messageText="",!0}parse(t){return t?(this._closeReason=t.readInt(),this._messageText=t.readString(),!0):!1}get closeReason(){return this._closeReason}get messageText(){return this._messageText}}class S2{flush(){return this._quizCode=null,this._questionIds=[],!0}parse(t){if(!t)return!1;this._quizCode=t.readString();const e=t.readInt();this._questionIds=[];for(let s=0;s<e;s++)this._questionIds.push(t.readInt());return!0}get quizCode(){return this._quizCode}get questionIds(){return this._questionIds}}class O2{flush(){return this._quizCode=null,this._questionIdsForWrongAnswers=[],!0}parse(t){if(!t)return!1;this._quizCode=t.readString();const e=t.readInt();this._questionIdsForWrongAnswers=[];for(let s=0;s<e;s++)this._questionIdsForWrongAnswers.push(t.readInt());return!0}get quizCode(){return this._quizCode}get questionIdsForWrongAnswers(){return this._questionIdsForWrongAnswers}}const od=class od{constructor(t){this._id=t.readInt(),this._title=t.readString(),this._bodyText=t.readString(),this._buttonText=t.readString(),this._linkType=t.readInt(),this._linkContent=t.readString(),this._imageUrl=t.readString()}get id(){return this._id}get title(){return this._title}get bodyText(){return this._bodyText}get buttonText(){return this._buttonText}get linkType(){return this._linkType}get linkContent(){return this._linkContent}get imageUrl(){return this._imageUrl}};od.LINK_TYPE_URL=0,od.LINK_TYPE_INTERNAL=1,od.LINK_TYPE_NO_LINK=2;let XI=od;class C2{flush(){return this._articles=[],!0}parse(t){if(!t)return!1;const e=t.readInt();for(let s=0;s<e;s++)this._articles.push(new XI(t));return!0}get articles(){return this._articles}}class A2{flush(){return!0}parse(t){return t?(this._acknowledged=t.readBoolean(),!0):!1}get acknowledged(){return this._acknowledged}}class N2{flush(){return this._newOfferId=-1,this._newPrice=0,this._requestedOfferId=-1,!0}parse(t){return t?(this._result=t.readInt(),this._newOfferId=t.readInt(),this._newPrice=t.readInt(),this._requestedOfferId=t.readInt(),!0):!1}get result(){return this._result}get offerId(){return this._newOfferId}get newPrice(){return this._newPrice}get requestedOfferId(){return this._requestedOfferId}}class x2{flush(){return this._offerId=0,this._success=!1,!0}parse(t){return t?(this._offerId=t.readInt(),this._success=t.readBoolean(),!0):!1}get offerId(){return this._offerId}get success(){return this._success}}class M2{flush(){return this._tokenCount=0,this._result=0,!0}parse(t){return t?(this._result=t.readInt(),this._tokenCount=t.readInt(),!0):!1}get tokenCount(){return this._tokenCount}get resultCode(){return this._result}}class y2{flush(){return this._enabled=!1,this._commission=0,this._credits=0,this._advertisements=0,this._maximumPrice=0,this._minimumPrice=0,this._offerTime=0,this._displayTime=0,!0}parse(t){return t?(this._enabled=t.readBoolean(),this._commission=t.readInt(),this._credits=t.readInt(),this._advertisements=t.readInt(),this._minimumPrice=t.readInt(),this._maximumPrice=t.readInt(),this._offerTime=t.readInt(),this._displayTime=t.readInt(),!0):!1}get enabled(){return this._enabled}get commission(){return this._commission}get credits(){return this._credits}get advertisements(){return this._advertisements}get minimumPrice(){return this._minimumPrice}get maximumPrice(){return this._maximumPrice}get offerTime(){return this._offerTime}get displayTime(){return this._displayTime}}class D2{flush(){return this._result=0,!0}parse(t){return t?(this._result=t.readInt(),!0):!1}get result(){return this._result}}class b2{flush(){return this._averagePrice=0,this._currentOfferCount=0,this._historyLength=0,this._dayOffsets=[],this._averagePrices=[],this._soldAmounts=[],this._furniTypeId=0,this._furniCategoryId=0,!0}parse(t){if(!t)return!1;this._averagePrice=t.readInt(),this._currentOfferCount=t.readInt(),this._historyLength=t.readInt();let e=t.readInt();for(;e>0;)this._dayOffsets.push(t.readInt()),this._averagePrices.push(t.readInt()),this._soldAmounts.push(t.readInt()),e--;return this._furniCategoryId=t.readInt(),this._furniTypeId=t.readInt(),!0}get averagePrice(){return this._averagePrice}get offerCount(){return this._currentOfferCount}get historyLength(){return this._historyLength}get dayOffsets(){return this._dayOffsets}get averagePrices(){return this._averagePrices}get soldAmounts(){return this._soldAmounts}get furniTypeId(){return this._furniTypeId}get furniCategoryId(){return this._furniCategoryId}}class ex{constructor(t,e,s,i,n,o,l,c,u,h=-1){this._timeLeftMinutes=-1,this._offerId=t,this._furniId=e,this._furniType=s,this._extraData=i,this._stuffData=n,this._price=o,this._status=l,this._timeLeftMinutes=c,this._averagePrice=u,this._offerCount=h}get offerId(){return this._offerId}get furniId(){return this._furniId}get furniType(){return this._furniType}get extraData(){return this._extraData}get stuffData(){return this._stuffData}get price(){return this._price}get status(){return this._status}get timeLeftMinutes(){return this._timeLeftMinutes}get averagePrice(){return this._averagePrice}get offerCount(){return this._offerCount}get isUniqueLimitedItem(){return this.stuffData!=null&&this.stuffData.uniqueSeries>0}}var Rc;let Git=(Rc=class{constructor(t,e,s,i,n,o,l,c,u=-1){this._timeLeftMinutes=-1,this._offerId=t,this._furniId=e,this._furniType=s,this._extraData=i,this._stuffData=n,this._price=o,this._status=l,this._averagePrice=c,this._offerCount=u}get offerId(){return this._offerId}set offerId(t){this._offerId=t}get furniId(){return this._furniId}get furniType(){return this._furniType}get extraData(){return this._extraData}get stuffData(){return this._stuffData}get price(){return this._price}set price(t){this._price=t}get averagePrice(){return this._averagePrice}get image(){return this._image}set image(t){this._image=t}get imageCallback(){return this._imageCallback}set imageCallback(t){this._imageCallback=t}get status(){return this._status}get timeLeftMinutes(){return this._timeLeftMinutes}set timeLeftMinutes(t){this._timeLeftMinutes=t}get offerCount(){return this._offerCount}set offerCount(t){this._offerCount=t}get isUniqueLimitedItem(){return this.stuffData&&this.stuffData.uniqueSeries>0}},Rc.TYPE_LANDSCAPE=1,Rc.TYPE_FLOOR=2,Rc);const Ja=class Ja{constructor(){this.MAX_LIST_LENGTH=500}flush(){return this._offers=[],this._totalItemsFound=0,!0}parse(t){if(!t)return!1;const e=t.readInt();let s=0;for(;s<e;){const i=t.readInt(),n=t.readInt();let o=t.readInt(),l=-1,c="",u=null;o===Ja.FURNITYPE_STUFF?(l=t.readInt(),u=To.parseObjectData(t)):o===Ja.FURNITYPE_WALL?(l=t.readInt(),c=t.readString()):o==Ja.FAKE_FURNITYPE_UNIQUE&&(l=t.readInt(),u=Aa.getData(wi.FORMAT_KEY),u.uniqueNumber=t.readInt(),u.uniqueSeries=t.readInt(),o=Ja.FURNITYPE_STUFF);const h=t.readInt(),d=t.readInt(),g=t.readInt(),E=t.readInt(),m=new ex(i,l,o,c,u,h,n,d,g,E);s<this.MAX_LIST_LENGTH&&this._offers.push(m),s++}return this._totalItemsFound=t.readInt(),!0}get offers(){return this._offers}get totalItemsFound(){return this._totalItemsFound}};Ja.FURNITYPE_STUFF=1,Ja.FURNITYPE_WALL=2,Ja.FAKE_FURNITYPE_UNIQUE=3;let qI=Ja;const Km=class Km{flush(){return this._offers=[],!0}parse(t){if(!t)return!1;this._offers=[],this._creditsWaiting=t.readInt();const e=t.readInt();for(let s=0;s<e;s++){const i=t.readInt(),n=t.readInt();let o=t.readInt(),l,c,u;o==1?(l=t.readInt(),u=this.getStuffData(t)):o==2?(l=t.readInt(),c=t.readString()):o==3&&(l=t.readInt(),u=Aa.getData(wi.FORMAT_KEY),u.uniqueNumber=t.readInt(),u.uniqueSeries=t.readInt(),o=1);const h=t.readInt(),d=t.readInt(),g=t.readInt(),E=new ex(i,l,o,c,u,h,n,d,g);s<Km.MAX_LIST_LENGTH&&this._offers.push(E)}return!0}get offers(){return this._offers}get creditsWaiting(){return this._creditsWaiting}getStuffData(t){const e=t.readInt(),s=Aa.getData(e);return s.parseWrapper(t),s}};Km.MAX_LIST_LENGTH=500;let QI=Km;class v2{constructor(t,e,s,i,n){this._timestamp=t,this._habboId=e,this._username=s,this._message=i,this._hasHighlighting=n}get timestamp(){return this._timestamp}get userId(){return this._habboId}get userName(){return this._username}get message(){return this._message}get hasHighlighting(){return this._hasHighlighting}}const $a=class $a{constructor(t){this._context=new Map,this._chatlog=[],this._recordType=t.readByte();const e=t.readShort();for(let i=0;i<e;i++){const n=t.readString(),o=t.readByte();switch(o){case 0:this._context.set(n,t.readBoolean());break;case 1:this._context.set(n,t.readInt());break;case 2:this._context.set(n,t.readString());break;default:throw new Error("Unknown data type "+o)}}const s=t.readShort();for(let i=0;i<s;i++){const n=t.readString(),o=t.readInt(),l=t.readString(),c=t.readString(),u=t.readBoolean();this._chatlog.push(new v2(n,o,l,c,u))}}get recordType(){return this._recordType}get context(){return this._context}get chatlog(){return this._chatlog}get roomId(){return this.getInt("roomId")}get roomName(){return this._context.get("roomName")}get groupId(){return this.getInt("groupId")}get threadId(){return this.getInt("threadId")}get messageId(){return this.getInt("messageId")}getInt(t){const e=this._context.get(t);return e||0}};$a.TYPE_SIMPLE=0,$a.TYPE_ROOM_CHAT=1,$a.TYPE_IM_SESSION=2,$a.TYPE_DISCUSSION_THREAD=3,$a.TYPE_DISCUSSION_MESSAGE=4,$a.TYPE_SELFIE=5,$a.TYPE_PHOTO=6;let Qd=$a;class L2{constructor(t){this._issueId=t.readInt(),this._callerUserId=t.readInt(),this._reportedUserId=t.readInt(),this._chatRecordId=t.readInt(),this._chatRecord=new Qd(t)}get issueId(){return this._issueId}get callerUserId(){return this._callerUserId}get reportedUserId(){return this._reportedUserId}get chatRecordId(){return this._chatRecordId}get chatRecord(){return this._chatRecord}}class P2{flush(){return this._data=null,!0}parse(t){return t?(this._data=new L2(t),!0):!1}get data(){return this._data}}class U2{flush(){return!0}parse(t){return this._issueId=parseInt(t.readString()),!0}get issueId(){return this._issueId}}const ld=class ld{constructor(t,e,s,i,n,o,l,c,u,h,d,g,E,m,I,p){this._disposed=!1,this._issueId=t,this._state=e,this._categoryId=s,this._reportedCategoryId=i,this._issueAgeInMilliseconds=n,this._priority=o,this._groupingId=l,this._reporterUserId=c,this._reporterUserName=u,this._reportedUserId=h,this._reportedUserName=d,this._pickerUserId=g,this._pickerUserName=E,this._message=m,this._chatRecordId=I,this._patterns=p,this._creationTimeInMilliseconds=Pt()}get issueId(){return this._issueId}get state(){return this._state}get categoryId(){return this._categoryId}get reportedCategoryId(){return this._reportedCategoryId}get issueAgeInMilliseconds(){return this._issueAgeInMilliseconds}get priority(){return this._priority}get groupingId(){return this._groupingId}get reporterUserId(){return this._reporterUserId}get reporterUserName(){return this._reporterUserName}get reportedUserId(){return this._reportedUserId}get reportedUserName(){return this._reportedUserName}get pickerUserId(){return this._pickerUserId}get pickerUserName(){return this._pickerUserName}get message(){return this._message}get chatRecordId(){return this._chatRecordId}get patterns(){return this._patterns}dispose(){if(!this.disposed){for(const t of this._patterns)t.dispose();this._patterns=[],this._disposed=!0}}get disposed(){return this._disposed}getOpenTime(t){const s=(this._issueAgeInMilliseconds+t-this._creationTimeInMilliseconds)/1e3/60,i=s%60,n=s/60,o=(i<10?"0":"")+i;return(n<10?"0":"")+n+":"+o}};ld.STATE_OPEN=1,ld.STATE_PICKED=2,ld.STATE_CLOSED=3;let Ec=ld;class j2{constructor(t){this._disposed=!1,this._pattern=t.readString(),this._startIndex=t.readInt(),this._endIndex=t.readInt()}dispose(){this._disposed=!0,this._pattern="",this._startIndex=-1,this._endIndex=-1}get disposed(){return this._disposed}get pattern(){return this._pattern}get startIndex(){return this._startIndex}get endIndex(){return this._endIndex}}class sx{get issueData(){return this._issueData}flush(){return this._issueData=null,!0}parse(t){const e=t.readInt(),s=t.readInt(),i=t.readInt(),n=t.readInt(),o=t.readInt(),l=t.readInt(),c=t.readInt(),u=t.readInt(),h=t.readString(),d=t.readInt(),g=t.readString(),E=t.readInt(),m=t.readString(),I=t.readString(),p=t.readInt(),T=t.readInt(),R=[];for(let S=0;S<T;S++)R.push(new j2(t));return this._issueData=new Ec(e,s,i,n,o,l,c,u,h,d,g,E,m,I,p,R),!0}}class w2{flush(){return this._issues=null,!0}parse(t){this._issues=[];const e=t.readInt();for(let s=0;s<e;s++){const i=t.readInt(),n=t.readInt(),o=t.readString(),l=new Ec(i,0,0,0,0,0,0,0,null,0,null,n,o,null,0,[]);this._issues.push(l)}return this._retryEnabled=t.readBoolean(),this._retryCount=t.readInt(),!0}get issues(){return this._issues}get retryEnabled(){return this._retryEnabled}get retryCount(){return this._retryCount}}class F2{flush(){return this._message="",this._url=null,!0}parse(t){return t?(this._message=t.readString(),this._url=t.readString(),!0):!1}get message(){return this._message}get url(){return this._url}}class G2{flush(){return this._userId=-1,this._success=!1,!0}parse(t){return this._userId=t.readInt(),this._success=t.readBoolean(),!0}get userId(){return this._userId}get success(){return this._success}}class B2{constructor(t){this._disposed=!1;const e=new sx;this._issues=[],this._messageTemplates=[],this._roomMessageTemplates=[];let s=t.readInt(),i=0;for(;i<s;)e.parse(t)&&this._issues.push(e.issueData),i++;for(s=t.readInt(),i=0;i<s;)this._messageTemplates.push(t.readString()),i++;for(s=t.readInt(),i=0;i<s;)t.readString(),i++;for(this._cfhPermission=t.readBoolean(),this._chatlogsPermission=t.readBoolean(),this._alertPermission=t.readBoolean(),this._kickPermission=t.readBoolean(),this._banPermission=t.readBoolean(),this._roomAlertPermission=t.readBoolean(),this._roomKickPermission=t.readBoolean(),s=t.readInt(),i=0;i<s;)this._roomMessageTemplates.push(t.readString()),i++}dispose(){this._disposed||(this._disposed=!0,this._messageTemplates=null,this._roomMessageTemplates=null,this._issues=null)}get disposed(){return this._disposed}get messageTemplates(){return this._messageTemplates}get roomMessageTemplates(){return this._roomMessageTemplates}get issues(){return this._issues}get cfhPermission(){return this._cfhPermission}get chatlogsPermission(){return this._chatlogsPermission}get alertPermission(){return this._alertPermission}get kickPermission(){return this._kickPermission}get banPermission(){return this._banPermission}get roomAlertPermission(){return this._roomAlertPermission}get roomKickPermission(){return this._roomKickPermission}}class k2{constructor(){this._data=null}flush(){return this._data=null,!0}parse(t){return this._data=new B2(t),!0}get data(){return this._data}}class V2{flush(){return this._message="",this._url="",!0}parse(t){return t?(this._message=t.readString(),this._url=t.readString(),!0):!1}get message(){return this._message}get url(){return this._url}}class H2{constructor(t){if(this._tags=[],this._exists=t.readBoolean(),!this.exists)return;this._name=t.readString(),this._desc=t.readString();const e=t.readInt();for(let s=0;s<e;s++)this._tags.push(t.readString())}get name(){return this._name}get desc(){return this._desc}get tags(){return this._tags}get exists(){return this._exists}get disposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this._tags=null)}}class W2{constructor(t){this._flatId=t.readInt(),this._userCount=t.readInt(),this._ownerInRoom=t.readBoolean(),this._ownerId=t.readInt(),this._ownerName=t.readString(),this._room=new H2(t)}get flatId(){return this._flatId}get userCount(){return this._userCount}get ownerInRoom(){return this._ownerInRoom}get ownerId(){return this._ownerId}get ownerName(){return this._ownerName}get room(){return this._room}get disposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this._room!=null&&(this._room.dispose(),this._room=null))}}class Y2{flush(){return this._data=null,!0}parse(t){return t?(this._data=new W2(t),!0):!1}get data(){return this._data}}class z2{flush(){return this._windowX=0,this._windowY=0,this._windowWidth=0,this._windowHeight=0,!0}parse(t){return this._windowX=t.readInt(),this._windowY=t.readInt(),this._windowWidth=t.readInt(),this._windowHeight=t.readInt(),!0}get windowX(){return this._windowX}get windowY(){return this._windowY}get windowWidth(){return this._windowWidth}get windowHeight(){return this._windowHeight}}class K2{constructor(t){this._lastSanctionTime="",this._sanctionAgeHours=0,this._userId=t.readInt(),this._userName=t.readString(),this._figure=t.readString(),this._registrationAgeInMinutes=t.readInt(),this._minutesSinceLastLogin=t.readInt(),this._online=t.readBoolean(),this._cfhCount=t.readInt(),this._abusiveCfhCount=t.readInt(),this._cautionCount=t.readInt(),this._banCount=t.readInt(),this._tradingLockCount=t.readInt(),this._tradingExpiryDate=t.readString(),this._lastPurchaseDate=t.readString(),this._identityId=t.readInt(),this._identityRelatedBanCount=t.readInt(),this._primaryEmailAddress=t.readString(),this._userClassification=t.readString(),t.bytesAvailable&&(this._lastSanctionTime=t.readString(),this._sanctionAgeHours=t.readInt())}get userId(){return this._userId}get userName(){return this._userName}get figure(){return this._figure}get registrationAgeInMinutes(){return this._registrationAgeInMinutes}get minutesSinceLastLogin(){return this._minutesSinceLastLogin}get online(){return this._online}get cfhCount(){return this._cfhCount}get abusiveCfhCount(){return this._abusiveCfhCount}get cautionCount(){return this._cautionCount}get banCount(){return this._banCount}get tradingLockCount(){return this._tradingLockCount}get tradingExpiryDate(){return this._tradingExpiryDate}get lastPurchaseDate(){return this._lastPurchaseDate}get identityId(){return this._identityId}get identityRelatedBanCount(){return this._identityRelatedBanCount}get primaryEmailAddress(){return this._primaryEmailAddress}get userClassification(){return this._userClassification}get lastSanctionTime(){return this._lastSanctionTime}get sanctionAgeHours(){return this._sanctionAgeHours}}class X2{flush(){return this._data=null,!0}parse(t){return t?(this._data=new K2(t),!0):!1}get data(){return this._data}}class q2{flush(){return this._data=null,!0}parse(t){return t?(this._data=new Qd(t),!0):!1}get data(){return this._data}}class Q2{constructor(t){this._roomId=t.readInt(),this._roomName=t.readString(),this._enterHour=t.readInt(),this._enterMinute=t.readInt()}get roomId(){return this._roomId}get roomName(){return this._roomName}get enterHour(){return this._enterHour}get enterMinute(){return this._enterMinute}}class J2{constructor(t){this._rooms=[],this._userId=t.readInt(),this._userName=t.readString();const e=t.readInt();let s=0;for(;s<e;)this._rooms.push(new Q2(t)),s++}get userId(){return this._userId}get userName(){return this._userName}get rooms(){return this._rooms}}class $2{flush(){return!0}parse(t){return this._data=new J2(t),!0}get data(){return this._data}}class Z2{flush(){return this._message="",!0}parse(t){return t?(this._message=t.readString(),!0):!1}get message(){return this._message}}class tH{constructor(t){this._roomChatlogs=[],this._userId=t.readInt(),this._username=t.readString();const e=t.readInt();for(let s=0;s<e;s++)this._roomChatlogs.push(new Qd(t))}get userId(){return this._userId}get username(){return this._username}get roomChatlogs(){return this._roomChatlogs}}class eH{flush(){return this._data=null,!0}parse(t){return t?(this._data=new tH(t),!0):!1}get data(){return this._data}}class sH{flush(){return!0}parse(t){return!!t}}class iH{flush(){return!0}parse(t){return t?(this._contentType=t.readString(),this._classId=t.readInt(),!0):!1}get contentType(){return this._contentType}get classId(){return this._classId}}class rH{flush(){return this._boxColor=null,this._keyColor=null,!0}parse(t){return t?(this._boxColor=t.readString(),this._keyColor=t.readString(),!0):!1}get boxColor(){return this._boxColor}get keyColor(){return this._keyColor}}class nH{flush(){return!0}parse(t){return!!t}}class aH{flush(){return this._canCreate=!1,this._errorCode=0,!0}parse(t){return t?(this._canCreate=t.readBoolean(),this._errorCode=t.readInt(),!0):!1}get canCreate(){return this._canCreate}get errorCode(){return this._errorCode}}const Xm=class Xm{flush(){return!0}parse(t){return t?(this._resultCode=t.readInt(),this._roomLimit=t.readInt(),!0):!1}get resultCode(){return this._resultCode}get roomLimit(){return this._roomLimit}};Xm.CREATION_ALLOWED=0,Xm.ROOM_LIMIT_REACHED=1;let JI=Xm;class oH{constructor(t){this._categoryToCurrentUserCountMap=new Map,this._categoryToMaxUserCountMap=new Map;const e=t.readInt();for(let s=0;s<e;s++){const i=t.readInt(),n=t.readInt(),o=t.readInt();this._categoryToCurrentUserCountMap.set(i,n),this._categoryToMaxUserCountMap.set(i,o)}}get categoryToCurrentUserCountMap(){return this._categoryToCurrentUserCountMap}get categoryToMaxUserCountMap(){return this._categoryToMaxUserCountMap}}class lH{constructor(t,e=0,s=0){this._goalId=e,this._pageIndex=s,t&&(this._goalId=t.readInt(),this._pageIndex=t.readInt(),this._pageCount=t.readInt())}get goalId(){return this._goalId}get pageIndex(){return this._pageIndex}get pageCount(){return this._pageCount}}const Za=class Za{constructor(t){this._index=t.readInt(),this._popupCaption=t.readString(),this._popupDesc=t.readString(),this._showDetails=t.readInt()==1,this._picText=t.readString(),this._picRef=t.readString(),this._folderId=t.readInt(),this._userCount=t.readInt(),this._type=t.readInt(),this._type==Za.TYPE_TAG?this._tag=t.readString():this._type==Za.TYPE_GUEST_ROOM?this._guestRoomData=new De(t):this._open=t.readBoolean()}dispose(){this._disposed||(this._disposed=!0,this._guestRoomData!=null&&(this._guestRoomData.flush(),this._guestRoomData=null))}get disposed(){return this._disposed}get type(){return this._type}get index(){return this._index}get popupCaption(){return this._popupCaption}get popupDesc(){return this._popupDesc}get showDetails(){return this._showDetails}get picText(){return this._picText}get picRef(){return this._picRef}get folderId(){return this._folderId}get tag(){return this._tag}get userCount(){return this._userCount}get guestRoomData(){return this._guestRoomData}get open(){return this._open}toggleOpen(){this._open=!this._open}get maxUsers(){return this.type==Za.TYPE_TAG?0:this.type==Za.TYPE_GUEST_ROOM?this._guestRoomData.maxUserCount:0}};Za.TYPE_TAG=1,Za.TYPE_GUEST_ROOM=2,Za.TYPE_FOLDER=4;let $I=Za;class cH{constructor(t){this._rooms=[],this._searchType=t.readInt(),this._searchParam=t.readString();const e=t.readInt();for(let i=0;i<e;i++)this._rooms.push(new De(t));t.readBoolean()&&(this._ad=new $I(t))}dispose(){if(!this._disposed){if(this._disposed=!0,this._rooms!=null)for(const t of this._rooms)t.flush();this._ad!=null&&(this._ad.dispose(),this._ad=null),this._rooms=null}}get disposed(){return this._disposed}get searchType(){return this._searchType}get searchParam(){return this._searchParam}get rooms(){return this._rooms}get ad(){return this._ad}}class ix{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._id=-1,this._code=null,this._filter=null,this._localization=null,!0}parse(t){return t?(this._id=t.readInt(),this._code=t.readString(),this._filter=t.readString(),this._localization=t.readString(),!0):!1}get id(){return this._id}get code(){return this._code}get filter(){return this._filter}get localization(){return this._localization}}class uH{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._code=null,this._data=null,this._action=-1,this._closed=!1,this._mode=-1,this._rooms=[],!0}parse(t){if(!t)return!1;this._code=t.readString(),this._data=t.readString(),this._action=t.readInt(),this._closed=t.readBoolean(),this._mode=t.readInt();let e=t.readInt();for(;e>0;)this._rooms.push(new De(t)),e--;return!0}get code(){return this._code}get data(){return this._data}get action(){return this._action}get closed(){return this._closed}get mode(){return this._mode}get rooms(){return this._rooms}}class hH{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._code=null,this._data=null,this._results=[],!0}parse(t){if(!t)return!1;this._code=t.readString(),this._data=t.readString();let e=t.readInt();for(;e>0;)this._results.push(new uH(t)),e--;return!0}get code(){return this._code}get data(){return this._data}get results(){return this._results}}class dH{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._code=null,this._savedSearches=[],!0}parse(t){if(!t)return!1;this._code=t.readString();let e=t.readInt();for(;e>0;)this._savedSearches.push(new ix(t)),e--;return!0}get code(){return this._code}get savedSearches(){return this._savedSearches}}class _H{constructor(t){this._adId=t.readInt(),this._ownerAvatarId=t.readInt(),this._ownerAvatarName=t.readString(),this._flatId=t.readInt(),this._eventType=t.readInt(),this._eventName=t.readString(),this._eventDescription=t.readString();const e=t.readInt(),s=t.readInt(),i=new Date;let n=i.getTime();const o=e*60*1e3;n=n-o;const l=new Date(n);this._creationTime=l.getDate()+"-"+l.getMonth()+"-"+l.getFullYear()+" "+l.getHours()+":"+l.getMinutes();let c=i.getTime();const u=s*60*1e3;c=c+u,this._expirationDate=new Date(c),this._categoryId=t.readInt()}dispose(){this._disposed||(this._disposed=!0)}get disposed(){return this._disposed}get adId(){return this._adId}get ownerAvatarId(){return this._ownerAvatarId}get ownerAvatarName(){return this._ownerAvatarName}get flatId(){return this._flatId}get categoryId(){return this._categoryId}get eventType(){return this._eventType}get eventName(){return this._eventName}get eventDescription(){return this._eventDescription}get creationTime(){return this._creationTime}get expirationDate(){return this._expirationDate}}class gH{flush(){return!0}parse(t){return t?(this._data=new oH(t),!0):!1}get data(){return this._data}}class fH{flush(){return!0}parse(t){return t?(this._data=new lH(t),!0):!1}get data(){return this._data}}class mH{flush(){return!0}parse(t){return t?(this._globalId=t.readString(),this._convertedId=t.readInt(),!0):!1}get globalId(){return this._globalId}get convertedId(){return this._convertedId}}class EH{flush(){return this._userName=null,!0}parse(t){return t?(this._userName=t.readString(),!0):!1}get userName(){return this._userName}}class pH{flush(){return!0}parse(t){return t?(this._flatId=t.readInt(),this._added=t.readBoolean(),!0):!1}get flatId(){return this._flatId}get added(){return this._added}}class IH{flush(){return!0}parse(t){if(!t)return!1;this._favouriteRoomIds=[],this._limit=t.readInt();const e=t.readInt();for(let s=0;s<e;s++)this._favouriteRoomIds.push(t.readInt());return!0}get limit(){return this._limit}get favoriteRoomIds(){return this._favouriteRoomIds}}class TH{flush(){return this._userName=null,!0}parse(t){return t?(this._userName=t.readString(),!0):!1}get userName(){return this._userName}}class RH{flush(){return this._roomId=-1,this._roomName=null,!0}parse(t){return t?(this._roomId=t.readInt(),this._roomName=t.readString(),!0):!1}get roomId(){return this._roomId}get roomName(){return this._roomName}}class SH{flush(){return this._roomEnter=!1,this._roomForward=!1,this._data=null,this._staffPick=!1,this._isGroupMember=!1,this._moderation=null,this._chat=null,!0}parse(t){return t?(this._roomEnter=t.readBoolean(),this._data=new De(t),this._roomForward=t.readBoolean(),this._staffPick=t.readBoolean(),this._isGroupMember=t.readBoolean(),this.data.allInRoomMuted=t.readBoolean(),this._moderation=new tr(t),this.data.canMute=t.readBoolean(),this._chat=new ns(t),!0):!1}get roomEnter(){return this._roomEnter}get roomForward(){return this._roomForward}get data(){return this._data}get staffPick(){return this._staffPick}get isGroupMember(){return this._isGroupMember}get moderation(){return this._moderation}get chat(){return this._chat}}class OH{flush(){return!0}parse(t){return t?(this._data=new cH(t),!0):!1}get data(){return this._data}}class CH{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._id=-1,this._name=null,this._visible=!1,this._automatic=!1,this._automaticCategoryKey=null,this._globalCategoryKey=null,this._staffOnly=!1,!0}parse(t){return t?(this._id=t.readInt(),this._name=t.readString(),this._visible=t.readBoolean(),this._automatic=t.readBoolean(),this._automaticCategoryKey=t.readString(),this._globalCategoryKey=t.readString(),this._staffOnly=t.readBoolean(),!0):!1}get id(){return this._id}get name(){return this._name}get visible(){return this._visible}get automatic(){return this._automatic}get automaticCategoryKey(){return this._automaticCategoryKey}get globalCategoryKey(){return this._globalCategoryKey}get staffOnly(){return this._staffOnly}}class AH{flush(){return this._categories=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._categories.push(t.readString()),e--;return!0}get categories(){return this._categories}}class NH{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._id=-1,this._name=null,this._visible=!1,!0}parse(t){return t?(this._id=t.readInt(),this._name=t.readString(),this._visible=t.readBoolean(),!0):!1}get id(){return this._id}get name(){return this._name}get visible(){return this._visible}}class xH{flush(){return this._homeRoomId=-1,this._roomIdToEnter=-1,!0}parse(t){return t?(this._homeRoomId=t.readInt(),this._roomIdToEnter=t.readInt(),!0):!1}get homeRoomId(){return this._homeRoomId}get roomIdToEnter(){return this._roomIdToEnter}}class MH{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._roomId=-1,this._areaId=-1,this._image=null,this._caption=null,!0}parse(t){return t?(this._roomId=t.readInt(),this._areaId=t.readInt(),this._image=t.readString(),this._caption=t.readString(),!0):!1}get roomId(){return this._roomId}get areaId(){return this._areaId}get image(){return this._image}get caption(){return this._caption}}class yH{flush(){return this._rooms=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._rooms.push(new MH(t)),e--;return!0}get rooms(){return this._rooms}}class DH{flush(){return this._topLevelContexts=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._topLevelContexts.push(new dH(t)),e--;return!0}get topLevelContexts(){return this._topLevelContexts}}class bH{flush(){return!0}parse(t){return!!t}}class vH{flush(){return this._searches=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._searches.push(new ix(t)),e--;return!0}get searches(){return this._searches}}class LH{flush(){return this._result=null,!0}parse(t){return t?(this._result=new hH(t),!0):!1}get result(){return this._result}}class PH{flush(){return this._windowX=0,this._windowY=0,this._windowWidth=0,this._windowHeight=0,this._leftPanelHidden=!1,this._resultsMode=0,!0}parse(t){return t?(this._windowX=t.readInt(),this._windowY=t.readInt(),this._windowWidth=t.readInt(),this._windowHeight=t.readInt(),this._leftPanelHidden=t.readBoolean(),this._resultsMode=t.readInt(),!0):!1}get windowX(){return this._windowX}get windowY(){return this._windowY}get windowWidth(){return this._windowWidth}get windowHeight(){return this._windowHeight}get leftPanelHidden(){return this._leftPanelHidden}get resultsMode(){return this._resultsMode}}class UH{constructor(t){this._tagName=t.readString(),this._userCount=t.readInt()}get tagName(){return this._tagName}get userCount(){return this._userCount}}class jH{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._tags=[],!0}parse(t){if(!t)return!1;this._tags=[];const e=t.readInt();let s=0;for(;s<e;)this._tags.push(new UH(t)),s++;return!0}get tags(){return this._tags}}class wH{flush(){return this._data=null,!0}parse(t){return t?(this._data=new jH(t),!0):!1}get data(){return this._data}}class FH{flush(){return!0}parse(t){return!0}}class GH{flush(){return!0}parse(t){return this._data=new _H(t),!0}get data(){return this._data}}class BH{flush(){return this._words=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._words.push(t.readString()),e--;return!0}get words(){return this._words}}class kH{flush(){return this._roomId=0,!0}parse(t){return t?(this._roomId=t.readInt(),!0):!1}get roomId(){return this._roomId}}class VH{flush(){return!0}parse(t){return this._flatId=t.readInt(),this._resultCode=t.readInt(),!0}get flatId(){return this._flatId}get resultCode(){return this._resultCode}}class HH{flush(){return this._categories=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._categories.push(new NH(t)),e--;return!0}get categories(){return this._categories}}class WH{flush(){return this._categories=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._categories.push(new CH(t)),e--;return!0}get categories(){return this._categories}}class YH{constructor(t){this._badgeCode="",this._removedBadgeCode="",this._type=t.readInt(),this._level=t.readInt(),this._badgeId=t.readInt(),this._badgeCode=t.readString(),this._points=t.readInt(),this._levelRewardPoints=t.readInt(),this._levelRewardPointType=t.readInt(),this._bonusPoints=t.readInt(),this._achievementID=t.readInt(),this._removedBadgeCode=t.readString(),this._category=t.readString(),this._showDialogToUser=t.readBoolean()}get type(){return this._type}get level(){return this._level}get points(){return this._points}get levelRewardPoints(){return this._levelRewardPoints}get levelRewardPointType(){return this._levelRewardPointType}get bonusPoints(){return this._bonusPoints}get badgeId(){return this._badgeId}get badgeCode(){return this._badgeCode}get removedBadgeCode(){return this._removedBadgeCode}get achievementID(){return this._achievementID}get category(){return this._category}get showDialogToUser(){return this._showDialogToUser}}class zH{flush(){return this._data=null,!0}parse(t){return t?(this._data=new YH(t),!0):!1}get data(){return this._data}}class KH{flush(){return this._amount=0,this._amountChanged=0,this._type=-1,!0}parse(t){return t?(this._amount=t.readInt(),this._amountChanged=t.readInt(),this._type=t.readInt(),!0):!1}get amount(){return this._amount}get amountChanged(){return this._amountChanged}get type(){return this._type}}class XH{flush(){return this._errorCode=-1,!0}parse(t){return t?(this._errorCode=t.readInt(),!0):!1}get errorCode(){return this._errorCode}}class qH{flush(){return this._numGifts=0,!0}parse(t){return t?(this._numGifts=t.readInt(),!0):!1}get numGifts(){return this._numGifts}}class QH{flush(){return this._errorCode=0,this._messageId=0,this._timestamp=null,!0}parse(t){return t?(this._messageId=t.readInt(),this._errorCode=t.readInt(),this._timestamp=t.readString(),!0):!1}get errorCode(){return this._errorCode}get messageId(){return this._messageId}get timestamp(){return this._timestamp}}class JH{flush(){return this._key=null,!0}parse(t){return t?(this._key=t.readString(),!0):!1}get key(){return this._key}}class $H{flush(){return this._message=null,!0}parse(t){return t?(this._message=t.readString(),!0):!1}get message(){return this._message}}class ZH{flush(){return this._enabled=!1,!0}parse(t){return t?(this._enabled=t.readBoolean(),!0):!1}get enabled(){return this._enabled}}class tW{flush(){return this._messages=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._messages.push(t.readString()),e--;return!0}get messages(){return this._messages}}class eW{flush(){return this._type=null,this._parameters=new Map,!0}parse(t){if(!t)return!1;this._type=t.readString();let e=t.readInt();for(;e>0;)this._parameters.set(t.readString(),t.readString()),e--;return!0}get type(){return this._type}get parameters(){return this._parameters}}class sW{flush(){return this._contentType=null,this._classId=0,this._name=null,this._description=null,!0}parse(t){return t?(this._contentType=t.readString(),this._classId=t.readInt(),this._name=t.readString(),this._description=t.readString(),!0):!1}get contentType(){return this._contentType}get classId(){return this._classId}get name(){return this._name}get description(){return this._description}}class iW{flush(){return this._petId=-1,this._petName=null,this._level=0,this._figureData=null,!0}parse(t){return t?(this._petId=t.readInt(),this._petName=t.readString(),this._level=t.readInt(),this._figureData=new RS(t),!0):!1}get petId(){return this._petId}get petName(){return this._petName}get level(){return this._level}get figureData(){return this._figureData}}class rW{flush(){return this._errorCode=-1,!0}parse(t){return t?(this._errorCode=t.readInt(),!0):!1}get errorCode(){return this._errorCode}}class nW{flush(){return!0}parse(t){return!0}}class aW{flush(){return this._alertMessage=null,!0}parse(t){return t?(this._alertMessage=t.readString(),t.bytesAvailable&&(this._titleMessage=t.readString()),!0):!1}get alertMessage(){return this._alertMessage}get titleMessage(){return this._titleMessage}}class oW{flush(){return this._items=new hs,!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;){const s=t.readInt();let i=t.readInt();const n=[];for(;i>0;)n.push(t.readInt()),i--;this._items.add(s,n),e--}return!0}getItemsByCategory(t){return this._items.getValue(t)}get categories(){return this._items.getKeys()}}class lW{flush(){return this._columns=null,this._rows=null,!0}parse(t){if(!t)return!1;this._columns=[],this._rows=new Map;let e=t.readInt();for(;e>0;)this._columns.push(t.readString()),e--;let s=t.readInt();for(;s>0;){for(var i=t.readInt(),n=t.readInt(),o=new Map;n>0;)o.set(t.readInt(),t.readString()),n--;this._rows.set(i,o),s--}return!0}get columns(){return this._columns}get rows(){return this._rows}}class cW{constructor(t,e,s){this._code=t,this._errorMessage=e,this._isAllowed=s}get code(){return this._code}get errorMessage(){return this._errorMessage}get isAllowed(){return this._isAllowed}}const hr=class hr{};hr.USE_GUIDE_TOOL="USE_GUIDE_TOOL",hr.GIVE_GUIDE_TOUR="GIVE_GUIDE_TOUR",hr.JUDGE_CHAT_REVIEWS="JUDGE_CHAT_REVIEWS",hr.VOTE_IN_COMPETITIONS="VOTE_IN_COMPETITIONS",hr.CALL_ON_HELPERS="CALL_ON_HELPERS",hr.CITIZEN="CITIZEN",hr.TRADE="TRADE",hr.HEIGHTMAP_EDITOR_BETA="HEIGHTMAP_EDITOR_BETA",hr.BUILDER_AT_WORK="BUILDER_AT_WORK",hr.NAVIGATOR_ROOM_THUMBNAIL_CAMERA="NAVIGATOR_ROOM_THUMBNAIL_CAMERA",hr.CAMERA="CAMERA",hr.MOUSE_ZOOM="MOUSE_ZOOM";let Vg=hr;class uW{flush(){return this._perks=[],!0}parse(t){if(!t)return!1;this._perks=[];const e=t.readInt();for(let s=0;s<e;s++)this._perks.push(new cW(t.readString(),t.readString(),t.readBoolean()));return!0}isAllowed(t){let e=!1;for(const s of this._perks)if(s.code===t){e=s.isAllowed;break}return e}get perks(){return this._perks}}class hW{flush(){return this._objectId=-1,this._figureData=null,!0}parse(t){return this._objectId=t.readInt(),t.bytesAvailable&&(this._figureData=new La(t.readString())),!0}get objectId(){return this._objectId}get figureData(){return this._figureData}}class dW{flush(){return this._objectId=0,this._nameValidationStatus=0,this._nameValidationInfo=null,!0}parse(t){return this._objectId=t.readInt(),this._nameValidationStatus=t.readInt(),this._nameValidationInfo=t.readString(),!0}get objectId(){return this._objectId}get nameValidationStatus(){return this._nameValidationStatus}get nameValidationInfo(){return this._nameValidationInfo}}class _W{flush(){return this._roomIndex=-1,this._petId=-1,this._level=-1,!0}parse(t){return this._roomIndex=t.readInt(),this._petId=t.readInt(),this._level=t.readInt(),!0}get roomIndex(){return this._roomIndex}get petId(){return this._petId}get level(){return this._level}}class gW{flush(){return this._currentAge=-1,this._requiredAge=-1,!0}parse(t){return this._currentAge=t.readInt(),this._requiredAge=t.readInt(),!0}get currentAge(){return this._currentAge}get requiredAge(){return this._requiredAge}}class fW{flush(){return this._petId=-1,this._commands=[],this._enabledCommands=[],!0}parse(t){this._petId=t.readInt();let e=t.readInt();for(;e>0;)this._commands.push(t.readInt()),e--;let s=t.readInt();for(;s>0;)this._enabledCommands.push(t.readInt()),s--;return!0}get petId(){return this._petId}get commands(){return this._commands}get enabledCommands(){return this._enabledCommands}}class mW{constructor(t,e,s){this._value=t,this._choiceText=e,this._choiceType=s}get value(){return this._value}set value(t){this._value=t}get choiceText(){return this._choiceText}set choiceText(t){this._choiceText=t}get choiceType(){return this._choiceType}set choiceType(t){this._choiceType=t}}class EW{constructor(){this._children=[],this._questionChoices=[]}get questionId(){return this._questionId}set questionId(t){this._questionId=t}get questionType(){return this._questionType}set questionType(t){this._questionType=t}get sortOrder(){return this._sortOrder}set sortOrder(t){this._sortOrder=t}get questionText(){return this._questionText}set questionText(t){this._questionText=t}get questionCategory(){return this._questionCategory}set questionCategory(t){this._questionCategory=t}get questionAnswerType(){return this._questionAnswerType}set questionAnswerType(t){this._questionAnswerType=t}get questionAnswerCount(){return this._questionAnswerCount}set questionAnswerCount(t){this._questionAnswerCount=t}get children(){return this._children}set children(t){this._children=t}get questionChoices(){return this._questionChoices}set questionChoices(t){this._questionChoices=t}}class pW{constructor(){this._id=-1,this._startMessage="",this._endMessage="",this._numQuestions=0,this._questionArray=[],this._npsPoll=!1}flush(){return this._id=-1,this._startMessage="",this._endMessage="",this._numQuestions=0,this._questionArray=[],!0}parse(t){this._id=t.readInt(),this._startMessage=t.readString(),this._endMessage=t.readString(),this._numQuestions=t.readInt();for(let e=0;e<this._numQuestions;e++){const s=this.parsePollQuestion(t),i=t.readInt();for(let n=0;n<i;n++)s.children.push(this.parsePollQuestion(t));this._questionArray.push(s)}return this._npsPoll=t.readBoolean(),!0}parsePollQuestion(t){const e=new EW;if(e.questionId=t.readInt(),e.sortOrder=t.readInt(),e.questionType=t.readInt(),e.questionText=t.readString(),e.questionCategory=t.readInt(),e.questionAnswerType=t.readInt(),e.questionAnswerCount=t.readInt(),e.questionType==1||e.questionType==2)for(let s=0;s<e.questionAnswerCount;s++)e.questionChoices.push(new mW(t.readString(),t.readString(),t.readInt()));return e}get id(){return this._id}get startMessage(){return this._startMessage}get endMessage(){return this._endMessage}get numQuestions(){return this._numQuestions}get questionArray(){return this._questionArray}get npsPoll(){return this._npsPoll}}class IW{flush(){throw!0}parse(t){return!0}}class TW{constructor(){this._id=-1,this._type="",this._headline="",this._summary=""}flush(){return this._id=-1,this._type="",this._summary="",!0}parse(t){return this._id=t.readInt(),this._type=t.readString(),this._headline=t.readString(),this._summary=t.readString(),!0}get id(){return this._id}get type(){return this._type}get headline(){return this._headline}get summary(){return this._summary}}class RW{flush(){return this._userId=-1,this._value="",this._answerCounts=null,!0}parse(t){this._userId=t.readInt(),this._value=t.readString(),this._answerCounts=new Map;const e=t.readInt();for(let s=0;s<e;s++){const i=t.readString(),n=t.readInt();this._answerCounts.set(i,n)}return!0}get userId(){return this._userId}get value(){return this._value}get answerCounts(){return this._answerCounts}}class SW{flush(){return this._questionId=-1,this._answerCounts=null,!0}parse(t){this._questionId=t.readInt(),this._answerCounts=new Map;const e=t.readInt();for(let s=0;s<e;s++){const i=t.readString(),n=t.readInt();this._answerCounts.set(i,n)}return!0}get questionId(){return this._questionId}get answerCounts(){return this._answerCounts}}class OW{constructor(){this._pollType=null,this._pollId=-1,this._questionId=-1,this._duration=-1,this._question=null}flush(){return this._pollType=null,this._pollId=-1,this._questionId=-1,this._duration=-1,this._question=null,!0}parse(t){this._pollType=t.readString(),this._pollId=t.readInt(),this._questionId=t.readInt(),this._duration=t.readInt();const e=t.readInt(),s=t.readInt(),i=t.readInt(),n=t.readString();if(this._question={id:e,number:s,type:i,content:n},this._question.type==1||this._question.type==2){this._question.selection_min=t.readInt();const o=t.readInt();this._question.selections=[],this._question.selection_values=[],this._question.selection_count=o,this._question.selection_max=o;for(let l=0;l<o;l++)this._question.selection_values.push(t.readString()),this._question.selections.push(t.readString())}return!0}get pollType(){return this._pollType}get pollId(){return this._pollId}get questionId(){return this._questionId}get duration(){return this._duration}get question(){return this._question}}class CW{flush(){return this._question=null,this._choices=[],this._SafeStr_7651=[],this._SafeStr_7654=-1,!0}parse(t){this._question=t.readString(),this._choices=[],this._SafeStr_7651=[];let e=t.readInt();for(;e>0;)this._choices.push(t.readString()),this._SafeStr_7651.push(t.readInt()),e--;return this._SafeStr_7654=t.readInt(),!0}get question(){return this._question}get choices(){return this._choices}get SafeStr_7651(){return this._SafeStr_7651}get SafeStr_7654(){return this._SafeStr_7654}}class AW{flush(){return this._question=null,this._choices=[],!0}parse(t){this._question=t.readString(),this._choices=[];const e=t.readInt();let s=0;for(;s<e;)this._choices.push(t.readString()),s++;return!0}get question(){return this._question}get choices(){return this._choices.slice()}}class NW{constructor(t){this._rewardUserLimits=[],this._hasGoalExpired=t.readBoolean(),this._personalContributionScore=t.readInt(),this._personalContributionRank=t.readInt(),this._communityTotalScore=t.readInt(),this._communityHighestAchievedLevel=t.readInt(),this._scoreRemainingUntilNextLevel=t.readInt(),this._percentCompletionTowardsNextLevel=t.readInt(),this._goalCode=t.readString(),this._timeRemainingInSeconds=t.readInt();const e=t.readInt();for(let s=0;s<e;s++)this._rewardUserLimits.push(t.readInt())}dispose(){this._rewardUserLimits=null}get disposed(){return this._rewardUserLimits==null}get hasGoalExpired(){return this._hasGoalExpired}get personalContributionScore(){return this._personalContributionScore}get personalContributionRank(){return this._personalContributionRank}get communityTotalScore(){return this._communityTotalScore}get communityHighestAchievedLevel(){return this._communityHighestAchievedLevel}get scoreRemainingUntilNextLevel(){return this._scoreRemainingUntilNextLevel}get percentCompletionTowardsNextLevel(){return this._percentCompletionTowardsNextLevel}get timeRemainingInSeconds(){return this._timeRemainingInSeconds}get rewardUserLimits(){return this._rewardUserLimits}get goalCode(){return this._goalCode}}class xW{constructor(t){this._communityGoalId=t.readInt(),this._communityGoalCode=t.readString(),this._userRank=t.readInt(),this._rewardCode=t.readString(),this._badge=t.readBoolean(),this._localizedName=t.readString()}get communityGoalId(){return this._communityGoalId}get communityGoalCode(){return this._communityGoalCode}get userRank(){return this._userRank}get rewardCode(){return this._rewardCode}get badge(){return this._badge}get localizedName(){return this._localizedName}}class MW{flush(){return this._prizes=[],!0}parse(t){if(!t)return!1;const e=t.readInt();for(let s=0;s<e;s++)this._prizes.push(new xW(t));return!0}get prizes(){return this._prizes}}class yW{constructor(t){this._userId=t.readInt(),this._userName=t.readString(),this._figure=t.readString(),this._rank=t.readInt(),this._currentScore=t.readInt()}get userId(){return this._userId}get userName(){return this._userName}get figure(){return this._figure}get rank(){return this._rank}get currentScore(){return this._currentScore}}class DW{constructor(t){this._hof=[],this._goalCode=t.readString();const e=t.readInt();for(let s=0;s<e;s++)this._hof.push(new yW(t))}dispose(){this._hof=null}get disposed(){return this._hof==null}get hof(){return this._hof}get goalCode(){return this._goalCode}}class bW{flush(){return this._data=null,!0}parse(t){return t?(this._data=new DW(t),!0):!1}get data(){return this._data}}class vW{flush(){return this._data=null,!0}parse(t){return t?(this._data=new NW(t),!0):!1}get data(){return this._data}}class LW{flush(){return this._state=-1,this._userCount=-1,this._userCountGoal=-1,!0}parse(t){return t?(this._state=t.readInt(),this._userCount=t.readInt(),this._userCountGoal=t.readInt(),!0):!1}get state(){return this._state}get userCount(){return this._userCount}get userCountGoal(){return this._userCountGoal}}class PW{flush(){return this._imageUri="",!0}parse(t){return t?(this._imageUri=t.readString(),!0):!1}get imageUri(){return this._imageUri}}class UW{flush(){return!0}parse(t){return t?(this._expired=t.readBoolean(),!0):!1}get expired(){return this._expired}}class jc{constructor(t){this._receiveTime=new Date,this._campaignCode=t.readString(),this._completedQuestsInCampaign=t.readInt(),this._questCountInCampaign=t.readInt(),this._activityPointType=t.readInt(),this._id=t.readInt(),this._accepted=t.readBoolean(),this._type=t.readString(),this._imageVersion=t.readString(),this._rewardCurrencyAmount=t.readInt(),this._localizationCode=t.readString(),this._completedSteps=t.readInt(),this._totalSteps=t.readInt(),this._sortOrder=t.readInt(),this._catalogPageName=t.readString(),this._chainCode=t.readString(),this._easy=t.readBoolean()}static getCampaignLocalizationKeyForCode(t){return"quests."+t}get campaignCode(){return this._campaignCode}get localizationCode(){return this._localizationCode}get completedQuestsInCampaign(){return this._completedQuestsInCampaign}get questCountInCampaign(){return this._questCountInCampaign}get activityPointType(){return this._activityPointType}set accepted(t){this._accepted=t}get accepted(){return this._accepted}set id(t){this._id=t}get id(){return this._id}get type(){return this._type}get imageVersion(){return this._imageVersion}get rewardCurrencyAmount(){return this._rewardCurrencyAmount}get completedSteps(){return this._completedSteps}get totalSteps(){return this._totalSteps}get isCompleted(){return this._completedSteps==this._totalSteps}set waitPeriodSeconds(t){this._waitPeriodSeconds=t}get waitPeriodSeconds(){if(this._waitPeriodSeconds<1)return 0;const e=new Date().getTime()-this._receiveTime.getTime();return Math.max(0,this._waitPeriodSeconds-Math.floor(e/1e3))}getCampaignLocalizationKey(){return jc.getCampaignLocalizationKeyForCode(this.campaignCode)}getQuestLocalizationKey(){return this.getCampaignLocalizationKey()+"."+this._localizationCode}get completedCampaign(){return this._id<1}get lastQuestInCampaign(){return this._completedQuestsInCampaign>=this._questCountInCampaign}get receiveTime(){return this._receiveTime}get sortOrder(){return this._sortOrder}get catalogPageName(){return this._catalogPageName}get chainCode(){return this._chainCode}get easy(){return this._easy}}class jW{flush(){return this._questData=null,!0}parse(t){return t?(this._questData=new jc(t),this._showDialog=t.readBoolean(),!0):!1}get questData(){return this._questData}get showDialog(){return this._showDialog}}class wW{flush(){return this._quest=null,!0}parse(t){return t?(t.readBoolean()&&(this._quest=new jc(t),this._easyQuestCount=t.readInt(),this._hardQuestCount=t.readInt()),!0):!1}get quest(){return this._quest}get easyQuestCount(){return this._easyQuestCount}get hardQuestCount(){return this._hardQuestCount}}class FW{flush(){return this._quest=null,!0}parse(t){return t?(this._quest=new jc(t),!0):!1}get quest(){return this._quest}}class GW{flush(){return this._quests=[],!0}parse(t){if(!t)return!1;const e=t.readInt();for(let s=0;s<e;s++)this._quests.push(new jc(t));return this._openWindow=t.readBoolean(),!0}get quests(){return this._quests}get openWindow(){return this._openWindow}}class BW{flush(){return this._quests=[],!0}parse(t){if(!t)return!1;const e=t.readInt();for(let s=0;s<e;s++)this._quests.push(new jc(t));return!0}get quests(){return this._quests}}class kW{flush(){return this._recyclerFinishedStatus=-1,this._prizeId=0,!0}parse(t){return t?(this._recyclerFinishedStatus=t.readInt(),this._prizeId=t.readInt(),!0):!1}get recyclerFinishedStatus(){return this._recyclerFinishedStatus}get prizeId(){return this._prizeId}}class VW{flush(){return this._recyclerStatus=-1,this._recyclerTimeoutSeconds=0,!0}parse(t){return t?(this._recyclerStatus=t.readInt(),this._recyclerTimeoutSeconds=t.readInt(),!0):!1}get recyclerStatus(){return this._recyclerStatus}get recyclerTimeoutSeconds(){return this._recyclerTimeoutSeconds}}class OS{constructor(t){this._stuffIds=[],this._intParams=[],this._stuffTypeSelectionEnabled=t.readBoolean(),this._furniLimit=t.readInt();let e=t.readInt();for(;e>0;)this._stuffIds.push(t.readInt()),e--;for(this._stuffTypeId=t.readInt(),this._id=t.readInt(),this._stringParam=t.readString(),e=t.readInt();e>0;)this._intParams.push(t.readInt()),e--;this._stuffTypeSelectionCode=t.readInt()}getBoolean(t){return this._intParams[t]===1}get stuffTypeSelectionEnabled(){return this._stuffTypeSelectionEnabled}get stuffTypeSelectionCode(){return this._stuffTypeSelectionCode}set stuffTypeSelectionCode(t){this._stuffTypeSelectionCode=t}get maximumItemSelectionCount(){return this._furniLimit}get selectedItems(){return this._stuffIds}get id(){return this._id}get stringData(){return this._stringParam}get intData(){return this._intParams}get code(){return 0}get spriteId(){return this._stuffTypeId}}class CS extends OS{constructor(t){super(t),this._type=t.readInt()}get type(){return this._type}get code(){return this._type}}class AS extends OS{constructor(t){super(t),this._conflictingActions=[],this._triggerConf=t.readInt();let e=t.readInt();for(;e>0;)this._conflictingActions.push(t.readInt()),e--}get code(){return this._triggerConf}get conflictingActions(){return this._conflictingActions}}class NS extends OS{constructor(t){super(t),this._conflictingTriggers=[],this._type=t.readInt(),this._delayInPulses=t.readInt();let e=t.readInt();for(;e>0;)this._conflictingTriggers.push(t.readInt()),e--}get type(){return this._type}get code(){return this._type}get delayInPulses(){return this._delayInPulses}get conflictingTriggers(){return this._conflictingTriggers}}class HW{flush(){return this._definition=null,!0}parse(t){return t?(this._definition=new NS(t),!0):!1}get definition(){return this._definition}}class WW{flush(){return this._definition=null,!0}parse(t){return t?(this._definition=new CS(t),!0):!1}get definition(){return this._definition}}class YW{flush(){return this._definition=null,!0}parse(t){return t?(this._definition=new AS(t),!0):!1}get definition(){return this._definition}}class zW{flush(){return this._stuffId=0,!0}parse(t){return t?(this._stuffId=t.readInt(),!0):!1}get stuffId(){return this._stuffId}}class KW{flush(){return this._reason=0,!0}parse(t){return t?(this._reason=t.readInt(),!0):!1}get reason(){return this._reason}}class XW{flush(){return!0}parse(t){return!!t}}class qW{flush(){return this._info=null,!0}parse(t){return t?(this._info=t.readString(),!0):!1}get info(){return this._info}}class QW{flush(){return!0}parse(t){return!!t}}class JW{flush(){return!0}parse(t){return!0}}class $W{constructor(){this._songDisks=new hs}flush(){return this._songDisks.reset(),this._maxLength=0,!0}parse(t){this._maxLength=t.readInt();const e=t.readInt();for(let s=0;s<e;s++)this._songDisks.add(t.readInt(),t.readInt());return!0}get songDisks(){return this._songDisks}get maxLength(){return this._maxLength}}class ZW{flush(){return this._currentSongId=-1,this._currentPosition=-1,this._nextSongId=-1,this._nextPosition=-1,this._syncCount=-1,!0}parse(t){return this._currentSongId=t.readInt(),this._currentPosition=t.readInt(),this._nextSongId=t.readInt(),this._nextPosition=t.readInt(),this._syncCount=t.readInt(),!0}get currentSongId(){return this._currentSongId}get currentPosition(){return this._currentPosition}get nextSongId(){return this._nextSongId}get nextPosition(){return this._nextPosition}get syncCount(){return this._syncCount}}class tY{flush(){return this._songId=0,this._officialSongId="",!0}parse(t){return this._officialSongId=t.readString(),this._songId=t.readInt(),!0}get songId(){return this._songId}get officialSongId(){return this._officialSongId}}class JE{constructor(t,e,s,i){this._startPlayHead=0,this._id=t,this._length=e,this._name=s,this._creator=i}get id(){return this._id}get length(){return this._length}get name(){return this._name}get creator(){return this._creator}get startPlayHeadPos(){return this._startPlayHead}set startPlayHeadPos(t){this._startPlayHead=t}}class eY{flush(){return this._synchronizationCount=-1,this._playlist=[],!0}parse(t){this._synchronizationCount=t.readInt();const e=t.readInt();for(let s=0;s<e;s++)this._playlist.push(new JE(t.readInt(),t.readInt(),t.readString(),t.readString()));return!0}get synchronizationCount(){return this._synchronizationCount}get playList(){return this._playlist}}class sY{flush(){return this._entry=null,!0}parse(t){return this._entry=new JE(t.readInt(),t.readInt(),t.readString(),t.readString()),!0}get entry(){return this._entry}}class iY extends JE{constructor(t,e,s,i,n){super(t,e,s,i),this._data="",this._data=n}get data(){return this._data}}class rY{flush(){return this._songs=[],!0}parse(t){const e=t.readInt();for(let s=0;s<e;s++){const i=t.readInt();t.readString();const n=t.readString(),o=t.readString(),l=t.readInt(),c=t.readString(),u=new iY(i,l,n,c,o);this._songs.push(u)}return!0}get songs(){return this._songs}}class nY{constructor(){this._songDiskInventory=new hs}flush(){return this._songDiskInventory.reset(),!0}parse(t){const e=t.readInt();for(let s=0;s<e;s++)this._songDiskInventory.add(t.readInt(),t.readInt());return!0}getDiskId(t){return t>=0&&t<this._songDiskInventory.length?this._songDiskInventory.getKey(t):-1}getSongId(t){return t>=0&&t<this._songDiskInventory.length?this._songDiskInventory.getWithIndex(t):-1}get songDiskCount(){return this._songDiskInventory.length}}class aY{flush(){return this._talentTrackName=null,this._level=-1,this._rewardPerks=[],this._rewardProducts=[],!0}parse(t){if(!t)return!1;let e=0;this._talentTrackName=t.readString(),this._level=t.readInt();const s=t.readInt();for(;e<s;)this._rewardPerks.push(new hY(t)),e++;const i=t.readInt();if(e<i)for(let n=0;n<i;n++){const o=t.readString(),l=t.readInt();this._rewardProducts.push(new rx(o,l)),e++}return!0}get talentTrackName(){return this._talentTrackName}get level(){return this._level}get rewardPerks(){return this._rewardPerks}get rewardProducts(){return this._rewardProducts}}class oY{constructor(t,e,s,i,n){this._level=t,this._state=e,this._tasks=s,this._rewardPerks=i,this._rewardProducts=n}get level(){return this._level}get state(){return this._state}get tasks(){return this._tasks}get perks(){return this._rewardPerks}get items(){return this._rewardProducts}}class lY{flush(){return this._talentTrackName=null,this._level=-1,this._maxLevel=-1,!0}parse(t){return t?(this._talentTrackName=t.readString(),this._level=t.readInt(),this._maxLevel=t.readInt(),!0):!1}get talentTrackName(){return this._talentTrackName}get level(){return this._level}get maxLevel(){return this._maxLevel}}class rx{constructor(t,e){this._productCode=t,this._vipDays=e}get productCode(){return this._productCode}get vipDays(){return this._vipDays}}class cY{constructor(t,e,s,i,n,o){this._id=t,this._requiredLevel=e,this._badgeCode=s,this._state=i,this._currentScore=n,this._totalScore=o}get id(){return this._id}get requiredLevel(){return this._requiredLevel}get badgeCode(){return this._badgeCode}get state(){return this._state}get currentScore(){return this._currentScore}get totalScore(){return this._totalScore}}class uY{flush(){return this._type=null,this._levels=null,!0}parse(t){if(!t)return!1;this._type=t.readString(),this._levels=[];const e=t.readInt();for(let s=0;s<e;s++){const i=t.readInt(),n=t.readInt(),o=[],l=t.readInt();for(let g=0;g<l;g++){const E=t.readInt(),m=t.readInt(),I=t.readString(),p=t.readInt(),T=t.readInt(),R=t.readInt();o.push(new cY(E,m,I,p,T,R))}const c=[],u=t.readInt();for(let g=0;g<u;g++)c.push(t.readString());const h=[],d=t.readInt();for(let g=0;g<d;g++){const E=t.readString(),m=t.readInt();h.push(new rx(E,m))}this._levels.push(new oY(i,n,o,c,h))}return!0}get type(){return this._type}get levels(){return this._levels}}class hY{constructor(t){this._perkId=t.readInt()}get perkId(){return this._perkId}}class dY{flush(){return this._classifiedUsersNames&&(this._classifiedUsersNames=new Map),this._classifiedUsersClass&&(this._classifiedUsersClass=new Map),!0}parse(t){if(!t)return!1;let e,s,i,n=t.readInt();for(this._classifiedUsersNames=new Map,this._classifiedUsersClass=new Map;n>0;)e=t.readInt(),s=t.readString(),i=t.readString(),this._classifiedUsersNames.set(e,s),this._classifiedUsersClass.set(e,i),n--;return!0}get classifiedUsernameMap(){return this._classifiedUsersNames}get classifiedUserTypeMap(){return this._classifiedUsersClass}}class nx extends v{constructor(t){super(t,d1)}getParser(){return this.parser}}class ax extends v{constructor(t){super(t,l1)}getParser(){return this.parser}}class ox extends v{constructor(t){super(t,u1)}getParser(){return this.parser}}class lx extends v{constructor(t){super(t,h1)}getParser(){return this.parser}}class cx extends v{constructor(t){super(t,g1)}getParser(){return this.parser}}class _Y extends v{constructor(t){super(t,f1)}getParser(){return this.parser}}class gY extends v{constructor(t){super(t,m1)}getParser(){return this.parser}}class ux extends v{constructor(t){super(t,E1)}getParser(){return this.parser}}class fY extends v{constructor(t){super(t,p1)}getParser(){return this.parser}}class hx extends v{constructor(t){super(t,I1)}getParser(){return this.parser}}class dx extends v{constructor(t){super(t,T1)}getParser(){return this.parser}}class _x extends v{constructor(t){super(t,R1)}getParser(){return this.parser}}class gx extends v{constructor(t){super(t,S1)}getParser(){return this.parser}}const ia=class ia extends v{constructor(t){super(t,O1)}getParser(){return this.parser}};ia.NAME_OK=0,ia.ERROR_NAME_REQUIRED=1,ia.ERROR_NAME_TOO_SHORT=2,ia.ERROR_NAME_TOO_LONG=3,ia.ERROR_NAME_NOT_VALID=4,ia.ERROR_NAME_IN_USE=5,ia.ERROR_NAME_CHANGE_NOT_ALLOWED=6,ia.ERROR_MERGE_HOTEL_DOWN=7;let Jd=ia;class fx extends v{constructor(t){super(t,C1)}getParser(){return this.parser}}class xS extends v{constructor(t){super(t,A1)}getParser(){return this.parser}}class mY extends v{constructor(t){super(t,x1)}getParser(){return this.parser}}class mx extends v{constructor(t){super(t,M1)}getParser(){return this.parser}}class Ex extends v{constructor(t){super(t,y1)}getParser(){return this.parser}}class EY extends v{constructor(t){super(t,D1)}getParser(){return this.parser}}class px extends v{constructor(t){super(t,b1)}getParser(){return this.parser}}class Ix extends v{constructor(t){super(t,U1)}getParser(){return this.parser}}class Tx extends v{constructor(t){super(t,j1)}getParser(){return this.parser}}class Rx extends v{constructor(t){super(t,w1)}getParser(){return this.parser}}class Sx extends v{constructor(t){super(t,F1)}getParser(){return this.parser}}class Ox extends v{constructor(t){super(t,G1)}getParser(){return this.parser}}class pY extends v{constructor(t){super(t,B1)}getParser(){return this.parser}}class Cx extends v{constructor(t){super(t,k1)}getParser(){return this.parser}}class IY extends v{constructor(t){super(t,V1)}getParser(){return this.parser}}class Ax extends v{constructor(t){super(t,H1)}getParser(){return this.parser}}class TY extends v{constructor(t){super(t,W1)}getParser(){return this.parser}}class Nx extends v{constructor(t){super(t,Y1)}getParser(){return this.parser}}class xx extends v{constructor(t){super(t,z1)}getParser(){return this.parser}}class Mx extends v{constructor(t){super(t,K1)}getParser(){return this.parser}}class yx extends v{constructor(t){super(t,X1)}getParser(){return this.parser}}class Dx extends v{constructor(t){super(t,q1)}getParser(){return this.parser}}class RY extends v{constructor(t){super(t,J1)}getParser(){return this.parser}}class SY extends v{constructor(t){super(t,tF)}getParser(){return this.parser}}class bx extends v{constructor(t){super(t,eF)}getParser(){return this.parser}}class vx extends v{constructor(t){super(t,$1)}getParser(){return this.parser}}class OY extends v{constructor(t){super(t,sF)}getParser(){return this.parser}}class Lx extends v{constructor(t){super(t,iF)}getParser(){return this.parser}}class MS extends v{constructor(t){super(t,nF)}getParser(){return this.parser}}class Px extends v{constructor(t){super(t,aF)}getParser(){return this.parser}}class CY extends v{constructor(t){super(t,lF)}getParser(){return this.parser}}class AY extends v{constructor(t){super(t,uF)}getParser(){return this.parser}}class Ux extends v{constructor(t){super(t,hF)}getParser(){return this.parser}}class jx extends v{constructor(t){super(t,dF)}getParser(){return this.parser}}class NY extends v{constructor(t){super(t,_F)}getParser(){return this.parser}}class wx extends v{constructor(t){super(t,gF)}getParser(){return this.parser}}class xY extends v{constructor(t){super(t,fF)}getParser(){return this.parser}}class Fx extends v{constructor(t){super(t,mF)}getParser(){return this.parser}}class MY extends v{constructor(t){super(t,EF)}getParser(){return this.parser}}class yY extends v{constructor(t){super(t,pF)}getParser(){return this.parser}}class Gx extends v{constructor(t){super(t,IF)}getParser(){return this.parser}}class Bx extends v{constructor(t){super(t,TF)}getParser(){return this.parser}}class kx extends v{constructor(t){super(t,RF)}getParser(){return this.parser}}class Vx extends v{constructor(t){super(t,OF)}getParser(){return this.parser}}class Hx extends v{constructor(t){super(t,Rk)}getParser(){return this.parser}}class DY extends v{constructor(t){super(t,Sk)}getParser(){return this.parser}}class Wx extends v{constructor(t){super(t,Ck)}getParser(){return this.parser}}class Yx extends v{constructor(t){super(t,xk)}getParser(){return this.parser}}class bY extends v{constructor(t){super(t,Nk)}getParser(){return this.parser}}class zx extends v{constructor(t){super(t,Mk)}getParser(){return this.parser}}class Kx extends v{constructor(t){super(t,yk)}getParser(){return this.parser}}class Xx extends v{constructor(t){super(t,Dk)}getParser(){return this.parser}}class vY extends v{constructor(t){super(t,UI)}getParser(){return this.parser}}class LY extends v{constructor(t){super(t,bk)}getParser(){return this.parser}}class PY extends v{constructor(t){super(t,vk)}getParser(){return this.parser}}class UY extends v{constructor(t){super(t,Lk)}getParser(){return this.parser}}class jY extends v{constructor(t){super(t,Pk)}getParser(){return this.parser}}class wY extends v{constructor(t){super(t,Uk)}getParser(){return this.parser}}class qx extends v{constructor(t){super(t,jk)}getParser(){return this.parser}}class Qx extends v{constructor(t){super(t,Fk)}getParser(){return this.parser}}class Jx extends v{constructor(t){super(t,Gk)}getParser(){return this.parser}}class $x extends v{constructor(t){super(t,Bk)}getParser(){return this.parser}}class $d extends v{constructor(t){super(t,kk)}getParser(){return this.parser}}class FY extends v{constructor(t){super(t,Hk)}getParser(){return this.parser}}class GY extends v{constructor(t){super(t,Wk)}getParser(){return this.parser}}class BY extends v{constructor(t){super(t,Yk)}getParser(){return this.parser}}class Zx extends v{constructor(t){super(t,zk)}getParser(){return this.parser}}class tM extends v{constructor(t){super(t,Kk)}getParser(){return this.parser}}class kY extends v{constructor(t){super(t,Xk)}getParser(){return this.parser}}class eM extends v{constructor(t){super(t,qk)}getParser(){return this.parser}}class sM extends v{constructor(t){super(t,Qk)}getParser(){return this.parser}}class VY extends v{constructor(t){super(t,Jk)}getParser(){return this.parser}}class HY extends v{constructor(t){super(t,$k)}getParser(){return this.parser}}class iM extends v{constructor(t){super(t,Zk)}getParser(){return this.parser}}class WY extends v{constructor(t){super(t,tV)}getParser(){return this.parser}}class YY extends v{constructor(t){super(t,eV)}getParser(){return this.parser}}class yS extends v{constructor(t){super(t,sV)}getParser(){return this.parser}}class DS extends v{constructor(t){super(t,iV)}getParser(){return this.parser}}class rM extends v{constructor(t){super(t,rV)}getParser(){return this.parser}}class bS extends v{constructor(t){super(t,nV)}getParser(){return this.parser}}class nM extends v{constructor(t){super(t,aV)}getParser(){return this.parser}}class zY extends v{constructor(t){super(t,FI)}getParser(){return this.parser}}class KY extends v{constructor(t){super(t,oV)}getParser(){return this.parser}}class XY extends v{constructor(t){super(t,GI)}getParser(){return this.parser}}class qY extends v{constructor(t){super(t,BI)}getParser(){return this.parser}}class QY extends v{constructor(t){super(t,lV)}getParser(){return this.parser}}class JY extends v{constructor(t){super(t,cV)}getParser(){return this.parser}}class $Y extends v{constructor(t){super(t,uV)}getParser(){return this.parser}}class ZY extends v{constructor(t){super(t,hV)}getParser(){return this.parser}}class tz extends v{constructor(t){super(t,dV)}getParser(){return this.parser}}class ez extends v{constructor(t){super(t,gV)}getParser(){return this.parser}}class sz extends v{constructor(t){super(t,mV)}getParser(){return this.parser}}class aM extends v{constructor(t){super(t,EV)}getParser(){return this.parser}}class oM extends v{constructor(t){super(t,kI)}getParser(){return this.parser}}class iz extends v{constructor(t){super(t,pV)}getParser(){return this.parser}}class rz extends v{constructor(t){super(t,VI)}getParser(){return this.parser}}class nz extends v{constructor(t){super(t,IV)}getParser(){return this.parser}}class az extends v{constructor(t){super(t,TV)}getParser(){return this.parser}}class vS extends v{constructor(t){super(t,RV)}getParser(){return this.parser}}class oz extends v{constructor(t){super(t,SV)}getParser(){return this.parser}}class lz extends v{constructor(t){super(t,OV)}getParser(){return this.parser}}class cz extends v{constructor(t){super(t,QE)}getParser(){return this.parser}}class uz extends v{constructor(t){super(t,QE)}getParser(){return this.parser}}class hz extends v{constructor(t){super(t,QE)}getParser(){return this.parser}}class dz extends v{constructor(t){super(t,QE)}getParser(){return this.parser}}class _z extends v{constructor(t){super(t,AV)}getParser(){return this.parser}}class gz extends v{constructor(t){super(t,NV)}getParser(){return this.parser}}class Hg extends v{constructor(t){super(t,xV)}getParser(){return this.parser}}class fz extends v{constructor(t){super(t,MV)}getParser(){return this.parser}}class mz extends v{constructor(t){super(t,yV)}getParser(){return this.parser}}class Ez extends v{constructor(t){super(t,DV)}getParser(){return this.parser}}class LS extends v{constructor(t){super(t,bV)}getParser(){return this.parser}}class lM extends v{constructor(t){super(t,vV)}getParser(){return this.parser}}class cM extends v{constructor(t){super(t,LV)}getParser(){return this.parser}}class ph extends v{constructor(t){super(t,PV)}getParser(){return this.parser}}class uM extends v{constructor(t){super(t,wV)}getParser(){return this.parser}}class hM extends v{constructor(t){super(t,FV)}getParser(){return this.parser}}class dM extends v{constructor(t){super(t,GV)}getParser(){return this.parser}}class _M extends v{constructor(t){super(t,BV)}getParser(){return this.parser}}class pz extends v{constructor(t){super(t,kV)}getParser(){return this.parser}}class Iz extends v{constructor(t){super(t,VV)}getParser(){return this.parser}}class Tz extends v{constructor(t){super(t,HV)}getParser(){return this.parser}}class Rz extends v{constructor(t){super(t,WV)}getParser(){return this.parser}}class Sz extends v{constructor(t){super(t,YV)}getParser(){return this.parser}}class Oz extends v{constructor(t){super(t,zV)}getParser(){return this.parser}}class Cz extends v{constructor(t){super(t,KV)}getParser(){return this.parser}}class Az extends v{constructor(t){super(t,XV)}getParser(){return this.parser}}class Nz extends v{constructor(t){super(t,qV)}getParser(){return this.parser}}class xz extends v{constructor(t){super(t,QV)}getParser(){return this.parser}}const qt=class qt{};qt.LOGOUT=0,qt.JUST_BANNED=1,qt.CONCURRENT_LOGIN=2,qt.CONNECTION_LOST_TO_PEER=3,qt.AVATAR_IDENTITY_CHANGE=4,qt.REMOVE_FURNITURE_TOOL=5,qt.STILL_BANNED=10,qt.DUAL_LOGIN_BY_USERID=11,qt.HOTEL_CLOSED=12,qt.DUAL_LOGIN_BY_IP=13,qt.PEER_CONNECTION_MISSING=16,qt.NO_LOGIN_PERMISSION=17,qt.DUPLICATE_CONNECTION=18,qt.HOTEL_CLOSING=19,qt.INCORRECT_PASSWORD=20,qt.INVALID_LOGIN_TICKET=22,qt.VERSION_CHECK_URL=23,qt.VERSION_CHECK_PROPERTY=24,qt.VERSION_CHECK_MACHINE_ID=25,qt.NO_MESSENGER_SESSION=26,qt.USER_NOT_FOUND=27,qt.CRYPTO_NOT_INITIALIZED=28,qt.DEV_CRYPTO_NOT_ALLOWED=29,qt.DUPLICATE_UUID_DETECTED=100,qt.OLD_SESSION_IN_PROXY=101,qt.PUBLIC_KEY_NOT_NUMERIC=102,qt.PUBLIC_KEY_TOO_SHORT=103,qt.SOCKET_READ_GENERIC=104,qt.SOCKET_READ_FIRST_BYTE=105,qt.SOCKET_READ_LENGTH=106,qt.SOCKET_READ_BODY=107,qt.SOCKET_READ_POLICY=108,qt.SOCKET_IO_EXCEPTION=109,qt.SOCKET_WRONG_CRYPTO=110,qt.PROXY_RUNTIME_EXCEPTION=111,qt.IDLE_CONNECTION=112,qt.PONG_TIMEOUT=113,qt.IDLE_CONNECTION_NOT_AUTH=114,qt.IDLE_CONNECTION_NO_USER_ID=115,qt.WRITE_CLOSED_CHANNEL=116,qt.SOCKET_WRITE_EXCEPTION_1=117,qt.SOCKET_WRITE_EXCEPTION_2=118,qt.SOCKET_WRITE_EXCEPTION_3=119;let Zc=qt;class Mz extends v{constructor(t){super(t,JV)}getParser(){return this.parser}get reasonString(){switch(this.getParser().reason){case Zc.JUST_BANNED:case Zc.STILL_BANNED:return"banned";case Zc.CONCURRENT_LOGIN:return"concurrentlogin";case Zc.INCORRECT_PASSWORD:return"incorrectpassword";default:return"logout"}}}class yz extends v{constructor(t){super(t,$V)}getParser(){return this.parser}}class Dz extends v{constructor(t){super(t,ZV)}getParser(){return this.parser}}class gM extends v{constructor(t){super(t,t2)}getParser(){return this.parser}}class fM extends v{constructor(t){super(t,e2)}getParser(){return this.parser}}class mM extends v{constructor(t){super(t,s2)}getParser(){return this.parser}}class EM extends v{constructor(t){super(t,i2)}getParser(){return this.parser}}class pM extends v{constructor(t){super(t,r2)}getParser(){return this.parser}}class IM extends v{constructor(t){super(t,n2)}getParser(){return this.parser}}class bz extends v{constructor(t){super(t,a2)}getParser(){return this.parser}}class vz extends v{constructor(t){super(t,o2)}getParser(){return this.parser}}class Lz extends v{constructor(t){super(t,l2)}getParser(){return this.parser}}class Pz extends v{constructor(t){super(t,c2)}getParser(){return this.parser}}class Uz extends v{constructor(t){super(t,HI)}getParser(){return this.parser}}class TM extends v{constructor(t){super(t,u2)}getParser(){return this.parser}}class jz extends v{constructor(t){super(t,WI)}getParser(){return this.parser}}class RM extends v{constructor(t){super(t,d2)}getParser(){return this.parser}}class SM extends v{constructor(t){super(t,_2)}getParser(){return this.parser}}class PS extends v{constructor(t){super(t,g2)}getParser(){return this.parser}}class US extends v{constructor(t){super(t,YI)}getParser(){return this.parser}}class OM extends v{constructor(t){super(t,f2)}getParser(){return this.parser}}class CM extends v{constructor(t){super(t,m2)}getParser(){return this.parser}}class AM extends v{constructor(t){super(t,E2)}getParser(){return this.parser}}class NM extends v{constructor(t){super(t,p2)}getParser(){return this.parser}}class jS extends v{constructor(t){super(t,I2)}getParser(){return this.parser}}class wz extends v{constructor(t){super(t,zI)}getParser(){return this.parser}}class Fz extends v{constructor(t){super(t,KI)}getParser(){return this.parser}}class Gz extends v{constructor(t){super(t,T2)}getParser(){return this.parser}}class xM extends v{constructor(t){super(t,R2)}getParser(){return this.parser}}class Bz extends v{constructor(t){super(t,S2)}getParser(){return this.parser}}class kz extends v{constructor(t){super(t,O2)}getParser(){return this.parser}}const x=class x{};x.BOBBA_TABLE_ALERT=4009,x.BOBBA_CHECK_VIP=4001,x.BOBBA_SOUND_CATEGORIES=4006,x.BOBBA_SOUND_LIST=4007,x.BOBBA_PLAY_SOUND=4008,x.BOBBA_LANGUAGES=4010,x.ACHIEVEMENT_LIST=305,x.AUTHENTICATED=2491,x.AUTHENTICATION=-1,x.AVAILABILITY_STATUS=2033,x.BUILDERS_CLUB_EXPIRED=1452,x.CLUB_OFFERS=2405,x.CATALOG_PAGE=804,x.CATALOG_PAGE_LIST=1032,x.CATALOG_PURCHASE_OK=869,x.CATALOG_PURCHASE_ERROR=1404,x.CATALOG_PURCHASE_NOT_ALLOWED=3770,x.PRODUCT_OFFER=3388,x.LIMITED_SOLD_OUT=377,x.CATALOG_PUBLISHED=1866,x.CFH_RESULT_MESSAGE=3635,x.CLIENT_LATENCY=10,x.CLIENT_PING=3928,x.DESKTOP_CAMPAIGN=1745,x.DESKTOP_NEWS=286,x.DESKTOP_VIEW=122,x.BUNDLE_DISCOUNT_RULESET=2347,x.FIRST_LOGIN_OF_DAY=793,x.FURNITURE_ALIASES=1723,x.FURNITURE_DATA=2547,x.FURNITURE_FLOOR=1778,x.FURNITURE_FLOOR_ADD=1534,x.FURNITURE_FLOOR_REMOVE=2703,x.FURNITURE_FLOOR_UPDATE=3776,x.FURNITURE_ITEMDATA=2202,x.FURNITURE_STATE=2376,x.FURNITURE_GROUP_CONTEXT_MENU_INFO=3293,x.FURNITURE_POSTIT_STICKY_POLE_OPEN=2366,x.GAME_CENTER_ACHIEVEMENTS=2265,x.GAME_CENTER_GAME_LIST=222,x.GAME_CENTER_STATUS=2893,x.GAME_CENTER_IN_ARENA_QUEUE=872,x.GAME_CENTER_STOP_COUNTER=3191,x.GAME_CENTER_USER_LEFT_GAME=3138,x.GAME_CENTER_DIRECTORY_STATUS=2246,x.GAME_CENTER_STARTING_GAME_FAILED=2142,x.GAME_CENTER_JOINING_FAILED=1730,x.GAMESTATUSMESSAGE=3805,x.GAMEACHIEVEMENTS=1689,x.GAMEINVITE=904,x.JOININGQUEUEFAILED=3035,x.JOINEDQUEUEMESSAGE=2260,x.LEFTQUEUE=1477,x.LOAD_GAME_URL=2624,x.LOADGAME=3654,x.UNLOADGAME=1715,x.ACHIEVEMENTRESOLUTIONCOMPLETED=740,x.ACHIEVEMENTRESOLUTIONPROGRESS=3370,x.ACHIEVEMENTRESOLUTIONS=66,x.GENERIC_ALERT=3801,x.MODERATOR_MESSAGE=2030,x.GENERIC_ERROR=1600,x.GIFT_WRAPPER_CONFIG=2234,x.GROUP_BADGES=2402,x.GROUP_CREATE_OPTIONS=2159,x.GROUP_FORUM_DATA=3011,x.GROUP_FORUM_LIST=3001,x.GROUP_FORUM_THREADS=1073,x.GROUP_FORUM_POST=2049,x.GROUP_FORUM_POST_THREAD=1862,x.GROUP_FORUM_THREAD_MESSAGES=509,x.GROUP_FORUM_UNREAD_COUNT=2379,x.GROUP_FORUM_UPDATE_MESSAGE=324,x.GROUP_FORUM_UPDATE_THREAD=2528,x.GROUP_INFO=1702,x.GROUP_LIST=420,x.GROUP_MEMBER=265,x.GROUP_MEMBERS=1200,x.GROUP_MEMBERS_REFRESH=2445,x.GROUP_MEMBER_REMOVE_CONFIRM=1876,x.GROUP_PURCHASED=2808,x.GROUP_SETTINGS=3965,x.GROUP_BADGE_PARTS=2238,x.GROUP_MEMBERSHIP_REQUESTED=1180,x.GROUP_DETAILS_CHANGED=1459,x.GROUP_HABBO_JOIN_FAILED=762,x.GUILD_EDIT_FAILED=3988,x.GUILD_MEMBER_MGMT_FAILED=818,x.ITEM_DIMMER_SETTINGS=2710,x.ITEM_STACK_HELPER=2816,x.ITEM_WALL=1369,x.ITEM_WALL_ADD=2187,x.ITEM_WALL_REMOVE=3208,x.ITEM_WALL_UPDATE=2009,x.MARKETPLACE_CONFIG=1823,x.MESSENGER_ACCEPT_FRIENDS=896,x.MESSENGER_CHAT=1587,x.MESSENGER_FIND_FRIENDS=1210,x.MESSENGER_FOLLOW_FAILED=3048,x.MESSENGER_FRIEND_NOTIFICATION=3082,x.MESSENGER_FRIENDS=3130,x.MESSENGER_INIT=1605,x.MESSENGER_INSTANCE_MESSAGE_ERROR=3359,x.MESSENGER_INVITE=3870,x.MESSENGER_INVITE_ERROR=462,x.MESSENGER_MESSAGE_ERROR=892,x.MESSENGER_MINIMAIL_COUNT=2803,x.MESSENGER_MINIMAIL_NEW=1911,x.MESSENGER_RELATIONSHIPS=2016,x.MESSENGER_REQUEST=2219,x.MESSENGER_REQUEST_ERROR=892,x.MESSENGER_REQUESTS=280,x.MESSENGER_SEARCH=973,x.MESSENGER_UPDATE=2800,x.MODERATION_REPORT_DISABLED=1651,x.MODERATION_TOOL=2696,x.MODERATION_USER_INFO=2866,x.MOTD_MESSAGES=2035,x.NAVIGATOR_CATEGORIES=1562,x.NAVIGATOR_COLLAPSED=1543,x.NAVIGATOR_EVENT_CATEGORIES=3244,x.NAVIGATOR_LIFTED=3104,x.NAVIGATOR_METADATA=3052,x.NAVIGATOR_OPEN_ROOM_CREATOR=2064,x.NAVIGATOR_SEARCH=2690,x.NAVIGATOR_SEARCHES=3984,x.NAVIGATOR_SETTINGS=518,x.THUMBNAIL_UPDATE_RESULT=1927,x.CAN_CREATE_ROOM=378,x.CATEGORIES_WITH_VISITOR_COUNT=1455,x.COMPETITION_ROOMS_DATA=3954,x.CONVERTED_ROOM_ID=1331,x.GUEST_ROOM_SEARCH_RESULT=52,x.NOTIFICATION_LIST=1992,x.NOTIFICATION_OFFER_REWARD_DELIVERED=2125,x.NOTIFICATION_SIMPLE_ALERT=5100,x.NOTIFICATION_ELEMENT_POINTER=1787,x.PET_FIGURE_UPDATE=1924,x.PET_INFO=2901,x.PET_TRAINING_PANEL=1164,x.PET_LEVEL_UPDATE=2824,x.PET_SCRATCH_FAILED=1130,x.PET_OPEN_PACKAGE_REQUESTED=2380,x.PET_OPEN_PACKAGE_RESULT=546,x.PET_BREEDING=1746,x.PET_CONFIRM_BREEDING_RESULT=1625,x.PET_GO_TO_BREEDING_NEST_FAILURE=2621,x.PET_NEST_BREEDING_SUCCESS=2527,x.PET_CONFIRM_BREEDING_REQUEST=634,x.PET_BREEDING_RESULT=1553,x.RECYCLER_PRIZES=3164,x.RECYCLER_STATUS=3433,x.RECYCLER_FINISHED=468,x.ROOM_BAN_LIST=1869,x.ROOM_BAN_REMOVE=3429,x.ROOM_CREATED=1304,x.ROOM_DOORBELL=2309,x.ROOM_DOORBELL_ACCEPTED=3783,x.ROOM_DOORBELL_REJECTED=878,x.ROOM_ENTER=758,x.ROOM_ENTER_ERROR=899,x.ROOM_FORWARD=160,x.ROOM_HEIGHT_MAP=2753,x.ROOM_HEIGHT_MAP_UPDATE=558,x.ROOM_INFO=687,x.ROOM_INFO_OWNER=749,x.ROOM_MODEL=1301,x.ROOM_MODEL_BLOCKED_TILES=3990,x.ROOM_MODEL_DOOR=1664,x.ROOM_MODEL_NAME=2031,x.ROOM_MUTED=2533,x.ROOM_MUTE_USER=826,x.ROOM_PAINT=2454,x.ROOM_PROMOTION=2274,x.ROOM_QUEUE_STATUS=2208,x.ROOM_RIGHTS=780,x.ROOM_RIGHTS_CLEAR=2392,x.ROOM_RIGHTS_LIST=1284,x.ROOM_RIGHTS_LIST_ADD=2088,x.ROOM_RIGHTS_LIST_REMOVE=1327,x.ROOM_RIGHTS_OWNER=339,x.ROOM_ROLLING=3207,x.ROOM_SCORE=482,x.ROOM_SETTINGS=1498,x.ROOM_SETTINGS_CHAT=1191,x.ROOM_SETTINGS_SAVE=948,x.ROOM_SETTINGS_SAVE_ERROR=1555,x.ROOM_INFO_UPDATED=3297,x.ROOM_SPECTATOR=1033,x.ROOM_THICKNESS=3547,x.ROOM_GET_FILTER_WORDS=2937,x.ROOM_MESSAGE_NOTIFICATION=1634,x.ROOM_POPULAR_TAGS_RESULT=2012,x.INFO_FEED_ENABLE=3284,x.SECURITY_MACHINE=1488,x.MYSTERY_BOX_KEYS=2833,x.GOTMYSTERYBOXPRIZEMESSAGE=3712,x.CANCELMYSTERYBOXWAITMESSAGE=596,x.SHOWMYSTERYBOXWAITMESSAGE=3201,x.TRADE_ACCEPTED=2568,x.TRADE_CLOSED=1373,x.TRADE_COMPLETED=1001,x.TRADE_CONFIRMATION=2720,x.TRADE_LIST_ITEM=2024,x.TRADE_NOT_OPEN=3128,x.TRADE_OPEN=2505,x.TRADE_OPEN_FAILED=217,x.TRADE_OTHER_NOT_ALLOWED=1254,x.TRADE_YOU_NOT_ALLOWED=3058,x.TRADE_NO_SUCH_ITEM=2873,x.UNIT=374,x.UNIT_CHANGE_NAME=2182,x.UNIT_CHAT=1446,x.UNIT_CHAT_SHOUT=1036,x.UNIT_CHAT_WHISPER=2704,x.UNIT_DANCE=2233,x.UNIT_EFFECT=1167,x.UNIT_EXPRESSION=1631,x.UNIT_HAND_ITEM=1474,x.UNIT_IDLE=1797,x.UNIT_INFO=3920,x.UNIT_NUMBER=2324,x.UNIT_REMOVE=2661,x.UNIT_STATUS=1640,x.UNIT_TYPING=1717,x.UNSEEN_ITEMS=2103,x.USER_ACHIEVEMENT_SCORE=1968,x.USER_BADGES=717,x.USER_BADGES_ADD=2493,x.USER_BADGES_CURRENT=1087,x.USER_BOT_REMOVE=233,x.USER_BOTS=3086,x.USER_CHANGE_NAME=118,x.USER_CLOTHING=1450,x.USER_CREDITS=3475,x.USER_CURRENCY=2018,x.ACTIVITY_POINT_NOTIFICATION=2275,x.USER_EFFECTS=340,x.USER_FAVORITE_ROOM=2524,x.USER_FAVORITE_ROOM_COUNT=151,x.USER_FIGURE=2429,x.USER_FURNITURE=994,x.USER_FURNITURE_ADD=104,x.USER_FURNITURE_POSTIT_PLACED=1501,x.USER_FURNITURE_REFRESH=3151,x.USER_FURNITURE_REMOVE=159,x.USER_HOME_ROOM=2875,x.ROOM_EVENT_CANCEL=3479,x.ROOM_EVENT=1840,x.USER_IGNORED=126,x.USER_IGNORED_RESULT=207,x.USER_INFO=2725,x.USER_OUTFITS=3315,x.USER_PERKS=2586,x.USER_PERMISSIONS=411,x.USER_PET_ADD=2101,x.USER_PET_REMOVE=3253,x.USER_PETS=3522,x.USER_PROFILE=3898,x.USER_RESPECT=2815,x.USER_SANCTION_STATUS=3679,x.USER_SETTINGS=513,x.USER_SUBSCRIPTION=954,x.USER_WARDROBE_PAGE=3315,x.USER_CLASSIFICATION=966,x.GET_USER_TAGS=1255,x.WIRED_ACTION=1434,x.WIRED_CONDITION=1108,x.WIRED_ERROR=156,x.WIRED_OPEN=1830,x.WIRED_REWARD=178,x.WIRED_SAVE=1155,x.WIRED_TRIGGER=383,x.PLAYING_GAME=448,x.FURNITURE_STATE_2=3431,x.REMOVE_BOT_FROM_INVENTORY=233,x.ADD_BOT_TO_INVENTORY=1352,x.ACHIEVEMENT_PROGRESSED=2107,x.MODTOOL_ROOM_INFO=1333,x.MODTOOL_USER_CHATLOG=3377,x.MODTOOL_ROOM_CHATLOG=3434,x.MODTOOL_VISITED_ROOMS_USER=1752,x.MODERATOR_ACTION_RESULT=2335,x.ISSUE_DELETED=3192,x.ISSUE_INFO=3609,x.ISSUE_PICK_FAILED=3150,x.CFH_CHATLOG=607,x.MODERATOR_TOOL_PREFERENCES=1576,x.LOVELOCK_FURNI_START=3753,x.LOVELOCK_FURNI_FRIEND_COMFIRMED=382,x.LOVELOCK_FURNI_FINISHED=770,x.GIFT_RECEIVER_NOT_FOUND=1517,x.GIFT_OPENED=56,x.FLOOD_CONTROL=566,x.REMAINING_MUTE=826,x.USER_EFFECT_LIST=340,x.USER_EFFECT_LIST_ADD=2867,x.USER_EFFECT_LIST_REMOVE=2228,x.USER_EFFECT_ACTIVATE=1959,x.AVATAR_EFFECT_SELECTED=3473,x.CLUB_GIFT_INFO=619,x.REDEEM_VOUCHER_ERROR=714,x.REDEEM_VOUCHER_OK=3336,x.IN_CLIENT_LINK=2023,x.BOT_COMMAND_CONFIGURATION=1618,x.BOT_SKILL_LIST_UPDATE=69,x.BOT_FORCE_OPEN_CONTEXT_MENU=296,x.HAND_ITEM_RECEIVED=354,x.PET_PLACING_ERROR=2913,x.BOT_ERROR=639,x.MARKETPLACE_SELL_ITEM=54,x.MARKETPLACE_ITEM_STATS=725,x.MARKETPLACE_OWN_ITEMS=3884,x.MARKETPLACE_CANCEL_SALE=3264,x.MARKETPLACE_ITEM_POSTED=1359,x.MARKETPLACE_ITEMS_SEARCHED=680,x.MARKETPLACE_AFTER_ORDER_STATUS=2032,x.CATALOG_RECEIVE_PET_BREEDS=3331,x.CATALOG_APPROVE_NAME_RESULT=1503,x.OBJECTS_DATA_UPDATE=1453,x.PET_EXPERIENCE=2156,x.COMMUNITY_GOAL_VOTE_EVENT=1435,x.PROMO_ARTICLES=286,x.COMMUNITY_GOAL_EARNED_PRIZES=3319,x.COMMUNITY_GOAL_PROGRESS=2525,x.CONCURRENT_USERS_GOAL_PROGRESS=2737,x.QUEST_DAILY=1878,x.QUEST_CANCELLED=3027,x.QUEST_COMPLETED=949,x.COMMUNITY_GOAL_HALL_OF_FAME=3005,x.EPIC_POPUP=3945,x.SEASONAL_QUESTS=1122,x.QUESTS=3625,x.QUEST=230,x.BONUS_RARE_INFO=1533,x.CRAFTABLE_PRODUCTS=1e3,x.CRAFTING_RECIPE=2774,x.CRAFTING_RECIPES_AVAILABLE=2124,x.CRAFTING_RESULT=618,x.CAMERA_PUBLISH_STATUS=2057,x.CAMERA_PURCHASE_OK=2783,x.CAMERA_STORAGE_URL=3696,x.CAMERA_SNAPSHOT=463,x.COMPETITION_STATUS=133,x.INIT_CAMERA=3878,x.THUMBNAIL_STATUS=3595,x.ACHIEVEMENT_NOTIFICATION=806,x.CLUB_GIFT_NOTIFICATION=2188,x.INTERSTITIAL_MESSAGE=1808,x.ROOM_AD_ERROR=1759,x.AVAILABILITY_TIME=600,x.HOTEL_CLOSED_AND_OPENS=3728,x.HOTEL_CLOSES_AND_OPENS_AT=2771,x.HOTEL_WILL_CLOSE_MINUTES=1050,x.HOTEL_MAINTENANCE=1350,x.JUKEBOX_PLAYLIST_FULL=105,x.JUKEBOX_SONG_DISKS=34,x.NOW_PLAYING=469,x.OFFICIAL_SONG_ID=1381,x.PLAYLIST=1748,x.PLAYLIST_SONG_ADDED=1140,x.TRAX_SONG_INFO=3365,x.USER_SONG_DISKS_INVENTORY=2602,x.CHECK_USER_NAME=563,x.CFH_SANCTION=2782,x.CFH_TOPICS=325,x.CFH_SANCTION_STATUS=2221,x.CAMPAIGN_CALENDAR_DATA=2531,x.CAMPAIGN_CALENDAR_DOOR_OPENED=2551,x.BUILDERS_CLUB_FURNI_COUNT=3828,x.BUILDERS_CLUB_SUBSCRIPTION=1452,x.CATALOG_PAGE_EXPIRATION=2668,x.CATALOG_EARLIEST_EXPIRY=2515,x.CLUB_GIFT_SELECTED=659,x.TARGET_OFFER_NOT_FOUND=1237,x.TARGET_OFFER=119,x.DIRECT_SMS_CLUB_BUY=195,x.ROOM_AD_PURCHASE=2468,x.NOT_ENOUGH_BALANCE=3914,x.LIMITED_OFFER_APPEARING_NEXT=44,x.IS_OFFER_GIFTABLE=761,x.CLUB_EXTENDED_OFFER=3964,x.SEASONAL_CALENDAR_OFFER=1889,x.COMPETITION_ENTRY_SUBMIT=1177,x.COMPETITION_VOTING_INFO=3506,x.COMPETITION_TIMING_CODE=1745,x.COMPETITION_USER_PART_OF=3841,x.COMPETITION_NO_OWNED_ROOMS=2064,x.COMPETITION_SECONDS_UNTIL=3926,x.BADGE_POINT_LIMITS=2501,x.BADGE_REQUEST_FULFILLED=2998,x.HELPER_TALENT_TRACK=3406,x.TALENT_TRACK_LEVEL=1203,x.TALENT_TRACK_LEVEL_UP=638,x.USER_BANNED=1683,x.BOT_RECEIVED=3684,x.PET_LEVEL_NOTIFICATION=859,x.PET_RECEIVED=1111,x.MODERATION_CAUTION=1890,x.YOUTUBE_CONTROL_VIDEO=1554,x.YOUTUBE_DISPLAY_PLAYLISTS=1112,x.YOUTUBE_DISPLAY_VIDEO=1411,x.CFH_DISABLED_NOTIFY=1651,x.QUESTION=2665,x.POLL_CONTENTS=2997,x.POLL_ERROR=662,x.POLL_OFFER=3785,x.POLL_ROOM_RESULT=5201,x.POLL_START_ROOM=5200,x.QUESTION_ANSWERED=2589,x.QUESTION_FINISHED=1066,x.CFH_PENDING_CALLS=1121,x.GUIDE_ON_DUTY_STATUS=1548,x.GUIDE_SESSION_ATTACHED=1591,x.GUIDE_SESSION_DETACHED=138,x.GUIDE_SESSION_ENDED=1456,x.GUIDE_SESSION_ERROR=673,x.GUIDE_SESSION_INVITED_TO_GUIDE_ROOM=219,x.GUIDE_SESSION_MESSAGE=841,x.GUIDE_SESSION_PARTNER_IS_TYPING=1016,x.GUIDE_SESSION_REQUESTER_ROOM=1847,x.GUIDE_SESSION_STARTED=3209,x.GUIDE_TICKET_CREATION_RESULT=3285,x.GUIDE_TICKET_RESOLUTION=2674,x.GUIDE_REPORTING_STATUS=3463,x.HOTEL_MERGE_NAME_CHANGE=1663,x.ISSUE_CLOSE_NOTIFICATION=934,x.QUIZ_DATA=2927,x.QUIZ_RESULTS=2772,x.CFH_PENDING_CALLS_DELETED=77,x.CFH_REPLY=3796,x.CHAT_REVIEW_SESSION_DETACHED=30,x.CHAT_REVIEW_SESSION_OFFERED_TO_GUIDE=735,x.CHAT_REVIEW_SESSION_RESULTS=3276,x.CHAT_REVIEW_SESSION_STARTED=143,x.CHAT_REVIEW_SESSION_VOTING_STATUS=1829,x.SCR_SEND_KICKBACK_INFO=3277,x.PET_STATUS=1907,x.GROUP_DEACTIVATE=3129,x.PET_RESPECTED=2788,x.PET_SUPPLEMENT=3441,x.NOOBNESS_LEVEL=3738,x.DISCONNECT_REASON=4e3,x.CAN_CREATE_ROOM_EVENT=2599,x.FAVORITE_GROUP_UDPATE=3403,x.NO_SUCH_FLAT=84,x.ROOM_SETTINGS_ERROR=2897,x.SHOW_ENFORCE_ROOM_CATEGORY=3896,x.CUSTOM_USER_NOTIFICATION=909,x.NEW_USER_EXPERIENCE_GIFT_OFFER=3575,x.RESTORE_CLIENT=426,x.FIREWORK_CHARGE_DATA=5210,x.NEW_USER_EXPERIENCE_NOT_COMPLETE=3639,x.CONNECTION_ERROR=1004,x.ACCOUNT_SAFETY_LOCK_STATUS_CHANGE=1243,x.PHONE_COLLECTION_STATE=2890,x.PHONE_TRY_NUMBER_RESULT=800,x.PHONE_TRY_VERIFICATION_CODE_RESULT=91,x.EXTENDED_PROFILE_CHANGED=876,x.WELCOME_GIFT_CHANGE_EMAIL_RESULT=2293,x.WELCOME_GIFT_STATUS=2707,x.HANDSHAKE_INIT_DIFFIE=1347,x.HANDSHAKE_COMPLETE_DIFFIE=3885,x.RENTABLE_SPACE_RENT_OK=2046,x.RENTABLE_SPACE_STATUS=3559,x.RENTABLE_SPACE_RENT_FAILED=1868,x.EMAIL_STATUS=612,x.CHANGE_EMAIL_RESULT=1815,x.WEEKLY_GAME_REWARD=2641,x.WEEKLY_GAME_REWARD_WINNERS=3097,x.WEEKLY_COMPETITIVE_LEADERBOARD=3512,x.WEEKLY_COMPETITIVE_FRIENDS_LEADERBOARD=3560,x.WEEKLY_GAME2_FRIENDS_LEADERBOARD=2270,x.WEEKLY_GAME2_LEADERBOARD=2196,x.RENTABLE_FURNI_RENT_OR_BUYOUT_OFFER=35,x.HANDSHAKE_IDENTITY_ACCOUNT=3523;let L=x;class MM extends v{constructor(t){super(t,KF)}getParser(){return this.parser}}class yM extends v{constructor(t){super(t,XF)}getParser(){return this.parser}}class DM extends v{constructor(t){super(t,qF)}getParser(){return this.parser}}class Vz extends v{constructor(t){super(t,JF)}getParser(){return this.parser}}class Hz extends v{constructor(t){super(t,$F)}getParser(){return this.parser}}class Wz extends v{constructor(t){super(t,ZF)}getParser(){return this.parser}}class Yz extends v{constructor(t){super(t,tG)}getParser(){return this.parser}}class zz extends v{constructor(t){super(t,eG)}getParser(){return this.parser}}class wS extends v{constructor(t){super(t,iG)}getParser(){return this.parser}}class bM extends v{constructor(t){super(t,rG)}getParser(){return this.parser}}class vM extends v{constructor(t){super(t,nG)}getParser(){return this.parser}}class Kz extends v{constructor(t){super(t,aG)}getParser(){return this.parser}}class LM extends v{constructor(t){super(t,oG)}getParser(){return this.parser}}class FS extends v{constructor(t){super(t,WB)}getParser(){return this.parser}}class Wg extends v{constructor(t){super(t,zB)}getParser(){return this.parser}}class PM extends v{constructor(t){super(t,YB)}getParser(){return this.parser}}class GS extends v{constructor(t){super(t,KB)}getParser(){return this.parser}}class UM extends v{constructor(t){super(t,XB)}getParser(){return this.parser}}class jM extends v{constructor(t){super(t,qB)}getParser(){return this.parser}}class Xz extends v{constructor(t){super(t,QB)}getParser(){return this.parser}}class qz extends v{constructor(t){super(t,JB)}getParser(){return this.parser}}class Qz extends v{constructor(t){super(t,$B)}getParser(){return this.parser}}class wM extends v{constructor(t){super(t,ZB)}getParser(){return this.parser}}class FM extends v{constructor(t){super(t,tk)}getParser(){return this.parser}}class GM extends v{constructor(t){super(t,ek)}getParser(){return this.parser}}class BM extends v{constructor(t){super(t,sk)}getParser(){return this.parser}}class kM extends v{constructor(t){super(t,rk)}get userID(){return this.getParser().userID}get userAccepts(){return this.getParser().userAccepts}getParser(){return this.parser}}class VM extends v{constructor(t){super(t,kg)}get userID(){return this.getParser().userID}getParser(){return this.parser}}class HM extends v{constructor(t){super(t,nk)}getParser(){return this.parser}}class WM extends v{constructor(t){super(t,ak)}getParser(){return this.parser}}class YM extends v{constructor(t){super(t,ok)}get firstUserID(){return this.getParser().firstUserID}get secondUserID(){return this.getParser().secondUserID}get firstUserNumItems(){return this.getParser().firstUserNumItems}get secondUserNumItems(){return this.getParser().secondUserNumItems}get firstUserNumCredits(){return this.getParser().firstUserNumCredits}get secondUserNumCredits(){return this.getParser().secondUserNumCredits}get firstUserItemArray(){return this.getParser().firstUserItemArray}get secondUserItemArray(){return this.getParser().secondUserItemArray}getParser(){return this.parser}}class Jz extends v{constructor(t){super(t,lk)}getParser(){return this.parser}}class zM extends v{constructor(t){super(t,ck)}getParser(){return this.parser}}class KM extends v{constructor(t){super(t,uk)}get userID(){return this.getParser().userID}get userCanTrade(){return this.getParser().userCanTrade}get otherUserID(){return this.getParser().otherUserID}get otherUserCanTrade(){return this.getParser().otherUserCanTrade}getParser(){return this.parser}}class XM extends v{constructor(t){super(t,PI)}getParser(){return this.parser}}class qM extends v{constructor(t){super(t,hk)}getParser(){return this.parser}}class QM extends v{constructor(t){super(t,dk)}getParser(){return this.parser}}class JM extends v{constructor(t){super(t,C2)}getParser(){return this.parser}}class $z extends v{constructor(t){super(t,A2)}getParser(){return this.parser}}class $M extends v{constructor(t){super(t,N2)}getParser(){return this.parser}}class ZM extends v{constructor(t){super(t,x2)}getParser(){return this.parser}}class Zz extends v{constructor(t){super(t,M2)}getParser(){return this.parser}}class ty extends v{constructor(t){super(t,y2)}getParser(){return this.parser}}class t5 extends v{constructor(t){super(t,b2)}getParser(){return this.parser}}class ey extends v{constructor(t){super(t,D2)}getParser(){return this.parser}}class sy extends v{constructor(t){super(t,qI)}getParser(){return this.parser}}class iy extends v{constructor(t){super(t,QI)}getParser(){return this.parser}}class ry extends v{constructor(t){super(t,P2)}getParser(){return this.parser}}class ny extends v{constructor(t){super(t,U2)}getParser(){return this.parser}}class ay extends v{constructor(t){super(t,sx)}getParser(){return this.parser}}class oy extends v{constructor(t){super(t,w2)}getParser(){return this.parser}}class ly extends v{constructor(t){super(t,G2)}getParser(){return this.parser}}class cy extends v{constructor(t){super(t,F2)}getParser(){return this.parser}}class uy extends v{constructor(t){super(t,k2)}getParser(){return this.parser}}class hy extends v{constructor(t){super(t,V2)}getParser(){return this.parser}}class dy extends v{constructor(t){super(t,Y2)}getParser(){return this.parser}}class _y extends v{constructor(t){super(t,z2)}getParser(){return this.parser}}class gy extends v{constructor(t){super(t,X2)}getParser(){return this.parser}}class fy extends v{constructor(t){super(t,q2)}getParser(){return this.parser}}class my extends v{constructor(t){super(t,$2)}getParser(){return this.parser}}class Ey extends v{constructor(t){super(t,Z2)}getParser(){return this.parser}}class py extends v{constructor(t){super(t,eH)}getParser(){return this.parser}}class Iy extends v{constructor(t){super(t,sH)}getParser(){return this.parser}}class Ty extends v{constructor(t){super(t,iH)}getParser(){return this.parser}}class Ry extends v{constructor(t){super(t,rH)}getParser(){return this.parser}}class Sy extends v{constructor(t){super(t,nH)}getParser(){return this.parser}}class e5 extends v{constructor(t){super(t,JI)}getParser(){return this.parser}}class Oy extends v{constructor(t){super(t,aH)}getParser(){return this.parser}}class s5 extends v{constructor(t){super(t,gH)}getParser(){return this.parser}}class i5 extends v{constructor(t){super(t,fH)}getParser(){return this.parser}}class r5 extends v{constructor(t){super(t,mH)}getParser(){return this.parser}}class BS extends v{constructor(t){super(t,EH)}getParser(){return this.parser}get userName(){return this.getParser().userName}}class n5 extends v{constructor(t){super(t,pH)}getParser(){return this.parser}}class a5 extends v{constructor(t){super(t,IH)}getParser(){return this.parser}}class Yg extends v{constructor(t){super(t,TH)}getParser(){return this.parser}}class Cy extends v{constructor(t){super(t,RH)}getParser(){return this.parser}}class po extends v{constructor(t){super(t,SH)}getParser(){return this.parser}}class o5 extends v{constructor(t){super(t,OH)}getParser(){return this.parser}}class l5 extends v{constructor(t){super(t,AH)}getParser(){return this.parser}}class Ay extends v{constructor(t){super(t,xH)}getParser(){return this.parser}}class c5 extends v{constructor(t){super(t,yH)}getParser(){return this.parser}}class Ny extends v{constructor(t){super(t,DH)}getParser(){return this.parser}}class xy extends v{constructor(t){super(t,bH)}getParser(){return this.parser}}class u5 extends v{constructor(t){super(t,vH)}getParser(){return this.parser}}class My extends v{constructor(t){super(t,LH)}getParser(){return this.parser}}class h5 extends v{constructor(t){super(t,PH)}getParser(){return this.parser}}class d5 extends v{constructor(t){super(t,wH)}getParser(){return this.parser}}class _5 extends v{constructor(t){super(t,FH)}getParser(){return this.parser}}class yy extends v{constructor(t){super(t,GH)}getParser(){return this.parser}}class Dy extends v{constructor(t){super(t,BH)}getParser(){return this.parser}}class by extends v{constructor(t){super(t,kH)}getParser(){return this.parser}}class g5 extends v{constructor(t){super(t,VH)}getParser(){return this.parser}}class vy extends v{constructor(t){super(t,HH)}getParser(){return this.parser}}class Ly extends v{constructor(t){super(t,WH)}getParser(){return this.parser}}class Py extends v{constructor(t){super(t,zH)}getParser(){return this.parser}}class kS extends v{constructor(t){super(t,KH)}getParser(){return this.parser}}class Uy extends v{constructor(t){super(t,XH)}getParser(){return this.parser}}class jy extends v{constructor(t){super(t,qH)}getParser(){return this.parser}}class wy extends v{constructor(t){super(t,QH)}getParser(){return this.parser}}class f5 extends v{constructor(t){super(t,JH)}getParser(){return this.parser}}class Fy extends v{constructor(t){super(t,$H)}getParser(){return this.parser}}class Gy extends v{constructor(t){super(t,ZH)}getParser(){return this.parser}}class By extends v{constructor(t){super(t,tW)}getParser(){return this.parser}}class ky extends v{constructor(t){super(t,eW)}getParser(){return this.parser}}class m5 extends v{constructor(t){super(t,sW)}getParser(){return this.parser}}class Vy extends v{constructor(t){super(t,iW)}getParser(){return this.parser}}class Hy extends v{constructor(t){super(t,rW)}getParser(){return this.parser}}class E5 extends v{constructor(t){super(t,nW)}getParser(){return this.parser}}class Wy extends v{constructor(t){super(t,aW)}getParser(){return this.parser}}class Yy extends v{constructor(t){super(t,oW)}getParser(){return this.parser}}class zy extends v{constructor(t){super(t,lW)}getParser(){return this.parser}}class p5{constructor(t){this._itemName=t.readString(),this._extraInfo=t.readString(),this._extraInfo==""&&(this._extraInfo=null)}get itemName(){return this._itemName}get extraInfo(){return this._extraInfo}}class I5{constructor(t){this._thumbnailUrl=t.readString(),this._thumbnailUrl==""&&(this._thumbnailUrl=null),this._productOfferList=[];const e=t.readInt();let s=0;for(;s<e;)this._productOfferList.push(new p5(t)),s++}get productOfferList(){return this._productOfferList}get thumbnailUrl(){return this._thumbnailUrl}}class T5{flush(){return!0}parse(t){if(!t)return!1;const e=t.readInt();this._giftOptions=[];let s=0;for(;s<e;)this._giftOptions.push(new O5(t)),s++;return!0}get giftOptions(){return this._giftOptions}}class R5{flush(){return!0}parse(t){return!!t}}class S5 extends v{constructor(t){super(t,T5)}getParser(){return this.parser}}class O5{constructor(t){this._dayIndex=t.readInt(),this._stepIndex=t.readInt(),this._options=[];const e=t.readInt();let s=0;for(;s<e;)this._options.push(new I5(t)),s++}get dayIndex(){return this._dayIndex}get stepIndex(){return this._stepIndex}get options(){return this._options}}class C5 extends v{constructor(t){super(t,R5)}getParser(){return this.parser}}class VS extends v{constructor(t){super(t,uW)}getParser(){return this.parser}}class A5 extends v{constructor(t){super(t,LI)}getParser(){return this.parser}}class Ky extends v{constructor(t){super(t,hW)}getParser(){return this.parser}}class Xy extends v{constructor(t){super(t,dW)}getParser(){return this.parser}}class qy extends v{constructor(t){super(t,_W)}getParser(){return this.parser}}class Qy extends v{constructor(t){super(t,gW)}getParser(){return this.parser}}class Jy extends v{constructor(t){super(t,fW)}getParser(){return this.parser}}class $y extends v{constructor(t){super(t,pW)}getParser(){return this.parser}}class Zy extends v{constructor(t){super(t,IW)}getParser(){return this.parser}}class tD extends v{constructor(t){super(t,TW)}getParser(){return this.parser}}class eD extends v{constructor(t){super(t,RW)}getParser(){return this.parser}}class sD extends v{constructor(t){super(t,OW)}getParser(){return this.parser}}class iD extends v{constructor(t){super(t,SW)}getParser(){return this.parser}}class rD extends v{constructor(t){super(t,CW)}getParser(){return this.parser}}class nD extends v{constructor(t){super(t,AW)}getParser(){return this.parser}}class N5 extends v{constructor(t){super(t,MW)}getParser(){return this.parser}}class aD extends v{constructor(t){super(t,bW)}getParser(){return this.parser}}class x5 extends v{constructor(t){super(t,vW)}getParser(){return this.parser}}class M5 extends v{constructor(t){super(t,LW)}getParser(){return this.parser}}class y5 extends v{constructor(t){super(t,PW)}getParser(){return this.parser}}class D5 extends v{constructor(t){super(t,UW)}getParser(){return this.parser}}class b5 extends v{constructor(t){super(t,jW)}getParser(){return this.parser}}class v5 extends v{constructor(t){super(t,wW)}getParser(){return this.parser}}class L5 extends v{constructor(t){super(t,FW)}getParser(){return this.parser}}class P5 extends v{constructor(t){super(t,GW)}getParser(){return this.parser}}class U5 extends v{constructor(t){super(t,BW)}getParser(){return this.parser}}const qm=class qm extends v{constructor(t){super(t,kW)}getParser(){return this.parser}};qm.FINISHED_OK=1,qm.FINISHED_FAIL=2;let ZI=qm;const cd=class cd extends v{constructor(t){super(t,VW)}getParser(){return this.parser}};cd.SYSTEM_STATUS_ENABLED=1,cd.SYSTEM_STATUS_DISABLED=2,cd.SYSTEM_STATUS_TIMEOUT=3;let tT=cd;class zg extends v{constructor(t){super(t,lG)}getParser(){return this.parser}}class eT extends v{constructor(t){super(t,cG)}getParser(){return this.parser}}class sT extends v{constructor(t){super(t,hG)}getParser(){return this.parser}}class iT extends v{constructor(t){super(t,uG)}getParser(){return this.parser}}class oD extends v{constructor(t){super(t,Ju)}getParser(){return this.parser}}class Kg extends v{constructor(t){super(t,dG)}getParser(){return this.parser}}class lD extends v{constructor(t){super(t,_G)}getParser(){return this.parser}}class cD extends v{constructor(t){super(t,gG)}getParser(){return this.parser}}class j5 extends v{constructor(t){super(t,fG)}getParser(){return this.parser}}class w5 extends v{constructor(t){super(t,EG)}getParser(){return this.parser}}class uD extends v{constructor(t){super(t,bG)}getParser(){return this.parser}}class HS extends v{constructor(t){super(t,vG)}getParser(){return this.parser}}class hD extends v{constructor(t){super(t,LG)}getParser(){return this.parser}}class dD extends v{constructor(t){super(t,PG)}getParser(){return this.parser}}class rT extends v{constructor(t){super(t,dB)}getParser(){return this.parser}}class nT extends v{constructor(t){super(t,_B)}getParser(){return this.parser}}class _D extends v{constructor(t){super(t,jG)}getParser(){return this.parser}}class aT extends v{constructor(t){super(t,wG)}getParser(){return this.parser}}class oT extends v{constructor(t){super(t,FG)}getParser(){return this.parser}}class lT extends v{constructor(t){super(t,GG)}getParser(){return this.parser}}class cT extends v{constructor(t){super(t,BG)}getParser(){return this.parser}}class uT extends v{constructor(t){super(t,kG)}getParser(){return this.parser}}class F5 extends v{constructor(t){super(t,VG)}getParser(){return this.parser}}class hT extends v{constructor(t){super(t,HG)}getParser(){return this.parser}}class dT extends v{constructor(t){super(t,To)}getParser(){return this.parser}}class gD extends v{constructor(t){super(t,WG)}getParser(){return this.parser}}class fD extends v{constructor(t){super(t,YG)}getParser(){return this.parser}}class _T extends v{constructor(t){super(t,zG)}getParser(){return this.parser}}class mD extends v{constructor(t){super(t,KG)}getParser(){return this.parser}}class ED extends v{constructor(t){super(t,XG)}getParser(){return this.parser}}class pD extends v{constructor(t){super(t,qG)}getParser(){return this.parser}}class gT extends v{constructor(t){super(t,QG)}getParser(){return this.parser}}class G5 extends v{constructor(t){super(t,JG)}getParser(){return this.parser}}class B5 extends v{constructor(t){super(t,$G)}getParser(){return this.parser}}class k5 extends v{constructor(t){super(t,vI)}getParser(){return this.parser}}class ID extends v{constructor(t){super(t,ZG)}getParser(){return this.parser}}class TD extends v{constructor(t){super(t,eB)}getParser(){return this.parser}}class V5 extends v{constructor(t){super(t,sB)}getParser(){return this.parser}}class fT extends v{constructor(t){super(t,iB)}getParser(){return this.parser}}class mT extends v{constructor(t){super(t,rB)}getParser(){return this.parser}}class ET extends v{constructor(t){super(t,nB)}getParser(){return this.parser}}class pT extends v{constructor(t){super(t,aB)}getParser(){return this.parser}}class H5 extends v{constructor(t){super(t,oB)}getParser(){return this.parser}}class RD extends v{constructor(t){super(t,lB)}getParser(){return this.parser}}class SD extends v{constructor(t){super(t,uB)}getParser(){return this.parser}}class OD extends v{constructor(t){super(t,hB)}getParser(){return this.parser}}class Xg extends v{constructor(t){super(t,Gg)}getParser(){return this.parser}}class qg extends v{constructor(t){super(t,gB)}getParser(){return this.parser}}class IT extends v{constructor(t){super(t,rl)}getParser(){return this.parser}}class TT extends v{constructor(t){super(t,fB)}getParser(){return this.parser}}class CD extends v{constructor(t){super(t,mB)}getParser(){return this.parser}}class RT extends v{constructor(t){super(t,EB)}getParser(){return this.parser}}class oh extends v{constructor(t){super(t,pB)}getParser(){return this.parser}}class Qg extends v{constructor(t){super(t,IB)}getParser(){return this.parser}}class AD extends v{constructor(t){super(t,TB)}getParser(){return this.parser}}class ND extends v{constructor(t){super(t,RB)}getParser(){return this.parser}}class Jg extends v{constructor(t){super(t,SB)}getParser(){return this.parser}}class xD extends v{constructor(t){super(t,OB)}getParser(){return this.parser}}class MD extends v{constructor(t){super(t,CB)}getParser(){return this.parser}}class yD extends v{constructor(t){super(t,NB)}getParser(){return this.parser}}class DD extends v{constructor(t){super(t,xB)}getParser(){return this.parser}}class bD extends v{constructor(t){super(t,MB)}getParser(){return this.parser}}class vD extends v{constructor(t){super(t,yB)}getParser(){return this.parser}}class WS extends v{constructor(t){super(t,TS)}getParser(){return this.parser}}class $g extends v{constructor(t){super(t,TS)}getParser(){return this.parser}}class Zg extends v{constructor(t){super(t,TS)}getParser(){return this.parser}}class ST extends v{constructor(t){super(t,DB)}getParser(){return this.parser}}class tf extends v{constructor(t){super(t,bB)}getParser(){return this.parser}}class OT extends v{constructor(t){super(t,vB)}getParser(){return this.parser}}class ef extends v{constructor(t){super(t,GB)}getParser(){return this.parser}}class CT extends v{constructor(t){super(t,LB)}getParser(){return this.parser}}class AT extends v{constructor(t){super(t,PB)}getParser(){return this.parser}}class LD extends v{constructor(t){super(t,UB)}getParser(){return this.parser}}class NT extends v{constructor(t){super(t,jB)}getParser(){return this.parser}}class sf extends v{constructor(t){super(t,wB)}getParser(){return this.parser}}class xT extends v{constructor(t){super(t,FB)}getParser(){return this.parser}}class rf extends v{constructor(t){super(t,BB)}getParser(){return this.parser}}class MT extends v{constructor(t){super(t,HB)}getParser(){return this.parser}}class PD extends v{constructor(t){super(t,HW)}getParser(){return this.parser}}class UD extends v{constructor(t){super(t,WW)}getParser(){return this.parser}}class jD extends v{constructor(t){super(t,YW)}getParser(){return this.parser}}class W5 extends v{constructor(t){super(t,zW)}getParser(){return this.parser}}const Qm=class Qm extends v{constructor(t){super(t,KW)}getParser(){return this.parser}};Qm.PRODUCT_DONATED_CODE=6,Qm.BADGE_DONATED_CODE=7;let yT=Qm;class wD extends v{constructor(t){super(t,XW)}getParser(){return this.parser}}class Y5 extends v{constructor(t){super(t,qW)}getParser(){return this.parser}}class FD extends v{constructor(t){super(t,IG)}getParser(){return this.parser}}class GD extends v{constructor(t){super(t,RG)}getParser(){return this.parser}}class BD extends v{constructor(t){super(t,SG)}getParser(){return this.parser}}class kD extends v{constructor(t){super(t,OG)}getParser(){return this.parser}}class z5 extends v{constructor(t){super(t,CG)}getParser(){return this.parser}}class K5 extends v{constructor(t){super(t,AG)}getParser(){return this.parser}}class VD extends v{constructor(t){super(t,NG)}getParser(){return this.parser}}class X5 extends v{constructor(t){super(t,xG)}getParser(){return this.parser}}class q5 extends v{constructor(t){super(t,MG)}getParser(){return this.parser}}class HD extends v{constructor(t){super(t,Xd)}getParser(){return this.parser}}class Q5 extends v{constructor(t){super(t,yG)}getParser(){return this.parser}}class J5 extends v{constructor(t){super(t,DG)}getParser(){return this.parser}}class WD extends v{constructor(t){super(t,QW)}getParser(){return this.parser}}class YD extends v{constructor(t){super(t,JW)}getParser(){return this.parser}}class zD extends v{constructor(t){super(t,$W)}getParser(){return this.parser}}class KD extends v{constructor(t){super(t,ZW)}getParser(){return this.parser}}class XD extends v{constructor(t){super(t,tY)}getParser(){return this.parser}}class $5 extends v{constructor(t){super(t,eY)}getParser(){return this.parser}}class Z5 extends v{constructor(t){super(t,sY)}getParser(){return this.parser}}class qD extends v{constructor(t){super(t,rY)}getParser(){return this.parser}}class QD extends v{constructor(t){super(t,nY)}getParser(){return this.parser}}class t3 extends v{constructor(t){super(t,aY)}getParser(){return this.parser}}class e3 extends v{constructor(t){super(t,lY)}getParser(){return this.parser}}class s3 extends v{constructor(t){super(t,uY)}getParser(){return this.parser}}class YS extends v{constructor(t){super(t,CF)}getParser(){return this.parser}}class JD extends v{constructor(t){super(t,jg)}getParser(){return this.parser}}class $D extends v{constructor(t){super(t,AF)}getParser(){return this.parser}}class i3 extends v{constructor(t){super(t,xI)}getParser(){return this.parser}}class zS extends v{constructor(t){super(t,xF)}getParser(){return this.parser}}class KS extends v{constructor(t){super(t,MF)}getParser(){return this.parser}}class lh extends v{constructor(t){super(t,DF)}getParser(){return this.parser}}class $E extends v{constructor(t){super(t,bF)}getParser(){return this.parser}}class ZD extends v{constructor(t){super(t,vF)}getParser(){return this.parser}}class XS extends v{constructor(t){super(t,LF)}getParser(){return this.parser}}class tb extends v{constructor(t){super(t,PF)}getParser(){return this.parser}}class eb extends v{constructor(t){super(t,UF)}getParser(){return this.parser}}class sb extends v{constructor(t){super(t,jF)}getParser(){return this.parser}}class r3 extends v{constructor(t){super(t,wF)}getParser(){return this.parser}}class n3 extends v{constructor(t){super(t,FF)}getParser(){return this.parser}}class a3 extends v{constructor(t){super(t,MI)}getParser(){return this.parser}}class o3 extends v{constructor(t){super(t,GF)}getParser(){return this.parser}}class ib extends v{constructor(t){super(t,BF)}getParser(){return this.parser}}class rb extends v{constructor(t){super(t,kF)}getParser(){return this.parser}}class l3 extends v{constructor(t){super(t,yI)}getParser(){return this.parser}}class nb extends v{constructor(t){super(t,VF)}getParser(){return this.parser}}class qS extends v{constructor(t){super(t,HF)}getParser(){return this.parser}}class ab extends v{constructor(t){super(t,WF)}getParser(){return this.parser}}class ob extends v{constructor(t){super(t,YF)}getParser(){return this.parser}}class lb extends v{constructor(t){super(t,zF)}getParser(){return this.parser}}class cb extends v{constructor(t){super(t,wg)}getParser(){return this.parser}}const Zr=class Zr{constructor(t){this._type=t.readInt(),this._userId=t.readInt(),this._userName=t.readString(),this._figure=t.readString(),this._memberSince=t.readString()}get userId(){return this._userId}get userName(){return this._userName}get admin(){return this._type==Zr.TYPE_ADMIN}get owner(){return this._type==Zr.TYPE_OWNER}get pending(){return this._type==Zr.TYPE_PENDING}get member(){return this._type!=Zr.TYPE_MEMBER}get blocked(){return this._type==Zr.TYPE_BLOCKED}get figure(){return this._figure}get memberSince(){return this._memberSince}};Zr.TYPE_OWNER=0,Zr.TYPE_ADMIN=1,Zr.TYPE_PENDING=2,Zr.TYPE_MEMBER=3,Zr.TYPE_BLOCKED=4;let DT=Zr;class ub extends v{constructor(t){super(t,_k)}getParser(){return this.parser}}class hb extends v{constructor(t){super(t,gk)}getParser(){return this.parser}}class QS extends v{constructor(t){super(t,fk)}getParser(){return this.parser}}class db extends v{constructor(t){super(t,pk)}getParser(){return this.parser}}class _b extends v{constructor(t){super(t,Ik)}getParser(){return this.parser}}class c3 extends v{constructor(t){super(t,Tk)}getParser(){return this.parser}}class u3 extends v{constructor(t){super(t,dY)}getParser(){return this.parser}}class gb{constructor(t){this._data=[t]}dispose(){}getMessageArray(){return this._data}}class fb{constructor(t){this._data=[t]}dispose(){}getMessageArray(){return this._data}}class h3{constructor(){this._data=[]}dispose(){}getMessageArray(){return this._data}}class d3{constructor(){this._data=[]}dispose(){}getMessageArray(){return this._data}}class mb{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Eb{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class pb{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class Ib{constructor(t=0){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Tb{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class _3{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Rb{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Sb{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class nf{constructor(t="",e="",s="",i=-1,n=-1){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=[]}assignBitmap(t){const e=Ee.generateImageUrl(t);if(!e)return;const s=e.split(",")[1],i=Uint8Array.from(atob(s),n=>n.charCodeAt(0));this._data.push(i.byteLength,i.buffer)}assignBase64(t){const e=t.split(",")[1],s=Uint8Array.from(atob(e),i=>i.charCodeAt(0));this._data.push(s.byteLength,s.buffer)}}class bT extends nf{constructor(t="",e="",s="",i=-1,n=-1){super(t,e,s,i,n)}}class Ob{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Cb{constructor(t,e){this._data=[t,e]}dispose(){this._data=null}getMessageArray(){return this._data}}class Ab{constructor(t,e){this._data=[t,e]}dispose(){this._data=null}getMessageArray(){return this._data}}class Nb{constructor(t,e,s,i,n,o){this._data=[t,e,s,i,n,o]}dispose(){this._data=null}getMessageArray(){return this._data}}class xb{constructor(t,e,s,i){this._data=[t,e,s,i]}dispose(){this._data=null}getMessageArray(){return this._data}}class Mb{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class yb{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class g3{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class Db{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class bb{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class f3{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class m3{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class JS{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class vb{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){this._data=null}}class E3{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){this._data=null}}class Lb{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class p3{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class I3{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class T3{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){this._data=null}}class R3{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class S3{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){this._data=null}}class Pb{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Ub{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class O3{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class jb{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class $S{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class C3{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class A3{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){this._data=null}}class wb{constructor(t,e,s,i,n,o,l,c,u){this._data=[t,e,s,i,n,o,l,c,u]}getMessageArray(){return this._data}dispose(){}}class R_{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class Fb{constructor(t,e,s,i,n,o,l){this._data=[t,e,s,i,n,o,l]}getMessageArray(){return this._data}dispose(){}}class Gb{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class N3{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Bb{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class x3{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class kb{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class M3{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class y3{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class D3{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class b3{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class v3{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class L3{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class P3{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class U3{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class j3{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}const Mu=class Mu{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}};Mu.CONFIRM_LEVEL_NOT_ACCEPTED=0,Mu.CONFIRM_LEVEL_NOT_SUBMITTED=1,Mu.CONFIRM_LEVEL_NOT_CONFIRMED=2,Mu.CONFIRM_LEVEL_COMMIT=3;let vT=Mu;class w3{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Vb{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class F3{constructor(t,e){this._data=[t,e.length].concat(e)}getMessageArray(){return this._data}dispose(){}}class Hb{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Wb{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class G3{constructor(t,e){this._data=[t,e.length].concat(e)}getMessageArray(){return this._data}dispose(){}}class Yb{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class zb{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class Kb{constructor(...t){this._data=[t.length,...t]}getMessageArray(){return this._data}dispose(){}}class LT{constructor(t,...e){this._data=[t,e.length,...e]}getMessageArray(){return this._data}dispose(){}}class B3{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class ZE{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Xb{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class qb{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Qb{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Jb{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class $b{constructor(...t){this._data=[t.length,...t]}getMessageArray(){return this._data}dispose(){}}class ZS{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}let Zb=class{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}};class tv{constructor(t,e){this._data=[e.length,...e,t]}getMessageArray(){return this._data}dispose(){}}class tu{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class k3{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class ev{constructor(t=!0){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class V3{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class H3{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class W3{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class Y3{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class sv{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class z3{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class K3{constructor(t,e){this._data=[t,e]}dispose(){this._data=null}getMessageArray(){return this._data}}class X3{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class q3{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class iv{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class rv{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class nv{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class Q3{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class av{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class J3{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class $3{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class Z3{constructor(t,e,s,i,n,o){this._data=[t,e,s,i,n,o]}dispose(){this._data=null}getMessageArray(){return this._data}}class tK{constructor(t,e,s,i,n,o){this._data=[t,e,s,i,n,o]}dispose(){this._data=null}getMessageArray(){return this._data}}class eK{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class sK{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}const dC=class dC{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}};dC.NO_ISSUE_ID=-1;let PT=dC;class iK{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}const _C=class _C{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}};_C.NO_ISSUE_ID=-1;let UT=_C;class rK{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class nK{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class aK{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class ov{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class lv{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class cv{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class uv{constructor(t,e,s,i,n,o){this._data=[t,e,s,i,n,o.length,...o]}getMessageArray(){return this._data}dispose(){}}class hv{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class dv{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class _v{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class gv{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class ch{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class fv{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class jT{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class mv{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class Ev{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class tp{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class pv{constructor(t,e){this._data=[t,e.length,...e]}getMessageArray(){return this._data}dispose(){}}class Iv{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class Tv{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class Rv{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class Sv{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Ov{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class oK{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class lK{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class cK{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class uK{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class hK{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class dK{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class _K{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class gK{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class fK{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class mK{constructor(...t){this._data=[t.length],t.forEach(e=>{this._data.push(e.k),this._data.push(e._arg_2),this._data.push(e._arg_3)})}getMessageArray(){return this._data}dispose(){}}class EK{constructor(t,e,s,i,n){this._data=[t,e,s,i,n]}getMessageArray(){return this._data}dispose(){}}class pK{constructor(t,e,s,i){this._data=[t,e,i,s]}getMessageArray(){return this._data}dispose(){}}class IK{constructor(t,e,s){if(this._type=t,e.length===s.length){this._data=[];for(let i=0;i<e.length;i++)this._data.push(e[i]),this._data.push(s[i])}}getMessageArray(){return this._data}dispose(){}}class Cv{constructor(t,e,s,i){this._data=[`NITRO-${rh.RENDERER_VERSION.replaceAll(".","-")}`,"HTML5",iI.HTML5,sI.BROWSER]}getMessageArray(){return this._data}dispose(){}}class TK{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class RK{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Av{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class SK{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Nv{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class xv{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class OK{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class CK{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class Mv{constructor(t,e,s,i,n){this._data=[t,e,s,i,n]}getMessageArray(){return this._data}dispose(){}}class yv{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class Dv{constructor(t,e,s,i){this._data=[t,e,s,i.length/2,...i]}getMessageArray(){return this._data}dispose(){}}class bv{constructor(t,e,s,i,n){this._data=[t,e,s,i,n]}getMessageArray(){return this._data}dispose(){}}class AK{constructor(t,e,s,i,n){this._data=[t,e,s,i,n]}getMessageArray(){return this._data}dispose(){}}class vv{constructor(t,e,s,i,n){this._data=[t,e,s,i,n.length/2,...n]}getMessageArray(){return this._data}dispose(){}}class NK{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class xK{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class MK{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class yK{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class Lv{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class DK{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class bK{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class vK{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class LK{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Pv{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class PK{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Uv{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class jv{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class wv{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Fv{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Gv{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class UK{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Bv{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class wT{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class jK{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class kv{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Vv{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class wK{constructor(t,e){this._data=[t,e.length,...e]}getMessageArray(){return this._data}dispose(){}}class FK{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class GK{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class BK{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class kK{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class VK{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class HK{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class Hv{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Wv{constructor(){this._badges=[]}getMessageArray(){const t=[];for(let e=1;e<=this._badges.length;e++)t.push(e),t.push(this._badges[e-1]);return t}dispose(){}addActivatedBadge(t){this._badges.push(t)}}class FT{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Yv{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class WK{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class YK{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class zK{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class GT{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class zv{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Kv{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Xv{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class qv{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class BT{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Qv{constructor(...t){this._data=[t.length,...t]}getMessageArray(){return this._data}dispose(){}}class Jv{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class $v{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Zv{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class tL{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class eL{constructor(t,...e){this._data=[t,e.length,...e]}getMessageArray(){return this._data}dispose(){}}class sL{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class KK{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class kT{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){this._data=null}}class XK{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class iL{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){this._data=null}}class qK{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class rL{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class QK{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){this._data=null}}class nL{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){this._data=null}}class aL{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class oL{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class lL{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class JK{constructor(t,e,s){this._data=[t,e.length,...e,s]}getMessageArray(){return this._data}dispose(){}}const ud=class ud{constructor(t,e){this._data=[e,t.length,...t]}getMessageArray(){return this._data}dispose(){}};ud.RESOLUTION_USELESS=1,ud.RESOLUTION_ABUSIVE=2,ud.RESOLUTION_RESOLVED=3;let uc=ud;const Jm=class Jm{constructor(t,e,s,i,n,o=-1){this._data=[t,e,s,i,n],o!=Jm.NO_ISSUE_ID&&this._data.push(o)}getMessageArray(){return this._data}dispose(){}};Jm.NO_ISSUE_ID=-1;let va=Jm;class cL{constructor(t,e,s,i=-1){this._data=[t,e,s],i!=va.NO_ISSUE_ID&&this._data.push(i)}getMessageArray(){return this._data}dispose(){}}class uL{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class hL{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class dL{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class _L{constructor(t,e=0){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class gL{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class fL{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class mL{constructor(t,e,s,i=-1){this._data=[t,e,s],i!=va.NO_ISSUE_ID&&this._data.push(i)}getMessageArray(){return this._data}dispose(){}}class VT{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}const yu=class yu{constructor(t,e,s){this._data=[],this._data.push(t),this._data.push(e),this._data.push(s)}getMessageArray(){return this._data}dispose(){}};yu.ACTION_ALERT=0,yu.ACTION_KICK=1,yu.ACTION_MESSAGE=3,yu.ACTION_MESSAGE_AND_SOFT_KICK=4;let hc=yu;class EL{constructor(t,e,s,i=-1){this._data=[t,e,s],i!=va.NO_ISSUE_ID&&this._data.push(i)}getMessageArray(){return this._data}dispose(){}}class tO{constructor(t,e,s,i=-1){this._data=[],this._data.push(t),this._data.push(e),this._data.push(""),this._data.push(""),this._data.push(s),i!=va.NO_ISSUE_ID&&this._data.push(i)}getMessageArray(){return this._data}dispose(){}}class pL{constructor(t,e,s,i=-1){this._data=[t,e,s],i!=va.NO_ISSUE_ID&&this._data.push(i)}getMessageArray(){return this._data}dispose(){}}class $K{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class ZK{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class IL{constructor(t,e,s,i,n=-1){this._data=[t,e,s,i],n!=va.NO_ISSUE_ID&&this._data.push(n)}getMessageArray(){return this._data}dispose(){}}class TL{constructor(t,e,s,i){this._data=[t.length,...t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class eO{constructor(t){this._data=[t.length,...t]}getMessageArray(){return this._data}dispose(){}}class RL{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class t4{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class e4{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class s4{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class i4{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class SL{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class OL{constructor(t,e,s,i,n,o){this._data=[t,e,s,i,n,o]}getMessageArray(){return this._data}dispose(){}}class r4{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class CL{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class n4{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class a4{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class o4{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class AL{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Zd{constructor(t,e,s){this._data=[t,e?1:0,s?1:0]}getMessageArray(){return this._data}dispose(){}}class l4{constructor(t=0){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class c4{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class sO{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class NL{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class u4{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class h4{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class d4{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class _4{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class g4{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class f4{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class m4{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class E4{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class p4{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class I4{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class T4{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class xL{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class R4{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Nc{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class S4{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class O4{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class C4{constructor(t,e,s,i,n,o){this._data=[t,e,s,i,n,o]}getMessageArray(){return this._data}dispose(){}}class A4{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class ML{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class N4{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class x4{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class M4{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class y4{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class D4{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class b4{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class v4{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class L4{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class yL{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class DL{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class bL{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class P4{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class U4{constructor(...t){this._data=[t.length*3],t.forEach(e=>{this._data.push(e.dayIndex),this._data.push(e.stepIndex),this._data.push(e.giftIndex)})}dispose(){this._data=null}getMessageArray(){return this._data}}class vL{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}const y=class y{};y.BOBBA_PLAY_SOUND=4006,y.BOBBA_SET_LANGUAGE=4007,y.ACHIEVEMENT_LIST=219,y.AUTHENTICATION=-1,y.BOT_CONFIGURATION=1986,y.BOT_PICKUP=3323,y.BOT_PLACE=1592,y.BOT_SKILL_SAVE=2624,y.GET_CLUB_OFFERS=3285,y.GET_CLUB_GIFT_INFO=487,y.GET_CATALOG_INDEX=1195,y.GET_CATALOG_PAGE=412,y.CATALOG_PURCHASE=3492,y.CATALOG_PURCHASE_GIFT=1411,y.GET_PRODUCT_OFFER=2594,y.CLIENT_LATENCY=295,y.CLIENT_LATENCY_MEASURE=96,y.CLIENT_POLICY=26979,y.CLIENT_PONG=2596,y.CLIENT_TOOLBAR_TOGGLE=2313,y.CLIENT_VARIABLES=1053,y.GET_CURRENT_TIMING_CODE=2912,y.DESKTOP_NEWS=1827,y.DESKTOP_VIEW=105,y.GET_BUNDLE_DISCOUNT_RULESET=223,y.EVENT_TRACKER=3457,y.FIND_NEW_FRIENDS=516,y.FURNITURE_ALIASES=3898,y.FURNITURE_FLOOR_UPDATE=248,y.FURNITURE_MULTISTATE=99,y.FURNITURE_PICKUP=3456,y.FURNITURE_PLACE=1258,y.FURNITURE_POSTIT_PLACE=2248,y.FURNITURE_POSTIT_SAVE_STICKY_POLE=3283,y.FURNITURE_RANDOMSTATE=3617,y.FURNITURE_WALL_MULTISTATE=210,y.FURNITURE_WALL_UPDATE=168,y.GAMES_INIT=2914,y.GAMES_LIST=741,y.ACCEPTGAMEINVITE=3802,y.GAMEUNLOADEDMESSAGE=3207,y.GETGAMEACHIEVEMENTSMESSAGE=2399,y.GETGAMESTATUSMESSAGE=3171,y.GETUSERGAMEACHIEVEMENTSMESSAGE=389,y.JOINQUEUEMESSAGE=1458,y.LEAVEQUEUEMESSAGE=2384,y.RESETRESOLUTIONACHIEVEMENTMESSAGE=3144,y.GETWEEKLYGAMEREWARDWINNERS=1054,y.GAME2GETACCOUNTGAMESTATUSMESSAGE=11,y.GAME2CHECKGAMEDIRECTORYSTATUSMESSAGE=3259,y.GAME2EXITGAMEMESSAGE=1445,y.GAME2GAMECHATMESSAGE=2502,y.GAME2LOADSTAGEREADYMESSAGE=2415,y.GAME2PLAYAGAINMESSAGE=3196,y.GAME2REQUESTFULLSTATUSUPDATEMESSAGE=1598,y.GAME2GETWEEKLYFRIENDSLEADERBOARD=1232,y.GAME2GETWEEKLYLEADERBOARD=2565,y.GET_GIFT_WRAPPING_CONFIG=418,y.GROUP_ADMIN_ADD=2894,y.GROUP_ADMIN_REMOVE=722,y.GROUP_CREATE_OPTIONS=798,y.GROUP_FAVORITE=3549,y.GET_FORUM_STATS=3149,y.GET_FORUM_THREADS=873,y.GET_FORUMS_LIST=436,y.GET_FORUM_MESSAGES=232,y.GET_FORUM_THREAD=3900,y.GET_UNREAD_FORUMS_COUNT=2908,y.FORUM_MODERATE_MESSAGE=286,y.FORUM_MODERATE_THREAD=1397,y.FORUM_POST_MESSAGE=3529,y.UPDATE_FORUM_READ_MARKER=1855,y.UPDATE_FORUM_SETTINGS=2214,y.FORUM_UPDATE_THREAD=3045,y.GROUP_INFO=2991,y.GROUP_DELETE=1134,y.GROUP_MEMBER_REMOVE_CONFIRM=3593,y.GROUP_MEMBER_REMOVE=593,y.GROUP_MEMBERS=312,y.GROUP_MEMBERSHIPS=367,y.GROUP_REQUEST=998,y.GROUP_REQUEST_ACCEPT=3386,y.GROUP_REQUEST_DECLINE=1894,y.GROUP_SETTINGS=1004,y.GROUP_PARTS=813,y.GROUP_BUY=230,y.GROUP_SAVE_INFORMATION=3137,y.GROUP_SAVE_BADGE=1991,y.GROUP_SAVE_COLORS=1764,y.GROUP_SAVE_PREFERENCES=3435,y.GROUP_BADGES=21,y.GROUP_UNBLOCK_MEMBER=2864,y.GET_BADGE_POINTS_LIMITS=1371,y.REQUESTABADGE=3077,y.GETISBADGEREQUESTFULFILLED=1364,y.ITEM_CLOTHING_REDEEM=3374,y.ITEM_COLOR_WHEEL_CLICK=2144,y.ITEM_DICE_CLICK=1990,y.ITEM_DICE_CLOSE=1533,y.ITEM_DIMMER_SAVE=1648,y.ITEM_DIMMER_SETTINGS=2813,y.ITEM_DIMMER_TOGGLE=2296,y.ITEM_EXCHANGE_REDEEM=3115,y.ITEM_PAINT=711,y.SET_OBJECT_DATA=3608,y.ITEM_STACK_HELPER=3839,y.ITEM_WALL_CLICK=210,y.ITEM_WALL_UPDATE=168,y.MARKETPLACE_CONFIG=2597,y.ACCEPT_FRIEND=137,y.MESSENGER_CHAT=3567,y.DECLINE_FRIEND=2890,y.FOLLOW_FRIEND=3997,y.MESSENGER_FRIENDS=1523,y.MESSENGER_INIT=2781,y.MESSENGER_RELATIONSHIPS=2138,y.SET_RELATIONSHIP_STATUS=3768,y.REMOVE_FRIEND=1689,y.REQUEST_FRIEND=3157,y.GET_FRIEND_REQUESTS=2448,y.SEND_ROOM_INVITE=1276,y.HABBO_SEARCH=1210,y.FRIEND_LIST_UPDATE=1419,y.MOD_TOOL_USER_INFO=3295,y.GET_USER_FLAT_CATS=3027,y.NAVIGATOR_INIT=2110,y.NAVIGATOR_SEARCH=249,y.NAVIGATOR_SEARCH_CLOSE=1834,y.NAVIGATOR_SEARCH_OPEN=637,y.NAVIGATOR_SEARCH_SAVE=2226,y.GET_USER_EVENT_CATS=1782,y.NAVIGATOR_SETTINGS_SAVE=3159,y.NAVIGATOR_CATEGORY_LIST_MODE=1202,y.NAVIGATOR_DELETE_SAVED_SEARCH=1954,y.PET_INFO=2934,y.PET_PICKUP=1581,y.PET_PLACE=2647,y.PET_RESPECT=3202,y.PET_RIDE=1036,y.PET_MOVE=3449,y.PET_OPEN_PACKAGE=3698,y.PET_SELECTED=549,y.PETS_BREED=1638,y.PET_CANCEL_BREEDING=2713,y.PET_CONFIRM_BREEDING=3382,y.GET_PET_TRAINING_PANEL=2161,y.RECYCLER_PRIZES=398,y.RECYCLER_STATUS=1342,y.RECYCLER_ITEMS=2771,y.RELEASE_VERSION=4e3,y.CALL_FOR_HELP=1691,y.ROOM_AMBASSADOR_ALERT=2996,y.ROOM_BAN_GIVE=1477,y.ROOM_BAN_LIST=2267,y.ROOM_BAN_REMOVE=992,y.ROOM_CREATE=2752,y.ROOM_DELETE=532,y.ROOM_DOORBELL=1644,y.ROOM_ENTER=2312,y.ROOM_FAVORITE=3817,y.ROOM_FAVORITE_REMOVE=309,y.CAN_CREATE_ROOM=2128,y.CANCEL_ROOM_EVENT=2725,y.EDIT_ROOM_EVENT=3991,y.COMPETITION_ROOM_SEARCH=433,y.FORWARD_TO_RANDOM_PROMOTED_ROOM=10,y.FORWARD_TO_SOME_ROOM=1703,y.GET_CATEGORIES_WITH_USER_COUNT=3782,y.GET_GUEST_ROOM=2230,y.GET_OFFICIAL_ROOMS=1229,y.GET_POPULAR_ROOM_TAGS=826,y.GUILD_BASE_SEARCH=2930,y.MY_FAVOURITE_ROOMS_SEARCH=2578,y.MY_FREQUENT_ROOM_HISTORY_SEARCH=1002,y.MY_FRIENDS_ROOM_SEARCH=2266,y.MY_GUILD_BASES_SEARCH=39,y.MY_RECOMMENDED_ROOMS=2537,y.MY_ROOM_HISTORY_SEARCH=2264,y.MY_ROOM_RIGHTS_SEARCH=272,y.MY_ROOMS_SEARCH=2277,y.POPULAR_ROOMS_SEARCH=2758,y.ROOM_AD_EVENT_TAB_CLICKED=2412,y.ROOM_AD_EVENT_TAB_VIEWED=2668,y.ROOM_AD_SEARCH=2809,y.ROOM_TEXT_SEARCH=3943,y.ROOMS_WHERE_MY_FRIENDS_ARE=1786,y.ROOMS_WITH_HIGHEST_SCORE_SEARCH=2939,y.SET_ROOM_SESSION_TAGS=3305,y.UPDATE_ROOM_THUMBNAIL=2468,y.ROOM_KICK=1320,y.ROOM_LIKE=3582,y.ROOM_MODEL=2300,y.GET_OCCUPIED_TILES=1687,y.GET_ROOM_ENTRY_TILE=3559,y.ROOM_MODEL_SAVE=875,y.ROOM_MUTE=3637,y.ROOM_MUTE_USER=3485,y.ROOM_RIGHTS_GIVE=808,y.ROOM_RIGHTS_LIST=3385,y.ROOM_RIGHTS_REMOVE=2064,y.ROOM_RIGHTS_REMOVE_ALL=2683,y.ROOM_RIGHTS_REMOVE_OWN=3182,y.ROOM_SETTINGS=3129,y.ROOM_SETTINGS_SAVE=1969,y.ROOM_SETTINGS_UPDATE_ROOM_CATEGORY_AND_TRADE=1265,y.ROOM_STAFF_PICK=1918,y.ROOM_FILTER_WORDS=1911,y.ROOM_FILTER_WORDS_MODIFY=3001,y.MYSTERYBOXWAITINGCANCELEDMESSAGE=2012,y.MYSTERYBOX_OPEN_TROPHY=3074,y.SECURITY_MACHINE=2490,y.SECURITY_TICKET=2419,y.TRADE=1481,y.TRADE_ACCEPT=3863,y.TRADE_CANCEL=2341,y.TRADE_CLOSE=2551,y.TRADE_CONFIRM=2760,y.TRADE_ITEM=3107,y.TRADE_ITEM_REMOVE=3845,y.TRADE_ITEMS=1263,y.TRADE_UNACCEPT=1444,y.UNIT_ACTION=2456,y.UNIT_CHAT=1314,y.UNIT_CHAT_SHOUT=2085,y.UNIT_CHAT_WHISPER=1543,y.UNIT_DANCE=2080,y.UNIT_DROP_HAND_ITEM=2814,y.UNIT_GIVE_HANDITEM=2941,y.UNIT_LOOK=3301,y.UNIT_POSTURE=2235,y.UNIT_SIGN=1975,y.UNIT_TYPING=1597,y.UNIT_TYPING_STOP=1474,y.UNIT_WALK=3320,y.USER_BADGES=2769,y.USER_BADGES_CURRENT=2091,y.USER_BADGES_CURRENT_UPDATE=644,y.USER_BOTS=3848,y.USER_CURRENCY=273,y.USER_EFFECT_ACTIVATE=2959,y.USER_EFFECT_ENABLE=1752,y.USER_FIGURE=2730,y.USER_FURNITURE=3150,y.REQUESTFURNIINVENTORYWHENNOTINROOM=3500,y.USER_HOME_ROOM=1740,y.USER_INFO=357,y.USER_MOTTO=2228,y.USER_IGNORED=3878,y.USER_PETS=3095,y.USER_PROFILE=3265,y.USER_PROFILE_BY_NAME=2249,y.USER_RESPECT=2694,y.GET_SOUND_SETTINGS=2388,y.USER_SETTINGS_CAMERA=1461,y.USER_SETTINGS_CHAT_STYLE=1030,y.USER_SETTINGS_INVITES=1086,y.USER_SETTINGS_OLD_CHAT=1262,y.USER_SETTINGS_VOLUME=1367,y.USER_SUBSCRIPTION=3166,y.GET_WARDROBE=2742,y.SAVE_WARDROBE_OUTFIT=800,y.USER_TAGS=17,y.PEER_USERS_CLASSIFICATION=1160,y.USER_CLASSIFICATION=2285,y.VISIT_USER=2970,y.WIRED_ACTION_SAVE=2281,y.WIRED_APPLY_SNAPSHOT=3373,y.WIRED_CONDITION_SAVE=3203,y.WIRED_OPEN=768,y.WIRED_TRIGGER_SAVE=1520,y.GET_ITEM_DATA=3964,y.ONE_WAY_DOOR_CLICK=2765,y.REMOVE_WALL_ITEM=3336,y.SET_ITEM_DATA=3666,y.CATALOG_REDEEM_VOUCHER=339,y.ROOM_TONER_APPLY=2880,y.FRIEND_FURNI_CONFIRM_LOCK=3775,y.MANNEQUIN_SAVE_NAME=2850,y.MANNEQUIN_SAVE_LOOK=2209,y.PRESENT_OPEN_PRESENT=3558,y.CATALOG_SELECT_VIP_GIFT=2276,y.USER_IGNORE_ID=3314,y.USER_IGNORE=1117,y.USER_UNIGNORE=2061,y.MODTOOL_REQUEST_ROOM_INFO=707,y.MODTOOL_CHANGE_ROOM_SETTINGS=3260,y.MODTOOL_REQUEST_USER_CHATLOG=1391,y.MODTOOL_REQUEST_ROOM_CHATLOG=2587,y.MODTOOL_SANCTION_ALERT=229,y.MODTOOL_SANCTION_BAN=2766,y.MODTOOL_SANCTION_KICK=2582,y.MODTOOL_SANCTION_TRADELOCK=3742,y.MODTOOL_ALERTEVENT=1840,y.MODTOOL_SANCTION_MUTE=1945,y.MODTOOL_REQUEST_USER_ROOMS=3526,y.MODTOOL_ROOM_ALERT=3842,y.MODTOOL_PREFERENCES=31,y.CLOSE_ISSUE_DEFAULT_ACTION=2717,y.CLOSE_ISSUES=2067,y.DEFAULT_SANCTION=1681,y.GET_CFH_CHATLOG=211,y.MODTOOL_SANCTION=1392,y.PICK_ISSUES=15,y.RELEASE_ISSUES=1572,y.CONVERT_GLOBAL_ROOM_ID=314,y.REQUEST_SELL_ITEM=848,y.REQUEST_MARKETPLACE_ITEM_STATS=3288,y.MARKETPLACE_SELL_ITEM=3447,y.MARKETPLACE_REQUEST_OWN_ITEMS=2105,y.MARKETPLACE_TAKE_BACK_ITEM=434,y.MARKETPLACE_REDEEM_CREDITS=2650,y.MARKETPLACE_REQUEST_OFFERS=2407,y.MARKETPLACE_BUY_OFFER=1603,y.MARKETPLACE_BUY_TOKENS=1866,y.CATALOG_REQUESET_PET_BREEDS=1756,y.APPROVE_NAME=2109,y.UNIT_GIVE_HANDITEM_PET=2768,y.PET_MOUNT=1036,y.PET_SUPPLEMENT=749,y.FURNITURE_GROUP_INFO=2651,y.ACHIEVEMENT_RESOLUTION_OPEN=359,y.USE_PET_PRODUCT=1328,y.REMOVE_PET_SADDLE=186,y.TOGGLE_PET_RIDING=1472,y.TOGGLE_PET_BREEDING=3379,y.UNSEEN_RESET_CATEGORY=3493,y.UNSEEN_RESET_ITEMS=2343,y.COMMUNITY_GOAL_VOTE_COMPOSER=3536,y.GET_PROMO_ARTICLES=1827,y.ACCEPT_QUEST=3604,y.ACTIVATE_QUEST=793,y.CANCEL_QUEST=3133,y.FRIEND_REQUEST_QUEST_COMPLETE=1148,y.GET_COMMUNITY_GOAL_EARNED_PRIZES=2688,y.GET_COMMUNITY_GOAL_HALL_OF_FAME=2167,y.GET_COMMUNITY_GOAL_PROGRESS=1145,y.GET_CONCURRENT_USERS_GOAL_PROGRESS=1343,y.GET_CONCURRENT_USERS_REWARD=3872,y.GET_DAILY_QUEST=2486,y.GET_QUESTS=3333,y.GET_SEASONAL_QUESTS_ONLY=1190,y.OPEN_QUEST_TRACKER=2750,y.REDEEM_COMMUNITY_GOAL_PRIZE=90,y.REJECT_QUEST=2397,y.START_CAMPAIGN=1697,y.GET_BONUS_RARE_INFO=957,y.CRAFT=3591,y.CRAFT_SECRET=1251,y.GET_CRAFTABLE_PRODUCTS=633,y.GET_CRAFTING_RECIPE=1173,y.GET_CRAFTING_RECIPES_AVAILABLE=3086,y.PHOTO_COMPETITION=3959,y.PUBLISH_PHOTO=2068,y.PURCHASE_PHOTO=2408,y.RENDER_ROOM=3226,y.RENDER_ROOM_THUMBNAIL=1982,y.REQUEST_CAMERA_CONFIGURATION=796,y.ADD_JUKEBOX_DISK=753,y.GET_JUKEBOX_PLAYLIST=1435,y.GET_NOW_PLAYING=1325,y.GET_OFFICIAL_SONG_ID=3189,y.GET_SONG_INFO=3082,y.GET_SOUND_MACHINE_PLAYLIST=3498,y.GET_USER_SONG_DISKS=2304,y.REMOVE_JUKEBOX_DISK=3050,y.INTERSTITIAL_SHOWN=1109,y.GET_INTERSTITIAL=2519,y.CHANGE_USERNAME=2977,y.CHECK_USERNAME=3950,y.OPEN_CAMPAIGN_CALENDAR_DOOR_STAFF=3889,y.OPEN_CAMPAIGN_CALENDAR_DOOR=2257,y.BUILDERS_CLUB_PLACE_ROOM_ITEM=1051,y.BUILDERS_CLUB_PLACE_WALL_ITEM=462,y.BUILDERS_CLUB_QUERY_FURNI_COUNT=2529,y.GET_CATALOG_PAGE_EXPIRATION=742,y.GET_CATALOG_PAGE_WITH_EARLIEST_EXP=3135,y.GET_DIRECT_CLUB_BUY_AVAILABLE=801,y.GET_HABBO_BASIC_MEMBERSHIP_EXTEND_OFFER=603,y.GET_HABBO_CLUB_EXTEND_OFFER=2462,y.GET_IS_OFFER_GIFTABLE=1347,y.GET_LIMITED_OFFER_APPEARING_NEXT=410,y.GET_NEXT_TARGETED_OFFER=596,y.GET_ROOM_AD_PURCHASE_INFO=1075,y.GET_SEASONAL_CALENDAR_DAILY_OFFER=3257,y.GET_TARGETED_OFFER=2487,y.MARK_CATALOG_NEW_ADDITIONS_PAGE_OPENED=2150,y.PURCHASE_BASIC_MEMBERSHIP_EXTENSION=2735,y.PURCHASE_ROOM_AD=777,y.PURCHASE_TARGETED_OFFER=1826,y.PURCHASE_VIP_MEMBERSHIP_EXTENSION=3407,y.ROOM_AD_PURCHASE_INITIATED=2283,y.SET_TARGETTED_OFFER_STATE=2041,y.SHOP_TARGETED_OFFER_VIEWED=3483,y.HELPER_TALENT_TRACK=196,y.TALENT_TRACK_GET_LEVEL=2127,y.FORWARD_TO_A_COMPETITION_ROOM=172,y.FORWARD_TO_A_SUBMITTABLE_ROOM=1450,y.FORWARD_TO_RANDOM_COMPETITION_ROOM=865,y.GET_IS_USER_PART_OF_COMPETITION=2077,y.GET_SECONDS_UNTIL=271,y.ROOM_COMPETITION_INIT=1334,y.SUBMIT_ROOM_TO_COMPETITION=2595,y.VOTE_FOR_ROOM=143,y.GET_GIFT=2436,y.RESET_PHONE_NUMBER_STATE=2741,y.SET_PHONE_NUMBER_VERIFICATION_STATUS=1379,y.TRY_PHONE_NUMBER=790,y.VERIFY_CODE=2721,y.CONTROL_YOUTUBE_DISPLAY_PLAYBACK=3005,y.GET_YOUTUBE_DISPLAY_STATUS=336,y.SET_YOUTUBE_DISPLAY_PLAYLIST=2069,y.GO_TO_FLAT=685,y.CHANGE_QUEUE=3093,y.CALL_FOR_HELP_FROM_FORUM_MESSAGE=1412,y.CALL_FOR_HELP_FROM_FORUM_THREAD=534,y.CALL_FOR_HELP_FROM_IM=2950,y.CALL_FOR_HELP_FROM_PHOTO=2492,y.CALL_FOR_HELP_FROM_SELFIE=2755,y.CHAT_REVIEW_GUIDE_DECIDES=3365,y.CHAT_REVIEW_GUIDE_DETACHED=2501,y.CHAT_REVIEW_GUIDE_VOTE=3961,y.CHAT_REVIEW_SESSION_CREATE=3060,y.DELETE_PENDING_CALLS_FOR_HELP=3605,y.GET_CFH_STATUS=2746,y.GET_FAQ_CATEGORY=3445,y.GET_FAQ_TEXT=1849,y.GET_GUIDE_REPORTING_STATUS=3786,y.GET_PENDING_CALLS_FOR_HELP=3267,y.GET_QUIZ_QUESTIONS=1296,y.GUIDE_SESSION_CREATE=3338,y.GUIDE_SESSION_FEEDBACK=477,y.GUIDE_SESSION_GET_REQUESTER_ROOM=1052,y.GUIDE_SESSION_GUIDE_DECIDES=1424,y.GUIDE_SESSION_INVITE_REQUESTER=234,y.GUIDE_SESSION_IS_TYPING=519,y.GUIDE_SESSION_MESSAGE=3899,y.GUIDE_SESSION_ON_DUTY_UPDATE=1922,y.GUIDE_SESSION_REPORT=3969,y.GUIDE_SESSION_REQUESTER_CANCELS=291,y.GUIDE_SESSION_RESOLVED=887,y.POST_QUIZ_ANSWERS=3720,y.SEARCH_FAQS=2031,y.POLL_ANSWER=3505,y.POLL_REJECT=1773,y.POLL_START=109,y.POLL_VOTE_COUNTER=6200,y.DISCONNECT=2445,y.SCR_GET_KICKBACK_INFO=869,y.COMPOST_PLANT=3835,y.HARVEST_PET=1521,y.SET_CLOTHING_CHANGE_DATA=924,y.GROUP_UNFAVORITE=1820,y.NEW_USER_EXPERIENCE_GET_GIFTS=1822,y.NEW_USER_EXPERIENCE_SCRIPT_PROCEED=1299,y.HANDSHAKE_INIT_DIFFIE=3110,y.HANDSHAKE_COMPLETE_DIFFIE=773,y.WELCOME_OPEN_GIFT=2638,y.WELCOME_GIFT_CHANGE_EMAIL=66,y.EMAIL_GET_STATUS=2557,y.EMAIL_CHANGE=3965,y.APPROVE_ALL_MEMBERSHIP_REQUESTS=882,y.RENTABLE_SPACE_CANCEL_RENT=1667,y.RENTABLE_SPACE_RENT=2946,y.RENTABLE_SPACE_STATUS=872,y.TRACKING_PERFORMANCE_LOG=3230,y.TRACKING_LAG_WARNING_REPORT=3847,y.ROOM_DIRECTORY_ROOM_NETWORK_OPEN_CONNECTION=3736,y.RENTABLE_EXTEND_RENT_OR_BUYOUT_STRIP_ITEM=2115,y.RENTABLE_EXTEND_RENT_OR_BUYOUT_FURNI=1071,y.RENTABLE_GET_RENT_OR_BUYOUT_OFFER=2518;let D=y;class LL{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class HT{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class S_{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class j4{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class PL{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class UL{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class jL{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class wL{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class FL{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class GL{constructor(t,e,s){this._data=[t,e,s.length,...s]}getMessageArray(){return this._data}dispose(){}}class BL{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class kL{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class VL{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class w4{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class F4{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class G4{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class B4{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class k4{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class HL{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class V4{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class H4{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class W4{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Y4{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class z4{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class K4{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class X4{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class q4{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Q4{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class J4{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class $4{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Z4{constructor(...t){this._data=[t.length],t.forEach(e=>{this._data.push(e.itemId)})}getMessageArray(){return this._data}dispose(){}}class WL{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class YL{constructor(t,e=null){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class zL{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class KL{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class XL{constructor(t,e=0,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class qL{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class iO{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class QL{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class JL{constructor(t,e,s=0){this._data=[t,s,e]}getMessageArray(){return this._data}dispose(){}}class rO{constructor(...t){this._data=[t.length,...t]}getMessageArray(){return this._data}dispose(){}}class $L{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class ZL{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class nO{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class aO{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class tP{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class eP{constructor(t,e,s,i,n,o,l,c,u,h,d,g,E,m,I,p,T,R,S,b,N,P,B,F){this._data=[],this._data.push(t,e,s,i,n,o,l),this._data.push(u.length,...u),this._data.push(h,d,g,E,m,I,p,T,R,S,b,N,P,B,F)}getMessageArray(){return this._data}dispose(){}}class sP{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class ep{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Xn{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class iP{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class rP extends iP{constructor(t){super(t)}}class nP{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class aP extends iP{constructor(t){super(t)}}class WT{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class oP{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class lP{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class cP{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class uP{constructor(t,e,s=""){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class hP{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class oO{constructor(t,e){this._data=[t,e.size*2];for(const[s,i]of e.entries())this._data.push(s,i)}getMessageArray(){return this._data}dispose(){}}class dP{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class _P{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class gP{constructor(t,e,s,i,n){this._data=[t,e,s,i,n]}getMessageArray(){return this._data}dispose(){}}class fP{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class tX{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class eX{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class YT{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class mP{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class EP{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class pP{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class lO{constructor(t,e,s,i,n,o){this._itemId=t,this._category=e,this._wallLocation=s,this._x=i,this._y=n,this._direction=o}getMessageArray(){switch(this._category){case W.FLOOR:return[`${this._itemId} ${this._x} ${this._y} ${this._direction}`];case W.WALL:return[`${this._itemId} ${this._wallLocation} `];default:return[]}}dispose(){}}class Dh{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class IP{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class sX{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class TP{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class RP{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class SP{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class OP{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class uh{constructor(t,e=0){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class CP{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class AP{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class af{constructor(t,e=-100){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class NP{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class xP{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class MP{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class yP{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class cO{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class iX{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class DP{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class rX{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class nX{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class aX{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class bP{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class vP{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class Ah{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class LP{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class zT{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class PP{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class KT{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class UP{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class uO{constructor(t,e,s,i,n,o,l){this._data=[t,e,s,i,n,o,l]}getMessageArray(){return this._data}dispose(){}}class jP{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class wP{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class FP{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class hO{constructor(t,e=0){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class GP{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class BP{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class kP{constructor(t,e,s){this._data=[t+" "+e,s]}getMessageArray(){return this._data}dispose(){}}class VP{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class HP{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class WP{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class YP{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class zP{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class KP{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class dO{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class XP{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class qP{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class QP{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class JP{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}const hd=class hd{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}};hd.STATE_START=0,hd.STATE_CANCEL=1,hd.STATE_ACCEPT=2;let XT=hd;class oX{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class lX{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class cX{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class uX{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class $P{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class ZP{constructor(t,e,s,i,n,o){this._data=[t,e.length,...e,s,i.length,...i,n,o]}getMessageArray(){return this._data}dispose(){}}class tU{constructor(t,e,s,i,n){this._data=[t,e.length,...e,s,i.length,...i,n]}getMessageArray(){return this._data}dispose(){}}class eU{constructor(t,e,s,i,n){this._data=[t,e.length,...e,s,i.length,...i,n]}getMessageArray(){return this._data}dispose(){}}class hX{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class sU{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class iU{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class rU{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class nU{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class aU{constructor(...t){this._data=[t.length].concat(t)}getMessageArray(){return this._data}dispose(){}}class dX{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class _X{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class oU{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class lU{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class gX{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class fX{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class mX{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class EX{constructor(t,e,s,i,n,o,l,c,u,h,d){this._data=[t,e,s,i,n,o,l,c,u,h,d]}getMessageArray(){return this._data}dispose(){}}class cU{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class _O{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class pX{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class IX{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class uU{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class hU{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class dU{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class _U{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class gU{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class gO{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class fO{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class fU{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class mU{constructor(t,e=!0){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class mO{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class TX{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class EU{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class pU{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class qT{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class IU{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class TU{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class RU{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class SU{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class OU{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class RX{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class CU{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class SX{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class AU{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class NU{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class OX extends Fa{constructor(t){super(),this._communication=t,this._handShaking=!1,this._didConnect=!1,this._pongInterval=null,this.onConnectionOpenedEvent=this.onConnectionOpenedEvent.bind(this),this.onConnectionClosedEvent=this.onConnectionClosedEvent.bind(this),this.onConnectionErrorEvent=this.onConnectionErrorEvent.bind(this),this.sendPong=this.sendPong.bind(this)}onInit(){const t=this._communication.connection;t&&(t.addEventListener(fs.CONNECTION_OPENED,this.onConnectionOpenedEvent),t.addEventListener(fs.CONNECTION_CLOSED,this.onConnectionClosedEvent),t.addEventListener(fs.CONNECTION_ERROR,this.onConnectionErrorEvent)),this._communication.registerMessageEvent(new Xx(this.onClientPingEvent.bind(this))),this._communication.registerMessageEvent(new WD(this.onAuthenticatedEvent.bind(this)))}onDispose(){const t=this._communication.connection;t&&(t.removeEventListener(fs.CONNECTION_OPENED,this.onConnectionOpenedEvent),t.removeEventListener(fs.CONNECTION_CLOSED,this.onConnectionClosedEvent),t.removeEventListener(fs.CONNECTION_ERROR,this.onConnectionErrorEvent)),this._handShaking=!1,this.stopPonging(),super.onDispose()}onConnectionOpenedEvent(t){const e=this._communication.connection;e&&(this._didConnect=!0,this.dispatchCommunicationDemoEvent(Us.CONNECTION_ESTABLISHED,e),Dt.getValue("system.pong.manually",!1)&&this.startPonging(),this.startHandshake(e),e.send(new Cv(null,null,null,null)),this.tryAuthentication(e))}onConnectionClosedEvent(t){const e=this._communication.connection;e&&(this.stopPonging(),this._didConnect&&this.dispatchCommunicationDemoEvent(Us.CONNECTION_CLOSED,e))}onConnectionErrorEvent(t){const e=this._communication.connection;e&&(this.stopPonging(),this.dispatchCommunicationDemoEvent(Us.CONNECTION_ERROR,e))}tryAuthentication(t){if(!t||!this.getSSO()){this.getSSO()||dt.error("Login without an SSO ticket is not supported"),this.dispatchCommunicationDemoEvent(Us.CONNECTION_HANDSHAKE_FAILED,t);return}t.send(new xv(this.getSSO(),Pt()))}onClientPingEvent(t){!t||!t.connection||this.sendPong(t.connection)}onAuthenticatedEvent(t){!t||!t.connection||(this.completeHandshake(t.connection),this.dispatchCommunicationDemoEvent(Us.CONNECTION_AUTHENTICATED,t.connection),t.connection.send(new Av))}startHandshake(t){this.dispatchCommunicationDemoEvent(Us.CONNECTION_HANDSHAKING,t),this._handShaking=!0}completeHandshake(t){this.dispatchCommunicationDemoEvent(Us.CONNECTION_HANDSHAKED,t),this._handShaking=!1}startPonging(){this.stopPonging(),this._pongInterval=setInterval(this.sendPong,Dt.getValue("system.pong.interval.ms",2e4))}stopPonging(){this._pongInterval&&(clearInterval(this._pongInterval),this._pongInterval=null)}sendPong(t=null){t=t||this._communication.connection||null,t&&t.send(new Nv)}dispatchCommunicationDemoEvent(t,e){Et.instance.events.dispatchEvent(new Us(t,e))}getSSO(){return Dt.getValue("sso.ticket",null)}}class CX{constructor(){this._events=new Map,this._composers=new Map,this.registerEvents(),this.registerComposers()}registerEvents(){this._events.set(L.BOBBA_CHECK_VIP,nx),this._events.set(L.BOBBA_SOUND_CATEGORIES,ax),this._events.set(L.BOBBA_SOUND_LIST,ox),this._events.set(L.BOBBA_PLAY_SOUND,lx),this._events.set(L.BOBBA_LANGUAGES,cx),this._events.set(L.INTERSTITIAL_MESSAGE,_Y),this._events.set(L.ROOM_AD_ERROR,gY),this._events.set(L.AVAILABILITY_STATUS,ux),this._events.set(L.AVAILABILITY_TIME,fY),this._events.set(L.HOTEL_CLOSED_AND_OPENS,hx),this._events.set(L.HOTEL_CLOSES_AND_OPENS_AT,dx),this._events.set(L.HOTEL_WILL_CLOSE_MINUTES,_x),this._events.set(L.HOTEL_MAINTENANCE,gx),this._events.set(L.USER_CHANGE_NAME,Jd),this._events.set(L.CHECK_USER_NAME,fx),this._events.set(L.USER_FIGURE,xS),this._events.set(L.USER_OUTFITS,mY),this._events.set(L.ADD_BOT_TO_INVENTORY,mx),this._events.set(L.USER_BOTS,Ex),this._events.set(L.BOT_RECEIVED,EY),this._events.set(L.REMOVE_BOT_FROM_INVENTORY,px),this._events.set(L.CFH_SANCTION,Ix),this._events.set(L.CFH_TOPICS,Tx),this._events.set(L.CFH_SANCTION_STATUS,Rx),this._events.set(L.CAMERA_PUBLISH_STATUS,Sx),this._events.set(L.CAMERA_PURCHASE_OK,Ox),this._events.set(L.CAMERA_STORAGE_URL,Cx),this._events.set(L.COMPETITION_STATUS,IY),this._events.set(L.INIT_CAMERA,Ax),this._events.set(L.THUMBNAIL_STATUS,TY),this._events.set(L.CAMERA_SNAPSHOT,pY),this._events.set(L.CAMPAIGN_CALENDAR_DATA,Nx),this._events.set(L.CAMPAIGN_CALENDAR_DOOR_OPENED,xx),this._events.set(L.BONUS_RARE_INFO,Mx),this._events.set(L.BUILDERS_CLUB_FURNI_COUNT,yx),this._events.set(L.BUILDERS_CLUB_SUBSCRIPTION,Dx),this._events.set(L.BUNDLE_DISCOUNT_RULESET,RY),this._events.set(L.CATALOG_PAGE_EXPIRATION,SY),this._events.set(L.CATALOG_PAGE,bx),this._events.set(L.CATALOG_PAGE_LIST,vx),this._events.set(L.CATALOG_EARLIEST_EXPIRY,OY),this._events.set(L.CATALOG_PUBLISHED,Lx),this._events.set(L.CLUB_GIFT_INFO,MS),this._events.set(L.CLUB_GIFT_SELECTED,Px),this._events.set(L.DIRECT_SMS_CLUB_BUY,CY),this._events.set(L.GIFT_RECEIVER_NOT_FOUND,Ux),this._events.set(L.GIFT_WRAPPER_CONFIG,jx),this._events.set(L.CLUB_EXTENDED_OFFER,NY),this._events.set(L.CLUB_OFFERS,wx),this._events.set(L.IS_OFFER_GIFTABLE,xY),this._events.set(L.LIMITED_SOLD_OUT,Fx),this._events.set(L.LIMITED_OFFER_APPEARING_NEXT,MY),this._events.set(L.NOT_ENOUGH_BALANCE,yY),this._events.set(L.PRODUCT_OFFER,Gx),this._events.set(L.CATALOG_PURCHASE_ERROR,Bx),this._events.set(L.CATALOG_PURCHASE_NOT_ALLOWED,kx),this._events.set(L.CATALOG_PURCHASE_OK,Vx),this._events.set(L.ROOM_AD_PURCHASE,Hx),this._events.set(L.SEASONAL_CALENDAR_OFFER,DY),this._events.set(L.CATALOG_RECEIVE_PET_BREEDS,Wx),this._events.set(L.TARGET_OFFER,Yx),this._events.set(L.TARGET_OFFER_NOT_FOUND,bY),this._events.set(L.REDEEM_VOUCHER_ERROR,zx),this._events.set(L.REDEEM_VOUCHER_OK,Kx),this._events.set(L.CLIENT_PING,Xx),this._events.set(L.COMPETITION_ENTRY_SUBMIT,vY),this._events.set(L.COMPETITION_VOTING_INFO,LY),this._events.set(L.COMPETITION_TIMING_CODE,PY),this._events.set(L.COMPETITION_USER_PART_OF,UY),this._events.set(L.COMPETITION_NO_OWNED_ROOMS,jY),this._events.set(L.COMPETITION_SECONDS_UNTIL,wY),this._events.set(L.CRAFTABLE_PRODUCTS,qx),this._events.set(L.CRAFTING_RECIPE,Qx),this._events.set(L.CRAFTING_RECIPES_AVAILABLE,Jx),this._events.set(L.CRAFTING_RESULT,$x),this._events.set(L.DESKTOP_VIEW,$d),this._events.set(L.MESSENGER_ACCEPT_FRIENDS,FY),this._events.set(L.MESSENGER_FIND_FRIENDS,GY),this._events.set(L.MESSENGER_FOLLOW_FAILED,BY),this._events.set(L.MESSENGER_FRIENDS,Zx),this._events.set(L.MESSENGER_UPDATE,tM),this._events.set(L.MESSENGER_FRIEND_NOTIFICATION,kY),this._events.set(L.MESSENGER_REQUESTS,eM),this._events.set(L.MESSENGER_SEARCH,sM),this._events.set(L.MESSENGER_INSTANCE_MESSAGE_ERROR,VY),this._events.set(L.MESSENGER_MESSAGE_ERROR,HY),this._events.set(L.MESSENGER_INIT,iM),this._events.set(L.MESSENGER_MINIMAIL_NEW,WY),this._events.set(L.MESSENGER_MINIMAIL_COUNT,YY),this._events.set(L.MESSENGER_CHAT,yS),this._events.set(L.MESSENGER_REQUEST,DS),this._events.set(L.MESSENGER_INVITE_ERROR,rM),this._events.set(L.MESSENGER_INVITE,bS),this._events.set(L.ACHIEVEMENTRESOLUTIONCOMPLETED,$Y),this._events.set(L.ACHIEVEMENTRESOLUTIONPROGRESS,ZY),this._events.set(L.ACHIEVEMENTRESOLUTIONS,tz),this._events.set(L.LOAD_GAME_URL,vS),this._events.set(L.LOADGAME,az),this._events.set(L.UNLOADGAME,oz),this._events.set(L.GAME_CENTER_GAME_LIST,aM),this._events.set(L.GAMESTATUSMESSAGE,oM),this._events.set(L.GAME_CENTER_ACHIEVEMENTS,lz),this._events.set(L.GAME_CENTER_STATUS,nM),this._events.set(L.GAME_CENTER_IN_ARENA_QUEUE,KY),this._events.set(L.GAME_CENTER_STOP_COUNTER,QY),this._events.set(L.GAME_CENTER_USER_LEFT_GAME,JY),this._events.set(L.GAME_CENTER_DIRECTORY_STATUS,zY),this._events.set(L.GAME_CENTER_STARTING_GAME_FAILED,qY),this._events.set(L.GAME_CENTER_JOINING_FAILED,XY),this._events.set(L.GAMEACHIEVEMENTS,ez),this._events.set(L.GAMEINVITE,sz),this._events.set(L.JOINEDQUEUEMESSAGE,iz),this._events.set(L.JOININGQUEUEFAILED,rz),this._events.set(L.LEFTQUEUE,nz),this._events.set(L.WEEKLY_GAME_REWARD,_z),this._events.set(L.WEEKLY_GAME_REWARD_WINNERS,gz),this._events.set(L.WEEKLY_COMPETITIVE_LEADERBOARD,dz),this._events.set(L.WEEKLY_COMPETITIVE_FRIENDS_LEADERBOARD,hz),this._events.set(L.WEEKLY_GAME2_FRIENDS_LEADERBOARD,cz),this._events.set(L.WEEKLY_GAME2_LEADERBOARD,uz),this._events.set(L.GROUP_INFO,ph),this._events.set(L.GROUP_MEMBER_REMOVE_CONFIRM,cM),this._events.set(L.GROUP_MEMBERS,uM),this._events.set(L.GROUP_CREATE_OPTIONS,lM),this._events.set(L.GROUP_BADGE_PARTS,LS),this._events.set(L.GROUP_SETTINGS,dM),this._events.set(L.GROUP_PURCHASED,hM),this._events.set(L.GROUP_BADGES,rb),this._events.set(L.GROUP_DEACTIVATE,_M),this._events.set(L.GROUP_MEMBERSHIP_REQUESTED,n3),this._events.set(L.GROUP_DETAILS_CHANGED,r3),this._events.set(L.GROUP_HABBO_JOIN_FAILED,l3),this._events.set(L.GROUP_FORUM_DATA,pz),this._events.set(L.GROUP_FORUM_LIST,Iz),this._events.set(L.GROUP_FORUM_THREADS,Tz),this._events.set(L.GROUP_FORUM_POST,Rz),this._events.set(L.GROUP_FORUM_POST_THREAD,Sz),this._events.set(L.GROUP_FORUM_THREAD_MESSAGES,Oz),this._events.set(L.GROUP_FORUM_UNREAD_COUNT,Cz),this._events.set(L.GROUP_FORUM_UPDATE_MESSAGE,Az),this._events.set(L.GROUP_FORUM_UPDATE_THREAD,Nz),this._events.set(L.CFH_DISABLED_NOTIFY,fM),this._events.set(L.CFH_PENDING_CALLS_DELETED,mM),this._events.set(L.CFH_PENDING_CALLS,EM),this._events.set(L.CFH_REPLY,pM),this._events.set(L.CFH_RESULT_MESSAGE,IM),this._events.set(L.GUIDE_ON_DUTY_STATUS,TM),this._events.set(L.GUIDE_SESSION_ATTACHED,RM),this._events.set(L.GUIDE_SESSION_DETACHED,SM),this._events.set(L.GUIDE_SESSION_ENDED,PS),this._events.set(L.GUIDE_SESSION_ERROR,US),this._events.set(L.GUIDE_SESSION_INVITED_TO_GUIDE_ROOM,OM),this._events.set(L.GUIDE_SESSION_MESSAGE,CM),this._events.set(L.GUIDE_SESSION_PARTNER_IS_TYPING,AM),this._events.set(L.GUIDE_SESSION_REQUESTER_ROOM,NM),this._events.set(L.GUIDE_SESSION_STARTED,jS),this._events.set(L.GUIDE_TICKET_CREATION_RESULT,wz),this._events.set(L.GUIDE_TICKET_RESOLUTION,Fz),this._events.set(L.GUIDE_REPORTING_STATUS,jz),this._events.set(L.HOTEL_MERGE_NAME_CHANGE,Gz),this._events.set(L.ISSUE_CLOSE_NOTIFICATION,xM),this._events.set(L.QUIZ_DATA,Bz),this._events.set(L.QUIZ_RESULTS,kz),this._events.set(L.CHAT_REVIEW_SESSION_DETACHED,bz),this._events.set(L.CHAT_REVIEW_SESSION_OFFERED_TO_GUIDE,vz),this._events.set(L.CHAT_REVIEW_SESSION_RESULTS,Lz),this._events.set(L.CHAT_REVIEW_SESSION_STARTED,Pz),this._events.set(L.CHAT_REVIEW_SESSION_VOTING_STATUS,Uz),this._events.set(L.ACHIEVEMENT_PROGRESSED,MM),this._events.set(L.ACHIEVEMENT_LIST,yM),this._events.set(L.USER_ACHIEVEMENT_SCORE,DM),this._events.set(L.USER_EFFECT_ACTIVATE,Vz),this._events.set(L.USER_EFFECT_LIST_ADD,Hz),this._events.set(L.USER_EFFECT_LIST_REMOVE,Wz),this._events.set(L.USER_EFFECT_LIST,zz),this._events.set(L.AVATAR_EFFECT_SELECTED,Yz),this._events.set(L.USER_BADGES,vM),this._events.set(L.USER_BADGES_ADD,bM),this._events.set(L.BADGE_POINT_LIMITS,wS),this._events.set(L.BADGE_REQUEST_FULFILLED,Kz),this._events.set(L.USER_CLOTHING,LM),this._events.set(L.USER_FURNITURE_ADD,FS),this._events.set(L.USER_FURNITURE,Wg),this._events.set(L.USER_FURNITURE_REFRESH,PM),this._events.set(L.USER_FURNITURE_REMOVE,GS),this._events.set(L.USER_FURNITURE_POSTIT_PLACED,UM),this._events.set(L.USER_PETS,FM),this._events.set(L.USER_PET_REMOVE,BM),this._events.set(L.USER_PET_ADD,wM),this._events.set(L.PET_RECEIVED,GM),this._events.set(L.PET_PLACING_ERROR,Hy),this._events.set(L.YOUTUBE_CONTROL_VIDEO,RD),this._events.set(L.YOUTUBE_DISPLAY_PLAYLISTS,SD),this._events.set(L.YOUTUBE_DISPLAY_VIDEO,OD),this._events.set(L.TRADE_ACCEPTED,kM),this._events.set(L.TRADE_CLOSED,VM),this._events.set(L.TRADE_COMPLETED,HM),this._events.set(L.TRADE_CONFIRMATION,WM),this._events.set(L.TRADE_LIST_ITEM,YM),this._events.set(L.TRADE_NOT_OPEN,zM),this._events.set(L.TRADE_OPEN_FAILED,XM),this._events.set(L.TRADE_OPEN,KM),this._events.set(L.TRADE_OTHER_NOT_ALLOWED,qM),this._events.set(L.TRADE_YOU_NOT_ALLOWED,QM),this._events.set(L.TRADE_NO_SUCH_ITEM,Jz),this._events.set(L.COMMUNITY_GOAL_VOTE_EVENT,$z),this._events.set(L.PROMO_ARTICLES,JM),this._events.set(L.MARKETPLACE_AFTER_ORDER_STATUS,$M),this._events.set(L.MARKETPLACE_CANCEL_SALE,ZM),this._events.set(L.MARKETPLACE_SELL_ITEM,Zz),this._events.set(L.MARKETPLACE_CONFIG,ty),this._events.set(L.MARKETPLACE_ITEM_STATS,t5),this._events.set(L.MARKETPLACE_ITEM_POSTED,ey),this._events.set(L.MARKETPLACE_ITEMS_SEARCHED,sy),this._events.set(L.MARKETPLACE_OWN_ITEMS,iy),this._events.set(L.USER_BANNED,Ey),this._events.set(L.MODERATION_CAUTION,cy),this._events.set(L.MODTOOL_ROOM_INFO,dy),this._events.set(L.MODTOOL_USER_CHATLOG,py),this._events.set(L.MODTOOL_ROOM_CHATLOG,fy),this._events.set(L.MODERATION_USER_INFO,gy),this._events.set(L.MODERATION_TOOL,uy),this._events.set(L.MODTOOL_VISITED_ROOMS_USER,my),this._events.set(L.CFH_CHATLOG,ry),this._events.set(L.ISSUE_DELETED,ny),this._events.set(L.ISSUE_INFO,ay),this._events.set(L.ISSUE_PICK_FAILED,oy),this._events.set(L.MODERATOR_ACTION_RESULT,ly),this._events.set(L.MODERATOR_MESSAGE,hy),this._events.set(L.MODERATOR_TOOL_PREFERENCES,_y),this._events.set(L.MYSTERY_BOX_KEYS,Ry),this._events.set(L.GOTMYSTERYBOXPRIZEMESSAGE,Ty),this._events.set(L.CANCELMYSTERYBOXWAITMESSAGE,Iy),this._events.set(L.SHOWMYSTERYBOXWAITMESSAGE,Sy),this._events.set(L.CAN_CREATE_ROOM,e5),this._events.set(L.CAN_CREATE_ROOM_EVENT,Oy),this._events.set(L.CATEGORIES_WITH_VISITOR_COUNT,s5),this._events.set(L.COMPETITION_ROOMS_DATA,i5),this._events.set(L.CONVERTED_ROOM_ID,r5),this._events.set(L.ROOM_DOORBELL,BS),this._events.set(L.USER_FAVORITE_ROOM,n5),this._events.set(L.USER_FAVORITE_ROOM_COUNT,a5),this._events.set(L.ROOM_DOORBELL_REJECTED,Yg),this._events.set(L.ROOM_CREATED,Cy),this._events.set(L.ROOM_INFO,po),this._events.set(L.GUEST_ROOM_SEARCH_RESULT,o5),this._events.set(L.USER_HOME_ROOM,Ay),this._events.set(L.ROOM_EVENT_CANCEL,_5),this._events.set(L.ROOM_EVENT,yy),this._events.set(L.ROOM_INFO_UPDATED,by),this._events.set(L.THUMBNAIL_UPDATE_RESULT,g5),this._events.set(L.NAVIGATOR_EVENT_CATEGORIES,vy),this._events.set(L.NAVIGATOR_CATEGORIES,Ly),this._events.set(L.NAVIGATOR_COLLAPSED,l5),this._events.set(L.NAVIGATOR_LIFTED,c5),this._events.set(L.NAVIGATOR_METADATA,Ny),this._events.set(L.NAVIGATOR_OPEN_ROOM_CREATOR,xy),this._events.set(L.NAVIGATOR_SEARCHES,u5),this._events.set(L.NAVIGATOR_SEARCH,My),this._events.set(L.NAVIGATOR_SETTINGS,h5),this._events.set(L.BOBBA_TABLE_ALERT,zy),this._events.set(L.GENERIC_ALERT,Fy),this._events.set(L.MOTD_MESSAGES,By),this._events.set(L.NOTIFICATION_LIST,ky),this._events.set(L.UNSEEN_ITEMS,Yy),this._events.set(L.ACHIEVEMENT_NOTIFICATION,Py),this._events.set(L.INFO_FEED_ENABLE,Gy),this._events.set(L.CLUB_GIFT_NOTIFICATION,jy),this._events.set(L.ACTIVITY_POINT_NOTIFICATION,kS),this._events.set(L.BOT_ERROR,Uy),this._events.set(L.PET_LEVEL_NOTIFICATION,Vy),this._events.set(L.NOTIFICATION_OFFER_REWARD_DELIVERED,m5),this._events.set(L.NOTIFICATION_SIMPLE_ALERT,Wy),this._events.set(L.NOTIFICATION_ELEMENT_POINTER,f5),this._events.set(L.USER_PERKS,VS),this._events.set(L.PET_TRAINING_PANEL,Jy),this._events.set(L.PET_LEVEL_UPDATE,qy),this._events.set(L.PET_SCRATCH_FAILED,Qy),this._events.set(L.PET_OPEN_PACKAGE_REQUESTED,Ky),this._events.set(L.PET_OPEN_PACKAGE_RESULT,Xy),this._events.set(L.PET_BREEDING_RESULT,AD),this._events.set(L.QUESTION,sD),this._events.set(L.POLL_CONTENTS,$y),this._events.set(L.POLL_ERROR,Zy),this._events.set(L.POLL_OFFER,tD),this._events.set(L.POLL_START_ROOM,nD),this._events.set(L.QUESTION_ANSWERED,eD),this._events.set(L.QUESTION_FINISHED,iD),this._events.set(L.POLL_ROOM_RESULT,rD),this._events.set(L.COMMUNITY_GOAL_EARNED_PRIZES,N5),this._events.set(L.COMMUNITY_GOAL_PROGRESS,x5),this._events.set(L.CONCURRENT_USERS_GOAL_PROGRESS,M5),this._events.set(L.QUEST_DAILY,v5),this._events.set(L.QUEST_CANCELLED,D5),this._events.set(L.QUEST_COMPLETED,b5),this._events.set(L.COMMUNITY_GOAL_HALL_OF_FAME,aD),this._events.set(L.EPIC_POPUP,y5),this._events.set(L.SEASONAL_QUESTS,U5),this._events.set(L.QUESTS,P5),this._events.set(L.QUEST,L5),this._events.set(L.ROOM_ENTER_ERROR,oD),this._events.set(L.ROOM_ENTER,Kg),this._events.set(L.ROOM_FORWARD,lD),this._events.set(L.ROOM_DOORBELL_ACCEPTED,zg),this._events.set(L.ROOM_RIGHTS_CLEAR,eT),this._events.set(L.ROOM_RIGHTS_OWNER,iT),this._events.set(L.ROOM_RIGHTS,sT),this._events.set(L.BOT_COMMAND_CONFIGURATION,cD),this._events.set(L.BOT_SKILL_LIST_UPDATE,w5),this._events.set(L.BOT_FORCE_OPEN_CONTEXT_MENU,j5),this._events.set(L.ROOM_SETTINGS_CHAT,uD),this._events.set(L.ROOM_INFO_OWNER,HS),this._events.set(L.ROOM_SCORE,hD),this._events.set(L.ROOM_ROLLING,nT),this._events.set(L.FURNITURE_FLOOR_ADD,oT),this._events.set(L.FURNITURE_FLOOR,lT),this._events.set(L.FURNITURE_FLOOR_REMOVE,cT),this._events.set(L.FURNITURE_FLOOR_UPDATE,uT),this._events.set(L.ITEM_WALL_ADD,fT),this._events.set(L.ITEM_WALL,mT),this._events.set(L.ITEM_WALL_REMOVE,ET),this._events.set(L.ITEM_WALL_UPDATE,pT),this._events.set(L.FURNITURE_ALIASES,hT),this._events.set(L.FURNITURE_DATA,dT),this._events.set(L.FURNITURE_ITEMDATA,_T),this._events.set(L.ITEM_STACK_HELPER,gD),this._events.set(L.FURNITURE_STATE,gT),this._events.set(L.ITEM_DIMMER_SETTINGS,TD),this._events.set(L.FURNITURE_STATE_2,aT),this._events.set(L.LOVELOCK_FURNI_FINISHED,mD),this._events.set(L.LOVELOCK_FURNI_FRIEND_COMFIRMED,ED),this._events.set(L.LOVELOCK_FURNI_START,pD),this._events.set(L.OBJECTS_DATA_UPDATE,rT),this._events.set(L.FURNITURE_GROUP_CONTEXT_MENU_INFO,fD),this._events.set(L.FURNITURE_POSTIT_STICKY_POLE_OPEN,ID),this._events.set(L.ROOM_SPECTATOR,DD),this._events.set(L.CUSTOM_USER_NOTIFICATION,_D),this._events.set(L.ROOM_MESSAGE_NOTIFICATION,V5),this._events.set(L.ROOM_POPULAR_TAGS_RESULT,d5),this._events.set(L.ROOM_RIGHTS_LIST,kD),this._events.set(L.ROOM_RIGHTS_LIST_ADD,GD),this._events.set(L.ROOM_RIGHTS_LIST_REMOVE,BD),this._events.set(L.ROOM_BAN_LIST,FD),this._events.set(L.ROOM_SETTINGS_SAVE_ERROR,HD),this._events.set(L.ROOM_SETTINGS,VD),this._events.set(L.ROOM_SETTINGS_SAVE,q5),this._events.set(L.ROOM_SETTINGS_ERROR,X5),this._events.set(L.SHOW_ENFORCE_ROOM_CATEGORY,Q5),this._events.set(L.ROOM_BAN_REMOVE,J5),this._events.set(L.ROOM_MUTED,z5),this._events.set(L.NO_SUCH_FLAT,K5),this._events.set(L.FAVORITE_GROUP_UDPATE,dD),this._events.set(L.ROOM_MODEL_DOOR,qg),this._events.set(L.ROOM_HEIGHT_MAP,IT),this._events.set(L.ROOM_HEIGHT_MAP_UPDATE,TT),this._events.set(L.ROOM_MODEL,Xg),this._events.set(L.ROOM_MODEL_NAME,oh),this._events.set(L.ROOM_PAINT,RT),this._events.set(L.ROOM_THICKNESS,Qg),this._events.set(L.ROOM_GET_FILTER_WORDS,Dy),this._events.set(L.ROOM_MODEL_BLOCKED_TILES,CD),this._events.set(L.PET_FIGURE_UPDATE,Jg),this._events.set(L.PET_INFO,xD),this._events.set(L.PET_STATUS,MD),this._events.set(L.PET_EXPERIENCE,ND),this._events.set(L.PLAYING_GAME,yD),this._events.set(L.UNIT_DANCE,tf),this._events.set(L.UNIT_EFFECT,OT),this._events.set(L.UNIT,ef),this._events.set(L.UNIT_EXPRESSION,CT),this._events.set(L.UNIT_HAND_ITEM,AT),this._events.set(L.UNIT_IDLE,NT),this._events.set(L.UNIT_INFO,sf),this._events.set(L.UNIT_NUMBER,xT),this._events.set(L.UNIT_REMOVE,rf),this._events.set(L.UNIT_STATUS,MT),this._events.set(L.HAND_ITEM_RECEIVED,LD),this._events.set(L.FLOOD_CONTROL,bD),this._events.set(L.REMAINING_MUTE,vD),this._events.set(L.UNIT_CHAT,WS),this._events.set(L.UNIT_CHAT_SHOUT,$g),this._events.set(L.UNIT_CHAT_WHISPER,Zg),this._events.set(L.UNIT_TYPING,ST),this._events.set(L.WIRED_ACTION,PD),this._events.set(L.WIRED_CONDITION,UD),this._events.set(L.WIRED_TRIGGER,jD),this._events.set(L.WIRED_OPEN,W5),this._events.set(L.WIRED_REWARD,yT),this._events.set(L.WIRED_SAVE,wD),this._events.set(L.WIRED_ERROR,Y5),this._events.set(L.AUTHENTICATED,WD),this._events.set(L.JUKEBOX_PLAYLIST_FULL,YD),this._events.set(L.JUKEBOX_SONG_DISKS,zD),this._events.set(L.NOW_PLAYING,KD),this._events.set(L.OFFICIAL_SONG_ID,XD),this._events.set(L.PLAYLIST,$5),this._events.set(L.PLAYLIST_SONG_ADDED,Z5),this._events.set(L.TRAX_SONG_INFO,qD),this._events.set(L.USER_SONG_DISKS_INVENTORY,QD),this._events.set(L.HELPER_TALENT_TRACK,s3),this._events.set(L.TALENT_TRACK_LEVEL,e3),this._events.set(L.TALENT_TRACK_LEVEL_UP,t3),this._events.set(L.IN_CLIENT_LINK,ab),this._events.set(L.USER_IGNORED,nb),this._events.set(L.USER_IGNORED_RESULT,qS),this._events.set(L.USER_RESPECT,QS),this._events.set(L.USER_PERMISSIONS,YS),this._events.set(L.USER_BADGES_CURRENT,KS),this._events.set(L.USER_INFO,lh),this._events.set(L.UNIT_CHANGE_NAME,$E),this._events.set(L.USER_SETTINGS,XS),this._events.set(L.USER_PROFILE,ZD),this._events.set(L.MESSENGER_RELATIONSHIPS,zS),this._events.set(L.GIFT_OPENED,jM),this._events.set(L.USER_CREDITS,ob),this._events.set(L.USER_CURRENCY,lb),this._events.set(L.USER_SUBSCRIPTION,cb),this._events.set(L.USER_WARDROBE_PAGE,_b),this._events.set(L.USER_CLASSIFICATION,u3),this._events.set(L.GET_USER_TAGS,tb),this._events.set(L.SCR_SEND_KICKBACK_INFO,db),this._events.set(L.PET_RESPECTED,ub),this._events.set(L.PET_SUPPLEMENT,hb),this._events.set(L.ACCOUNT_SAFETY_LOCK_STATUS_CHANGE,JD),this._events.set(L.GENERIC_ERROR,Hg),this._events.set(L.GROUP_LIST,ib),this._events.set(L.CATALOG_APPROVE_NAME_RESULT,$D),this._events.set(L.CONNECTION_ERROR,wy),this._events.set(L.GUILD_EDIT_FAILED,a3),this._events.set(L.GUILD_MEMBER_MGMT_FAILED,o3),this._events.set(L.EXTENDED_PROFILE_CHANGED,sb),this._events.set(L.NOOBNESS_LEVEL,gM),this._events.set(L.DISCONNECT_REASON,Mz),this._events.set(L.HANDSHAKE_INIT_DIFFIE,Dz),this._events.set(L.HANDSHAKE_COMPLETE_DIFFIE,xz),this._events.set(L.HANDSHAKE_IDENTITY_ACCOUNT,yz),this._events.set(L.NEW_USER_EXPERIENCE_GIFT_OFFER,S5),this._events.set(L.NEW_USER_EXPERIENCE_NOT_COMPLETE,C5),this._events.set(L.RESTORE_CLIENT,E5),this._events.set(L.FIREWORK_CHARGE_DATA,AY),this._events.set(L.PHONE_COLLECTION_STATE,fz),this._events.set(L.PHONE_TRY_NUMBER_RESULT,mz),this._events.set(L.PHONE_TRY_VERIFICATION_CODE_RESULT,Ez),this._events.set(L.WELCOME_GIFT_CHANGE_EMAIL_RESULT,c3),this._events.set(L.WELCOME_GIFT_STATUS,H5),this._events.set(L.RENTABLE_SPACE_RENT_OK,B5),this._events.set(L.RENTABLE_SPACE_STATUS,k5),this._events.set(L.RENTABLE_SPACE_RENT_FAILED,G5),this._events.set(L.RECYCLER_STATUS,tT),this._events.set(L.RECYCLER_FINISHED,ZI),this._events.set(L.EMAIL_STATUS,eb),this._events.set(L.CHANGE_EMAIL_RESULT,i3),this._events.set(L.RENTABLE_FURNI_RENT_OR_BUYOUT_OFFER,F5)}registerComposers(){this._composers.set(D.BOBBA_PLAY_SOUND,gb),this._composers.set(D.BOBBA_SET_LANGUAGE,fb),this._composers.set(D.AUTHENTICATION,IK),this._composers.set(D.INTERSTITIAL_SHOWN,d3),this._composers.set(D.GET_INTERSTITIAL,h3),this._composers.set(D.GET_WARDROBE,Ib),this._composers.set(D.SAVE_WARDROBE_OUTFIT,Tb),this._composers.set(D.CHANGE_USERNAME,Eb),this._composers.set(D.CHECK_USERNAME,pb),this._composers.set(D.REQUEST_CAMERA_CONFIGURATION,Ob),this._composers.set(D.RENDER_ROOM,nf),this._composers.set(D.RENDER_ROOM_THUMBNAIL,bT),this._composers.set(D.PURCHASE_PHOTO,Sb),this._composers.set(D.PUBLISH_PHOTO,Rb),this._composers.set(D.PHOTO_COMPETITION,_3),this._composers.set(D.OPEN_CAMPAIGN_CALENDAR_DOOR,Ab),this._composers.set(D.OPEN_CAMPAIGN_CALENDAR_DOOR_STAFF,Cb),this._composers.set(D.BUILDERS_CLUB_PLACE_ROOM_ITEM,Nb),this._composers.set(D.BUILDERS_CLUB_PLACE_WALL_ITEM,xb),this._composers.set(D.BUILDERS_CLUB_QUERY_FURNI_COUNT,Mb),this._composers.set(D.GET_CATALOG_INDEX,Db),this._composers.set(D.GET_CATALOG_PAGE,bb),this._composers.set(D.CATALOG_PURCHASE,R_),this._composers.set(D.CATALOG_PURCHASE_GIFT,wb),this._composers.set(D.GET_PRODUCT_OFFER,Pb),this._composers.set(D.GET_CLUB_OFFERS,vb),this._composers.set(D.GET_CLUB_GIFT_INFO,JS),this._composers.set(D.CATALOG_REDEEM_VOUCHER,Bb),this._composers.set(D.GROUP_MEMBERSHIPS,_O),this._composers.set(D.GET_GIFT_WRAPPING_CONFIG,Lb),this._composers.set(D.CATALOG_SELECT_VIP_GIFT,kb),this._composers.set(D.CATALOG_REQUESET_PET_BREEDS,jb),this._composers.set(D.GET_BONUS_RARE_INFO,yb),this._composers.set(D.GET_BUNDLE_DISCOUNT_RULESET,g3),this._composers.set(D.GET_CATALOG_PAGE_EXPIRATION,f3),this._composers.set(D.GET_CATALOG_PAGE_WITH_EARLIEST_EXP,m3),this._composers.set(D.GET_DIRECT_CLUB_BUY_AVAILABLE,E3),this._composers.set(D.GET_HABBO_BASIC_MEMBERSHIP_EXTEND_OFFER,p3),this._composers.set(D.GET_HABBO_CLUB_EXTEND_OFFER,I3),this._composers.set(D.GET_IS_OFFER_GIFTABLE,T3),this._composers.set(D.GET_LIMITED_OFFER_APPEARING_NEXT,R3),this._composers.set(D.GET_NEXT_TARGETED_OFFER,S3),this._composers.set(D.GET_ROOM_AD_PURCHASE_INFO,Ub),this._composers.set(D.GET_SEASONAL_CALENDAR_DAILY_OFFER,O3),this._composers.set(D.GET_TARGETED_OFFER,$S),this._composers.set(D.MARK_CATALOG_NEW_ADDITIONS_PAGE_OPENED,C3),this._composers.set(D.PURCHASE_BASIC_MEMBERSHIP_EXTENSION,A3),this._composers.set(D.PURCHASE_ROOM_AD,Fb),this._composers.set(D.PURCHASE_TARGETED_OFFER,Gb),this._composers.set(D.PURCHASE_VIP_MEMBERSHIP_EXTENSION,N3),this._composers.set(D.ROOM_AD_PURCHASE_INITIATED,x3),this._composers.set(D.SET_TARGETTED_OFFER_STATE,M3),this._composers.set(D.SHOP_TARGETED_OFFER_VIEWED,y3),this._composers.set(D.FORWARD_TO_A_COMPETITION_ROOM,D3),this._composers.set(D.FORWARD_TO_A_SUBMITTABLE_ROOM,b3),this._composers.set(D.FORWARD_TO_RANDOM_COMPETITION_ROOM,v3),this._composers.set(D.GET_CURRENT_TIMING_CODE,L3),this._composers.set(D.GET_IS_USER_PART_OF_COMPETITION,P3),this._composers.set(D.GET_SECONDS_UNTIL,U3),this._composers.set(D.ROOM_COMPETITION_INIT,j3),this._composers.set(D.SUBMIT_ROOM_TO_COMPETITION,vT),this._composers.set(D.VOTE_FOR_ROOM,w3),this._composers.set(D.CRAFT,Vb),this._composers.set(D.CRAFT_SECRET,F3),this._composers.set(D.GET_CRAFTABLE_PRODUCTS,Wb),this._composers.set(D.GET_CRAFTING_RECIPE,Hb),this._composers.set(D.GET_CRAFTING_RECIPES_AVAILABLE,G3),this._composers.set(D.FRIEND_FURNI_CONFIRM_LOCK,zb),this._composers.set(D.ACCEPT_FRIEND,Kb),this._composers.set(D.DECLINE_FRIEND,LT),this._composers.set(D.FIND_NEW_FRIENDS,B3),this._composers.set(D.FOLLOW_FRIEND,ZE),this._composers.set(D.FRIEND_LIST_UPDATE,Xb),this._composers.set(D.GET_FRIEND_REQUESTS,qb),this._composers.set(D.HABBO_SEARCH,Qb),this._composers.set(D.MESSENGER_INIT,Jb),this._composers.set(D.REMOVE_FRIEND,$b),this._composers.set(D.REQUEST_FRIEND,ZS),this._composers.set(D.MESSENGER_CHAT,Zb),this._composers.set(D.SEND_ROOM_INVITE,tv),this._composers.set(D.SET_RELATIONSHIP_STATUS,tu),this._composers.set(D.VISIT_USER,k3),this._composers.set(D.ACHIEVEMENT_RESOLUTION_OPEN,nv),this._composers.set(D.ACCEPTGAMEINVITE,K3),this._composers.set(D.GAMEUNLOADEDMESSAGE,X3),this._composers.set(D.GETGAMEACHIEVEMENTSMESSAGE,q3),this._composers.set(D.GAMES_LIST,iv),this._composers.set(D.GETGAMESTATUSMESSAGE,rv),this._composers.set(D.GETUSERGAMEACHIEVEMENTSMESSAGE,Q3),this._composers.set(D.JOINQUEUEMESSAGE,av),this._composers.set(D.LEAVEQUEUEMESSAGE,J3),this._composers.set(D.RESETRESOLUTIONACHIEVEMENTMESSAGE,$3),this._composers.set(D.GAMES_INIT,eK),this._composers.set(D.GETWEEKLYGAMEREWARDWINNERS,sK),this._composers.set(D.GAME2GETACCOUNTGAMESTATUSMESSAGE,sv),this._composers.set(D.GAME2CHECKGAMEDIRECTORYSTATUSMESSAGE,Y3),this._composers.set(D.GAME2EXITGAMEMESSAGE,ev),this._composers.set(D.GAME2GAMECHATMESSAGE,V3),this._composers.set(D.GAME2LOADSTAGEREADYMESSAGE,H3),this._composers.set(D.GAME2PLAYAGAINMESSAGE,W3),this._composers.set(D.GAME2REQUESTFULLSTATUSUPDATEMESSAGE,z3),this._composers.set(D.GAME2GETWEEKLYFRIENDSLEADERBOARD,Z3),this._composers.set(D.GAME2GETWEEKLYLEADERBOARD,tK),this._composers.set(D.GET_GIFT,PT),this._composers.set(D.RESET_PHONE_NUMBER_STATE,iK),this._composers.set(D.SET_PHONE_NUMBER_VERIFICATION_STATUS,UT),this._composers.set(D.TRY_PHONE_NUMBER,rK),this._composers.set(D.VERIFY_CODE,nK),this._composers.set(D.GET_FORUM_STATS,lK),this._composers.set(D.GET_FORUMS_LIST,oK),this._composers.set(D.GET_FORUM_MESSAGES,cK),this._composers.set(D.GET_FORUM_THREAD,uK),this._composers.set(D.GET_FORUM_THREADS,hK),this._composers.set(D.GET_UNREAD_FORUMS_COUNT,dK),this._composers.set(D.FORUM_MODERATE_MESSAGE,_K),this._composers.set(D.FORUM_MODERATE_THREAD,gK),this._composers.set(D.FORUM_POST_MESSAGE,fK),this._composers.set(D.UPDATE_FORUM_READ_MARKER,mK),this._composers.set(D.UPDATE_FORUM_SETTINGS,EK),this._composers.set(D.FORUM_UPDATE_THREAD,pK),this._composers.set(D.CLIENT_PONG,Nv),this._composers.set(D.RELEASE_VERSION,Cv),this._composers.set(D.SECURITY_TICKET,xv),this._composers.set(D.USER_INFO,Av),this._composers.set(D.DISCONNECT,RK),this._composers.set(D.SECURITY_MACHINE,OK),this._composers.set(D.CLIENT_VARIABLES,CK),this._composers.set(D.HANDSHAKE_INIT_DIFFIE,SK),this._composers.set(D.HANDSHAKE_COMPLETE_DIFFIE,TK),this._composers.set(D.CALL_FOR_HELP_FROM_FORUM_MESSAGE,Mv),this._composers.set(D.CALL_FOR_HELP_FROM_FORUM_THREAD,yv),this._composers.set(D.CALL_FOR_HELP_FROM_IM,Dv),this._composers.set(D.CALL_FOR_HELP_FROM_PHOTO,bv),this._composers.set(D.CALL_FOR_HELP_FROM_SELFIE,AK),this._composers.set(D.CALL_FOR_HELP,vv),this._composers.set(D.CHAT_REVIEW_GUIDE_DECIDES,NK),this._composers.set(D.CHAT_REVIEW_GUIDE_DETACHED,xK),this._composers.set(D.CHAT_REVIEW_GUIDE_VOTE,MK),this._composers.set(D.CHAT_REVIEW_SESSION_CREATE,yK),this._composers.set(D.DELETE_PENDING_CALLS_FOR_HELP,Lv),this._composers.set(D.GET_CFH_STATUS,DK),this._composers.set(D.GET_FAQ_CATEGORY,bK),this._composers.set(D.GET_FAQ_TEXT,vK),this._composers.set(D.GET_GUIDE_REPORTING_STATUS,LK),this._composers.set(D.GET_PENDING_CALLS_FOR_HELP,Pv),this._composers.set(D.GET_QUIZ_QUESTIONS,PK),this._composers.set(D.GUIDE_SESSION_CREATE,Uv),this._composers.set(D.GUIDE_SESSION_FEEDBACK,jv),this._composers.set(D.GUIDE_SESSION_GET_REQUESTER_ROOM,wv),this._composers.set(D.GUIDE_SESSION_GUIDE_DECIDES,Fv),this._composers.set(D.GUIDE_SESSION_INVITE_REQUESTER,Gv),this._composers.set(D.GUIDE_SESSION_IS_TYPING,UK),this._composers.set(D.GUIDE_SESSION_MESSAGE,Bv),this._composers.set(D.GUIDE_SESSION_ON_DUTY_UPDATE,wT),this._composers.set(D.GUIDE_SESSION_REPORT,jK),this._composers.set(D.GUIDE_SESSION_REQUESTER_CANCELS,kv),this._composers.set(D.GUIDE_SESSION_RESOLVED,Vv),this._composers.set(D.POST_QUIZ_ANSWERS,wK),this._composers.set(D.SEARCH_FAQS,FK),this._composers.set(D.DESKTOP_VIEW,Yb),this._composers.set(D.GROUP_INFO,ch),this._composers.set(D.GROUP_REQUEST,fv),this._composers.set(D.GROUP_MEMBER_REMOVE_CONFIRM,dv),this._composers.set(D.GROUP_MEMBER_REMOVE,tp),this._composers.set(D.GROUP_MEMBERS,jT),this._composers.set(D.GROUP_ADMIN_ADD,ov),this._composers.set(D.GROUP_ADMIN_REMOVE,lv),this._composers.set(D.GROUP_REQUEST_ACCEPT,mv),this._composers.set(D.GROUP_REQUEST_DECLINE,Ev),this._composers.set(D.GROUP_DELETE,_v),this._composers.set(D.GROUP_CREATE_OPTIONS,hv),this._composers.set(D.GROUP_PARTS,cv),this._composers.set(D.GROUP_BUY,uv),this._composers.set(D.GROUP_SETTINGS,Sv),this._composers.set(D.GROUP_SAVE_BADGE,pv),this._composers.set(D.GROUP_SAVE_COLORS,Iv),this._composers.set(D.GROUP_SAVE_INFORMATION,Tv),this._composers.set(D.GROUP_SAVE_PREFERENCES,Rv),this._composers.set(D.GROUP_FAVORITE,gv),this._composers.set(D.GROUP_UNFAVORITE,Ov),this._composers.set(D.GROUP_BADGES,EU),this._composers.set(D.APPROVE_ALL_MEMBERSHIP_REQUESTS,aK),this._composers.set(D.GROUP_UNBLOCK_MEMBER,RX),this._composers.set(D.ROOM_FAVORITE,t4),this._composers.set(D.CAN_CREATE_ROOM,s4),this._composers.set(D.CANCEL_ROOM_EVENT,e4),this._composers.set(D.CONVERT_GLOBAL_ROOM_ID,SL),this._composers.set(D.COMPETITION_ROOM_SEARCH,i4),this._composers.set(D.ROOM_CREATE,OL),this._composers.set(D.GET_USER_FLAT_CATS,NL),this._composers.set(D.GET_USER_EVENT_CATS,sO),this._composers.set(D.ROOM_FAVORITE_REMOVE,r4),this._composers.set(D.EDIT_ROOM_EVENT,CL),this._composers.set(D.FORWARD_TO_RANDOM_PROMOTED_ROOM,n4),this._composers.set(D.FORWARD_TO_SOME_ROOM,a4),this._composers.set(D.GET_CATEGORIES_WITH_USER_COUNT,o4),this._composers.set(D.GET_GUEST_ROOM,Zd),this._composers.set(D.GET_OFFICIAL_ROOMS,l4),this._composers.set(D.GET_POPULAR_ROOM_TAGS,c4),this._composers.set(D.GUILD_BASE_SEARCH,u4),this._composers.set(D.MY_FAVOURITE_ROOMS_SEARCH,h4),this._composers.set(D.MY_FREQUENT_ROOM_HISTORY_SEARCH,d4),this._composers.set(D.MY_FRIENDS_ROOM_SEARCH,_4),this._composers.set(D.MY_GUILD_BASES_SEARCH,g4),this._composers.set(D.MY_RECOMMENDED_ROOMS,f4),this._composers.set(D.MY_ROOM_HISTORY_SEARCH,m4),this._composers.set(D.MY_ROOM_RIGHTS_SEARCH,E4),this._composers.set(D.MY_ROOMS_SEARCH,p4),this._composers.set(D.POPULAR_ROOMS_SEARCH,A4),this._composers.set(D.ROOM_LIKE,ML),this._composers.set(D.ROOM_RIGHTS_REMOVE_OWN,N4),this._composers.set(D.ROOM_AD_EVENT_TAB_CLICKED,x4),this._composers.set(D.ROOM_AD_EVENT_TAB_VIEWED,M4),this._composers.set(D.ROOM_AD_SEARCH,y4),this._composers.set(D.ROOM_TEXT_SEARCH,v4),this._composers.set(D.ROOMS_WHERE_MY_FRIENDS_ARE,D4),this._composers.set(D.ROOMS_WITH_HIGHEST_SCORE_SEARCH,b4),this._composers.set(D.SET_ROOM_SESSION_TAGS,L4),this._composers.set(D.ROOM_STAFF_PICK,yL),this._composers.set(D.ROOM_FILTER_WORDS,AL),this._composers.set(D.ROOM_FILTER_WORDS_MODIFY,bL),this._composers.set(D.USER_HOME_ROOM,DL),this._composers.set(D.UPDATE_ROOM_THUMBNAIL,P4),this._composers.set(D.NAVIGATOR_INIT,xL),this._composers.set(D.NAVIGATOR_SEARCH_CLOSE,R4),this._composers.set(D.NAVIGATOR_SEARCH,Nc),this._composers.set(D.NAVIGATOR_SEARCH_OPEN,S4),this._composers.set(D.NAVIGATOR_SEARCH_SAVE,O4),this._composers.set(D.NAVIGATOR_SETTINGS_SAVE,C4),this._composers.set(D.NAVIGATOR_CATEGORY_LIST_MODE,I4),this._composers.set(D.NAVIGATOR_DELETE_SAVED_SEARCH,T4),this._composers.set(D.POLL_ANSWER,GL),this._composers.set(D.POLL_REJECT,BL),this._composers.set(D.POLL_START,kL),this._composers.set(D.POLL_VOTE_COUNTER,VL),this._composers.set(D.USER_EFFECT_ACTIVATE,GK),this._composers.set(D.USER_EFFECT_ENABLE,BK),this._composers.set(D.USER_BADGES,Hv),this._composers.set(D.USER_BADGES_CURRENT_UPDATE,Wv),this._composers.set(D.GET_BADGE_POINTS_LIMITS,kK),this._composers.set(D.REQUESTABADGE,HK),this._composers.set(D.GETISBADGEREQUESTFULFILLED,VK),this._composers.set(D.USER_BOTS,FT),this._composers.set(D.USER_FURNITURE,Yv),this._composers.set(D.REQUESTFURNIINVENTORYWHENNOTINROOM,WK),this._composers.set(D.USER_PETS,GT),this._composers.set(D.TRADE_ACCEPT,zv),this._composers.set(D.TRADE_CANCEL,Kv),this._composers.set(D.TRADE_CLOSE,Xv),this._composers.set(D.TRADE_CONFIRM,qv),this._composers.set(D.TRADE_ITEM,BT),this._composers.set(D.TRADE_ITEMS,Qv),this._composers.set(D.TRADE_ITEM_REMOVE,Jv),this._composers.set(D.TRADE,$v),this._composers.set(D.TRADE_UNACCEPT,Zv),this._composers.set(D.UNSEEN_RESET_CATEGORY,tL),this._composers.set(D.UNSEEN_RESET_ITEMS,eL),this._composers.set(D.ACHIEVEMENT_LIST,mb),this._composers.set(D.PET_MOUNT,HT),this._composers.set(D.PET_RESPECT,S_),this._composers.set(D.PET_SUPPLEMENT,j4),this._composers.set(D.REMOVE_PET_SADDLE,PL),this._composers.set(D.PET_INFO,UL),this._composers.set(D.TOGGLE_PET_BREEDING,jL),this._composers.set(D.TOGGLE_PET_RIDING,wL),this._composers.set(D.USE_PET_PRODUCT,FL),this._composers.set(D.GET_PET_TRAINING_PANEL,LL),this._composers.set(D.PET_OPEN_PACKAGE,cO),this._composers.set(D.PET_SELECTED,oX),this._composers.set(D.PETS_BREED,XT),this._composers.set(D.PET_CANCEL_BREEDING,YK),this._composers.set(D.PET_CONFIRM_BREEDING,zK),this._composers.set(D.ROOM_ENTER,YL),this._composers.set(D.ROOM_DOORBELL,WL),this._composers.set(D.GO_TO_FLAT,FP),this._composers.set(D.CHANGE_QUEUE,wP),this._composers.set(D.ROOM_AMBASSADOR_ALERT,KL),this._composers.set(D.ROOM_BAN_GIVE,XL),this._composers.set(D.ROOM_BAN_REMOVE,$L),this._composers.set(D.ROOM_RIGHTS_GIVE,iO),this._composers.set(D.ROOM_KICK,QL),this._composers.set(D.ROOM_MUTE_USER,JL),this._composers.set(D.ROOM_RIGHTS_REMOVE,rO),this._composers.set(D.ROOM_RIGHTS_REMOVE_ALL,zL),this._composers.set(D.ROOM_DELETE,qL),this._composers.set(D.ROOM_SETTINGS,aO),this._composers.set(D.ROOM_SETTINGS_SAVE,eP),this._composers.set(D.ROOM_RIGHTS_LIST,tP),this._composers.set(D.ROOM_BAN_LIST,nO),this._composers.set(D.ROOM_SETTINGS_UPDATE_ROOM_CATEGORY_AND_TRADE,hX),this._composers.set(D.BOT_CONFIGURATION,ZL),this._composers.set(D.GET_ITEM_DATA,nP),this._composers.set(D.REMOVE_WALL_ITEM,cP),this._composers.set(D.BOT_PLACE,sP),this._composers.set(D.BOT_PICKUP,ep),this._composers.set(D.BOT_SKILL_SAVE,Xn),this._composers.set(D.PET_PLACE,oP),this._composers.set(D.PET_MOVE,WT),this._composers.set(D.PET_PICKUP,lP),this._composers.set(D.SET_ITEM_DATA,hP),this._composers.set(D.SET_OBJECT_DATA,oO),this._composers.set(D.COMPOST_PLANT,rP),this._composers.set(D.HARVEST_PET,aP),this._composers.set(D.SET_CLOTHING_CHANGE_DATA,uP),this._composers.set(D.FURNITURE_ALIASES,mP),this._composers.set(D.FURNITURE_GROUP_INFO,EP),this._composers.set(D.FURNITURE_PICKUP,pP),this._composers.set(D.FURNITURE_PLACE,lO),this._composers.set(D.ITEM_PAINT,Dh),this._composers.set(D.FURNITURE_POSTIT_PLACE,IP),this._composers.set(D.FURNITURE_POSTIT_SAVE_STICKY_POLE,dP),this._composers.set(D.CONTROL_YOUTUBE_DISPLAY_PLAYBACK,Ah),this._composers.set(D.GET_YOUTUBE_DISPLAY_STATUS,LP),this._composers.set(D.SET_YOUTUBE_DISPLAY_PLAYLIST,zT),this._composers.set(D.FURNITURE_FLOOR_UPDATE,YT),this._composers.set(D.FURNITURE_WALL_UPDATE,vP),this._composers.set(D.ITEM_DIMMER_SETTINGS,_P),this._composers.set(D.ITEM_DIMMER_SAVE,gP),this._composers.set(D.ITEM_DIMMER_TOGGLE,fP),this._composers.set(D.ROOM_TONER_APPLY,bP),this._composers.set(D.ITEM_COLOR_WHEEL_CLICK,TP),this._composers.set(D.ITEM_DICE_CLICK,RP),this._composers.set(D.ITEM_DICE_CLOSE,SP),this._composers.set(D.FURNITURE_MULTISTATE,uh),this._composers.set(D.FURNITURE_RANDOMSTATE,AP),this._composers.set(D.ITEM_STACK_HELPER,af),this._composers.set(D.FURNITURE_WALL_MULTISTATE,NP),this._composers.set(D.ONE_WAY_DOOR_CLICK,CP),this._composers.set(D.ITEM_EXCHANGE_REDEEM,OP),this._composers.set(D.ITEM_CLOTHING_REDEEM,jP),this._composers.set(D.ROOM_MODEL,KT),this._composers.set(D.GET_OCCUPIED_TILES,PP),this._composers.set(D.GET_ROOM_ENTRY_TILE,UP),this._composers.set(D.ROOM_MODEL_SAVE,uO),this._composers.set(D.UNIT_ACTION,WP),this._composers.set(D.UNIT_DANCE,YP),this._composers.set(D.UNIT_DROP_HAND_ITEM,zP),this._composers.set(D.UNIT_GIVE_HANDITEM,KP),this._composers.set(D.UNIT_GIVE_HANDITEM_PET,dO),this._composers.set(D.UNIT_LOOK,XP),this._composers.set(D.UNIT_SIGN,QP),this._composers.set(D.UNIT_POSTURE,qP),this._composers.set(D.UNIT_WALK,JP),this._composers.set(D.UNIT_CHAT,hO),this._composers.set(D.UNIT_CHAT_SHOUT,GP),this._composers.set(D.USER_SETTINGS_CHAT_STYLE,BP),this._composers.set(D.UNIT_CHAT_WHISPER,kP),this._composers.set(D.UNIT_TYPING,VP),this._composers.set(D.UNIT_TYPING_STOP,HP),this._composers.set(D.WIRED_APPLY_SNAPSHOT,cX),this._composers.set(D.WIRED_OPEN,uX),this._composers.set(D.WIRED_ACTION_SAVE,ZP),this._composers.set(D.WIRED_CONDITION_SAVE,tU),this._composers.set(D.WIRED_TRIGGER_SAVE,eU),this._composers.set(D.ROOM_MUTE,$P),this._composers.set(D.APPROVE_NAME,cU),this._composers.set(D.USER_RESPECT,CU),this._composers.set(D.SCR_GET_KICKBACK_INFO,IU),this._composers.set(D.PEER_USERS_CLASSIFICATION,AU),this._composers.set(D.USER_CLASSIFICATION,NU),this._composers.set(D.USER_IGNORED,uU),this._composers.set(D.USER_IGNORE,dU),this._composers.set(D.USER_IGNORE_ID,_U),this._composers.set(D.USER_UNIGNORE,gU),this._composers.set(D.USER_BADGES_CURRENT,gO),this._composers.set(D.USER_FIGURE,fO),this._composers.set(D.USER_MOTTO,fU),this._composers.set(D.USER_PROFILE,mU),this._composers.set(D.USER_PROFILE_BY_NAME,IX),this._composers.set(D.USER_TAGS,hU),this._composers.set(D.MESSENGER_RELATIONSHIPS,mO),this._composers.set(D.MANNEQUIN_SAVE_NAME,MP),this._composers.set(D.MANNEQUIN_SAVE_LOOK,xP),this._composers.set(D.PRESENT_OPEN_PRESENT,DP),this._composers.set(D.MARKETPLACE_CONFIG,rL),this._composers.set(D.MARKETPLACE_SELL_ITEM,oL),this._composers.set(D.MARKETPLACE_REQUEST_OWN_ITEMS,aL),this._composers.set(D.MARKETPLACE_TAKE_BACK_ITEM,iL),this._composers.set(D.MARKETPLACE_REQUEST_OFFERS,nL),this._composers.set(D.MARKETPLACE_BUY_OFFER,kT),this._composers.set(D.MARKETPLACE_REDEEM_CREDITS,lL),this._composers.set(D.MARKETPLACE_BUY_TOKENS,XK),this._composers.set(D.REQUEST_SELL_ITEM,qK),this._composers.set(D.REQUEST_MARKETPLACE_ITEM_STATS,QK),this._composers.set(D.USER_BOTS,FT),this._composers.set(D.USER_PETS,GT),this._composers.set(D.USER_CURRENCY,pU),this._composers.set(D.USER_SUBSCRIPTION,qT),this._composers.set(D.MODTOOL_REQUEST_ROOM_INFO,hL),this._composers.set(D.MODTOOL_CHANGE_ROOM_SETTINGS,VT),this._composers.set(D.MODTOOL_REQUEST_USER_CHATLOG,fL),this._composers.set(D.MODTOOL_REQUEST_ROOM_CHATLOG,_L),this._composers.set(D.MOD_TOOL_USER_INFO,dL),this._composers.set(D.MODTOOL_SANCTION_ALERT,mL),this._composers.set(D.MODTOOL_SANCTION_BAN,va),this._composers.set(D.MODTOOL_SANCTION_KICK,EL),this._composers.set(D.MODTOOL_SANCTION_TRADELOCK,IL),this._composers.set(D.MODTOOL_ALERTEVENT,tO),this._composers.set(D.MODTOOL_SANCTION_MUTE,pL),this._composers.set(D.MODTOOL_REQUEST_USER_ROOMS,gL),this._composers.set(D.MODTOOL_ROOM_ALERT,hc),this._composers.set(D.CLOSE_ISSUE_DEFAULT_ACTION,JK),this._composers.set(D.CLOSE_ISSUES,uc),this._composers.set(D.DEFAULT_SANCTION,cL),this._composers.set(D.GET_CFH_CHATLOG,uL),this._composers.set(D.MODTOOL_PREFERENCES,$K),this._composers.set(D.MODTOOL_SANCTION,ZK),this._composers.set(D.PICK_ISSUES,TL),this._composers.set(D.RELEASE_ISSUES,eO),this._composers.set(D.MYSTERYBOXWAITINGCANCELEDMESSAGE,RL),this._composers.set(D.MYSTERYBOX_OPEN_TROPHY,yP),this._composers.set(D.USER_SETTINGS_CAMERA,TU),this._composers.set(D.USER_SETTINGS_OLD_CHAT,RU),this._composers.set(D.USER_SETTINGS_INVITES,SU),this._composers.set(D.USER_SETTINGS_VOLUME,OU),this._composers.set(D.COMMUNITY_GOAL_VOTE_COMPOSER,KK),this._composers.set(D.GET_PROMO_ARTICLES,sL),this._composers.set(D.ACCEPT_QUEST,w4),this._composers.set(D.ACTIVATE_QUEST,F4),this._composers.set(D.CANCEL_QUEST,G4),this._composers.set(D.FRIEND_REQUEST_QUEST_COMPLETE,B4),this._composers.set(D.GET_COMMUNITY_GOAL_EARNED_PRIZES,k4),this._composers.set(D.GET_COMMUNITY_GOAL_HALL_OF_FAME,HL),this._composers.set(D.GET_COMMUNITY_GOAL_PROGRESS,V4),this._composers.set(D.GET_CONCURRENT_USERS_GOAL_PROGRESS,H4),this._composers.set(D.GET_CONCURRENT_USERS_REWARD,W4),this._composers.set(D.GET_DAILY_QUEST,Y4),this._composers.set(D.GET_QUESTS,z4),this._composers.set(D.GET_SEASONAL_QUESTS_ONLY,K4),this._composers.set(D.OPEN_QUEST_TRACKER,X4),this._composers.set(D.REDEEM_COMMUNITY_GOAL_PRIZE,q4),this._composers.set(D.REJECT_QUEST,Q4),this._composers.set(D.START_CAMPAIGN,J4),this._composers.set(D.GET_SOUND_SETTINGS,_X),this._composers.set(D.ADD_JUKEBOX_DISK,sU),this._composers.set(D.GET_JUKEBOX_PLAYLIST,iU),this._composers.set(D.GET_NOW_PLAYING,rU),this._composers.set(D.GET_OFFICIAL_SONG_ID,nU),this._composers.set(D.GET_SONG_INFO,aU),this._composers.set(D.GET_SOUND_MACHINE_PLAYLIST,dX),this._composers.set(D.GET_USER_SONG_DISKS,oU),this._composers.set(D.REMOVE_JUKEBOX_DISK,lU),this._composers.set(D.HELPER_TALENT_TRACK,fX),this._composers.set(D.TALENT_TRACK_GET_LEVEL,gX),this._composers.set(D.NEW_USER_EXPERIENCE_GET_GIFTS,U4),this._composers.set(D.NEW_USER_EXPERIENCE_SCRIPT_PROCEED,vL),this._composers.set(D.WELCOME_OPEN_GIFT,iX),this._composers.set(D.WELCOME_GIFT_CHANGE_EMAIL,SX),this._composers.set(D.EMAIL_GET_STATUS,TX),this._composers.set(D.EMAIL_CHANGE,pX),this._composers.set(D.RENTABLE_SPACE_CANCEL_RENT,rX),this._composers.set(D.RENTABLE_SPACE_RENT,nX),this._composers.set(D.RENTABLE_SPACE_STATUS,aX),this._composers.set(D.RECYCLER_STATUS,$4),this._composers.set(D.RECYCLER_ITEMS,Z4),this._composers.set(D.TRACKING_PERFORMANCE_LOG,EX),this._composers.set(D.TRACKING_LAG_WARNING_REPORT,mX),this._composers.set(D.ROOM_DIRECTORY_ROOM_NETWORK_OPEN_CONNECTION,lX),this._composers.set(D.RENTABLE_EXTEND_RENT_OR_BUYOUT_STRIP_ITEM,eX),this._composers.set(D.RENTABLE_EXTEND_RENT_OR_BUYOUT_FURNI,tX),this._composers.set(D.RENTABLE_GET_RENT_OR_BUYOUT_OFFER,sX)}get events(){return this._events}get composers(){return this._composers}}class AX extends Fa{constructor(t){super(),this._communication=t,this._connection=null,this._messages=new CX,this._demo=new OX(this),this.onConnectionOpenedEvent=this.onConnectionOpenedEvent.bind(this),this.onConnectionClosedEvent=this.onConnectionClosedEvent.bind(this),this.onConnectionErrorEvent=this.onConnectionErrorEvent.bind(this),this.onConnectionAuthenticatedEvent=this.onConnectionAuthenticatedEvent.bind(this)}onInit(){this._connection||(Et.instance.events.addEventListener(Us.CONNECTION_AUTHENTICATED,this.onConnectionAuthenticatedEvent),this._connection=this._communication.createConnection(this),this._connection.registerMessages(this._messages),this._connection.addEventListener(fs.CONNECTION_OPENED,this.onConnectionOpenedEvent),this._connection.addEventListener(fs.CONNECTION_CLOSED,this.onConnectionClosedEvent),this._connection.addEventListener(fs.CONNECTION_ERROR,this.onConnectionErrorEvent),this._demo&&this._demo.init(),Dt.getValue("socket.enabled",!1)&&this._connection.init(Dt.getValue("socket.url")),Dt.getValue("signalr.enabled",!1)&&this._connection.init(Dt.getValue("signalr.url")))}onDispose(){this._demo&&this._demo.dispose(),this._connection&&(this._connection.removeEventListener(fs.CONNECTION_OPENED,this.onConnectionOpenedEvent),this._connection.removeEventListener(fs.CONNECTION_CLOSED,this.onConnectionClosedEvent),this._connection.removeEventListener(fs.CONNECTION_ERROR,this.onConnectionErrorEvent)),Et.instance.events.removeEventListener(Us.CONNECTION_AUTHENTICATED,this.onConnectionAuthenticatedEvent),super.onDispose()}onConnectionOpenedEvent(t){dt.log("Connection Initialized")}onConnectionClosedEvent(t){dt.log("Connection Closed")}onConnectionErrorEvent(t){dt.log("Connection Error")}onConnectionAuthenticatedEvent(t){dt.log("Connection Authenticated"),this._connection&&this._connection.authenticated()}connectionInit(t){dt.log("Initializing Connection",t)}registerMessageEvent(t){return this._connection&&this._connection.addMessageEvent(t),t}removeMessageEvent(t){this._connection&&this._connection.removeMessageEvent(t)}get demo(){return this._demo}get connection(){return this._connection}}const ql=class ql{static get available(){return this._isListeningForPostMessages||(this._isListeningForPostMessages=!0,window.addEventListener("message",t=>{if(typeof t.data=="string"&&t.data.startsWith(ql.MESSAGE_KEY)){const{method:e,params:s}=JSON.parse(t.data.substr(ql.MESSAGE_KEY.length)),i=window[e];if(!i)return;i(...s);return}})),!0}static call(t,...e){if(window.top!==window&&window.top.postMessage(ql.MESSAGE_KEY+JSON.stringify({method:t,params:e}),"*"),!("FlashExternalInterface"in window))return;const s=window.FlashExternalInterface[t];return typeof s<"u"?s(...e):void 0}static callGame(t,...e){if(window.top!==window&&window.top.postMessage("Nitro_LegacyExternalGameInterface"+JSON.stringify({method:t,params:e}),"*"),!("FlashExternalGameInterface"in window))return;const s=window.FlashExternalGameInterface[t];return typeof s<"u"?s(...e):void 0}static addCallback(t,e){window[t]=e}};ql.MESSAGE_KEY="Nitro_LegacyExternalInterface",ql._isListeningForPostMessages=!1;let Zt=ql;class NX{constructor(t){t.addMessageEvent(new vS(this.onLoadGameUrl.bind(this)))}onLoadGameUrl(t){if(!t)return;const e=t.getParser();e&&Zt.callGame("showGame",e.url)}}class Cp{constructor(t){this._badgeId="",this._level=1,this._base="",this._badgeId=t,this.parseText()}parseText(){let t=this._badgeId.length-1;for(;t>0&&this.isNumber(this._badgeId.charAt(t));)t--;this._base=this._badgeId.substr(0,t+1);const e=this._badgeId.substr(t+1,this._badgeId.length);e&&e!==""&&(this._level=Number.parseInt(e))}isNumber(t){const e=t.charCodeAt(0);return e>=48&&e<=57}get level(){return this._level}set level(t){this._level=Math.max(1,t)}get getBadgeId(){return this._base+this._level}get base(){return this._base}}class xX extends Fa{constructor(t){super(),this._communication=t,this._definitions=new Map,this._parameters=new Map,this._badgePointLimits=new Map,this._romanNumerals=["I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII","XIII","XIV","XV","XVI","XVII","XVIII","XIX","XX","XXI","XXII","XXIII","XXIV","XXV","XXVI","XXVII","XXVIII","XXIX","XXX"],this._pendingUrls=[]}onInit(){this._communication.registerMessageEvent(new wS(this.onBadgePointLimitsEvent.bind(this)));let t=Dt.getValue("external.texts");(t==null||t!=null&&t.length==0)&&(t=Dt.getValue("external.texts.url")),Array.isArray(t)||(t=[Dt.getValue("external.texts.url")]);for(let e=0;e<t.length;e++)t[e]=Dt.interpolate(t[e]);this._pendingUrls=t,this.loadNextLocalization()}loadNextLocalization(){if(!this._pendingUrls.length){this.events&&this.events.dispatchEvent(new $o($o.LOADED));return}this.loadLocalizationFromURL(this._pendingUrls[0])}loadLocalizationFromURL(t){fetch(t).then(e=>e.json()).then(e=>this.onLocalizationLoaded(e,t)).catch(e=>this.onLocalizationFailed(e))}onLocalizationLoaded(t,e){if(!t)return;if(!this.parseLocalization(t))throw new Error(`Invalid json data for file ${e}`);const s=this._pendingUrls.indexOf(e);s>=0&&this._pendingUrls.splice(s,1),this.loadNextLocalization()}onLocalizationFailed(t){this.events&&this.events.dispatchEvent(new $o($o.FAILED))}parseLocalization(t){if(!t)return!1;for(const e in t)this._definitions.set(e,t[e]);return!0}onBadgePointLimitsEvent(t){const e=t.getParser();for(const s of e.data)this.setBadgePointLimit(s.badgeId,s.limit)}getBadgePointLimit(t){return this._badgePointLimits.get(t)||-1}setBadgePointLimit(t,e){this._badgePointLimits.set(t,e)}getRomanNumeral(t){return this._romanNumerals[Math.max(0,t-1)]}getPreviousLevelBadgeId(t){const e=new Cp(t);return e.level--,e.getBadgeId}hasValue(t){return this._definitions.has(t)}getValue(t,e=!0){if(!t||!t.length)return null;const s=t.match(/\$\{.[^}]*\}/g);if(s&&s.length)for(const n of s)t=t.replace(n,this.getValue(n.slice(2,-1),e));let i=this._definitions.get(t)||null;if(!i&&(i=Dt.definitions.get(t),i))return i;if(i&&e){const n=this._parameters.get(t);if(n)for(const[o,l]of n)i=i.replace("%"+o+"%",l)}return i||t}getValueWithParameter(t,e,s){const i=this.getValue(t,!1),n=i.replace("%"+e+"%",s);if(i.startsWith("%{")){const o=new RegExp("%{"+e.toUpperCase()+"\\|([^|]*)\\|([^|]*)\\|([^|]*)}"),l=i.match(o);if(!l)return n;let c=-1;switch(Number.parseInt(s)){case 0:c=1;break;case 1:c=2;break;default:case 2:c=3;break}if(c==-1||typeof l[c]>"u")return n;const h=l[c];if(h)return h.replace("%%",s)}return n}getValueWithParameters(t,e,s){let i=this.getValue(t,!1);if(e)for(let n=0;n<e.length;n++){const o=e[n],l=s[n];if(l!==void 0&&(i=i.replace("%"+o+"%",l),i.startsWith("%{"))){const c=new RegExp("%{"+o.toUpperCase()+"\\|([^|]*)\\|([^|]*)\\|([^|]*)}"),u=i.match(c);if(!u)continue;const h=parseInt(l);let d=-1;switch(h){case 0:d=1;break;case 1:d=2;break;case 2:default:d=3;break}if(d===-1||typeof u[d]>"u")continue;const g=u[d];g&&(i=g.replace("%%",l))}}return i}setValue(t,e){this._definitions.set(t,e)}registerParameter(t,e,s){if(!t||t.length===0||!e||e.length===0)return;let i=this._parameters.get(t);i||(i=new Map,this._parameters.set(t,i)),i.set(e,s)}getBadgeName(t){const e=new Cp(t),s=["badge_name_"+t,"badge_name_"+e.base];let i=this.fixBadLocalization(this.getExistingKey(s));return i=i.replace("%roman%",this.getRomanNumeral(e.level)),i}getBadgeDesc(t){const e=new Cp(t),s=["badge_desc_"+t,"badge_desc_"+e.base];let i=this.fixBadLocalization(this.getExistingKey(s));const n=this.getBadgePointLimit(t);return n>-1&&(i=i.replace("%limit%",n.toString())),i=i.replace("%roman%",this.getRomanNumeral(e.level)),i}getExistingKey(t){for(const e of t){const s=this.getValue(e);if(s!=e)return s}return""}fixBadLocalization(t){return t.replace("${","$").replace("{","$").replace("}","$")}}Tj.add(Rj,Sj,Oj,Cj,Aj,Nj,xj);class XC{constructor(){this.id=0,this.data=null,this.image=null}getImage(){return this.image?this.image:this.data?Ee.generateImage(this.data):null}}const $m=class $m extends Ys{constructor(t){super(null,null),this._type=t}get type(){return this._type}};$m.IMAGE_LOADED="ROAUM_IMAGE_LOADED",$m.IMAGE_LOADING_FAILED="ROAUM_IMAGE_FAILED";let ki=$m;class ks extends Ys{constructor(){super(null,null)}}class xU extends ks{constructor(t,e){super(),this._itemType=t,this._itemName=e}get itemType(){return this._itemType}get itemName(){return this._itemName}}class EO extends ks{constructor(t=0){super(),this._numberOfWords=t}get numberOfWords(){return this._numberOfWords}}class MU extends ks{constructor(t=0){super(),this._danceStyle=t}get danceStyle(){return this._danceStyle}}class yU extends ks{constructor(t,e=0){super(),this._effect=t,this._delayMilliseconds=e}get effect(){return this._effect}get delayMilliseconds(){return this._delayMilliseconds}}class DU extends ks{constructor(t){super(),this._gainedExperience=t}get gainedExperience(){return this._gainedExperience}}class bU extends ks{constructor(t=0){super(),this._expressionType=t}get expressionType(){return this._expressionType}}class of extends ks{constructor(t,e=null,s=null,i=!1){super(),this._figure=t,this._gender=e,this._subType=s,this._isRiding=i}get figure(){return this._figure}get gender(){return this._gender}get subType(){return this._subType}get isRiding(){return this._isRiding}}class vU extends ks{constructor(t=0){super(),this._level=t}get level(){return this._level}}class LU extends ks{constructor(t=0){super(),this._gesture=t}get gesture(){return this._gesture}}class MX extends ks{constructor(t){super(),this._guideStatus=t}get guideStatus(){return this._guideStatus}}class PU extends ks{constructor(t=!1){super(),this._isMuted=t}get isMuted(){return this._isMuted}}class UU extends ks{}class jU extends ks{constructor(t){super(),this._gesture=t}get gesture(){return this._gesture}}class wU extends ks{constructor(t){super(),this._value=t}get value(){return this._value}}class FU extends ks{constructor(t){super(),this._isPlayingGame=t}get isPlayingGame(){return this._isPlayingGame}}class pO extends ks{constructor(t,e=""){super(),this._postureType=t,this._parameter=e}get postureType(){return this._postureType}get parameter(){return this._parameter}}class lf extends ks{constructor(t){super(),this._selected=t}get selected(){return this._selected}}class GU extends ks{constructor(t=0){super(),this._signType=t}get signType(){return this._signType}}class IO extends ks{constructor(t=!1){super(),this._isSleeping=t}get isSleeping(){return this._isSleeping}}class BU extends ks{constructor(t=!1){super(),this._isTyping=t}get isTyping(){return this._isTyping}}class nl extends Ys{constructor(t,e,s,i=!1){super(t,s),this._targetLocation=e,this._isSlide=i}get targetLocation(){return this._targetLocation?this._targetLocation:this.location}get isSlide(){return this._isSlide}}class cf extends nl{constructor(t,e,s,i,n,o){super(t,e,s),this._headDirection=i,this._canStandUp=n,this._baseY=o}get headDirection(){return this._headDirection}get canStandUp(){return this._canStandUp}get baseY(){return this._baseY}}class kU extends ks{constructor(t){super(),this._itemType=t}get itemType(){return this._itemType}}class je extends Ys{constructor(t,e,s=null){super(null,null),this._state=t,this._data=e,this._extra=s}get state(){return this._state}get data(){return this._data}get extra(){return this._extra}}const gC=class gC extends Ys{constructor(t,e){super(null,null),this._badgeId=t,this._assetName=e}get badgeId(){return this._badgeId}get assetName(){return this._assetName}};gC.BADGE_LOADED="ROGBUM_BADGE_LOADED";let xc=gC;class VU extends Ys{constructor(t,e,s){super(t,e),this._height=s}get height(){return this._height}}class TO extends Ys{constructor(t){super(null,null),this._data=t}get data(){return this._data}}class HU extends Ys{constructor(t,e){super(null,null),this._numberKey=t,this._numberValue=e}get numberKey(){return this._numberKey}get numberValue(){return this._numberValue}}const fC=class fC extends Ys{constructor(t,e,s,i){super(null,null),this._type=t,this._color=e,this._light=s,this._backgroundOnly=i}get type(){return this._type}get color(){return this._color}get light(){return this._light}get backgroundOnly(){return this._backgroundOnly}};fC.BACKGROUND_COLOR="RORCUM_BACKGROUND_COLOR";let t_=fC;const Zm=class Zm extends Ys{constructor(t,e,s=0,i=0,n=0,o=0){super(null,null),this._type=t,this._id=e,this._x=s,this._y=i,this._width=n,this._height=o}get type(){return this._type}get id(){return this._id}get x(){return this._x}get y(){return this._y}get width(){return this._width}get height(){return this._height}};Zm.ADD="ORPFHUM_ADD",Zm.REMOVE="ORPFHUM_REMOVE";let ho=Zm;const tE=class tE extends Ys{constructor(t){super(null,null),this._type=tE.UPDATE_MAP,this._mapData=t}get type(){return this._type}get mapData(){return this._mapData}};tE.UPDATE_MAP="RORMUM_UPDATE_MAP";let uf=tE;const Ql=class Ql extends Ys{constructor(t,e,s=null,i=null,n="window"){super(null,null),this._type=t,this._maskId=e,this._maskType=s,this._maskLocation=i?new j(i.x,i.y,i.z):null,this._maskCategory=n}get type(){return this._type}get maskId(){return this._maskId}get maskType(){return this._maskType}get maskLocation(){return this._maskLocation}get maskCategory(){return this._maskCategory}};Ql.ADD_MASK="RORMUM_ADD_MASK",Ql.REMOVE_MASK="RORMUM_ADD_MASK",Ql.DOOR="door",Ql.WINDOW="window",Ql.HOLE="hole";let yi=Ql;const eE=class eE extends Ys{constructor(t,e){super(null,null),this._type=t,this._value=e}get type(){return this._type}get value(){return this._value}};eE.WALL_THICKNESS="RORPPUM_WALL_THICKNESS",eE.FLOOR_THICKNESS="RORPVUM_FLOOR_THICKNESS";let _o=eE;const sE=class sE extends Ys{constructor(t,e){super(null,null),this._type=t,this._visible=e}get type(){return this._type}get visible(){return this._visible}};sE.WALL_VISIBILITY="RORPVUM_WALL_VISIBILITY",sE.FLOOR_VISIBILITY="RORPVUM_FLOOR_VISIBILITY";let go=sE;const dd=class dd extends Ys{constructor(t,e){super(null,null),this._type=t,this._value=e}get type(){return this._type}get value(){return this._value}};dd.ROOM_WALL_UPDATE="RORUM_ROOM_WALL_UPDATE",dd.ROOM_FLOOR_UPDATE="RORUM_ROOM_FLOOR_UPDATE",dd.ROOM_LANDSCAPE_UPDATE="RORUM_ROOM_LANDSCAPE_UPDATE";let hi=dd;class e_ extends ks{constructor(t){super(),this._selected=t}get selected(){return this._selected}}class qc extends Ys{constructor(t,e,s,i,n=!1){super(t,null),this._height=e,this._visible=s,this._sourceEventId=i,this._toggleVisibility=n}get height(){return this._height}get visible(){return this._visible}get sourceEventId(){return this._sourceEventId}get toggleVisibility(){return this._toggleVisibility}}const iE=class iE extends Ys{constructor(t){super(null,null),this._type=t}get type(){return this._type}};iE.ENABLED="ROVUM_ENABLED",iE.DISABLED="ROVUM_DISABLED";let fo=iE;const Du=class Du extends KE{constructor(){super(),this._liftAmount=0,this._location=new j,this._locationDelta=new j,this._lastUpdateTime=0,this._changeTime=0,this._updateInterval=Du.DEFAULT_UPDATE_INTERVAL}onDispose(){this._liftAmount=0,super.onDispose()}update(t){super.update(t);const e=this.getLocationOffset(),s=this.object&&this.object.model;if(s&&(e?this._liftAmount!==e.z&&(this._liftAmount=e.z,s.setValue(C.FURNITURE_LIFT_AMOUNT,this._liftAmount)):this._liftAmount!==0&&(this._liftAmount=0,s.setValue(C.FURNITURE_LIFT_AMOUNT,this._liftAmount))),this._locationDelta.length>0||e){const i=Du.TEMP_VECTOR;let n=this.time-this._changeTime;n===this._updateInterval>>1&&n++,n>this._updateInterval&&(n=this._updateInterval),this._locationDelta.length>0?(i.assign(this._locationDelta),i.multiply(n/this._updateInterval),i.add(this._location)):i.assign(this._location),e&&i.add(e),this.object.setLocation(i),n===this._updateInterval&&(this._locationDelta.x=0,this._locationDelta.y=0,this._locationDelta.z=0)}this._lastUpdateTime=this.time}setObject(t){super.setObject(t),t&&this._location.assign(t.getLocation())}processUpdateMessage(t){if(t&&(super.processUpdateMessage(t),t.location&&this._location.assign(t.location),t instanceof nl))return this.processMoveMessage(t)}processMoveMessage(t){!t||!this.object||!t.location||(this._changeTime=this._lastUpdateTime,this._locationDelta.assign(t.targetLocation),this._locationDelta.subtract(this._location))}getLocationOffset(){return null}get lastUpdateTime(){return this._lastUpdateTime}set updateInterval(t){t<=0&&(t=1),this._updateInterval=t}};Du.DEFAULT_UPDATE_INTERVAL=500,Du.TEMP_VECTOR=new j;let al=Du;const As=class As extends al{constructor(){super(),this._selected=!1,this._reportedLocation=null,this._effectChangeTimeStamp=0,this._newEffect=0,this._blinkingStartTimestamp=Pt()+this.randomBlinkStartTimestamp(),this._blinkingEndTimestamp=0,this._talkingEndTimestamp=0,this._talkingPauseStartTimestamp=0,this._talkingPauseEndTimestamp=0,this._carryObjectStartTimestamp=0,this._carryObjectEndTimestamp=0,this._allowUseCarryObject=!1,this._animationEndTimestamp=0,this._signEndTimestamp=0,this._gestureEndTimestamp=0,this._numberValueEndTimestamp=0}getEventTypes(){const t=[Gt.CLICK,Gt.DOUBLE_CLICK,Ui.POSITION_CHANGED,Gt.MOUSE_ENTER,Gt.MOUSE_LEAVE,lt.MOUSE_BUTTON,lt.MOUSE_ARROW];return this.mergeTypes(super.getEventTypes(),t)}dispose(){this._selected&&this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Ui(Ui.OBJECT_REMOVED,this.object)),super.dispose(),this._reportedLocation=null}update(t){if(super.update(t),this._selected&&this.object&&this.eventDispatcher){const s=this.object.getLocation();(!this._reportedLocation||this._reportedLocation.x!==s.x||this._reportedLocation.y!==s.y||this._reportedLocation.z!==s.z)&&(this._reportedLocation||(this._reportedLocation=new j),this._reportedLocation.assign(s),this.eventDispatcher.dispatchEvent(new Ui(Ui.POSITION_CHANGED,this.object)))}const e=this.object&&this.object.model;e&&this.updateModel(this.time,e)}updateModel(t,e){this._talkingEndTimestamp>0&&(t>this._talkingEndTimestamp?(e.setValue(C.FIGURE_TALK,0),this._talkingEndTimestamp=0,this._talkingPauseStartTimestamp=0,this._talkingPauseEndTimestamp=0):!this._talkingPauseEndTimestamp&&!this._talkingPauseStartTimestamp?(this._talkingPauseStartTimestamp=t+this.randomTalkingPauseStartTimestamp(),this._talkingPauseEndTimestamp=this._talkingPauseStartTimestamp+this.randomTalkingPauseEndTimestamp()):this._talkingPauseStartTimestamp>0&&t>this._talkingPauseStartTimestamp?(e.setValue(C.FIGURE_TALK,0),this._talkingPauseStartTimestamp=0):this._talkingPauseEndTimestamp>0&&t>this._talkingPauseEndTimestamp&&(e.setValue(C.FIGURE_TALK,1),this._talkingPauseEndTimestamp=0)),this._animationEndTimestamp>0&&t>this._animationEndTimestamp&&(e.setValue(C.FIGURE_EXPRESSION,0),this._animationEndTimestamp=0),this._gestureEndTimestamp>0&&t>this._gestureEndTimestamp&&(e.setValue(C.FIGURE_GESTURE,0),this._gestureEndTimestamp=0),this._signEndTimestamp>0&&t>this._signEndTimestamp&&(e.setValue(C.FIGURE_SIGN,-1),this._signEndTimestamp=0),this._carryObjectEndTimestamp>0&&t>this._carryObjectEndTimestamp&&(e.setValue(C.FIGURE_CARRY_OBJECT,0),e.setValue(C.FIGURE_USE_OBJECT,0),this._carryObjectStartTimestamp=0,this._carryObjectEndTimestamp=0,this._allowUseCarryObject=!1),this._allowUseCarryObject&&t-this._carryObjectStartTimestamp>5e3&&((t-this._carryObjectStartTimestamp)%1e4<1e3?e.setValue(C.FIGURE_USE_OBJECT,1):e.setValue(C.FIGURE_USE_OBJECT,0)),this._blinkingStartTimestamp>-1&&t>this._blinkingStartTimestamp&&(e.setValue(C.FIGURE_BLINK,1),this._blinkingStartTimestamp=t+this.randomBlinkStartTimestamp(),this._blinkingEndTimestamp=t+this.randomBlinkEndTimestamp()),this._blinkingEndTimestamp>0&&t>this._blinkingEndTimestamp&&(e.setValue(C.FIGURE_BLINK,0),this._blinkingEndTimestamp=0),this._effectChangeTimeStamp>0&&t>this._effectChangeTimeStamp&&(e.setValue(C.FIGURE_EFFECT,this._newEffect),this._effectChangeTimeStamp=0),this._numberValueEndTimestamp>0&&t>this._numberValueEndTimestamp&&(e.setValue(C.FIGURE_NUMBER_VALUE,0),this._numberValueEndTimestamp=0)}processUpdateMessage(t){if(!t||!this.object)return;super.processUpdateMessage(t);const e=this.object&&this.object.model;if(e){if(t instanceof pO){e.setValue(C.FIGURE_POSTURE,t.postureType),e.setValue(C.FIGURE_POSTURE_PARAMETER,t.parameter);return}if(t instanceof EO){e.setValue(C.FIGURE_TALK,1),this._talkingEndTimestamp=this.time+t.numberOfWords*1e3;return}if(t instanceof BU){e.setValue(C.FIGURE_IS_TYPING,t.isTyping?1:0);return}if(t instanceof PU){e.setValue(C.FIGURE_IS_MUTED,t.isMuted?1:0);return}if(t instanceof FU){e.setValue(C.FIGURE_IS_PLAYING_GAME,t.isPlayingGame?1:0);return}if(t instanceof cf){e.setValue(C.HEAD_DIRECTION,t.headDirection),e.setValue(C.FIGURE_CAN_STAND_UP,t.canStandUp),e.setValue(C.FIGURE_VERTICAL_OFFSET,t.baseY);return}if(t instanceof LU){e.setValue(C.FIGURE_GESTURE,t.gesture),this._gestureEndTimestamp=this.time+3e3;return}if(t instanceof bU){e.setValue(C.FIGURE_EXPRESSION,t.expressionType),this._animationEndTimestamp=mt.getExpressionTimeout(e.getValue(C.FIGURE_EXPRESSION)),this._animationEndTimestamp>-1&&(this._animationEndTimestamp+=this.time);return}if(t instanceof MU){e.setValue(C.FIGURE_DANCE,t.danceStyle);return}if(t instanceof IO){e.setValue(C.FIGURE_SLEEP,t.isSleeping?1:0),t.isSleeping?this._blinkingStartTimestamp=-1:this._blinkingStartTimestamp=this.time+this.randomBlinkStartTimestamp();return}if(t instanceof wU){e.setValue(C.FIGURE_NUMBER_VALUE,t.value),this._numberValueEndTimestamp=this.time+3e3;return}if(t instanceof yU){this.updateAvatarEffect(t.effect,t.delayMilliseconds,e);return}if(t instanceof xU){e.setValue(C.FIGURE_CARRY_OBJECT,t.itemType),e.setValue(C.FIGURE_USE_OBJECT,0),t.itemType===0?(this._carryObjectStartTimestamp=0,this._carryObjectEndTimestamp=0,this._allowUseCarryObject=!1):(this._carryObjectStartTimestamp=this.time,t.itemType<As.MAX_HAND_ID?(this._carryObjectEndTimestamp=0,this._allowUseCarryObject=t.itemType<=As.MAX_HAND_USE_ID):(this._carryObjectEndTimestamp=this._carryObjectStartTimestamp+1500,this._allowUseCarryObject=!1));return}if(t instanceof kU){e.setValue(C.FIGURE_USE_OBJECT,t.itemType);return}if(t instanceof GU){e.setValue(C.FIGURE_SIGN,t.signType),this._signEndTimestamp=this.time+5e3;return}if(t instanceof vU){e.setValue(C.FIGURE_FLAT_CONTROL,t.level);return}if(t instanceof of){e.setValue(C.FIGURE,t.figure),e.setValue(C.GENDER,t.gender);return}if(t instanceof lf){this._selected=t.selected,this._reportedLocation=null;return}if(t instanceof UU){e.setValue(C.OWN_USER,1);return}}}updateAvatarEffect(t,e,s){if(t===As.EFFECT_TYPE_SPLASH)this._effectChangeTimeStamp=Pt()+As.EFFECT_SPLASH_LENGTH,this._newEffect=As.EFFECT_TYPE_SWIM;else if(t===As.EFFECT_TYPE_SPLASH_DARK)this._effectChangeTimeStamp=Pt()+As.EFFECT_SPLASH_LENGTH,this._newEffect=As.EFFECT_TYPE_SWIM_DARK;else if(s.getValue(C.FIGURE_EFFECT)===As.EFFECT_TYPE_SWIM)this._effectChangeTimeStamp=Pt()+As.EFFECT_SPLASH_LENGTH,this._newEffect=t,t=As.EFFECT_TYPE_SPLASH;else if(s.getValue(C.FIGURE_EFFECT)===As.EFFECT_TYPE_SWIM_DARK)this._effectChangeTimeStamp=Pt()+As.EFFECT_SPLASH_LENGTH,this._newEffect=t,t=As.EFFECT_TYPE_SPLASH_DARK;else if(e===0)this._effectChangeTimeStamp=0;else{this._effectChangeTimeStamp=Pt()+e,this._newEffect=t;return}s.setValue(C.FIGURE_EFFECT,t)}mouseEvent(t,e){let s=null;switch(t.type){case at.MOUSE_CLICK:s=Gt.CLICK;break;case at.DOUBLE_CLICK:s=Gt.DOUBLE_CLICK;break;case at.ROLL_OVER:s=Gt.MOUSE_ENTER,this.object.model&&this.object.model.setValue(C.FIGURE_HIGHLIGHT,1),this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new lt(lt.MOUSE_BUTTON,this.object));break;case at.ROLL_OUT:s=Gt.MOUSE_LEAVE,this.object.model&&this.object.model.setValue(C.FIGURE_HIGHLIGHT,0),this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new lt(lt.MOUSE_ARROW,this.object));break}s&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Gt(s,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown))}randomTalkingPauseStartTimestamp(){return 100+Math.random()*200}randomTalkingPauseEndTimestamp(){return 75+Math.random()*75}randomBlinkStartTimestamp(){return 4500+Math.random()*1e3}randomBlinkEndTimestamp(){return 50+Math.random()*200}};As.MAX_HAND_ID=999999999,As.MAX_HAND_USE_ID=999,As.EFFECT_TYPE_SPLASH=28,As.EFFECT_SPLASH_LENGTH=500,As.EFFECT_TYPE_SWIM=29,As.EFFECT_TYPE_SPLASH_DARK=184,As.EFFECT_TYPE_SWIM_DARK=185;let QT=As;const dr=class dr extends al{constructor(){super(),this._sizeX=0,this._sizeY=0,this._sizeZ=0,this._centerX=0,this._centerY=0,this._centerZ=0,this._directions=[],this._mouseOver=!1,this._locationOffset=new j,this._bouncingStep=0,this._storedRotateMessage=null,this._directionInitialized=!1,dr.BOUNCING_STEPS===-1&&(dr.BOUNCING_STEPS=Dt.getValue("furni.rotation.bounce.steps",8)),dr.BOUNCING_Z===-1&&(dr.BOUNCING_Z=Dt.getValue("furni.rotation.bounce.height",.0625))}getEventTypes(){const t=[_e.STATE_CHANGE,Gt.CLICK,Gt.MOUSE_DOWN,Gt.MOUSE_DOWN_LONG,Ze.ROOM_AD_TOOLTIP_SHOW,Ze.ROOM_AD_TOOLTIP_HIDE,Ze.ROOM_AD_FURNI_DOUBLE_CLICK,Ze.ROOM_AD_FURNI_CLICK];return this.widget&&t.push(X.OPEN_WIDGET,X.CLOSE_WIDGET),this.contextMenu&&t.push(X.OPEN_FURNI_CONTEXT_MENU,X.CLOSE_FURNI_CONTEXT_MENU),this.mergeTypes(super.getEventTypes(),t)}initialize(t){if(!t)return;const e=this.object&&this.object.model;if(e){if(t.logic){if(t.logic.model){const s=t.logic.model.dimensions;s&&(this._sizeX=s.x,this._sizeY=s.y,this._sizeZ=s.z,this._centerX=this._sizeX/2,this._centerY=this._sizeY/2,this._centerZ=this._sizeZ/2);const i=t.logic.model.directions;if(i&&i.length){for(const n of i)this._directions.push(n);this._directions.sort((n,o)=>n-o)}}if(t.logic.customVars){const s=t.logic.customVars.variables;s&&s.length&&e.setValue(C.FURNITURE_CUSTOM_VARIABLES,s)}}e.setValue(C.FURNITURE_SIZE_X,this._sizeX),e.setValue(C.FURNITURE_SIZE_Y,this._sizeY),e.setValue(C.FURNITURE_SIZE_Z,this._sizeZ),e.setValue(C.FURNITURE_CENTER_X,this._centerX),e.setValue(C.FURNITURE_CENTER_Y,this._centerY),e.setValue(C.FURNITURE_CENTER_Z,this._centerZ),e.setValue(C.FURNITURE_ALLOWED_DIRECTIONS,this._directions),e.setValue(C.FURNITURE_ALPHA_MULTIPLIER,1)}}onDispose(){this._storedRotateMessage=null,this._directions=null,super.onDispose()}setObject(t){super.setObject(t),t&&t.getLocation().length&&(this._directionInitialized=!0)}getAdClickUrl(t){return t.getValue(C.FURNITURE_AD_URL)}handleAdClick(t,e,s){this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Ze(Ze.ROOM_AD_FURNI_CLICK,this.object))}update(t){super.update(t),this._bouncingStep>0&&(this._bouncingStep++,this._bouncingStep>dr.BOUNCING_STEPS&&(this._bouncingStep=0))}processUpdateMessage(t){if(t instanceof je){this.processDataUpdateMessage(t);return}if(t instanceof VU){this.processObjectHeightUpdateMessage(t);return}if(t instanceof TO){this.processItemDataUpdateMessage(t);return}if(this._mouseOver=!1,t.location&&t.direction){if(!(t instanceof nl)){const e=this.object.getDirection(),s=this.object.getLocation();e.x!==t.direction.x&&this._directionInitialized&&s.x===t.location.x&&s.y===t.location.y&&s.z===t.location.z&&(this._bouncingStep=1,this._storedRotateMessage=new Ys(t.location,t.direction),t=null)}this._directionInitialized=!0}if(t instanceof e_&&this.contextMenu&&this.eventDispatcher&&this.object){const e=t.selected?X.OPEN_FURNI_CONTEXT_MENU:X.CLOSE_FURNI_CONTEXT_MENU;this.eventDispatcher.dispatchEvent(new X(e,this.object))}super.processUpdateMessage(t)}processDataUpdateMessage(t){t&&(this.object.setState(t.state,0),t.data&&t.data.writeRoomObjectModel(this.object.model),t.extra!==null&&this.object.model.setValue(C.FURNITURE_EXTRAS,t.extra.toString()),this.object.model.setValue(C.FURNITURE_STATE_UPDATE_TIME,this.lastUpdateTime))}processObjectHeightUpdateMessage(t){t&&this.object.model.setValue(C.FURNITURE_SIZE_Z,t.height)}processItemDataUpdateMessage(t){t&&this.object.model.setValue(C.FURNITURE_ITEMDATA,t.data)}mouseEvent(t,e){const s=this.getAdClickUrl(this.object.model);switch(t.type){case at.MOUSE_MOVE:if(this.eventDispatcher){const i=new Gt(Gt.MOUSE_MOVE,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown);i.localX=t.localX,i.localY=t.localY,i.spriteOffsetX=t.spriteOffsetX,i.spriteOffsetY=t.spriteOffsetY,this.eventDispatcher.dispatchEvent(i)}return;case at.ROLL_OVER:if(!this._mouseOver){if(this.eventDispatcher){s&&s.indexOf("http")===0&&this.eventDispatcher.dispatchEvent(new Ze(Ze.ROOM_AD_TOOLTIP_SHOW,this.object));const i=new Gt(Gt.MOUSE_ENTER,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown);i.localX=t.localX,i.localY=t.localY,i.spriteOffsetX=t.spriteOffsetX,i.spriteOffsetY=t.spriteOffsetY,this.eventDispatcher.dispatchEvent(i)}this._mouseOver=!0}return;case at.ROLL_OUT:if(this._mouseOver){if(this.eventDispatcher){s&&s.indexOf("http")===0&&this.eventDispatcher.dispatchEvent(new Ze(Ze.ROOM_AD_TOOLTIP_HIDE,this.object));const i=new Gt(Gt.MOUSE_LEAVE,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown);i.localX=t.localX,i.localY=t.localY,i.spriteOffsetX=t.spriteOffsetX,i.spriteOffsetY=t.spriteOffsetY,this.eventDispatcher.dispatchEvent(i)}this._mouseOver=!1}return;case at.DOUBLE_CLICK:this.useObject();return;case at.MOUSE_CLICK:if(this.eventDispatcher){const i=new Gt(Gt.CLICK,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown);i.localX=t.localX,i.localY=t.localY,i.spriteOffsetX=t.spriteOffsetX,i.spriteOffsetY=t.spriteOffsetY,this.eventDispatcher.dispatchEvent(i),s&&s.indexOf("http")===0&&this.eventDispatcher.dispatchEvent(new Ze(Ze.ROOM_AD_TOOLTIP_HIDE,this.object)),s&&s.length&&this.handleAdClick(this.object.id,this.object.type,s)}return;case at.MOUSE_DOWN:if(this.eventDispatcher){const i=new Gt(Gt.MOUSE_DOWN,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown);this.eventDispatcher.dispatchEvent(i)}return;case at.MOUSE_DOWN_LONG:if(this.eventDispatcher){const i=new Gt(Gt.MOUSE_DOWN_LONG,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown);this.eventDispatcher.dispatchEvent(i)}return}}getLocationOffset(){return this._bouncingStep<=0?null:(this._locationOffset.x=0,this._locationOffset.y=0,this._bouncingStep<=dr.BOUNCING_STEPS/2?this._locationOffset.z=dr.BOUNCING_Z*this._bouncingStep:this._bouncingStep<=dr.BOUNCING_STEPS&&(this._storedRotateMessage&&(super.processUpdateMessage(this._storedRotateMessage),this._storedRotateMessage=null),this._locationOffset.z=dr.BOUNCING_Z*(dr.BOUNCING_STEPS-this._bouncingStep)),this._locationOffset)}useObject(){if(!this.object||!this.eventDispatcher)return;const t=this.getAdClickUrl(this.object.model);t&&t.length&&this.eventDispatcher.dispatchEvent(new Ze(Ze.ROOM_AD_FURNI_DOUBLE_CLICK,this.object,null,t)),this.widget&&this.eventDispatcher.dispatchEvent(new X(X.OPEN_WIDGET,this.object)),this.eventDispatcher.dispatchEvent(new _e(_e.STATE_CHANGE,this.object))}tearDown(){this.object.model.getValue(C.FURNITURE_REAL_ROOM_OBJECT)===1&&(this.widget&&this.eventDispatcher.dispatchEvent(new X(X.CLOSE_WIDGET,this.object)),this.contextMenu&&this.eventDispatcher.dispatchEvent(new X(X.CLOSE_FURNI_CONTEXT_MENU,this.object))),super.tearDown()}};dr.BOUNCING_STEPS=-1,dr.BOUNCING_Z=-1;let Te=dr;class WU extends Te{getEventTypes(){const t=[X.BADGE_DISPLAY_ENGRAVING,Gn.LOAD_BADGE];return this.mergeTypes(super.getEventTypes(),t)}processUpdateMessage(t){if(super.processUpdateMessage(t),!!this.object){if(t instanceof je){const e=t.data;e instanceof Vn&&this.updateBadge(e.getValue(1));return}if(t instanceof xc){t.assetName!=="loading_icon"&&(this.object.model.setValue(C.FURNITURE_BADGE_ASSET_NAME,t.assetName),this.object.model.setValue(C.FURNITURE_BADGE_IMAGE_STATUS,1),this.update(Pt()));return}}}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new X(X.BADGE_DISPLAY_ENGRAVING,this.object))}updateBadge(t){t!==""&&this.eventDispatcher&&(this.object.model.setValue(C.FURNITURE_BADGE_IMAGE_STATUS,-1),this.eventDispatcher.dispatchEvent(new Gn(Gn.LOAD_BADGE,this.object,t,!1)))}}const _r=class _r extends WU{getEventTypes(){const t=[X.ACHIEVEMENT_RESOLUTION_OPEN,X.ACHIEVEMENT_RESOLUTION_ENGRAVING,X.ACHIEVEMENT_RESOLUTION_FAILED,Gn.LOAD_BADGE];return this.mergeTypes(super.getEventTypes(),t)}processUpdateMessage(t){if(super.processUpdateMessage(t),t instanceof xc&&t.assetName!=="loading_icon"&&this.object.model.setValue(C.FURNITURE_BADGE_VISIBLE_IN_STATE,_r.BADGE_VISIBLE_IN_STATE),t instanceof e_){if(!this.eventDispatcher||!this.object)return;this.eventDispatcher.dispatchEvent(new X(X.CLOSE_FURNI_CONTEXT_MENU,this.object))}}useObject(){if(!this.object||!this.eventDispatcher)return;let t=null;switch(this.object.getState(0)){case _r.STATE_RESOLUTION_NOT_STARTED:case _r.STATE_RESOLUTION_IN_PROGRESS:t=new X(X.ACHIEVEMENT_RESOLUTION_OPEN,this.object);break;case _r.STATE_RESOLUTION_ACHIEVED:t=new X(X.ACHIEVEMENT_RESOLUTION_ENGRAVING,this.object);break;case _r.STATE_RESOLUTION_FAILED:t=new X(X.ACHIEVEMENT_RESOLUTION_FAILED,this.object);break}t&&this.eventDispatcher.dispatchEvent(t)}updateBadge(t){t!==_r.ACH_NOT_SET&&super.updateBadge(t)}};_r.STATE_RESOLUTION_NOT_STARTED=0,_r.STATE_RESOLUTION_IN_PROGRESS=1,_r.STATE_RESOLUTION_ACHIEVED=2,_r.STATE_RESOLUTION_FAILED=3,_r.ACH_NOT_SET="ach_0",_r.BADGE_VISIBLE_IN_STATE=2;let JT=_r;class yX extends Te{constructor(){super(),this.onRoomToObjectOwnAvatarMoveEvent=this.onRoomToObjectOwnAvatarMoveEvent.bind(this)}initialize(t){super.initialize(t),this.eventDispatcher&&this.eventDispatcher.addEventListener(ih.ROAME_MOVE_TO,this.onRoomToObjectOwnAvatarMoveEvent)}tearDown(){this.eventDispatcher&&this.eventDispatcher.removeEventListener(ih.ROAME_MOVE_TO,this.onRoomToObjectOwnAvatarMoveEvent),super.tearDown()}onRoomToObjectOwnAvatarMoveEvent(t){if(!t||!this.object)return;const e=this.object.getLocation(),s=t.targetLocation;if(!s)return;let i=this.object.model.getValue(C.FURNITURE_SIZE_X),n=this.object.model.getValue(C.FURNITURE_SIZE_Y);const o=(Math.floor(this.object.getDirection().x)+45)%360/90;(o===1||o===3)&&([i,n]=[n,i]),s.x>=e.x&&s.x<e.x+i&&s.y>=e.y&&s.y<e.y+n?this.object.setState(1,0):this.object.setState(0,0)}}class DX extends Te{getEventTypes(){const t=[X.CLOTHING_CHANGE];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t);const e=this.object.model.getValue(C.FURNITURE_DATA);this.updateClothingData(e)}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof je&&t.data&&this.updateClothingData(t.data.getLegacyString())}updateClothingData(t){if(!t||!t.length)return;const[e,s]=t.split(",");e&&e.length&&this.object.model.setValue(C.FURNITURE_CLOTHING_BOY,e),s&&s.length&&this.object.model.setValue(C.FURNITURE_CLOTHING_GIRL,s)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new X(X.CLOTHING_CHANGE,this.object))}}class bX extends Te{getEventTypes(){const t=[_e.STATE_CHANGE];return this.mergeTypes(super.getEventTypes(),t)}mouseEvent(t,e){if(!t||!e||!this.object)return;let s=null;switch(t.type){case at.DOUBLE_CLICK:switch(t.spriteTag){case"start_stop":s=new _e(_e.STATE_CHANGE,this.object,1);break;case"reset":s=new _e(_e.STATE_CHANGE,this.object,2);break}if(this.eventDispatcher&&s){this.eventDispatcher.dispatchEvent(s);return}break}super.mouseEvent(t,e)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new _e(_e.STATE_CHANGE,this.object,1))}}class vX extends Te{processUpdateMessage(t){super.processUpdateMessage(t),this.object&&this.object.model.getValue(C.FURNITURE_REAL_ROOM_OBJECT)===1&&this.object.model.setValue(Ms.INFOSTAND_EXTRA_PARAM,Ms.CRACKABLE_FURNI)}}class LX extends Te{get widget(){return Fd.CRAFTING}}class PX extends Te{getEventTypes(){const t=[X.CREDITFURNI];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t);let e=0;t.logic&&t.logic.credits&&t.logic.credits!==""&&t.logic.credits.length>0&&(e=parseInt(t.logic.credits)),this.object.model.setValue(C.FURNITURE_CREDIT_VALUE,e)}useObject(){!this.object||!this.eventDispatcher||(this.eventDispatcher.dispatchEvent(new X(X.CREDITFURNI,this.object)),super.useObject())}}class Ds extends Te{getEventTypes(){const t=[lt.MOUSE_BUTTON,lt.MOUSE_ARROW];return this.mergeTypes(super.getEventTypes(),t)}mouseEvent(t,e){if(!(!t||!e||!this.object)){switch(t.type){case at.ROLL_OVER:this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new lt(lt.MOUSE_BUTTON,this.object));break;case at.ROLL_OUT:this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new lt(lt.MOUSE_ARROW,this.object));break}super.mouseEvent(t,e)}}}class UX extends Ds{constructor(){super(...arguments),this._state=1}getEventTypes(){const t=[uo.PLAY_SOUND_AT_PITCH];return this.mergeTypes(super.getEventTypes(),t)}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof je&&(this._state!==-1&&t.state!==this._state&&this.dispatchSoundEvent(this.object.location.z),this._state=t.state)}dispatchSoundEvent(t){const e=Math.pow(2,t-1.2);this.eventDispatcher.dispatchEvent(new uo(uo.PLAY_SOUND_AT_PITCH,this.object,"FURNITURE_cuckoo_clock",e))}}class jX extends Ds{getEventTypes(){const t=[X.STACK_HEIGHT];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),this.object&&this.object.model&&this.object.model.setValue(C.FURNITURE_ALWAYS_STACKABLE,1)}useObject(){!this.object||!this.eventDispatcher||(this.eventDispatcher.dispatchEvent(new X(X.STACK_HEIGHT,this.object)),super.useObject())}}class wX extends Te{constructor(){super(),this._noTags=!1,this._noTagsLastStateActivate=!1}getEventTypes(){const t=[lt.DICE_ACTIVATE,lt.DICE_OFF];return this.mergeTypes(super.getEventTypes(),t)}mouseEvent(t,e){if(!t||!e||!this.object)return;let s=null;switch(t.type){case at.DOUBLE_CLICK:this._noTags?!this._noTagsLastStateActivate||this.object.getState(0)===0||this.object.getState(0)===100?(s=new lt(lt.DICE_ACTIVATE,this.object),this._noTagsLastStateActivate=!0):(s=new lt(lt.DICE_OFF,this.object),this._noTagsLastStateActivate=!1):t.spriteTag==="activate"||this.object.getState(0)===0||this.object.getState(0)===100?s=new lt(lt.DICE_ACTIVATE,this.object):t.spriteTag==="deactivate"&&(s=new lt(lt.DICE_OFF,this.object)),s&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(s);return}super.mouseEvent(t,e)}}class FX extends Te{getEventTypes(){const t=[X.ECOTRONBOX];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new X(X.ECOTRONBOX,this.object))}}class GX extends Te{constructor(){super(),this._showStateOnceRendered=!1,this._updateCount=0}getEventTypes(){const t=[X.INERNAL_LINK];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),t.logic&&t.logic.action&&t.logic.action.startState===1&&(this._showStateOnceRendered=!0)}update(t){super.update(t),this._showStateOnceRendered&&(this._updateCount++,this._showStateOnceRendered&&this._updateCount>20&&(this.setAutomaticStateIndex(1),this._showStateOnceRendered=!1))}setAutomaticStateIndex(t){this.object&&this.object.model&&this.object.model.setValue(C.FURNITURE_AUTOMATIC_STATE_INDEX,t)}mouseEvent(t,e){!t||!e||(t.type===at.DOUBLE_CLICK&&this.setAutomaticStateIndex(0),super.mouseEvent(t,e))}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new X(X.INERNAL_LINK,this.object))}}class BX extends Te{getEventTypes(){const t=[X.ROOM_LINK];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),t.logic&&t.logic.action&&t.logic.action.link&&t.logic.action.link!==""&&t.logic.action.link.length>0&&this.object&&this.object.model&&this.object.model.setValue(C.FURNITURE_INTERNAL_LINK,t.logic.action.link)}onDispose(){this._timer&&(clearTimeout(this._timer),this._timer=null),super.onDispose()}setAutomaticStateIndex(t){this.object&&this.object.model&&this.object.model.setValue(C.FURNITURE_AUTOMATIC_STATE_INDEX,t)}useObject(){this.setAutomaticStateIndex(1),this._timer&&(clearTimeout(this._timer),this._timer=null),this._timer=setTimeout(()=>{this.setAutomaticStateIndex(0),this._timer=null},2500),!(!this.object||!this.eventDispatcher)&&this.eventDispatcher.dispatchEvent(new X(X.ROOM_LINK,this.object))}}class kX extends Te{getEventTypes(){const t=[X.EFFECTBOX_OPEN_DIALOG];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new X(X.EFFECTBOX_OPEN_DIALOG,this.object))}get contextMenu(){return ts.EFFECT_BOX}}class VX extends Ds{getEventTypes(){const t=[X.EXTERNAL_IMAGE];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){if(super.initialize(t),!!t&&this.object&&this.object.model){let e="";t.logic&&t.logic.maskType&&t.logic.maskType!==""&&t.logic.maskType.length>0&&(e=t.logic.maskType),this.object.model.setValue(C.FURNITURE_USES_PLANE_MASK,0),this.object.model.setValue(C.FURNITURE_PLANE_MASK_TYPE,e)}}useObject(){!this.object||!this.eventDispatcher||(this.eventDispatcher.dispatchEvent(new X(X.EXTERNAL_IMAGE,this.object)),super.useObject())}}class HX extends Te{getEventTypes(){const t=[_e.STATE_CHANGE];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),t.logic&&t.logic.particleSystems&&t.logic.particleSystems.length&&this.object.model.setValue(C.FURNITURE_FIREWORKS_DATA,t.logic.particleSystems)}mouseEvent(t,e){if(!t||!e||!this.object)return;let s=null;switch(t.type){case at.DOUBLE_CLICK:switch(t.spriteTag){case"start_stop":s=new _e(_e.STATE_CHANGE,this.object,1);break;case"reset":s=new _e(_e.STATE_CHANGE,this.object,2);break}if(this.eventDispatcher&&s){this.eventDispatcher.dispatchEvent(s);return}break}super.mouseEvent(t,e)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new _e(_e.STATE_CHANGE,this.object,0))}}const Jl=class Jl extends Ds{constructor(){super(),this._currentState=-1,this._currentLocation=null}getEventTypes(){const t=[Mi.ADD_HOLE,Mi.REMOVE_HOLE];return this.mergeTypes(super.getEventTypes(),t)}onDispose(){this._currentState===Jl.STATE_HOLE&&this.eventDispatcher.dispatchEvent(new Mi(Mi.REMOVE_HOLE,this.object)),super.onDispose()}update(t){super.update(t),this.handleAutomaticStateUpdate()}processUpdateMessage(t){if(super.processUpdateMessage(t),!this.object)return;t instanceof je&&this.handleStateUpdate(this.object.getState(0));const e=this.object.getLocation();this._currentLocation?(e.x!==this._currentLocation.x||e.y!==this._currentLocation.y)&&this._currentState===Jl.STATE_HOLE&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Mi(Mi.ADD_HOLE,this.object)):this._currentLocation=new j,this._currentLocation.assign(e)}handleStateUpdate(t){t!==this._currentState&&(this.eventDispatcher&&(t===Jl.STATE_HOLE?this.eventDispatcher.dispatchEvent(new Mi(Mi.ADD_HOLE,this.object)):this._currentState===Jl.STATE_HOLE&&this.eventDispatcher.dispatchEvent(new Mi(Mi.REMOVE_HOLE,this.object))),this._currentState=t)}handleAutomaticStateUpdate(){if(!this.object)return;const t=this.object.model;if(!t)return;const e=t.getValue(C.FURNITURE_AUTOMATIC_STATE_INDEX);isNaN(e)||this.handleStateUpdate(e%2)}};Jl.STATE_HOLE=0;let $T=Jl;const $l=class $l extends Ds{constructor(){super(...arguments),this._state=-1}initialize(t){super.initialize(t),this.object&&this.object.model.setValue(C.FURNITURE_FRIENDFURNI_ENGRAVING,this.engravingDialogType)}processUpdateMessage(t){if(t instanceof je){const e=t.data;e?this._state=e.state:this._state=t.state}super.processUpdateMessage(t)}getEventTypes(){const t=[X.FRIEND_FURNITURE_ENGRAVING];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||(this._state===$l.STATE_LOCKED?this.eventDispatcher.dispatchEvent(new X(X.FRIEND_FURNITURE_ENGRAVING,this.object)):super.useObject())}get engravingDialogType(){return 0}get contextMenu(){return this._state===$l.STATE_UNLOCKED?ts.FRIEND_FURNITURE:ts.DUMMY}};$l.STATE_UNINITIALIZED=-1,$l.STATE_UNLOCKED=0,$l.STATE_LOCKED=1;let hf=$l;const ra=class ra extends Ds{getEventTypes(){const t=[Gn.LOAD_BADGE,X.GUILD_FURNI_CONTEXT_MENU,X.CLOSE_FURNI_CONTEXT_MENU];return this.mergeTypes(super.getEventTypes(),t)}processUpdateMessage(t){if(super.processUpdateMessage(t),t instanceof je){const e=t.data;e instanceof Vn&&(this.updateGroupId(e.getValue(ra.GROUPID_KEY)),this.updateBadge(e.getValue(ra.BADGE_KEY)),this.updateColors(e.getValue(ra.COLOR1_KEY),e.getValue(ra.COLOR2_KEY)))}else t instanceof xc?t.assetName!=="loading_icon"&&(this.object.model.setValue(C.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME,t.assetName),this.update(Pt())):t instanceof e_&&(t.selected||this.eventDispatcher.dispatchEvent(new X(X.CLOSE_FURNI_CONTEXT_MENU,this.object)))}updateGroupId(t){this.object.model.setValue(C.FURNITURE_GUILD_CUSTOMIZED_GUILD_ID,parseInt(t))}updateBadge(t){this.eventDispatcher.dispatchEvent(new Gn(Gn.LOAD_BADGE,this.object,t,!0))}updateColors(t,e){this.object.model.setValue(C.FURNITURE_GUILD_CUSTOMIZED_COLOR_1,parseInt(t,16)),this.object.model.setValue(C.FURNITURE_GUILD_CUSTOMIZED_COLOR_2,parseInt(e,16))}mouseEvent(t,e){if(!(!t||!e||!this.object)){switch(t.type){case at.MOUSE_CLICK:this.openContextMenu()}super.mouseEvent(t,e)}}openContextMenu(){this.eventDispatcher.dispatchEvent(new X(X.GUILD_FURNI_CONTEXT_MENU,this.object))}};ra.GROUPID_KEY=1,ra.BADGE_KEY=2,ra.COLOR1_KEY=3,ra.COLOR2_KEY=4;let df=ra;class WX extends df{getEventTypes(){const t=[X.INERNAL_LINK];return this.mergeTypes(super.getEventTypes(),t)}updateGroupId(t){super.updateGroupId(t),this.object.model.setValue(C.FURNITURE_INTERNAL_LINK,`groupforum/${t}`)}useObject(){!this.object||!this.eventDispatcher||(this.eventDispatcher.dispatchEvent(new X(X.INERNAL_LINK,this.object)),super.useObject())}}class YX extends Te{getEventTypes(){const t=[lt.USE_HABBOWHEEL];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new lt(lt.USE_HABBOWHEEL,this.object))}}const rE=class rE extends Te{constructor(){super(...arguments),this._state=-1}getEventTypes(){return[X.HIGH_SCORE_DISPLAY,X.HIDE_HIGH_SCORE_DISPLAY]}tearDown(){this.object.model.getValue(C.FURNITURE_REAL_ROOM_OBJECT)===1&&this.eventDispatcher.dispatchEvent(new X(X.HIDE_HIGH_SCORE_DISPLAY,this.object)),super.tearDown()}processUpdateMessage(t){super.processUpdateMessage(t),this.object.model.getValue(C.FURNITURE_REAL_ROOM_OBJECT)===1&&t instanceof je&&(t.state===rE.SHOW_WIDGET_IN_STATE?this.eventDispatcher.dispatchEvent(new X(X.HIGH_SCORE_DISPLAY,this.object)):this.eventDispatcher.dispatchEvent(new X(X.HIDE_HIGH_SCORE_DISPLAY,this.object)),this._state=t.state)}};rE.SHOW_WIDGET_IN_STATE=1;let ZT=rE;class zX extends Te{getEventTypes(){const t=[_e.STATE_CHANGE];return this.mergeTypes(super.getEventTypes(),t)}mouseEvent(t,e){if(!t||!e||!this.object)return;let s=null;switch(t.type){case at.DOUBLE_CLICK:switch(t.spriteTag){case"off":s=new _e(_e.STATE_CHANGE,this.object,3);break}break;case at.MOUSE_CLICK:switch(t.spriteTag){case"inc":s=new _e(_e.STATE_CHANGE,this.object,2);break;case"dec":s=new _e(_e.STATE_CHANGE,this.object,1);break}break}if(this.eventDispatcher&&s){this.eventDispatcher.dispatchEvent(s);return}super.mouseEvent(t,e)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new _e(_e.STATE_CHANGE,this.object,3))}}class KX extends hf{get engravingDialogType(){return _g.HABBOWEEN}}class XX extends Ds{constructor(){super(),this._nextState=0,this._nextStateTimestamp=0}update(t){if(this._nextStateTimestamp>0&&t>=this._nextStateTimestamp){this._nextStateTimestamp=0;const e=new wi;e.setString(this._nextState.toString()),super.processUpdateMessage(new je(this._nextState,e,this._nextStateExtra))}super.update(t)}processUpdateMessage(t){if(t instanceof je){this.processUpdate(t);return}super.processUpdateMessage(t)}processUpdate(t){if(!t)return;const e=~~(t.state/1e3),s=~~(t.state%1e3);if(s)this._nextState=e,this._nextStateExtra=t.extra,this._nextStateTimestamp=this.time+s;else{this._nextStateTimestamp=0;const i=new wi;i.setString(e.toString()),super.processUpdateMessage(new je(e,i,t.extra))}}}class qX extends Te{constructor(){super(...arguments),this._showStateOnceRendered=!1,this._updateCount=0}getEventTypes(){const t=[X.INERNAL_LINK];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),t.logic&&t.logic.action&&(this.object.model.setValue(C.FURNITURE_INTERNAL_LINK,t.logic.action.link),t.logic.action.startState===1&&(this._showStateOnceRendered=!0))}update(t){super.update(t),this._showStateOnceRendered&&(this._updateCount++,this._showStateOnceRendered&&this._updateCount===20&&(this.setAutomaticStateIndex(1),this._showStateOnceRendered=!1))}setAutomaticStateIndex(t){this.object&&this.object.model&&this.object.model.setValue(C.FURNITURE_AUTOMATIC_STATE_INDEX,t)}mouseEvent(t,e){!t||!e||(t.type===at.DOUBLE_CLICK&&this._showStateOnceRendered&&this.setAutomaticStateIndex(0),super.mouseEvent(t,e))}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new X(X.INERNAL_LINK,this.object))}}class QX extends Ds{constructor(){super(...arguments),this._disposeEventsAllowed=!1,this._isInitialized=!1,this._currentState=-1}getEventTypes(){const t=[lt.JUKEBOX_START,lt.JUKEBOX_MACHINE_STOP,lt.JUKEBOX_DISPOSE,lt.JUKEBOX_INIT,X.JUKEBOX_PLAYLIST_EDITOR];return this.mergeTypes(super.getEventTypes(),t)}onDispose(){this.requestDispose(),super.onDispose()}processUpdateMessage(t){if(super.processUpdateMessage(t),this.object.model.getValue(C.FURNITURE_REAL_ROOM_OBJECT)===1&&(this._isInitialized||this.requestInit(),this.object.model.setValue(Ms.INFOSTAND_EXTRA_PARAM,Ms.JUKEBOX),t instanceof je)){const e=this.object.getState(0);e!==this._currentState&&(this._currentState=e,e===1?this.requestPlayList():e===0&&this.requestStopPlaying())}}requestInit(){!this.object||!this.eventDispatcher||(this._disposeEventsAllowed=!0,this.eventDispatcher.dispatchEvent(new lt(lt.JUKEBOX_INIT,this.object)),this._isInitialized=!0)}requestPlayList(){!this.object||!this.eventDispatcher||(this._disposeEventsAllowed=!0,this.eventDispatcher.dispatchEvent(new lt(lt.JUKEBOX_START,this.object)))}requestStopPlaying(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new lt(lt.JUKEBOX_MACHINE_STOP,this.object))}requestDispose(){!this._disposeEventsAllowed||!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new lt(lt.JUKEBOX_DISPOSE,this.object))}useObject(){!this.object||!this.eventDispatcher||(this.eventDispatcher.dispatchEvent(new X(X.JUKEBOX_PLAYLIST_EDITOR,this.object)),this.eventDispatcher.dispatchEvent(new _e(_e.STATE_CHANGE,this.object,-1)))}}class JX extends hf{get engravingDialogType(){return _g.LOVE_LOCK}}const Bo=class Bo extends Te{getEventTypes(){const t=[X.MANNEQUIN];return this.mergeTypes(super.getEventTypes(),t)}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof je&&(t.data.writeRoomObjectModel(this.object.model),this.processObjectData())}processObjectData(){if(!this.object||!this.object.model)return;const t=new Oc;t.initializeFromRoomObjectModel(this.object.model),this.object.model.setValue(C.FURNITURE_MANNEQUIN_GENDER,t.getValue(Bo.GENDER)),this.object.model.setValue(C.FURNITURE_MANNEQUIN_FIGURE,t.getValue(Bo.FIGURE)),this.object.model.setValue(C.FURNITURE_MANNEQUIN_NAME,t.getValue(Bo.OUTFIT_NAME))}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new X(X.MANNEQUIN,this.object))}};Bo.GENDER="GENDER",Bo.FIGURE="FIGURE",Bo.OUTFIT_NAME="OUTFIT_NAME";let tR=Bo;class $X extends Ds{getEventTypes(){const t=[X.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new X(X.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG,this.object))}get contextMenu(){return ts.MONSTERPLANT_SEED}}class ZX extends Ds{initialize(t){super.initialize(t),this.object&&this.object.model&&this.object.model.setValue(C.FURNITURE_IS_VARIABLE_HEIGHT,1)}}class t6 extends Ds{getEventTypes(){const t=[X.MYSTERYBOX_OPEN_DIALOG];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new X(X.MYSTERYBOX_OPEN_DIALOG,this.object))}get contextMenu(){return ts.MYSTERY_BOX}}class e6 extends Ds{getEventTypes(){const t=[X.MYSTERYTROPHY_OPEN_DIALOG];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new X(X.MYSTERYTROPHY_OPEN_DIALOG,this.object))}get contextMenu(){return ts.MYSTERY_TROPHY}}class s6 extends Te{getEventTypes(){const t=[lt.ENTER_ONEWAYDOOR];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new lt(lt.ENTER_ONEWAYDOOR,this.object))}}class i6 extends Te{getEventTypes(){const t=[X.PET_PRODUCT_MENU];return this.mergeTypes(super.getEventTypes(),t)}processUpdateMessage(t){super.processUpdateMessage(t),this.object&&this.object.model.getValue(C.FURNITURE_REAL_ROOM_OBJECT)===1&&this.object.model.setValue(Ms.INFOSTAND_EXTRA_PARAM,Ms.USABLE_PRODUCT)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new X(X.PET_PRODUCT_MENU,this.object))}}class r6 extends Te{getEventTypes(){const t=[X.PLACEHOLDER];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new X(X.PLACEHOLDER,this.object))}}class n6 extends Te{initialize(t){super.initialize(t),t.logic&&t.logic.planetSystems&&this.object.model.setValue(C.FURNITURE_PLANETSYSTEM_DATA,t.logic.planetSystems)}}const tn=class tn extends Te{getEventTypes(){const t=[X.PRESENT];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),t.logic&&t.logic.particleSystems&&t.logic.particleSystems.length&&this.object.model.setValue(C.FURNITURE_FIREWORKS_DATA,t.logic.particleSystems)}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof je&&(t.data.writeRoomObjectModel(this.object.model),this.updateStuffData()),t instanceof HU&&t.numberKey===C.FURNITURE_DISABLE_PICKING_ANIMATION&&this.object.model.setValue(C.FURNITURE_DISABLE_PICKING_ANIMATION,t.numberValue)}updateStuffData(){if(!this.object||!this.object.model)return;const t=new Oc;t.initializeFromRoomObjectModel(this.object.model);const e=t.getValue(tn.MESSAGE),s=this.object.model.getValue(C.FURNITURE_DATA);!e&&typeof s=="string"?this.object.model.setValue(C.FURNITURE_DATA,s.substr(1)):this.object.model.setValue(C.FURNITURE_DATA,t.getValue(tn.MESSAGE)),this.writeToModel(C.FURNITURE_TYPE_ID,t.getValue(tn.PRODUCT_CODE)),this.writeToModel(C.FURNITURE_PURCHASER_NAME,t.getValue(tn.PURCHASER_NAME)),this.writeToModel(C.FURNITURE_PURCHASER_FIGURE,t.getValue(tn.PURCHASER_FIGURE))}writeToModel(t,e){e&&this.object.model.setValue(t,e)}mouseEvent(t,e){if(!(!t||!e||!this.object)){switch(t.type){case at.ROLL_OVER:this.eventDispatcher.dispatchEvent(new lt(lt.MOUSE_BUTTON,this.object));break;case at.ROLL_OUT:this.eventDispatcher.dispatchEvent(new lt(lt.MOUSE_ARROW,this.object));break}super.mouseEvent(t,e)}}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new X(X.PRESENT,this.object))}};tn.MESSAGE="MESSAGE",tn.PRODUCT_CODE="PRODUCT_CODE",tn.EXTRA_PARAM="EXTRA_PARAM",tn.PURCHASER_NAME="PURCHASER_NAME",tn.PURCHASER_FIGURE="PURCHASER_FIGURE";let eR=tn;class a6 extends Ds{getEventTypes(){const t=[X.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new X(X.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG,this.object))}get contextMenu(){return ts.PURCHASABLE_CLOTHING}}const to=class to extends Ds{constructor(){super(),this.updateInterval=al.DEFAULT_UPDATE_INTERVAL,this._oldLocation=new j}processUpdateMessage(t){if(!t)return;const e=t instanceof nl;if(this.object&&!e&&t.location){const s=this.object.getLocation(),i=j.dif(t.location,s);if(i&&Math.abs(i.x)<2&&Math.abs(i.y)<2){let n=s;(Math.abs(i.x)>1||Math.abs(i.y)>1)&&(n=j.sum(s,j.product(i,.5))),super.processUpdateMessage(new nl(n,t.location,t.direction));return}}if(t.location&&!e&&super.processUpdateMessage(new nl(t.location,t.location,t.direction)),t instanceof je){t.state>0?this.updateInterval=al.DEFAULT_UPDATE_INTERVAL/this.getUpdateIntervalValue(t.state):this.updateInterval=1,this.handleDataUpdate(t);return}e&&t.isSlide&&(this.updateInterval=al.DEFAULT_UPDATE_INTERVAL),super.processUpdateMessage(t)}getUpdateIntervalValue(t){return t/to.MAX_ANIMATION_COUNT}getAnimationValue(t){return t%to.MAX_ANIMATION_COUNT}handleDataUpdate(t){const e=this.getAnimationValue(t.state);if(e!==t.state){const s=new wi;s.setString(e.toString()),t=new je(e,s,t.extra)}super.processUpdateMessage(t)}update(t){this.object&&(this._oldLocation.assign(this.object.getLocation()),super.update(t),j.dif(this.object.getLocation(),this._oldLocation).length===0&&this.object.getState(0)!==to.ANIMATION_NOT_MOVING&&this.object.setState(to.ANIMATION_NOT_MOVING,0))}};to.ANIMATION_NOT_MOVING=0,to.ANIMATION_MOVING=1,to.MAX_ANIMATION_COUNT=10;let sR=to;class o6 extends Te{getEventTypes(){const t=[_e.STATE_RANDOM];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new _e(_e.STATE_RANDOM,this.object))}}class l6 extends Ds{get contextMenu(){return ts.RANDOM_TELEPORT}}class c6 extends Te{getEventTypes(){const t=[gn.RODRE_CURRENT_USER_ID];return this.mergeTypes(super.getEventTypes(),t)}update(t){if(super.update(t),this.object&&this.object.model){this.object.model.getValue(C.SESSION_CURRENT_USER_ID)||this.eventDispatcher.dispatchEvent(new gn(gn.RODRE_CURRENT_USER_ID,this.object));const e=this.object.model.getValue(C.FURNITURE_DATA).renterId,s=this.object.model.getValue(C.SESSION_CURRENT_USER_ID);e?parseInt(e)===s?this.object.setState(2,0):this.object.setState(1,0):this.object.setState(0,0)}}get widget(){return Fd.RENTABLESPACE}}class u6 extends Ds{constructor(){super(),this._roomColorUpdated=!1}getEventTypes(){const t=[X.BACKGROUND_COLOR,oo.ROOM_BACKGROUND_COLOR];return this.mergeTypes(super.getEventTypes(),t)}onDispose(){this._roomColorUpdated&&(this.eventDispatcher&&this.object&&this.object.model.getValue(C.FURNITURE_REAL_ROOM_OBJECT)===1&&this.eventDispatcher.dispatchEvent(new oo(oo.ROOM_BACKGROUND_COLOR,this.object,!1,0,0,0)),this._roomColorUpdated=!1),super.onDispose()}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof je&&(t.data.writeRoomObjectModel(this.object.model),this.object.model.getValue(C.FURNITURE_REAL_ROOM_OBJECT)===1&&this.processColorUpdate())}processColorUpdate(){if(!this.object||!this.object.model)return;const t=new jd;t.initializeFromRoomObjectModel(this.object.model);const e=t.getValue(0),s=t.getValue(1),i=t.getValue(2),n=t.getValue(3);e>-1&&s>-1&&i>-1&&n>-1&&(this.object.model.setValue(C.FURNITURE_ROOM_BACKGROUND_COLOR_HUE,s),this.object.model.setValue(C.FURNITURE_ROOM_BACKGROUND_COLOR_SATURATION,i),this.object.model.setValue(C.FURNITURE_ROOM_BACKGROUND_COLOR_LIGHTNESS,n),this.object.setState(e,0),this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new oo(oo.ROOM_BACKGROUND_COLOR,this.object,e===1,s,i,n)),this._roomColorUpdated=!0)}mouseEvent(t,e){if(!(!t||!e||!this.object)){switch(t.type){case at.DOUBLE_CLICK:this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new X(X.BACKGROUND_COLOR,this.object));return}super.mouseEvent(t,e)}}}const ti=class ti extends Te{constructor(){super(),this._disableFurnitureSelection=!0,this._hasClickUrl=!1}getEventTypes(){const t=[Ze.ROOM_AD_LOAD_IMAGE];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),this._disableFurnitureSelection&&this.object.model.setValue(C.FURNITURE_SELECTION_DISABLED,1)}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof je&&this.processAdDataUpdateMessage(t),t instanceof ki&&this.processAdUpdate(t)}processAdDataUpdateMessage(t){if(!t)return;const e=new Oc;e.initializeFromRoomObjectModel(this.object.model);const s=parseInt(e.getValue(ti.STATE));!isNaN(s)&&this.object.getState(0)!==s&&this.object.setState(s,0);const i=e.getValue(ti.IMAGEURL_KEY),n=this.object.model.getValue(C.FURNITURE_BRANDING_IMAGE_URL);(!n||n!==i)&&(this.object.model.setValue(C.FURNITURE_BRANDING_IMAGE_URL,i),this.object.model.setValue(C.FURNITURE_BRANDING_IMAGE_STATUS,0),this.downloadBackground());const o=e.getValue(ti.CLICKURL_KEY);if(o){const d=this.object.model.getValue(C.FURNITURE_BRANDING_URL);(!d||d!==o)&&this.object.model&&this.object.model.setValue(C.FURNITURE_BRANDING_URL,o)}const l=parseInt(e.getValue(ti.OFFSETX_KEY)),c=parseInt(e.getValue(ti.OFFSETY_KEY)),u=parseInt(e.getValue(ti.OFFSETZ_KEY));isNaN(l)||this.object.model.setValue(C.FURNITURE_BRANDING_OFFSET_X,l),isNaN(c)||this.object.model.setValue(C.FURNITURE_BRANDING_OFFSET_Y,c),isNaN(u)||this.object.model.setValue(C.FURNITURE_BRANDING_OFFSET_Z,u);let h=ti.IMAGEURL_KEY+"="+(i!==null?i:"")+"	";this._hasClickUrl&&(h=h+(ti.CLICKURL_KEY+"="+(o!==null?o:"")+"	")),h=h+(ti.OFFSETX_KEY+"="+l+"	"),h=h+(ti.OFFSETY_KEY+"="+c+"	"),h=h+(ti.OFFSETZ_KEY+"="+u+"	"),this.object.model.setValue(Ms.INFOSTAND_EXTRA_PARAM,Ms.BRANDING_OPTIONS+h)}processAdUpdate(t){if(!(!t||!this.object))switch(t.type){case ki.IMAGE_LOADED:this.object.model.setValue(C.FURNITURE_BRANDING_IMAGE_STATUS,1);break;case ki.IMAGE_LOADING_FAILED:this.object.model.setValue(C.FURNITURE_BRANDING_IMAGE_STATUS,-1);break}}mouseEvent(t,e){!t||!e||t.type===at.MOUSE_MOVE||t.type===at.DOUBLE_CLICK||super.mouseEvent(t,e)}async downloadBackground(){const t=this.object&&this.object.model;if(!t)return;const e=t.getValue(C.FURNITURE_BRANDING_IMAGE_URL),s=t.getValue(C.FURNITURE_BRANDING_IMAGE_STATUS);if(!(!e||e===""||s===1))if(e.endsWith(".gif"))this.object.model.setValue(C.FURNITURE_BRANDING_IS_ANIMATED,!0),fetch(e).then(i=>i.arrayBuffer()).then(i=>Mj(i)).then(i=>{const n=i.lsd.width,o=i.lsd.height,l=n*o,c=yj(i,!1),u=[],h=[];let d=new Uint8Array(l*4);for(let g=0;g<c.length;g++){g>0&&(d=d.slice(0));const E=c[g].pixels,m=c[g].colorTable,I=c[g].transparentIndex,p=c[g].dims;for(let R=0;R<p.height;R++)for(let S=0;S<p.width;S++){const b=E[R*p.width+S],N=(R+p.top)*n+(S+p.left);if(I!==b){const P=m[b];d[4*N]=P[0],d[4*N+1]=P[1],d[4*N+2]=P[2],d[4*N+3]=255}}const T=HE.fromBuffer(d,n,o);u.push(new Es(T)),h.push(c[g].delay)}Et.instance.roomEngine.roomContentLoader.createGifCollection(e,u,h),this.processUpdateMessage(new ki(ki.IMAGE_LOADED))}).catch(i=>{this.processUpdateMessage(new ki(ki.IMAGE_LOADING_FAILED))});else{const i=Rr();if(!i)return;if(!i.getTexture(e)){await i.downloadAsset(e)?this.processUpdateMessage(new ki(ki.IMAGE_LOADED)):this.processUpdateMessage(new ki(ki.IMAGE_LOADING_FAILED));return}this.processUpdateMessage(new ki(ki.IMAGE_LOADED))}}};ti.STATE="state",ti.IMAGEURL_KEY="imageUrl",ti.CLICKURL_KEY="clickUrl",ti.OFFSETX_KEY="offsetX",ti.OFFSETY_KEY="offsetY",ti.OFFSETZ_KEY="offsetZ";let _f=ti;class h6 extends _f{getAdClickUrl(t){return null}}class d6 extends _f{constructor(){super(),this._hasClickUrl=!0}getAdClickUrl(t){return t.getValue(C.FURNITURE_BRANDING_URL)}handleAdClick(t,e,s){if(s.indexOf("http")===0){Hn.openWebPage(s);return}this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Ze(Ze.ROOM_AD_FURNI_CLICK,this.object,"",s))}}class _6 extends Te{constructor(){super(),this._roomColorUpdated=!1}getEventTypes(){const t=[X.DIMMER,X.WIDGET_REMOVE_DIMMER,mc.DIMMER_STATE];return this.mergeTypes(super.getEventTypes(),t)}onDispose(){this._roomColorUpdated&&this.eventDispatcher&&this.object&&(this.object.model.getValue(C.FURNITURE_REAL_ROOM_OBJECT)===1&&(this.eventDispatcher.dispatchEvent(new mc(this.object,0,1,1,16777215,255)),this.eventDispatcher.dispatchEvent(new X(X.WIDGET_REMOVE_DIMMER,this.object))),this._roomColorUpdated=!1),super.onDispose()}processUpdateMessage(t){if(t instanceof je){if(t.data){const e=t.data.getLegacyString();this.object.model.getValue(C.FURNITURE_REAL_ROOM_OBJECT)===1&&this.processDimmerData(e),super.processUpdateMessage(new je(this.getStateFromDimmerData(e),t.data))}return}super.processUpdateMessage(t)}getStateFromDimmerData(t){if(!t)return 0;const e=t.split(",");return e.length>=5?parseInt(e[0])-1:0}processDimmerData(t){if(!t)return;const e=t.split(",");if(e.length>=5){const s=this.getStateFromDimmerData(t),i=parseInt(e[1]),n=parseInt(e[2]),o=e[3];let l=parseInt(o.substr(1),16),c=parseInt(e[4]);s||(l=16777215,c=255),this.eventDispatcher&&this.object&&(this.eventDispatcher.dispatchEvent(new mc(this.object,s,i,n,l,c)),this._roomColorUpdated=!0)}}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new X(X.DIMMER,this.object))}update(t){super.update(t)}}const ko=class ko extends Te{constructor(){super(),this._score=0,this._scoreIncreaser=50,this._scoreTimer=0}processUpdateMessage(t){if(t instanceof je)return this.updateScore(t.state);super.processUpdateMessage(t)}updateScore(t){this._score=t;const e=this.object.getState(0);if(this._score!==e){let s=this._score-e;s<0&&(s=-s),s*ko.UPDATE_INTERVAL>ko.MAX_UPDATE_TIME?this._scoreIncreaser=ko.MAX_UPDATE_TIME/s:this._scoreIncreaser=ko.UPDATE_INTERVAL,this._scoreTimer=Pt()}}update(t){super.update(t);const e=this.object.getState(0);if(e!==this._score&&t>=this._scoreTimer+this._scoreIncreaser){const s=t-this._scoreTimer;let i=s/this._scoreIncreaser,n=1;this._score<e&&(n=-1),i>n*(this._score-e)&&(i=n*(this._score-e)),this.object.setState(e+n*i,0),this._scoreTimer=t-(s-i*this._scoreIncreaser)}}};ko.UPDATE_INTERVAL=50,ko.MAX_UPDATE_TIME=3e3;let iR=ko;class g6 extends Te{processUpdateMessage(t){if(super.processUpdateMessage(t),this.object.model.getValue(C.FURNITURE_REAL_ROOM_OBJECT)===1){const e=this.object.model.getValue(C.FURNITURE_EXTRAS),s=parseInt(e);this.object.model.setValue(Ms.INFOSTAND_EXTRA_PARAM,Ms.SONGDISK+s)}}}const en=class en extends Ds{constructor(){super(...arguments),this._state=-1,this._sampleId=-1,this._noPitch=!1,this._lastLocZ=0}getEventTypes(){const t=[vs.ROOM_OBJECT_INITIALIZED,vs.ROOM_OBJECT_DISPOSED,vs.PLAY_SAMPLE,vs.CHANGE_PITCH];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),t.logic&&t.logic.soundSample&&(this._sampleId=t.logic.soundSample.id,this._noPitch=t.logic.soundSample.noPitch),this.object.model.setValue(C.FURNITURE_SOUNDBLOCK_RELATIVE_ANIMATION_SPEED,1)}onDispose(){this._state!==en.STATE_UNINITIALIZED&&this.eventDispatcher.dispatchEvent(new vs(vs.ROOM_OBJECT_DISPOSED,this.object,this._sampleId)),super.onDispose()}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof je&&this.updateSoundBlockMessage(t)}updateSoundBlockMessage(t){if(!t)return;const e=this.object&&this.object.model,s=this.object&&this.object.location;!e||!s||(this._state===en.STATE_UNINITIALIZED&&e.getValue(C.FURNITURE_REAL_ROOM_OBJECT)===1&&(this._lastLocZ=s.z,this.eventDispatcher.dispatchEvent(new vs(vs.ROOM_OBJECT_INITIALIZED,this.object,this._sampleId,this.getPitchForHeight(s.z)))),this._state!==en.STATE_UNINITIALIZED&&e.getValue(C.FURNITURE_REAL_ROOM_OBJECT)===1&&this._lastLocZ!==s.z&&(this._lastLocZ=s.z,this.eventDispatcher.dispatchEvent(new vs(vs.CHANGE_PITCH,this.object,this._sampleId,this.getPitchForHeight(s.z)))),this._state!==en.STATE_UNINITIALIZED&&t.state!==this._state&&this.playSoundAt(s.z),this._state=t.state)}playSoundAt(t){if(!this.object)return;const e=this.getPitchForHeight(t);this.object.model.setValue(C.FURNITURE_SOUNDBLOCK_RELATIVE_ANIMATION_SPEED,e),this.eventDispatcher.dispatchEvent(new vs(vs.PLAY_SAMPLE,this.object,this._sampleId,e))}getPitchForHeight(t){if(this._noPitch)return 1;let e=t*2;return e>en.HIGHEST_SEMITONE&&(e=Math.min(0,en.LOWEST_SEMITONE+(e-en.HIGHEST_SEMITONE-1))),Math.pow(2,e/12)}};en.HIGHEST_SEMITONE=12,en.LOWEST_SEMITONE=-12,en.STATE_UNINITIALIZED=-1;let rR=en;class f6 extends Ds{constructor(){super(...arguments),this._disposeEventsAllowed=!1,this._isInitialized=!1,this._currentState=-1}getEventTypes(){const t=[lt.SOUND_MACHINE_START,lt.SOUND_MACHINE_STOP,lt.SOUND_MACHINE_DISPOSE,lt.SOUND_MACHINE_INIT];return this.mergeTypes(super.getEventTypes(),t)}onDispose(){this.requestDispose(),super.onDispose()}processUpdateMessage(t){if(super.processUpdateMessage(t),this.object.model.getValue(C.FURNITURE_REAL_ROOM_OBJECT)===1&&(this._isInitialized||this.requestInit(),this.object.model.setValue(Ms.INFOSTAND_EXTRA_PARAM,Ms.JUKEBOX),t instanceof je)){const e=this.object.getState(0);e!==this._currentState&&(this._currentState=e,e===1?this.requestPlayList():e===0&&this.requestStopPlaying())}}requestInit(){!this.object||!this.eventDispatcher||(this._disposeEventsAllowed=!0,this.eventDispatcher.dispatchEvent(new lt(lt.SOUND_MACHINE_INIT,this.object)),this._isInitialized=!0)}requestPlayList(){!this.object||!this.eventDispatcher||(this._disposeEventsAllowed=!0,this.eventDispatcher.dispatchEvent(new lt(lt.SOUND_MACHINE_START,this.object)))}requestStopPlaying(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new lt(lt.SOUND_MACHINE_STOP,this.object))}requestDispose(){!this._disposeEventsAllowed||!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new lt(lt.SOUND_MACHINE_DISPOSE,this.object))}}const nE=class nE extends Te{getEventTypes(){const t=[X.STICKIE,lt.STICKIE];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),this.updateColor(),this.object&&this.object.model.setValue(C.FURNITURE_IS_STICKIE,"")}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof TO&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new X(X.STICKIE,this.object)),this.updateColor()}updateColor(){if(!this.object)return;const t=this.object.model.getValue(C.FURNITURE_DATA);let e=nE.STICKIE_COLORS.indexOf(t);e<0&&(e=3),this.object.model.setValue(C.FURNITURE_COLOR,e+1)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new lt(lt.STICKIE,this.object))}};nE.STICKIE_COLORS=["9CCEFF","FF9CFF","9CFF9C","FFFF33"];let nR=nE;class m6 extends Te{getEventTypes(){const t=[X.TROPHY];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new X(X.TROPHY,this.object))}}const Vo=class Vo extends Ds{constructor(){super(),this._total=0,this._lastUpdate=0,this._interval=33}processUpdateMessage(t){if(super.processUpdateMessage(t),t instanceof je){const e=t.data;if(!e)return;this.updateTotal(e.result)}}updateTotal(t){if(this._total=t,!this._lastUpdate){this.object.model.setValue(C.FURNITURE_VOTE_COUNTER_COUNT,t),this._lastUpdate=Pt();return}if(this._total!==this.currentTotal){const e=Math.abs(this._total-this.currentTotal);e*Vo.UPDATE_INTERVAL>Vo.MAX_UPDATE_TIME?this._interval=Vo.MAX_UPDATE_TIME/e:this._interval=Vo.UPDATE_INTERVAL,this._lastUpdate=Pt()}}update(t){if(super.update(t),this.object&&this.currentTotal!==this._total&&t>=this._lastUpdate+this._interval){const e=t-this._lastUpdate;let s=e/this._interval,i=1;this._total<this.currentTotal&&(i=-1),s>i*(this._total-this.currentTotal)&&(s=i*(this._total-this.currentTotal)),this.object.model.setValue(C.FURNITURE_VOTE_COUNTER_COUNT,this.currentTotal+i*s),this._lastUpdate=t-(e-s*this._interval)}}get currentTotal(){return this.object.model.getValue(C.FURNITURE_VOTE_COUNTER_COUNT)}};Vo.UPDATE_INTERVAL=33,Vo.MAX_UPDATE_TIME=1e3;let aR=Vo;class E6 extends Ds{processUpdateMessage(t){if(super.processUpdateMessage(t),!!this.object&&t instanceof je){const e=t.data;e instanceof wd&&this.object.model.setValue(C.FURNITURE_VOTE_MAJORITY_RESULT,e.result)}}}class p6 extends Ds{mouseEvent(t,e){!t||!e||(t.type===at.DOUBLE_CLICK&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new _e(_e.STATE_CHANGE,this.object)),super.mouseEvent(t,e))}}class I6 extends Ds{initialize(t){super.initialize(t);let e="";t.logic&&t.logic.maskType&&t.logic.maskType!==""&&t.logic.maskType.length>0&&(e=t.logic.maskType),this.object.model.setValue(C.FURNITURE_USES_PLANE_MASK,1),this.object.model.setValue(C.FURNITURE_PLANE_MASK_TYPE,e)}}class T6 extends Te{getEventTypes(){const t=[X.YOUTUBE,gn.RODRE_URL_PREFIX];return this.mergeTypes(super.getEventTypes(),t)}update(t){super.update(t),this.object.model.getValue(C.SESSION_URL_PREFIX)||this.eventDispatcher.dispatchEvent(new gn(gn.RODRE_URL_PREFIX,this.object))}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new X(X.YOUTUBE,this.object))}}class R6 extends al{constructor(){super(),this._selected=!1,this._reportedLocation=null,this._postureIndex=0,this._gestureIndex=0,this._headDirectionDelta=0,this._directions=[],this._talkingEndTimestamp=0,this._gestureEndTimestamp=0,this._expressionEndTimestamp=0}getEventTypes(){const t=[Gt.CLICK,Ui.POSITION_CHANGED];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){if(!t)return;const e=this.object&&this.object.model;if(e){if(t.logic&&t.logic.model){const s=t.logic.model.directions;if(s&&s.length){for(const i of s)this._directions.push(i);this._directions.sort()}}e.setValue(C.PET_ALLOWED_DIRECTIONS,this._directions)}}dispose(){this._selected&&this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Ui(Ui.OBJECT_REMOVED,this.object)),this._directions=null,this._reportedLocation=null}update(t){if(super.update(t),this._selected&&this.object&&this.eventDispatcher){const e=this.object.getLocation();(!this._reportedLocation||this._reportedLocation.x!==e.x||this._reportedLocation.y!==e.y||this._reportedLocation.z!==e.z)&&(this._reportedLocation||(this._reportedLocation=new j),this._reportedLocation.assign(e),this.eventDispatcher.dispatchEvent(new Ui(Ui.POSITION_CHANGED,this.object)))}this.object&&this.object.model&&this.updateModel(t,this.object.model)}updateModel(t,e){this._gestureEndTimestamp>0&&t>this._gestureEndTimestamp&&(e.setValue(C.FIGURE_GESTURE,null),this._gestureEndTimestamp=0),this._talkingEndTimestamp>0&&t>this._talkingEndTimestamp&&(e.setValue(C.FIGURE_TALK,0),this._talkingEndTimestamp=0),this._expressionEndTimestamp>0&&t>this._expressionEndTimestamp&&(e.setValue(C.FIGURE_EXPRESSION,0),this._expressionEndTimestamp=0)}processUpdateMessage(t){if(!t||!this.object)return;super.processUpdateMessage(t);const e=this.object&&this.object.model;if(e){if(t instanceof cf){e.setValue(C.HEAD_DIRECTION,t.headDirection);return}if(t instanceof of){const s=new La(t.figure);e.setValue(C.FIGURE,t.figure),e.setValue(C.RACE,t.subType),e.setValue(C.PET_PALETTE_INDEX,s.paletteId),e.setValue(C.PET_COLOR,s.color),e.setValue(C.PET_TYPE,s.typeId),e.setValue(C.PET_CUSTOM_LAYER_IDS,s.customLayerIds),e.setValue(C.PET_CUSTOM_PARTS_IDS,s.customPartIds),e.setValue(C.PET_CUSTOM_PALETTE_IDS,s.customPaletteIds),e.setValue(C.PET_IS_RIDING,t.isRiding?1:0);return}if(t instanceof pO){e.setValue(C.FIGURE_POSTURE,t.postureType);return}if(t instanceof EO){e.setValue(C.FIGURE_TALK,1),this._talkingEndTimestamp=this.time+t.numberOfWords*1e3;return}if(t instanceof IO){e.setValue(C.FIGURE_SLEEP,t.isSleeping?1:0);return}if(t instanceof jU){e.setValue(C.FIGURE_GESTURE,t.gesture),this._gestureEndTimestamp=this.time+3e3;return}if(t instanceof lf){this._selected=t.selected,this._reportedLocation=null;return}if(t instanceof DU){e.setValue(C.FIGURE_EXPERIENCE_TIMESTAMP,this.time),e.setValue(C.FIGURE_GAINED_EXPERIENCE,t.gainedExperience);return}}}mouseEvent(t,e){let s=null;switch(t.type){case at.MOUSE_CLICK:s=Gt.CLICK;break;case at.DOUBLE_CLICK:break;case at.MOUSE_DOWN:{this.object.model.getValue(C.PET_TYPE)===xs.MONSTERPLANT&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Gt(Gt.MOUSE_DOWN,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown));break}}s&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Gt(s,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown))}}class YU{constructor(){this._width=0,this._height=0,this._wallHeight=0,this._fixedWallsHeight=0,this._tileMap=[],this._holeMap=[],this._doors=[],this._dimensions={minX:0,maxX:0,minY:0,maxY:0},this._restrictsDragging=!1,this._restrictedScale=1,this._restrictsScaling=!1}get width(){return this._width}set width(t){this._width=t}get height(){return this._height}set height(t){this._height=t}get wallHeight(){return this._wallHeight}set wallHeight(t){this._wallHeight=t}get fixedWallsHeight(){return this._fixedWallsHeight}set fixedWallsHeight(t){this._fixedWallsHeight=t}get tileMap(){return this._tileMap}get holeMap(){return this._holeMap}get doors(){return this._doors}get dimensions(){return this._dimensions}get restrictsDragging(){return this._restrictsDragging}set restrictsDragging(t){this._restrictsDragging=t}get restrictsScaling(){return this._restrictsScaling}set restrictsScaling(t){this._restrictsScaling=t}get restrictedScale(){return this._restrictedScale}set restrictedScale(t){this._restrictedScale=t}}const aE=class aE{constructor(t,e,s){this.type=t,this.loc=e,this.category=s}get loc(){return this._loc}set loc(t){this._loc||(this._loc=new j),this._loc.assign(t)}get type(){return this._type}set type(t){this._type=t}get category(){return this._category}set category(t){this._category=t}dispose(){this._loc=null}};aE.WINDOW="window",aE.HOLE="hole";let Mc=aE;class S6{constructor(){this._masks=[]}get masks(){return this._masks}}class zU{constructor(){this._masks=new Map}get maskCount(){return this._masks.size}dispose(){this._masks&&(this.reset(),this._masks=null)}initialize(t){if(!t)return!1;if(this._masks.clear(),t.masks.length)for(const e of t.masks){if(!e)continue;const s=e.locations.length?e.locations[0]:null;s&&this._masks.set(e.id,new Mc(e.type,s,e.category))}return!0}reset(){for(const t of this._masks.values())t&&t.dispose();this._masks.clear()}addMask(t,e,s,i){const n=new Mc(e,s,i);this._masks.delete(t),this._masks.set(t,n)}removeMask(t){const e=this._masks.get(t);return e?(this._masks.delete(t),e.dispose(),!0):!1}getXML(){const t=new S6;for(const[e,s]of this._masks.entries()){if(!s)continue;const i=this.getMaskType(s),n=this.getMaskCategory(s),o=this.getMaskLocation(s);if(i&&n&&o){const l={id:e,type:i,category:n,locations:[{x:o.x,y:o.y,z:o.z}]};t.masks.push(l)}}return t}getMaskLocation(t){return t?t.loc:null}getMaskType(t){return t?t.type:null}getMaskCategory(t){return t?t.category:null}get masks(){return this._masks}}class O6{constructor(t,e,s,i){this._leftSideLoc=0,this._rightSideLoc=0,this._leftSideLength=0,this._rightSideLength=0,this._leftSideLoc=t,this._rightSideLoc=e,this._leftSideLength=s,this._rightSideLength=i}get leftSideLoc(){return this._leftSideLoc}get rightSideLoc(){return this._rightSideLoc}get leftSideLength(){return this._leftSideLength}get rightSideLength(){return this._rightSideLength}}const Zl=class Zl{constructor(t,e,s,i,n){this._type=0,this._loc=null,this._leftSide=null,this._rightSide=null,this._normal=null,this._normalDirection=null;let o,l,c,u,h,d,g,E;if(this._secondaryNormals=[],this._masks=[],this._loc=new j,this._loc.assign(e),this._leftSide=new j,this._leftSide.assign(s),this._rightSide=new j,this._rightSide.assign(i),this._type=t,s!=null&&i!=null&&(this._normal=j.crossProduct(s,i),o=0,l=0,c=0,u=0,h=0,this.normal.x!=0||this.normal.y!=0?(u=this.normal.x,h=this.normal.y,o=360+Math.atan2(h,u)/Math.PI*180,o>=360&&(o=o-360),u=Math.sqrt(this.normal.x*this.normal.x+this.normal.y*this.normal.y),h=this.normal.z,l=360+Math.atan2(h,u)/Math.PI*180,l>=360&&(l=l-360)):this.normal.z<0?l=90:l=270,this._normalDirection=new j(o,l,c)),n!=null&&n.length>0)for(d=0;d<n.length;)g=n[d],g!=null&&g.length>0&&(E=new j,E.assign(g),E.multiply(1/E.length),this._secondaryNormals.push(E)),d++}get type(){return this._type}get loc(){return this._loc}get leftSide(){return this._leftSide}get rightSide(){return this._rightSide}get normal(){return this._normal}get normalDirection(){return this._normalDirection}get secondaryNormalCount(){return this._secondaryNormals.length}get maskCount(){return this._masks.length}getSecondaryNormal(t){if(t<0||t>=this.secondaryNormalCount)return null;const e=new j;return e.assign(this._secondaryNormals[t]),e}addMask(t,e,s,i){const n=new O6(t,e,s,i);this._masks.push(n)}getMask(t){return t<0||t>=this.maskCount?null:this._masks[t]}getMaskLeftSideLoc(t){const e=this.getMask(t);return e!=null?e.leftSideLoc:-1}getMaskRightSideLoc(t){const e=this.getMask(t);return e!=null?e.rightSideLoc:-1}getMaskLeftSideLength(t){const e=this.getMask(t);return e!=null?e.leftSideLength:-1}getMaskRightSideLength(t){const e=this.getMask(t);return e!=null?e.rightSideLength:-1}};Zl.PLANE_UNDEFINED=0,Zl.PLANE_FLOOR=1,Zl.PLANE_WALL=2,Zl.PLANE_LANDSCAPE=3,Zl.PLANE_BILLBOARD=4;let gs=Zl;class C6{constructor(t,e,s,i){this._x=t,this._y=e,this._width=s,this._height=i}get x(){return this._x}get y(){return this._y}get width(){return this._width}get height(){return this._height}}const bu=class bu{constructor(){this._corners=[],this._endPoints=[],this._directions=[],this._lengths=[],this._leftTurns=[],this._borders=[],this._hideWalls=[],this._manuallyLeftCut=[],this._manuallyRightCut=[],this._addDuplicates=!1,this._count=0}addWall(t,e,s,i,n){(this._addDuplicates||this.checkIsNotDuplicate(t,e,s,i,n))&&(this._corners.push(t),this._directions.push(e),this._lengths.push(s),this._borders.push(i),this._leftTurns.push(n),this._hideWalls.push(!1),this._manuallyLeftCut.push(!1),this._manuallyRightCut.push(!1),this._count++)}checkIsNotDuplicate(t,e,s,i,n){let o=0;for(;o<this._count;){if(this._corners[o].x==t.x&&this._corners[o].y==t.y&&this._directions[o]==e&&this._lengths[o]==s&&this._borders[o]==i&&this._leftTurns[o]==n)return!1;o++}return!0}get count(){return this._count}getCorner(t){return this._corners[t]}getEndPoint(t){return this.calculateWallEndPoints(),this._endPoints[t]}getLength(t){return this._lengths[t]}getDirection(t){return this._directions[t]}getBorder(t){return this._borders[t]}getHideWall(t){return this._hideWalls[t]}getLeftTurn(t){return this._leftTurns[t]}getManuallyLeftCut(t){return this._manuallyLeftCut[t]}getManuallyRightCut(t){return this._manuallyRightCut[t]}setHideWall(t,e){this._hideWalls[t]=e}setLength(t,e){e<this._lengths[t]&&(this._lengths[t]=e,this._manuallyRightCut[t]=!0)}moveCorner(t,e){let s;if(e>0&&e<this._lengths[t]){const i=this._corners[t];s=bu.WALL_DIRECTION_VECTORS[this.getDirection(t)],this._corners[t]=new wt(i.x+e*s.x,i.y+e*s.y),this._lengths[t]=this._lengths[t]-e,this._manuallyLeftCut[t]=!0}}calculateWallEndPoints(){let t,e,s,i,n;if(this._endPoints.length!=this.count)for(this._endPoints=[],t=0;t<this.count;)e=this.getCorner(t),s=new wt(e.x,e.y),i=bu.WALL_DIRECTION_VECTORS[this.getDirection(t)],n=this.getLength(t),s.x=s.x+i.x*n,s.y=s.y+i.y*n,this._endPoints.push(s),t++}};bu.WALL_DIRECTION_VECTORS=[new j(1,0,0),new j(0,1,0),new j(-1,0,0),new j(0,-1,0)],bu.WALL_NORMAL_VECTORS=[new j(0,1,0),new j(-1,0,0),new j(0,-1,0),new j(1,0,0)];let qn=bu;const oe=class oe{constructor(){this._width=0,this._height=0,this._minX=0,this._maxX=0,this._minY=0,this._maxY=0,this._fixedWallHeight=-1,this._floorHeight=0,this._restrictsScaling=!1,this._restrictedScale=1,this._tileMatrix=[],this._tileMatrixOriginal=[],this._planes=[],this._floorHoleMatrix=[],this._wallHeight=3.6,this._wallThicknessMultiplier=1,this._floorThicknessMultiplier=1,this._floorHoles=new Map}static getFloorHeight(t){const e=t.length;if(!e)return 0;let s=0,i=0;for(;i<e;){const n=t[i];let o=0;for(;o<n.length;){const l=n[o];l>s&&(s=l),o++}i++}return s}static findEntranceTile(t){if(!t)return null;const e=t.length;if(!e)return null;const s=[];let i=0;for(;i<e;){const n=t[i];if(!n||!n.length)return null;let o=0;for(;o<n.length;){if(n[o]>=0){s.push(o);break}o++}s.length<i+1&&s.push(n.length+1),i++}for(i=1;i<s.length-1;){if(Math.trunc(s[i])<=Math.trunc(s[i-1])-1&&Math.trunc(s[i])<=Math.trunc(s[i+1])-1)return new wt(Math.trunc(s[i]|0),i);i++}return null}static expandFloorTiles(t){let e,s,i,n,o,l,c,u,h,d,g,E;const m=t.length,I=t[0].length,p=[];for(s=0;s<m*4;)p[s]=[],s++;let T=0;for(s=0;s<m;){for(o=0,e=0;e<I;){if(l=t[s][e],l<0||l<=255)for(n=0;n<4;){for(i=0;i<4;)p[T+n]===void 0&&(p[T+n]=[]),p[T+n][o+i]=l<0?l:l*4,i++;n++}else{for(c=(l&255)*4,u=c+(l>>11&1)*3,h=c+(l>>10&1)*3,d=c+(l>>9&1)*3,g=c+(l>>8&1)*3,i=0;i<3;)E=i+1,p[T][o+i]=(u*(3-i)+h*i)/3,p[T+3][o+E]=(d*(3-E)+g*E)/3,p[T+E][o]=(u*(3-E)+d*E)/3,p[T+i][o+3]=(h*(3-i)+g*i)/3,i++;p[T+1][o+1]=u>c?c+2:c+1,p[T+1][o+2]=h>c?c+2:c+1,p[T+2][o+1]=d>c?c+2:c+1,p[T+2][o+2]=g>c?c+2:c+1}o=o+4,e++}T=T+4,s++}return p}static addTileTypes(t){let e,s,i,n,o,l,c,u,h,d,g,E,m;const I=t.length-1,p=t[0].length-1;for(s=1;s<I;){for(e=1;e<p;)i=t[s][e],i<0||(n=t[s-1][e-1]&255,o=t[s-1][e]&255,l=t[s-1][e+1]&255,c=t[s][e-1]&255,u=t[s][e+1]&255,h=t[s+1][e-1]&255,d=t[s+1][e]&255,g=t[s+1][e+1]&255,E=i+1,m=(n==E||o==E||c==E?8:0)|(l==E||o==E||u==E?4:0)|(h==E||d==E||c==E?2:0)|(g==E||d==E||u==E?1:0),m==15&&(m=0),t[s][e]=i|m<<8),e++;s++}}static unpadHeightMap(t){t.shift(),t.pop();for(const e of t)e.shift(),e.pop()}static padHeightMap(t){const e=[],s=[];for(const i of t)i.push(oe.TILE_BLOCKED),i.unshift(oe.TILE_BLOCKED);for(const i of t[0])e.push(oe.TILE_BLOCKED),s.push(oe.TILE_BLOCKED);t.push(s),t.unshift(e)}get minX(){return this._minX}get maxX(){return this._maxX}get minY(){return this._minY}get maxY(){return this._maxY}get tileMapWidth(){return this._width}get tileMapHeight(){return this._height}get planeCount(){return this._planes.length}get floorHeight(){return this._fixedWallHeight!=-1?this._fixedWallHeight:this._floorHeight}get wallHeight(){return this._fixedWallHeight!=-1?this._fixedWallHeight+3.6:this._wallHeight}set wallHeight(t){t<0&&(t=0),this._wallHeight=t}get wallThicknessMultiplier(){return this._wallThicknessMultiplier}set wallThicknessMultiplier(t){t<0&&(t=0),this._wallThicknessMultiplier=t}get floorThicknessMultiplier(){return this._floorThicknessMultiplier}set floorThicknessMultiplier(t){t<0&&(t=0),this._floorThicknessMultiplier=t}dispose(){this._planes=null,this._tileMatrix=null,this._tileMatrixOriginal=null,this._floorHoleMatrix=null,this._floorHoles!=null&&(this._floorHoles.clear(),this._floorHoles=null)}reset(){this._planes=[],this._tileMatrix=[],this._tileMatrixOriginal=[],this._width=0,this._height=0,this._minX=0,this._maxX=0,this._minY=0,this._maxY=0,this._floorHeight=0,this._floorHoleMatrix=[]}initializeTileMap(t,e){t<0&&(t=0),e<0&&(e=0),this._tileMatrix=[],this._tileMatrixOriginal=[],this._floorHoleMatrix=[];let s=0;for(;s<e;){const i=[],n=[],o=[];let l=0;for(;l<t;)i[l]=oe.TILE_BLOCKED,n[l]=oe.TILE_BLOCKED,o[l]=!1,l++;this._tileMatrix.push(i),this._tileMatrixOriginal.push(n),this._floorHoleMatrix.push(o),s++}return this._width=t,this._height=e,this._minX=this._width,this._maxX=-1,this._minY=this._height,this._maxY=-1,!0}setTileHeight(t,e,s){let i,n,o,l,c;if(t>=0&&t<this._width&&e>=0&&e<this._height){if(i=this._tileMatrix[e],i[t]=s,s>=0)t<this._minX&&(this._minX=t),t>this._maxX&&(this._maxX=t),e<this._minY&&(this._minY=e),e>this._maxY&&(this._maxY=e);else{if(t==this._minX||t==this._maxX){for(n=!1,o=this._minY;o<this._maxY;){if(this.getTileHeightInternal(t,o)>=0){n=!0;break}o++}n||(t==this._minX&&this._minX++,t==this._maxX&&this._maxX--)}if(e==this._minY||e==this._maxY){for(l=!1,c=this._minX;c<this._maxX;){if(this.getTileHeight(c,e)>=0){l=!0;break}c++}l||(e==this._minY&&this._minY++,e==this._maxY&&this._maxY--)}}return!0}return!1}getTileHeight(t,e){if(t<0||t>=this._width||e<0||e>=this._height)return oe.TILE_BLOCKED;const s=this._tileMatrix[e];return s[t]===void 0?0:Math.abs(s[t])}getTileHeightOriginal(t,e){return t<0||t>=this._width||e<0||e>=this._height?oe.TILE_BLOCKED:this._floorHoleMatrix[e][t]?oe.TILE_HOLE:this._tileMatrixOriginal[e][t]}getTileHeightInternal(t,e){return t<0||t>=this._width||e<0||e>=this._height?oe.TILE_BLOCKED:this._tileMatrix[e][t]}initializeFromTileData(t=-1){let e,s;for(this._fixedWallHeight=t,s=0;s<this._height;){for(e=0;e<this._width;)this._tileMatrixOriginal[s]===void 0&&(this._tileMatrixOriginal[s]=[]),this._tileMatrixOriginal[s][e]=this._tileMatrix[s][e],e++;s++}const i=oe.findEntranceTile(this._tileMatrix);for(s=0;s<this._height;){for(e=0;e<this._width;)this._floorHoleMatrix[s]===void 0&&(this._floorHoleMatrix[s]=[]),this._floorHoleMatrix[s][e]&&this.setTileHeight(e,s,oe.TILE_HOLE),e++;s++}return this.initialize(i)}initialize(t){let e=0;t!=null&&(e=this.getTileHeight(t.x,t.y),this.setTileHeight(t.x,t.y,oe.TILE_BLOCKED)),this._floorHeight=oe.getFloorHeight(this._tileMatrix),this.createWallPlanes();const s=[];for(const n of this._tileMatrix)s.push(n.concat());oe.padHeightMap(s),oe.addTileTypes(s),oe.unpadHeightMap(s);const i=oe.expandFloorTiles(s);return this.extractPlanes(i),t!=null&&(this.setTileHeight(t.x,t.y,e),this.addFloor(new j(t.x+.5,t.y+.5,e),new j(-1,0,0),new j(0,-1,0),!1,!1,!1,!1)),!0}generateWallData(t,e){let s,i,n,o,l;const c=new qn,u=[this.extractTopWall.bind(this),this.extractRightWall.bind(this),this.extractBottomWall.bind(this),this.extractLeftWall.bind(this)];let h=0,d=new wt(t.x,t.y),g=0;for(;g++<1e3;){if(s=!1,i=!1,n=h,(d.x<this.minX||d.x>this.maxX||d.y<this.minY||d.y>this.maxY)&&(s=!0),o=u[h](d,e),o==null)return null;if(l=Math.abs(o.x-d.x)+Math.abs(o.y-d.y),d.x==o.x||d.y==o.y?(h=(h-1+u.length)%u.length,l=l+1,i=!0):(h=(h+1)%u.length,l--),c.addWall(d,n,l,s,i),o.x==t.x&&o.y==t.y&&(o.x!=d.x||o.y!=d.y))break;d=o}return c.count==0?null:c}hidePeninsulaWallChains(t){let e,s,i,n,o=0;const l=t.count;for(;o<l;){const c=o;for(e=o,s=0,i=!1;!t.getBorder(o)&&o<l;)t.getLeftTurn(o)?s++:s>0&&s--,s>1&&(i=!0),e=o,o++;if(i)for(n=c;n<=e;)t.setHideWall(n,!0),n++;o++}}updateWallsNextToHoles(t){let e,s,i,n,o,l,c;const u=t.count;let h=0;for(;h<u;){if(!t.getHideWall(h)){for(e=t.getCorner(h),s=t.getDirection(h),i=t.getLength(h),n=qn.WALL_DIRECTION_VECTORS[s],o=qn.WALL_NORMAL_VECTORS[s],l=0,c=0;c<i;){if(this.getTileHeightInternal(e.x+c*n.x-o.x,e.y+c*n.y-o.y)==oe.TILE_HOLE){if(c>0&&l==0){t.setLength(h,c);break}l++}else if(l>0){t.moveCorner(h,l);break}c++}l==i&&t.setHideWall(h,!0)}h++}}resolveOriginalWallIndex(t,e,s){let i,n,o,l,c,u;const h=Math.min(t.y,e.y),d=Math.max(t.y,e.y),g=Math.min(t.x,e.x),E=Math.max(t.x,e.x),m=s.count;let I=0;for(;I<m;){if(i=s.getCorner(I),n=s.getEndPoint(I),t.x==e.x){if(i.x==t.x&&n.x==t.x&&(o=Math.min(i.y,n.y),l=Math.max(i.y,n.y),o<=h&&d<=l))return I}else if(t.y==e.y&&i.y==t.y&&n.y==t.y&&(c=Math.min(i.x,n.x),u=Math.max(i.x,n.x),c<=g&&E<=u))return I;I++}return-1}hideOriginallyHiddenWalls(t,e){let s,i,n,o,l;const c=t.count;let u=0;for(;u<c;)t.getHideWall(u)||(s=t.getCorner(u),i=new wt(s.x,s.y),n=qn.WALL_DIRECTION_VECTORS[t.getDirection(u)],o=t.getLength(u),i.x=i.x+n.x*o,i.y=i.y+n.y*o,l=this.resolveOriginalWallIndex(s,i,e),l>=0?e.getHideWall(l)&&t.setHideWall(u,!0):t.setHideWall(u,!0)),u++}checkWallHiding(t,e){this.hidePeninsulaWallChains(e),this.updateWallsNextToHoles(t),this.hideOriginallyHiddenWalls(t,e)}addWalls(t,e){const s=t.count,i=e.count;let n=0;for(;n<s;){if(!t.getHideWall(n)){const o=t.getCorner(n),l=t.getDirection(n),c=t.getLength(n),u=qn.WALL_DIRECTION_VECTORS[l],h=qn.WALL_NORMAL_VECTORS[l];let d=-1,g=0;for(;g<c;){const G=this.getTileHeightInternal(o.x+g*u.x+h.x,o.y+g*u.y+h.y);G>=0&&(G<d||d<0)&&(d=G),g++}const E=d;let m=new j(o.x,o.y,E);m=j.sum(m,j.product(h,.5)),m=j.sum(m,j.product(u,-.5));const I=this.wallHeight+Math.min(oe.MAX_WALL_ADDITIONAL_HEIGHT,this.floorHeight)-d,p=j.product(u,-c),T=new j(0,0,I);m=j.dif(m,p);const R=this.resolveOriginalWallIndex(o,t.getEndPoint(n),e);let S=0,b=0;R>=0?(S=e.getDirection((R+1)%i),b=e.getDirection((R-1+i)%i)):(S=t.getDirection((n+1)%s),b=t.getDirection((n-1+s)%s));let N=null;(S-l+4)%4==3?N=qn.WALL_NORMAL_VECTORS[S]:(l-b+4)%4==3&&(N=qn.WALL_NORMAL_VECTORS[b]);const P=t.getLeftTurn(n),B=t.getLeftTurn((n-1+s)%s),F=t.getHideWall((n+1)%s),w=t.getManuallyLeftCut(n),U=t.getManuallyRightCut(n);this.addWall(m,p,T,N,!B||w,!P||U,!F)}n++}}createWallPlanes(){const t=this._tileMatrix;if(t==null)return!1;let e,s,i;const n=t.length;let o=0;if(n==0)return!1;for(e=0;e<n;){if(i=t[e],i==null||i.length==0)return!1;o>0?o=Math.min(o,i.length):o=i.length,e++}const l=Math.min(oe.MAX_WALL_ADDITIONAL_HEIGHT,this._fixedWallHeight!=-1?this._fixedWallHeight:oe.getFloorHeight(t)),c=this.minX;let u=this.minY;for(u=this.minY;u<=this.maxY;){if(this.getTileHeightInternal(c,u)>oe.TILE_HOLE){u--;break}u++}if(u>this.maxY)return!1;const h=new wt(c,u),d=this.generateWallData(h,!0),g=this.generateWallData(h,!1);for(d!=null&&(d.count,g.count,this.checkWallHiding(d,g),this.addWalls(d,g)),s=0;s<this.tileMapHeight;){for(e=0;e<this.tileMapWidth;)this.getTileHeightInternal(e,s)<0&&this.setTileHeight(e,s,-(l+this.wallHeight)),e++;s++}return!0}extractTopWall(t,e){if(t==null)return null;let s=1,i=oe.TILE_HOLE;for(e||(i=oe.TILE_BLOCKED);s<1e3;){if(this.getTileHeightInternal(t.x+s,t.y)>i)return new wt(t.x+s-1,t.y);if(this.getTileHeightInternal(t.x+s,t.y+1)<=i)return new wt(t.x+s,t.y+1);s++}return null}extractRightWall(t,e){if(t==null)return null;let s=1,i=oe.TILE_HOLE;for(e||(i=oe.TILE_BLOCKED);s<1e3;){if(this.getTileHeightInternal(t.x,t.y+s)>i)return new wt(t.x,t.y+(s-1));if(this.getTileHeightInternal(t.x-1,t.y+s)<=i)return new wt(t.x-1,t.y+s);s++}return null}extractBottomWall(t,e){if(t==null)return null;let s=1,i=oe.TILE_HOLE;for(e||(i=oe.TILE_BLOCKED);s<1e3;){if(this.getTileHeightInternal(t.x-s,t.y)>i)return new wt(t.x-(s-1),t.y);if(this.getTileHeightInternal(t.x-s,t.y-1)<=i)return new wt(t.x-s,t.y-1);s++}return null}extractLeftWall(t,e){if(t==null)return null;let s=1,i=oe.TILE_HOLE;for(e||(i=oe.TILE_BLOCKED);s<1e3;){if(this.getTileHeightInternal(t.x,t.y-s)>i)return new wt(t.x,t.y-(s-1));if(this.getTileHeightInternal(t.x+1,t.y-s)<=i)return new wt(t.x+1,t.y-s);s++}return null}addWall(t,e,s,i,n,o,l){this.addPlane(gs.PLANE_WALL,t,e,s,[i]),this.addPlane(gs.PLANE_LANDSCAPE,t,e,s,[i]);const c=oe.WALL_THICKNESS*this._wallThicknessMultiplier,u=oe.FLOOR_THICKNESS*this._floorThicknessMultiplier,h=j.crossProduct(e,s),d=j.product(h,1/h.length*-c);if(this.addPlane(gs.PLANE_WALL,j.sum(t,s),e,d,[h,i]),n&&this.addPlane(gs.PLANE_WALL,j.sum(j.sum(t,e),s),j.product(s,-(s.length+u)/s.length),d,[h,i]),o&&(this.addPlane(gs.PLANE_WALL,j.sum(t,j.product(s,-u/s.length)),j.product(s,(s.length+u)/s.length),d,[h,i]),l)){const g=j.product(e,c/e.length);this.addPlane(gs.PLANE_WALL,j.sum(j.sum(t,s),j.product(g,-1)),g,d,[h,e,i])}}addFloor(t,e,s,i,n,o,l){let c,u,h;this.addPlane(gs.PLANE_FLOOR,t,e,s)!=null&&(c=oe.FLOOR_THICKNESS*this._floorThicknessMultiplier,u=new j(0,0,c),h=j.dif(t,u),o&&this.addPlane(gs.PLANE_FLOOR,h,e,u),l&&this.addPlane(gs.PLANE_FLOOR,j.sum(h,j.sum(e,s)),j.product(e,-1),u),i&&this.addPlane(gs.PLANE_FLOOR,j.sum(h,s),j.product(s,-1),u),n&&this.addPlane(gs.PLANE_FLOOR,j.sum(h,e),s,u))}initializeFromMapData(t){if(!t)return!1;this.reset(),this.resetFloorHoles();const e=t.width,s=t.height,i=t.wallHeight,n=t.fixedWallsHeight;if(this.initializeTileMap(e,s),t.tileMap){let o=0;for(;o<t.tileMap.length;){const l=t.tileMap[o];if(l){let c=0;for(;c<l.length;){const u=l[c];u&&this.setTileHeight(c,o,u.height),c++}}o++}}if(t.holeMap&&t.holeMap.length){let o=0;for(;o<t.holeMap.length;){const l=t.holeMap[o];l&&(this.addFloorHole(l.id,l.x,l.y,l.width,l.height),o++)}this.initializeHoleMap()}return this.wallHeight=i,this.restrictsDragging=t.restrictsDragging,this.restrictsScaling=t.restrictsScaling,this.restrictedScale=t.restrictedScale,this.initializeFromTileData(n),!0}addPlane(t,e,s,i,n=null){if(s.length==0||i.length==0)return null;const o=new gs(t,e,s,i,n);return this._planes.push(o),o}getMapData(){const t=new YU;t.width=this._width,t.height=this._height,t.wallHeight=this._wallHeight,t.fixedWallsHeight=this._fixedWallHeight,t.dimensions.minX=this.minX,t.dimensions.maxX=this.maxX,t.dimensions.minY=this.minY,t.dimensions.maxY=this.maxY,t.restrictsDragging=this.restrictsDragging,t.restrictsScaling=this.restrictsScaling,t.restrictedScale=this.restrictedScale;let e=0;for(;e<this._height;){const s=[],i=this._tileMatrixOriginal[e];let n=0;for(;n<this._width;){const o=i[n];s.push({height:o}),n++}t.tileMap.push(s),e++}for(const[s,i]of this._floorHoles.entries())i&&t.holeMap.push({id:s,x:i.x,y:i.y,width:i.width,height:i.height});return t}getPlaneLocation(t){if(t<0||t>=this.planeCount)return null;const e=this._planes[t];return e?e.loc:null}getPlaneNormal(t){if(t<0||t>=this.planeCount)return null;const e=this._planes[t];return e?e.normal:null}getPlaneLeftSide(t){if(t<0||t>=this.planeCount)return null;const e=this._planes[t];return e?e.leftSide:null}getPlaneRightSide(t){if(t<0||t>=this.planeCount)return null;const e=this._planes[t];return e?e.rightSide:null}getPlaneNormalDirection(t){if(t<0||t>=this.planeCount)return null;const e=this._planes[t];return e?e.normalDirection:null}getPlaneSecondaryNormals(t){let e,s;if(t<0||t>=this.planeCount)return null;const i=this._planes[t];if(i!=null){for(e=[],s=0;s<i.secondaryNormalCount;)e.push(i.getSecondaryNormal(s)),s++;return e}return null}getPlaneType(t){if(t<0||t>=this.planeCount)return gs.PLANE_UNDEFINED;const e=this._planes[t];return e?e.type:gs.PLANE_UNDEFINED}getPlaneMaskCount(t){if(t<0||t>=this.planeCount)return 0;const e=this._planes[t];return e?e.maskCount:0}getPlaneMaskLeftSideLoc(t,e){if(t<0||t>=this.planeCount)return-1;const s=this._planes[t];return s?s.getMaskLeftSideLoc(e):-1}getPlaneMaskRightSideLoc(t,e){if(t<0||t>=this.planeCount)return-1;const s=this._planes[t];return s?s.getMaskRightSideLoc(e):-1}getPlaneMaskLeftSideLength(t,e){if(t<0||t>=this.planeCount)return-1;const s=this._planes[t];return s?s.getMaskLeftSideLength(e):-1}getPlaneMaskRightSideLength(t,e){if(t<0||t>=this.planeCount)return-1;const s=this._planes[t];return s?s.getMaskRightSideLength(e):-1}addFloorHole(t,e,s,i,n){this.removeFloorHole(t),this._floorHoles.set(t,new C6(e,s,i,n))}removeFloorHole(t){this._floorHoles.delete(t)}resetFloorHoles(){this._floorHoles.clear()}initializeHoleMap(){let t,e,s,i,n,o,l,c;for(e=0;e<this._height;){for(s=this._floorHoleMatrix[e],t=0;t<this._width;)s[t]=!1,t++;e++}for(const u of this._floorHoles.values())if(i=u,i!=null)for(n=i.x,o=i.x+i.width-1,l=i.y,c=i.y+i.height-1,n=n<0?0:n,o=o>=this._width?this._width-1:o,l=l<0?0:l,c=c>=this._height?this._height-1:c,e=l;e<=c;){for(s=this._floorHoleMatrix[e],t=n;t<=o;)s[t]=!0,t++;e++}}extractPlanes(t){let e,s,i,n,o,l,c,u,h,d,g,E,m,I,p;const T=t.length,R=t[0].length,S=[];let b=0;for(;b<T;)S[b]=[],b++;let N=0;for(;N<T;){for(e=0;e<R;){if(s=t[N][e],!(s<0||S[N][e])){for(o=e==0||t[N][e-1]!=s,l=N==0||t[N-1][e]!=s,i=e+1;i<R&&!(t[N][i]!=s||S[N][i]||N>0&&t[N-1][i]==s==l);)i++;for(c=i==R||t[N][i]!=s,g=!1,n=N+1;n<T&&!g;){for(u=t[n][e]!=s,g=u||e>0&&t[n][e-1]==s==o||i<R&&t[n][i]==s==c,h=e;h<i;){if(t[n][h]==s==u){g=!0,i=h;break}h++}if(g)break;n++}for(u=u||n==T,c=i==R||t[N][i]!=s,d=N;d<n;){for(h=e;h<i;)S[d][h]=!0,h++;d++}E=e/4-.5,m=N/4-.5,I=(i-e)/4,p=(n-N)/4,this.addFloor(new j(E+I,m+p,s/4),new j(-I,0,0),new j(0,-p,0),c,o,u,l)}e++}N++}}get restrictsDragging(){return this._restrictsDragging}set restrictsDragging(t){this._restrictsDragging=t}get restrictsScaling(){return this._restrictsScaling}set restrictsScaling(t){this._restrictsScaling=t}get restrictedScale(){return this._restrictedScale}set restrictedScale(t){this._restrictedScale=t}};oe.FLOOR_THICKNESS=.25,oe.WALL_THICKNESS=.25,oe.MAX_WALL_ADDITIONAL_HEIGHT=20,oe.TILE_BLOCKED=-110,oe.TILE_HOLE=-100;let Ws=oe;class A6 extends KE{constructor(){super(),this._planeParser=new Ws,this._planeBitmapMaskParser=new zU,this._color=16777215,this._light=255,this._originalColor=16777215,this._originalLight=255,this._targetColor=16777215,this._targetLight=255,this._colorChangedTime=0,this._colorTransitionLength=1500,this._lastHoleUpdate=0,this._needsMapUpdate=!1,this._skipColorTransition=!1}getEventTypes(){const t=[Gt.MOUSE_MOVE,Gt.CLICK];return this.mergeTypes(super.getEventTypes(),t)}dispose(){super.dispose(),this._planeParser&&(this._planeParser.dispose(),this._planeParser=null),this._planeBitmapMaskParser&&(this._planeBitmapMaskParser.dispose(),this._planeBitmapMaskParser=null)}initialize(t){!t||!this.object||t instanceof YU&&this._planeParser.initializeFromMapData(t)&&(this.object.model.setValue(C.ROOM_MAP_DATA,t),this.object.model.setValue(C.ROOM_BACKGROUND_COLOR,16777215),this.object.model.setValue(C.ROOM_FLOOR_VISIBILITY,1),this.object.model.setValue(C.ROOM_WALL_VISIBILITY,1),this.object.model.setValue(C.ROOM_LANDSCAPE_VISIBILITY,1),this._skipColorTransition=Dt.getValue("room.color.skip.transition")===!0)}update(t){if(super.update(t),this.updateBackgroundColor(t),this._needsMapUpdate){if(this._lastHoleUpdate&&t-this._lastHoleUpdate<5)return;const e=this.object&&this.object.model;if(e){const s=this._planeParser.getMapData();e.setValue(C.ROOM_MAP_DATA,s),e.setValue(C.ROOM_FLOOR_HOLE_UPDATE_TIME,t),this._planeParser.initializeFromMapData(s)}this._lastHoleUpdate=0,this._needsMapUpdate=!1}}updateBackgroundColor(t){if(!this.object||!this._colorChangedTime)return;let e=this._color,s=this._light;if(t-this._colorChangedTime>=this._colorTransitionLength)e=this._targetColor,s=this._targetLight,this._colorChangedTime=0;else{let n=this._originalColor>>16&255,o=this._originalColor>>8&255,l=this._originalColor&255;const c=this._targetColor>>16&255,u=this._targetColor>>8&255,h=this._targetColor&255,d=(t-this._colorChangedTime)/this._colorTransitionLength;n=n+(c-n)*d,o=o+(u-o)*d,l=l+(h-l)*d,e=(n<<16)+(o<<8)+l,s=this._originalLight+(this._targetLight-this._originalLight)*d,this._color=e,this._light=s}let i=ii.rgbToHSL(e);i=(i&16776960)+s,e=ii.hslToRGB(i),this.object.model&&this.object.model.setValue(C.ROOM_BACKGROUND_COLOR,e)}processUpdateMessage(t){if(!t||!this.object)return;const e=this.object.model;if(e){if(t instanceof hi){this.onObjectRoomUpdateMessage(t,e);return}if(t instanceof yi){this.onObjectRoomMaskUpdateMessage(t,e);return}if(t instanceof go){this.onObjectRoomPlaneVisibilityUpdateMessage(t,e);return}if(t instanceof _o){this.onObjectRoomPlanePropertyUpdateMessage(t,e);return}if(t instanceof ho){this.onObjectRoomFloorHoleUpdateMessage(t,e);return}if(t instanceof t_){this.onObjectRoomColorUpdateMessage(t,e);return}t instanceof uf&&this.onObjectRoomMapUpdateMessage(t)}}onObjectRoomUpdateMessage(t,e){switch(t.type){case hi.ROOM_FLOOR_UPDATE:e.setValue(C.ROOM_FLOOR_TYPE,t.value);return;case hi.ROOM_WALL_UPDATE:e.setValue(C.ROOM_WALL_TYPE,t.value);return;case hi.ROOM_LANDSCAPE_UPDATE:e.setValue(C.ROOM_LANDSCAPE_TYPE,t.value);return}}onObjectRoomMaskUpdateMessage(t,e){let s=null,i=!1;switch(t.type){case yi.ADD_MASK:s=Mc.WINDOW,t.maskCategory===yi.HOLE&&(s=Mc.HOLE),this._planeBitmapMaskParser.addMask(t.maskId,t.maskType,t.maskLocation,s),i=!0;break;case yi.REMOVE_MASK:i=this._planeBitmapMaskParser.removeMask(t.maskId);break}i&&e.setValue(C.ROOM_PLANE_MASK_XML,this._planeBitmapMaskParser.getXML())}onObjectRoomPlaneVisibilityUpdateMessage(t,e){let s=0;switch(t.visible&&(s=1),t.type){case go.FLOOR_VISIBILITY:e.setValue(C.ROOM_FLOOR_VISIBILITY,s);return;case go.WALL_VISIBILITY:e.setValue(C.ROOM_WALL_VISIBILITY,s),e.setValue(C.ROOM_LANDSCAPE_VISIBILITY,s);return}}onObjectRoomPlanePropertyUpdateMessage(t,e){switch(t.type){case _o.FLOOR_THICKNESS:e.setValue(C.ROOM_FLOOR_THICKNESS,t.value);return;case _o.WALL_THICKNESS:e.setValue(C.ROOM_WALL_THICKNESS,t.value);return}}onObjectRoomFloorHoleUpdateMessage(t,e){switch(t.type){case ho.ADD:this._planeParser.addFloorHole(t.id,t.x,t.y,t.width,t.height),this._needsMapUpdate=!0;return;case ho.REMOVE:this._planeParser.removeFloorHole(t.id),this._needsMapUpdate=!0;return}this._lastHoleUpdate=this.time}onObjectRoomColorUpdateMessage(t,e){!t||!e||(this._originalColor=this._color,this._originalLight=this._light,this._targetColor=t.color,this._targetLight=t.light,this._colorChangedTime=this.time,this._skipColorTransition?this._colorTransitionLength=0:this._colorTransitionLength=1500,e.setValue(C.ROOM_COLORIZE_BG_ONLY,t.backgroundOnly))}onObjectRoomMapUpdateMessage(t){!t||!t.mapData||(this.object.model.setValue(C.ROOM_MAP_DATA,t.mapData),this.object.model.setValue(C.ROOM_FLOOR_HOLE_UPDATE_TIME,this.time),this._planeParser.initializeFromMapData(t.mapData))}mouseEvent(t,e){if(!t||!e||!this.object||!this.object.model)return;const s=t.spriteTag;let i=0;if(s&&s.indexOf("@")>=0&&(i=parseInt(s.substr(s.indexOf("@")+1))),i<1||i>this._planeParser.planeCount){t.type===at.ROLL_OUT&&this.object.model.setValue(C.ROOM_SELECTED_PLANE,0);return}i--;let n=null;const o=this._planeParser.getPlaneLocation(i),l=this._planeParser.getPlaneLeftSide(i),c=this._planeParser.getPlaneRightSide(i),u=this._planeParser.getPlaneNormalDirection(i),h=this._planeParser.getPlaneType(i);if(o==null||l==null||c==null||u==null)return;const d=l.length,g=c.length;if(d==0||g==0)return;const E=t.screenX,m=t.screenY,I=new wt(E,m);if(n=e.getPlanePosition(I,o,l,c),!n){this.object.model.setValue(C.ROOM_SELECTED_PLANE,0);return}const p=j.product(l,n.x/d);p.add(j.product(c,n.y/g)),p.add(o);const T=p.x,R=p.y,S=p.z;if(n.x>=0&&n.x<d&&n.y>=0&&n.y<g)this.object.model.setValue(C.ROOM_SELECTED_X,T),this.object.model.setValue(C.ROOM_SELECTED_Y,R),this.object.model.setValue(C.ROOM_SELECTED_Z,S),this.object.model.setValue(C.ROOM_SELECTED_PLANE,i+1);else{this.object.model.setValue(C.ROOM_SELECTED_PLANE,0);return}let b=null;switch(t.type===at.MOUSE_MOVE||t.type===at.ROLL_OVER?b=Gt.MOUSE_MOVE:t.type===at.MOUSE_CLICK&&(b=Gt.CLICK),t.type){case at.MOUSE_MOVE:case at.ROLL_OVER:case at.MOUSE_CLICK:{let N=null;if(h===gs.PLANE_FLOOR)N=new Ha(b,this.object,t.eventId,T,R,S,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown);else if(h===gs.PLANE_WALL||h===gs.PLANE_LANDSCAPE){let P=90;u&&(P=u.x+90,P>360&&(P-=360));const B=l.length*n.x/d,F=c.length*n.y/g;N=new Xc(b,this.object,t.eventId,o,l,c,B,F,P,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown)}this.eventDispatcher&&this.eventDispatcher.dispatchEvent(N);return}}}}class N6 extends KE{initialize(t){this.object&&(this.object.model.setValue(C.FURNITURE_ALPHA_MULTIPLIER,1),this.object.setState(1,0))}processUpdateMessage(t){if(super.processUpdateMessage(t),t instanceof fo&&this.object)switch(t.type){case fo.ENABLED:this.object.setState(0,0);return;case fo.DISABLED:this.object.setState(1,0);return}}}const na=class na extends KE{constructor(){super(),this._lastEventId=null,this._isHidden=!1}initialize(t){this.object&&(this.object.model.setValue(C.FURNITURE_ALPHA_MULTIPLIER,1),this.object.setState(na.CURSOR_HIDDEN_STATE,0))}processUpdateMessage(t){t instanceof qc&&(this._lastEventId&&this._lastEventId===t.sourceEventId||(t.toggleVisibility&&(this._isHidden=!this._isHidden),super.processUpdateMessage(t),this.object&&(this._isHidden?this.object.setState(na.CURSOR_HIDDEN_STATE,0):t.visible?(this.object.model.setValue(C.TILE_CURSOR_HEIGHT,t.height),this.object.setState(t.height>.8?na.CURSOR_HEIGHT_STATE:na.CURSOR_VISIBLE_STATE)):this.object.setState(na.CURSOR_HIDDEN_STATE,0)),this._lastEventId=t.sourceEventId))}};na.CURSOR_VISIBLE_STATE=0,na.CURSOR_HIDDEN_STATE=1,na.CURSOR_HEIGHT_STATE=6;let oR=na;class KU{constructor(t,e,s){this._id=t,this._type=e,this._visualization=s}dispose(){this._visualization=null}update(t,e){}animate(t){return!1}get id(){return this._id}get type(){return this._type}get visualization(){return this._visualization}}const gr=class gr extends KU{constructor(t,e,s){super(t,e,s),this._asset=null,this._startTime=Pt(),this._delta=0,this._offsetY=0,this._scale=0,this._state=0}update(t,e){if(!t)return;this._scale=e;let s=64,i=0;if(e<48?(this._asset=this.visualization.getAvatarRenderAsset("avatar_addition_user_blowkiss_small"),this.visualization.angle===90||this.visualization.angle===270?i=0:this.visualization.angle===135||this.visualization.angle===180||this.visualization.angle===225?i=6:i=-6,this._offsetY=-38,s=32):(this._asset=this.visualization.getAvatarRenderAsset("avatar_addition_user_blowkiss"),this.visualization.angle===90||this.visualization.angle===270?i=-3:this.visualization.angle===135||this.visualization.angle===180||this.visualization.angle===225?i=22:i=-30,this._offsetY=-70),this.visualization.posture===mt.POSTURE_SIT?this._offsetY+=s/2:this.visualization.posture===mt.POSTURE_LAY&&(this._offsetY+=s),this._asset){t.texture=this._asset,t.offsetX=i,t.offsetY=this._offsetY,t.relativeDepth=-.02,t.alpha=0;const n=this._delta;this.animate(t),this._delta=n}}animate(t){if(!t)return!1;if(this._asset&&(t.texture=this._asset),this._state===gr.STATE_DELAY)return Pt()-this._startTime<gr.DELAY_BEFORE_ANIMATION?!1:(this._state=gr.STATE_FADE_IN,t.alpha=0,t.visible=!0,this._delta=0,!0);if(this._state===gr.STATE_FADE_IN)return this._delta+=.1,t.offsetY=this._offsetY,t.alpha=Math.pow(this._delta,.9)*255,this._delta>=1&&(t.alpha=255,this._delta=0,this._state=gr.STATE_FLOAT),!0;if(this._state===gr.STATE_FLOAT){const e=Math.pow(this._delta,.9);this._delta+=.05;const s=this._scale<48?-30:-40;return t.offsetY=this._offsetY+(this._delta<1?e:1)*s,t.alpha=(1-e)*255,t.alpha<=0&&(t.visible=!1,this._state=gr.STATE_COMPLETE),!0}return!1}};gr.DELAY_BEFORE_ANIMATION=300,gr.STATE_DELAY=0,gr.STATE_FADE_IN=1,gr.STATE_FLOAT=2,gr.STATE_COMPLETE=3;let lR=gr;const tc=class tc{static getExpressionAddition(t,e,s){switch(e){case this.BLOW:return new lR(t,this.BLOW,s);default:return new KU(t,e,s)}}};tc.WAVE=1,tc.BLOW=2,tc.LAUGH=3,tc.CRY=4,tc.IDLE=5;let cR=tc;const Ii=class Ii{constructor(t,e){this._id=t,this._visualization=e,this._asset=null,this._startTime=Pt(),this._offsetY=0,this._scale=0,this._state=0}dispose(){this._visualization=null,this._asset=null}getSpriteAssetName(t){let e="left";return(this._visualization.angle===135||this._visualization.angle===180||this._visualization.angle===225||this._visualization.angle===270)&&(e="right"),"avatar_addition_user_idle_"+e+"_"+t+(this._scale<48?"_small":"")}update(t,e){if(!t)return;this._scale=e,this._asset=this._visualization.getAvatarRenderAsset(this.getSpriteAssetName(this._state===Ii.STATE_FRAME_A?1:2));let s=64,i=0;e<48?(this._visualization.angle===135||this._visualization.angle===180||this._visualization.angle===225||this._visualization.angle===270?i=10:i=-16,this._offsetY=-38,s=32):(this._visualization.angle===135||this._visualization.angle===180||this._visualization.angle===225||this._visualization.angle===270?i=22:i=-30,this._offsetY=-70),this._visualization.posture===mt.POSTURE_SIT?this._offsetY+=s/2:this._visualization.posture===mt.POSTURE_LAY&&(this._offsetY+=s-.3*s),this._asset&&(t.texture=this._asset,t.offsetX=i,t.offsetY=this._offsetY,t.relativeDepth=-.02,t.alpha=0)}animate(t){if(!t)return!1;const e=Pt();return this._state===Ii.STATE_DELAY&&e-this._startTime>=Ii.DELAY_BEFORE_ANIMATION&&(this._state=Ii.STATE_FRAME_A,this._startTime=e,this._asset=this._visualization.getAvatarRenderAsset(this.getSpriteAssetName(1))),this._state===Ii.STATE_FRAME_A&&e-this._startTime>=Ii.DELAY_PER_FRAME&&(this._state=Ii.STATE_FRAME_B,this._startTime=e,this._asset=this._visualization.getAvatarRenderAsset(this.getSpriteAssetName(2))),this._state===Ii.STATE_FRAME_B&&e-this._startTime>=Ii.DELAY_PER_FRAME&&(this._state=Ii.STATE_FRAME_A,this._startTime=e,this._asset=this._visualization.getAvatarRenderAsset(this.getSpriteAssetName(1))),this._asset?(t.texture=this._asset,t.alpha=255,t.visible=!0):t.visible=!1,!1}get id(){return this._id}};Ii.DELAY_BEFORE_ANIMATION=2e3,Ii.DELAY_PER_FRAME=2e3,Ii.STATE_DELAY=0,Ii.STATE_FRAME_A=1,Ii.STATE_FRAME_B=2;let uR=Ii;const aa=class aa{constructor(t){this._id=t,this._asset=null,this._disposed=!1}dispose(){this._asset=null}update(t,e){if(t){if(!this._asset){const s=new ms(Es.WHITE);s.alpha=0,s.width=aa.WIDTH,s.height=aa.HEIGHT,this._asset=Ee.generateTexture(s)}t.visible=!0,t.texture=this._asset,t.offsetX=aa.OFFSET_X,t.offsetY=aa.OFFSET_Y,t.alphaTolerance=Fn.MATCH_ALL_PIXELS}}animate(t){return!1}get id(){return this._id}};aa.WIDTH=46,aa.HEIGHT=60,aa.OFFSET_X=-23,aa.OFFSET_Y=-48;let hR=aa;class x6{constructor(t,e,s){this._id=t,this._visualization=e,this._asset=null,this._relativeDepth=0,this._status=s}dispose(){this._visualization=null,this._asset=null}update(t,e){if(!t)return;t.visible=!0,t.relativeDepth=this._relativeDepth,t.alpha=255;let s=64,i=0,n=0;this._asset=this._visualization.getAvatarRenderAsset(this._status===Ia.GUIDE?"avatar_addition_user_guide_bubble":"avatar_addition_user_guide_requester_bubble"),e<48?(i=-19,n=-80,s=32):(i=-19,n=-120),this._visualization.posture===mt.POSTURE_SIT?n+=s/2:this._visualization.posture===mt.POSTURE_LAY&&(n+=e),this._asset&&(t.texture=this._asset,t.offsetX=i,t.offsetY=n,t.relativeDepth=-.02+0)}animate(t){return this._asset&&t&&(t.texture=this._asset),!1}get id(){return this._id}get relativeDepth(){return this._relativeDepth}set relativeDepth(t){this._relativeDepth=t}}class M6{constructor(t,e){this._id=t,this._visualization=e,this._asset=null}dispose(){this._visualization=null,this._asset=null}update(t,e){if(!t)return;let s=64,i=0,n=0;e<48?(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_user_muted_small"),s=32,i=-12,n=-66):(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_user_muted"),i=-15,n=-110),this._visualization.posture===mt.POSTURE_SIT?n+=s/2:this._visualization.posture===mt.POSTURE_LAY&&(n+=e),this._asset?(t.visible=!0,t.texture=this._asset,t.offsetX=i,t.offsetY=n,t.relativeDepth=-.02):t.visible=!1}animate(t){return this._asset&&t&&(t.texture=this._asset),!1}get id(){return this._id}}class y6{constructor(t,e,s){this._id=t,this._visualization=s,this._asset=null,this._scale=0,this._number=e,this._numberValueFadeDirection=0,this._numberValueMoving=!1,this._numberValueMoveCounter=0}dispose(){this._visualization=null,this._asset=null}update(t,e){if(!t)return;this._scale=e;let s=64,i=0,n=0;this._number>0?(e<48?(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_number_"+this._number+"_small"),s=32,i=-6,n=-52):(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_number_"+this._number),i=-8,n=-105),this._visualization.posture===mt.POSTURE_SIT?n+=s/2:this._visualization.posture===mt.POSTURE_LAY&&(n+=e),this._asset?(t.visible=!0,t.texture=this._asset,t.offsetX=i,t.offsetY=n,t.relativeDepth=-.01,t.alpha=0,this._numberValueFadeDirection=1,this._numberValueMoving=!0,this._numberValueMoveCounter=0):t.visible=!1):t.visible&&(this._numberValueFadeDirection=-1)}animate(t){if(!t)return!1;this._asset&&(t.texture=this._asset);let e=t.alpha,s=!1;if(this._numberValueMoving){if(this._numberValueMoveCounter++,this._numberValueMoveCounter<10)return!1;if(this._numberValueFadeDirection<0)this._scale<48?t.offsetY-=2:t.offsetY-=4;else{let i=4;this._scale<48&&(i=8),this._numberValueMoveCounter%i||(t.offsetY--,s=!0)}}return this._numberValueFadeDirection>0?(e<255&&(e+=32),e>=255&&(e=255,this._numberValueFadeDirection=0),t.alpha=e,!0):this._numberValueFadeDirection<0?(e>=0&&(e-=32),e<=0&&(this._numberValueFadeDirection=0,this._numberValueMoving=!1,e=0,t.visible=!1),t.alpha=e,!0):s}get id(){return this._id}}class D6{constructor(t,e){this._id=t,this._visualization=e,this._asset=null,this._relativeDepth=0}dispose(){this._visualization=null,this._asset=null}update(t,e){if(!t)return;t.visible=!0,t.relativeDepth=this._relativeDepth,t.alpha=255;let s=64,i=0,n=0;e<48?(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_user_typing_small"),i=3,n=-42,s=32):(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_user_typing"),i=14,n=-83),this._visualization.posture===mt.POSTURE_SIT?n+=s/2:this._visualization.posture===mt.POSTURE_LAY&&(n+=e),this._asset&&(t.texture=this._asset,t.offsetX=i,t.offsetY=n,t.relativeDepth=-.02+0)}animate(t){return this._asset&&t&&(t.texture=this._asset),!1}get id(){return this._id}get relativeDepth(){return this._relativeDepth}set relativeDepth(t){this._relativeDepth=t}}class gf extends Ar{constructor(){super()}initialize(t){return!0}onDispose(){this._avatarRenderer=null}createAvatarImage(t,e,s=null,i=null,n=null){let o=null;return e>48?o=this._avatarRenderer.createAvatarImage(t,kr.LARGE,s,i,n):o=this._avatarRenderer.createAvatarImage(t,kr.SMALL,s,i,n),o}getAvatarRendererAsset(t){return this._avatarRenderer?this._avatarRenderer.assets.getTexture(t):null}get avatarManager(){return this._avatarRenderer}set avatarManager(t){this._avatarRenderer=t}get layerCount(){return 0}}const ft=class ft extends nh{constructor(){super(),this._data=null,this._avatarImage=null,this._cachedAvatars=new hs,this._cachedAvatarEffects=new hs,this._shadow=null,this._lastUpdate=-1e3,this._disposed=!1,this._figure=null,this._gender=null,this._direction=-1,this._headDirection=-1,this._posture="",this._postureParameter="",this._canStandUp=!1,this._postureOffset=0,this._verticalOffset=0,this._angle=-1,this._headAngle=-1,this._talk=!1,this._expression=0,this._sleep=!1,this._blink=!1,this._gesture=0,this._sign=-1,this._highlightEnabled=!1,this._highlight=!1,this._dance=0,this._effect=0,this._carryObject=0,this._useObject=0,this._ownUser=!1,this._isLaying=!1,this._layInside=!1,this._isAnimating=!1,this._extraSpritesStartIndex=2,this._forcedAnimFrames=0,this._updatesUntilFrameUpdate=0,this._isAvatarReady=!1,this._needsUpdate=!1,this._geometryUpdateCounter=-1,this._additions=new Map}initialize(t){return t instanceof gf?(this._data=t,this.createSprites(ft.INITIAL_RESERVED_SPRITES),super.initialize(t),!0):!1}dispose(){this._disposed||(super.dispose(),this._avatarImage&&this._avatarImage.dispose(),this._shadow=null,this._disposed=!0)}update(t,e,s,i){if(!this.object||!t||!this._data||e<this._lastUpdate+ft.UPDATE_TIME_INCREASER)return;this._lastUpdate+=ft.UPDATE_TIME_INCREASER,this._lastUpdate+ft.UPDATE_TIME_INCREASER<e&&(this._lastUpdate=e-ft.UPDATE_TIME_INCREASER);const n=this.object.model,o=t.scale,l=this._effect;let c=!1,u=!1,h=!1,d=!1;const g=this.updateModel(n,o);if(g||o!==this._scale||!this._avatarImage){if(o!==this._scale&&(c=!0,this.updateScale(o)),l!==this._effect&&(u=!0),c||!this._avatarImage||u){if(this._avatarImage=this.createAvatarImage(o,this._effect),!this._avatarImage)return;h=!0;const I=this.getSprite(ft.AVATAR_LAYER_ID);I&&this._avatarImage&&this._avatarImage.isPlaceholder()?I.alpha=150:I&&(I.alpha=255)}if(!this._avatarImage)return;if(u&&this._avatarImage.animationHasResetOnToggle&&this._avatarImage.resetAnimationFrameCounter(),this.updateShadow(o),d=this.updateObject(this.object,t,s,!0),this.processActionsForAvatar(this._avatarImage),this._additions){let I=this._extraSpritesStartIndex;for(const p of this._additions.values())p.update(this.getSprite(I++),o)}this._scale=o}else d=this.updateObject(this.object,t,s);if(this._additions){let I=this._extraSpritesStartIndex;for(const p of this._additions.values())p.animate(this.getSprite(I++))&&this.updateSpriteCounter++}const E=d||g||c,m=(this._isAnimating||this._forcedAnimFrames>0)&&s;if(E&&(this._forcedAnimFrames=ft.ANIMATION_FRAME_UPDATE_INTERVAL),E||m){if(this.updateSpriteCounter++,this._forcedAnimFrames--,this._updatesUntilFrameUpdate--,this._updatesUntilFrameUpdate<=0||c||g||h)this._avatarImage.updateAnimationByFrames(1),this._updatesUntilFrameUpdate=ft.ANIMATION_FRAME_UPDATE_INTERVAL;else return;let I=this._avatarImage.getCanvasOffsets();(!I||I.length<3)&&(I=ft.DEFAULT_CANVAS_OFFSETS);const p=this.getSprite(ft.SPRITE_INDEX_AVATAR);if(p){const b=this.object.model.getValue(C.FIGURE_HIGHLIGHT_ENABLE)===1&&this.object.model.getValue(C.FIGURE_HIGHLIGHT)===1,N=this._avatarImage.getImage(si.FULL,b);N&&(p.texture=N,b||(p.filters=[])),p.texture&&(p.offsetX=-1*o/2+I[0]-(p.texture.width-o)/2,p.offsetY=-p.texture.height+o/4+I[1]+this._postureOffset),this._isLaying?this._layInside?p.relativeDepth=-.5:p.relativeDepth=ft.AVATAR_SPRITE_LAYING_DEPTH+I[2]:p.relativeDepth=ft.AVATAR_SPRITE_DEFAULT_DEPTH+I[2],this._ownUser?(p.relativeDepth-=ft.AVATAR_OWN_DEPTH_ADJUST,p.spriteType=Gr.AVATAR_OWN):p.spriteType=Gr.AVATAR}const T=this.getAddition(ft.TYPING_BUBBLE_ID);T&&(this._isLaying?T.relativeDepth=ft.AVATAR_SPRITE_LAYING_DEPTH-.01+I[2]:T.relativeDepth=ft.AVATAR_SPRITE_DEFAULT_DEPTH-.01+I[2]),this._isAnimating=this._avatarImage.isAnimating();let R=ft.INITIAL_RESERVED_SPRITES;const S=this._avatarImage.getDirection();for(const b of this._avatarImage.getSprites())if(b.id===ft.AVATAR){const N=this.getSprite(ft.SPRITE_INDEX_AVATAR);if(N){const P=this._avatarImage.getLayerData(b);let B=b.getDirectionOffsetX(S),F=b.getDirectionOffsetY(S);P&&(B+=P.dx,F+=P.dy),o<48&&(B/=2,F/=2),this._canStandUp||(N.offsetX+=B,N.offsetY+=F)}}else{const N=this.getSprite(R);if(N){N.alphaTolerance=Fn.MATCH_NOTHING,N.visible=!0;const P=this._avatarImage.getLayerData(b);let B=0,F=b.getDirectionOffsetX(S),w=b.getDirectionOffsetY(S);const U=b.getDirectionOffsetZ(S);let G=0;b.hasDirections&&(G=S),P&&(B=P.animationFrame,F+=P.dx,w+=P.dy,G+=P.dd),o<48&&(F/=2,w/=2),G<0?G+=8:G>7&&(G-=8);const K=this._avatarImage.getScale()+"_"+b.member+"_"+G+"_"+B,z=this._avatarImage.getAsset(K);if(!z)continue;N.texture=z.texture,N.offsetX=z.offsetX-o/2+F,N.offsetY=z.offsetY+w,N.flipH=z.flipH,b.hasStaticY?N.offsetY+=this._verticalOffset*o/(2*ft.BASE_Y_SCALE):N.offsetY+=this._postureOffset,this._isLaying?N.relativeDepth=ft.AVATAR_SPRITE_LAYING_DEPTH-.001*this.totalSprites*U:N.relativeDepth=ft.AVATAR_SPRITE_DEFAULT_DEPTH-.001*this.totalSprites*U,b.ink===33?N.blendMode=lo.ADD:N.blendMode=lo.NORMAL}R++}}}createAvatarImage(t,e){let s=null,i="avatarImage"+t.toString();if(e?(i+="-"+e,s=this._cachedAvatarEffects.getValue(i)):s=this._cachedAvatars.getValue(i),!s&&(s=this._data.createAvatarImage(this._figure,t,this._gender,this,this),s))if(!e)this._cachedAvatars.add(i,s);else{if(this._cachedAvatarEffects.length>=ft.MAX_EFFECT_CACHE){const n=this._cachedAvatarEffects.remove(this._cachedAvatarEffects.getKey(0));n&&n.dispose()}this._cachedAvatarEffects.add(i,s)}return s}updateObject(t,e,s,i=!1){if(!i&&this.updateObjectCounter===t.updateCounter&&this._geometryUpdateCounter===e.updateId)return!1;let n=t.getDirection().x-e.direction.x,o=this._headDirection-e.direction.x;return this._posture==="float"&&(o=n),n=(n%360+360)%360,o=(o%360+360)%360,this._posture==="sit"&&this._canStandUp&&(n-=n%90-45,o-=o%90-45),(n!==this._angle||i)&&(s=!0,this._angle=n,n=n-(135-22.5),n=(n+360)%360,this._avatarImage.setDirectionAngle(si.FULL,n)),(o!==this._headAngle||i)&&(s=!0,this._headAngle=o,this._headAngle!==this._angle&&(o=o-(135-22.5),o=(o+360)%360,this._avatarImage.setDirectionAngle(si.HEAD,o))),this._geometryUpdateCounter=e.updateId,this.updateObjectCounter=this.object.updateCounter,s}updateModel(t,e){if(!t||this.updateModelCounter===t.updateCounter)return!1;let s=!1;const i=t.getValue(C.FIGURE_TALK)>0;i!==this._talk&&(this._talk=i,s=!0);const n=t.getValue(C.FIGURE_EXPRESSION);n!==this._expression&&(this._expression=n,s=!0);const o=t.getValue(C.FIGURE_SLEEP)>0;o!==this._sleep&&(this._sleep=o,s=!0);const l=t.getValue(C.FIGURE_BLINK)>0;l!==this._blink&&(this._blink=l,s=!0);const c=t.getValue(C.FIGURE_GESTURE)||0;c!==this._gesture&&(this._gesture=c,s=!0);const u=t.getValue(C.FIGURE_POSTURE);u!==this._posture&&(this._posture=u,s=!0);const h=t.getValue(C.FIGURE_POSTURE_PARAMETER);h!==this._postureParameter&&(this._postureParameter=h,s=!0);const d=t.getValue(C.FIGURE_CAN_STAND_UP);d!==this._canStandUp&&(this._canStandUp=d,s=!0);const g=t.getValue(C.FIGURE_VERTICAL_OFFSET)*ft.BASE_Y_SCALE;g!==this._verticalOffset&&(this._verticalOffset=g,s=!0);const E=t.getValue(C.FIGURE_DANCE)||0;E!==this._dance&&(this._dance=E,s=!0);const m=t.getValue(C.FIGURE_EFFECT)||0;m!==this._effect&&(this._effect=m,s=!0);const I=t.getValue(C.FIGURE_CARRY_OBJECT)||0;I!==this._carryObject&&(this._carryObject=I,s=!0);const p=t.getValue(C.FIGURE_USE_OBJECT)||0;p!==this._useObject&&(this._useObject=p,s=!0);const T=t.getValue(C.HEAD_DIRECTION);T!==this._headDirection&&(this._headDirection=T,s=!0),this._carryObject>0&&p>0?this._useObject!==this._carryObject&&(this._useObject=this._carryObject,s=!0):this._useObject!==0&&(this._useObject=0,s=!0);let R=this.getAddition(ft.FLOATING_IDLE_Z_ID);this._sleep?(R||(R=this.addAddition(new uR(ft.FLOATING_IDLE_Z_ID,this))),s=!0):R&&this.removeAddition(ft.FLOATING_IDLE_Z_ID);const S=t.getValue(C.FIGURE_IS_MUTED)>0;let b=this.getAddition(ft.MUTED_BUBBLE_ID);if(S)b||(b=this.addAddition(new M6(ft.MUTED_BUBBLE_ID,this))),s=!0;else{b&&(this.removeAddition(ft.MUTED_BUBBLE_ID),s=!0);const rt=t.getValue(C.FIGURE_IS_TYPING)>0;let J=this.getAddition(ft.TYPING_BUBBLE_ID);rt?(J||(J=this.addAddition(new D6(ft.TYPING_BUBBLE_ID,this))),s=!0):J&&(this.removeAddition(ft.TYPING_BUBBLE_ID),s=!0)}const N=t.getValue(C.FIGURE_GUIDE_STATUS)||0;N!==Ia.NONE?(this.removeAddition(ft.GUIDE_BUBBLE_ID),this.addAddition(new x6(ft.GUIDE_BUBBLE_ID,this,N)),s=!0):this.getAddition(ft.GUIDE_BUBBLE_ID)&&(this.removeAddition(ft.GUIDE_BUBBLE_ID),s=!0);const P=t.getValue(C.FIGURE_IS_PLAYING_GAME)>0;let B=this.getAddition(ft.GAME_CLICK_TARGET_ID);P?(B||(B=this.addAddition(new hR(ft.GAME_CLICK_TARGET_ID))),s=!0):B&&this.removeAddition(ft.GAME_CLICK_TARGET_ID);const F=t.getValue(C.FIGURE_NUMBER_VALUE);let w=this.getAddition(ft.NUMBER_BUBBLE_ID);F>0?(w||(w=this.addAddition(new y6(ft.NUMBER_BUBBLE_ID,F,this))),s=!0):w&&this.removeAddition(ft.NUMBER_BUBBLE_ID);let U=this.getAddition(ft.EXPRESSION_ID);this._expression>0?U||(U=cR.getExpressionAddition(ft.EXPRESSION_ID,this._expression,this),U&&this.addAddition(U)):U&&this.removeAddition(ft.EXPRESSION_ID),this.updateScale(e);const G=t.getValue(C.GENDER);G!==this._gender&&(this._gender=G,s=!0),this.updateFigure(t.getValue(C.FIGURE))&&(s=!0);let K=t.getValue(C.FIGURE_SIGN);K===null&&(K=-1),this._sign!==K&&(this._sign=K,s=!0);const z=t.getValue(C.FIGURE_HIGHLIGHT_ENABLE)>0;if(z!==this._highlightEnabled&&(this._highlightEnabled=z,s=!0),this._highlightEnabled){const rt=t.getValue(C.FIGURE_HIGHLIGHT)>0;rt!==this._highlight&&(this._highlight=rt,s=!0)}const et=t.getValue(C.OWN_USER)>0;return et!==this._ownUser&&(this._ownUser=et,s=!0),this.updateModelCounter=t.updateCounter,s}setDirection(t){this._direction!==t&&(this._direction=t,this._needsUpdate=!0)}updateScale(t){t<48&&(this._blink=!1),this._posture==="sit"||this._posture==="lay"?this._postureOffset=t/2:this._postureOffset=0,this._layInside=!1,this._isLaying=!1,this._posture==="lay"&&(this._isLaying=!0,parseInt(this._postureParameter)<0&&(this._layInside=!0))}processActionsForAvatar(t){if(!t)return;if(t.initActionAppends(),t.appendAction(mt.POSTURE,this._posture,this._postureParameter),this._gesture>0&&this._avatarImage.appendAction(mt.GESTURE,mt.getGesture(this._gesture)),this._dance>0&&this._avatarImage.appendAction(mt.DANCE,this._dance),this._sign>-1&&this._avatarImage.appendAction(mt.SIGN,this._sign),this._carryObject>0&&this._avatarImage.appendAction(mt.CARRY_OBJECT,this._carryObject),this._useObject>0&&this._avatarImage.appendAction(mt.USE_OBJECT,this._useObject),this._talk&&this._avatarImage.appendAction(mt.TALK),(this._sleep||this._blink)&&this._avatarImage.appendAction(mt.SLEEP),this._expression>0){const s=mt.getExpression(this._expression);if(s!=="")switch(s){case mt.DANCE:this._avatarImage.appendAction(mt.DANCE,2);break;default:this._avatarImage.appendAction(s);break}}this._effect>0&&this._avatarImage.appendAction(mt.EFFECT,this._effect),t.endActionAppends(),this._isAnimating=t.isAnimating();let e=ft.INITIAL_RESERVED_SPRITES;for(const s of this._avatarImage.getSprites())s.id!==ft.AVATAR&&e++;if(e!==this.totalSprites&&this.createSprites(e),this._extraSpritesStartIndex=e,this._additions)for(const s of this._additions.values())this.createSprite()}updateFigure(t){return this._figure===t?!1:(this._figure=t,this.clearAvatar(),!0)}resetFigure(t){this.clearAvatar()}resetEffect(t){this.clearAvatar()}clearAvatar(){for(const e of this._cachedAvatars.getValues())e&&e.dispose();for(const e of this._cachedAvatarEffects.getValues())e&&e.dispose();this._cachedAvatars.reset(),this._cachedAvatarEffects.reset(),this._avatarImage=null;const t=this.getSprite(ft.AVATAR_LAYER_ID);t&&(t.texture=Es.EMPTY,t.alpha=255)}getAddition(t){if(!this._additions)return null;const e=this._additions.get(t);return e||null}addAddition(t){if(!this.getAddition(t.id))return this._additions.set(t.id,t),t}removeAddition(t){const e=this.getAddition(t);e&&(this._additions.delete(e.id),e.dispose())}updateShadow(t){this._shadow=null;const e=this.getSprite(ft.SHADOW_LAYER_ID);if(!e)return;let s=this._posture==="mv"||this._posture==="std"||this._posture==="sit"&&this._canStandUp;if(this._effect===ft.SNOWBOARDING_EFFECT&&(s=!1),s){if(e.visible=!0,!this._shadow||t!==this._scale){let i=0,n=0;t<48?(e.libraryAssetName="sh_std_sd_1_0_0",this._shadow=this._avatarImage.getAsset(e.libraryAssetName),i=-8,n=this._canStandUp?6:-3):(e.libraryAssetName="h_std_sd_1_0_0",this._shadow=this._avatarImage.getAsset(e.libraryAssetName),i=-17,n=this._canStandUp?10:-7),this._shadow?(e.texture=this._shadow.texture,e.offsetX=i,e.offsetY=n,e.alpha=50,e.relativeDepth=1):e.visible=!1}}else this._shadow=null,e.visible=!1}getAvatarRenderAsset(t){return this._data?this._data.getAvatarRendererAsset(t):null}get direction(){return this._direction}get posture(){return this._posture}get angle(){return this._angle}get disposed(){return this._disposed}};ft.AVATAR="avatar",ft.FLOATING_IDLE_Z_ID=1,ft.TYPING_BUBBLE_ID=2,ft.EXPRESSION_ID=3,ft.NUMBER_BUBBLE_ID=4,ft.GAME_CLICK_TARGET_ID=5,ft.MUTED_BUBBLE_ID=6,ft.GUIDE_BUBBLE_ID=7,ft.OWN_USER_ID=4,ft.UPDATE_TIME_INCREASER=41,ft.AVATAR_LAYER_ID=0,ft.SHADOW_LAYER_ID=1,ft.SNOWBOARDING_EFFECT=97,ft.INITIAL_RESERVED_SPRITES=2,ft.ANIMATION_FRAME_UPDATE_INTERVAL=2,ft.DEFAULT_CANVAS_OFFSETS=[0,0,0],ft.MAX_EFFECT_CACHE=2,ft.SPRITE_INDEX_AVATAR=0,ft.BASE_Y_SCALE=1e3,ft.AVATAR_SPRITE_DEFAULT_DEPTH=-.01,ft.AVATAR_OWN_DEPTH_ADJUST=.001,ft.AVATAR_SPRITE_LAYING_DEPTH=-.409;let dR=ft;const fr=class fr{static allocate(t,e,s,i,n,o,l=-1,c=0){const u=fr.POOL.length?fr.POOL.pop():new fr;return i<1&&(i=1),n<0&&(n=fr.FRAME_REPEAT_FOREVER),u._id=t,u._x=e||0,u._y=s||0,u._repeats=i,u._frameRepeats=n,u._remainingFrameRepeats=n,u._isLastFrame=o,u._isRecycled=!1,l>=0?(u._activeSequence=l,u._activeSequenceOffset=c):(u._activeSequence=-1,u._activeSequenceOffset=0),u}get id(){return this._id>=0?this._id:-this._id*Math.random()}get x(){return this._x}get y(){return this._y}get repeats(){return this._repeats}get frameRepeats(){return this._frameRepeats}get isLastFrame(){return this._isLastFrame}get remainingFrameRepeats(){return this._frameRepeats<0?fr.FRAME_REPEAT_FOREVER:this._remainingFrameRepeats}set remainingFrameRepeats(t){t<0&&(t=0),this._frameRepeats>0&&t>this._frameRepeats&&(t=this._frameRepeats),this._remainingFrameRepeats=t}get activeSequence(){return this._activeSequence}get activeSequenceOffset(){return this._activeSequenceOffset}recycle(){this._isRecycled||(this._isRecycled=!0,fr.POOL.length<fr.POOL_SIZE_LIMIT&&fr.POOL.push(this))}};fr.FRAME_REPEAT_FOREVER=-1,fr.SEQUENCE_NOT_DEFINED=-1,fr.POOL_SIZE_LIMIT=3e3,fr.POOL=[];let ol=fr;class XU{constructor(t,e,s,i,n,o){this._id=0,this._x=0,this._y=0,this._randomX=0,this._randomY=0,this._repeats=1,this._id=t,this._x=e,this._y=s,this._randomX=i,this._randomY=n,this._repeats=o}get id(){return this._id}hasDirectionalOffsets(){return!1}getX(t){return this._x}getY(t){return this._y}get x(){return this._x}get y(){return this._x}get randomX(){return this._randomX}get randomY(){return this._randomY}get repeats(){return this._repeats}}class b6 extends XU{constructor(t,e,s,i,n,o,l){super(t,e,s,i,n,l),this._directionalOffsets=o}hasDirectionalOffsets(){return this._directionalOffsets!==null}getX(t){return this._directionalOffsets?this._directionalOffsets.getXOffset(t,super.getX(t)):super.getX(t)}getY(t){return this._directionalOffsets?this._directionalOffsets.getYOffset(t,super.getY(t)):super.getY(t)}}class v6{constructor(t,e){this._frames=[],this._frameIndexes=[],this._frameRepeats=[],this._isRandom=e,this._loopCount=t<1?1:t}get isRandom(){return this._isRandom}get frameCount(){return this._frameIndexes.length*this._loopCount}dispose(){this._frames=[]}initialize(){let t=this._frameIndexes.length-1,e=-1,s=1;for(;t>=0;)this._frameIndexes[t]===e?s++:(e=this._frameIndexes[t],s=1),this._frameRepeats[t]=s,t--}addFrame(t,e,s,i,n,o){let l=1;if(this._frames.length>0){const u=this._frames[this._frames.length-1];u.id===t&&!u.hasDirectionalOffsets()&&u.x===e&&u.y===s&&u.randomX===i&&i===0&&u.randomY===n&&n===0&&(l+=u.repeats,this._frames.pop())}const c=o?new b6(t,e,s,i,n,o,l):new XU(t,e,s,i,n,l);this._frames.push(c),this._frameIndexes.push(this._frames.length-1),this._frameRepeats.push(1)}getFrame(t){return!this._frames.length||t<0||t>=this.frameCount?null:this._frames[this._frameIndexes[t%this._frameIndexes.length]]}getFrameIndex(t){return t<0||t>=this.frameCount?-1:(this._isRandom&&(t=Math.round(Math.random()*this._frameIndexes.length),t===this._frameIndexes.length&&t--),t)}getRepeats(t){return t<0||t>=this.frameCount?0:this._frameRepeats[t%this._frameRepeats.length]}}class L6{constructor(t,e,s){this._frameSequences=[],this._frameCount=-1,this._loopCount=t<0?0:t,this._frameRepeat=e<1?1:e,this._isRandom=s}get frameCount(){return this._frameCount<0&&this.calculateLength(),this._frameCount}dispose(){if(!(!this._frameSequences||!this._frameSequences.length)){for(const t of this._frameSequences)t&&t.dispose();this._frameSequences=[]}}addFrameSequence(t,e){const s=new v6(t,e);return this._frameSequences.push(s),s}calculateLength(){this._frameCount=0;for(const t of this._frameSequences)t&&(this._frameCount+=t.frameCount)}getFrame(t,e){if(this._frameCount<1)return null;if(e=e/this._frameRepeat,!this._isRandom){const n=Math.floor(e/this._frameCount);e=Math.floor(e%this._frameCount);let o=!1,l=null;(this._loopCount>0&&n>=this._loopCount||this._loopCount<=0&&this._frameCount===1)&&(e=this._frameCount-1,o=!0);let c=0,u=0;for(;u<this._frameSequences.length;){if(l=this._frameSequences[u],l){if(e<c+l.frameCount)break;c+=l.frameCount}u++}return this.getFrameFromSpecificSequence(t,l,u,e-c,o)}const s=Math.trunc(this._frameSequences.length*Math.random()),i=this._frameSequences[s];return i.frameCount<1?null:this.getFrameFromSpecificSequence(t,i,s,0,!1)}getFrameFromSequence(t,e,s,i){if(e<0||e>=this._frameSequences.length)return null;const n=this._frameSequences[e];return n?s>=n.frameCount?this.getFrame(t,i):this.getFrameFromSpecificSequence(t,n,e,s,!1):null}getFrameFromSpecificSequence(t,e,s,i,n){if(!e)return null;const o=e.getFrameIndex(i),l=e.getFrame(o);if(!l)return null;let c=l.getX(t),u=l.getY(t);const h=l.randomX,d=l.randomY;let g=l.repeats,E=!1;h&&(c=Math.trunc(c+h*Math.random())),d&&(u=Math.trunc(u+d*Math.random())),g>1&&(g=e.getRepeats(o));let m=this._frameRepeat*g;return n&&(m=ol.FRAME_REPEAT_FOREVER),!this._isRandom&&!e.isRandom&&s===this._frameSequences.length-1&&i===e.frameCount-1&&(E=!0),ol.allocate(l.id,c,u,g,m,E,s,i)}}class qU{constructor(){this._offsetX=new Map,this._offsetY=new Map}getXOffset(t,e){const s=this._offsetX.get(t);return s??e}getYOffset(t,e){const s=this._offsetY.get(t);return s??e}setDirection(t,e,s){this._offsetX.set(t,e),this._offsetY.set(t,s)}}const oa=class oa{constructor(){this._layers=new Map,this._frameCount=-1,this._randomStart=!1,this._immediateChanges=null}static getTransitionToAnimationId(t){return oa.TRANSITION_TO_ANIMATION_OFFSET+t}static getTransitionFromAnimationId(t){return oa.TRANSITION_FROM_ANIMATION_OFFSET+t}static isTransitionToAnimation(t){return t>=oa.TRANSITION_TO_ANIMATION_OFFSET&&t<oa.TRANSITION_FROM_ANIMATION_OFFSET}static isTransitionFromAnimation(t){return t>=oa.TRANSITION_FROM_ANIMATION_OFFSET}dispose(){for(const t of this._layers.values())t&&t.dispose();this._layers.clear(),this._immediateChanges=null}setImmediateChanges(t){this._immediateChanges=t}isImmediateChange(t){return!(!this._immediateChanges||this._immediateChanges.indexOf(t)===-1)}getStartFrame(t){return this._randomStart?Math.random()*this._frameCount:0}initialize(t){if(t.randomStart&&(this._randomStart=!0),t.layers)for(const e in t.layers){const s=t.layers[e];if(!s)return!1;const i=parseInt(e),n=s.loopCount!==void 0?s.loopCount:1,o=s.frameRepeat!==void 0?s.frameRepeat:1,l=s.random!==void 0&&s.random!==0;if(!this.addLayer(i,n,o,l,s))return!1}return!0}addLayer(t,e,s,i,n){const o=new L6(e,s,i);if(n.frameSequences)for(const c in n.frameSequences){const u=n.frameSequences[c];if(!u)continue;const h=u.loopCount!==void 0?u.loopCount:1,d=u.random!==void 0&&u.random!==0,g=o.addFrameSequence(h,d);if(u.frames)for(const E in u.frames){const m=u.frames[E];if(!m)return o.dispose(),!1;g.addFrame(m.id,m.x||0,m.y||0,m.randomX||0,m.randomY||0,this.readDirectionalOffsets(m))}g.initialize()}o.calculateLength(),this._layers.set(t,o);const l=o.frameCount;return l>this._frameCount&&(this._frameCount=l),!0}readDirectionalOffsets(t){let e=null;if(t&&t.offsets)for(const s in t.offsets){const i=t.offsets[s];i&&(e||(e=new qU),e.setDirection(i.direction,i.x,i.y))}return e}getFrame(t,e,s){const i=this._layers.get(e);return i?i.getFrame(t,s):null}getFrameFromSequence(t,e,s,i,n){const o=this._layers.get(e);return o?o.getFrameFromSequence(t,s,i,n):null}};oa.TRANSITION_TO_ANIMATION_OFFSET=1e6,oa.TRANSITION_FROM_ANIMATION_OFFSET=2e6,oa.DEFAULT_FRAME_NUMBER=0;let Xs=oa;const _d=class _d{constructor(t){this._colors=[],this.createColors(t)}createColors(t){if(t)for(let e=0;e<t;e++)this._colors.push(_d.DEFAULT_COLOR)}dispose(){this._colors=[]}getLayerColor(t){const e=this._colors[t];return e||_d.DEFAULT_COLOR}setColorLayer(t,e){this._colors[t]&&(this._colors[t]=e)}};_d.DEFAULT_COLOR=16777215;let yc=_d;const li=class li{constructor(){this._tag=li.DEFAULT_TAG,this._ink=li.DEFAULT_INK,this._alpha=li.DEFAULT_ALPHA,this._ignoreMouse=li.DEFAULT_IGNORE_MOUSE,this._xOffset=li.DEFAULT_XOFFSET,this._yOffset=li.DEFAULT_YOFFSET,this._zOffset=li.DEFAULT_ZOFFSET}setFromLayer(t){t&&(this._tag=t.tag,this._ink=t.ink,this._alpha=t.alpha,this._ignoreMouse=t.ignoreMouse,this._xOffset=t.xOffset,this._yOffset=t.yOffset,this._zOffset=t.zOffset)}get tag(){return this._tag}set tag(t){this._tag=t}get ink(){return this._ink}set ink(t){this._ink=t}get alpha(){return this._alpha}set alpha(t){this._alpha=t}get ignoreMouse(){return this._ignoreMouse}set ignoreMouse(t){this._ignoreMouse=t}get xOffset(){return this._xOffset}set xOffset(t){this._xOffset=t}get yOffset(){return this._yOffset}set yOffset(t){this._yOffset=t}get zOffset(){return this._zOffset}set zOffset(t){this._zOffset=t}};li.DEFAULT_COUNT=0,li.DEFAULT_DIRECTION=0,li.DEFAULT_TAG="",li.DEFAULT_INK=lo.NORMAL,li.DEFAULT_ALPHA=255,li.DEFAULT_IGNORE_MOUSE=!1,li.DEFAULT_XOFFSET=0,li.DEFAULT_YOFFSET=0,li.DEFAULT_ZOFFSET=0;let Me=li;const mC=class mC{constructor(t){this._layers=[],this.createLayers(t)}createLayers(t){if(t)for(let e=0;e<t;e++)this._layers.push(new Me)}dispose(){this._layers=[]}setFromDirection(t){if(!t)return;const e=this.layerCount;if(e===t.layerCount)for(let s=0;s<e;s++){const i=this.getLayer(s),n=t.getLayer(s);i&&i.setFromLayer(n)}}getLayer(t){const e=this._layers[t];return e||null}getLayerTag(t){const e=this.getLayer(t);return e?e.tag:Me.DEFAULT_TAG}setLayerTag(t,e){const s=this.getLayer(t);s&&(s.tag=e)}getLayerInk(t){const e=this.getLayer(t);return e?e.ink:Me.DEFAULT_INK}setLayerInk(t,e){const s=this.getLayer(t);s&&(isNaN(e)||(s.ink=e))}getLayerAlpha(t){const e=this.getLayer(t);return e?e.alpha:Me.DEFAULT_ALPHA}setLayerAlpha(t,e){const s=this.getLayer(t);s&&(isNaN(e)||(s.alpha=e))}getLayerIgnoreMouse(t){const e=this.getLayer(t);return e?e.ignoreMouse:Me.DEFAULT_IGNORE_MOUSE}setLayerIgnoreMouse(t,e){const s=this.getLayer(t);s&&(s.ignoreMouse=e||!1)}getLayerXOffset(t){const e=this.getLayer(t);return e?e.xOffset:Me.DEFAULT_XOFFSET}setLayerXOffset(t,e){const s=this.getLayer(t);s&&(isNaN(e)||(s.xOffset=e))}getLayerYOffset(t){const e=this.getLayer(t);return e?e.yOffset:Me.DEFAULT_YOFFSET}setLayerYOffset(t,e){const s=this.getLayer(t);s&&(isNaN(e)||(s.yOffset=e))}getLayerZOffset(t){const e=this.getLayer(t);return e?e.zOffset:Me.DEFAULT_ZOFFSET}setLayerZOffset(t,e){const s=this.getLayer(t);s&&(isNaN(e)||(s.zOffset=e))}get layerCount(){return this._layers.length}};mC.USE_DEFAULT_DIRECTION=-1;let tl=mC;const gd=class gd{constructor(t,e){this._layerCount=t<0?0:t>gd.MAX_LAYERS?gd.MAX_LAYERS:t,this._angle=e<1?1:e>360?360:e,this._defaultDirection=new tl(this._layerCount),this._directions=new Map,this._colors=[],this._lastDirectionData=null,this._lastDirection=-1}dispose(){this._defaultDirection&&this._defaultDirection.dispose();for(const t of this._directions.values())t&&t.dispose();for(const t of this._colors)t&&t.dispose();this.reset()}reset(){this._defaultDirection=null,this._colors=[],this._lastDirectionData=null,this._lastDirection=-1,this._directions.clear()}processLayers(t){return t?this.setDirectionLayers(this._defaultDirection,t):!1}processDirections(t){if(!t)return!1;for(const e in t){const s=t[e];if(!s)continue;const i=parseInt(e);if(this._directions.get(i))return!1;const n=new tl(this._layerCount);n.setFromDirection(this._defaultDirection),this.setDirectionLayers(n,s.layers),this._directions.set(i,n),this._lastDirectionData=null,this._lastDirection=-1}return!0}processColors(t){if(!t)return!1;for(const e in t){const s=t[e];if(!s)continue;const i=parseInt(e);if(this._colors[i])return!1;const n=new yc(this._layerCount);for(const o in s.layers){const l=s.layers[o];if(!l)continue;const c=parseInt(o),u=l.color;n.setColorLayer(c,u)}this._colors[i]=n}return!0}setDirectionLayers(t,e){if(!t||!e)return!1;for(const s in e){const i=e[s];if(!i)continue;const n=parseInt(s);if(n<0||n>=this._layerCount)return!1;i.ink!==void 0&&t.setLayerInk(n,$w.inkToBlendMode(i.ink)),i.tag!==void 0&&t.setLayerTag(n,i.tag),i.alpha!==void 0&&t.setLayerAlpha(n,i.alpha),i.ignoreMouse!==void 0&&t.setLayerIgnoreMouse(n,i.ignoreMouse),i.x!==void 0&&t.setLayerXOffset(n,i.x),i.y!==void 0&&t.setLayerYOffset(n,i.y),i.z!==void 0&&t.setLayerZOffset(n,i.z/-1e3)}return!0}getValidDirection(t){if(this._directions.get(t))return t;t=(t%360+360)%360;let s=-1,i=-1;for(const n of this._directions.keys()){let o=(n*this._angle-t+360)%360;o>180&&(o=360-o),(o<s||s<0)&&(s=o,i=n)}return i>=0?Math.trunc(i):0}getDirectionData(t){if(t===this._lastDirection&&this._lastDirectionData)return this._lastDirectionData;let e=this._directions.get(t);return e||(e=this._defaultDirection),this._lastDirection=t,this._lastDirectionData=e,this._lastDirectionData}getLayerTag(t,e){const s=this.getDirectionData(t);return s?s.getLayerTag(e):Me.DEFAULT_TAG}getLayerInk(t,e){const s=this.getDirectionData(t);return s?s.getLayerInk(e):Me.DEFAULT_INK}getLayerAlpha(t,e){const s=this.getDirectionData(t);return s?s.getLayerAlpha(e):Me.DEFAULT_ALPHA}getLayerColor(t,e){const s=this._colors[e];return s?s.getLayerColor(t):yc.DEFAULT_COLOR}getLayerIgnoreMouse(t,e){const s=this.getDirectionData(t);return s?s.getLayerIgnoreMouse(e):Me.DEFAULT_IGNORE_MOUSE}getLayerXOffset(t,e){const s=this.getDirectionData(t);return s?s.getLayerXOffset(e):Me.DEFAULT_XOFFSET}getLayerYOffset(t,e){const s=this.getDirectionData(t);return s?s.getLayerYOffset(e):Me.DEFAULT_YOFFSET}getLayerZOffset(t,e){const s=this.getDirectionData(t);return s?s.getLayerZOffset(e):Me.DEFAULT_ZOFFSET}get layerCount(){return this._layerCount}};gd.MAX_LAYERS=26;let ff=gd;class mf extends ff{constructor(t,e){super(t,e),this._animations=new Map,this._animationIds=[]}dispose(){super.dispose();for(const t of this._animations.values())t&&t.dispose();this._animations.clear(),this._animationIds=[]}defineAnimations(t){if(!t)return!0;for(const e in t){const s=t[e];if(!s)return!1;let i=parseInt(e.split("_")[0]),n=!1;const o=s.transitionTo,l=s.transitionFrom;o!==void 0&&(i=Xs.getTransitionToAnimationId(o),n=!0),l!==void 0&&(i=Xs.getTransitionFromAnimationId(l),n=!0);const c=this.createAnimationData();if(!c.initialize(s))return c.dispose(),!1;const u=s.immediateChangeFrom;if(u!==void 0){const h=u.split(","),d=[];for(const g of h){const E=parseInt(g);d.indexOf(E)===-1&&d.push(E)}c.setImmediateChanges(d)}this._animations.set(i,c),n||this._animationIds.push(i)}return!0}createAnimationData(){return new Xs}hasAnimation(t){return!!this._animations.get(t)}getAnimationCount(){return this._animationIds.length||0}getAnimationId(t){const e=this.getAnimationCount();return t<0||e<=0?0:this._animationIds[t%e]}isImmediateChange(t,e){const s=this._animations.get(t);return s?s.isImmediateChange(e):!1}getStartFrame(t,e){const s=this._animations.get(t);return s?s.getStartFrame(e):0}getFrame(t,e,s,i){const n=this._animations.get(t);return n?n.getFrame(e,s,i):null}getFrameFromSequence(t,e,s,i,n,o){const l=this._animations.get(t);return l?l.getFrameFromSequence(e,s,i,n,o):null}}class QU{constructor(){this._animationId=-1,this._animationAfterTransitionId=0,this._animationOver=!1,this._frameCounter=0,this._frames=[],this._lastFramePlayed=[],this._animationPlayed=[],this._layerCount=0}get animationOver(){return this._animationOver}set animationOver(t){this._animationOver=t}get frameCounter(){return this._frameCounter}set frameCounter(t){this._frameCounter=t}get animationId(){return this._animationId}set animationId(t){t!==this._animationId&&(this._animationId=t,this.resetAnimationFrames(!1))}get animationAfterTransitionId(){return this._animationAfterTransitionId}set animationAfterTransitionId(t){this._animationAfterTransitionId=t}dispose(){this.recycleFrames(),this._frames=null,this._lastFramePlayed=null,this._animationPlayed=null}setLayerCount(t){this._layerCount=t,this.resetAnimationFrames()}resetAnimationFrames(t=!0){(t||!this._frames)&&(this.recycleFrames(),this._frames=[]),this._lastFramePlayed=[],this._animationPlayed=[],this._animationOver=!1,this._frameCounter=0;let e=0;for(;e<this._layerCount;){if(t||this._frames.length<=e)this._frames[e]=null;else{const s=this._frames[e];s&&(s.recycle(),this._frames[e]=ol.allocate(s.id,s.x,s.y,s.repeats,0,s.isLastFrame))}this._lastFramePlayed[e]=!1,this._animationPlayed[e]=!1,e++}}recycleFrames(){if(!(!this._frames||!this._frames.length))for(const t of this._frames)t&&t.recycle()}getFrame(t){return t<0||t>=this._layerCount?null:this._frames[t]}setFrame(t,e){if(t<0||t>=this._layerCount)return;const s=this._frames[t];s&&s.recycle(),this._frames[t]=e}getAnimationPlayed(t){return t<0||t>=this._layerCount?!0:this._animationPlayed[t]}setAnimationPlayed(t,e){t<0||t>=this._layerCount||(this._animationPlayed[t]=e)}getLastFramePlayed(t){return t<0||t>=this._layerCount?!0:this._lastFramePlayed[t]}setLastFramePlayed(t,e){t<0||t>=this._layerCount||(this._lastFramePlayed[t]=e)}}const oE=class oE extends mf{constructor(t,e){super(t,e),this._posturesToAnimations=new Map,this._gesturesToAnimations=new Map,this._defaultPosture=null}processPostures(t){if(!t||(t.defaultPosture&&t.defaultPosture.length&&(this._defaultPosture=t.defaultPosture),!t.postures))return!1;for(const e of t.postures)this._posturesToAnimations.get(e.id)||(this._defaultPosture===null&&(this._defaultPosture=e.id),this._posturesToAnimations.set(e.id,e.animationId));return this._posturesToAnimations.get(this._defaultPosture)!==void 0}processGestures(t){if(!t)return!1;for(const e of t)this._gesturesToAnimations.get(e.id)||this._gesturesToAnimations.set(e.id,e.animationId);return!0}postureToAnimation(t){return this._posturesToAnimations.get(t)||(t=this._defaultPosture),this._posturesToAnimations.get(t)}getGestureDisabled(t){return t==="ded"}gestureToAnimation(t){return this._gesturesToAnimations.get(t)?this._gesturesToAnimations.get(t):oE.DEFAULT}animationToPosture(t,e){if(t>=0&&t<this._posturesToAnimations.size){const s=this._posturesToAnimations.keys();for(;;){const i=s.next();if(i.done)return null;if(t<=0)return i.value;--t}}return e?this._defaultPosture:null}animationToGesture(t){if(t>=0&&t<this._gesturesToAnimations.size){const e=this._gesturesToAnimations.keys();for(;;){const s=e.next();if(s.done)return null;if(t<=0)return s.value;--t}}return null}getGestureForAnimationId(t){for(const e of this._gesturesToAnimations.keys())if(this._gesturesToAnimations.get(e)===t)return e;return null}get totalPostures(){return this._posturesToAnimations.size}get totalGestures(){return this._gesturesToAnimations.size}};oE.DEFAULT=-1;let Dl=oE;const EC=class EC{constructor(){this._type="",this._sizes=[],this._sizeDatas=new Map,this._lastSize=-1,this._lastSizeScale=-1,this._lastSizeData=null,this._lastSizeDataScale=-1}initialize(t){return this.reset(),t?(this._type=t.name,this.defineVisualizations(t.visualizations)?!0:(this.reset(),!1)):!1}dispose(){if(this._sizeDatas&&this._sizeDatas.size){for(const t of this._sizeDatas.values())t&&t.dispose();this._sizeDatas=null}this._lastSizeData=null,this._sizes=null}reset(){if(this._type="",this._sizeDatas&&this._sizeDatas.size)for(const t of this._sizeDatas.values())t&&t.dispose();this._sizeDatas.clear(),this._sizes=[],this._lastSizeData=null,this._lastSizeDataScale=-1}createSizeData(t,e,s){return new ff(e,s)}defineVisualizations(t){if(!t)return!1;for(const e in t){const s=t[e],i=s.layerCount,n=s.angle;let o=s.size;if(o<1&&(o=1),this._sizeDatas.get(o))return!1;const l=this.createSizeData(o,i,n);if(!l)return!1;for(const c in s){const u=s[c];if(!this.processVisualElement(l,c,u))return l.dispose(),!1}this._sizeDatas.set(o,l),this._sizes.push(o)}return this._sizes.sort(),!0}processVisualElement(t,e,s){if(!t||!e||!s)return!1;switch(e){case"layers":if(!t.processLayers(s))return!1;break;case"directions":if(!t.processDirections(s))return!1;break;case"colors":if(!t.processColors(s))return!1;break}return!0}getValidSize(t){if(t===this._lastSizeScale)return this._lastSize;const e=this.getSizeIndex(t);let s=-1;return e<this._sizes.length&&(s=this._sizes[e]),this._lastSizeScale=t,this._lastSize=s,s}getSizeIndex(t){if(t<=0)return 0;let e=0,s=1;for(;s<this._sizes.length;){if(this._sizes[s]>t){this._sizes[s]/t<t/this._sizes[s-1]&&(e=s);break}e=s,s++}return e}getSizeData(t){if(t===this._lastSizeDataScale)return this._lastSizeData;const e=this.getSizeIndex(t);return e<this._sizes.length?this._lastSizeData=this._sizeDatas.get(this._sizes[e]):this._lastSizeData=null,this._lastSizeDataScale=t,this._lastSizeData}getLayerCount(t){const e=this.getSizeData(t);return e?e.layerCount:Me.DEFAULT_COUNT}getValidDirection(t,e){const s=this.getSizeData(t);return s?s.getValidDirection(e):Me.DEFAULT_DIRECTION}getLayerTag(t,e,s){const i=this.getSizeData(t);return i?i.getLayerTag(e,s):Me.DEFAULT_TAG}getLayerInk(t,e,s){const i=this.getSizeData(t);return i?i.getLayerInk(e,s):Me.DEFAULT_INK}getLayerAlpha(t,e,s){const i=this.getSizeData(t);return i?i.getLayerAlpha(e,s):Me.DEFAULT_ALPHA}getLayerColor(t,e,s){const i=this.getSizeData(t);return i?i.getLayerColor(e,s):yc.DEFAULT_COLOR}getLayerIgnoreMouse(t,e,s){const i=this.getSizeData(t);return i?i.getLayerIgnoreMouse(e,s):Me.DEFAULT_IGNORE_MOUSE}getLayerXOffset(t,e,s){const i=this.getSizeData(t);return i?i.getLayerXOffset(e,s):Me.DEFAULT_XOFFSET}getLayerYOffset(t,e,s){const i=this.getSizeData(t);return i?i.getLayerYOffset(e,s):Me.DEFAULT_YOFFSET}getLayerZOffset(t,e,s){const i=this.getSizeData(t);return i?i.getLayerZOffset(e,s):Me.DEFAULT_ZOFFSET}get type(){return this._type}};EC.LAYER_LETTERS=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"];let ya=EC;class RO extends ya{createSizeData(t,e,s){return new mf(e,s)}processVisualElement(t,e,s){if(!t||!e||!s)return!1;switch(e){case"animations":if(!(t instanceof mf)||!t.defineAnimations(s))return!1;break;default:if(!super.processVisualElement(t,e,s))return!1;break}return!0}hasAnimation(t,e){const s=this.getSizeData(t);return s?s.hasAnimation(e):null}getAnimationCount(t){const e=this.getSizeData(t);return e?e.getAnimationCount():null}getAnimationId(t,e){const s=this.getSizeData(t);return s?s.getAnimationId(e):null}isImmediateChange(t,e,s){const i=this.getSizeData(t);return i?i.isImmediateChange(e,s):null}getStartFrame(t,e,s){const i=this.getSizeData(t);return i?i.getStartFrame(e,s):null}getFrame(t,e,s,i,n){const o=this.getSizeData(t);return o?o.getFrame(e,s,i,n):null}getFrameFromSequence(t,e,s,i,n,o,l){const c=this.getSizeData(t);return c?c.getFrameFromSequence(e,s,i,n,o,l):null}}const fd=class fd extends nh{constructor(){super(),this._data=null,this._type=null,this._direction=0,this._lastCameraAngle=NaN,this._selectedColor=0,this._furnitureLift=0,this._alphaMultiplier=1,this._alphaChanged=!1,this._clickUrl=null,this._clickHandling=!1,this._cacheDirection=-1,this._cacheScale=0,this._cacheSize=-1,this._layerCount=0,this._shadowLayerIndex=-1,this._updatedLayers=[],this._assetNames=[],this._spriteTags=[],this._spriteInks=[],this._spriteAlphas=[],this._spriteColors=[],this._spriteMouseCaptures=[],this._spriteXOffsets=[],this._spriteYOffsets=[],this._spriteZOffsets=[],this._animationNumber=0}initialize(t){return this.reset(),t instanceof ya?(this._type=t.type,this._data=t,!0):!1}dispose(){super.dispose(),this._data=null,this._updatedLayers=null,this._assetNames=null,this._spriteTags=null,this._spriteInks=null,this._spriteAlphas=null,this._spriteColors=null,this._spriteMouseCaptures=null,this._spriteXOffsets=null,this._spriteYOffsets=null,this._spriteZOffsets=null}reset(){super.reset(),this.setDirection(-1),this._data=null,this._updatedLayers=[],this._assetNames=[],this._spriteTags=[],this._spriteInks=[],this._spriteAlphas=[],this._spriteColors=[],this._spriteMouseCaptures=[],this._spriteXOffsets=[],this._spriteYOffsets=[],this._spriteZOffsets=[],this.createSprites(0)}resetLayers(t,e){this._cacheDirection===e&&this._cacheScale===t||(this._updatedLayers=[],this._assetNames=[],this._spriteTags=[],this._spriteInks=[],this._spriteAlphas=[],this._spriteColors=[],this._spriteMouseCaptures=[],this._spriteXOffsets=[],this._spriteYOffsets=[],this._spriteZOffsets=[],this._cacheDirection=e,this._cacheScale=t,this._cacheSize=this.getValidSize(t),this.setLayerCount((this._data&&this._data.getLayerCount(t)||0)+this.getAdditionalLayerCount()))}update(t,e,s,i){if(!t)return;const n=t.scale;let o=!1;this.updateObject(n,t.direction.x)&&(o=!0),this.updateModel(n)&&(o=!0);let l=0;i?this._animationNumber=this._animationNumber|this.updateAnimation(n):(l=this.updateAnimation(n)|this._animationNumber,this._animationNumber=0),(o||l!==0)&&(this.updateSprites(n,o,l),this._scale=n,this.updateSpriteCounter++)}updateObject(t,e){if(!this.object||this.updateObjectCounter===this.object.updateCounter&&t===this._scale&&this._lastCameraAngle===e)return!1;let s=this.object.getDirection().x-(e+135);if(s=(s%360+360)%360,this._data){const i=this._data.getValidDirection(t,s);this.setDirection(i)}return this._lastCameraAngle=e,this._scale=t,this.updateObjectCounter=this.object.updateCounter,this.resetLayers(t,this._direction),!0}updateModel(t){const e=this.object&&this.object.model;if(!e||this.updateModelCounter===e.updateCounter)return!1;this._selectedColor=e.getValue(C.FURNITURE_COLOR),this._clickUrl=e.getValue(C.FURNITURE_AD_URL),this._clickHandling=this._clickUrl&&this._clickUrl!==""&&this._clickUrl.indexOf("http")===0||!1,this._furnitureLift=e.getValue(C.FURNITURE_LIFT_AMOUNT)||0;let s=e.getValue(C.FURNITURE_ALPHA_MULTIPLIER);return isNaN(s)&&(s=1),this._alphaMultiplier!==s&&(this._alphaMultiplier=s,this._alphaChanged=!0),this.updateModelCounter=e.updateCounter,!0}updateSprites(t,e,s){if(this._layerCount!==this.totalSprites&&this.createSprites(this._layerCount),e){let i=this.totalSprites-1;for(;i>=0;)this.updateSprite(t,i),i--}else{let i=0;for(;s>0;)s&&this.updateSprite(t,i),i++,s=s>>1}this._alphaChanged=!1}updateSprite(t,e){const s=this.getSpriteAssetName(t,e),i=this.getSprite(e);if(s&&i){const n=this.getAsset(s,e);if(n&&n.texture){i.visible=!0,i.type=this._type,i.texture=n.texture,i.flipH=n.flipH,i.flipV=n.flipV,i.direction=this._direction;let o=0;e!==this._shadowLayerIndex?(i.tag=this.getLayerTag(t,this._direction,e),i.alpha=this.getLayerAlpha(t,this._direction,e),i.color=this.getLayerColor(t,e,this._selectedColor),i.offsetX=n.offsetX+this.getLayerXOffset(t,this._direction,e),i.offsetY=n.offsetY+this.getLayerYOffset(t,this._direction,e),i.blendMode=this.getLayerInk(t,this._direction,e),i.alphaTolerance=this.getLayerIgnoreMouse(t,this._direction,e)?Fn.MATCH_NOTHING:Fn.MATCH_OPAQUE_PIXELS,o=this.getLayerZOffset(t,this._direction,e),o=o-e*.001):(i.offsetX=n.offsetX,i.offsetY=n.offsetY+this.getLayerYOffset(t,this._direction,e),i.alpha=48*this._alphaMultiplier,i.alphaTolerance=Fn.MATCH_NOTHING,o=1),i.relativeDepth=o*fd.DEPTH_MULTIPLIER,i.name=s,i.libraryAssetName=this.getLibraryAssetNameForSprite(n,i),i.posture=this.getPostureForAsset(t,n.source),i.clickHandling=this._clickHandling}else this.resetSprite(i)}else i&&this.resetSprite(i)}getLibraryAssetNameForSprite(t,e){return t.source}getPostureForAssetFile(t,e){return null}resetSprite(t){t&&(t.texture=null,t.libraryAssetName="",t.posture="",t.tag="",t.offsetX=0,t.offsetY=0,t.flipH=!1,t.flipV=!1,t.relativeDepth=0,t.clickHandling=!1)}getSpriteAssetName(t,e){if(!this._data||e>=ya.LAYER_LETTERS.length)return"";let s=this._assetNames[e],i=this._updatedLayers[e];return(!s||!s.length)&&(s=this.cacheSpriteAssetName(t,e,!0),i=this._cacheSize!==1),i&&(s+=this.getFrameNumber(t,e)),s}cacheSpriteAssetName(t,e,s){this._type;const i=s?this._cacheSize:this.getValidSize(t);let n="";const o=i!==1;if(e!==this._shadowLayerIndex?n=ya.LAYER_LETTERS[e]||"":n="sd",n==="")return null;const l=this._type+(o?"_"+i+"_"+n+"_"+this._direction+"_":"_icon_"+n);return s&&(this._assetNames[e]=l,this._updatedLayers[e]=o),l}getLayerTag(t,e,s){const i=this._spriteTags[s];if(i!==void 0)return i;if(!this._data)return Me.DEFAULT_TAG;const n=this._data.getLayerTag(t,e,s);return this._spriteTags[s]=n,n}getLayerInk(t,e,s){const i=this._spriteInks[s];if(i!==void 0)return i;if(!this._data)return Me.DEFAULT_INK;const n=this._data.getLayerInk(t,e,s);return this._spriteInks[s]=n,n}getLayerAlpha(t,e,s){if(!this._alphaChanged){const n=this._spriteAlphas[s];if(n!==void 0)return n}if(!this._data)return Me.DEFAULT_ALPHA;let i=this._data.getLayerAlpha(t,e,s);return this._alphaMultiplier!==null&&(i=i*this._alphaMultiplier),this._spriteAlphas[s]=i,i}getLayerColor(t,e,s){const i=this._spriteColors[e];if(i!==void 0)return i;if(!this._data)return yc.DEFAULT_COLOR;const n=this._data.getLayerColor(t,e,s);return this._spriteColors[e]=n,n}getLayerIgnoreMouse(t,e,s){const i=this._spriteMouseCaptures[s];if(i!==void 0)return i;if(!this._data)return Me.DEFAULT_IGNORE_MOUSE;const n=this._data.getLayerIgnoreMouse(t,e,s);return this._spriteMouseCaptures[s]=n,n}getLayerXOffset(t,e,s){const i=this._spriteXOffsets[s];if(i!==void 0)return i;if(!this._data)return Me.DEFAULT_XOFFSET;const n=this._data.getLayerXOffset(t,e,s);return this._spriteXOffsets[s]=n,n}getLayerYOffset(t,e,s){if(s===this._shadowLayerIndex)return Math.ceil(this._furnitureLift*(t/2));const i=this._spriteYOffsets[s];if(i!==void 0)return i;if(!this._data)return Me.DEFAULT_YOFFSET;const n=this._data.getLayerYOffset(t,e,s);return this._spriteYOffsets[s]=n,n}getLayerZOffset(t,e,s){const i=this._spriteZOffsets[s];if(i!==void 0)return i;if(!this._data)return Me.DEFAULT_ZOFFSET;const n=this._data.getLayerZOffset(t,e,s);return this._spriteZOffsets[s]=n,n}getValidSize(t){return this._data?this._data.getValidSize(t):t}setLayerCount(t){this._layerCount=t,this._shadowLayerIndex=t-this.getAdditionalLayerCount()}setDirection(t){this._direction!==t&&(this._direction=t)}getAdditionalLayerCount(){return 1}updateAnimation(t){return 0}getFrameNumber(t,e){return 0}getPostureForAsset(t,e){return null}getAsset(t,e=-1){return this.asset?this.asset.getAsset(t):null}get direction(){return this._direction}get data(){return this._data}};fd.DEPTH_MULTIPLIER=Math.sqrt(.5),fd.TYPE=ht.FURNITURE_STATIC;let Io=fd;const vu=class vu extends Io{constructor(){super(),this._state=-1,this._frameIncrease=1,this._animationData=new QU,this._animationScale=0,this._animationChangeTime=0,this._animatedLayerCount=0,this._directionChanged=!1}initialize(t){return t instanceof RO?super.initialize(t):!1}dispose(){super.dispose(),this._animationData&&(this._animationData.dispose(),this._animationData=null)}get animatedLayerCount(){return this._animatedLayerCount}get animationId(){return this._animationData.animationId}getAnimationId(t){return this.animationId!==vu.DEFAULT_ANIMATION_ID&&this.data.hasAnimation(this._animationScale,this.animationId)?this.animationId:vu.DEFAULT_ANIMATION_ID}updateObject(t,e){if(super.updateObject(t,e)){const s=this.object.getState(0);return s!==this._state&&(this.setAnimation(s),this._state=s,this._animationChangeTime=this.object.model.getValue(C.FURNITURE_STATE_UPDATE_TIME)||0),!0}return!1}updateModel(t){if(super.updateModel(t)){if(this.usesAnimationResetting()){const s=this.object.model.getValue(C.FURNITURE_STATE_UPDATE_TIME);s>this._animationChangeTime&&(this._animationChangeTime=s,this.setAnimation(this._state))}const e=this.object.model.getValue(C.FURNITURE_AUTOMATIC_STATE_INDEX);if(!isNaN(e)){const s=this.data.getAnimationId(this._animationScale,e);this.setAnimation(s)}return!0}return!1}isPlayingTransition(t,e){return!(!Xs.isTransitionFromAnimation(t.animationId)&&!Xs.isTransitionToAnimation(t.animationId)||e!==t.animationAfterTransitionId||t.animationOver)}getCurrentState(t){const e=t.animationId;return!Xs.isTransitionFromAnimation(e)&&!Xs.isTransitionToAnimation(e)?e:t.animationAfterTransitionId}setAnimation(t){this.data&&this.setSubAnimation(this._animationData,t,this._state>=0)}setSubAnimation(t,e,s=!0){const i=t.animationId;if(s){if(this.isPlayingTransition(t,e))return!1;const n=this.getCurrentState(t);if(e!==n){if(!this.data.isImmediateChange(this._animationScale,e,n)){let o=Xs.getTransitionFromAnimationId(n);this.data.hasAnimation(this._animationScale,o)?(t.animationAfterTransitionId=e,e=o):(o=Xs.getTransitionToAnimationId(e),this.data.hasAnimation(this._animationScale,o)&&(t.animationAfterTransitionId=e,e=o))}}else if(Xs.isTransitionFromAnimation(t.animationId)){const o=Xs.getTransitionToAnimationId(e);this.data.hasAnimation(this._animationScale,o)&&(t.animationAfterTransitionId=e,e=o)}else if(!Xs.isTransitionToAnimation(t.animationId)&&this.usesAnimationResetting()){const o=Xs.getTransitionFromAnimationId(n);if(this.data.hasAnimation(this._animationScale,o))t.animationAfterTransitionId=e,e=o;else{const l=Xs.getTransitionToAnimationId(e);this.data.hasAnimation(this._animationScale,l)&&(t.animationAfterTransitionId=e,e=l)}}}return i!==e?(t.animationId=e,!0):!1}getLastFramePlayed(t){return this._animationData.getLastFramePlayed(t)}resetAllAnimationFrames(){this._animationData&&this._animationData.setLayerCount(this._animatedLayerCount)}updateAnimation(t){if(!this.data)return 0;t!==this._animationScale&&(this._animationScale=t,this._animatedLayerCount=this.data.getLayerCount(t),this.resetAllAnimationFrames());const e=this.updateAnimations(t);return this._directionChanged=!1,e}updateAnimations(t){if(this._animationData.animationOver&&!this._directionChanged)return 0;const e=this.updateFramesForAnimation(this._animationData,t);return this._animationData.animationOver&&(Xs.isTransitionFromAnimation(this._animationData.animationId)||Xs.isTransitionToAnimation(this._animationData.animationId))&&(this.setAnimation(this._animationData.animationAfterTransitionId),this._animationData.animationOver=!1),e}updateFramesForAnimation(t,e){if(t.animationOver&&!this._directionChanged)return 0;const s=this.getAnimationId(t);let i=t.frameCounter;i||(i=this.data.getStartFrame(e,s,this._direction)),i+=this.frameIncrease,t.frameCounter=i,t.animationOver=!0;let n=!1,o=this._animatedLayerCount-1,l=0,c=1<<this._animatedLayerCount-1;for(;o>=0;){let u=0;if(n=t.getAnimationPlayed(o),!n||this._directionChanged){let h=t.getLastFramePlayed(o),d=t.getFrame(o);d&&d.isLastFrame&&d.remainingFrameRepeats<=this.frameIncrease&&(h=!0),(this._directionChanged||!d||d.remainingFrameRepeats>=0&&(d.remainingFrameRepeats=d.remainingFrameRepeats-this.frameIncrease)<=0)&&(u=ol.SEQUENCE_NOT_DEFINED,d&&(u=d.activeSequence),u===ol.SEQUENCE_NOT_DEFINED?d=this.data.getFrame(e,s,this._direction,o,i):d=this.data.getFrameFromSequence(e,s,this._direction,o,u,d.activeSequenceOffset+d.repeats,i),t.setFrame(o,d),l=l|c),!d||d.remainingFrameRepeats==ol.FRAME_REPEAT_FOREVER?(h=!0,n=!0):t.animationOver=!1,t.setLastFramePlayed(o,h),t.setAnimationPlayed(o,n)}c=c>>1,o--}return l}getFrameNumber(t,e){const s=this._animationData.getFrame(e);return s?s.id:super.getFrameNumber(t,e)}getLayerXOffset(t,e,s){const i=super.getLayerXOffset(t,e,s),n=this._animationData.getFrame(s);return n?i+n.x:i}getLayerYOffset(t,e,s){const i=super.getLayerYOffset(t,e,s),n=this._animationData.getFrame(s);return n?i+n.y:i}usesAnimationResetting(){return!1}setDirection(t){this._direction!==t&&(super.setDirection(t),this._directionChanged=!0)}get frameIncrease(){return this._frameIncrease}get data(){return this._data}};vu.TYPE=ht.FURNITURE_ANIMATED,vu.DEFAULT_ANIMATION_ID=0;let ys=vu;const Lu=class Lu extends ys{constructor(){super(),this._badgeId="",this._badgeAssetNameNormalScale="",this._badgeAssetNameSmallScale="",this._badgeVisibleInState=-1}updateModel(t){let e=super.updateModel(t);const s=this.object.model.getValue(C.FURNITURE_BADGE_IMAGE_STATUS),i=this.object.model.getValue(C.FURNITURE_BADGE_ASSET_NAME);if(s===-1)this._badgeAssetNameNormalScale="",this._badgeAssetNameSmallScale="";else if(s===1&&i!==this._badgeId){this._badgeId=i,this._badgeAssetNameNormalScale=this._badgeId,this._badgeAssetNameSmallScale===""&&(this._badgeAssetNameSmallScale=this._badgeAssetNameNormalScale+"_32");const n=this.object.model.getValue(C.FURNITURE_BADGE_VISIBLE_IN_STATE);isNaN(n)||(this._badgeVisibleInState=n),e=!0}return e}getSpriteAssetName(t,e){return this.getLayerTag(t,this.direction,e)!==Lu.BADGE||this._badgeVisibleInState!==-1&&this.object.getState(0)!==this._badgeVisibleInState?super.getSpriteAssetName(t,e):t===32?this._badgeAssetNameSmallScale:this._badgeAssetNameNormalScale}getLayerXOffset(t,e,s){let i=super.getLayerXOffset(t,e,s);if(this.getLayerTag(t,e,s)===Lu.BADGE){const n=this.getAsset(t===32?this._badgeAssetNameSmallScale:this._badgeAssetNameNormalScale,s);n&&(t===64?i+=(40-n.width)/2:i+=(20-n.width)/2)}return i}getLayerYOffset(t,e,s){let i=super.getLayerYOffset(t,e,s);if(this.getLayerTag(t,e,s)===Lu.BADGE){const n=this.getAsset(t===32?this._badgeAssetNameSmallScale:this._badgeAssetNameNormalScale,s);n&&(t===64?i+=(40-n.height)/2:i+=(20-n.height)/2)}return i}};Lu.BADGE="BADGE";let _R=Lu;const br=class br extends Io{constructor(){super(),this._imageUrl=null,this._shortUrl=null,this._imageReady=!1,this._isAnimated=!1,this._gifCollection=null,this._offsetX=0,this._offsetY=0,this._offsetZ=0,this._currentFrame=-1,this._totalFrames=-1}dispose(){super.dispose(),this._imageUrl&&this.asset&&this.asset.disposeAsset(this._imageUrl)}updateObject(t,e){return super.updateObject(t,e)?(this._imageReady&&this.checkAndCreateImageForCurrentState(),!0):!1}updateModel(t){const e=super.updateModel(t);if(e&&(this._offsetX=this.object.model.getValue(C.FURNITURE_BRANDING_OFFSET_X)||0,this._offsetY=this.object.model.getValue(C.FURNITURE_BRANDING_OFFSET_Y)||0,this._offsetZ=this.object.model.getValue(C.FURNITURE_BRANDING_OFFSET_Z)||0,this._isAnimated=this.object.model.getValue(C.FURNITURE_BRANDING_IS_ANIMATED)||!1),this._imageReady){if(this.checkIfImageChanged())return this._imageReady=!1,this._imageUrl=null,!0}else if(this._imageReady=this.checkIfImageReady(),this._imageReady)return this.checkAndCreateImageForCurrentState(),!0;return e}checkIfImageChanged(){const t=this.object.model.getValue(C.FURNITURE_BRANDING_IMAGE_URL);return t&&t===this._imageUrl?!1:(this._gifCollection,this.asset&&this.asset.disposeAsset(this._imageUrl),!0)}checkIfImageReady(){if(!(this.object&&this.object.model))return!1;const e=this.object.model.getValue(C.FURNITURE_BRANDING_IMAGE_URL);if(!e||this._imageUrl&&this._imageUrl===e)return!1;if(this.object.model.getValue(C.FURNITURE_BRANDING_IMAGE_STATUS)===1){let i=null;if(this._isAnimated){const n=Et.instance.roomEngine.roomContentLoader.getGifCollection(e);n&&(this._gifCollection=n,i=n.textures[0])}else i=Rr().getTexture(e);return i?(this.imageReady(i,e),!0):!1}return!1}imageReady(t,e){if(!t){this._imageUrl=null;return}this._imageUrl=e}checkAndCreateImageForCurrentState(){if(this._isAnimated){this.buildAssetsForGif();return}if(!this._imageUrl)return;const t=Rr().getTexture(this._imageUrl);if(!t)return;const e=this.object.getState(0);this.addBackgroundAsset(t,e,0)}buildAssetsForGif(){if(!this._gifCollection)return;const t=this._gifCollection.textures,e=this._gifCollection.durations;if(!t.length||!e.length||t.length!==e.length)return;const s=this.object.getState(0);for(let i=0;i<t.length;i++){const n=t[i];e[i],n&&this.addBackgroundAsset(n,s,i)}this._currentFrame=-1,this._totalFrames=t.length}addBackgroundAsset(t,e,s){let i=0,n=0,o=!1,l=!1;switch(e){case br.STATE_0:i=0,n=0,o=!1,l=!1;break;case br.STATE_1:i=-t.width,n=0,o=!0,l=!1;break;case br.STATE_2:i=-t.width,n=-t.height,o=!0,l=!0;break;case br.STATE_3:i=0,n=-t.height,o=!1,l=!0;break}this.asset.addAsset(`${this._imageUrl}_${s}`,t,!0,i,n,o,l)}getSpriteAssetName(t,e){return this.getLayerTag(t,this._direction,e)===br.BRANDED_IMAGE&&this._imageUrl?`${this._imageUrl}_${this.getFrameNumber(t,e)}`:super.getSpriteAssetName(t,e)}updateAnimation(t){return!this._imageReady||!this._isAnimated||this._totalFrames<=0?0:1}getFrameNumber(t,e){if(!this._imageReady||!this._isAnimated||this._totalFrames<=0)return 0;if(this.getLayerTag(t,this._direction,e)===br.BRANDED_IMAGE&&this._imageUrl){let i=this._currentFrame;return i<0?i=0:i+=1,i===this._totalFrames&&(i=0),this._currentFrame=i,this._currentFrame}return 0}};br.BRANDED_IMAGE="branded_image",br.STATE_0=0,br.STATE_1=1,br.STATE_2=2,br.STATE_3=3;let s_=br;class JU extends s_{getLayerXOffset(t,e,s){return super.getLayerXOffset(t,e,s)+this._offsetX}getLayerYOffset(t,e,s){return super.getLayerYOffset(t,e,s)+this._offsetY}getLayerZOffset(t,e,s){return super.getLayerZOffset(t,e,s)+this._offsetZ}}const Ho=class Ho extends ys{constructor(){super(),this._stateQueue=[],this._running=!1}setAnimation(t){if(t===-1&&!this._running){this._running=!0,this._stateQueue=[],this._stateQueue.push(Ho.ANIMATION_ID_ROLL);return}if(t>=0&&t<=7){if(this._running){this._running=!1,this._stateQueue=[],this._stateQueue.push(Ho.ANIMATION_ID_OFFSET_SLOW1),this._stateQueue.push(Ho.ANIMATION_ID_OFFSET_SLOW2+t),this._stateQueue.push(t);return}super.setAnimation(t)}}updateAnimation(t){return this.getLastFramePlayed(0)&&this._stateQueue.length&&super.setAnimation(this._stateQueue.shift()),super.updateAnimation(t)}};Ho.ANIMATION_ID_OFFSET_SLOW1=20,Ho.ANIMATION_ID_OFFSET_SLOW2=9,Ho.ANIMATION_ID_ROLL=-1;let gR=Ho;class P6 extends Io{}const la=class la extends ys{getFrameNumber(t,e){const s=this.getLayerTag(t,this.direction,e),i=this.object.getState(0);switch(s){case la.SECONDS_SPRITE:return Math.floor(i%60%10);case la.TEN_SECONDS_SPRITE:return Math.floor(i%60/10);case la.MINUTES_SPRITE:return Math.floor(i/60%10);case la.TEN_MINUTES_SPRITE:return Math.floor(i/60/10%10);default:return super.getFrameNumber(t,e)}}get animationId(){return 0}};la.SECONDS_SPRITE="seconds_sprite",la.TEN_SECONDS_SPRITE="ten_seconds_sprite",la.MINUTES_SPRITE="minutes_sprite",la.TEN_MINUTES_SPRITE="ten_minutes_sprite";let fR=la;class U6 extends nh{}const md=class md extends ys{constructor(){super(),this._thumbnailAssetNameNormal=null,this._thumbnailImageNormal=null,this._thumbnailDirection=-1,this._thumbnailChanged=!1,this._hasOutline=!1}get hasThumbnailImage(){return this._thumbnailImageNormal!=null}setThumbnailImages(t){this._thumbnailImageNormal=t,this._thumbnailChanged=!0}updateModel(t){const e=super.updateModel(t);return!this._thumbnailChanged&&this._thumbnailDirection===this.direction?e:(this.refreshThumbnail(),!0)}refreshThumbnail(){this.asset!=null&&(this._thumbnailImageNormal?this.addThumbnailAsset(this._thumbnailImageNormal,64):this.asset.disposeAsset(this.getThumbnailAssetName(64)),this._thumbnailChanged=!1,this._thumbnailDirection=this.direction)}addThumbnailAsset(t,e){let s=0;for(;s<this.totalSprites;){if(this.getLayerTag(e,this.direction,s)===md.THUMBNAIL){const i=this.cacheSpriteAssetName(e,s,!1)+this.getFrameNumber(e,s),n=this.getAsset(i,s);if(n){const o=this.generateTransformedThumbnail(t,n),l=this.getThumbnailAssetName(e);this.asset.disposeAsset(l),this.asset.addAsset(l,o,!0,n.offsetX,n.offsetY,!1,!1)}return}s++}}generateTransformedThumbnail(t,e){if(this._hasOutline){const l=new Xe,c=new Xe(gS.WHITE);c.tint=0,c.width=t.width+40,c.height=t.height+40;const u=new Xe(t),h=(c.width-u.width)/2,d=(c.height-u.height)/2;u.position.set(h,d),l.addChild(c,u),t=Ee.generateTexture(l)}const s=1.1,i=new sr,n=e.width/t.width;switch(this.direction){case 2:i.a=n,i.b=-.5*n,i.c=0,i.d=n*s,i.tx=0,i.ty=.5*n*t.width;break;case 0:case 4:i.a=n,i.b=.5*n,i.c=0,i.d=n*s,i.tx=0,i.ty=0;break;default:i.a=n,i.b=0,i.c=0,i.d=n,i.tx=0,i.ty=0}const o=new Xe(t);return o.transform.setFromMatrix(i),Ee.generateTexture(o)}getSpriteAssetName(t,e){return this._thumbnailImageNormal&&this.getLayerTag(t,this.direction,e)===md.THUMBNAIL?this.getThumbnailAssetName(t):super.getSpriteAssetName(t,e)}getThumbnailAssetName(t){return this._thumbnailAssetNameNormal=this.getFullThumbnailAssetName(this.object.id,64),this._thumbnailAssetNameNormal}getFullThumbnailAssetName(t,e){return[this._type,t,"thumb",e].join("_")}};md.THUMBNAIL="THUMBNAIL";let Ef=md;class $U extends Ef{constructor(){super(),this._cachedUrl=null,this._hasOutline=!0}updateModel(t){if(this.object){const e=this.getThumbnailURL();if(this._cachedUrl!==e)if(this._cachedUrl=e,this._cachedUrl&&this._cachedUrl!==""){const s=new Image;s.src=e,s.crossOrigin="*",s.onload=()=>{const i=Es.from(s);i.baseTexture.scaleMode=Jp.LINEAR,this.setThumbnailImages(i)}}else this.setThumbnailImages(null)}return super.updateModel(t)}getThumbnailURL(){throw new Error("This method must be overridden!")}}class j6 extends $U{constructor(){super(),this._url=null,this._typePrefix=null}getThumbnailURL(){if(!this.object)return null;if(this._url)return this._url;const t=this.object.model.getValue(C.FURNITURE_DATA);if(!t||t==="")return null;this.object.type.indexOf("")>=0&&(this._typePrefix=this.object.type.indexOf("")>=0?"":"postcards/selfie/");let s=JSON.parse(t).w||"";return s=this.buildThumbnailUrl(s),this._url=s,this._url}buildThumbnailUrl(t){return t=t.replace(".png","_small.png"),t.indexOf(".png")===-1&&(t=t+"_small.png"),t}}class qC{constructor(){this._hasMoved=!1,this._age=0,this._isEmitter=!1,this._fade=!1,this._alphaMultiplier=1}init(t,e,s,i,n,o,l,c=!1,u=null,h=!1){this._x=t,this._y=e,this._z=s,this._particleDirection=new Hr(i.x,i.y,i.z),this._particleDirection.scaleBy(n),this._lastX=this._x-this._particleDirection.x*o,this._lastY=this._y-this._particleDirection.y*o,this._lastZ=this._z-this._particleDirection.z*o,this._age=0,this._hasMoved=!1,this._lifeTime=l,this._isEmitter=c,this._frames=u,this._fade=h,this._alphaMultiplier=1,this._fadeTime=.5+Math.random()*.5}dispose(){this._particleDirection=null}update(){this._age++,this._age===this._lifeTime&&this.ignite(),this._fade&&this._age/this._lifeTime>this._fadeTime&&(this._alphaMultiplier=(this._lifeTime-this._age)/(this._lifeTime*(1-this._fadeTime)))}getAsset(){return this._frames&&this._frames.length>0?this._frames[this._age%this._frames.length]:null}ignite(){}get fade(){return this._fade}get alphaMultiplier(){return this._alphaMultiplier}get direction(){return this._particleDirection}get age(){return this._age}get isEmitter(){return this._isEmitter}get isAlive(){return this._age<=this._lifeTime}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}get z(){return this._z}set z(t){this._z=t}get lastX(){return this._lastX}set lastX(t){this._hasMoved=!0,this._lastX=t}get lastY(){return this._lastY}set lastY(t){this._hasMoved=!0,this._lastY=t}get lastZ(){return this._lastZ}set lastZ(t){this._hasMoved=!0,this._lastZ=t}get hasMoved(){return this._hasMoved}toString(){return[this._x,this._y,this._z].toString()}copy(t,e){this._x=t._x*e,this._y=t._y*e,this._z=t._z*e,this._lastX=t._lastX*e,this._lastY=t._lastY*e,this._lastZ=t._lastZ*e,this._hasMoved=t.hasMoved,this._particleDirection=t._particleDirection,this._age=t._age,this._lifeTime=t._lifeTime,this._isEmitter=t._isEmitter,this._fade=t._fade,this._fadeTime=t._fadeTime,this._alphaMultiplier=t._alphaMultiplier}}const Wo=class Wo extends qC{constructor(t="",e=-1){super(),this._roomObjectSpriteId=-1,this._timeStep=.1,this._fuseTime=10,this._energy=1,this._hasIgnited=!1,this._burstPulse=1,this._particles=[],this._name=t,this._roomObjectSpriteId=e,this._particleConfigurations=[]}dispose(){for(const t of this._particles)t.dispose();this._particles=null,this._particleConfigurations=null,super.dispose()}setup(t,e,s,i,n,o,l,c,u,h){this._maxNumberOfParticles=t,this._particlesPerFrame=e,this._force=s,this._emitterDirection=i,this._emitterDirection.normalize(),this._gravity=n,this._airFriction=o,this._explosionShape=l,this._fuseTime=u,this._energy=c,this._burstPulse=h,this.reset()}reset(){for(const t of this._particles)t.dispose();this._particles=[],this._emittedParticles=0,this._hasIgnited=!1,this.init(0,0,0,this._emitterDirection,this._force,this._timeStep,this._fuseTime,!0)}copyStateFrom(t,e){super.copy(t,e),this._force=t._force,this._emitterDirection=t._emitterDirection,this._gravity=t._gravity,this._airFriction=t._airFriction,this._explosionShape=t._explosionShape,this._fuseTime=t._fuseTime,this._energy=t._energy,this._burstPulse=t._burstPulse,this._timeStep=t._timeStep,this._hasIgnited=t._hasIgnited}configureParticle(t,e,s,i){const n={};n.lifeTime=t,n.isEmitter=e,n.frames=s,n.fade=i,this._particleConfigurations.push(n)}ignite(){this._hasIgnited=!0,this._emittedParticles<this._maxNumberOfParticles&&this.age>1&&this.releaseParticles(this,this.direction)}releaseParticles(t,e=null){e||(e=new Hr);const s=new Hr,i=this.getRandomParticleConfiguration();let n=0;for(;n<this._particlesPerFrame;){switch(this._explosionShape){case Wo.CONE:s.x=this.randomBoolean(.5)?Math.random():-Math.random(),s.y=-(Math.random()+1),s.z=this.randomBoolean(.5)?Math.random():-Math.random();break;case Wo.PLANE:s.x=this.randomBoolean(.5)?Math.random():-Math.random(),s.y=0,s.z=this.randomBoolean(.5)?Math.random():-Math.random();break;case Wo.SPHERE:s.x=this.randomBoolean(.5)?Math.random():-Math.random(),s.y=this.randomBoolean(.5)?Math.random():-Math.random(),s.z=this.randomBoolean(.5)?Math.random():-Math.random();break}s.normalize();const o=new qC;let l=0,c=!1,u=!1,h=[];i?(l=Math.floor(Math.random()*i.lifeTime+10),c=i.isEmitter,h=i.frames,u=i.fade):(l=Math.trunc(Math.floor(Math.random()*20+10)),c=!1,h=[]),o.init(t.x,t.y,t.z,s,this._energy,this._timeStep,l,c,h,u),this._particles.push(o),this._emittedParticles++,n++}}getRandomParticleConfiguration(){const t=Math.trunc(Math.floor(Math.random()*this._particleConfigurations.length));return this._particleConfigurations[t]}update(){super.update(),this.accumulateForces(),this.verlet(),this.satisfyConstraints(),!this.isAlive&&this._emittedParticles<this._maxNumberOfParticles&&this.age%this._burstPulse===0&&this.releaseParticles(this,this.direction)}verlet(){if(this.isAlive||this._emittedParticles<this._maxNumberOfParticles){const e=this.x,s=this.y,i=this.z;this.x=(2-this._airFriction)*this.x-(1-this._airFriction)*this.lastX,this.y=(2-this._airFriction)*this.y-(1-this._airFriction)*this.lastY+this._gravity*this._timeStep*this._timeStep,this.z=(2-this._airFriction)*this.z-(1-this._airFriction)*this.lastZ,this.lastX=e,this.lastY=s,this.lastZ=i}const t=[];for(const e of this._particles){e.update();const s=e.x,i=e.y,n=e.z;e.x=(2-this._airFriction)*e.x-(1-this._airFriction)*e.lastX,e.y=(2-this._airFriction)*e.y-(1-this._airFriction)*e.lastY+this._gravity*this._timeStep*this._timeStep,e.z=(2-this._airFriction)*e.z-(1-this._airFriction)*e.lastZ,e.lastX=s,e.lastY=i,e.lastZ=n,(e.y>10||!e.isAlive)&&t.push(e)}for(const e of t)e.isEmitter,this._particles.splice(this._particles.indexOf(e),1),e.dispose()}satisfyConstraints(){}accumulateForces(){for(const t of this._particles);}get particles(){return this._particles}get hasIgnited(){return this._hasIgnited}randomBoolean(t){return Math.random()<t}get roomObjectSpriteId(){return this._roomObjectSpriteId}};Wo.CONE="cone",Wo.PLANE="plane",Wo.SPHERE="sphere";let mR=Wo;class w6{constructor(t){this._canvasId=-1,this._hasIgnited=!1,this._centerX=0,this._centerY=0,this._scaleMultiplier=1,this._blend=1,this._bgColor=4278190080,this._isDone=!1,this._emitters=new hs,this._visualization=t,this._blackOverlayAlphaTransform=new Qp,this._blackOverlayAlphaTransform.alpha=1,this._particleColorTransform=new Qp,this._identityMatrix=new sr,this._translationMatrix=new sr}dispose(){for(const t of this._emitters.getValues())t.dispose();this._emitters=null,this._canvasTexture&&(this._canvasTexture.destroy(),this._canvasTexture=null),this._blackOverlay&&(this._blackOverlay.destroy(),this._blackOverlay=null),this._emptySprite&&(this._emptySprite.destroy(),this._emptySprite=null),this._blackOverlayAlphaTransform=null,this._particleColorTransform=null,this._identityMatrix=null,this._translationMatrix=null}reset(){this._currentEmitter&&this._currentEmitter.reset(),this._currentEmitter=null,this._hasIgnited=!1,this._isDone=!1,this.updateCanvas()}setAnimation(t){this._currentEmitter&&this._currentEmitter.reset(),this._currentEmitter=this._emitters.getValue(t),this._hasIgnited=!1,this._isDone=!1,this.updateCanvas()}updateCanvas(){if(!(!this._currentEmitter||this._canvasId===-1)&&(this._roomSprite=this._visualization.getSprite(this._canvasId),this._roomSprite&&this._roomSprite.texture)){if(this._roomSprite.width<=1||this._roomSprite.height<=1)return;this._canvasTexture&&(this._canvasTexture.width!==this._roomSprite.width||this._canvasTexture.height!==this._roomSprite.height)&&(this._canvasTexture=null),this.clearCanvas(),this._centerX=-this._roomSprite.offsetX,this._centerY=-this._roomSprite.offsetY,this._roomSprite.texture=this._canvasTexture}}getLayerYOffset(t,e,s){return this._currentEmitter&&this._currentEmitter.roomObjectSpriteId===s?this._currentEmitter.y*this._scaleMultiplier:0}controlsSprite(t){return this._currentEmitter?this._currentEmitter.roomObjectSpriteId==t:!1}updateSprites(){!this._currentEmitter||!this._roomSprite||(this._canvasTexture&&this._roomSprite.texture!==this._canvasTexture&&(this._roomSprite.texture=this._canvasTexture),this._hasIgnited&&this._currentEmitter.roomObjectSpriteId>=0&&(this._visualization.getSprite(this._currentEmitter.roomObjectSpriteId).visible=!1))}updateAnimation(){if(!this._currentEmitter||!this._roomSprite||this._isDone)return;const t=10;!this._hasIgnited&&this._currentEmitter.hasIgnited&&(this._hasIgnited=!0);const e=this._offsetY*this._scaleMultiplier;if(this._currentEmitter.update(),this._hasIgnited){this._currentEmitter.roomObjectSpriteId>=0&&(this._visualization.getSprite(this._currentEmitter.roomObjectSpriteId).visible=!1),this._canvasTexture||this.updateCanvas(),this.clearCanvas();for(const s of this._currentEmitter.particles){const i=this._centerX+(s.x-s.z)*t/10*this._scaleMultiplier,n=this._centerY-e+(s.y+(s.x+s.z)/2)*t/10*this._scaleMultiplier,o=s.getAsset();if(o&&o.texture)if(s.fade&&s.alphaMultiplier<1){this._translationMatrix.identity(),this._translationMatrix.translate(i+o.offsetX,n+o.offsetY);const l=new Xe(o.texture);this._particleColorTransform.alpha=s.alphaMultiplier,l.filters=[this._particleColorTransform],ws.instance.renderer.render(l,{renderTexture:this._canvasTexture,transform:this._translationMatrix,clear:!1})}else{const l=new ei(i+o.offsetX,n+o.offsetY),c=new Xe(o.texture);c.x=l.x,c.y=l.y,ws.instance.renderer.render(c,{renderTexture:this._canvasTexture,clear:!1})}else{const l=new Xe(Es.WHITE);l.tint=16777215,l.x=i-1,l.y=n-1,l.width=2,l.height=2,ws.instance.renderer.render(l,{renderTexture:this._canvasTexture,clear:!1})}}if(!this._currentEmitter.particles.length){this._isDone=!0;return}}}parseData(t){this._size=t.size,this._canvasId=t.canvasId!==void 0?t.canvasId:-1,this._offsetY=t.offsetY!==void 0?t.offsetY:10,this._scaleMultiplier=this._size/64,this._blend=t.blend!==void 0?t.blend:1,this._blend=Math.min(this._blend,1),this._blackOverlayAlphaTransform.alpha=this._blend;const e=t.bgColor!==void 0?t.bgColor:"0";if(this._bgColor=parseInt(e,16)||0,!(!t.emitters||!t.emitters.length))for(const s of t.emitters){const i=s.id,n=s.name,o=s.spriteId,l=new mR(n,o);this._emitters.add(i,l);const c=s.maxNumParticles,u=s.particlesPerFrame,h=s.burstPulse!==void 0?s.burstPulse:1,d=s.fuseTime,g=s.simulation.force,E=s.simulation.direction,m=s.simulation.gravity,I=s.simulation.airFriction,p=s.simulation.shape,T=s.simulation.energy;for(const R of s.particles){const S=R.lifeTime,b=R.isEmitter||!1,N=R.fade||!1,P=[];for(const B of R.frames)P.push(this._visualization.asset.getAsset(B));l.configureParticle(S,b,P,N)}l.setup(c,u,g,new Hr(0,E,0),m,I,p,T,d,h)}}copyStateFrom(t){let e=0;t._emitters&&t._currentEmitter&&(e=t._emitters.getKey(t._emitters.getValues().indexOf(t._currentEmitter))),this.setAnimation(e),this._currentEmitter&&this._currentEmitter.copyStateFrom(t._currentEmitter,t._size/this._size),this._canvasTexture=null}clearCanvas(){this._emptySprite||(this._emptySprite=new Xe(Es.EMPTY),this._emptySprite.alpha=0),this._canvasTexture?ws.instance.renderer.render(this._emptySprite,{renderTexture:this._canvasTexture,clear:!0}):this._canvasTexture=kn.create({width:this._roomSprite.width,height:this._roomSprite.height})}}class ZU extends ys{dispose(){if(super.dispose(),this._currentParticleSystem=null,this._particleSystems){for(const t of this._particleSystems.getValues())t.dispose();this._particleSystems=null}}updateObject(t,e){if(super.updateObject(t,e)){if(!this._particleSystems)this.readDefinition(),this._particleSystems?this._currentParticleSystem=this._particleSystems.getValue(t):dt.log("ERROR Particle systems could not be read!",this.object.type);else if(t!==this._scale||this._particleSystems.getValue(t)!==this._currentParticleSystem){const s=this._particleSystems.getValue(t);s.copyStateFrom(this._currentParticleSystem),this._currentParticleSystem&&this._currentParticleSystem.reset(),this._currentParticleSystem=s}return!0}return!1}updateSprites(t,e,s){super.updateSprites(t,e,s),this._currentParticleSystem&&this._currentParticleSystem.updateSprites()}updateAnimation(t){return this._currentParticleSystem&&this._currentParticleSystem.updateAnimation(),super.updateAnimation(t)}setAnimation(t){this._currentParticleSystem&&this._currentParticleSystem.setAnimation(t),super.setAnimation(t)}getLayerYOffset(t,e,s){return this._currentParticleSystem&&this._currentParticleSystem.controlsSprite(s)?this._currentParticleSystem.getLayerYOffset(t,e,s):super.getLayerYOffset(t,e,s)}readDefinition(){if(!this.object||!this.object.model)return!1;const t=this.object.model.getValue(C.FURNITURE_FIREWORKS_DATA);if(!t||!t.length)return!1;this._particleSystems=new hs;for(const e of t){const s=e.size,i=new w6(this);i.parseData(e),this._particleSystems.add(s,i)}return!0}}const Yo=class Yo extends ZU{constructor(){super(...arguments),this._packetType=0,this._ribbonType=0,this._lastAnimationId=0}update(t,e,s,i){this.updatePresentWrap(),super.update(t,e,s,i)}updatePresentWrap(){if(!this.object)return;const t=1e3,e=this.object.model.getValue(C.FURNITURE_EXTRAS),s=parseInt(e),i=Math.floor(s/t),n=s%t;this._packetType=i>Yo.MAX_PACKET_TYPE_VALUE?0:i,this._ribbonType=n>Yo.MAX_RIBBON_TYPE_VALUE?0:n}getFrameNumber(t,e){if(this._lastAnimationId===Yo.PRESENT_DEFAULT_STATE){if(e<=1)return this._packetType;if(e===2)return this._ribbonType}return super.getFrameNumber(t,e)}getSpriteAssetName(t,e){const s=this.getValidSize(t);let i=this._type,n="";e<this.spriteCount-1?n=String.fromCharCode(97+e):n="sd";const o=this.getFrameNumber(t,e);return i=i+("_"+s+"_"+n+"_"+this.direction),i=i+("_"+o),i}setAnimation(t){this._lastAnimationId=t,super.setAnimation(t)}};Yo.PRESENT_DEFAULT_STATE=0,Yo.MAX_PACKET_TYPE_VALUE=9,Yo.MAX_RIBBON_TYPE_VALUE=11;let ER=Yo;class F6 extends Io{constructor(){super(...arguments),this._packetType=0,this._ribbonType=0}update(t,e,s,i){this.updatePresentWrap(),super.update(t,e,s,i)}updatePresentWrap(){if(!this.object)return;const t=this.object.model.getValue(C.FURNITURE_EXTRAS),e=1e3,s=parseInt(t);this._packetType=Math.floor(s/e),this._ribbonType=s%e}getFrameNumber(t,e){return e<=1?this._packetType:this._ribbonType}getSpriteAssetName(t,e){const s=this.getValidSize(t);let i=this._type,n="";e<this.spriteCount-1?n=String.fromCharCode(97+e):n="sd";const o=this.getFrameNumber(t,e);return i=i+("_"+s+"_"+n+"_"+this.direction),i=i+("_"+o),i}}const zi=class zi extends ys{constructor(){super(),this._color1=zi.DEFAULT_COLOR_1,this._color2=zi.DEFAULT_COLOR_2,this._badgeAssetNameNormalScale="",this._badgeAssetNameSmallScale=""}updateModel(t){const e=super.updateModel(t);if(this._badgeAssetNameNormalScale===""){const n=this.object.model.getValue(C.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME);n&&(this._badgeAssetNameNormalScale=n,this._badgeAssetNameSmallScale=this._badgeAssetNameNormalScale+"_32")}const s=this.object.model.getValue(C.FURNITURE_GUILD_CUSTOMIZED_COLOR_1);this._color1=s||zi.DEFAULT_COLOR_1;const i=this.object.model.getValue(C.FURNITURE_GUILD_CUSTOMIZED_COLOR_2);return this._color2=i||zi.DEFAULT_COLOR_2,e}getLayerColor(t,e,s){switch(this.getLayerTag(t,this._direction,e)){case zi.PRIMARY_COLOUR_SPRITE_TAG:return this._color1;case zi.SECONDARY_COLOUR_SPRITE_TAG:return this._color2}return super.getLayerColor(t,e,s)}getSpriteAssetName(t,e){return this.getLayerTag(t,this._direction,e)===zi.BADGE?t===32?this._badgeAssetNameSmallScale:this._badgeAssetNameNormalScale:super.getSpriteAssetName(t,e)}getLibraryAssetNameForSprite(t,e){return e.tag===zi.BADGE?"%group.badge.url%"+e.libraryAssetName.replace("badge_",""):super.getLibraryAssetNameForSprite(t,e)}};zi.PRIMARY_COLOUR_SPRITE_TAG="COLOR1",zi.SECONDARY_COLOUR_SPRITE_TAG="COLOR2",zi.BADGE="BADGE",zi.DEFAULT_COLOR_1=15658734,zi.DEFAULT_COLOR_2=4934475;let pR=zi;const Cn=class Cn extends Ef{updateModel(t){const e=super.updateModel(t);if(!this.hasThumbnailImage){const n=this.object.model.getValue(C.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME);n&&n.length&&this.setThumbnailImages(this.getBitmapAsset(n))}const s=this.object.model.getValue(C.FURNITURE_GUILD_CUSTOMIZED_COLOR_1);this._color1=s||Cn.DEFAULT_COLOR_1;const i=this.object.model.getValue(C.FURNITURE_GUILD_CUSTOMIZED_COLOR_2);return this._color2=i||Cn.DEFAULT_COLOR_2,e}generateTransformedThumbnail(t,e){const i=new sr,n=e.width/t.width;switch(this.direction){case 2:i.a=n,i.b=-.5*n,i.c=0,i.d=n*1.1,i.tx=0,i.ty=.5*n*t.width;break;case 0:case 4:i.a=n,i.b=.5*n,i.c=0,i.d=n*1.1,i.tx=0,i.ty=0;break;default:i.a=n,i.b=0,i.c=0,i.d=n,i.tx=0,i.ty=0}const o=new Xe(t);return o.transform.setFromMatrix(i),o.position.set(0),Ee.generateTexture(o)}getLayerColor(t,e,s){switch(this.getLayerTag(t,this._direction,e)){case Cn.PRIMARY_COLOUR_SPRITE_TAG:return this._color1;case Cn.SECONDARY_COLOUR_SPRITE_TAG:return this._color2}return super.getLayerColor(t,e,s)}getLibraryAssetNameForSprite(t,e){return e.tag===Cn.THUMBNAIL&&this.object&&this.object.model.getValue(C.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME)?"%group.badge.url%"+this.object.model.getValue(C.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME):super.getLibraryAssetNameForSprite(t,e)}getBitmapAsset(t){const e=this.asset.getAsset(t);return!e||!e.texture?null:e.texture}};Cn.PRIMARY_COLOUR_SPRITE_TAG="COLOR1",Cn.SECONDARY_COLOUR_SPRITE_TAG="COLOR2",Cn.DEFAULT_COLOR_1=15658734,Cn.DEFAULT_COLOR_2=4934475;let IR=Cn;const An=class An extends ys{constructor(){super(),this._stateQueue=[],this._running=!1}setAnimation(t){if(t===-1&&!this._running){this._running=!0,this._stateQueue=[],this._stateQueue.push(An.ANIMATION_ID_START_ROLL),this._stateQueue.push(An.ANIMATION_ID_ROLL);return}if(t>0&&t<=An.ANIMATION_ID_OFFSET_SLOW1){if(this._running){this._running=!1,this._stateQueue=[],this._stateQueue.push(An.ANIMATION_ID_OFFSET_SLOW1+t),this._stateQueue.push(An.ANIMATION_ID_OFFSET_SLOW2+t),this._stateQueue.push(t);return}super.setAnimation(t)}}updateAnimation(t){return this.getLastFramePlayed(1)&&this.getLastFramePlayed(2)&&this.getLastFramePlayed(3)&&this._stateQueue.length&&super.setAnimation(this._stateQueue.shift()),super.updateAnimation(t)}};An.ANIMATION_ID_OFFSET_SLOW1=10,An.ANIMATION_ID_OFFSET_SLOW2=20,An.ANIMATION_ID_START_ROLL=31,An.ANIMATION_ID_ROLL=32;let TR=An;class G6 extends JU{constructor(){super(...arguments),this._needsTransform=!0}transformGifTextures(t){if(!this._gifCollection)return;const e=this._gifCollection.textures;if(e.length){for(let s=0;s<e.length;s++){const i=e[s];if(!i||!this.getAsset(`${this._imageUrl}_${s}`))continue;const o=1.1,l=new sr,c=t.width/i.width;switch(this.direction){case 2:l.a=c,l.b=-.5*c,l.c=0,l.d=c*o,l.tx=0,l.ty=.5*c*i.width;break;case 0:case 4:l.a=c,l.b=.5*c,l.c=0,l.d=c*o,l.tx=0,l.ty=0;break;default:l.a=c,l.b=0,l.c=0,l.d=c,l.tx=0,l.ty=0}const u=new Xe(i),h=kn.create({width:t.width+l.tx,height:t.height+l.ty});ws.instance.renderer.render(u,{renderTexture:h,clear:!0,transform:l}),this.asset.disposeAsset(`${this._imageUrl}_${s}`),this.asset.addAsset(`${this._imageUrl}_${s}`,h,!0,t.x,t.y,t.flipH,t.flipV)}this._needsTransform=!1}}generateTransformedImage(t,e){const i=new sr,n=e.width/t.width;switch(this.direction){case 2:i.a=n,i.b=-.5*n,i.c=0,i.d=n*1.1,i.tx=0,i.ty=.5*n*t.width;break;case 0:case 4:i.a=n,i.b=.5*n,i.c=0,i.d=n*1.1,i.tx=0,i.ty=0;break;default:i.a=n,i.b=0,i.c=0,i.d=n,i.tx=0,i.ty=0}const o=new Xe(t),l=kn.create({width:e.width+i.tx,height:e.height+i.ty});ws.instance.renderer.render(o,{renderTexture:l,clear:!0,transform:i}),this.asset.disposeAsset(`${this._imageUrl}_0`),this.asset.addAsset(`${this._imageUrl}_0`,l,!0,o.x,o.y,e.flipH,e.flipV),this._needsTransform=!1}checkAndCreateImageForCurrentState(){super.checkAndCreateImageForCurrentState(),this._needsTransform=!0}getSpriteAssetName(t,e){return this.getLayerTag(t,this._direction,e)===s_.BRANDED_IMAGE&&this._imageUrl?(this._needsTransform&&(this._isAnimated?this.transformGifTextures(this.getAsset(super.getSpriteAssetName(t,e))):this.generateTransformedImage(Rr().getTexture(this._imageUrl),this.getAsset(super.getSpriteAssetName(t,e)))),`${this._imageUrl}_${this.getFrameNumber(t,e)}`):super.getSpriteAssetName(t,e)}}class RR extends ya{constructor(){super(),this._avatarData=new gf}dispose(){super.dispose(),this._avatarData&&(this._avatarData.dispose(),this._avatarData=null)}createAvatarImage(t,e,s=null,i=null,n=null){return this._avatarData.createAvatarImage(t,e,s,i,n)}set avatarManager(t){this._avatarData.avatarManager=t}}const Pu=class Pu extends Io{constructor(){super(),this._mannequinScale=-1,this._figure=null,this._gender=null,this._dynamicAssetName=null,this._needsUpdate=!1,this._placeHolderFigure="hd-99999-99998",this._disposed=!1}initialize(t){return t instanceof RR?super.initialize(t):!1}dispose(){this._disposed||(this._disposed=!0,this._dynamicAssetName&&this.asset&&(this.asset.disposeAsset(this._dynamicAssetName),this._dynamicAssetName=null),super.dispose())}updateObject(t,e){const s=super.updateObject(t,e);return s&&this._mannequinScale!==t&&(this._mannequinScale=t,this.updateAvatar()),s}updateModel(t){let e=super.updateModel(t);if(e){const s=this.object.model.getValue(C.FURNITURE_MANNEQUIN_FIGURE)||null;s&&(this._figure=s+"."+this._placeHolderFigure,this._gender=this.object.model.getValue(C.FURNITURE_MANNEQUIN_GENDER)||null,this.updateAvatar())}return e=e||this._needsUpdate,this._needsUpdate=!1,e}updateAvatar(t=!1){if(!this.avatarExists()||t){const e=this.data.createAvatarImage(this._figure,this._mannequinScale,this._gender,this);e&&(e.setDirection(si.FULL,this.direction),this._dynamicAssetName&&this.asset.disposeAsset(this._dynamicAssetName),this.asset.addAsset(this.getAvatarAssetName(),e.getImage(si.FULL,!1,1,!1),!0),this._dynamicAssetName=this.getAvatarAssetName(),this._needsUpdate=!0,e.dispose())}}avatarExists(){return this._figure&&this.getAsset(this.getAvatarAssetName())!==null}getAvatarAssetName(){return"mannequin_"+this._figure+"_"+this._mannequinScale+"_"+this.direction+"_"+this.object.id}resetFigure(t){t===this._figure&&this.updateAvatar(!0)}getSpriteAssetName(t,e){const s=this.getLayerTag(t,this.direction,e);return this._figure&&s===Pu.AVATAR_IMAGE_SPRITE_TAG&&this.avatarExists()?this.getAvatarAssetName():super.getSpriteAssetName(t,e)}getLayerXOffset(t,e,s){return this.getLayerTag(t,e,s)===Pu.AVATAR_IMAGE_SPRITE_TAG&&this.avatarExists()?-this.getSprite(s).width/2:super.getLayerXOffset(t,e,s)}getLayerYOffset(t,e,s){return this.getLayerTag(t,e,s)===Pu.AVATAR_IMAGE_SPRITE_TAG&&this.avatarExists()?-this.getSprite(s).height:super.getLayerYOffset(t,e,s)}get disposed(){return this._disposed}get data(){return this._data}};Pu.AVATAR_IMAGE_SPRITE_TAG="avatar_image";let SR=Pu;const vr=class vr extends ys{constructor(){super(),this._animOffsetIndex=[]}updateAnimation(t){this._animSpeedIndex||this.initItems(t);let e=this.getSprite(2);return e&&(this._animOffsetIndex[0]=this.getNewPoint(t,0)),e=this.getSprite(3),e&&(this._animOffsetIndex[1]=this.getNewPoint(t,1)),super.updateAnimation(t)}getNewPoint(t,e){let s=0,i=this._animPhaseIndex[e],n=this._animDirectionIndex[e];const o=this._animSpeedIndex[e],l=this._animFactorIndex[e];let c=1;t==32?(s=vr.AREA_DIAMETER_SMALL,c=.5):s=vr.AREA_DIAMETER_LARGE;const u=i+n*o;Math.abs(u)>=s&&(n>0?i=i-(u-s):i=i+(-s-u),n=-n,this._animDirectionIndex[e]=n);const h=(s-Math.abs(i))*l;let d=n*Math.sin(Math.abs(i/4))*h;return n>0?d=d-h:d=d+h,i=i+n*o*c,this._animPhaseIndex[e]=i,Math.trunc(d)==0&&(this._animFactorIndex[e]=this.getRandomAmplitudeFactor()),new ei(i,d)}initItems(t){let e;t===32?e=vr.AREA_DIAMETER_SMALL:e=vr.AREA_DIAMETER_LARGE,this._animPhaseIndex=[],this._animPhaseIndex.push(Math.random()*e*1.5),this._animPhaseIndex.push(Math.random()*e*1.5),this._animDirectionIndex=[],this._animDirectionIndex.push(1),this._animDirectionIndex.push(-1),this._animSpeedIndex=[],this._animSpeedIndex.push(vr.ANIM_SPEED_FAST),this._animSpeedIndex.push(vr.ANIM_SPEED_SLOW),this._animFactorIndex=[],this._animFactorIndex.push(this.getRandomAmplitudeFactor()),this._animFactorIndex.push(this.getRandomAmplitudeFactor())}getLayerXOffset(t,e,s){return(s===2||s===3)&&this._animOffsetIndex.length==2?this._animOffsetIndex[s-2].x:super.getLayerXOffset(t,e,s)}getLayerYOffset(t,e,s){return(s===2||s===3)&&this._animOffsetIndex.length==2?this._animOffsetIndex[s-2].y:super.getLayerYOffset(t,e,s)}getRandomAmplitudeFactor(){return Math.random()*30/100+.15}};vr.UPDATE_INTERVAL=2,vr.AREA_DIAMETER_SMALL=15,vr.AREA_DIAMETER_LARGE=31,vr.ANIM_SPEED_FAST=2,vr.ANIM_SPEED_SLOW=1;let OR=vr;const lE=class lE{constructor(t,e,s,i,n,o){this._name=t,this._index=e,this._radius=s,this._arcSpeed=i*Math.PI*2/360,this._arcOffset=n*Math.PI*2/360,this._height=o,this._position=0,this._positionVector=new j(0,0,0),this._children=[]}dispose(){for(;this._children.length>0;)this._children.shift().dispose()}update(t,e,s){this._position=this._position+this._arcSpeed/lE.SYSTEM_TEMPO,t[this._index]=this.getPositionVector(e,s);for(const i of this._children)i.update(t,this._positionVector,s)}getPositionVector(t,e){const s=this._radius*Math.cos(this._position+this._arcOffset),i=this._radius*Math.sin(this._position+this._arcOffset);return this._positionVector.x=(s-i)*(e/2),this._positionVector.y=(i+s)*(e/2)*.5-this._height*(e/2),this._positionVector.z=-Math.trunc(4*(s+i)-.7),t&&this._positionVector.add(t),this._positionVector}addChild(t){this._children.indexOf(t)>=0||this._children.push(t)}hasChild(t){return!!this.getChild(t)}getChild(t){for(const e of this._children){if(e.name===t)return e;if(e.hasChild(t))return e.getChild(t)}return null}get name(){return this._name}};lE.SYSTEM_TEMPO=30;let CR=lE;class B6 extends ys{constructor(){super(),this._offsetArray=[],this._rootPosition=new j}dispose(){if(this._planetIndex)for(;this._planetIndex.length>0;)this._planetIndex.shift().dispose();this._planetIndex=null,this._planetNameIndex=null}updateAnimation(t){if(!this._planetIndex&&this.spriteCount>0&&!this.processPlanets())return 0;if(this._planetIndex){for(const e of this._planetIndex)e.update(this._offsetArray,this._rootPosition,t);return super.updateAnimation(t)}return 0}getLayerXOffset(t,e,s){return this._offsetArray[s]?this._offsetArray[s].x:super.getLayerXOffset(t,e,s)}getLayerYOffset(t,e,s){return this._offsetArray[s]?this._offsetArray[s].y:super.getLayerYOffset(t,e,s)}getLayerZOffset(t,e,s){return this._offsetArray[s]?this._offsetArray[s].z:super.getLayerZOffset(t,e,s)}processPlanets(){if(!this.object||!this.object.model)return;const t=this.object.model.getValue(C.FURNITURE_PLANETSYSTEM_DATA);if(!t)return!1;this._planetIndex=[],this._planetNameIndex=[];for(const e of t)this.getSprite(e.id)&&this.addPlanet(e.name,e.id,e.parent,e.radius||0,e.arcSpeed||0,e.arcOffset||0,e.height||0);return!0}addPlanet(t,e,s,i,n,o,l){if(!this._planetIndex)return;const c=new CR(t,e,i,n,o,l),u=this.getPlanet(s);u?u.addChild(c):(this._planetIndex.push(c),this._planetNameIndex.push(t))}getPlanet(t){for(const e of this._planetIndex){if(e.name===t)return e;if(e.hasChild(t))return e.getChild(t)}return null}}class k6 extends ys{}const eo=class eo extends ys{constructor(){super(),this._stateQueue=[],this._animationCounter=-1}setAnimation(t){return t===eo.ANIMATION_ID_ROLL_ONCE&&(this._stateQueue=[],this._stateQueue.push(eo.ANIMATION_ID_NORMAL),this._animationCounter=eo.ANIMATION_DURATION),super.setAnimation(t)}updateAnimation(t){return this._animationCounter>0&&this._animationCounter--,this._animationCounter||this._stateQueue.length&&super.setAnimation(this._stateQueue.shift()),super.updateAnimation(t)}usesAnimationResetting(){return!0}};eo.ANIMATION_ID_ROLL=3,eo.ANIMATION_ID_ROLL_ONCE=2,eo.ANIMATION_ID_NORMAL=1,eo.ANIMATION_DURATION=15;let AR=eo;class V6 extends ys{usesAnimationResetting(){return!0}}class H6 extends s_{imageReady(t,e){super.imageReady(t,e),t&&this.setImageOffset(t.width,t.height)}setImageOffset(t,e){const s=new qU;s.setDirection(1,0,-e),s.setDirection(3,0,0),s.setDirection(5,-t,0),s.setDirection(7,-t,-e),s.setDirection(4,-t/2,-e/2),this._imageOffset=s}getLayerXOffset(t,e,s){if(this._imageOffset){const i=this._imageOffset.getXOffset(e,0);if(i!==void 0)return i+this._offsetX}return super.getLayerXOffset(t,e,s)+this._offsetX}getLayerYOffset(t,e,s){if(this._imageOffset){const i=this._imageOffset.getYOffset(e,0);if(i!==void 0)return i+this._offsetY}return super.getLayerYOffset(t,e,s)+this._offsetY}getLayerZOffset(t,e,s){return super.getLayerZOffset(t,e,s)+-this._offsetZ}getLayerIgnoreMouse(t,e,s){return!0}}const ca=class ca extends ys{getFrameNumber(t,e){const s=this.getLayerTag(t,this.direction,e),i=this.object.getState(0);switch(s){case ca.ONES_SPRITE:return Math.floor(i%10);case ca.TENS_SPRITE:return Math.floor(i/10%10);case ca.HUNDREDS_SPRITE:return Math.floor(i/100%10);case ca.THOUSANDS_SPRITE:return Math.floor(i/1e3%10);default:return super.getFrameNumber(t,e)}}};ca.ONES_SPRITE="ones_sprite",ca.TENS_SPRITE="tens_sprite",ca.HUNDREDS_SPRITE="hundreds_sprite",ca.THOUSANDS_SPRITE="thousands_sprite";let NR=ca;class W6 extends ys{constructor(){super(...arguments),this._internalFrameIncreaseCounter=0}updateAnimations(t){return this._internalFrameIncreaseCounter=this._internalFrameIncreaseCounter+this.object.model.getValue(C.FURNITURE_SOUNDBLOCK_RELATIVE_ANIMATION_SPEED),this._frameIncrease=this._internalFrameIncreaseCounter,this._internalFrameIncreaseCounter=this._internalFrameIncreaseCounter-this._frameIncrease,super.updateAnimations(t)}}class Y6 extends Io{getLayerColor(t,e,s){return this._data?this._data.getLayerColor(t,e,s):yc.DEFAULT_COLOR}}const Ti=class Ti extends ys{constructor(){super(),this._stateQueue=[],this._running=!1,super.setAnimation(Ti.ANIMATION_ID_OFF)}setAnimation(t){if(t===0&&!this._running){this._running=!0,this._stateQueue=[],this._stateQueue.push(Ti.ANIMATION_ID_START_ROLL),this._stateQueue.push(Ti.ANIMATION_ID_ROLL);return}if(t>0&&t<=Ti.ANIMATION_ID_OFFSET_SLOW2){if(this._running){this._running=!1,this._stateQueue=[],this.direction===2?(this._stateQueue.push(Ti.ANIMATION_ID_OFFSET_SLOW1+5),this._stateQueue.push(Ti.ANIMATION_ID_OFFSET_SLOW2+5)):(this._stateQueue.push(Ti.ANIMATION_ID_OFFSET_SLOW1+t),this._stateQueue.push(Ti.ANIMATION_ID_OFFSET_SLOW2+t)),this._stateQueue.push(Ti.ANIMATION_ID_OFF);return}super.setAnimation(Ti.ANIMATION_ID_OFF)}}updateAnimation(t){return this.getLastFramePlayed(11)&&this._stateQueue.length&&super.setAnimation(this._stateQueue.shift()),super.updateAnimation(t)}};Ti.ANIMATION_ID_OFFSET_SLOW1=20,Ti.ANIMATION_ID_OFFSET_SLOW2=10,Ti.ANIMATION_ID_START_ROLL=31,Ti.ANIMATION_ID_ROLL=32,Ti.ANIMATION_ID_OFF=30;let xR=Ti;const Lr=class Lr extends ys{updateObject(t,e){return super.updateObject(t,e),!0}getFrameNumber(t,e){const s=this.object.model.getValue(C.FURNITURE_VOTE_COUNTER_COUNT);switch(this.getLayerTag(t,this.direction,e)){case Lr.ONES_SPRITE:return s%10;case Lr.TENS_SPRITE:return s/10%10;case Lr.HUNDREDS_SPRITE:return s/100%10;default:return super.getFrameNumber(t,e)}}getLayerAlpha(t,e,s){if(this.object.model.getValue(C.FURNITURE_VOTE_COUNTER_COUNT)===Lr.HIDE_COUNTER_SCORE)switch(this.getLayerTag(t,e,s)){case Lr.ONES_SPRITE:case Lr.TENS_SPRITE:case Lr.HUNDREDS_SPRITE:return 0}return super.getLayerAlpha(t,e,s)}};Lr.ONES_SPRITE="ones_sprite",Lr.TENS_SPRITE="tens_sprite",Lr.HUNDREDS_SPRITE="hundreds_sprite",Lr.HIDE_COUNTER_SCORE=-1;let MR=Lr;const Ki=class Ki extends ys{getFrameNumber(t,e){const s=this.object.model.getValue(C.FURNITURE_VOTE_MAJORITY_RESULT);switch(this.getLayerTag(t,this.direction,e)){case Ki.ONES_SPRITE:return s%10;case Ki.TENS_SPRITE:return s/10%10;case Ki.HUNDREDS_SPRITE:return s/100%10;default:return super.getFrameNumber(t,e)}}getLayerAlpha(t,e,s){const i=this.object.model.getValue(C.FURNITURE_VOTE_MAJORITY_RESULT);if(Ki.HIDE_RESULTS_STATES.indexOf(this.object.getState(0))!==-1||i===Ki.HIDE_RESULTS_VALUE)switch(this.getLayerTag(t,e,s)){case Ki.ONES_SPRITE:case Ki.TENS_SPRITE:case Ki.HUNDREDS_SPRITE:return 0}return super.getLayerAlpha(t,e,s)}};Ki.ONES_SPRITE="ones_sprite",Ki.TENS_SPRITE="tens_sprite",Ki.HUNDREDS_SPRITE="hundreds_sprite",Ki.HIDE_RESULTS_STATES=[-1,1],Ki.HIDE_RESULTS_VALUE=-1;let yR=Ki;class z6 extends ys{}const cE=class cE extends $U{getThumbnailURL(){if(!this.object)return null;const t=this.object.model.getValue(C.FURNITURE_DATA);return t&&t[cE.THUMBNAIL_URL]||null}};cE.THUMBNAIL_URL="THUMBNAIL_URL";let DR=cE;class K6{constructor(t){this._sprite=new Xe(t),this._texture=null,this._amount=-1,this._alpha=0}renderBubble(t){if(!this._sprite||this._amount===t)return null;const e=new hn;e.addChild(this._sprite);const s=new Dj("+"+t,{fontFamily:"Arial",fontSize:9,fill:16777215,align:"center"});return s.anchor.x=.5,s.x=this._sprite.width/2,s.y=19,e.addChild(s),this._texture?ws.instance.renderer.render(e,{renderTexture:this._texture,clear:!0}):this._texture=Ee.generateTexture(e),this._texture}get amount(){return this._amount}set amount(t){this._amount=t}get alpha(){return this._alpha}set alpha(t){this._alpha=t}}class t0 extends RO{constructor(){super(),this._isAllowedToTurnHead=!0}createSizeData(t,e,s){return t>1?new Dl(e,s):new mf(e,s)}defineVisualizations(t){return this._isAllowedToTurnHead=!0,super.defineVisualizations(t)}processVisualElement(t,e,s){if(!t||!e||!s)return!1;switch(e){case"postures":if(!(t instanceof Dl)||!t.processPostures(s))return!1;break;case"gestures":if(!(t instanceof Dl)||!t.processGestures(s))return!1;break;default:if(!super.processVisualElement(t,e,s))return!1;break}return!0}postureToAnimation(t,e){const s=this.getSizeData(t);return s?s.postureToAnimation(e):Dl.DEFAULT}getGestureDisabled(t,e){const s=this.getSizeData(t);return s?s.getGestureDisabled(e):!1}gestureToAnimation(t,e){const s=this.getSizeData(t);return s?s.gestureToAnimation(e):Dl.DEFAULT}animationToPosture(t,e,s){const i=this.getSizeData(t);return i?i.animationToPosture(e,s):null}animationToGesture(t,e){const s=this.getSizeData(t);return s?s.animationToGesture(e):null}getGestureForAnimationId(t,e){const s=this.getSizeData(t);return s?s.getGestureForAnimationId(e):null}totalPostures(t){const e=this.getSizeData(t);return e?e.totalPostures:0}totalGestures(t){const e=this.getSizeData(t);return e?e.totalGestures:0}get isAllowedToTurnHead(){return this._isAllowedToTurnHead}}const Qe=class Qe extends ys{constructor(){for(super(),this._posture="",this._gesture="",this._isSleeping=!1,this._headDirection=-1,this._headOnly=!1,this._nonHeadSprites=[],this._headSprites=[],this._saddleSprites=[],this._animationOver=!1,this._paletteIndex=-1,this._paletteName="",this._customLayerIds=[],this._customPartIds=[],this._customPaletteIds=[],this._isRiding=!1,this._color=16777215,this._experience=0,this._experienceTimestamp=0,this._experienceData=null,this._previousAnimationDirection=-1,this._animationStates=[];this._animationStates.length<Qe.ANIMATION_INDEX_COUNT;)this._animationStates.push(new QU)}initialize(t){if(!(t instanceof t0))return!1;const e=this.getPetAdditionAsset(Qe.PET_EXPERIENCE_BUBBLE);return e&&(this._experienceData=new K6(e)),super.initialize(t)}dispose(){if(super.dispose(),this._animationStates){for(;this._animationStates.length;){const t=this._animationStates[0];t&&t.dispose(),this._animationStates.pop()}this._animationStates=null}}getAnimationId(t){return t.animationId}update(t,e,s,i){super.update(t,e,s,i),this.updateExperienceBubble(e)}updateExperienceBubble(t){if(this._experienceData&&(this._experienceData.alpha=0,this._experienceTimestamp)){const e=t-this._experienceTimestamp;e<Qe.EXPERIENCE_BUBBLE_VISIBLE_IN_MS?this._experienceData.alpha=Math.sin(e/Qe.EXPERIENCE_BUBBLE_VISIBLE_IN_MS*Math.PI)*255:this._experienceTimestamp=0;const s=this.getSprite(this.totalSprites-1);if(s){if(this._experienceData.alpha>0){const i=this._experienceData.renderBubble(this._experience);if(i){s.texture=i,s.offsetX=-20,s.offsetY=-80,s.alpha=this._experienceData.alpha,s.visible=!0,s.relativeDepth=-.2;return}}s.texture=null,s.visible=!1}}}updateModel(t){const e=this.object&&this.object.model;if(!e||this.updateModelCounter===e.updateCounter)return!1;const s=e.getValue(C.FIGURE_POSTURE),i=e.getValue(C.FIGURE_GESTURE);this.setPostureAndGesture(s,i);let n=e.getValue(C.FURNITURE_ALPHA_MULTIPLIER)||null;(n===null||isNaN(n))&&(n=1),this._alphaMultiplier!==n&&(this._alphaMultiplier=n,this._alphaChanged=!0),this._isSleeping=e.getValue(C.FIGURE_SLEEP)>0;const o=e.getValue(C.HEAD_DIRECTION);!isNaN(o)&&this.data.isAllowedToTurnHead?this._headDirection=o:this._headDirection=this.object.getDirection().x,this._experience=e.getValue(C.FIGURE_GAINED_EXPERIENCE),this._experienceTimestamp=e.getValue(C.FIGURE_EXPERIENCE_TIMESTAMP);const l=e.getValue(C.PET_PALETTE_INDEX),c=e.getValue(C.PET_CUSTOM_LAYER_IDS),u=e.getValue(C.PET_CUSTOM_PARTS_IDS),h=e.getValue(C.PET_CUSTOM_PALETTE_IDS),d=e.getValue(C.PET_IS_RIDING),g=e.getValue(C.PET_HEAD_ONLY),E=e.getValue(C.PET_COLOR);return l!==this._paletteIndex&&(this._paletteIndex=l,this._paletteName=this._paletteIndex.toString()),this._customLayerIds=c||[],this._customPartIds=u||[],this._customPaletteIds=h||[],this._isRiding=!isNaN(d)&&d>0,this._headOnly=!isNaN(g)&&g>0,!isNaN(E)&&this._color!==E&&(this._color=E),this.updateModelCounter=e.updateCounter,!0}updateAnimation(t){if(this.object){const e=this.object.getDirection().x;e!==this._previousAnimationDirection&&(this._previousAnimationDirection=e,this.resetAllAnimationFrames())}return super.updateAnimation(t)}setPostureAndGesture(t,e){this.data&&(t!==this._posture&&(this._posture=t,this.setAnimationForIndex(Qe.POSTURE_ANIMATION_INDEX,this.data.postureToAnimation(this._scale,t))),this.data.getGestureDisabled(this._scale,t)&&(e=null),e!==this._gesture&&(this._gesture=e,this.setAnimationForIndex(Qe.GESTURE_ANIMATION_INDEX,this.data.gestureToAnimation(this._scale,e))))}getAnimationStateData(t){return t>=0&&t<this._animationStates.length?this._animationStates[t]:null}setAnimationForIndex(t,e){const s=this.getAnimationStateData(t);s&&this.setSubAnimation(s,e)&&(this._animationOver=!1)}resetAllAnimationFrames(){this._animationOver=!1;let t=this._animationStates.length-1;for(;t>=0;){const e=this._animationStates[t];e&&e.setLayerCount(this.animatedLayerCount),t--}}updateAnimations(t){if(this._animationOver)return 0;let e=!0,s=0,i=0;for(;i<this._animationStates.length;){const n=this._animationStates[i];if(n&&!n.animationOver){const o=this.updateFramesForAnimation(n,t);s=s|o,n.animationOver?(Xs.isTransitionFromAnimation(n.animationId)||Xs.isTransitionToAnimation(n.animationId))&&(this.setAnimationForIndex(i,n.animationAfterTransitionId),e=!1):e=!1}i++}return this._animationOver=e,s}getSpriteAssetName(t,e){if(this._headOnly&&this.isNonHeadSprite(e)||this._isRiding&&this._parser3(e))return null;const s=this.totalSprites;if(e<s-Qe.ADDITIONAL_SPRITE_COUNT){const i=this.getValidSize(t);if(e<s-(1+Qe.ADDITIONAL_SPRITE_COUNT)){if(e>=ya.LAYER_LETTERS.length)return null;const n=ya.LAYER_LETTERS[e];return i===1?this._type+"_icon_"+n:this._type+"_"+i+"_"+n+"_"+this.getDirection(t,e)+"_"+this.getFrameNumber(i,e)}return this._type+"_"+i+"_sd_"+this.getDirection(t,e)+"_0"}return null}getLayerColor(t,e,s){return e<this.totalSprites-Qe.ADDITIONAL_SPRITE_COUNT?this._color:16777215}getLayerXOffset(t,e,s){let i=super.getLayerXOffset(t,e,s),n=this._animationStates.length-1;for(;n>=0;){const o=this._animationStates[n];if(o){const l=o.getFrame(s);l&&(i+=l.x)}n--}return i}getLayerYOffset(t,e,s){let i=super.getLayerYOffset(t,e,s),n=this._animationStates.length-1;for(;n>=0;){const o=this._animationStates[n];if(o){const l=o.getFrame(s);l&&(i+=l.y)}n--}return i}getLayerZOffset(t,e,s){return this.data?this.data.getLayerZOffset(t,this.getDirection(t,s),s):Me.DEFAULT_ZOFFSET}getDirection(t,e){return this.isHeadSprite(e)?this.data.getValidDirection(t,this._headDirection):this._direction}getFrameNumber(t,e){let s=this._animationStates.length-1;for(;s>=0;){const i=this._animationStates[s];if(i){const n=i.getFrame(e);if(n)return n.id}s--}return super.getFrameNumber(t,e)}isHeadSprite(t){if(this._headSprites[t]===void 0){const e=this.data.getLayerTag(this._scale,tl.USE_DEFAULT_DIRECTION,t)===Qe.HEAD,s=this.data.getLayerTag(this._scale,tl.USE_DEFAULT_DIRECTION,t)===Qe.HAIR;e||s?this._headSprites[t]=!0:this._headSprites[t]=!1}return this._headSprites[t]}isNonHeadSprite(t){if(this._nonHeadSprites[t]===void 0)if(t<this.totalSprites-(1+Qe.ADDITIONAL_SPRITE_COUNT)){const e=this.data.getLayerTag(this._scale,tl.USE_DEFAULT_DIRECTION,t);e&&e.length>0&&e!==Qe.HEAD&&e!==Qe.HAIR?this._nonHeadSprites[t]=!0:this._nonHeadSprites[t]=!1}else this._nonHeadSprites[t]=!0;return this._nonHeadSprites[t]}_parser3(t){return this._saddleSprites[t]===void 0&&(this.data.getLayerTag(this._scale,tl.USE_DEFAULT_DIRECTION,t)===Qe.SADDLE?this._saddleSprites[t]=!0:this._saddleSprites[t]=!1),this._saddleSprites[t]}getAsset(t,e=-1){if(!this.asset)return null;const s=this._customLayerIds.indexOf(e);let i=this._paletteName,n=-1,o=-1;return s>-1&&(n=this._customPartIds[s],o=this._customPaletteIds[s],i=o>-1?o.toString():this._paletteName),!isNaN(n)&&n>-1&&(t=t+"_"+n),this.asset.getAssetWithPalette(t,i)}getAdditionalLayerCount(){return super.getAdditionalLayerCount()+Qe.ADDITIONAL_SPRITE_COUNT}setLayerCount(t){super.setLayerCount(t),this._headSprites=[]}getPostureForAsset(t,e){const s=e.split("_");let i=s.length,n=0;for(;n<s.length;){if(s[n]==="64"||s[n]==="32"){i=n+3;break}n++}let o=null;if(i<s.length){let l=s[i];l=l.split("@")[0],o=this.data.animationToPosture(t,parseInt(l)/100,!1),o||(o=this.data.getGestureForAnimationId(t,parseInt(l)/100))}return o}getPetAdditionAsset(t){return Rr().getTexture(t)}get data(){return this._data}};Qe.TYPE=ht.PET_ANIMATED,Qe.HEAD="head",Qe.SADDLE="saddle",Qe.HAIR="hair",Qe.ADDITIONAL_SPRITE_COUNT=1,Qe.EXPERIENCE_BUBBLE_VISIBLE_IN_MS=1e3,Qe.PET_EXPERIENCE_BUBBLE="avatar_addition_pet_experience_bubble",Qe.POSTURE_ANIMATION_INDEX=0,Qe.GESTURE_ANIMATION_INDEX=1,Qe.ANIMATION_INDEX_COUNT=2;let bR=Qe;const uE=class uE{constructor(t,e=-1,s=1,i=-1,n=1){this._normalMinX=e,this._normalMaxX=s,this._normalMinY=i,this._normalMaxY=n,this._asset=t}get asset(){return this._asset}get normalMinX(){return this._normalMinX}get normalMaxX(){return this._normalMaxX}get normalMinY(){return this._normalMinY}get normalMaxY(){return this._normalMaxY}dispose(){this._asset=null}};uE.MIN_NORMAL_COORDINATE_VALUE=-1,uE.MAX_NORMAL_COORDINATE_VALUE=1;let vR=uE;const hE=class hE{constructor(){this._bitmaps=[]}dispose(){for(const t of this._bitmaps)t&&t.dispose();this._bitmaps=null}addBitmap(t,e=-1,s=1,i=-1,n=1){this._bitmaps.push(new vR(t,e,s,i,n))}getAsset(t){if(!t)return null;for(const e of this._bitmaps)if(e&&t.x>=e.normalMinX&&t.x<=e.normalMaxX&&t.y>=e.normalMinY&&t.y<=e.normalMaxY)return e.asset;return null}};hE.MIN_NORMAL_COORDINATE_VALUE=-1,hE.MAX_NORMAL_COORDINATE_VALUE=1;let dc=hE;class X6{constructor(){this._sizes=[],this._maskVisualizations=new Map,this._assetNames=new Map,this._lastMaskVisualization=null,this._lastSize=-1}dispose(){if(this._maskVisualizations){for(const t of this._maskVisualizations.values())t&&t.dispose();this._maskVisualizations=null}this._lastMaskVisualization=null,this._sizes=null}createMaskVisualization(t){if(this._maskVisualizations.get(t))return null;const s=new dc;return this._maskVisualizations.set(t,s),this._sizes.push(t),this._sizes.sort(),s}getSizeIndex(t){let e=0,s=1;for(;s<this._sizes.length;){if(this._sizes[s]>t){this._sizes[s]-t<t-this._sizes[s-1]&&(e=s);break}e=s,s++}return e}getMaskVisualization(t){if(t===this._lastSize)return this._lastMaskVisualization;const e=this.getSizeIndex(t);return e<this._sizes.length?this._lastMaskVisualization=this._maskVisualizations.get(this._sizes[e]):this._lastMaskVisualization=null,this._lastSize=t,this._lastMaskVisualization}getGraphicAsset(t,e){const s=this.getMaskVisualization(t);return s?s.getAsset(e):null}getAssetName(t){return this._assetNames&&this._assetNames.get(t)||null}setAssetName(t,e){this._assetNames&&this._assetNames.set(t,e)}}class q6{constructor(){this._assetCollection=null,this._masks=new Map,this._data=null}get data(){return this._data}dispose(){if(this._assetCollection=null,this._data=null,this._masks&&this._masks.size){for(const t of this._masks.values())t&&t.dispose();this._masks.clear()}}initialize(t){this._data=t}initializeAssetCollection(t){this.data&&(this._assetCollection=t,this.parseMasks(this.data,t))}parseMasks(t,e){if(!(!t||!e)&&t.masks&&t.masks.length){let s=0;for(;s<t.masks.length;){const i=t.masks[s];if(i){const n=i.id;if(this._masks.get(n))continue;const l=new X6;if(i.visualizations&&i.visualizations.length){let c=0;for(;c<i.visualizations.length;){const u=i.visualizations[c];if(u){const h=u.size,d=l.createMaskVisualization(h);if(d){const g=this.parseMaskBitmaps(u.bitmaps,d,e);l.setAssetName(h,g)}}c++}}this._masks.set(n,l)}s++}}}parseMaskBitmaps(t,e,s){if(!t||!t.length)return null;let i=null;for(const n of t){if(!n)continue;const o=n.assetName,l=s.getAsset(o);if(!l)continue;let c=dc.MIN_NORMAL_COORDINATE_VALUE,u=dc.MAX_NORMAL_COORDINATE_VALUE,h=dc.MIN_NORMAL_COORDINATE_VALUE,d=dc.MAX_NORMAL_COORDINATE_VALUE;n.normalMinX!==void 0&&(c=n.normalMinX),n.normalMaxX!==void 0&&(u=n.normalMaxX),n.normalMinY!==void 0&&(h=n.normalMinY),n.normalMaxY!==void 0&&(d=n.normalMaxY),l.flipH||(i=o),e.addBitmap(l,c,u,h,d)}return i}updateMask(t,e,s,i,n,o){const l=this._masks.get(e);if(!l)return!0;const c=l.getGraphicAsset(s,i);if(!c)return!0;const u=c.texture;if(!u)return!0;const h=new wt(n+c.offsetX,o+c.offsetY),d=new sr;let g=1,E=1,m=0,I=0,p=h.x+m,T=h.y+I;return c.flipH&&(g=-1,m=u.width,p=h.x+m-u.width),c.flipV&&(E=-1,I=u.height,T=h.y+I-u.height),d.scale(g,E),d.translate(p,T),ws.instance.renderer.render(new ms(u),{renderTexture:t,clear:!1,transform:d}),!0}getMask(t){return!this._masks||!this._masks.size?null:this._masks.get(t)||null}}class Nh{constructor(t=null,e=0,s=!1){this._assetNames=[],this._maskAssetNames=[],this._maskAssetLocations=[],this._maskAssetFlipHs=[],this._maskAssetFlipVs=[],t!=null&&(this._maskAssetNames=t._maskAssetNames,this._maskAssetLocations=t._maskAssetLocations,this._maskAssetFlipHs=t._maskAssetFlipHs,this._maskAssetFlipVs=t._maskAssetFlipVs),this._color=e,this._alignBottom=s}addMask(t,e,s,i){this._maskAssetNames.push(t),this._maskAssetLocations.push(e),this._maskAssetFlipHs.push(s),this._maskAssetFlipVs.push(i)}addAssetColumn(t){this._assetNames.push(t)}set z(t){this._z=t}get z(){return this._z}set cornerPoints(t){this._points=t}get cornerPoints(){return this._points}get color(){return this._color}get maskAssetNames(){return this._maskAssetNames}get maskAssetLocations(){return this._maskAssetLocations}get maskAssetFlipHs(){return this._maskAssetFlipHs}get maskAssetFlipVs(){return this._maskAssetFlipVs}isBottomAligned(){return this._alignBottom}get assetNameColumns(){return this._assetNames}}class Q6{constructor(t,e,s,i,n){this._x=t,this._y=e,this._speedX=s,this._speedY=i,this._asset=n,isNaN(this._x)&&(this._x=0),isNaN(this._y)&&(this._y=0),isNaN(this._speedX)&&(this._speedX=0),isNaN(this._speedY)&&(this._speedY=0)}get bitmapData(){return this._asset}dispose(){this._asset=null}getPosition(t,e,s,i,n){let o=this._x,l=this._y;s>0&&(o=o+this._speedX/s*n/1e3),i>0&&(l=l+this._speedY/i*n/1e3);const c=Math.trunc(o%1*t),u=Math.trunc(l%1*e);return new wt(c,u)}}const zo=class zo{constructor(t,e,s,i=0){this._material=t,this._offset=i,this._align=s,this._color=e,this._isDisposed=!1}get offset(){return this._offset}get align(){return this._align}get disposed(){return this._isDisposed}dispose(){this._isDisposed=!0,this._material=null,this.clearCache()}clearCache(){}render(t,e,s,i,n,o,l,c,u){const h=this._color>>16,d=this._color>>8&255,g=this._color&255,E=h<255||d<255||g<255;if(this._material){const m=this._material.render(t,e,E?null:s,i,n,o,l,c,u+this.offset,this.align===zo.ALIGN_TOP);if(m&&E){const I=new ms(m);E&&(I.tint=this._color),e.writeToRenderTexture(I,s,!1)}}else{const m=e.createAndFillRenderTexture(i,n,t,this._color);e.writeToRenderTexture(new ms(m),s,!1)}return s}getMaterial(){return this._material}getColor(){return this._color}};zo.DEFAULT_OFFSET=0,zo.ALIGN_TOP=1,zo.ALIGN_BOTTOM=2,zo.ALIGN_DEFAULT=zo.ALIGN_TOP;let fn=zo;class J6{constructor(t,e,s){this._layers=[],this._geometry=s,this._cachedBitmapNormal=new j,this._isCached=!1,this._hasAnimationLayers=!1,e<0&&(e=0);let i=0;for(;i<e;)this._layers.push(null),i++}get geometry(){return this._geometry}get hasAnimationLayers(){return this._hasAnimationLayers}dispose(){if(this._layers&&this._layers.length){for(const t of this._layers)t&&t.dispose();this._layers=null}this._geometry=null,this._cachedBitmapNormal&&(this._cachedBitmapNormal=null)}clearCache(){if(this._isCached){if(this._cachedBitmapNormal&&this._cachedBitmapNormal.assign(new j),this._layers&&this._layers.length)for(const t of this._layers){if(!t)continue;t.clearCache()}this._isCached=!1}}setLayer(t,e,s,i,n=0){if(t<0||t>this._layers.length)return!1;let o=this._layers[t];return o&&o.dispose(),o=new fn(e,s,i,n),this._layers[t]=o,!0}setAnimationLayer(t,e,s){if(t<0||t>this._layers.length)return!1;let i=this._layers[t];return i&&i.dispose(),i=new QC(e,s),this._layers[t]=i,this._hasAnimationLayers=!0,!0}getLayers(){return this._layers}render(t,e,s,i,n,o,l,c=0,u=0,h=0,d=0,g=0,E=0,m=0){i<1&&(i=1),n<1&&(n=1),(!s||s.width!==i||s.height!==n)&&(s=null),this._isCached=!0;const I=e.createAndFillRenderTexture(i,n,t);if(this._cachedBitmapNormal.assign(o),this._layers&&this._layers.length)for(const p of this._layers)p&&(p instanceof fn?p.render(`${t}:${this._layers.indexOf(p)}`,e,I,i,n,o,l,c,u):p instanceof QC&&p.render(e,I,i,n,o,c,u,h,d,g,E,m));return I}}class SO{constructor(){this._planeVisualizations=new Map,this._sizes=[],this._lastPlaneVisualization=null,this._lastSize=-1}isStatic(t){return!0}dispose(){for(const t of this._planeVisualizations.values())t&&t.dispose();this._planeVisualizations=null,this._lastPlaneVisualization=null,this._sizes=null,this._lastSize=-1}clearCache(){for(const t of this._planeVisualizations.values())t&&t.clearCache()}createPlaneVisualization(t,e,s){if(this._planeVisualizations.get(t.toString()))return null;const n=new J6(t,e,s);return this._planeVisualizations.set(t.toString(),n),this._sizes.push(t),this._sizes.sort(),n}getSizeIndex(t){let e=0,s=1;for(;s<this._sizes.length;){if(this._sizes[s]>t){this._sizes[s]-t<t-this._sizes[s-1]&&(e=s);break}e=s,s++}return e}getPlaneVisualization(t){if(t===this._lastSize)return this._lastPlaneVisualization;const e=this.getSizeIndex(t);return e<this._sizes.length?this._lastPlaneVisualization=this._planeVisualizations.get(this._sizes[e].toString()):this._lastPlaneVisualization=null,this._lastSize=t,this._lastPlaneVisualization}getLayers(){return this.getPlaneVisualization(this._lastSize).getLayers()}}const Ed=class Ed extends SO{render(t,e,s,i,n,o,l,c,u,h){const d=this.getPlaneVisualization(o);if(!d||!d.geometry)return null;const g=d.geometry.getScreenPoint(new j(0,0,0)),E=d.geometry.getScreenPoint(new j(0,n/d.geometry.scale,0)),m=d.geometry.getScreenPoint(new j(i/d.geometry.scale,0,0));let I=0,p=0;if(g&&E&&m){i=Math.round(Math.abs(g.x-m.x)),n=Math.round(Math.abs(g.x-E.x));const T=g.x-d.geometry.getScreenPoint(new j(1,0,0)).x;I=u*Math.trunc(Math.abs(T)),p=h*Math.trunc(Math.abs(T))}return d.render(t,e,s,i,n,l,c,I,p)}};Ed.DEFAULT_COLOR=16777215,Ed.HORIZONTAL_ANGLE_DEFAULT=45,Ed.VERTICAL_ANGLE_DEFAULT=30;let $u=Ed;class pf{constructor(t,e){this._texture=t,this._timeStamp=e}dispose(){this._texture=null}get texture(){return this._texture}get timeStamp(){return this._timeStamp}}var Ss;let hh=(Ss=class{constructor(){this._seed=1,this._modulus=16777216,this._multiplier=69069,this._increment=5}static setSeed(t=1){Ss._randomizer||(Ss._randomizer=new Ss),Ss._randomizer.seed=t}static setModulus(t=16777216){Ss._randomizer||(Ss._randomizer=new Ss),Ss._randomizer.modulus=t}static getValues(t,e,s){return Ss._randomizer||(Ss._randomizer=new Ss),Ss._randomizer.getRandomValues(t,e,s)}static getArray(t,e){return Ss._randomizer||(Ss._randomizer=new Ss),Ss._randomizer.getRandomArray(t,e)}set seed(t){this._seed=t}set modulus(t){t<1&&(t=1),this._modulus=t}dispose(){}getRandomValues(t,e,s){const i=[];let n=0;for(;n<t;)i.push(this.iterateScaled(e,s-e)),n++;return i}getRandomArray(t,e){if(t>e||e>1e3)return null;const s=[];let i=0;for(;i<=e;)s.push(i),i++;const n=[];let o=0;for(;o<t;){const l=this.iterateScaled(0,s.length-1);n.push(s[l]),s.splice(l,1),o++}return n}iterate(){let t=r0(Math.trunc(this._multiplier*this._seed)+this._increment);return t<0&&(t=-t),t=t%this._modulus,this._seed=t,t}iterateScaled(t,e){let s=this.iterate();return e<1?t:(s=Math.trunc(t+s/this._modulus*e),s)}},Ss.DEFAULT_SEED=1,Ss.DEFAULT_MODULUS=16777216,Ss._randomizer=null,Ss);const Xi=class Xi{constructor(t,e,s=1){if(this._cells=[],this._repeatMode=s,this._width=t<1?1:t,this._cachedBitmapData=null,this._cachedBitmapNormal=null,this._cachedBitmapDataOffsetX=0,this._cachedBitmapDataOffsetY=0,this._isCached=!1,this._isStatic=!0,e&&e.length){let i=0;for(;i<e.length;){const n=e[i];n&&(this._cells.push(n),n.isStatic||(this._isStatic=!1)),i++}}}get isStatic(){return this._isStatic}isRepeated(){return this._repeatMode!==Xi.REPEAT_MODE_NONE}get width(){return this._width}dispose(){if(this._cells&&this._cells.length){for(const t of this._cells)t&&t.dispose();this._cells=null}this._cachedBitmapData=null,this._cachedBitmapNormal&&(this._cachedBitmapNormal=null)}clearCache(){if(this._isCached){if(this._cachedBitmapData&&(this._cachedBitmapData=null),this._cachedBitmapNormal&&(this._cachedBitmapNormal.x=0,this._cachedBitmapNormal.y=0,this._cachedBitmapNormal.z=0),this._cells&&this._cells.length)for(const t of this._cells)t&&t.clearCache();this._isCached=!1}}render(t,e,s,i,n,o){if(this._repeatMode===Xi.REPEAT_MODE_NONE&&(s=this.getCellsHeight(this._cells,i)),this._cachedBitmapNormal||(this._cachedBitmapNormal=new j),this.isStatic){if(this._cachedBitmapData){if(this._cachedBitmapData.height===s&&j.isEqual(this._cachedBitmapNormal,i)&&this._cachedBitmapDataOffsetX===n&&this._cachedBitmapDataOffsetY===o)return this._cachedBitmapData;this._cachedBitmapData=null}}else this._cachedBitmapData=null;if(this._isCached=!0,this._cachedBitmapData||(this._cachedBitmapData=e.createRenderTexture(this._width,s,`${t}:column`)),this._cachedBitmapNormal.assign(i),this._cachedBitmapDataOffsetX=n,this._cachedBitmapDataOffsetY=o,!this._cells.length)return this._cachedBitmapData;switch(this._repeatMode){case Xi.REPEAT_MODE_NONE:this.renderRepeatNone(i);break;case Xi.REPEAT_MODE_BORDERS:this.renderRepeatBorders(i);break;case Xi.REPEAT_MODE_CENTER:this.renderRepeatCenter(i);break;case Xi.REPEAT_MODE_FIRST:this.renderRepeatFirst(i);break;case Xi.REPEAT_MODE_LAST:this.renderRepeatLast(i);break;default:this.renderRepeatAll(i,n,o);break}return this._cachedBitmapData}getCellsHeight(t,e){if(!t||!t.length)return 0;let s=0,i=0;for(;i<t.length;){const n=t[i];n&&(s+=n.getHeight(e)),i++}return s}renderCells(t,e,s,i,n=0,o=0){if(!t||!t.length||!this._cachedBitmapData)return e;let l=0;for(;l<t.length;){let c=null;if(s?c=t[l]:c=t[t.length-1-l],c){const u=c.render(i,n,o);if(u&&(s||(e-=u.height),u.y=e,Ee.writeToRenderTexture(u,this._cachedBitmapData,!1),s&&(e=e+u.height),s&&e>=this._cachedBitmapData.height||!s&&e<=0))return e}l++}return e}renderRepeatNone(t){!this._cells.length||!this._cachedBitmapData||this.renderCells(this._cells,0,!0,t)}renderRepeatAll(t,e,s){if(!this._cells.length||!this._cachedBitmapData)return;let i=0;for(;i<this._cachedBitmapData.height;)if(i=this.renderCells(this._cells,i,!0,t,e,s),!i)return}renderRepeatBorders(t){if(!this._cells.length||!this._cachedBitmapData)return;const e=[];let s=0,i=1;for(;i<this._cells.length-1;){const c=this._cells[i];if(c){const u=c.getHeight(t);u>0&&(s=s+u,e.push(c))}i++}if(this._cells.length==1){const c=this._cells[0];if(c){const u=c.getHeight(t);u>0&&(s=s+u,e.push(c))}}let n=this._cachedBitmapData.height-s>>1,o=this.renderCells(e,n,!0,t),l=this._cells[0];if(l){const c=[l];for(;n>=0;)n=this.renderCells(c,n,!1,t)}if(l=this._cells[this._cells.length-1],l){const c=[l];for(;o<this._cachedBitmapData.height;)o=this.renderCells(c,o,!0,t)}}renderRepeatCenter(t){if(!this._cells.length||!this._cachedBitmapData)return;const e=[],s=[];let i=0,n=0,o=0;for(;o<this._cells.length>>1;){const u=this._cells[o];if(u){const h=u.getHeight(t);h>0&&(i=i+h,e.push(u))}o++}for(o=(this._cells.length>>1)+1;o<this._cells.length;){const u=this._cells[o];if(u){const h=u.getHeight(t);h>0&&(n=n+h,s.push(u))}o++}let l=0,c=this._cachedBitmapData.height;if(i+n>this._cachedBitmapData.height&&(l=i+n-this._cachedBitmapData.height,c=c+(l-(l>>1))),l==0){const u=this._cells[this._cells.length>>1];if(u){const h=u.getHeight(t);if(h>0){const d=this._cachedBitmapData.height-(i+n),g=Math.ceil(d/h)*h;let E=i-(g-d>>1);const m=E+g,I=[u];for(;E<m;)E=this.renderCells(I,E,!0,t)}}}this.renderCells(e,0,!0,t),this.renderCells(s,c,!1,t)}renderRepeatFirst(t){if(!this._cells.length||!this._cachedBitmapData)return;let e=this.renderCells(this._cells,this._cachedBitmapData.height,!1,t);const s=this._cells[0];if(!s)return;const i=[s];for(;e>=0;)e=this.renderCells(i,e,!1,t)}renderRepeatLast(t){if(!this._cells.length||!this._cachedBitmapData)return;let e=this.renderCells(this._cells,0,!0,t);const s=this._cells[this._cells.length-1];if(!s)return;const i=[s];for(;e<this._cachedBitmapData.height;)e=this.renderCells(i,e,!0,t)}getCells(){return this._cells}};Xi.REPEAT_MODE_NONE=0,Xi.REPEAT_MODE_ALL=1,Xi.REPEAT_MODE_BORDERS=2,Xi.REPEAT_MODE_CENTER=3,Xi.REPEAT_MODE_FIRST=4,Xi.REPEAT_MODE_LAST=5;let pa=Xi;const Je=class Je{constructor(t,e=1,s=1,i=-1,n=1,o=-1,l=1){this._repeatMode=1,this._align=1,this._cachedBitmapNormal=null,this._cachedBitmapHeight=0,this._isCached=!1,this._isStatic=!0,this._normalMinX=-1,this._normalMaxX=1,this._normalMinY=-1,this._normalMaxY=1,this._columns=[],t<1&&(t=1);let c=0;for(;c<t;)this._columns.push(null),c++;this._repeatMode=e,this._align=s,this._normalMinX=i,this._normalMaxX=n,this._normalMinY=o,this._normalMaxY=l,this._repeatMode===Je.REPEAT_MODE_RANDOM&&(this._isStatic=!1)}static nextRandomColumnIndex(t){return hh.getValues(1,0,t*17631)[0]%t}get normalMinX(){return this._normalMinX}get normalMaxX(){return this._normalMaxX}get normalMinY(){return this._normalMinY}get normalMaxY(){return this._normalMaxY}isBottomAligned(){return this._align===Je.ALIGN_BOTTOM}get isStatic(){return this._isStatic}dispose(){this._cachedBitmapNormal&&(this._cachedBitmapNormal=null)}clearCache(){if(this._isCached){if(this._cachedBitmapNormal&&(this._cachedBitmapNormal.x=0,this._cachedBitmapNormal.y=0,this._cachedBitmapNormal.z=0),this._columns&&this._columns.length)for(const t of this._columns)t&&t.clearCache();this._isCached=!1}}createColumn(t,e,s,i=1){if(t<0||t>=this._columns.length)return!1;const n=new pa(e,s,i),o=this._columns[t];return o&&o.dispose(),this._columns[t]=n,n&&!n.isStatic&&(this._isStatic=!1),!0}render(t,e,s,i,n,o,l,c,u,h){if(i<1&&(i=1),n<1&&(n=1),this._cachedBitmapNormal||(this._cachedBitmapNormal=new j),this.isStatic){if(this._cachedBitmapData){if(this._cachedBitmapData.baseTexture&&this._cachedBitmapData.width===i&&this._cachedBitmapData.height===n&&j.isEqual(this._cachedBitmapNormal,o))return s?(this.copyCachedBitmapOnCanvas(s,this._cachedBitmapHeight,u,h),s):this._cachedBitmapData;this._cachedBitmapData=null}}else this._cachedBitmapData=null;if(this._isCached=!0,this._cachedBitmapNormal.assign(o),!l)return this._cachedBitmapHeight=n,this._cachedBitmapData?e.clearAndFillRenderTexture(this._cachedBitmapData):this._cachedBitmapData=e.createAndFillRenderTexture(i,n,`${t}:matrix`),this._cachedBitmapData;this._cachedBitmapData||(this._cachedBitmapHeight=n,this._cachedBitmapData=e.createRenderTexture(i,n,`${t}:matrix`),e.clearRenderTexture(this._cachedBitmapData));const d=[];let g=0;for(;g<this._columns.length;){const m=this._columns[g];if(m){const I=m.render(t,e,n,o,c,u);I&&d.push(I)}g++}if(!d.length)return s||this._cachedBitmapData;let E=0;switch(this._repeatMode){case Je.REPEAT_MODE_BORDERS:dt.log("REPEAT_MODE_BORDERS");break;case Je.REPEAT_MODE_CENTER:dt.log("REPEAT_MODE_CENTER");break;case Je.REPEAT_MODE_FIRST:dt.log("REPEAT_MODE_FIRST");break;case Je.REPEAT_MODE_LAST:dt.log("REPEAT_MODE_LAST");break;case Je.REPEAT_MODE_RANDOM:E=this.renderRepeatRandom(this._cachedBitmapData,d);break;default:E=this.renderRepeatAll(this._cachedBitmapData,d);break}return this._cachedBitmapHeight=E,s?(this.copyCachedBitmapOnCanvas(s,E,u,h),s):this._cachedBitmapData}copyCachedBitmapOnCanvas(t,e,s,i){if(!t||!this._cachedBitmapData||t===this._cachedBitmapData)return;i||(s=t.height-e-s);let n=null;this._align===Je.ALIGN_TOP?n=new Or(0,0,this._cachedBitmapData.width,this._cachedBitmapHeight):n=new Or(0,this._cachedBitmapData.height-this._cachedBitmapHeight,this._cachedBitmapData.width,this._cachedBitmapHeight);const o=new kn(this._cachedBitmapData.baseTexture,n),l=new ms(o);l.position.set(0,s),Ee.writeToRenderTexture(l,t,!1)}getColumnsWidth(t){if(!t||!t.length)return 0;let e=0;for(const s of t)s&&(e+=s.width);return e}renderColumns(t,e,s,i){if(!t||!e||!e.length)return new wt(s,0);let n=0,o=0;for(;o<e.length;){const l=i?e[o]:e[e.length-1-o];if(l){i||(s=s-l.width);let c=0;this._align==Je.ALIGN_BOTTOM&&(c=t.height-l.height);const u=new ms(l);if(u.position.set(s,c),Ee.writeToRenderTexture(u,t,!1),l.height>n&&(n=l.height),i&&(s=s+l.width),i&&s>=t.width||!i&&s<=0)return new wt(s,n)}o++}return new wt(s,n)}renderRepeatAll(t,e){if(!t||!e||!e.length)return 0;this.getColumnsWidth(e);let s=0,i=0;for(;s<t.width;){const n=this.renderColumns(t,e,s,!0);if(s=n.x,n.y>i&&(i=n.y),!n.x)return i}return i}renderRepeatRandom(t,e){if(!t||!e||!e.length)return 0;let s=0,i=0;for(;i<t.width;){const n=e[Je.nextRandomColumnIndex(e.length)];if(n!=null){const o=this.renderColumns(t,[n],i,!0);i=o.x,o.y>s&&(s=o.y)}else return s}return s}getColumns(t){if(this._repeatMode===Je.REPEAT_MODE_RANDOM){const e=[];let s=0;for(;s<t;){const i=this._columns[Je.nextRandomColumnIndex(this._columns.length)];if(i)if(e.push(i),i.width>1)s+=i.width;else break;else break}return e}return this._columns}};Je.REPEAT_MODE_ALL=1,Je.REPEAT_MODE_BORDERS=2,Je.REPEAT_MODE_CENTER=3,Je.REPEAT_MODE_FIRST=4,Je.REPEAT_MODE_LAST=5,Je.REPEAT_MODE_RANDOM=6,Je.REPEAT_MODE_DEFAULT=Je.REPEAT_MODE_ALL,Je.MIN_NORMAL_COORDINATE_VALUE=-1,Je.MAX_NORMAL_COORDINATE_VALUE=1,Je.ALIGN_TOP=1,Je.ALIGN_BOTTOM=2,Je.ALIGN_DEFAULT=Je.ALIGN_TOP;let ui=Je;const dE=class dE{constructor(){this._planeMaterialItems=[],this._isCached=!1}dispose(){if(this._planeMaterialItems&&this._planeMaterialItems.length){for(const t of this._planeMaterialItems)t&&t.dispose();this._planeMaterialItems=null}this._isCached=!1}clearCache(){if(this._isCached){if(this._planeMaterialItems&&this._planeMaterialItems.length)for(const t of this._planeMaterialItems)t&&t.clearCache();this._isCached=!1}}addMaterialCellMatrix(t,e,s,i=-1,n=1,o=-1,l=1){const c=new ui(t,e,s,i,n,o,l);return this._planeMaterialItems.push(c),c}getMaterialCellMatrix(t){if(!t)return null;if(this._planeMaterialItems&&this._planeMaterialItems.length){for(const e of this._planeMaterialItems)if(e&&t.x>=e.normalMinX&&t.x<=e.normalMaxX&&t.y>=e.normalMinY&&t.y<=e.normalMaxY)return e}return null}render(t,e,s,i,n,o,l,c,u,h){i<1&&(i=1),n<1&&(n=1);const d=this.getMaterialCellMatrix(o);return d?(this._isCached=!0,d.render(t,e,s,i,n,o,l,c,u,h)):null}};dE.MIN_NORMAL_COORDINATE_VALUE=-1,dE.MAX_NORMAL_COORDINATE_VALUE=1;let LR=dE;class $6{constructor(t,e=null,s=null,i=0){if(this._extraItemCount=0,this._texture=t,this._extraItemOffsets=[],this._extraItemAssets=[],this._extraItemCount=0,e&&e.length&&i>0){let n=0;for(;n<e.length;){const o=e[n];o&&this._extraItemAssets.push(o),n++}if(this._extraItemAssets.length){if(s){let o=0;for(;o<s.length;){const l=s[o];l&&this._extraItemOffsets.push(new wt(l.x,l.y)),o++}}this._extraItemCount=i}}}get isStatic(){return this._extraItemCount===0}dispose(){this._texture&&(this._texture.dispose(),this._texture=null),this._extraItemAssets=null,this._extraItemOffsets=null,this._extraItemCount=0}clearCache(){}getHeight(t){if(this._texture){const e=this._texture.getBitmap(t);if(e)return e.height}return 0}render(t,e,s){if(!this._texture)return null;const i=this._texture.getBitmap(t);if(!i)return null;const n=new bj(i,i.width,i.height);if(e!==0||s!==0){for(;e<0;)e+=i.width;for(;s<0;)s+=i.height;n.tilePosition.set(e%i.width,s%i.height),n.uvRespectAnchor=!0,e&&(n.anchor.x=1,n.scale.x=-1),s&&(n.anchor.y=1,n.scale.y=-1)}if(!this.isStatic){const o=Math.min(this._extraItemCount,this._extraItemOffsets.length),l=Math.max(this._extraItemCount,this._extraItemOffsets.length),c=hh.getArray(this._extraItemCount,l);let u=0;for(;u<o;){const h=this._extraItemOffsets[c[u]],d=this._extraItemAssets[u%this._extraItemAssets.length];if(h&&d){const g=d.texture;if(g){let E=d.offsetX,m=d.offsetY,I=1,p=1,T=0,R=0;d.flipH&&(I=-1,T=g.width,E=-(d.width+d.x)),d.flipV&&(p=-1,R=g.height,m=-(d.height+d.y));const S=new wt(h.x+E,h.y+m),b=new sr;let N=S.x+T;N=N>>1<<1,b.scale(I,p),b.translate(N,S.y+R);const P=new ms(g);P.transform.setFromMatrix(b),n.addChild(P)}}u++}}return n}getAssetName(t){return this._texture==null?null:this._texture.getAssetName(t)}}const _E=class _E{constructor(t,e=-1,s=1,i=-1,n=1,o=null){this._bitmap=t,this._normalMinX=e,this._normalMaxX=s,this._normalMinY=i,this._normalMaxY=n,this._assetName=o}get bitmap(){return this._bitmap}get normalMinX(){return this._normalMinX}get normalMaxX(){return this._normalMaxX}get normalMinY(){return this._normalMinY}get normalMaxY(){return this._normalMaxY}get assetName(){return this._assetName}dispose(){this._bitmap=null}};_E.MIN_NORMAL_COORDINATE_VALUE=-1,_E.MAX_NORMAL_COORDINATE_VALUE=1;let PR=_E;const gE=class gE{constructor(){this._bitmaps=[]}dispose(){if(this._bitmaps){for(const t of this._bitmaps)t&&t.dispose();this._bitmaps=null}}addBitmap(t,e=-1,s=1,i=-1,n=1,o=null){this._bitmaps.push(new PR(t,e,s,i,n,o))}getBitmap(t){const e=this.getPlaneTextureBitmap(t);return e?e.bitmap:null}getPlaneTextureBitmap(t){if(!t)return null;for(const e of this._bitmaps)if(e&&t.x>=e.normalMinX&&t.x<=e.normalMaxX&&t.y>=e.normalMinY&&t.y<=e.normalMaxY)return e;return null}getAssetName(t){const e=this.getPlaneTextureBitmap(t);return e?e.assetName:null}};gE.MIN_NORMAL_COORDINATE_VALUE=-1,gE.MAX_NORMAL_COORDINATE_VALUE=1;let bl=gE;const fE=class fE{constructor(){this._assetCollection=null,this._textures=new Map,this._materials=new Map,this._planes=new Map,this._geometries=new Map,this._data=null}get data(){return this._data}get assetCollection(){return this._assetCollection}initializeDimensions(t,e){return!0}dispose(){if(this._planes){for(const t of this._planes.values())t&&t.dispose();this._planes=null}if(this._materials&&(this.resetMaterials(),this._materials=null),this._textures&&(this.resetTextures(),this._textures=null),this._geometries){for(const t of this._geometries.values())t&&t.dispose();this._geometries=null}this._data=null,this._assetCollection=null}clearCache(){for(const t of this._planes.values())t&&t.clearCache();for(const t of this._materials.values())t&&t.clearCache()}initialize(t){this._data=t}reinitialize(){this.resetTextures(),this.resetMaterials(),this.initializeAll()}resetMaterials(){for(const t of this._materials.values())t&&t.dispose();this._materials.clear()}resetTextures(){for(const t of this._textures.values())t&&t.dispose();this._textures.clear()}getTexture(t){return this._textures.get(t)}getMaterial(t){return this._materials.get(t)}getPlane(t){return this._planes.get(t)}addPlane(t,e){return e?this._planes.get(t)?!1:(this._planes.set(t,e),!0):!1}initializeAssetCollection(t){this._data&&(this._assetCollection=t,this.initializeAll())}initializeAll(){this._data&&(this.initializeTexturesAndMaterials(),this.initializePlanes())}initializeTexturesAndMaterials(){this._data.textures&&this._data.textures.length&&this.parseTextures(this._data.textures,this.assetCollection),this._data.materials&&this._data.materials.length&&this.parsePlaneMaterials(this._data.materials)}initializePlanes(){}parseTextures(t,e){if(!(!t||!e)&&t.length)for(const s of t){if(!s)continue;const i=s.id;if(!this._textures.get(i)){const n=new bl;if(s.bitmaps&&s.bitmaps.length)for(const o of s.bitmaps){if(!o)continue;const l=o.assetName;let c=bl.MIN_NORMAL_COORDINATE_VALUE,u=bl.MAX_NORMAL_COORDINATE_VALUE,h=bl.MIN_NORMAL_COORDINATE_VALUE,d=bl.MAX_NORMAL_COORDINATE_VALUE;o.normalMinX!==void 0&&(c=o.normalMinX),o.normalMaxX!==void 0&&(u=o.normalMaxX),o.normalMinY!==void 0&&(h=o.normalMinY),o.normalMaxY!==void 0&&(d=o.normalMaxY);const g=e.getAsset(l);if(g){const E=g.texture;if(E){let m=E;g.flipH?m=Jw.getFlipHBitmapData(E):m=m.clone(),n.addBitmap(m,c,u,h,d,l)}}}this._textures.set(i,n)}}}parsePlaneMaterials(t){if(!(!t||!t.length))for(const e of t){if(!e)continue;const s=e.id,i=new LR;if(e.matrices&&e.matrices.length)for(const n of e.matrices){if(!n)continue;let o=ui.REPEAT_MODE_DEFAULT,l=ui.ALIGN_DEFAULT,c=ui.MIN_NORMAL_COORDINATE_VALUE,u=ui.MAX_NORMAL_COORDINATE_VALUE,h=ui.MIN_NORMAL_COORDINATE_VALUE,d=ui.MAX_NORMAL_COORDINATE_VALUE;switch(n.normalMinX!==void 0&&(c=n.normalMinX),n.normalMaxX!==void 0&&(u=n.normalMaxX),n.normalMinY!==void 0&&(h=n.normalMinY),n.normalMaxY!==void 0&&(d=n.normalMaxY),n.repeatMode){case"borders":o=ui.REPEAT_MODE_BORDERS;break;case"center":o=ui.REPEAT_MODE_CENTER;break;case"first":o=ui.REPEAT_MODE_FIRST;break;case"last":o=ui.REPEAT_MODE_LAST;break;case"random":o=ui.REPEAT_MODE_RANDOM;break;default:o=ui.REPEAT_MODE_DEFAULT;break}switch(n.align){case"top":l=ui.ALIGN_TOP;break;case"bottom":l=ui.ALIGN_BOTTOM;break;default:l=ui.ALIGN_DEFAULT;break}if(n.columns&&n.columns.length){const g=i.addMaterialCellMatrix(n.columns.length,o,l,c,u,h,d);let E=0;for(;E<n.columns.length;){const m=n.columns[E];m&&this.parsePlaneMaterialCellColumn(m,g,E),E++}}}this._materials.set(s,i)}}parsePlaneMaterialCellColumn(t,e,s){if(!t||!e)return;let i=pa.REPEAT_MODE_ALL;const n=t.width,o=this.parsePlaneMaterialCells(t);switch(t.repeatMode){case"borders":i=pa.REPEAT_MODE_BORDERS;break;case"center":i=pa.REPEAT_MODE_CENTER;break;case"first":i=pa.REPEAT_MODE_FIRST;break;case"last":i=pa.REPEAT_MODE_LAST;break;case"none":i=pa.REPEAT_MODE_NONE;break;default:i=pa.REPEAT_MODE_ALL;break}e.createColumn(s,n,o,i)}parsePlaneMaterialCells(t){if(!t||!t.cells||!t.cells.length)return null;const e=[];let s=0;for(;s<t.cells.length;){const i=t.cells[s];if(i){const n=i.textureId;let o=null,l=null,c=null,u=0;if(i.extraData){const g=i.extraData.extraItemTypes,E=i.extraData.offsets;g&&E&&g.length&&E.length&&(o=this.parseExtraItemTypes(g),l=this.parseExtraItemOffsets(E),u=l.length,i.extraData.limitMax!==void 0&&(u=i.extraData.limitMax))}if(o&&o.length){c=[];for(const g of o){if(!g)continue;const E=this._assetCollection.getAsset(g);E&&c.push(E)}}const h=this.getTexture(n),d=new $6(h,c,l,u);e.push(d)}s++}return!e||!e.length?null:e}parseExtraItemTypes(t){const e=[];if(t&&t.length){let s=0;for(;s<t.length;){const i=t[s];i&&e.push(i),s++}}return e}parseExtraItemOffsets(t){const e=[];if(t&&t.length){let s=0;for(;s<t.length;){const[i,n]=t[s];e.push(new wt(i,n)),s++}}return e}getGeometry(t,e,s){e=Math.abs(e),e>90&&(e=90),s=Math.abs(s),s>90&&(s=90);const i=`${t}_${Math.round(e)}_${Math.round(s)}`;let n=this._geometries.get(i);return n||(n=new dl(t,new j(e,s),new j(-10,0,0)),this._geometries.set(i,n),n)}parseVisualizations(t,e){if(!(!t||!e)&&e&&e.length)for(const s of e){if(!s)continue;const i=s.size;let n=$u.HORIZONTAL_ANGLE_DEFAULT,o=$u.VERTICAL_ANGLE_DEFAULT;s.horizontalAngle!==void 0&&(n=s.horizontalAngle),s.verticalAngle!==void 0&&(o=s.verticalAngle);const l=s.allLayers,c=t.createPlaneVisualization(i,l&&l.length||0,this.getGeometry(i,n,o));if(c&&l&&l.length){let u=0;for(;u<l.length;){const h=l[u];if(h){let d=null,g=fn.ALIGN_DEFAULT,E=$u.DEFAULT_COLOR,m=fn.DEFAULT_OFFSET;h.materialId&&(d=this.getMaterial(h.materialId)),h.color&&(E=h.color),h.offset&&(m=h.offset),h.align&&(h.align==="bottom"?g=fn.ALIGN_BOTTOM:h.align=="top"&&(g=fn.ALIGN_TOP)),c.setLayer(u,d,E,g,m)}u++}}}}render(t,e,s,i,n,o,l,c,u,h=0,d=0,g=0,E=0,m=0){return null}getTextureIdentifier(t,e){return t.toString()}getLayers(t){let e=this.getPlane(t);return e||(e=this.getPlane(fE.DEFAULT)),e.getLayers()}};fE.DEFAULT="default";let Dc=fE;class Z6 extends Dc{initializePlanes(){if(!this.data)return;const t=this.data.planes;t&&t.length&&this.parseFloors(t)}parseFloors(t){if(t)for(const e in t){const s=t[e];if(!s)continue;const i=s.id,n=s.visualizations,o=new $u;this.parseVisualizations(o,n),this.addPlane(i,o)||o.dispose()}}render(t,e,s,i,n,o,l,c,u,h=0,d=0,g=0,E=0,m=0){let I=this.getPlane(i);if(I||(I=this.getPlane(Dc.DEFAULT)),!I)return null;s&&e.clearAndFillRenderTexture(s);let p=I.render(t,e,s,n,o,l,c,u,h,d);return p&&p!==s&&(p=new kn(p.baseTexture),!p)?null:new pf(p,-1)}}const pd=class pd extends SO{render(t,e,s,i,n,o,l,c){const u=this.getPlaneVisualization(o);if(!u||!u.geometry)return null;const h=u.geometry.getScreenPoint(new j(0,0,0)),d=u.geometry.getScreenPoint(new j(0,0,n/u.geometry.scale)),g=u.geometry.getScreenPoint(new j(0,i/u.geometry.scale,0));return h&&d&&g&&(i=Math.round(Math.abs(h.x-g.x)),n=Math.round(Math.abs(h.y-d.y))),u.render(t,e,s,i,n,l,c)}};pd.DEFAULT_COLOR=16777215,pd.HORIZONTAL_ANGLE_DEFAULT=45,pd.VERTICAL_ANGLE_DEFAULT=30;let UR=pd;class tq extends Dc{initializePlanes(){if(!this.data)return;const t=this.data.planes;t&&t.length&&this.parseWalls(t)}parseWalls(t){if(t)for(const e in t){const s=t[e];if(!s)continue;const i=s.id,n=s.visualizations,o=new UR;this.parseVisualizations(o,n),this.addPlane(i,o)||o.dispose()}}render(t,e,s,i,n,o,l,c,u,h=0,d=0,g=0,E=0,m=0){let I=this.getPlane(i);if(I||(I=this.getPlane(Dc.DEFAULT)),!I)return null;s&&e.clearAndFillRenderTexture(s);let p=I.render(t,e,s,n,o,l,c,u);return p&&p!==s&&(p=new kn(p.baseTexture),!p)?null:new pf(p,-1)}getTextureIdentifier(t,e){return e?`${t}_${e.x}_${e.y}_${e.z}`:super.getTextureIdentifier(t,e)}}const Id=class Id extends SO{constructor(){super(...arguments),this._width=0,this._height=0}isStatic(t){const e=this.getPlaneVisualization(t);return e?!e.hasAnimationLayers:super.isStatic(t)}initializeDimensions(t,e){t<0&&(t=0),e<0&&(e=0),(t!==this._width||e!==this._height)&&(this._width=t,this._height=e)}render(t,e,s,i,n,o,l,c,u,h,d,g,E){const m=this.getPlaneVisualization(o);if(!m||!m.geometry)return null;const I=m.geometry.getScreenPoint(new j(0,0,0)),p=m.geometry.getScreenPoint(new j(0,0,1)),T=m.geometry.getScreenPoint(new j(0,1,0));if(I&&p&&T){i=Math.round(Math.abs((I.x-T.x)*i/m.geometry.scale)),n=Math.round(Math.abs((I.y-p.y)*n/m.geometry.scale));const R=Math.trunc(u*Math.abs(I.x-T.x)),S=Math.trunc(h*Math.abs(I.y-p.y)),b=Math.trunc(d*Math.abs(I.x-T.x)),N=Math.trunc(g*Math.abs(I.y-p.y));return m.render(t,e,s,i,n,l,c,R,S,b,N,d,g,E)}return null}};Id.DEFAULT_COLOR=16777215,Id.HORIZONTAL_ANGLE_DEFAULT=45,Id.VERTICAL_ANGLE_DEFAULT=30;let eu=Id;const ua=class ua extends Dc{constructor(){super(...arguments),this._landscapeWidth=0,this._landscapeHeight=0,this._cachedBitmap=null}initializeDimensions(t,e){return t<0&&(t=0),e<0&&(e=0),this._landscapeWidth=t,this._landscapeHeight=e,!0}initializePlanes(){if(!this.data)return;const t=this.data.planes;t&&t.length&&this.parseLandscapes(t)}parseLandscapes(t){if(!t)return;const e=Math.trunc(Math.random()*654321);for(const s in t){const i=t[s];if(!i)continue;const n=i.id,o=i.animatedVisualization,l=new eu;for(const c of o){if(!c)continue;const u=c.size;let h=eu.HORIZONTAL_ANGLE_DEFAULT,d=eu.VERTICAL_ANGLE_DEFAULT;c.horizontalAngle!==void 0&&(h=c.horizontalAngle),c.verticalAngle!==void 0&&(d=c.verticalAngle);const g=c.allLayers.length??0,E=l.createPlaneVisualization(u,g||0,this.getGeometry(u,h,d));if(E){hh.setSeed(e);let m=0;for(;m<g;){const I=c.allLayers[m];if(I){if(I.items===void 0){const p=I;let T=null,R=fn.ALIGN_DEFAULT,S=eu.DEFAULT_COLOR,b=fn.DEFAULT_OFFSET;p.materialId&&(T=this.getMaterial(p.materialId)),p.color&&(S=p.color),p.offset&&(b=p.offset),p.align&&(p.align==="bottom"?R=fn.ALIGN_BOTTOM:p.align==="top"&&(R=fn.ALIGN_TOP)),E.setLayer(m,T,S,R,b)}else{const T=I.items,R=[];if(T&&T.length){for(const S of T)if(S){S.id;const b=S.assetId,N=this.getCoordinateValue(S.x||"",S.randomX||""),P=this.getCoordinateValue(S.y||"",S.randomY||""),B=S.speedX,F=S.speedY;R.push({asset:b,x:N,y:P,speedX:B,speedY:F})}}E.setAnimationLayer(m,R,this.assetCollection)}m++}}}}this.addPlane(n,l)||l.dispose()}}getCoordinateValue(t,e){let s=0;if(t.length>0&&t.charAt(t.length-1)==="%"&&(t=t.substr(0,t.length-1),s=parseFloat(t)/100),e.length>0){const o=hh.getValues(1,0,1e4)[0]/1e4;e.charAt(e.length-1)==="%"&&(e=e.substr(0,e.length-1),s=s+o*parseFloat(e)/100)}return s}render(t,e,s,i,n,o,l,c,u,h=0,d=0,g=0,E=0,m=0){let I=this.getPlane(i);if(I||(I=this.getPlane(ua.DEFAULT)),!I)return null;s&&e.clearRenderTexture(s);let p=I.render(t,e,s,n,o,l,c,u,h,d,g,E,m);if(p&&p!==s&&(p=new kn(p.baseTexture),!p))return null;let T=null;return!I.isStatic(l)&&ua.UPDATE_INTERVAL>0?T=new pf(p,Math.round(m/ua.UPDATE_INTERVAL)*ua.UPDATE_INTERVAL+ua.UPDATE_INTERVAL):T=new pf(p,-1),T}getTextureIdentifier(t,e){return e?e.x<0?t+"_0":t+"_1":super.getTextureIdentifier(t,e)}};ua.LANDSCAPES_ENABLED=!0,ua.LANDSCAPE_DEFAULT_COLOR=8828617,ua.UPDATE_INTERVAL=500;let If=ua;class QC{constructor(t,e){if(this._color=0,this._isDisposed=!1,this._color=0,this._isDisposed=!1,this._items=[],t&&e)for(const s of t){if(!s)continue;const i=s.asset;if(i){const n=e.getAsset(i);n&&this._items.push(new Q6(s.x,s.y,s.speedX,s.speedY,n))}}}get disposed(){return this._isDisposed}dispose(){if(this._isDisposed=!0,this._items){for(const t of this._items)t&&t.dispose();this._items=[]}}clearCache(){}render(t,e,s,i,n,o,l,c,u,h,d,g){if(c>0&&u>0){let E=0;for(;E<this._items.length;){const m=this._items[E];if(m){const I=m.getPosition(c,u,h,d,g);if(I.x=Math.trunc(I.x-o),I.y=Math.trunc(I.y-l),m.bitmapData){if(I.x>-m.bitmapData.width&&I.x<e.width&&I.y>-m.bitmapData.height&&I.y<e.height){const p=new ms(m.bitmapData.texture);p.position.set(I.x,I.y),t.writeToRenderTexture(p,e,!1)}if(I.x-c>-m.bitmapData.width&&I.x-c<e.width&&I.y>-m.bitmapData.height&&I.y<e.height){const p=new ms(m.bitmapData.texture);p.position.set(I.x-c,I.y),t.writeToRenderTexture(p,e,!1)}if(I.x>-m.bitmapData.width&&I.x<e.width&&I.y-u>-m.bitmapData.height&&I.y-u<e.height){const p=new ms(m.bitmapData.texture);p.position.set(I.x,I.y-u),t.writeToRenderTexture(p,e,!1)}if(I.x-c>-m.bitmapData.width&&I.x-c<e.width&&I.y-u>-m.bitmapData.height&&I.y-u<e.height){const p=new ms(m.bitmapData.texture);p.position.set(I.x-c,I.y-u),t.writeToRenderTexture(p,e,!1)}}}E++}}return e}}class JC{constructor(t,e,s){this._type=t,this._leftSideLoc=e,this._rightSideLoc=s}get type(){return this._type}get leftSideLoc(){return this._leftSideLoc}get rightSideLoc(){return this._rightSideLoc}}class $C{constructor(t,e,s,i){this._leftSideLoc=t,this._rightSideLoc=e,this._leftSideLength=s,this._rightSideLength=i}get leftSideLoc(){return this._leftSideLoc}get rightSideLoc(){return this._rightSideLoc}get leftSideLength(){return this._leftSideLength}get rightSideLength(){return this._rightSideLength}}const qi=class qi{constructor(t,e,s,i,n,o,l,c,u,h=0,d=0,g=0,E=0){if(this._maskManager=null,this._width=0,this._height=0,this._textureCache=t,this._secondaryNormals=[],this._bitmapMasks=[],this._rectangleMasks=[],this._bitmapMasksOld=[],this._rectangleMasksOld=[],this._randomSeed=u,this._bitmapData=null,this._maskBitmapData=null,this._maskChanged=!1,this._activeTexture=null,this._origin=new j,this._origin.assign(e),this._location=new j,this._location.assign(s),this._leftSide=new j,this._leftSide.assign(i),this._rightSide=new j,this._rightSide.assign(n),this._normal=j.crossProduct(this._leftSide,this._rightSide),this._normal.length>0&&this._normal.multiply(1/this._normal.length),c!=null)for(const m of c){if(!m)continue;const I=new j;I.assign(m),this._secondaryNormals.push(I)}this._disposed=!1,this._isVisible=!1,this._id=null,this._hasTexture=!0,this._geometryUpdateId=-1,this._offset=new wt,this._relativeDepth=0,this._type=o,this._color=0,this._rasterizer=null,this._canBeVisible=!0,this._cornerA=new j,this._cornerB=new j,this._cornerC=new j,this._cornerD=new j,this._width=0,this._height=0,this._textureOffsetX=h,this._textureOffsetY=d,this._textureMaxX=g,this._textureMaxY=E,this._useMask=l,this._uniqueId=++qi._uniqueIdCounter}static blend(t,e){return ii.colorize(e,t|4278190080)&16777215}set canBeVisible(t){t!==this._canBeVisible&&(this._canBeVisible||this.resetTextureCache(),this._canBeVisible=t)}get canBeVisible(){return this._canBeVisible}get bitmapData(){return!this.visible||!this._bitmapData?null:this._bitmapData}get maskBitmapData(){return!this.visible||!this._maskBitmapData?null:this._maskBitmapData}get visible(){return this._isVisible&&this._canBeVisible}get offset(){return this._offset}get relativeDepth(){return this._relativeDepth}get color(){return this._color}set color(t){this._color=t}get type(){return this._type}get leftSide(){return this._leftSide}get rightSide(){return this._rightSide}get location(){return this._location}get normal(){return this._normal}get hasTexture(){return this._hasTexture}set hasTexture(t){this._hasTexture=t}set rasterizer(t){this._rasterizer=t}set maskManager(t){this._maskManager=t}set id(t){t!==this._id&&(this.resetTextureCache(),this._id=t)}get uniqueId(){return this._uniqueId}dispose(){this._activeTexture=null,this._location=null,this._origin=null,this._leftSide=null,this._rightSide=null,this._normal=null,this._rasterizer=null,this._cornerA=null,this._cornerB=null,this._cornerC=null,this._cornerD=null,this._bitmapMasks=null,this._rectangleMasks=null,this._maskPixels=null,this._maskBitmapData&&(this._maskBitmapData.destroy(!0),this._maskBitmapData=null),this._disposed=!0}copyBitmapData(t){return!this.visible||!this._bitmapData||!t||this._bitmapData.width!==t.width||this._bitmapData.height!==t.height?null:t}resetTextureCache(t=null){this._activeTexture=null}getTextureIdentifier(t){return this._rasterizer?this._rasterizer.getTextureIdentifier(t,this.normal):t.toString()}needsNewTexture(t,e){if(!t)return!1;const s=this._activeTexture;return this.updateMaskChangeStatus(),!!(this._canBeVisible&&(!s||s.timeStamp>=0&&e>s.timeStamp||this._maskChanged))}getTexture(t,e){if(!t)return null;let s=null;if(this.needsNewTexture(t,e)){this.getTextureIdentifier(t.scale);const i=this._leftSide.length*t.scale,n=this._rightSide.length*t.scale,o=t.getCoordinatePosition(this._normal);s=this._rasterizer.render(this._uniqueId.toString(),this._textureCache,null,this._id,i,n,t.scale,o,this._hasTexture,this._textureOffsetX,this._textureOffsetY,this._textureMaxX,this._textureMaxY,e),s&&this.updateMask(s.texture,t)}else this._activeTexture&&(s=this._activeTexture);return s?(this._activeTexture=s,s.texture):null}resolveMasks(t){if(!this._useMask)return null;const e=new Nh,s=0;for(;s<this._bitmapMasks.length;){const i=this._bitmapMasks[s];if(i){const n=this._maskManager.getMask(i.type);if(n){const o=n.getAssetName(t.scale);if(o){const l=t.getCoordinatePosition(this._normal),c=n.getGraphicAsset(t.scale,l);if(c){const u=this._maskBitmapData.width*(1-i.leftSideLoc/this._leftSide.length),h=this._maskBitmapData.height*(1-i.rightSideLoc/this._rightSide.length);e.addMask(o,new wt(u+c.offsetX,h+c.offsetY),c.flipH,c.flipV)}}}}}return e}screenWidth(t){const e=t.getScreenPoint(new j(0,0,0)),s=t.getScreenPoint(new j(0,1,0));return Math.round(this._leftSide.length*Math.abs(e.x-s.x))}getDrawingDatas(t){const e=[];if(this._isVisible){const s=this.resolveMasks(t),i=this._rasterizer.getLayers(this._id);for(const n of i)if(this._hasTexture&&n.getMaterial()){const o=t.getCoordinatePosition(this._normal),l=n.getMaterial().getMaterialCellMatrix(o),c=new Nh(s,qi.blend(this._color,n.getColor()),l.isBottomAligned());hh.setSeed(this._randomSeed);for(const u of l.getColumns(this.screenWidth(t))){const h=[];for(const d of u.getCells()){const g=d.getAssetName(o);g&&h.push(g)}h.length>0&&(u.isRepeated()||h.push(""),c.addAssetColumn(h))}c.assetNameColumns.length>0&&e.push(c)}else{const o=new Nh(s,qi.blend(this._color,n.getColor()));e.push(o)}e.length||e.push(new Nh(s,this._color))}return e}update(t,e){if(!t||this._disposed)return!1;let s=!1;if(this._geometryUpdateId!=t.updateId&&(s=!0),(!s||!this._canBeVisible)&&!this.visible)return!1;if(s){this._activeTexture=null;let i=0;if(i=j.cosAngle(t.directionAxis,this.normal),i>-.001)return this._isVisible?(this._isVisible=!1,!0):!1;let n=0;for(;n<this._secondaryNormals.length;){if(i=j.cosAngle(t.directionAxis,this._secondaryNormals[n]),i>-.001)return this._isVisible?(this._isVisible=!1,!0):!1;n++}this.updateCorners(t);const l=t.getScreenPosition(this._origin).z;let c=Math.max(this._cornerA.z,this._cornerB.z,this._cornerC.z,this._cornerD.z)-l;this._type===qi.TYPE_FLOOR&&(c=c-(this._location.z+Math.min(0,this._leftSide.z,this._rightSide.z))*8),this._type===qi.TYPE_LANDSCAPE&&(c=c+.02),this._relativeDepth=c,this._isVisible=!0,this._geometryUpdateId=t.updateId}if(s||this.needsNewTexture(t,e)){if(!this._bitmapData||this._width!==this._bitmapData.width||this._height!==this._bitmapData.height){if(this._bitmapData)if(this._width!==this._bitmapData.width||this._height!==this._bitmapData.height){if(this._bitmapData.destroy(),this._bitmapData=null,this._width<1||this._height<1)return!0;this._bitmapData=this._textureCache.createAndFillRenderTexture(this._width,this._height)}else{if(this._width<1||this._height<1)return this._bitmapData.destroy(),this._bitmapData=null,!0;this._textureCache.clearAndFillRenderTexture(this._bitmapData)}else{if(this._width<1||this._height<1)return!1;this._bitmapData=this._textureCache.createAndFillRenderTexture(this._width,this._height)}if(!this._bitmapData)return!1}else this._textureCache.clearAndFillRenderTexture(this._bitmapData);hh.setSeed(this._randomSeed);const i=this.getTexture(t,e);if(i)this.renderTexture(t,i);else return this.dispose(),!1;return i!==null||s}return!1}updateCorners(t){this._cornerA.assign(t.getScreenPosition(this._location)),this._cornerB.assign(t.getScreenPosition(j.sum(this._location,this._rightSide))),this._cornerC.assign(t.getScreenPosition(j.sum(j.sum(this._location,this._leftSide),this._rightSide))),this._cornerD.assign(t.getScreenPosition(j.sum(this._location,this._leftSide))),this._offset=t.getScreenPoint(this._origin),this._cornerA.x=Math.round(this._cornerA.x),this._cornerA.y=Math.round(this._cornerA.y),this._cornerB.x=Math.round(this._cornerB.x),this._cornerB.y=Math.round(this._cornerB.y),this._cornerC.x=Math.round(this._cornerC.x),this._cornerC.y=Math.round(this._cornerC.y),this._cornerD.x=Math.round(this._cornerD.x),this._cornerD.y=Math.round(this._cornerD.y),this._offset.x=Math.round(this._offset.x),this._offset.y=Math.round(this._offset.y);const e=Math.min(this._cornerA.x,this._cornerB.x,this._cornerC.x,this._cornerD.x),s=Math.max(this._cornerA.x,this._cornerB.x,this._cornerC.x,this._cornerD.x)-e,i=Math.min(this._cornerA.y,this._cornerB.y,this._cornerC.y,this._cornerD.y),n=Math.max(this._cornerA.y,this._cornerB.y,this._cornerC.y,this._cornerD.y)-i;this._offset.x=this._offset.x-e,this._cornerA.x=this._cornerA.x-e,this._cornerB.x=this._cornerB.x-e,this._cornerC.x=this._cornerC.x-e,this._cornerD.x=this._cornerD.x-e,this._offset.y=this._offset.y-i,this._cornerA.y=this._cornerA.y-i,this._cornerB.y=this._cornerB.y-i,this._cornerC.y=this._cornerC.y-i,this._cornerD.y=this._cornerD.y-i,this._width=s,this._height=n}getMatrixForDimensions(t,e){let s=this._cornerD.x-this._cornerC.x,i=this._cornerD.y-this._cornerC.y,n=this._cornerB.x-this._cornerC.x,o=this._cornerB.y-this._cornerC.y;(this._type===qi.TYPE_WALL||this._type===qi.TYPE_LANDSCAPE)&&(Math.abs(n-t)<=1&&(n=t),Math.abs(o-t)<=1&&(o=t),Math.abs(s-e)<=1&&(s=e),Math.abs(i-e)<=1&&(i=e));const l=n/t,c=o/t,u=s/e,h=i/e,d=new sr(l,c,u,h);return d.translate(this._cornerC.x,this._cornerC.y),d}renderTexture(t,e){this._cornerA==null||this._cornerB==null||this._cornerC==null||this._cornerD==null||e==null||this._bitmapData==null||this.draw(e,this.getMatrixForDimensions(e.width,e.height))}draw(t,e){this._textureCache.writeToRenderTexture(new ms(t),this._bitmapData,!0,e)}resetBitmapMasks(){this._disposed||!this._useMask||!this._bitmapMasks.length||(this._maskChanged=!0,this._bitmapMasks=[])}addBitmapMask(t,e,s){if(!this._useMask)return!1;for(const n of this._bitmapMasks)if(n&&n.type===t&&n.leftSideLoc===e&&n.rightSideLoc===s)return!1;const i=new JC(t,e,s);return this._bitmapMasks.push(i),this._maskChanged=!0,!0}resetRectangleMasks(){!this._useMask||!this._rectangleMasks.length||(this._maskChanged=!0,this._rectangleMasks=[])}addRectangleMask(t,e,s,i){if(this._useMask){for(const o of this._rectangleMasks)if(o&&o.leftSideLoc===t&&o.rightSideLoc===e&&o.leftSideLength===s&&o.rightSideLength===i)return!1;const n=new $C(t,e,s,i);return this._rectangleMasks.push(n),this._maskChanged=!0,!0}return!1}updateMaskChangeStatus(){if(!this._maskChanged)return;let t=!0;if(this._bitmapMasks.length===this._bitmapMasksOld.length)for(const e of this._bitmapMasks){if(!e)continue;let s=!1;for(const i of this._bitmapMasksOld)if(i&&i.type===e.type&&i.leftSideLoc===e.leftSideLoc&&i.rightSideLoc===e.rightSideLoc){s=!0;break}if(!s){t=!1;break}}else t=!1;this._rectangleMasks.length>this._rectangleMasksOld.length&&(t=!1),t&&(this._maskChanged=!1)}updateMask(t,e){if(!t||!e||!this._useMask||!this._bitmapMasks.length&&!this._rectangleMasks.length&&!this._maskChanged||!this._maskManager)return;const s=t.width,i=t.height;if(this.updateMaskChangeStatus(),(!this._maskBitmapData||this._maskBitmapData.width!==s||this._maskBitmapData.height!==i)&&(this._maskBitmapData=this._textureCache.createAndFillRenderTexture(s,i,"mask"),this._maskChanged=!0),this._maskChanged){this._bitmapMasksOld=[],this._rectangleMasksOld=[],this._maskBitmapData&&this._textureCache.clearAndFillRenderTexture(this._maskBitmapData),this.resetTextureCache(t);const n=e.getCoordinatePosition(this._normal);let o=null,l=0,c=0,u=0;for(;u<this._bitmapMasks.length;){const h=this._bitmapMasks[u];h&&(o=h.type,l=this._maskBitmapData.width-this._maskBitmapData.width*h.leftSideLoc/this._leftSide.length,c=this._maskBitmapData.height-this._maskBitmapData.height*h.rightSideLoc/this._rightSide.length,this._maskManager.updateMask(this._maskBitmapData,o,e.scale,n,l,c),this._bitmapMasksOld.push(new JC(o,h.leftSideLoc,h.rightSideLoc))),u++}for(u=0;u<this._rectangleMasks.length;){const h=this._rectangleMasks[u];if(h){l=this._maskBitmapData.width-this._maskBitmapData.width*h.leftSideLoc/this._leftSide.length,c=this._maskBitmapData.height-this._maskBitmapData.height*h.rightSideLoc/this._rightSide.length;const d=this._maskBitmapData.width*h.leftSideLength/this._leftSide.length,g=this._maskBitmapData.height*h.rightSideLength/this._rightSide.length,E=new ms(Es.WHITE);E.tint=0,E.width=d,E.height=g,E.position.set(l-d,c-g),this._textureCache.writeToRenderTexture(E,this._maskBitmapData,!1),this._rectangleMasksOld.push(new $C(h.leftSideLength,h.rightSideLoc,h.leftSideLength,h.rightSideLength))}u++}this._maskPixels=this._textureCache.getPixels(this._maskBitmapData),this._maskChanged=!1}this.combineTextureMask(t,this._maskPixels)}combineTextureMask(t,e){var o,l;if(!t||!e)return;const s=this._textureCache.getPixels(t);for(let c=0;c<s.length;c+=4){const u=e[c],h=e[c+1],d=e[c+2];e[c+3],!u&&!h&&!d&&(s[c+3]=0)}const i=(o=t.baseTexture._glTextures[1])==null?void 0:o.texture,n=(l=ws.instance.renderer)==null?void 0:l.gl;!i||!n||(n.bindTexture(n.TEXTURE_2D,i),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,t.width,t.height,0,n.RGBA,n.UNSIGNED_BYTE,s),n.bindTexture(n.TEXTURE_2D,null))}};qi.ZERO_POINT=new wt(0,0),qi.TYPE_UNDEFINED=0,qi.TYPE_WALL=1,qi.TYPE_FLOOR=2,qi.TYPE_LANDSCAPE=3,qi._uniqueIdCounter=1;let xe=qi;class e0 extends Ar{constructor(){super(),this._wallRasterizer=new tq,this._floorRasterizer=new Z6,this._landscapeRasterizer=new If,this._maskManager=new q6,this._initialized=!1}initialize(t){if(!t.roomVisualization)return!1;const e=t.roomVisualization.wallData;e&&this._wallRasterizer.initialize(e);const s=t.roomVisualization.floorData;s&&this._floorRasterizer.initialize(s);const i=t.roomVisualization.landscapeData;i&&this._landscapeRasterizer.initialize(i);const n=t.roomVisualization.maskData;return n&&this._maskManager.initialize(n),!0}onDispose(){this._wallRasterizer&&(this._wallRasterizer.dispose(),this._wallRasterizer=null),this._floorRasterizer&&(this._floorRasterizer.dispose(),this._floorRasterizer=null),this._landscapeRasterizer&&(this._landscapeRasterizer.dispose(),this._landscapeRasterizer=null),this._maskManager&&(this._maskManager.dispose(),this._maskManager=null),super.onDispose()}setGraphicAssetCollection(t){this._initialized||(this._wallRasterizer.initializeAssetCollection(t),this._floorRasterizer.initializeAssetCollection(t),this._landscapeRasterizer.initializeAssetCollection(t),this._maskManager.initializeAssetCollection(t),this._initialized=!0)}clearCache(){this._wallRasterizer&&this._wallRasterizer.clearCache(),this._floorRasterizer&&this._floorRasterizer.clearCache(),this._landscapeRasterizer&&this._landscapeRasterizer.clearCache()}get wallRasterizer(){return this._wallRasterizer}get floorRasterizer(){return this._floorRasterizer}get landscapeRasterizer(){return this._landscapeRasterizer}get maskManager(){return this._maskManager}}const Ve=class Ve extends nh{constructor(){super(),this._data=null,this._roomPlaneParser=new Ws,this._roomPlaneBitmapMaskParser=new zU,this._geometryUpdateId=-1,this._directionX=0,this._directionY=0,this._directionZ=0,this._floorThickness=1,this._wallThickness=1,this._holeUpdateTime=NaN,this._planes=[],this._visiblePlanes=[],this._visiblePlaneSpriteNumbers=[],this._roomScale=0,this._lastUpdateTime=-1e3,this._updateIntervalTime=250,this._wallType=null,this._floorType=null,this._landscapeType=null,this._colorBackgroundOnly=!0,this._color=16777215,this._redColor=255,this._greenColor=255,this._blueColor=255,this._typeVisibility=[],this._assetUpdateCounter=0,this._maskData=null,this._isPlaneSet=!1,this._textureCache=new Zp,this._typeVisibility[xe.TYPE_UNDEFINED]=!1,this._typeVisibility[xe.TYPE_FLOOR]=!0,this._typeVisibility[xe.TYPE_WALL]=!0,this._typeVisibility[xe.TYPE_LANDSCAPE]=!0}initialize(t){return t instanceof e0?(this._data=t,super.initialize(t),this._data.setGraphicAssetCollection(this.asset),!0):!1}dispose(){super.dispose(),this.clearPlanes(),this._planes=null,this._visiblePlanes=null,this._visiblePlaneSpriteNumbers=null,this._roomPlaneParser&&(this._roomPlaneParser.dispose(),this._roomPlaneParser=null),this._roomPlaneBitmapMaskParser&&(this._roomPlaneBitmapMaskParser.dispose(),this._roomPlaneBitmapMaskParser=null),this._data&&(this._data.clearCache(),this._data=null),this._textureCache&&this._textureCache.clearCache()}reset(){super.reset(),this._floorType=null,this._wallType=null,this._landscapeType=null,this._maskData=null,this._geometryUpdateId=-1,this._roomScale=0}update(t,e,s,i){if(!this.object||!t)return;const n=this.updateGeometry(t),o=this.object.model;let l=!1;if(this.updateThickness(o)&&(l=!0),this.updateHole(o)&&(l=!0),this.initializeRoomPlanes(),l=this.updateMasks(o),!(e<this._lastUpdateTime+this._updateIntervalTime&&!n&&!l)){if(this.updatePlaneTexturesAndVisibilities(o)&&(l=!0),this.updatePlanes(t,n,e)&&(l=!0),l){let c=0;for(;c<this._visiblePlanes.length;){const u=this._visiblePlaneSpriteNumbers[c],h=this.getSprite(u),d=this._visiblePlanes[c];if(h&&d&&d.type!==xe.TYPE_LANDSCAPE)if(this._colorBackgroundOnly){let g=d.color;const E=(g&255)*this._redColor/255,m=(g>>8&255)*this._greenColor/255,I=(g>>16&255)*this._blueColor/255;g=(g>>24<<24)+(I<<16)+(m<<8)+E,h.color=g}else h.color=d.color;c++}this.updateSpriteCounter++}this.updateModelCounter=o.updateCounter,this._lastUpdateTime=e}}updateGeometry(t){if(!t||this._geometryUpdateId===t.updateId)return!1;this._geometryUpdateId=t.updateId,this._boundingRectangle=null;const e=t.direction;return e&&(e.x!==this._directionX||e.y!==this._directionY||e.z!==this._directionZ||t.scale!==this._roomScale)?(this._directionX=e.x,this._directionY=e.y,this._directionZ=e.z,this._roomScale=t.scale,!0):!1}updateThickness(t){if(this.updateModelCounter===t.updateCounter)return!1;const e=t.getValue(C.ROOM_FLOOR_THICKNESS),s=t.getValue(C.ROOM_WALL_THICKNESS);return!isNaN(e)&&!isNaN(s)&&(e!==this._floorThickness||s!==this._wallThickness)?(this._floorThickness=e,this._wallThickness=s,this.clearPlanes(),!0):!1}updateHole(t){if(this.updateModelCounter===t.updateCounter)return!1;const e=t.getValue(C.ROOM_FLOOR_HOLE_UPDATE_TIME);return!isNaN(e)&&e!==this._holeUpdateTime?(this._holeUpdateTime=e,this.clearPlanes(),!0):!1}updateMasks(t){if(this.updateModelCounter===t.updateCounter)return!1;let e=!1;const s=t.getValue(C.ROOM_PLANE_MASK_XML);s!==this._maskData&&(this.updatePlaneMasks(s),this._maskData=s,e=!0);const i=t.getValue(C.ROOM_BACKGROUND_COLOR);i!==this._color&&(this._color=i,this._redColor=this._color&255,this._greenColor=this._color>>8&255,this._blueColor=this._color>>16&255,e=!0);const n=t.getValue(C.ROOM_COLORIZE_BG_ONLY)||!1;return n!==this._colorBackgroundOnly&&(this._colorBackgroundOnly=n,e=!0),e}updatePlaneTexturesAndVisibilities(t){if(this.updateModelCounter===t.updateCounter)return!1;const e=t.getValue(C.ROOM_FLOOR_TYPE),s=t.getValue(C.ROOM_WALL_TYPE),i=t.getValue(C.ROOM_LANDSCAPE_TYPE),n=t.getValue(C.ROOM_FLOOR_VISIBILITY)===1,o=t.getValue(C.ROOM_WALL_VISIBILITY)===1,l=t.getValue(C.ROOM_LANDSCAPE_VISIBILITY)===1;return this.updatePlaneTypes(e,s,i)||this.updatePlaneVisibility(n,o,l)}clearPlanes(){if(this._planes){for(;this._planes.length;){const t=this._planes[0];t&&t.dispose(),this._planes.pop()}this._planes=[],this._planes=[]}this._isPlaneSet=!1,this._assetUpdateCounter=this._assetUpdateCounter+1,this.reset()}initializeRoomPlanes(){if(!this.object||this._isPlaneSet)return;isNaN(this._floorThickness)||(this._roomPlaneParser.floorThicknessMultiplier=this._floorThickness),isNaN(this._wallThickness)||(this._roomPlaneParser.wallThicknessMultiplier=this._wallThickness);const t=this.object.model.getValue(C.ROOM_MAP_DATA);if(!this._roomPlaneParser.initializeFromMapData(t))return;const e=this.getLandscapeWidth(),s=this.getLandscapeHeight();let i=0,n=this.object.model.getValue(C.ROOM_RANDOM_SEED),o=0;for(;o<this._roomPlaneParser.planeCount;){const l=this._roomPlaneParser.getPlaneLocation(o),c=this._roomPlaneParser.getPlaneLeftSide(o),u=this._roomPlaneParser.getPlaneRightSide(o),h=this._roomPlaneParser.getPlaneSecondaryNormals(o),d=this._roomPlaneParser.getPlaneType(o);let g=null;if(l&&c&&u){const E=j.crossProduct(c,u);if(n=r0(Math.trunc(n*7613+517)>>>0),g=null,d===gs.PLANE_FLOOR){const m=l.x+c.x+.5,I=l.y+u.y+.5,p=Math.trunc(m)-m,T=Math.trunc(I)-I;g=new xe(this._textureCache,this.object.getLocation(),l,c,u,xe.TYPE_FLOOR,!0,h,n,-p,-T),E.z!==0?g.color=Ve.FLOOR_COLOR:g.color=E.x!==0?Ve.FLOOR_COLOR_RIGHT:Ve.FLOOR_COLOR_LEFT,this._data&&(g.rasterizer=this._data.floorRasterizer)}else d===gs.PLANE_WALL?(g=new xe(this._textureCache,this.object.getLocation(),l,c,u,xe.TYPE_WALL,!0,h,n),(c.length<1||u.length<1)&&(g.hasTexture=!1),E.x===0&&E.y===0?g.color=Ve.WALL_COLOR_BORDER:E.y>0?g.color=Ve.WALL_COLOR_TOP:E.y===0?g.color=Ve.WALL_COLOR_SIDE:g.color=Ve.WALL_COLOR_BOTTOM,this._data&&(g.rasterizer=this._data.wallRasterizer)):d===gs.PLANE_LANDSCAPE?(g=new xe(this._textureCache,this.object.getLocation(),l,c,u,xe.TYPE_LANDSCAPE,!0,h,n,i,0,e,s),E.y>0?g.color=Ve.LANDSCAPE_COLOR_TOP:E.y==0?g.color=Ve.LANDSCAPE_COLOR_SIDE:g.color=Ve.LANDSCAPE_COLOR_BOTTOM,this._data&&(g.rasterizer=this._data.landscapeRasterizer),i=i+c.length):d==gs.PLANE_BILLBOARD&&(g=new xe(this._textureCache,this.object.getLocation(),l,c,u,xe.TYPE_WALL,!0,h,n),(c.length<1||u.length<1)&&(g.hasTexture=!1),E.x==0&&E.y==0?g.color=Ve.WALL_COLOR_BORDER:E.y>0?g.color=Ve.WALL_COLOR_TOP:E.y==0?g.color=Ve.WALL_COLOR_SIDE:g.color=Ve.WALL_COLOR_BOTTOM);if(g){g.maskManager=this._data.maskManager;let m=0;for(;m<this._roomPlaneParser.getPlaneMaskCount(o);){const I=this._roomPlaneParser.getPlaneMaskLeftSideLoc(o,m),p=this._roomPlaneParser.getPlaneMaskRightSideLoc(o,m),T=this._roomPlaneParser.getPlaneMaskLeftSideLength(o,m),R=this._roomPlaneParser.getPlaneMaskRightSideLength(o,m);g.addRectangleMask(I,p,T,R),m++}this._planes.push(g)}}else return;o++}this._isPlaneSet=!0,this.defineSprites()}defineSprites(){this.createSprites(this._planes.length);let t=0;for(;t<this._planes.length;){const e=this._planes[t],s=this.getSprite(t);e&&s&&e.leftSide&&e.rightSide&&(e.type===xe.TYPE_WALL&&(e.leftSide.length<1||e.rightSide.length<1)?s.alphaTolerance=Fn.MATCH_NOTHING:s.alphaTolerance=Fn.MATCH_OPAQUE_PIXELS,e.type===xe.TYPE_WALL?s.tag="plane.wall@"+(t+1):e.type===xe.TYPE_FLOOR?s.tag="plane.floor@"+(t+1):s.tag="plane@"+(t+1),s.spriteType=Gr.ROOM_PLANE),t++}}getLandscapeWidth(){let t=0,e=0;for(;e<this._roomPlaneParser.planeCount;){if(this._roomPlaneParser.getPlaneType(e)===gs.PLANE_LANDSCAPE){const i=this._roomPlaneParser.getPlaneLeftSide(e);t+=i.length}e++}return t}getLandscapeHeight(){let t=0,e=0;for(;e<this._roomPlaneParser.planeCount;){if(this._roomPlaneParser.getPlaneType(e)===gs.PLANE_LANDSCAPE){const i=this._roomPlaneParser.getPlaneRightSide(e);i.length>t&&(t=i.length)}e++}return t>5&&(t=5),t}updatePlaneTypes(t,e,s){if(t!==this._floorType?this._floorType=t:t=null,e!==this._wallType?this._wallType=e:e=null,s!==this._landscapeType?this._landscapeType=s:s=null,!t&&!e&&!s)return!1;let i=0;for(;i<this._planes.length;){const n=this._planes[i];n&&(n.type===xe.TYPE_FLOOR&&t?n.id=t:n.type===xe.TYPE_WALL&&e?n.id=e:n.type===xe.TYPE_LANDSCAPE&&s&&(n.id=s)),i++}return!0}updatePlaneVisibility(t,e,s){return t===this._typeVisibility[xe.TYPE_FLOOR]&&e===this._typeVisibility[xe.TYPE_WALL]&&s===this._typeVisibility[xe.TYPE_LANDSCAPE]?!1:(this._typeVisibility[xe.TYPE_FLOOR]=t,this._typeVisibility[xe.TYPE_WALL]=e,this._typeVisibility[xe.TYPE_LANDSCAPE]=s,this._visiblePlanes=[],this._visiblePlaneSpriteNumbers=[],!0)}updatePlanes(t,e,s){if(!t||!this.object)return!1;this._assetUpdateCounter++,e&&(this._visiblePlanes=[],this._visiblePlaneSpriteNumbers=[]);const i=this._visiblePlanes.length>0;let n=this._visiblePlanes;this._visiblePlanes.length||(n=this._planes);let o=0,l=!1,c=0;for(;c<n.length;){let u=c;i&&(u=this._visiblePlaneSpriteNumbers[c]);const h=this.getSprite(u);if(h){const d=n[c];d?(h.id=d.uniqueId,d.update(t,s)&&(d.visible&&(o=d.relativeDepth+this.floorRelativeDepth+u/1e3,d.type!==xe.TYPE_FLOOR&&(o=d.relativeDepth+this.wallRelativeDepth+u/1e3,(d.leftSide.length<1||d.rightSide.length<1)&&(o=o+Ve.ROOM_DEPTH_OFFSET*.5)),this.updateSprite(h,t,d,`plane ${u} ${t.scale}`,o)),l=!0),h.visible!=(d.visible&&this._typeVisibility[d.type])&&(h.visible=!h.visible,l=!0),h.visible&&(i||(this._visiblePlanes.push(d),this._visiblePlaneSpriteNumbers.push(c)))):(h.id=0,h.visible&&(h.visible=!1,l=!0))}c++}return l}updatePlaneMasks(t){if(!t)return;this._roomPlaneBitmapMaskParser.initialize(t);const e=[],s=[];let i=!1,n=0;for(;n<this._planes.length;){const o=this._planes[n];o&&(o.resetBitmapMasks(),o.type===xe.TYPE_LANDSCAPE&&e.push(n)),n++}for(const o of this._roomPlaneBitmapMaskParser.masks.values()){const l=this._roomPlaneBitmapMaskParser.getMaskType(o),c=this._roomPlaneBitmapMaskParser.getMaskLocation(o),u=this._roomPlaneBitmapMaskParser.getMaskCategory(o);if(c){let h=0;for(;h<this._planes.length;){const d=this._planes[h];if((d.type===xe.TYPE_WALL||d.type===xe.TYPE_LANDSCAPE)&&d&&d.location&&d.normal){const g=j.dif(c,d.location);if(Math.abs(j.scalarProjection(g,d.normal))<.01&&d.leftSide&&d.rightSide){const m=j.scalarProjection(g,d.leftSide),I=j.scalarProjection(g,d.rightSide);d.type===xe.TYPE_WALL||d.type===xe.TYPE_LANDSCAPE&&u===Mc.HOLE?d.addBitmapMask(l,m,I):d.type===xe.TYPE_LANDSCAPE&&(d.canBeVisible||(i=!0),d.canBeVisible=!0,s.push(h))}}h++}}}for(n=0;n<e.length;){const o=e[n];if(s.indexOf(o)<0){const l=this._planes[o];l.canBeVisible=!1,i=!0}n++}i&&(this._visiblePlanes=[],this._visiblePlaneSpriteNumbers=[])}updateSprite(t,e,s,i,n){const o=s.offset;t.offsetX=-o.x,t.offsetY=-o.y,t.relativeDepth=n,t.color=s.color,t.texture=s.bitmapData,t.name=i+"_"+this._assetUpdateCounter}getBoundingRectangle(){return this._boundingRectangle||(this._boundingRectangle=super.getBoundingRectangle()),new Or(this._boundingRectangle.x,this._boundingRectangle.y,this._boundingRectangle.width,this._boundingRectangle.height)}get planes(){const t=[];for(const e of this._visiblePlanes)t.push(e);return t}get floorRelativeDepth(){return Ve.ROOM_DEPTH_OFFSET+.1}get wallRelativeDepth(){return Ve.ROOM_DEPTH_OFFSET+.5}};Ve.FLOOR_COLOR=16777215,Ve.FLOOR_COLOR_LEFT=14540253,Ve.FLOOR_COLOR_RIGHT=12303291,Ve.WALL_COLOR_TOP=16777215,Ve.WALL_COLOR_SIDE=13421772,Ve.WALL_COLOR_BOTTOM=10066329,Ve.WALL_COLOR_BORDER=10066329,Ve.LANDSCAPE_COLOR_TOP=16777215,Ve.LANDSCAPE_COLOR_SIDE=13421772,Ve.LANDSCAPE_COLOR_BOTTOM=10066329,Ve.ROOM_DEPTH_OFFSET=1e3;let jR=Ve;class eq extends ys{constructor(){super(),this._tileHeight=0}getLayerYOffset(t,e,s){return s===1?(this._tileHeight=this.object.model.getValue(C.TILE_CURSOR_HEIGHT),-this._tileHeight*32):super.getLayerYOffset(t,e,s)}}const mE=class mE{constructor(){this._visualizationDatas=new Map}getVisualization(t){const e=this.getVisualizationType(t);return e?new e:null}getVisualizationType(t){if(!t)return null;let e=null;switch(t){case ht.ROOM:e=jR;break;case ht.TILE_CURSOR:e=eq;break;case ht.USER:case ht.BOT:case ht.RENTABLE_BOT:e=dR;break;case ht.PET_ANIMATED:e=bR;break;case ht.FURNITURE_STATIC:e=Io;break;case ht.FURNITURE_ANIMATED:e=ys;break;case ht.FURNITURE_RESETTING_ANIMATED:e=V6;break;case ht.FURNITURE_BADGE_DISPLAY:e=_R;break;case ht.FURNITURE_BG:e=H6;break;case ht.FURNITURE_BB:e=JU;break;case ht.FURNITURE_ISOMETRIC_BB:e=G6;break;case ht.FURNITURE_BOTTLE:e=gR;break;case ht.FURNITURE_BUILDER_PLACEHOLDER:e=P6;break;case ht.FURNITURE_COUNTER_CLOCK:e=fR;break;case ht.FURNITURE_CUBOID:e=U6;break;case ht.FURNITURE_EXTERNAL_IMAGE:e=j6;break;case ht.FURNITURE_FIREWORKS:e=ZU;break;case ht.FURNITURE_GIFT_WRAPPED_FIREWORKS:e=ER;break;case ht.FURNITURE_GIFT_WRAPPED:e=F6;break;case ht.FURNITURE_GUILD_CUSTOMIZED:e=pR;break;case ht.FURNITURE_GUILD_ISOMETRIC_BADGE:e=IR;break;case ht.FURNITURE_HABBOWHEEL:e=TR;break;case ht.FURNITURE_MANNEQUIN:e=SR;break;case ht.FURNITURE_PARTY_BEAMER:e=OR;break;case ht.FURNITURE_PLANET_SYSTEM:e=B6;break;case ht.FURNITURE_POSTER:e=k6;break;case ht.FURNITURE_QUEUE_TILE:e=AR;break;case ht.FURNITURE_SCORE_BOARD:e=NR;break;case ht.FURNITURE_SOUNDBLOCK:e=W6;break;case ht.FURNITURE_STICKIE:e=Y6;break;case ht.FURNITURE_VAL_RANDOMIZER:e=xR;break;case ht.FURNITURE_VOTE_COUNTER:e=MR;break;case ht.FURNITURE_VOTE_MAJORITY:e=yR;break;case ht.FURNITURE_WATER_AREA:e=z6;break;case ht.FURNITURE_YOUTUBE:e=DR;break}return e||(dt.log("Unknown Visualization",t),null)}getVisualizationData(t,e,s){const i=this._visualizationDatas.get(t);if(i)return i;let n=null;switch(e){case ht.FURNITURE_STATIC:case ht.FURNITURE_GIFT_WRAPPED:case ht.FURNITURE_BB:case ht.FURNITURE_ISOMETRIC_BB:case ht.FURNITURE_BG:case ht.FURNITURE_STICKIE:case ht.FURNITURE_BUILDER_PLACEHOLDER:n=new ya;break;case ht.FURNITURE_ANIMATED:case ht.FURNITURE_RESETTING_ANIMATED:case ht.FURNITURE_POSTER:case ht.FURNITURE_HABBOWHEEL:case ht.FURNITURE_VAL_RANDOMIZER:case ht.FURNITURE_BOTTLE:case ht.FURNITURE_PLANET_SYSTEM:case ht.FURNITURE_QUEUE_TILE:case ht.FURNITURE_PARTY_BEAMER:case ht.FURNITURE_COUNTER_CLOCK:case ht.FURNITURE_WATER_AREA:case ht.FURNITURE_SCORE_BOARD:case ht.FURNITURE_FIREWORKS:case ht.FURNITURE_GIFT_WRAPPED_FIREWORKS:case ht.FURNITURE_GUILD_CUSTOMIZED:case ht.FURNITURE_GUILD_ISOMETRIC_BADGE:case ht.FURNITURE_VOTE_COUNTER:case ht.FURNITURE_VOTE_MAJORITY:case ht.FURNITURE_SOUNDBLOCK:case ht.FURNITURE_BADGE_DISPLAY:case ht.FURNITURE_EXTERNAL_IMAGE:case ht.FURNITURE_YOUTUBE:case ht.TILE_CURSOR:n=new RO;break;case ht.FURNITURE_MANNEQUIN:n=new RR;break;case ht.ROOM:n=new e0;break;case ht.USER:case ht.BOT:case ht.RENTABLE_BOT:n=new gf;break;case ht.PET_ANIMATED:n=new t0;break}return n?n.initialize(s)?((n instanceof gf||n instanceof RR)&&(n.avatarManager=Et.instance.avatar),mE.CACHING_ENABLED&&this._visualizationDatas.set(t,n),n):(n.dispose(),null):null}};mE.CACHING_ENABLED=!0;let wR=mE;const Pr=class Pr{};Pr.ROOM_MIN_X="room_min_x",Pr.ROOM_MAX_X="room_max_x",Pr.ROOM_MIN_Y="room_min_y",Pr.ROOM_MAX_Y="room_max_y",Pr.ROOM_IS_PUBLIC="room_is_public",Pr.ROOM_Z_SCALE="room_z_scale",Pr.AD_DISPLAY_DELAY="ad_display_delay",Pr.IS_PLAYING_GAME="is_playing_game",Pr.RESTRICTS_DRAGGING="restricts_dragging",Pr.RESTRICTS_SCALING="restricts_scaling",Pr.RESTRICTED_SCALE="room_scale";let cs=Pr;class sq{constructor(t,e){this._width=t,this._height=e,this._heights=[],this._isNotStackable=[],this._isRoomTile=[];let s=t*e;for(;s>0;)this._heights.push(0),this._isNotStackable.push(!1),this._isRoomTile.push(!1),s--}dispose(){this._width=0,this._height=0,this._height=null,this._isNotStackable=null,this._isRoomTile=null}validPosition(t,e){return t>=0&&t<this._width&&e>=0&&e<this._height}getTileHeight(t,e){return this.validPosition(t,e)?this._heights[e*this._width+t]:0}setTileHeight(t,e,s){this.validPosition(t,e)&&(this._heights[e*this._width+t]=s)}setStackingBlocked(t,e,s){this.validPosition(t,e)&&(this._isNotStackable[e*this._width+t]=s)}setIsRoomTile(t,e,s){this.validPosition(t,e)&&(this._isRoomTile[e*this._width+t]=s)}validateLocation(t,e,s,i,n,o,l,c,u,h=-1){let d=0,g=0;if(!this.validPosition(t,e)||!this.validPosition(t+s-1,e+i-1))return!1;(n<0||n>=this._width)&&(n=0),(o<0||o>=this._height)&&(o=0),l=Math.min(l,this._width-n),c=Math.min(c,this._height-o),h===-1&&(h=this.getTileHeight(t,e));let E=e;for(;E<e+i;){for(d=t;d<t+s;){if(d<n||d>=n+l||E<o||E>=o+c){if(g=E*this._width+d,u){if(!this._isRoomTile[g])return!1}else if(this._isNotStackable[g]||!this._isRoomTile[g]||Math.abs(this._heights[g]-h)>.01)return!1}d++}E++}return!0}get width(){return this._width}get height(){return this._height}}const Ur=class Ur{constructor(){this._isDisposed=!1,this._scale=64,this._heightMap=[],this._width=0,this._height=0,this._floorHeight=0}get disposed(){return this._isDisposed}get scale(){return this._scale}set scale(t){this._scale=t}dispose(){this.reset(),this._isDisposed=!0}initialize(t,e,s){if(t<=this._width&&e<=this._height){this._width=t,this._height=e,this._floorHeight=s;return}this.reset();let i=0;for(;i<e;){const n=[];this._heightMap.push(n);let o=0;for(;o<t;)n.push(0),o++;i++}this._width=t,this._height=e,this._floorHeight=s}reset(){this._heightMap=[]}setHeight(t,e,s){if(t<0||t>=this._width||e<0||e>=this._height)return!1;const i=this._heightMap[e];return i?(i[t]=s,!0):!1}getHeight(t,e){if(t<0||t>=this._width||e<0||e>=this._height)return 0;const s=this._heightMap[e];return s?s[t]:0}getLocation(t,e,s,i,n){if(t==0&&e==0){t=this._width,e=this._height;const h=Math.round(this.scale/10);if(n==Ur.R){let d=this._width-1;for(;d>=0;){let g=1;for(;g<this._height;){if(this.getHeight(d,g)<=this._floorHeight){g-1<e&&(t=d,e=g-1);break}g++}d--}i=i+(this.scale/4-h/2),s=s+this.scale/2}else{let d=this._height-1;for(;d>=0;){let g=1;for(;g<this._width;){if(this.getHeight(g,d)<=this._floorHeight){g-1<t&&(t=g-1,e=d);break}g++}d--}i=i+(this.scale/4-h/2),s=s-h}}let o=t,l=e,c=this.getHeight(t,e);return n==Ur.R?(o=o+(s/(this._scale/2)-.5),l=l+.5,c=c-(i-s/2)/(this._scale/2)):(l=l+((this._scale/2-s)/(this._scale/2)-.5),o=o+.5,c=c-(i-(this._scale/2-s)/2)/(this._scale/2)),new j(o,l,c)}getLocationOldFormat(t,e,s){let i,n,o=0,l=0;n=Math.ceil(t),o=n-t;let c,u,h,d=0;for(i=0;i<this._width;){if(n>=0&&n<this._height){if(this.getHeight(i,n)<=this._floorHeight){c=i-1,u=n,l=i,s=Ur.L;break}if(this.getHeight(i,n+1)<=this._floorHeight){c=i,u=n,l=u-t,s=Ur.R;break}}n++,i++}const g=this.scale/2*o;let E=-l*this.scale/2;return E=E+-e*18/32*this.scale/2,d=this.getHeight(c,u),h=d*this.scale/2+E,s==Ur.R?h=h+o*this.scale/4:h=h+(1-o)*this.scale/4,this.getLocation(c,u,g,h,s)}getOldLocation(t,e){if(t==null)return null;let s=0,i=0,n=0,o=0,l="",c=0;if(e==90)s=Math.floor(t.x-.5),i=Math.floor(t.y+.5),c=this.getHeight(s,i),n=this._scale/2-(t.y-i+.5)*(this._scale/2),o=(c-t.z)*(this._scale/2)+(this._scale/2-n)/2,l=Ur.L;else if(e==180)s=Math.floor(t.x+.5),i=Math.floor(t.y-.5),c=this.getHeight(s,i),n=(t.x+.5-s)*(this._scale/2),o=(c-t.z)*(this._scale/2)+n/2,l=Ur.R;else return null;return[s,i,n,o,l]}getOldLocationString(t,e){const s=this.getOldLocation(t,e);if(s==null)return null;const i=Math.trunc(s[0]),n=Math.trunc(s[1]),o=Math.trunc(s[2]),l=Math.trunc(s[3]),c=s[4];return":w="+i+","+n+" l="+o+","+l+" "+c}getDirection(t){return t==Ur.R?180:90}getFloorAltitude(t,e){const s=this.getHeight(t,e),i=s+1;return s+(Math.trunc(this.getHeight(t-1,e-1))==i||Math.trunc(this.getHeight(t,e-1))==i||Math.trunc(this.getHeight(t+1,e-1))==i||Math.trunc(this.getHeight(t-1,e))==i||Math.trunc(this.getHeight(t+1,e))==i||Math.trunc(this.getHeight(t-1,e+1))==i||Math.trunc(this.getHeight(t,e+1))==i||Math.trunc(this.getHeight(t+1,e+1))==i?.5:0)}isRoomTile(t,e){return t>=0&&t<this._width&&e>=0&&e<this._height&&this._heightMap[e][t]>=0}};Ur.DEFAULT_SCALE=32,Ur.L="l",Ur.R="r";let i_=Ur;const EE=class EE{constructor(){this._targetId=-1,this._targetCategory=-2,this._targetLoc=null,this._moveDistance=0,this._previousMoveSpeed=0,this._maintainPreviousMoveSpeed=!1,this._currentLoc=null,this._limitedLocX=!1,this._limitedLocY=!1,this._centeredLocX=!1,this._centeredLocY=!1,this._screenWd=0,this._screenHt=0,this._scale=0,this._roomWd=0,this._roomHt=0,this._geometryUpdateId=-1,this._scaleChanged=!1,this._targetObjectLoc=new j}get location(){return this._currentLoc}get targetId(){return this._targetId}set targetId(t){this._targetId=t}get targetCategory(){return this._targetCategory}set targetCategory(t){this._targetCategory=t}get targetObjectLoc(){return this._targetObjectLoc}set targetObjectLoc(t){this._targetObjectLoc.assign(t)}get limitedLocationX(){return this._limitedLocX}set limitedLocationX(t){this._limitedLocX=t}get limitedLocationY(){return this._limitedLocY}set limitedLocationY(t){this._limitedLocY=t}get centeredLocX(){return this._centeredLocX}set centeredLocX(t){this._centeredLocX=t}get centeredLocY(){return this._centeredLocY}set centeredLocY(t){this._centeredLocY=t}get screenWd(){return this._screenWd}set screenWd(t){this._screenWd=t}get screenHt(){return this._screenHt}set screenHt(t){this._screenHt=t}get scale(){return this._scale}set scale(t){this._scale!=t&&(this._scale=t,this._scaleChanged=!0)}get roomWd(){return this._roomWd}set roomWd(t){this._roomWd=t}get roomHt(){return this._roomHt}set roomHt(t){this._roomHt=t}get geometryUpdateId(){return this._geometryUpdateId}set geometryUpdateId(t){this._geometryUpdateId=t}get isMoving(){return this._targetLoc!=null&&this._currentLoc!=null}set target(t){let e;this._targetLoc==null&&(this._targetLoc=new j),(this._targetLoc.x!=t.x||this._targetLoc.y!=t.y||this._targetLoc.z!=t.z)&&(this._targetLoc.assign(t),e=j.dif(this._targetLoc,this._currentLoc),this._moveDistance=e.length,this._maintainPreviousMoveSpeed=!0)}dispose(){this._targetLoc=null,this._currentLoc=null}initializeLocation(t){this._currentLoc==null&&(this._currentLoc=new j,this._currentLoc.assign(t))}resetLocation(t){this._currentLoc==null&&(this._currentLoc=new j),this._currentLoc.assign(t)}update(t,e){let s,i,n,o,l;if(this._followDuration>0&&this._targetLoc!=null&&this._currentLoc!=null){if(this._scaleChanged){this._scaleChanged=!1,this._currentLoc=this._targetLoc,this._targetLoc=null;return}s=j.dif(this._targetLoc,this._currentLoc),s.length>this._moveDistance&&(this._moveDistance=s.length),s.length<=e?(this._currentLoc=this._targetLoc,this._targetLoc=null,this._previousMoveSpeed=0):(i=Math.sin(Math.PI*s.length/this._moveDistance),n=e*.5,o=this._moveDistance/EE.MOVE_SPEED_DENOMINATOR,l=n+(o-n)*i,this._maintainPreviousMoveSpeed&&(l<this._previousMoveSpeed?(l=this._previousMoveSpeed,l>s.length&&(l=s.length)):this._maintainPreviousMoveSpeed=!1),this._previousMoveSpeed=l,s.divide(s.length),s.multiply(l),this._currentLoc=j.sum(this._currentLoc,s))}}reset(){this._geometryUpdateId=-1}activateFollowing(t){this._followDuration=t}};EE.MOVE_SPEED_DENOMINATOR=12;let FR=EE;class ZC{constructor(t,e){this._roomId=t,this._data=e,this._floorType=null,this._wallType=null,this._landscapeType=null}get roomId(){return this._roomId}get data(){return this._data}get floorType(){return this._floorType}set floorType(t){this._floorType=t}get wallType(){return this._wallType}set wallType(t){this._wallType=t}get landscapeType(){return this._landscapeType}set landscapeType(t){this._landscapeType=t}}class Ap{constructor(t,e,s,i,n,o,l,c=NaN,u=-1,h=0,d=0,g="",E=!0,m=!0,I=-1){this._id=t,this._typeId=e,this._type=s,this._state=o,this._data=l,this._extra=c,this._expiryTime=u,this._usagePolicy=h,this._ownerId=d,this._ownerName=g,this._synchronized=E,this._realRoomObject=m,this._sizeZ=I,this._location=new j,this._direction=new j,this._location.assign(i),this._direction.assign(n)}set winReason(t){this._winReason=t}get winReason(){return this._winReason}set validRare(t){this._validRare=t}get validRare(){return this._validRare}set rareValue(t){this._rareValue=t}get rareValue(){return this._rareValue}get id(){return this._id}get typeId(){return this._typeId}get type(){return this._type}get location(){return this._location}get direction(){return this._direction}get state(){return this._state}get data(){return this._data}get extra(){return this._extra}get expiryTime(){return this._expiryTime}get usagePolicy(){return this._usagePolicy}get ownerId(){return this._ownerId}get ownerName(){return this._ownerName}get synchronized(){return this._synchronized}get realRoomObject(){return this._realRoomObject}get sizeZ(){return this._sizeZ}}class iq{constructor(t,e){this._tileObjectMap=new Map;let s=0;for(;s<e;)this._tileObjectMap.set(s,new Map),s++;this._width=t,this._height=e}clear(){for(const t of this._tileObjectMap.values())t&&t.clear();this._tileObjectMap.clear()}populate(t){this.clear();for(const e of t)this.addRoomObject(e)}dispose(){this._tileObjectMap=null,this._width=0,this._height=0}getObjectIntTile(t,e){if(t>=0&&t<this._width&&e>=0&&e<this._height){const s=this._tileObjectMap.get(e);if(s)return s.get(t)}return null}setObjectInTile(t,e,s){if(!s.isReady){dt.log("Assigning non initialized object to tile object map!");return}if(t>=0&&t<this._width&&e>=0&&e<this._height){const i=this._tileObjectMap.get(e);i&&i.set(t,s)}}addRoomObject(t){if(!t||!t.model||!t.isReady)return;const e=t.getLocation(),s=t.getDirection();if(!e||!s)return;let i=t.model.getValue(C.FURNITURE_SIZE_X),n=t.model.getValue(C.FURNITURE_SIZE_Y);i<1&&(i=1),n<1&&(n=1);const o=Math.trunc(s.x+45)%360/90;(o===1||o===3)&&([i,n]=[n,i]);let l=e.y;for(;l<e.y+n;){let c=e.x;for(;c<e.x+i;){const u=this.getObjectIntTile(c,l);(!u||u!==t&&u.getLocation().z<=e.z)&&this.setObjectInTile(c,l,t),c++}l++}}}class rq{constructor(t){this._roomId=t,this._modelName=null,this._legacyGeometry=new i_,this._tileObjectMap=null,this._roomCamera=new FR,this._selectedObject=null,this._placedObject=null,this._furnitureStackingHeightMap=null,this._floorStack=new Map,this._wallStack=new Map,this._mouseButtonCursorOwners=[]}dispose(){}setModelName(t){this._modelName=t}setSelectedObject(t){this._selectedObject&&this._selectedObject.dispose(),this._selectedObject=t}setPlacedObject(t){this._placedObject&&this._placedObject.dispose(),this._placedObject=t}setFurnitureStackingHeightMap(t){this._furnitureStackingHeightMap&&this._furnitureStackingHeightMap.dispose(),this._furnitureStackingHeightMap=t,this._tileObjectMap&&this._tileObjectMap.dispose(),this._furnitureStackingHeightMap&&(this._tileObjectMap=new iq(this._furnitureStackingHeightMap.width,this._furnitureStackingHeightMap.height))}addPendingFurnitureFloor(t){t&&(this._floorStack.delete(t.id),this._floorStack.set(t.id,t))}removePendingFunitureFloor(t){const e=this._floorStack.get(t);return e?(this._floorStack.delete(t),e):null}getPendingFurnitureFloor(t){const e=this._floorStack.get(t);return e?(this._floorStack.delete(t),e):null}getNextPendingFurnitureFloor(){if(!this._floorStack.size)return null;const t=this._floorStack.keys();return this.getPendingFurnitureFloor(t.next().value)}addPendingFurnitureWall(t){t&&(this._wallStack.delete(t.id),this._wallStack.set(t.id,t))}removePendingFurnitureWall(t){const e=this._wallStack.get(t);return e?(this._wallStack.delete(t),e):null}getPendingFurnitureWall(t){const e=this._wallStack.get(t);return e?(this._wallStack.delete(t),e):null}getNextPendingFurnitureWall(){if(!this._wallStack.size)return null;const t=this._wallStack.keys();return this.getPendingFurnitureWall(t.next().value)}addButtonMouseCursorOwner(t){return this._mouseButtonCursorOwners.indexOf(t)===-1?(this._mouseButtonCursorOwners.push(t),!0):!1}removeButtonMouseCursorOwner(t){const e=this._mouseButtonCursorOwners.indexOf(t);return e>-1?(this._mouseButtonCursorOwners.splice(e,1),!0):!1}hasButtonMouseCursorOwners(){return this._mouseButtonCursorOwners.length>0}get roomId(){return this._roomId}get modelName(){return this._modelName}get legacyGeometry(){return this._legacyGeometry}get tileObjectMap(){return this._tileObjectMap}get roomCamera(){return this._roomCamera}get selectedObject(){return this._selectedObject}get placedObject(){return this._placedObject}get furnitureStackingHeightMap(){return this._furnitureStackingHeightMap}}class nq{constructor(t,e){this._object=t,this._groupBadge=e}get object(){return this._object}get groupBadge(){return this._groupBadge}}class Np{constructor(t,e,s,i,n,o=0,l=null,c=null,u=-1,h=-1,d=null){this._id=0,this._category=0,this._operation="",this._loc=null,this._dir=null,this._typeId=0,this._instanceData=null,this._stuffData=null,this._state=-1,this._animFrame=-1,this._posture=null,this._id=t,this._category=e,this._operation=s,this._loc=new j,this._loc.assign(i),this._dir=new j,this._dir.assign(n),this._typeId=o,this._instanceData=l,this._stuffData=c,this._state=u,this._animFrame=h,this._posture=d}get id(){return this._id}get category(){return this._category}get operation(){return this._operation}get loc(){return this._loc}get dir(){return this._dir}get typeId(){return this._typeId}get instanceData(){return this._instanceData}get stuffData(){return this._stuffData}get state(){return this._state}get animFrame(){return this._animFrame}get posture(){return this._posture}dispose(){this._loc=null,this._dir=null}}const Qi=class Qi{constructor(){this.spriteCount=0,this.externalImageCount=0}static addMannequinSprites(t,e){const s=[];for(const i of t)if(i)if(i.type==="boutique_mannequin1"&&i.name.indexOf("mannequin_")===0){const n=e.getRoomObject(e.activeRoomId,i.objectId,W.FLOOR);if(n){const o=n.visualization.getSpriteList();if(o)for(const l of o)l.x=l.x+(i.x+i.width/2+Qi.MANNEQUIN_MAGIC_X_OFFSET),l.y=l.y+(i.y+i.height+Qi.MANNEQUIN_MAGIC_Y_OFFSET),l.z=l.z+i.z,s.push(l)}}else s.push(i);return s}static sortSpriteDataObjects(t,e){return t.z<e.z?1:(t.z>e.z,-1)}static isSpriteInViewPort(t,e,s){return!0}static sortQuadPoints(t,e,s,i){const n=[];if(t.x==e.x?n.push(t,s,e,i):t.x==s.x?n.push(t,e,s,i):e.x<t.x&&e.y>t.y||e.x>t.x&&e.y<t.y?n.push(t,s,e,i):n.push(t,e,s,i),n[0].x<n[1].x){let o=n[0];n[0]=n[1],n[1]=o,o=n[2],n[2]=n[3],n[3]=o}if(n[0].y<n[2].y){let o=n[0];n[0]=n[2],n[2]=o,o=n[1],n[1]=n[3],n[3]=o}return n}getFurniData(t,e,s,i){const n=[];let o=e.getSortableSpriteList();const l=s.getRoomObjects(s.activeRoomId,W.UNIT);for(const c of l)if(c.id!==i){const u=c.visualization.getSpriteList();if(u){let h=0,d=0;for(const E of o)if(E.name==="avatar_"+c.id){h=E.z,d=E.y+E.height-e.geometry.scale/4;break}const g=s.getRoomObjectScreenLocation(s.activeRoomId,c.id,W.UNIT,e.id);if(g){d===0&&(d=g.y);for(const E of u)E.x=E.x+(g.x-e.screenOffsetX),E.y=E.y+d,E.z=E.z+h,(E.name.indexOf("h_std_fx29_")===0||E.name.indexOf("h_std_fx185_")===0)&&(E.y=E.y+Qi.AVATAR_WATER_EFFECT_MAGIC_Y_OFFSET),o.push(E)}}}o=Qi.addMannequinSprites(o,s),o.sort(Qi.sortSpriteDataObjects);for(const c of o)c.name!==null&&c.name.length>0&&c.name.indexOf("tile_cursor_")!==0&&Qi.isSpriteInViewPort(c,t,e)&&(i<0||c.objectId!=i)&&(n.push(this.getSpriteDataObject(c,t,e,s)),this.maxZ||(this.maxZ=c.z),this.spriteCount++);return JSON.stringify(n)}getRoomRenderingModifiers(t){return JSON.stringify(new Object)}getSpriteDataObject(t,e,s,i){let n=[];const o={};let l=t.name;return t.name.indexOf("@")!==-1&&(n=t.name.split("@"),l=n[0],n[1]),o.name=l,o.x=t.x-e.x,o.y=t.y-e.y,o.x=o.x+s.screenOffsetX,o.y=o.y+s.screenOffsetY,o.z=t.z,t.alpha&&t.alpha.toString()!=="255"&&(o.alpha=t.alpha),t.flipH&&(o.flipH=t.flipH),t.skew&&(o.skew=t.skew),t.frame&&(o.frame=t.frame),t.color&&t.color.length>0&&(o.color=parseInt(t.color)),t.blendMode&&t.blendMode!=="normal"&&(o.blendMode=t.blendMode),l.indexOf("http")===0&&(o.width=t.width,o.height=t.height,this.externalImageCount++,this.externalImageCount>Qi.MAX_EXTERNAL_IMAGE_COUNT&&(o.name="box")),t.posture&&(o.posture=t.posture),o}makeBackgroundPlane(t,e,s){const i=new wt(0,0),n=new wt(t.width,0),o=new wt(0,t.height),l=new wt(t.width,t.height),c=Qi.sortQuadPoints(i,n,o,l);let u=0;s.length>0?(u=s[0].z,this.maxZ&&(u=Math.max(this.maxZ,u))):u=this.maxZ?this.maxZ:0,u=u+(this.spriteCount*1.776104+s.length*2.31743);const h=new Nh(null,e);return h.cornerPoints=c,h.z=u,h}sortRoomPlanes(t,e,s){const i=new Map;let n=1;this.maxZ&&(n=n+this.maxZ);for(const c of t){const u={plane:c,z:n};i.set(c.uniqueId,u)}const o=e.getPlaneSortableSprites();o.sort((c,u)=>u.z-c.z),o.reverse();let l=[];for(const c of o){const u=c.sprite;if(u){const h=i.get(u.id);h&&(i.delete(u.id),h.z=c.z,l.push(h))}}return l=l.concat(Array.from(i.values())),l}getRoomPlanes(t,e,s,i){const n=[],l=s.getRoomObject(s.activeRoomId,r_.ROOM_OBJECT_ID,W.ROOM).visualization;if(l){const c=e.geometry,u=this.sortRoomPlanes(l.planes,e,s),h=ws.instance.stage;for(const d of u){const g=d.plane,E=[],m=j.sum(g.location,g.leftSide),I=c.getScreenPoint(g.location),p=c.getScreenPoint(m),T=c.getScreenPoint(j.sum(g.location,g.rightSide)),R=c.getScreenPoint(j.sum(m,g.rightSide));E.push(I,p,T,R);let S=0,b=0;for(const N of E)N.x+=h.width/2,N.y+=h.height/2,N.x+=e.screenOffsetX,N.y+=e.screenOffsetY,N.x+=-t.x,N.y+=-t.y,N.x<0?S--:N.x>=t.width&&S++,N.y<0?b--:N.y>=t.height&&b++;if(!(Math.abs(S)===4||Math.abs(b)===4)){const N=Qi.sortQuadPoints(I,p,T,R);for(const P of g.getDrawingDatas(c))P.cornerPoints=N,P.z=d.z,n.push(P)}}n.unshift(this.makeBackgroundPlane(t,i,n))}return n}};Qi.MANNEQUIN_MAGIC_X_OFFSET=1,Qi.MANNEQUIN_MAGIC_Y_OFFSET=-16,Qi.AVATAR_WATER_EFFECT_MAGIC_Y_OFFSET=-52,Qi.MAX_EXTERNAL_IMAGE_COUNT=30;let GR=Qi;class aq extends Ar{constructor(t){super(),this._connection=null,this._roomCreator=t,this._planeParser=new Ws,this._latestEntryTileEvent=null,this._currentRoomId=0,this._ownUserId=0,this._initialConnection=!0,this._guideId=-1,this._requesterId=-1}onDispose(){super.onDispose(),this._connection=null,this._roomCreator=null,this._latestEntryTileEvent=null,this._planeParser&&(this._planeParser.dispose(),this._planeParser=null)}setConnection(t){this._connection||!t||(this._connection=t,this._connection.addMessageEvent(new lh(this.onUserInfoEvent.bind(this))),this._connection.addMessageEvent(new oh(this.onRoomReadyMessageEvent.bind(this))),this._connection.addMessageEvent(new RT(this.onRoomPaintEvent.bind(this))),this._connection.addMessageEvent(new Xg(this.onRoomModelEvent.bind(this))),this._connection.addMessageEvent(new IT(this.onRoomHeightMapEvent.bind(this))),this._connection.addMessageEvent(new TT(this.onRoomHeightMapUpdateEvent.bind(this))),this._connection.addMessageEvent(new Qg(this.onRoomThicknessEvent.bind(this))),this._connection.addMessageEvent(new qg(this.onRoomDoorEvent.bind(this))),this._connection.addMessageEvent(new nT(this.onRoomRollingEvent.bind(this))),this._connection.addMessageEvent(new rT(this.onObjectsDataUpdateEvent.bind(this))),this._connection.addMessageEvent(new hT(this.onFurnitureAliasesEvent.bind(this))),this._connection.addMessageEvent(new oT(this.onFurnitureFloorAddEvent.bind(this))),this._connection.addMessageEvent(new lT(this.onFurnitureFloorEvent.bind(this))),this._connection.addMessageEvent(new cT(this.onFurnitureFloorRemoveEvent.bind(this))),this._connection.addMessageEvent(new uT(this.onFurnitureFloorUpdateEvent.bind(this))),this._connection.addMessageEvent(new fT(this.onFurnitureWallAddEvent.bind(this))),this._connection.addMessageEvent(new mT(this.onFurnitureWallEvent.bind(this))),this._connection.addMessageEvent(new ET(this.onFurnitureWallRemoveEvent.bind(this))),this._connection.addMessageEvent(new pT(this.onFurnitureWallUpdateEvent.bind(this))),this._connection.addMessageEvent(new dT(this.onFurnitureDataEvent.bind(this))),this._connection.addMessageEvent(new _T(this.onItemDataUpdateMessageEvent.bind(this))),this._connection.addMessageEvent(new gT(this.onOneWayDoorStatusMessageEvent.bind(this))),this._connection.addMessageEvent(new tf(this.onRoomUnitDanceEvent.bind(this))),this._connection.addMessageEvent(new OT(this.onRoomUnitEffectEvent.bind(this))),this._connection.addMessageEvent(new ef(this.onRoomUnitEvent.bind(this))),this._connection.addMessageEvent(new CT(this.onRoomUnitExpressionEvent.bind(this))),this._connection.addMessageEvent(new AT(this.onRoomUnitHandItemEvent.bind(this))),this._connection.addMessageEvent(new NT(this.onRoomUnitIdleEvent.bind(this))),this._connection.addMessageEvent(new sf(this.onRoomUnitInfoEvent.bind(this))),this._connection.addMessageEvent(new xT(this.onRoomUnitNumberEvent.bind(this))),this._connection.addMessageEvent(new rf(this.onRoomUnitRemoveEvent.bind(this))),this._connection.addMessageEvent(new MT(this.onRoomUnitStatusEvent.bind(this))),this._connection.addMessageEvent(new WS(this.onRoomUnitChatEvent.bind(this))),this._connection.addMessageEvent(new $g(this.onRoomUnitChatEvent.bind(this))),this._connection.addMessageEvent(new Zg(this.onRoomUnitChatEvent.bind(this))),this._connection.addMessageEvent(new ST(this.onRoomUnitTypingEvent.bind(this))),this._connection.addMessageEvent(new Jg(this.onPetFigureUpdateEvent.bind(this))),this._connection.addMessageEvent(new ND(this.onPetExperienceEvent.bind(this))),this._connection.addMessageEvent(new yD(this.onYouArePlayingGameEvent.bind(this))),this._connection.addMessageEvent(new aT(this.onDiceValueMessageEvent.bind(this))),this._connection.addMessageEvent(new qS(this.onIgnoreResultEvent.bind(this))),this._connection.addMessageEvent(new jS(this.onGuideSessionStartedMessageEvent.bind(this))),this._connection.addMessageEvent(new PS(this.onGuideSessionEndedMessageEvent.bind(this))),this._connection.addMessageEvent(new US(this.onGuideSessionErrorMessageEvent.bind(this))))}setRoomId(t){this._currentRoomId!==0&&this._roomCreator&&this._roomCreator.destroyRoom(this._currentRoomId),this._currentRoomId=t,this._latestEntryTileEvent=null}clearRoomId(){this._currentRoomId=0,this._latestEntryTileEvent=null}onUserInfoEvent(t){if(!(t instanceof lh)||!t.connection)return;const e=t.getParser();e&&(this._ownUserId=e.userInfo.userId)}onRoomReadyMessageEvent(t){const e=t.getParser();if(this._currentRoomId!==e.roomId&&this.setRoomId(e.roomId),this._roomCreator&&this._roomCreator.setRoomInstanceModelName(e.roomId,e.name),this._initialConnection){t.connection.send(new mP),this._initialConnection=!1;return}t.connection.send(new KT)}onRoomPaintEvent(t){if(!(t instanceof RT))return;const e=t.getParser();if(!e)return;const s=e.floorType,i=e.wallType,n=e.landscapeType;this._roomCreator&&this._roomCreator.updateRoomInstancePlaneType(this._currentRoomId,s,i,n)}onRoomModelEvent(t){if(!(t instanceof Xg)||!t.connection||!this._roomCreator)return;const e=t.getParser();if(!e)return;const s=this._roomCreator.getLegacyWallGeometry(this._currentRoomId);if(!s)return;this._planeParser.reset();const i=e.width,n=e.height;this._planeParser.initializeTileMap(i,n);let o=null;this._latestEntryTileEvent&&(o=this._latestEntryTileEvent.getParser());let l=-1,c=-1,u=0,h=0,d=0;for(;d<n;){let m=0;for(;m<i;){const I=e.getHeight(m,d);(d>0&&d<n-1||m>0&&m<i-1)&&I!=Ws.TILE_BLOCKED&&(o==null||m==o.x&&d==o.y)&&(e.getHeight(m,d-1)==Ws.TILE_BLOCKED&&e.getHeight(m-1,d)==Ws.TILE_BLOCKED&&e.getHeight(m,d+1)==Ws.TILE_BLOCKED&&(l=m+.5,c=d,u=I,h=90),e.getHeight(m,d-1)==Ws.TILE_BLOCKED&&e.getHeight(m-1,d)==Ws.TILE_BLOCKED&&e.getHeight(m+1,d)==Ws.TILE_BLOCKED&&(l=m,c=d+.5,u=I,h=180)),this._planeParser.setTileHeight(m,d,I),m++}d++}this._planeParser.setTileHeight(Math.floor(l),Math.floor(c),u),this._planeParser.initializeFromTileData(e.wallHeight),this._planeParser.setTileHeight(Math.floor(l),Math.floor(c),u+this._planeParser.wallHeight),e.scale===64?(this._planeParser.restrictsDragging=!0,this._planeParser.restrictsScaling=!0,this._planeParser.restrictedScale=.5):(this._planeParser.restrictsDragging=!1,this._planeParser.restrictsScaling=!1,this._planeParser.restrictedScale=1),s.scale=i_.DEFAULT_SCALE,s.initialize(i,n,this._planeParser.floorHeight);let g=e.height-1;for(;g>=0;){let m=e.width-1;for(;m>=0;)s.setHeight(m,g,this._planeParser.getTileHeight(m,g)),m--;g--}const E=this._planeParser.getMapData();E.doors.push({x:l,y:c,z:u,dir:h}),this._roomCreator.createRoomInstance(this._currentRoomId,E)}onRoomHeightMapEvent(t){if(!(t instanceof IT)||!t.connection||!this._roomCreator)return;const e=t.getParser();if(!e)return;const s=e.width,i=e.height,n=new sq(s,i);let o=0;for(;o<i;){let l=0;for(;l<s;)n.setTileHeight(l,o,e.getTileHeight(l,o)),n.setStackingBlocked(l,o,e.getStackingBlocked(l,o)),n.setIsRoomTile(l,o,e.isRoomTile(l,o)),l++;o++}this._roomCreator.setFurnitureStackingHeightMap(this._currentRoomId,n)}onRoomHeightMapUpdateEvent(t){if(!(t instanceof TT)||!t.connection||!this._roomCreator)return;const e=t.getParser();if(!e)return;const s=this._roomCreator.getFurnitureStackingHeightMap(this._currentRoomId);if(s){for(;e.next();)s.setTileHeight(e.x,e.y,e.tileHeight()),s.setStackingBlocked(e.x,e.y,e.isStackingBlocked()),s.setIsRoomTile(e.x,e.y,e.isRoomTile());this._roomCreator.refreshTileObjectMap(this._currentRoomId,"RoomMessageHandler.onRoomHeightMapUpdateEvent()")}}onRoomThicknessEvent(t){if(!(t instanceof Qg))return;const e=t.getParser();if(!e)return;const s=!e.hideWalls,i=!0,n=e.thicknessWall,o=e.thicknessFloor;this._roomCreator&&(this._roomCreator.updateRoomInstancePlaneVisibility(this._currentRoomId,s,i),this._roomCreator.updateRoomInstancePlaneThickness(this._currentRoomId,n,o))}onRoomDoorEvent(t){t instanceof qg&&(this._latestEntryTileEvent=t)}onRoomRollingEvent(t){if(!(t instanceof nT)||!t.connection||!this._roomCreator)return;const e=t.getParser();this._roomCreator.updateRoomObjectFloor(this._currentRoomId,e.rollerId,null,null,1,null),this._roomCreator.updateRoomObjectFloor(this._currentRoomId,e.rollerId,null,null,2,null);const s=e.itemsRolling;if(s&&s.length)for(const n of s)n&&this._roomCreator.rollRoomObjectFloor(this._currentRoomId,n.id,n.location,n.targetLocation);const i=e.unitRolling;if(i){this._roomCreator.updateRoomObjectUserLocation(this._currentRoomId,i.id,i.location,i.targetLocation);const n=this._roomCreator.getRoomObjectUser(this._currentRoomId,i.id);if(n&&n.type!==me.MONSTER_PLANT){let o="std";switch(i.movementType){case ao.MOVE:o="mv";break;case ao.SLIDE:o="std";break}this._roomCreator.updateRoomObjectUserPosture(this._currentRoomId,i.id,o)}}}onObjectsDataUpdateEvent(t){if(!(t instanceof rT)||!t.connection||!this._roomCreator)return;const e=t.getParser();if(e)for(const s of e.objects)this._roomCreator.updateRoomObjectFloor(this._currentRoomId,s.id,null,null,s.state,s.data)}onFurnitureAliasesEvent(t){!(t instanceof hT)||!t.connection||!this._roomCreator||(t.getParser().aliases,this._connection.send(new KT))}onFurnitureFloorAddEvent(t){if(!(t instanceof oT)||!t.connection||!this._roomCreator)return;const e=t.getParser().item;e&&this.addRoomObjectFurnitureFloor(this._currentRoomId,e)}onFurnitureFloorEvent(t){if(!(t instanceof lT)||!t.connection||!this._roomCreator)return;const e=t.getParser();if(!e)return;const s=e.items.length;let i=0;for(;i<s;){const n=e.items[i];n&&this.addRoomObjectFurnitureFloor(this._currentRoomId,n),i++}}onFurnitureFloorRemoveEvent(t){if(!(t instanceof cT)||!t.connection||!this._roomCreator)return;const e=t.getParser();e&&(e.delay>0?setTimeout(()=>{this._roomCreator.removeRoomObjectFloor(this._currentRoomId,e.itemId,e.isExpired?-1:e.userId,!0)},e.delay):this._roomCreator.removeRoomObjectFloor(this._currentRoomId,e.itemId,e.isExpired?-1:e.userId,!0))}onFurnitureFloorUpdateEvent(t){if(!(t instanceof uT)||!t.connection||!this._roomCreator)return;const e=t.getParser().item;if(!e)return;const s=new j(e.x,e.y,e.z),i=new j(e.direction);this._roomCreator.updateRoomObjectFloor(this._currentRoomId,e.itemId,s,i,e.data.state,e.data,e.extra),this._roomCreator.updateRoomObjectFloorHeight(this._currentRoomId,e.itemId,e.stackHeight),this._roomCreator.updateRoomObjectFloorExpiration(this._currentRoomId,e.itemId,e.expires)}onFurnitureWallAddEvent(t){if(!(t instanceof fT)||!t.connection||!this._roomCreator)return;const e=t.getParser().item;e&&this.addRoomObjectFurnitureWall(this._currentRoomId,e)}onFurnitureWallEvent(t){if(!(t instanceof mT)||!t.connection||!this._roomCreator)return;const e=t.getParser();if(!e)return;const s=e.items.length;let i=0;for(;i<s;){const n=e.items[i];n&&this.addRoomObjectFurnitureWall(this._currentRoomId,n),i++}}onFurnitureWallRemoveEvent(t){if(!(t instanceof ET)||!t.connection||!this._roomCreator)return;const e=t.getParser();e&&this._roomCreator.removeRoomObjectWall(this._currentRoomId,e.itemId,e.userId)}onFurnitureWallUpdateEvent(t){if(!(t instanceof pT)||!t.connection||!this._roomCreator)return;const e=this._roomCreator.getLegacyWallGeometry(this._currentRoomId);if(!e)return;const s=t.getParser().item;if(!s)return;const i=e.getLocation(s.width,s.height,s.localX,s.localY,s.direction),n=new j(e.getDirection(s.direction));this._roomCreator.updateRoomObjectWall(this._currentRoomId,s.itemId,i,n,s.state,s.stuffData,s.data),this._roomCreator.updateRoomObjectWallExpiration(this._currentRoomId,s.itemId,s.secondsToExpiration)}onFurnitureDataEvent(t){if(!(t instanceof dT)||!t.connection||!this._roomCreator)return;const e=t.getParser();this._roomCreator.updateRoomObjectFloor(this._currentRoomId,e.furnitureId,null,null,e.objectData.state,e.objectData)}onItemDataUpdateMessageEvent(t){if(!(t instanceof _T)||!t.connection||!this._roomCreator)return;const e=t.getParser();this._roomCreator.updateRoomObjectWallItemData(this._currentRoomId,e.furnitureId,e.data)}onOneWayDoorStatusMessageEvent(t){if(!(t instanceof gT)||!t.connection||!this._roomCreator)return;const e=t.getParser();this._roomCreator.updateRoomObjectFloor(this._currentRoomId,e.itemId,null,null,e.state,new wi)}onDiceValueMessageEvent(t){if(!(t instanceof aT)||!t.connection||!this._roomCreator)return;const e=t.getParser();this._roomCreator.updateRoomObjectFloor(this._currentRoomId,e.itemId,null,null,e.value,new wi)}onRoomUnitDanceEvent(t){!(t instanceof tf)||!t.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,t.getParser().unitId,C.FIGURE_DANCE,t.getParser().danceId)}onRoomUnitEffectEvent(t){!(t instanceof OT)||!t.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserEffect(this._currentRoomId,t.getParser().unitId,t.getParser().effectId,t.getParser().delay)}onRoomUnitEvent(t){if(!(t instanceof ef)||!t.connection||!this._roomCreator)return;const e=t.getParser().users;if(!(!e||!e.length)){for(const s of e){if(!s)continue;const i=new j(s.x,s.y,s.z),n=new j(s.dir);this._roomCreator.addRoomObjectUser(this._currentRoomId,s.roomIndex,i,n,s.dir,s.userType,s.figure),s.webID===this._ownUserId&&(this._roomCreator.setRoomSessionOwnUser(this._currentRoomId,s.roomIndex),this._roomCreator.updateRoomObjectUserOwn(this._currentRoomId,s.roomIndex)),this._roomCreator.updateRoomObjectUserFigure(this._currentRoomId,s.roomIndex,s.figure,s.sex,s.subType,s.isRiding),me.getTypeString(s.userType)===me.PET&&this._roomCreator.getPetTypeId(s.figure)===xs.MONSTERPLANT&&this._roomCreator.updateRoomObjectUserPosture(this._currentRoomId,s.roomIndex,s.petPosture),this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,s.roomIndex,C.FIGURE_IS_MUTED,this._roomCreator.sessionDataManager.isUserIgnored(s.name)?1:0)}this.updateGuideMarker()}}onRoomUnitExpressionEvent(t){!(t instanceof CT)||!t.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,t.getParser().unitId,C.FIGURE_EXPRESSION,t.getParser().expression)}onRoomUnitHandItemEvent(t){!(t instanceof AT)||!t.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,t.getParser().unitId,C.FIGURE_CARRY_OBJECT,t.getParser().handId)}onRoomUnitIdleEvent(t){!(t instanceof NT)||!t.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,t.getParser().unitId,C.FIGURE_SLEEP,t.getParser().isIdle?1:0)}onRoomUnitInfoEvent(t){!(t instanceof sf)||!t.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserFigure(this._currentRoomId,t.getParser().unitId,t.getParser().figure,t.getParser().gender)}onRoomUnitNumberEvent(t){if(!(t instanceof xT)||!t.connection||!this._roomCreator)return;const e=t.getParser();e&&this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,e.unitId,C.FIGURE_NUMBER_VALUE,e.value)}onRoomUnitRemoveEvent(t){!(t instanceof rf)||!t.connection||!this._roomCreator||(this._roomCreator.removeRoomObjectUser(this._currentRoomId,t.getParser().unitId),this.updateGuideMarker())}onRoomUnitStatusEvent(t){if(!(t instanceof MT)||!t.connection||!this._roomCreator)return;const e=t.getParser().statuses;if(!e||!e.length)return;const s=this._roomCreator.getRoomInstance(this._currentRoomId);if(!s)return;const i=s.model.getValue(cs.ROOM_Z_SCALE)||1;for(const n of e){if(!n)continue;let o=n.height;o&&(o=o/i);const l=new j(n.x,n.y,n.z+o),c=new j(n.direction);let u=null;n.didMove&&(u=new j(n.targetX,n.targetY,n.targetZ)),this._roomCreator.updateRoomObjectUserLocation(this._currentRoomId,n.id,l,u,n.canStandUp,o,c,n.headDirection),this._roomCreator.updateRoomObjectUserFlatControl(this._currentRoomId,n.id,null);let h=!0,d=!1,g=C.STD,E="";if(n.actions&&n.actions.length){for(const m of n.actions)if(m)switch(m.action){case"flatctrl":this._roomCreator.updateRoomObjectUserFlatControl(this._currentRoomId,n.id,m.value);break;case"sign":n.actions.length===1&&(h=!1),this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,n.id,C.FIGURE_SIGN,parseInt(m.value));break;case"gst":n.actions.length===1&&(h=!1),this._roomCreator.updateRoomObjectUserPetGesture(this._currentRoomId,n.id,m.value);break;case"wav":case"mv":d=!0,g=m.action,E=m.value;break;case"trd":break;default:d=!0,g=m.action,E=m.value;break}}d?this._roomCreator.updateRoomObjectUserPosture(this._currentRoomId,n.id,g,E):h&&this._roomCreator.updateRoomObjectUserPosture(this._currentRoomId,n.id,C.STD,"")}this.updateGuideMarker()}onRoomUnitChatEvent(t){if(!t.connection||!this._roomCreator)return;const e=t.getParser();e&&(this._roomCreator.updateRoomObjectUserGesture(this._currentRoomId,e.roomIndex,e.gesture),this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,e.roomIndex,C.FIGURE_TALK,e.message.length/10))}onRoomUnitTypingEvent(t){!(t instanceof ST)||!t.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,t.getParser().unitId,C.FIGURE_IS_TYPING,t.getParser().isTyping?1:0)}onPetFigureUpdateEvent(t){if(!(t instanceof Jg)||!t.connection||!this._roomCreator)return;const e=t.getParser();e&&this._roomCreator.updateRoomObjectUserFigure(this._currentRoomId,e.roomIndex,e.figureData.figuredata,"","",e.isRiding)}onPetExperienceEvent(t){const e=t.getParser();e&&this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,e.roomIndex,C.FIGURE_GAINED_EXPERIENCE,e.gainedExperience)}onYouArePlayingGameEvent(t){if(!t)return;const e=t.getParser();e&&this._roomCreator.setRoomEngineGameMode(this._currentRoomId,e.isPlaying)}addRoomObjectFurnitureFloor(t,e){if(!e||!this._roomCreator)return;const s=new j(e.x,e.y,e.z),i=new j(e.direction);e.spriteName?this._roomCreator.addFurnitureFloorByTypeName(t,e.itemId,e.spriteName,s,i,e.state,e.data,e.extra,e.expires,e.usagePolicy,e.userId,e.username,!0,!0,e.stackHeight,e.rareValue,e.validRare,e.winReason):this._roomCreator.addFurnitureFloor(t,e.itemId,e.spriteId,s,i,e.state,e.data,e.extra,e.expires,e.usagePolicy,e.userId,e.username,!0,!0,e.stackHeight,e.rareValue,e.validRare,e.winReason)}addRoomObjectFurnitureWall(t,e){if(!e||!this._roomCreator)return;const s=this._roomCreator.getLegacyWallGeometry(t);if(!s)return;let i=null;e.isOldFormat||(i=s.getLocation(e.width,e.height,e.localX,e.localY,e.direction));const n=new j(s.getDirection(e.direction));this._roomCreator.addFurnitureWall(t,e.itemId,e.spriteId,i,n,e.state,e.stuffData,e.secondsToExpiration,e.usagePolicy,e.userId,e.username,!0,e.rareValue,e.validRare,e.winReason,e.data)}onIgnoreResultEvent(t){if(!t)return;const e=t.getParser();if(!e)return;const s=this._roomCreator.roomSessionManager.getSession(this._currentRoomId);if(!s)return;const i=s.userDataManager.getUserDataByName(e.name);if(i)switch(e.result){case 1:case 2:this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,i.roomIndex,C.FIGURE_IS_MUTED,1);return;case 3:this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,i.roomIndex,C.FIGURE_IS_MUTED,0);return}}onGuideSessionStartedMessageEvent(t){const e=t.getParser();this._guideId=e.guideUserId,this._requesterId=e.requesterUserId,this.updateGuideMarker()}onGuideSessionEndedMessageEvent(t){this.removeGuideMarker()}onGuideSessionErrorMessageEvent(t){this.removeGuideMarker()}updateGuideMarker(){const t=this._roomCreator.sessionDataManager.userId;this.setUserGuideStatus(this._guideId,this._requesterId===t?Ia.GUIDE:Ia.NONE),this.setUserGuideStatus(this._requesterId,this._guideId===t?Ia.REQUESTER:Ia.NONE)}removeGuideMarker(){this.setUserGuideStatus(this._guideId,Ia.NONE),this.setUserGuideStatus(this._requesterId,Ia.NONE),this._guideId=-1,this._requesterId=-1}setUserGuideStatus(t,e){if(!this._roomCreator||!this._roomCreator.roomSessionManager)return;const s=this._roomCreator.roomSessionManager.getSession(this._currentRoomId);if(!s)return;const i=s.userDataManager.getDataByType(t,be.USER);i&&this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,i.roomIndex,C.FIGURE_GUIDE_STATUS,e)}get currentRoomId(){return this._currentRoomId}}class oq extends Ar{constructor(t){super(),this._roomEngine=t,this._eventIds=new Map,this._selectedAvatarId=-1,this._selectedObjectId=-1,this._selectedObjectCategory=-2,this._whereYouClickIsWhereYouGo=!0,this._objectPlacementSource=null,this.onRoomEngineObjectEvent=this.onRoomEngineObjectEvent.bind(this),this._roomEngine.events.addEventListener(Rt.ADDED,this.onRoomEngineObjectEvent)}dispose(){this._eventIds&&(this._eventIds=null),this._roomEngine.events.removeEventListener(Rt.ADDED,this.onRoomEngineObjectEvent),this._roomEngine=null}onRoomEngineObjectEvent(t){let e=this.getSelectedRoomObjectData(t.roomId);if(e&&e.operation===Ft.OBJECT_PLACE&&e.id===t.objectId){const s=this._roomEngine.getRoomObject(t.roomId,e.id,e.category);if(s&&s.model&&e.category===W.FLOOR){const i=s.model.getValue(C.FURNITURE_ALLOWED_DIRECTIONS);if(i&&i.length){const n=new j(i[0]);if(s.setDirection(n),this.updateSelectedObjectData(t.roomId,e.id,e.category,e.loc,n,e.operation,e.typeId,e.instanceData,e.stuffData,e.state,e.animFrame,e.posture),e=this.getSelectedRoomObjectData(t.roomId),!e)return}}this.setFurnitureAlphaMultiplier(s,.5)}}processRoomCanvasMouseEvent(t,e,s){if(!t||!e||Br.isRunning())return;const i=e.type;let n=this._roomEngine.getRoomObjectCategoryForType(i);if(n!==W.ROOM&&(!this._roomEngine.isPlayingGame()||n!==W.UNIT)&&(n=W.MINIMUM),this.getMouseEventId(n,t.type)===t.eventId){if(t.type===at.MOUSE_CLICK||t.type===at.DOUBLE_CLICK||t.type===at.MOUSE_DOWN||t.type===at.MOUSE_UP||t.type===at.MOUSE_MOVE)return}else t.eventId&&this.setMouseEventId(n,t.type,t.eventId);e.mouseHandler&&e.mouseHandler.mouseEvent(t,s)}processRoomObjectPlacement(t,e,s,i,n,o=null,l=null,c=-1,u=-1,h=null){this._objectPlacementSource=t;const d=new j(-100,-100),g=new j(0);return this.setSelectedRoomObjectData(e,s,i,d,g,Ft.OBJECT_PLACE,n,o,l,c,u,h),this._roomEngine&&(this._roomEngine.setObjectMoverIconSprite(n,i,!1,o,l,c,u,h),this._roomEngine.setObjectMoverIconSpriteVisible(!1)),!0}cancelRoomObjectInsert(t){return this.resetSelectedObjectData(t),!0}getMouseEventId(t,e){const s=this._eventIds.get(t);return s&&s.get(e)||null}setMouseEventId(t,e,s){let i=this._eventIds.get(t);i||(i=new Map,this._eventIds.set(t,i)),i.delete(e),i.set(e,s)}handleRoomObjectEvent(t,e){if(t){if(t instanceof Gt){this.handleRoomObjectMouseEvent(t,e);return}switch(t.type){case _e.STATE_CHANGE:case _e.STATE_RANDOM:this.onRoomObjectStateChangedEvent(t,e);return;case mc.DIMMER_STATE:this.onRoomObjectDimmerStateUpdateEvent(t,e);return;case Ui.POSITION_CHANGED:case Ui.OBJECT_REMOVED:this.handleSelectedObjectRemove(t,e);return;case X.OPEN_WIDGET:case X.CLOSE_WIDGET:case X.OPEN_FURNI_CONTEXT_MENU:case X.CLOSE_FURNI_CONTEXT_MENU:case X.PLACEHOLDER:case X.CREDITFURNI:case X.STACK_HEIGHT:case X.EXTERNAL_IMAGE:case X.STICKIE:case X.PRESENT:case X.TROPHY:case X.TEASER:case X.ECOTRONBOX:case X.DIMMER:case X.WIDGET_REMOVE_DIMMER:case X.CLOTHING_CHANGE:case X.JUKEBOX_PLAYLIST_EDITOR:case X.MANNEQUIN:case X.PET_PRODUCT_MENU:case X.GUILD_FURNI_CONTEXT_MENU:case X.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG:case X.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG:case X.BACKGROUND_COLOR:case X.MYSTERYBOX_OPEN_DIALOG:case X.EFFECTBOX_OPEN_DIALOG:case X.MYSTERYTROPHY_OPEN_DIALOG:case X.ACHIEVEMENT_RESOLUTION_OPEN:case X.ACHIEVEMENT_RESOLUTION_ENGRAVING:case X.ACHIEVEMENT_RESOLUTION_FAILED:case X.FRIEND_FURNITURE_CONFIRM:case X.FRIEND_FURNITURE_ENGRAVING:case X.BADGE_DISPLAY_ENGRAVING:case X.HIGH_SCORE_DISPLAY:case X.HIDE_HIGH_SCORE_DISPLAY:case X.INERNAL_LINK:case X.ROOM_LINK:case X.YOUTUBE:this.onRoomObjectWidgetRequestEvent(t,e);return;case lt.DICE_ACTIVATE:case lt.DICE_OFF:case lt.USE_HABBOWHEEL:case lt.STICKIE:case lt.ENTER_ONEWAYDOOR:this.onRoomObjectFurnitureActionEvent(t,e);return;case lt.SOUND_MACHINE_INIT:case lt.SOUND_MACHINE_START:case lt.SOUND_MACHINE_STOP:case lt.SOUND_MACHINE_DISPOSE:this.handleObjectSoundMachineEvent(t,e);return;case lt.JUKEBOX_INIT:case lt.JUKEBOX_START:case lt.JUKEBOX_MACHINE_STOP:case lt.JUKEBOX_DISPOSE:this.handleObjectJukeboxEvent(t,e);return;case Mi.ADD_HOLE:case Mi.REMOVE_HOLE:this.onRoomObjectFloorHoleEvent(t,e);return;case Ze.ROOM_AD_FURNI_CLICK:case Ze.ROOM_AD_FURNI_DOUBLE_CLICK:case Ze.ROOM_AD_TOOLTIP_SHOW:case Ze.ROOM_AD_TOOLTIP_HIDE:case Ze.ROOM_AD_LOAD_IMAGE:this.onRoomObjectRoomAdEvent(t,e);return;case Gn.LOAD_BADGE:this.onRoomObjectBadgeAssetEvent(t,e);return;case lt.MOUSE_ARROW:case lt.MOUSE_BUTTON:this.handleMousePointer(t,e);return;case uo.PLAY_SOUND:case uo.PLAY_SOUND_AT_PITCH:this.handleRoomObjectPlaySoundEvent(t,e);return;case vs.ROOM_OBJECT_INITIALIZED:case vs.ROOM_OBJECT_DISPOSED:case vs.PLAY_SAMPLE:case vs.CHANGE_PITCH:this.handleRoomObjectSamplePlaybackEvent(t,e);return;case oo.ROOM_BACKGROUND_COLOR:this.onHSLColorEnableEvent(t,e);return;case gn.RODRE_CURRENT_USER_ID:case gn.RODRE_URL_PREFIX:this.onRoomObjectDataRequestEvent(t,e);return;default:dt.warn("Unhandled Event",t.constructor.name,"Object ID",t.object.id);return}}}handleRoomObjectMouseEvent(t,e){if(!(!t||!t.type))switch(t.type){case Gt.CLICK:this.handleRoomObjectMouseClickEvent(t,e);return;case Gt.DOUBLE_CLICK:this.handleRoomObjectMouseDoubleClickEvent(t,e);return;case Gt.MOUSE_MOVE:this.handleRoomObjectMouseMoveEvent(t,e);return;case Gt.MOUSE_DOWN:this.handleRoomObjectMouseDownEvent(t,e);return;case Gt.MOUSE_DOWN_LONG:this.handleRoomObjectMouseDownLongEvent(t,e);return;case Gt.MOUSE_ENTER:this.handleRoomObjectMouseEnterEvent(t,e);return;case Gt.MOUSE_LEAVE:this.handleRoomObjectMouseLeaveEvent(t,e);return}}handleRoomObjectMouseClickEvent(t,e){if(!t)return;let s=Ft.OBJECT_UNDEFINED;const i=this.getSelectedRoomObjectData(e);i&&(s=i.operation);let n=!1,o=!1;this._whereYouClickIsWhereYouGo&&(!s||s===Ft.OBJECT_UNDEFINED)&&(n=this.handleMoveTargetFurni(e,t));const l=this._roomEngine.getRoomObjectCategoryForType(t.objectType);switch(s){case Ft.OBJECT_MOVE:l===W.ROOM?i&&this.modifyRoomObject(e,i.id,i.category,Ft.OBJECT_MOVE_TO):l===W.UNIT&&(i&&t.objectType===me.MONSTER_PLANT&&this.modifyRoomObject(e,i.id,i.category,Ft.OBJECT_MOVE_TO),t.eventId&&this.setMouseEventId(W.ROOM,at.MOUSE_CLICK,t.eventId),this.placeObjectOnUser(e,t.objectId,l)),o=!0,t.objectId!==-1&&this.setSelectedObject(e,t.objectId,l);break;case Ft.OBJECT_PLACE:if(l===W.ROOM)this.placeObject(e,t instanceof Ha,t instanceof Xc);else if(l===W.UNIT)switch(t.objectType){case me.MONSTER_PLANT:case me.RENTABLE_BOT:this.placeObject(e,t instanceof Ha,t instanceof Xc);break;default:t.eventId&&this.setMouseEventId(W.ROOM,at.MOUSE_CLICK,t.eventId),this.placeObjectOnUser(e,t.objectId,l);break}break;case Ft.OBJECT_UNDEFINED:l===W.ROOM?!n&&t instanceof Ha&&this.onRoomObjectTileMouseEvent(e,t):(this.setSelectedObject(e,t.objectId,l),o=!1,l===W.UNIT?(t.ctrlKey&&!t.altKey&&!t.shiftKey&&t.objectType===me.RENTABLE_BOT?this.modifyRoomObject(e,t.objectId,l,Ft.OBJECT_PICKUP_BOT):t.ctrlKey&&!t.altKey&&!t.shiftKey&&t.objectType===me.MONSTER_PLANT?this.modifyRoomObject(e,t.objectId,l,Ft.OBJECT_PICKUP_PET):!t.ctrlKey&&!t.altKey&&t.shiftKey&&t.objectType===me.MONSTER_PLANT&&this.modifyRoomObject(e,t.objectId,l,Ft.OBJECT_ROTATE_POSITIVE),this._roomEngine.isPlayingGame()?o=!0:n=!0):(l===W.FLOOR||l===W.WALL)&&(t.altKey||t.ctrlKey||t.shiftKey)&&(!t.ctrlKey&&!t.altKey&&t.shiftKey?l===W.FLOOR&&this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new Rt(Rt.REQUEST_ROTATE,e,t.objectId,l)):t.ctrlKey&&!t.altKey&&!t.shiftKey&&this.modifyRoomObject(e,t.objectId,l,Ft.OBJECT_PICKUP),this._roomEngine.isPlayingGame()?o=!0:n=!0),t.eventId&&(n&&this.setMouseEventId(W.ROOM,at.MOUSE_CLICK,t.eventId),o&&this.setMouseEventId(W.MINIMUM,at.MOUSE_CLICK,t.eventId)));break}if(l===W.ROOM){const c=this.getMouseEventId(W.MINIMUM,at.MOUSE_CLICK),u=this.getMouseEventId(W.UNIT,at.MOUSE_CLICK);c!==t.eventId&&u!==t.eventId&&!o&&(this.deselectObject(e),this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new Rt(Rt.DESELECTED,e,-1,W.MINIMUM)),this.setSelectedAvatar(e,0,!1))}}handleRoomObjectMouseDoubleClickEvent(t,e){const s=t.objectId,i=t.objectType,n=this._roomEngine.getRoomObjectCategoryForType(i);this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new Rt(Rt.DOUBLE_CLICK,e,s,n))}handleRoomObjectMouseMoveEvent(t,e){if(!t)return;let s=Ft.OBJECT_UNDEFINED;const i=this.getSelectedRoomObjectData(e);i&&(s=i.operation);const n=this._roomEngine.getRoomObjectCategoryForType(t.objectType);if(this._roomEngine){const o=this._roomEngine.getRoomObjectCursor(e);if(o&&o.logic){let l=null;t instanceof Ha?l=this.handleMouseOverTile(t,e):t.object&&t.object.id!==-1?this._whereYouClickIsWhereYouGo&&(l=this.handleMouseOverObject(n,e,t)):l=new qc(null,0,!1,t.eventId),o.processUpdateMessage(l)}}switch(s){case Ft.OBJECT_MOVE:n===W.ROOM&&this.handleObjectMove(t,e);return;case Ft.OBJECT_PLACE:n===W.ROOM&&this.handleObjectPlace(t,e);return}}handleRoomObjectMouseDownEvent(t,e){if(!t)return;let s=Ft.OBJECT_UNDEFINED;const i=this.getSelectedRoomObjectData(e);i&&(s=i.operation);const n=this._roomEngine.getRoomObjectCategoryForType(t.objectType);switch(s){case Ft.OBJECT_UNDEFINED:(n===W.FLOOR||n===W.WALL||t.objectType===me.MONSTER_PLANT)&&(t.altKey&&!t.ctrlKey&&!t.shiftKey||this.decorateModeMove(t))&&this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new Rt(Rt.REQUEST_MOVE,e,t.objectId,n));return}}handleRoomObjectMouseDownLongEvent(t,e){if(!t)return;let s=Ft.OBJECT_UNDEFINED;const i=this.getSelectedRoomObjectData(e);i&&(s=i.operation);const n=this._roomEngine.getRoomObjectCategoryForType(t.objectType);switch(s){case Ft.OBJECT_UNDEFINED:(n===W.FLOOR||n===W.WALL||t.objectType===me.MONSTER_PLANT)&&(!t.ctrlKey&&!t.shiftKey||this.decorateModeMove(t))&&this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new Rt(Rt.REQUEST_MANIPULATION,e,t.objectId,n));return}}handleRoomObjectMouseEnterEvent(t,e){const s=t.objectId,i=t.objectType,n=this._roomEngine.getRoomObjectCategoryForType(i);this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new Rt(Rt.MOUSE_ENTER,e,s,n))}handleRoomObjectMouseLeaveEvent(t,e){const s=t.objectId,i=t.objectType,n=this._roomEngine.getRoomObjectCategoryForType(i);if(n!==W.ROOM&&n===W.UNIT){const o=this._roomEngine.getRoomObjectCursor(e);o&&o.processUpdateMessage(new je(0,null))}this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new Rt(Rt.MOUSE_LEAVE,e,s,n))}onRoomObjectStateChangedEvent(t,e){if(t)switch(t.type){case _e.STATE_CHANGE:this.changeObjectState(e,t.object.id,t.object.type,t.state,!1);return;case _e.STATE_RANDOM:this.changeObjectState(e,t.object.id,t.object.type,t.state,!0);return}}onRoomObjectDimmerStateUpdateEvent(t,e){if(t)switch(t.type){case mc.DIMMER_STATE:this._roomEngine.events.dispatchEvent(new Tg(e,t.state,t.presetId,t.effectId,t.color,t.brightness));return}}handleSelectedObjectRemove(t,e){if(!(!t||!this._roomEngine))switch(t.type){case Ui.POSITION_CHANGED:{const s=t.objectId,i=t.objectType,n=this._roomEngine.getRoomObjectCategoryForType(i),o=this._roomEngine.getRoomObject(e,s,n),l=this._roomEngine.getRoomObjectSelectionArrow(e);if(o&&l&&l.logic){const c=o.getLocation();l.logic.processUpdateMessage(new Ys(c,null))}return}case Ui.OBJECT_REMOVED:this.setSelectedAvatar(e,0,!1);return}}onRoomObjectWidgetRequestEvent(t,e){if(!t||!this._roomEngine)return;const s=t.objectId,i=t.objectType,n=this._roomEngine.getRoomObjectCategoryForType(i),o=this._roomEngine.events;if(o&&!wn.isRoomPreviewerId(e))switch(t.type){case X.OPEN_WIDGET:o.dispatchEvent(new nt(nt.OPEN_WIDGET,e,s,n,t.object.logic.widget));return;case X.CLOSE_WIDGET:o.dispatchEvent(new nt(nt.CLOSE_WIDGET,e,s,n,t.object.logic.widget));return;case X.OPEN_FURNI_CONTEXT_MENU:o.dispatchEvent(new nt(nt.OPEN_FURNI_CONTEXT_MENU,e,s,n,t.object.logic.contextMenu));return;case X.CLOSE_FURNI_CONTEXT_MENU:o.dispatchEvent(new nt(nt.CLOSE_FURNI_CONTEXT_MENU,e,s,n));return;case X.PLACEHOLDER:o.dispatchEvent(new nt(nt.REQUEST_PLACEHOLDER,e,s,n));return;case X.CREDITFURNI:o.dispatchEvent(new nt(nt.REQUEST_CREDITFURNI,e,s,n));return;case X.STACK_HEIGHT:o.dispatchEvent(new nt(nt.REQUEST_STACK_HEIGHT,e,s,n));return;case X.EXTERNAL_IMAGE:o.dispatchEvent(new nt(nt.REQUEST_EXTERNAL_IMAGE,e,s,n));return;case X.STICKIE:o.dispatchEvent(new nt(nt.REQUEST_STICKIE,e,s,n));return;case X.PRESENT:o.dispatchEvent(new nt(nt.REQUEST_PRESENT,e,s,n));return;case X.TROPHY:o.dispatchEvent(new nt(nt.REQUEST_TROPHY,e,s,n));return;case X.TEASER:o.dispatchEvent(new nt(nt.REQUEST_TEASER,e,s,n));return;case X.ECOTRONBOX:o.dispatchEvent(new nt(nt.REQUEST_ECOTRONBOX,e,s,n));return;case X.DIMMER:o.dispatchEvent(new nt(nt.REQUEST_DIMMER,e,s,n));return;case X.WIDGET_REMOVE_DIMMER:o.dispatchEvent(new nt(nt.REMOVE_DIMMER,e,s,n));return;case X.CLOTHING_CHANGE:o.dispatchEvent(new nt(nt.REQUEST_CLOTHING_CHANGE,e,s,n));return;case X.JUKEBOX_PLAYLIST_EDITOR:o.dispatchEvent(new nt(nt.REQUEST_PLAYLIST_EDITOR,e,s,n));return;case X.MANNEQUIN:o.dispatchEvent(new nt(nt.REQUEST_MANNEQUIN,e,s,n));return;case X.PET_PRODUCT_MENU:o.dispatchEvent(new sh(sh.USE_PRODUCT_FROM_ROOM,e,s,n));return;case X.GUILD_FURNI_CONTEXT_MENU:this._roomEngine.connection.send(new EP(t.objectId,t.object.model.getValue(C.FURNITURE_GUILD_CUSTOMIZED_GUILD_ID)));return;case X.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG:o.dispatchEvent(new nt(nt.REQUEST_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG,e,s,n));return;case X.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG:o.dispatchEvent(new nt(nt.REQUEST_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG,e,s,n));return;case X.BACKGROUND_COLOR:o.dispatchEvent(new nt(nt.REQUEST_BACKGROUND_COLOR,e,s,n));return;case X.MYSTERYBOX_OPEN_DIALOG:o.dispatchEvent(new nt(nt.REQUEST_MYSTERYBOX_OPEN_DIALOG,e,s,n));return;case X.EFFECTBOX_OPEN_DIALOG:o.dispatchEvent(new nt(nt.REQUEST_EFFECTBOX_OPEN_DIALOG,e,s,n));return;case X.MYSTERYTROPHY_OPEN_DIALOG:o.dispatchEvent(new nt(nt.REQUEST_MYSTERYTROPHY_OPEN_DIALOG,e,s,n));return;case X.ACHIEVEMENT_RESOLUTION_OPEN:this._roomEngine.connection.send(new nv(t.objectId,0));return;case X.ACHIEVEMENT_RESOLUTION_ENGRAVING:o.dispatchEvent(new nt(nt.REQUEST_ACHIEVEMENT_RESOLUTION_ENGRAVING,e,s,n));return;case X.ACHIEVEMENT_RESOLUTION_FAILED:o.dispatchEvent(new nt(nt.REQUEST_ACHIEVEMENT_RESOLUTION_FAILED,e,s,n));return;case X.FRIEND_FURNITURE_CONFIRM:o.dispatchEvent(new nt(nt.REQUEST_FRIEND_FURNITURE_CONFIRM,e,s,n));return;case X.FRIEND_FURNITURE_ENGRAVING:o.dispatchEvent(new nt(nt.REQUEST_FRIEND_FURNITURE_ENGRAVING,e,s,n));return;case X.BADGE_DISPLAY_ENGRAVING:o.dispatchEvent(new nt(nt.REQUEST_BADGE_DISPLAY_ENGRAVING,e,s,n));return;case X.HIGH_SCORE_DISPLAY:o.dispatchEvent(new nt(nt.REQUEST_HIGH_SCORE_DISPLAY,e,s,n));return;case X.HIDE_HIGH_SCORE_DISPLAY:o.dispatchEvent(new nt(nt.REQUEST_HIDE_HIGH_SCORE_DISPLAY,e,s,n));return;case X.INERNAL_LINK:o.dispatchEvent(new nt(nt.REQUEST_INTERNAL_LINK,e,s,n));return;case X.ROOM_LINK:o.dispatchEvent(new nt(nt.REQUEST_ROOM_LINK,e,s,n));return;case X.YOUTUBE:o.dispatchEvent(new nt(nt.REQUEST_YOUTUBE,e,s,n));return}}onRoomObjectFurnitureActionEvent(t,e){t&&this.useObject(e,t.object.id,t.object.type,t.type)}handleObjectSoundMachineEvent(t,e){if(!t)return;const s=this._roomEngine.getRoomObjectCategoryForType(t.objectType),i=this.getSelectedRoomObjectData(e);if(!(i&&i.category===s&&i.id===t.objectId&&i.operation===Ft.OBJECT_PLACE))switch(t.type){case lt.SOUND_MACHINE_INIT:this._roomEngine.events.dispatchEvent(new us(us.SOUND_MACHINE_INIT,e,t.objectId,s));return;case lt.SOUND_MACHINE_START:this._roomEngine.events.dispatchEvent(new us(us.SOUND_MACHINE_SWITCHED_ON,e,t.objectId,s));return;case lt.SOUND_MACHINE_STOP:this._roomEngine.events.dispatchEvent(new us(us.SOUND_MACHINE_SWITCHED_OFF,e,t.objectId,s));return;case lt.SOUND_MACHINE_DISPOSE:this._roomEngine.events.dispatchEvent(new us(us.SOUND_MACHINE_DISPOSE,e,t.objectId,s));return}}handleObjectJukeboxEvent(t,e){if(!t)return;const s=this._roomEngine.getRoomObjectCategoryForType(t.objectType),i=this.getSelectedRoomObjectData(e);if(!(i&&i.category===s&&i.id===t.objectId&&i.operation===Ft.OBJECT_PLACE))switch(t.type){case lt.JUKEBOX_INIT:this._roomEngine.events.dispatchEvent(new us(us.JUKEBOX_INIT,e,t.objectId,s));return;case lt.JUKEBOX_START:this._roomEngine.events.dispatchEvent(new us(us.JUKEBOX_SWITCHED_ON,e,t.objectId,s));return;case lt.JUKEBOX_MACHINE_STOP:this._roomEngine.events.dispatchEvent(new us(us.JUKEBOX_SWITCHED_OFF,e,t.objectId,s));return;case lt.JUKEBOX_DISPOSE:this._roomEngine.events.dispatchEvent(new us(us.JUKEBOX_DISPOSE,e,t.objectId,s));return}}onRoomObjectFloorHoleEvent(t,e){if(t)switch(t.type){case Mi.ADD_HOLE:this._roomEngine.addRoomInstanceFloorHole(e,t.objectId);return;case Mi.REMOVE_HOLE:this._roomEngine.removeRoomInstanceFloorHole(e,t.objectId);return}}onRoomObjectRoomAdEvent(t,e){if(!t)return;let s=null;switch(t.type){case Ze.ROOM_AD_FURNI_CLICK:this._roomEngine.events.dispatchEvent(t),t.clickUrl&&t.clickUrl.length>0&&Et.instance.createLinkEvent(t.clickUrl),s=Na.FURNI_CLICK;break;case Ze.ROOM_AD_FURNI_DOUBLE_CLICK:if(t.clickUrl&&t.clickUrl.length>0){const i="CATALOG_PAGE";t.clickUrl.indexOf(i)===0&&Et.instance.createLinkEvent(t.clickUrl.substr(i.length))}s=Na.FURNI_DOUBLE_CLICK;break;case Ze.ROOM_AD_TOOLTIP_SHOW:s=Na.TOOLTIP_SHOW;break;case Ze.ROOM_AD_TOOLTIP_HIDE:s=Na.TOOLTIP_HIDE;break}s&&this._roomEngine.events.dispatchEvent(new Rt(s,e,t.objectId,this._roomEngine.getRoomObjectCategoryForType(t.objectType)))}onRoomObjectBadgeAssetEvent(t,e){if(!(!t||!this._roomEngine))switch(t.type){case Gn.LOAD_BADGE:{const s=t.objectId,i=t.objectType,n=this._roomEngine.getRoomObjectCategoryForType(i);this._roomEngine.loadRoomObjectBadgeImage(e,s,n,t.badgeId,t.groupBadge);return}}}handleMousePointer(t,e){t&&this._roomEngine.updateMousePointer(t.type,t.objectId,t.objectType)}handleRoomObjectPlaySoundEvent(t,e){const s=this._roomEngine.getRoomObjectCategoryForType(t.objectType);switch(t.type){case uo.PLAY_SOUND:this._roomEngine.events.dispatchEvent(new Qc(Qc.PLAY_SOUND,e,t.objectId,s,t.soundId,t.pitch));return;case uo.PLAY_SOUND_AT_PITCH:this._roomEngine.events.dispatchEvent(new Qc(Qc.PLAY_SOUND_AT_PITCH,e,t.objectId,s,t.soundId,t.pitch));return}}handleRoomObjectSamplePlaybackEvent(t,e){if(!t)return;const s=this._roomEngine.getRoomObjectCategoryForType(t.objectType);switch(t.type){case vs.ROOM_OBJECT_INITIALIZED:this._roomEngine.events.dispatchEvent(new wr(wr.ROOM_OBJECT_INITIALIZED,e,t.objectId,s,t.sampleId,t.pitch));break;case vs.ROOM_OBJECT_DISPOSED:this._roomEngine.events.dispatchEvent(new wr(wr.ROOM_OBJECT_DISPOSED,e,t.objectId,s,t.sampleId,t.pitch));break;case vs.PLAY_SAMPLE:this._roomEngine.events.dispatchEvent(new wr(wr.PLAY_SAMPLE,e,t.objectId,s,t.sampleId,t.pitch));break;case vs.CHANGE_PITCH:this._roomEngine.events.dispatchEvent(new wr(wr.CHANGE_PITCH,e,t.objectId,s,t.sampleId,t.pitch));break}}onHSLColorEnableEvent(t,e){if(!(!t||!this._roomEngine))switch(t.type){case oo.ROOM_BACKGROUND_COLOR:this._roomEngine.events.dispatchEvent(new Vd(Vd.ROOM_BACKGROUND_COLOR,e,t.enable,t.hue,t.saturation,t.lightness));return}}onRoomObjectDataRequestEvent(t,e){if(!(!t||!this._roomEngine||!t.object))switch(t.type){case gn.RODRE_CURRENT_USER_ID:t.object.model.setValue(C.SESSION_CURRENT_USER_ID,this._roomEngine.sessionDataManager.userId);return;case gn.RODRE_URL_PREFIX:t.object.model.setValue(C.SESSION_URL_PREFIX,Dt.getValue("url.prefix"));return}}onRoomObjectTileMouseEvent(t,e){if(!this._roomEngine||this._roomEngine.isDecorating||!this._roomEngine.roomSessionManager)return;const s=this._roomEngine.roomSessionManager.getSession(t);!s||s.isSpectator||this.sendWalkUpdate(e.tileXAsInt,e.tileYAsInt)}handleObjectMove(t,e){if(!t||!this._roomEngine||!this._roomEngine.events)return;const i=this.getSelectedRoomObjectData(e);if(!i)return;const n=this._roomEngine.getRoomObject(e,i.id,i.category);if(!n)return;let o=!0;if(i.category===W.FLOOR||i.category===W.UNIT){const l=this._roomEngine.getFurnitureStackingHeightMap(e);t instanceof Ha&&this.handleFurnitureMove(n,i,Math.trunc(t.tileX+.5),Math.trunc(t.tileY+.5),l)||(this.handleFurnitureMove(n,i,i.loc.x,i.loc.y,l),o=!1)}else if(i.category===W.WALL){if(o=!1,t instanceof Xc){const l=t.wallLocation,c=t.wallWidth,u=t.wallHeight,h=t.x,d=t.y,g=t.direction;this.handleWallItemMove(n,i,l,c,u,h,d,g)&&(o=!0)}o||(n.setLocation(i.loc),n.setDirection(i.dir)),this._roomEngine.updateRoomObjectMask(e,i.id,o)}if(o){this.setFurnitureAlphaMultiplier(n,.5),this._roomEngine.setObjectMoverIconSpriteVisible(!1);const l=n.getLocation(),c=n.model;let u=1,h=1;if(c){u=c.getValue(C.FURNITURE_SIZE_X)||1,h=c.getValue(C.FURNITURE_SIZE_Y)||1;const m=n.getDirection(),I=Math.floor((m.x+45)/90)%4;(I===1||I===3)&&([u,h]=[h,u])}let d=0;const g=this._roomEngine.getRoomInstance(e);if(g){const m=g.managers.get(W.FLOOR);if(m)for(let I=l.x;I<l.x+u;I++)for(let p=l.y;p<l.y+h;p++)for(let T=0;T<m.totalObjects;T++){const R=m.getObjectByIndex(T);if(R&&R.id!==n.id){const S=R.getLocation(),b=R.model;if(b&&S){let N=b.getValue(C.FURNITURE_SIZE_X)||1,P=b.getValue(C.FURNITURE_SIZE_Y)||1;const B=R.getDirection(),F=Math.floor((B.x+45)/90)%4;if((F===1||F===3)&&([N,P]=[P,N]),I>=S.x&&I<S.x+N&&p>=S.y&&p<S.y+P){const w=b.getValue(C.FURNITURE_SIZE_Z)||0,G=S.z+w;G>d&&(d=G)}}}}}const E=new j(l.x,l.y,d);n.setLocation(E),n.getLocation()}}handleObjectPlace(t,e){if(!t||!this._roomEngine||!this._roomEngine.events)return;let i=this.getSelectedRoomObjectData(e);if(!i)return;let n=this._roomEngine.getRoomObject(e,i.id,i.category);if(!n){if(t instanceof Ha){if(i.category===W.FLOOR)this._roomEngine.addFurnitureFloor(e,i.id,i.typeId,i.loc,i.dir,0,i.stuffData,parseFloat(i.instanceData),-1,0,0,"",!1);else if(i.category===W.UNIT){this._roomEngine.addRoomObjectUser(e,i.id,new j,new j(180),180,i.typeId,i.instanceData);const o=this._roomEngine.getRoomObject(e,i.id,i.category);o&&i.posture&&o.model.setValue(C.FIGURE_POSTURE,i.posture)}}else t instanceof Xc&&i.category===W.WALL&&this._roomEngine.addFurnitureWall(e,i.id,i.typeId,i.loc,i.dir,0,i.instanceData,0);if(n=this._roomEngine.getRoomObject(e,i.id,i.category),n&&i.category===W.FLOOR){const o=n.model.getValue(C.FURNITURE_ALLOWED_DIRECTIONS);if(o&&o.length){const l=new j(o[0]);if(n.setDirection(l),this.updateSelectedObjectData(e,i.id,i.category,i.loc,l,i.operation,i.typeId,i.instanceData,i.stuffData,i.state,i.animFrame,i.posture),i=this.getSelectedRoomObjectData(e),!i)return}}this.setFurnitureAlphaMultiplier(n,.5),this._roomEngine.setObjectMoverIconSpriteVisible(!0)}if(n){let o=!0;const l=this._roomEngine.getFurnitureStackingHeightMap(e);if(i.category===W.FLOOR)if(!(t instanceof Ha&&this.handleFurnitureMove(n,i,Math.trunc(t.tileX+.5),Math.trunc(t.tileY+.5),l)))this._roomEngine.removeRoomObjectFloor(e,i.id),o=!1;else{const c=n.getLocation();console.log("📦 [INVENTARIO] Posizione corrente:",c.x,c.y,c.z);const u=n.model;let h=1,d=1;if(u){h=u.getValue(C.FURNITURE_SIZE_X)||1,d=u.getValue(C.FURNITURE_SIZE_Y)||1;const p=n.getDirection(),T=Math.floor((p.x+45)/90)%4;(T===1||T===3)&&([h,d]=[d,h])}console.log(`📦 [INVENTARIO] Dimensioni furno: ${h}x${d}`);let g=0;const E=this._roomEngine.getRoomInstance(e);if(E){const p=E.managers.get(W.FLOOR);if(p)for(let T=c.x;T<c.x+h;T++)for(let R=c.y;R<c.y+d;R++){console.log(`🔍 [INVENTARIO] Controllo casella: (${T}, ${R})`);for(let S=0;S<p.totalObjects;S++){const b=p.getObjectByIndex(S);if(b&&b.id!==n.id){const N=b.getLocation(),P=b.model;if(P&&N){let B=P.getValue(C.FURNITURE_SIZE_X)||1,F=P.getValue(C.FURNITURE_SIZE_Y)||1;const w=b.getDirection(),U=Math.floor((w.x+45)/90)%4;if((U===1||U===3)&&([B,F]=[F,B]),T>=N.x&&T<N.x+B&&R>=N.y&&R<N.y+F){const G=P.getValue(C.FURNITURE_SIZE_Z)||0,K=N.z,z=K+G;console.log(`🔍 [INVENTARIO] Oggetto sotto trovato: ID=${b.id}, pos=(${N.x},${N.y},${K}), dim=${B}x${F}, altezza=${G}, top=${z}`),z>g&&(g=z)}}}}}}console.log("📏 [INVENTARIO] Altezza finale calcolata:",g);const m=new j(c.x,c.y,g);n.setLocation(m);const I=n.getLocation();console.log("✅ [INVENTARIO] Nuova posizione applicata:",I.x,I.y,I.z)}else if(i.category===W.WALL){if(o=!1,t instanceof Xc){const c=t.wallLocation,u=t.wallWidth,h=t.wallHeight,d=t.x,g=t.y,E=t.direction;this.handleWallItemMove(n,i,c,u,h,d,g,E)&&(o=!0)}o||this._roomEngine.removeRoomObjectWall(e,i.id),this._roomEngine.updateRoomObjectMask(e,i.id,o)}else i.category===W.UNIT&&(t instanceof Ha&&this.handleUserPlace(n,Math.trunc(t.tileX+.5),Math.trunc(t.tileY+.5),this._roomEngine.getLegacyWallGeometry(e))||(this._roomEngine.removeRoomObjectUser(e,i.id),o=!1));this._roomEngine.setObjectMoverIconSpriteVisible(!o)}}handleFurnitureMove(t,e,s,i,n){if(!t||!e)return!1;const o=new j;o.assign(t.getDirection()),t.setDirection(e.dir);const l=new j(s,i,0),c=new j;c.assign(t.getDirection());let u=this.validateFurnitureLocation(t,l,e.loc,e.dir,n);return u||(c.x=this.getValidRoomObjectDirection(t,!0),t.setDirection(c),u=this.validateFurnitureLocation(t,l,e.loc,e.dir,n)),u?(t.setLocation(u),c&&t.setDirection(c),!0):(t.setDirection(o),!1)}handleWallItemMove(t,e,s,i,n,o,l,c){if(!t||!e)return!1;const u=new j(c),h=this.validateWallItemLocation(t,s,i,n,o,l,e);return h?(t.setLocation(h),t.setDirection(u),!0):!1}validateFurnitureLocation(t,e,s,i,n){if(!t||!t.model||!e)return null;let o=null;const l=t.getDirection();if(!l||!s||!i)return null;if(e.x===s.x&&e.y===s.y&&l.x===i.x)return o=new j,o.assign(s),o;let c=t.model.getValue(C.FURNITURE_SIZE_X),u=t.model.getValue(C.FURNITURE_SIZE_Y);c<1&&(c=1),u<1&&(u=1);const h=s.x,d=s.y;let g=c,E=u,m=0,I=Math.trunc(Math.trunc(l.x+45)%360/90);if((I===1||I===3)&&(m=c,c=u,u=m),I=Math.trunc(Math.trunc(i.x+45)%360/90),(I===1||I===3)&&(m=g,g=E,E=m),n&&e){const p=t.model.getValue(C.FURNITURE_ALWAYS_STACKABLE)===1;return n.validateLocation(e.x,e.y,c,u,h,d,g,E,p)?new j(e.x,e.y,n.getTileHeight(e.x,e.y)):null}return null}validateWallItemLocation(t,e,s,i,n,o,l){if(t==null||t.model==null||e==null||s==null||i==null||l==null)return null;const c=t.model.getValue(C.FURNITURE_SIZE_X),u=t.model.getValue(C.FURNITURE_SIZE_Z),h=t.model.getValue(C.FURNITURE_CENTER_Z);if((n<c/2||n>s.length-c/2||o<h||o>i.length-(u-h))&&(n<c/2&&n<=s.length-c/2?n=c/2:n>=c/2&&n>s.length-c/2&&(n=s.length-c/2),o<h&&o<=i.length-(u-h)?o=h:o>=h&&o>i.length-(u-h)&&(o=i.length-(u-h))),n<c/2||n>s.length-c/2||o<h||o>i.length-(u-h))return null;let d=j.sum(j.product(s,n/s.length),j.product(i,o/i.length));return d=j.sum(e,d),d}changeObjectState(t,e,s,i,n){const o=this._roomEngine.getRoomObjectCategoryForType(s);this.changeRoomObjectState(t,e,o,i,n)}useObject(t,e,s,i){if(!(!this._roomEngine||!this._roomEngine.connection))switch(i){case lt.DICE_ACTIVATE:this._roomEngine.connection.send(new RP(e));return;case lt.DICE_OFF:this._roomEngine.connection.send(new SP(e));return;case lt.USE_HABBOWHEEL:this._roomEngine.connection.send(new TP(e));return;case lt.STICKIE:this._roomEngine.connection.send(new nP(e));return;case lt.ENTER_ONEWAYDOOR:this._roomEngine.connection.send(new CP(e));return}}changeRoomObjectState(t,e,s,i,n){return!this._roomEngine||!this._roomEngine.connection||(s===W.FLOOR?n?this._roomEngine.connection.send(new AP(e,i)):this._roomEngine.connection.send(new uh(e,i)):s===W.WALL&&this._roomEngine.connection.send(new NP(e,i))),!0}sendWalkUpdate(t,e){!this._roomEngine||!this._roomEngine.connection||this._roomEngine.connection.send(new JP(t,e))}handleMouseOverObject(t,e,s){if(t!==W.FLOOR)return null;const i=this._roomEngine.getRoomObject(e,s.objectId,W.FLOOR);if(!i)return null;const n=this.getActiveSurfaceLocation(i,s);if(!n||!this._roomEngine.getFurnitureStackingHeightMap(e))return null;const l=n.x,c=n.y,u=n.z;return new qc(new j(l,c,i.getLocation().z),u,!0,s.eventId)}handleMoveTargetFurni(t,e){if(e.objectType===me.USER||e.objectType===me.PET||e.objectType===me.BOT||e.objectType===me.RENTABLE_BOT||e.objectType===me.MONSTER_PLANT)return;const s=this._roomEngine.getRoomObject(t,e.objectId,W.FLOOR),i=this.getActiveSurfaceLocation(s,e);return i?(this.sendWalkUpdate(i.x,i.y),!0):!1}getActiveSurfaceLocation(t,e){if(!t||!e)return null;const s=this._roomEngine.sessionDataManager.getFloorItemDataByName(t.type);if(!s||!s.canStandOn&&!s.canSitOn&&!s.canLayOn)return null;const i=t.model;if(!i)return null;const n=t.getLocation(),o=t.getDirection();let l=i.getValue(C.FURNITURE_SIZE_X),c=i.getValue(C.FURNITURE_SIZE_Y);const u=i.getValue(C.FURNITURE_SIZE_Z);(o.x===90||o.x===270)&&([l,c]=[c,l]),l<1&&(l=1),c<1&&(c=1);const h=this._roomEngine.getActiveRoomInstanceRenderingCanvas();if(!h)return null;const d=h.geometry.scale,g=s.canSitOn?.5:0,E=(d/2+e.spriteOffsetX+e.localX)/(d/4),m=(e.spriteOffsetY+e.localY+(u-g)*d/2)/(d/4),I=(E+2*m)/4,p=(E-2*m)/4,T=Math.floor(n.x+I),R=Math.floor(n.y-p+1);let S=!1;(T<n.x||T>=n.x+l||R<n.y||R>=n.y+c)&&(S=!0);const b=s.canSitOn?u-.5:u;return S?null:new j(T,R,b)}handleMouseOverTile(t,e){if(this._whereYouClickIsWhereYouGo)return new qc(new j(t.tileXAsInt,t.tileYAsInt,t.tileZAsInt),0,!0,t.eventId);const s=this._roomEngine.getRoomObjectCursor(e);if(s&&s.visualization){const i=t.tileXAsInt,n=t.tileYAsInt,o=t.tileZAsInt;if(this._roomEngine.getRoomInstance(e)){const c=this._roomEngine.getRoomTileObjectMap(e);if(c){const u=c.getObjectIntTile(i,n),h=this._roomEngine.getFurnitureStackingHeightMap(e);if(h){if(u&&u.model&&u.model.getValue(C.FURNITURE_IS_VARIABLE_HEIGHT)>0){const d=h.getTileHeight(i,n),g=this._roomEngine.getLegacyWallGeometry(e).getHeight(i,n);return new qc(new j(i,n,o),d-g,!0,t.eventId)}return new qc(new j(i,n,o),0,!0,t.eventId)}}}}return null}placeObject(t,e,s){const i=this.getSelectedRoomObjectData(t);if(!i)return;let n=null,o=i.id;const l=i.category;let c=0,u=0,h=0,d=0,g="";if(this._roomEngine&&this._roomEngine.connection&&(n=this._roomEngine.getRoomObject(t,o,l),n)){const E=n.getLocation();if(d=n.getDirection().x,l===W.FLOOR||l===W.UNIT)c=E.x,u=E.y,h=E.z;else if(l===W.WALL){c=E.x,u=E.y,h=E.z;const m=this._roomEngine.getLegacyWallGeometry(t);m&&(g=m.getOldLocationString(E,d))}d=(d/45%8+8)%8,o<0&&l===W.UNIT&&(o=o*-1),this._objectPlacementSource!==hl.CATALOG&&(l===W.UNIT?i.typeId===be.PET?this._roomEngine.connection.send(new oP(o,Math.trunc(c),Math.trunc(u))):i.typeId===be.RENTABLE_BOT&&this._roomEngine.connection.send(new sP(o,Math.trunc(c),Math.trunc(u))):n.model.getValue(C.FURNITURE_IS_STICKIE)!==void 0?this._roomEngine.connection.send(new IP(o,g)):this._roomEngine.connection.send(new lO(o,l,g,Math.trunc(c),Math.trunc(u),d)))}if(this._roomEngine.setPlacedRoomObjectData(t,new Np(i.id,i.category,null,i.dir,null)),this.resetSelectedObjectData(t),this._roomEngine&&this._roomEngine.events){const E=n&&n.id===i.id;this._roomEngine.events.dispatchEvent(new oI(Rt.PLACED,t,o,l,g,c,u,h,d,E,e,s,i.instanceData))}}modifyRoomObject(t,e,s,i){if(!this._roomEngine)return!1;const n=this._roomEngine.getRoomObject(t,e,s);if(!n)return!1;let o=!0;switch(i){case Ft.OBJECT_ROTATE_POSITIVE:case Ft.OBJECT_ROTATE_NEGATIVE:if(this._roomEngine.connection){let l=0;i==Ft.OBJECT_ROTATE_NEGATIVE?l=this.getValidRoomObjectDirection(n,!1):l=this.getValidRoomObjectDirection(n,!0);const c=n.getLocation().x,u=n.getLocation().y;if(this.isValidLocation(n,new j(l),this._roomEngine.getFurnitureStackingHeightMap(t)))if(l=Math.trunc(l/45),n.type===me.MONSTER_PLANT){const h=this._roomEngine.roomSessionManager.getSession(t);if(h){const d=h.userDataManager.getUserDataByIndex(e);d&&this._roomEngine.connection.send(new WT(d.webID,Math.trunc(c),Math.trunc(u),l))}}else this._roomEngine.connection.send(new YT(e,c,u,l))}break;case Ft.OBJECT_EJECT:case Ft.OBJECT_PICKUP:this._roomEngine.connection&&this._roomEngine.connection.send(new pP(s,e));break;case Ft.OBJECT_PICKUP_PET:if(this._roomEngine.connection){const l=this._roomEngine.roomSessionManager.getSession(t);if(l){const c=l.userDataManager.getUserDataByIndex(e);l.pickupPet(c.webID)}}break;case Ft.OBJECT_PICKUP_BOT:if(this._roomEngine.connection){const l=this._roomEngine.roomSessionManager.getSession(t);if(l){const c=l.userDataManager.getUserDataByIndex(e);l.pickupBot(c.webID)}}break;case Ft.OBJECT_MOVE:o=!1,this.setFurnitureAlphaMultiplier(n,.5),this.setSelectedRoomObjectData(t,n.id,s,n.getLocation(),n.getDirection(),i),this._roomEngine.setObjectMoverIconSprite(n.id,s,!0),this._roomEngine.setObjectMoverIconSpriteVisible(!1);break;case Ft.OBJECT_MOVE_TO:{const l=this.getSelectedRoomObjectData(t);if(this.updateSelectedObjectData(t,l.id,l.category,l.loc,l.dir,Ft.OBJECT_MOVE_TO,l.typeId,l.instanceData,l.stuffData,l.state,l.animFrame,l.posture),this.setFurnitureAlphaMultiplier(n,1),this._roomEngine.removeObjectMoverIconSprite(),this._roomEngine.connection){if(s===W.FLOOR){const c=n.getDirection().x%360,u=n.getLocation(),h=c/45;this._roomEngine.connection.send(new YT(e,u.x,u.y,h))}else if(s===W.WALL){const c=n.getDirection().x%360,u=this._roomEngine.getLegacyWallGeometry(t);if(u){const h=u.getOldLocationString(n.getLocation(),c);h&&this._roomEngine.connection.send(new vP(e,h))}}else if(s===W.UNIT){const c=n.getDirection().x%360,u=n.getLocation(),h=c/45;parseInt(n.model.getValue(C.RACE));const d=this._roomEngine.roomSessionManager.getSession(t);if(d){const g=d.userDataManager.getUserDataByIndex(e);g&&this._roomEngine.connection.send(new WT(g.webID,u.x,u.y,h))}}}break}}return o&&this.resetSelectedObjectData(t),!0}modifyRoomObjectDataWithMap(t,e,s,i,n){if(!this._roomEngine||!this._roomEngine.getRoomObject(t,e,s))return!1;switch(i){case Ft.OBJECT_SAVE_STUFF_DATA:this._roomEngine.connection&&this._roomEngine.connection.send(new oO(e,n));break}return!0}modifyWallItemData(t,e,s,i){return!this._roomEngine||!this._roomEngine.connection?!1:(this._roomEngine.connection.send(new hP(e,s,i)),!0)}deleteWallItem(t,e){return!this._roomEngine||!this._roomEngine.connection?!1:(this._roomEngine.connection.send(new cP(e)),!0)}getValidRoomObjectDirection(t,e){if(!t||!t.model)return 0;let s=0,i=0,n=[];t.type===me.MONSTER_PLANT?n=t.model.getValue(C.PET_ALLOWED_DIRECTIONS):n=t.model.getValue(C.FURNITURE_ALLOWED_DIRECTIONS);let o=t.getDirection().x;if(n&&n.length){if(s=n.indexOf(o),s<0){for(s=0,i=0;i<n.length&&!(o<=n[i]);)s++,i++;s=s%n.length}e?s=(s+1)%n.length:s=(s-1+n.length)%n.length,o=n[s]}return o}isValidLocation(t,e,s){if(!t||!t.model||!e)return!1;const i=t.getDirection(),n=t.getLocation();if(!i||!n)return!1;if(i.x%180===e.x%180)return!0;let o=t.model.getValue(C.FURNITURE_SIZE_X),l=t.model.getValue(C.FURNITURE_SIZE_Y);o<1&&(o=1),l<1&&(l=1);let c=o,u=l,h=Math.trunc(Math.trunc(e.x+45)%360/90);if((h===1||h===3)&&([o,l]=[l,o]),h=Math.trunc(Math.trunc(i.x+45)%360/90),(h===1||h===3)&&([c,u]=[u,c]),s&&n){const d=t.model.getValue(C.FURNITURE_ALWAYS_STACKABLE)===1;if(s.validateLocation(n.x,n.y,o,l,n.x,n.y,c,u,d,n.z))return!0}return!1}placeObjectOnUser(t,e,s){const i=this.getSelectedRoomObjectData(t);!i||!this._roomEngine.getRoomObject(t,e,s)||!this._roomEngine||!this._roomEngine.events||this._roomEngine.events.dispatchEvent(new Ew(Rt.PLACED_ON_USER,t,e,s,i.id,i.category))}setSelectedObject(t,e,s){if(!this._roomEngine)return;const i=this._roomEngine.events;if(i)switch(s){case W.UNIT:case W.FLOOR:case W.WALL:if(s===W.UNIT)if(this._roomEngine.isPlayingGame()){const n=this._roomEngine.getRoomObject(t,e,s);this.sendWalkUpdate(n.location.x,n.location.y)}else this.deselectObject(t),this.setSelectedAvatar(t,e,!0);else if(this.setSelectedAvatar(t,0,!1),e!==this._selectedObjectId){this.deselectObject(t);const n=this._roomEngine.getRoomObject(t,e,s);n&&n.logic&&(n.logic.processUpdateMessage(new e_(!0)),this._selectedObjectId=e,this._selectedObjectCategory=s)}i.dispatchEvent(new Rt(Rt.SELECTED,t,e,s));return}}deselectObject(t){if(this._selectedObjectId===-1)return;const e=this._roomEngine.getRoomObject(t,this._selectedObjectId,this._selectedObjectCategory);e&&e.logic&&(e.logic.processUpdateMessage(new e_(!1)),this._selectedObjectId=-1,this._selectedObjectCategory=W.MINIMUM)}setSelectedAvatar(t,e,s){if(!this._roomEngine)return;const i=W.UNIT,n=this._roomEngine.getRoomObject(t,this._selectedAvatarId,i);n&&n.logic&&(n.logic.processUpdateMessage(new lf(!1)),this._selectedAvatarId=-1);let o=!1;if(s){const c=this._roomEngine.getRoomObject(t,e,i);if(c&&c.logic){c.logic.processUpdateMessage(new lf(!0)),o=!0,this._selectedAvatarId=e;const u=c.getLocation();u&&this._roomEngine.connection.send(new XP(~~u.x,~~u.y))}}const l=this._roomEngine.getRoomObjectSelectionArrow(t);l&&l.logic&&(o&&!this._roomEngine.isPlayingGame()?l.logic.processUpdateMessage(new fo(fo.ENABLED)):l.logic.processUpdateMessage(new fo(fo.DISABLED)))}resetSelectedObjectData(t){if(!this._roomEngine)return;this._roomEngine.removeObjectMoverIconSprite();const e=this.getSelectedRoomObjectData(t);if(e){if(e.operation===Ft.OBJECT_MOVE||e.operation===Ft.OBJECT_MOVE_TO){const s=this._roomEngine.getRoomObject(t,e.id,e.category);s&&e.operation!==Ft.OBJECT_MOVE_TO&&(s.setLocation(e.loc),s.setDirection(e.dir)),this.setFurnitureAlphaMultiplier(s,1),e.category===W.WALL&&this._roomEngine.updateRoomObjectMask(t,e.id,!0),this.updateSelectedObjectData(t,e.id,e.category,e.loc,e.dir,Ft.OBJECT_MOVE,e.typeId,e.instanceData,e.stuffData,e.state,e.animFrame,e.posture)}else if(e.operation===Ft.OBJECT_PLACE){const s=e.id;switch(e.category){case W.FLOOR:this._roomEngine.removeRoomObjectFloor(t,s);break;case W.WALL:this._roomEngine.removeRoomObjectWall(t,s);break;case W.UNIT:this._roomEngine.removeRoomObjectUser(t,s);break}}this._roomEngine.setSelectedRoomObjectData(t,null)}}getSelectedRoomObjectData(t){return this._roomEngine?this._roomEngine.getSelectedRoomObjectData(t):null}setFurnitureAlphaMultiplier(t,e){!t||!t.model||t.model.setValue(C.FURNITURE_ALPHA_MULTIPLIER,e)}decorateModeMove(t){return this._roomEngine.isDecorating&&!(t.ctrlKey||t.shiftKey)}cancelRoomObjectPlacement(t){return this.resetSelectedObjectData(t),!0}setSelectedRoomObjectData(t,e,s,i,n,o,l=0,c=null,u=null,h=-1,d=-1,g=null){if(this.resetSelectedObjectData(t),!this._roomEngine)return;const E=new Np(e,s,o,i,n,l,c,u,h,d,g);this._roomEngine.setSelectedRoomObjectData(t,E)}updateSelectedObjectData(t,e,s,i,n,o,l=0,c=null,u=null,h=-1,d=-1,g=null){if(!this._roomEngine)return null;const E=new Np(e,s,o,i,n,l,c,u,h,d,g);this._roomEngine.setSelectedRoomObjectData(t,E)}handleUserPlace(t,e,s,i){return i.isRoomTile(e,s)?(t.setLocation(new j(e,s,i.getHeight(e,s))),!0):!1}get engine(){return this._roomEngine}get selectedAvatarId(){return this._selectedAvatarId}}class lq{constructor(){this._events=new nr,this._cachedEvents=new Map,this._registeredEvents=new Map,this._functions=[]}getLogic(t){const e=this.getLogicType(t);if(!e)return null;const s=new e;if(!s)return null;if(s.eventDispatcher=this._events,!this._cachedEvents.get(t)){this._cachedEvents.set(t,!0);const i=s.getEventTypes();for(const n of i)n&&this.registerEventType(n)}return s}registerEventType(t){if(!this._registeredEvents.get(t)){this._registeredEvents.set(t,!0);for(const e of this._functions)e&&this._events.addEventListener(t,e)}}registerEventFunction(t){if(t&&!(this._functions.indexOf(t)>=0)){this._functions.push(t);for(const e of this._registeredEvents.keys())e&&this._events.addEventListener(e,t)}}removeEventFunction(t){if(!t)return;const e=this._functions.indexOf(t);if(e!==-1){this._functions.splice(e,1);for(const s of this._registeredEvents.keys())s&&this._events.removeEventListener(s,t)}}getLogicType(t){if(!t)return null;let e=null;switch(t){case Nt.ROOM:e=A6;break;case Nt.TILE_CURSOR:e=oR;break;case Nt.SELECTION_ARROW:e=N6;break;case Nt.USER:case Nt.BOT:case Nt.RENTABLE_BOT:e=QT;break;case Nt.PET:e=R6;break;case Nt.FURNITURE_BASIC:e=Te;break;case Nt.FURNITURE_BADGE_DISPLAY:e=WU;break;case Nt.FURNITURE_CHANGE_STATE_WHEN_STEP_ON:e=yX;break;case Nt.FURNITURE_COUNTER_CLOCK:e=bX;break;case Nt.FURNITURE_CRACKABLE:e=vX;break;case Nt.FURNITURE_CREDIT:e=PX;break;case Nt.FURNITURE_CUSTOM_STACK_HEIGHT:e=jX;break;case Nt.FURNITURE_DICE:e=wX;break;case Nt.FURNITURE_EDITABLE_INTERNAL_LINK:e=GX;break;case Nt.FURNITURE_EDITABLE_ROOM_LINK:e=BX;break;case Nt.FURNITURE_EXTERNAL_IMAGE_WALLITEM:e=VX;break;case Nt.FURNITURE_FIREWORKS:e=HX;break;case Nt.FURNITURE_FLOOR_HOLE:e=$T;break;case Nt.FURNITURE_GUILD_CUSTOMIZED:e=df;break;case Nt.FURNITURE_HIGH_SCORE:e=ZT;break;case Nt.FURNITURE_HOCKEY_SCORE:e=zX;break;case Nt.FURNITURE_ES:e=XX;break;case Nt.FURNITURE_MANNEQUIN:e=tR;break;case Nt.FURNITURE_MULTIHEIGHT:e=ZX;break;case Nt.FURNITURE_MULTISTATE:e=Ds;break;case Nt.FURNITURE_ONE_WAY_DOOR:e=s6;break;case Nt.FURNITURE_PET_CUSTOMIZATION:e=i6;break;case Nt.FURNITURE_PRESENT:e=eR;break;case Nt.FURNITURE_PURCHASABLE_CLOTHING:e=a6;break;case Nt.FURNITURE_PUSHABLE:e=sR;break;case Nt.FURNITURE_BACKGROUND_COLOR:e=u6;break;case Nt.FURNITURE_BG:e=h6;break;case Nt.FURNITURE_BB:e=d6;break;case Nt.FURNITURE_ROOMDIMMER:e=_6;break;case Nt.FURNITURE_SCORE:e=iR;break;case Nt.FURNITURE_SOUNDBLOCK:e=rR;break;case Nt.FURNITURE_STICKIE:e=nR;break;case Nt.FURNITURE_TROPHY:e=m6;break;case Nt.FURNITURE_VOTE_COUNTER:e=aR;break;case Nt.FURNITURE_VOTE_MAJORITY:e=E6;break;case Nt.FURNITURE_WINDOW:e=I6;break;case Nt.FURNITURE_LOVELOCK:e=JX;break;case Nt.FURNITURE_YOUTUBE:e=T6;break;case Nt.FURNITURE_CRAFTING_GIZMO:e=LX;break;case Nt.FURNITURE_RENTABLE_SPACE:e=c6;break;case Nt.FURNITURE_EFFECTBOX:e=kX;break;case Nt.FURNITURE_MONSTERPLANT_SEED:e=$X;break;case Nt.FURNITURE_MYSTERYBOX:e=t6;break;case Nt.FURNITURE_MYSTERYTROPHY:e=e6;break;case Nt.FURNITURE_RANDOM_TELEPORT:e=l6;break;case Nt.FURNITURE_CLOTHING_CHANGE:e=DX;break;case Nt.FURNITURE_CUCKOO_CLOCK:e=UX;break;case Nt.FURNITURE_ECOTRON_BOX:e=FX;break;case Nt.FURNITURE_GROUP_FORUM_TERMINAL:e=WX;break;case Nt.FURNITURE_HWEEN_LOVELOCK:e=KX;break;case Nt.FURNITURE_INTERNAL_LINK:e=qX;break;case Nt.FURNITURE_JUKEBOX:e=QX;break;case Nt.FURNITURE_PLACEHOLDER:e=r6;break;case Nt.FURNITURE_PLANET_SYSTEM:e=n6;break;case Nt.FURNITURE_RANDOMSTATE:e=o6;break;case Nt.FURNITURE_SONG_DISK:e=g6;break;case Nt.FURNITURE_SOUND_MACHINE:e=f6;break;case Nt.FURNITURE_WELCOME_GIFT:e=p6;break;case Nt.FURNITURE_ACHIEVEMENT_RESOLUTION:e=JT;break;case Nt.FURNITURE_HABBOWHEEL:e=YX;break;default:e=Te;break}return e||(dt.warn("Unknown Logic",t),null)}get events(){return this._events}}const re=class re extends Fa{constructor(t){super(),this._communication=t,this._sessionDataManager=null,this._roomSessionManager=null,this._roomManager=null,this._roomObjectEventHandler=new oq(this),this._roomMessageHandler=new aq(this),this._roomContentLoader=new Qu,this._ready=!1,this._roomContentLoaderReady=!1,this._activeRoomId=-1,this._activeRoomActiveCanvas=-1,this._roomInstanceDatas=new Map,this._roomDatas=new Map,this._roomRendererFactory=new s1,this._visualizationFactory=new wR,this._logicFactory=new lq,this._activeRoomActiveCanvasMouseX=0,this._activeRoomActiveCanvasMouseY=0,this._activeRoomIsDragged=!1,this._activeRoomWasDragged=!1,this._activeRoomDragStartX=0,this._activeRoomDragStartY=0,this._activeRoomDragX=0,this._activeRoomDragY=0,this._skipFurnitureCreationForNextFrame=!1,this._mouseCursorUpdate=!1,this._imageObjectIdBank=null,this._imageCallbacks=new Map,this._thumbnailCallbacks=new Map,this._roomDraggingAlwaysCenters=!1,this._roomAllowsDragging=!0,this._badgeListenerObjects=new Map,this.runVisibilityUpdate=this.runVisibilityUpdate.bind(this),this.processRoomObjectEvent=this.processRoomObjectEvent.bind(this),this.onRoomSessionEvent=this.onRoomSessionEvent.bind(this),this.onRoomContentLoaderReadyEvent=this.onRoomContentLoaderReadyEvent.bind(this),this.onBadgeImageReadyEvent=this.onBadgeImageReadyEvent.bind(this)}onInit(){this._ready||(this._imageObjectIdBank=new WC(1e3),this._thumbnailObjectIdBank=new WC(1e3),this._logicFactory.registerEventFunction(this.processRoomObjectEvent),this._roomManager&&(this._roomManager.setContentLoader(this._roomContentLoader),this._roomManager.addUpdateCategory(W.FLOOR),this._roomManager.addUpdateCategory(W.WALL),this._roomManager.addUpdateCategory(W.UNIT),this._roomManager.addUpdateCategory(W.CURSOR),this._roomManager.addUpdateCategory(W.ROOM)),this._roomMessageHandler.setConnection(this._communication.connection),this._roomContentLoader.initialize(this.events),this._roomContentLoader.setSessionDataManager(this._sessionDataManager),this._roomContentLoader.setIconListener(this),this._roomSessionManager&&(this._roomSessionManager.events.addEventListener(Mt.STARTED,this.onRoomSessionEvent),this._roomSessionManager.events.addEventListener(Mt.ENDED,this.onRoomSessionEvent)),this.events.addEventListener(Qu.LOADER_READY,this.onRoomContentLoaderReadyEvent),fi().add(this.update,this),document.addEventListener("visibilitychange",this.runVisibilityUpdate))}onDispose(){if(this._ready){for(const[t,e]of this._roomInstanceDatas)this.removeRoomInstance(t);document.removeEventListener("visibilitychange",this.runVisibilityUpdate),fi().remove(this.update,this),this._roomObjectEventHandler&&this._roomObjectEventHandler.dispose(),this._roomMessageHandler&&this._roomMessageHandler.dispose(),this._roomContentLoader&&this._roomContentLoader.dispose(),this.events.removeEventListener(Qu.LOADER_READY,this.onRoomContentLoaderReadyEvent),this._roomSessionManager&&(this._roomSessionManager.events.removeEventListener(Mt.STARTED,this.onRoomSessionEvent),this._roomSessionManager.events.removeEventListener(Mt.ENDED,this.onRoomSessionEvent)),super.onDispose()}}onRoomSessionEvent(t){if(t instanceof Mt)switch(t.type){case Mt.STARTED:this._roomMessageHandler&&this._roomMessageHandler.setRoomId(t.session.roomId);return;case Mt.ENDED:this._roomMessageHandler&&(this._roomMessageHandler.clearRoomId(),this.removeRoomInstance(t.session.roomId));return}}onRoomContentLoaderReadyEvent(t){this._roomContentLoaderReady=!0,this._roomManager.init()}setActiveRoomId(t){this._activeRoomId=t}destroyRoom(t){this.removeRoomInstance(t)}getRoomInstance(t){return this._roomManager&&this._roomManager.getRoomInstance(this.getRoomId(t))||null}removeRoomInstance(t){this.getRoomInstance(t)&&this._roomManager&&this._roomManager.removeRoomInstance(this.getRoomId(t));const s=this._roomInstanceDatas.get(t);s&&(this._roomInstanceDatas.delete(s.roomId),s.dispose()),this.events.dispatchEvent(new te(te.DISPOSED,t))}createRoomInstance(t,e){let s="111",i="201",n="1";if(!this._ready){let c=this._roomDatas.get(t);c&&(this._roomDatas.delete(t),s=c.floorType,i=c.wallType,n=c.landscapeType),c=new ZC(t,e),c.floorType=s,c.wallType=i,c.landscapeType=n,this._roomDatas.set(t,c),dt.warn("Room Engine not initilized yet, can not create room. Room data stored for later initialization.");return}if(!e){dt.warn("Room property messages");return}const o=this._roomDatas.get(t);o&&(this._roomDatas.delete(t),o.floorType&&(s=o.floorType),o.wallType&&(i=o.wallType),o.landscapeType&&(n=o.landscapeType)),this.setupRoomInstance(t,e,s,i,n,this.getRoomInstanceModelName(t))&&(e.restrictsDragging?this._roomAllowsDragging=!1:this._roomAllowsDragging=!0,this.events.dispatchEvent(new te(te.INITIALIZED,t)))}setupRoomInstance(t,e,s,i,n,o){if(!this._ready||!this._roomManager)return;const l=this._roomManager.createRoomInstance(this.getRoomId(t));if(!l)return null;const c=W.ROOM,u=l.createRoomObjectAndInitalize(re.ROOM_OBJECT_ID,re.ROOM_OBJECT_TYPE,c);if(l.model.setValue(cs.ROOM_IS_PUBLIC,0),l.model.setValue(cs.ROOM_Z_SCALE,1),e&&(l.model.setValue(cs.RESTRICTS_DRAGGING,e.restrictsDragging),l.model.setValue(cs.RESTRICTS_SCALING,e.restrictsScaling),l.model.setValue(cs.RESTRICTED_SCALE,e.restrictedScale),e.dimensions)){const g=e.dimensions.minX,E=e.dimensions.maxX,m=e.dimensions.minY,I=e.dimensions.maxY;l.model.setValue(cs.ROOM_MIN_X,g),l.model.setValue(cs.ROOM_MAX_X,E),l.model.setValue(cs.ROOM_MIN_Y,m),l.model.setValue(cs.ROOM_MAX_Y,I);const p=Math.trunc(g*423+E*671+m*913+I*7509);u&&u.model&&u.model.setValue(C.ROOM_RANDOM_SEED,p)}const h=u&&u.logic||null;if(h&&(h.initialize(e),s&&(h.processUpdateMessage(new hi(hi.ROOM_FLOOR_UPDATE,s)),l.model.setValue(C.ROOM_FLOOR_TYPE,s)),i&&(h.processUpdateMessage(new hi(hi.ROOM_WALL_UPDATE,i)),l.model.setValue(C.ROOM_WALL_TYPE,i)),n&&(h.processUpdateMessage(new hi(hi.ROOM_LANDSCAPE_UPDATE,n)),l.model.setValue(C.ROOM_LANDSCAPE_TYPE,n))),e&&e.doors.length){let d=0;for(;d<e.doors.length;){const g=e.doors[d];if(g){const E=g.x,m=g.y,I=g.z,p=g.dir,T=yi.DOOR,R="door_"+d,S=new j(E,m,I);h.processUpdateMessage(new yi(yi.ADD_MASK,R,T,S,yi.HOLE)),(p===90||p===180)&&(p===90&&(l.model.setValue(C.ROOM_DOOR_X,E-.5),l.model.setValue(C.ROOM_DOOR_Y,m)),p===180&&(l.model.setValue(C.ROOM_DOOR_X,E),l.model.setValue(C.ROOM_DOOR_Y,m-.5)),l.model.setValue(C.ROOM_DOOR_Z,I),l.model.setValue(C.ROOM_DOOR_DIR,p))}d++}}return l.createRoomObjectAndInitalize(re.CURSOR_OBJECT_ID,re.CURSOR_OBJECT_TYPE,W.CURSOR),Dt.getValue("enable.avatar.arrow",!1)&&l.createRoomObjectAndInitalize(re.ARROW_OBJECT_ID,re.ARROW_OBJECT_TYPE,W.CURSOR),l}getRoomInstanceDisplay(t,e,s,i,n){const o=this.getRoomInstance(t);if(!o)return null;let l=o.renderer;if(!l&&(l=this._roomRendererFactory.createRenderer(),!l))return null;l.roomObjectVariableAccurateZ=C.OBJECT_ACCURATE_Z_VALUE,o.setRenderer(l);const c=l.createCanvas(e,s,i,n);if(!c)return null;if(o.model.getValue(cs.RESTRICTS_SCALING)){let h=o.model.getValue(cs.RESTRICTED_SCALE);h||(h=1),c.setScale(h),c.restrictsScaling=!0}else c.restrictsScaling=!1;if(c.setMouseListener(this._roomObjectEventHandler),c.geometry){c.geometry.z_scale=o.model.getValue(cs.ROOM_Z_SCALE);const h=o.model.getValue(C.ROOM_DOOR_X),d=o.model.getValue(C.ROOM_DOOR_Y),g=o.model.getValue(C.ROOM_DOOR_Z),E=o.model.getValue(C.ROOM_DOOR_DIR),m=new j(h,d,g);let I=null;E===90&&(I=new j(-2e3,0,0)),E===180&&(I=new j(0,-2e3,0)),c.geometry.setDisplacement(m,I);const p=c.master;if(p){const T=new Xe(Es.EMPTY);T.name=re.OVERLAY,T.interactive=!1,p.addChild(T)}}return c.master}setRoomInstanceRenderingCanvasMask(t,e,s){const i=this.getRoomInstanceRenderingCanvas(t,e);i&&i.setMask(s)}setRoomInstanceRenderingCanvasScale(t,e,s,i=null,n=null,o=!1,l=!1){const c=this.getRoomInstanceRenderingCanvas(t,e);if(c){if(c.restrictsScaling&&!o)return;c.setScale(s,i,n,o,l),this.events.dispatchEvent(new te(te.ROOM_ZOOMED,t))}}getRoomInstanceRenderingCanvas(t,e=-1){const s=this.getRoomInstance(t);if(!s)return null;const i=s.renderer;if(!i)return null;e===-1&&(e=this._activeRoomActiveCanvas);const n=i.getCanvas(e);return n||null}getActiveRoomInstanceRenderingCanvas(){return this.getRoomInstanceRenderingCanvas(this._activeRoomId,this._activeRoomActiveCanvas)}getRoomInstanceRenderingCanvasOffset(t,e=-1){e===-1&&(e=this._activeRoomActiveCanvas);const s=this.getRoomInstanceRenderingCanvas(t,e);return s?new wt(s.screenOffsetX,s.screenOffsetY):null}setRoomInstanceRenderingCanvasOffset(t,e,s){const i=this.getRoomInstanceRenderingCanvas(t,e);if(!i||!s)return!1;const n=~~s.x,o=~~s.y;if(!(i.screenOffsetX===n&&i.screenOffsetY===o))return this.events.dispatchEvent(new Ig(t,-(i.screenOffsetX-n),-(i.screenOffsetY-o))),i.screenOffsetX=n,i.screenOffsetY=o,!0}getRoomInstanceRenderingCanvasScale(t=-1e3,e=-1){t===-1e3&&(t=this._activeRoomId),e===-1&&(e=this._activeRoomActiveCanvas);const s=this.getRoomInstanceRenderingCanvas(t,e);return s?s.scale:1}initializeRoomInstanceRenderingCanvas(t,e,s,i){const n=this.getRoomInstanceRenderingCanvas(t,e);n&&n.initialize(s,i)}getRoomInstanceGeometry(t,e=-1){const s=this.getRoomInstance(t);if(!s)return null;const i=s.renderer;if(!i)return null;e===-1&&(e=this._activeRoomActiveCanvas);const n=i.getCanvas(e);return n?n.geometry:null}getRoomInstanceVariable(t,e){const s=this.getRoomInstance(t);return s&&s.model&&s.model.getValue(e)||null}updateRoomInstancePlaneVisibility(t,e,s=!0){const i=this.getRoomOwnObject(t);return i?(i.processUpdateMessage(new go(go.WALL_VISIBILITY,e)),i.processUpdateMessage(new go(go.FLOOR_VISIBILITY,s)),!0):!1}updateRoomInstancePlaneThickness(t,e,s){const i=this.getRoomOwnObject(t);return i?(i.processUpdateMessage(new _o(_o.WALL_THICKNESS,e)),i.processUpdateMessage(new _o(_o.FLOOR_THICKNESS,s)),!0):!1}updateRoomInstancePlaneType(t,e=null,s=null,i=null,n=!1){const o=this.getRoomOwnObject(t),l=this.getRoomInstance(t);if(!o){let c=this._roomDatas.get(t);return c||(c=new ZC(t,null),this._roomDatas.set(t,c)),e&&(c.floorType=e),s&&(c.wallType=s),i&&(c.landscapeType=i),!0}return e&&(l&&!n&&l.model.setValue(C.ROOM_FLOOR_TYPE,e),o.processUpdateMessage(new hi(hi.ROOM_FLOOR_UPDATE,e))),s&&(l&&!n&&l.model.setValue(C.ROOM_WALL_TYPE,s),o.processUpdateMessage(new hi(hi.ROOM_WALL_UPDATE,s))),i&&(l&&!n&&l.model.setValue(C.ROOM_LANDSCAPE_TYPE,i),o.processUpdateMessage(new hi(hi.ROOM_LANDSCAPE_UPDATE,i))),!0}updateObjectRoomColor(t,e,s,i){const n=this.getRoomOwnObject(t);if(!n||!n.logic)return!1;const o=new t_(t_.BACKGROUND_COLOR,e,s,i);return n.logic.processUpdateMessage(o),this.events.dispatchEvent(new pg(t,e,s,i)),!0}addRoomInstanceFloorHole(t,e){if(e<0)return;const s=this.getRoomOwnObject(t),i=this.getRoomObjectFloor(t,e);if(s&&s.logic&&i&&i.model){const n=i.getLocation(),o=i.model.getValue(C.FURNITURE_SIZE_X),l=i.model.getValue(C.FURNITURE_SIZE_Y);s.processUpdateMessage(new ho(ho.ADD,e,n.x,n.y,o,l))}}removeRoomInstanceFloorHole(t,e){if(e<0)return;const s=this.getRoomOwnObject(t);s&&s.processUpdateMessage(new ho(ho.REMOVE,e))}setRoomEngineGameMode(t,e){const s=this.getRoomInstance(t);if(!s)return;const i=e?1:0;s.model.setValue(cs.IS_PLAYING_GAME,i),i===0?this.events.dispatchEvent(new te(te.NORMAL_MODE,t)):this.events.dispatchEvent(new te(te.GAME_MODE,t))}isRoomIdPlayingGame(t){const e=this.getRoomInstance(t);return e?e.model.getValue(cs.IS_PLAYING_GAME)>0:!1}isPlayingGame(){return this.isRoomIdPlayingGame(this._activeRoomId)}disableUpdate(t){t?fi().remove(this.update,this):(fi().remove(this.update,this),fi().add(this.update,this))}runUpdate(){this.update(1)}runVisibilityUpdate(){document.hidden||this.update(1,!0)}update(t,e=!1){this._roomManager&&(t=Pt(),Br.turnVisualizationOn(),this.processPendingFurniture(),this._roomManager.update(t,e),this.updateRoomCameras(t),this._mouseCursorUpdate&&this.setPointer(),Br.turnVisualizationOff())}setPointer(){this._mouseCursorUpdate=!1;const t=this.getRoomInstanceData(this._activeRoomId);t&&t.hasButtonMouseCursorOwners()?document.body.style.cursor="pointer":document.body.style.cursor="auto"}processPendingFurniture(){if(this._skipFurnitureCreationForNextFrame){this._skipFurnitureCreationForNextFrame=!1;return}const t=new Date().valueOf(),e=5;for(const s of this._roomInstanceDatas.values()){if(!s)continue;let i=null,n=0,o=!1;for(;i=s.getNextPendingFurnitureFloor();)if(o=this.processPendingFurnitureFloor(s.roomId,i.id,i),!(++n%e)&&new Date().valueOf()-t>=40){this._skipFurnitureCreationForNextFrame=!0;break}for(;!this._skipFurnitureCreationForNextFrame&&(i=s.getNextPendingFurnitureWall());)if(o=this.processPendingFurnitureWall(s.roomId,i.id,i),!(++n%e)&&new Date().valueOf()-t>=40){this._skipFurnitureCreationForNextFrame=!0;break}if(o&&this._roomManager&&(this._roomManager.getRoomInstance(this.getRoomId(s.roomId)).hasUninitializedObjects()||this.objectsInitialized(s.roomId.toString())),this._skipFurnitureCreationForNextFrame)return}}onRoomEngineInitalized(t){if(t){this._ready=!0,this.events.dispatchEvent(new te(te.ENGINE_INITIALIZED,0));for(const e of this._roomDatas.values())e&&this.createRoomInstance(e.roomId,e.data)}}processPendingFurnitureFloor(t,e,s){if(!s){const c=this.getRoomInstanceData(t);if(c&&(s=c.getPendingFurnitureFloor(e)),!s)return!1}let i=s.type;i||(i=this.getFurnitureFloorName(s.typeId));const n=this.createRoomObjectFloor(t,e,i);if(!n)return!1;const o=n.model;if(o&&(o.setValue(C.FURNITURE_COLOR,this.getFurnitureFloorColorIndex(s.typeId)),o.setValue(C.FURNITURE_TYPE_ID,s.typeId),o.setValue(C.FURNITURE_AD_URL,this.getRoomObjectAdUrl(s.type)),o.setValue(C.FURNITURE_REAL_ROOM_OBJECT,s.realRoomObject?1:0),o.setValue(C.FURNITURE_EXPIRY_TIME,s.expiryTime),o.setValue(C.FURNITURE_EXPIRTY_TIMESTAMP,Pt()),o.setValue(C.FURNITURE_USAGE_POLICY,s.usagePolicy),o.setValue(C.FURNITURE_OWNER_ID,s.ownerId),o.setValue(C.FURNITURE_OWNER_NAME,s.ownerName),o.setValue(C.FURNITURE_RARE_VALUE,s.rareValue),o.setValue(C.FURNITURE_VALID_RARE,s.validRare),o.setValue(C.FURNITURE_WIN_REASON,s.winReason)),!this.updateRoomObjectFloor(t,e,s.location,s.direction,s.state,s.data,s.extra)||s.sizeZ>=0&&!this.updateRoomObjectFloorHeight(t,e,s.sizeZ))return!1;this.events&&this.events.dispatchEvent(new Rt(Rt.ADDED,t,e,W.FLOOR));const l=this.getPlacedRoomObjectData(t);return l&&l.id===e&&l.category===W.FLOOR&&this.selectRoomObject(t,e,W.FLOOR),n.isReady&&s.synchronized&&this.addObjectToTileMap(t,n),!0}processPendingFurnitureWall(t,e,s){if(!s){const u=this.getRoomInstanceData(t);if(u&&(s=u.getPendingFurnitureWall(e)),!s)return!1}let i="";s.data&&(i=s.data.getLegacyString());let n=this.getFurnitureWallName(s.typeId,i);n||(n="");const o=this.createRoomObjectWall(t,e,n);if(!o)return!1;const l=o.model;if(l&&(l.setValue(C.FURNITURE_COLOR,this.getFurnitureWallColorIndex(s.typeId)),l.setValue(C.FURNITURE_TYPE_ID,s.typeId),l.setValue(C.FURNITURE_AD_URL,this.getRoomObjectAdUrl(s.type)),l.setValue(C.FURNITURE_REAL_ROOM_OBJECT,s.realRoomObject?1:0),l.setValue(C.OBJECT_ACCURATE_Z_VALUE,1),l.setValue(C.FURNITURE_EXPIRY_TIME,s.expiryTime),l.setValue(C.FURNITURE_EXPIRTY_TIMESTAMP,Pt()),l.setValue(C.FURNITURE_USAGE_POLICY,s.usagePolicy),l.setValue(C.FURNITURE_OWNER_ID,s.ownerId),l.setValue(C.FURNITURE_OWNER_NAME,s.ownerName),l.setValue(C.FURNITURE_RARE_VALUE,s.rareValue),l.setValue(C.FURNITURE_VALID_RARE,s.validRare)),!this.updateRoomObjectWall(t,e,s.location,s.direction,s.state,i,s.data))return!1;this.events&&this.events.dispatchEvent(new Rt(Rt.ADDED,t,e,W.WALL));const c=this.getPlacedRoomObjectData(t);return c&&Math.abs(c.id)===e&&c.category===W.WALL&&this.selectRoomObject(t,e,W.WALL),!0}setRoomSessionOwnUser(t,e){if(!this._roomSessionManager)return;const s=this._roomSessionManager.getSession(t);s&&s.setOwnRoomIndex(e);const i=this.getRoomCamera(t);i&&(i.targetId=e,i.targetCategory=W.UNIT,i.activateFollowing(this.cameraFollowDuration))}get cameraFollowDuration(){return 1e3}updateRoomCameras(t){for(const e of this._roomInstanceDatas.values()){if(!e)continue;const s=e.roomCamera;if(!s)continue;let i=null;const n=this.getRoomObject(e.roomId,s.targetId,s.targetCategory);n&&(i=n.getLocation()),i&&(e.roomId!==this._activeRoomId||!this._activeRoomIsDragged)&&this.updateRoomCamera(e.roomId,1,i,t)}if(this._activeRoomWasDragged){const e=this.getRoomInstanceRenderingCanvas(this._activeRoomId,1);e&&this.setRoomInstanceRenderingCanvasOffset(this._activeRoomId,1,new wt(e.screenOffsetX+this._activeRoomDragX,e.screenOffsetY+this._activeRoomDragY)),this._activeRoomDragX=0,this._activeRoomDragY=0}}updateRoomCamera(t,e,s,i){const n=this.getRoomInstanceRenderingCanvas(t,e),o=this.getRoomInstanceData(t);if(!n||!o||n.scale!==1)return;const l=n.geometry,c=o.roomCamera,u=this.getRoomInstance(t);if(!l||!c||!u)return;const h=this.getRoomCanvasRectangle(t,e);if(!h)return;let d=Math.floor(s.z)+1;const g=Math.round(h.width),E=Math.round(h.height),m=this.getCanvasBoundingRectangle(e);if(m&&(m.right<0||m.bottom<0||m.left>=g||m.top>=E)&&c.reset(),c.screenWd!==g||c.screenHt!==E||c.scale!==l.scale||c.geometryUpdateId!==l.updateId||!j.isEqual(s,c.targetObjectLoc)||c.isMoving){c.targetObjectLoc=s;const I=new j;I.assign(s),I.x=Math.round(I.x),I.y=Math.round(I.y);const p=u.model.getValue(cs.ROOM_MIN_X)-.5,T=u.model.getValue(cs.ROOM_MIN_Y)-.5,R=u.model.getValue(cs.ROOM_MAX_X)+.5,S=u.model.getValue(cs.ROOM_MAX_Y)+.5,b=Math.round((p+R)/2),N=Math.round((T+S)/2),P=2;let B=new wt(I.x-b,I.y-N);const F=l.scale/Math.sqrt(2),w=F/2,U=new sr;U.rotate(-(l.direction.x+90)/180*Math.PI),B=U.apply(B),B.y=B.y*(w/F);const G=h.width/2/F-1,K=h.height/2/w-1;let z=0,et=0,rt=0,J=0,Ct=l.getScreenPoint(new j(b,N,P));if(!Ct)return;if(Ct.x=Ct.x+Math.round(h.width/2),Ct.y=Ct.y+Math.round(h.height/2),m)if(m.x+=-n.screenOffsetX,m.y+=-n.screenOffsetY,m.width>1&&m.height>1)z=(m.left-Ct.x-l.scale*.25)/F,rt=(m.right-Ct.x+l.scale*.25)/F,et=(m.top-Ct.y-l.scale*.5)/w,J=(m.bottom-Ct.y+l.scale*.5)/w;else{l.adjustLocation(new j(-30,-30),25);return}else{l.adjustLocation(new j(0,0),25);return}let At=!1,se=!1,ve=!1,ss=!1;Math.round((rt-z)*F)<h.width?(d=2,B.x=(rt+z)/2,ve=!0):(B.x>rt-G&&(B.x=rt-G,At=!0),B.x<z+G&&(B.x=z+G,At=!0)),Math.round((J-et)*w)<h.height?(d=2,B.y=(J+et)/2,ss=!0):(B.y>J-K&&(B.y=J-K,se=!0),B.y<et+K&&(B.y=et+K,se=!0),se&&(B.y=B.y/(w/F))),U.invert(),B=U.apply(B),B.x=B.x+b,B.y=B.y+N;let ge=.35,Rs=.2,mi=.2;const pe=10,Wt=10;if(mi*g>100&&(mi=100/g),ge*E>150&&(ge=150/E),Rs*E>150&&(Rs=150/E),c.limitedLocationX&&c.screenWd==g&&c.screenHt==E&&(mi=0),c.limitedLocationY&&c.screenWd==g&&c.screenHt==E&&(ge=0,Rs=0),h.width=h.width*(1-mi*2),h.height=h.height*(1-(ge+Rs)),h.width<pe&&(h.width=pe),h.height<Wt&&(h.height=Wt),ge+Rs>0?(h.x+=-h.width/2,h.y+=-h.height*(Rs/(ge+Rs))):(h.x+=-h.width/2,h.y+=-h.height/2),Ct=l.getScreenPoint(I),!Ct)return;if(Ct){Ct.x=Ct.x+n.screenOffsetX,Ct.y=Ct.y+n.screenOffsetY,I.z=d,I.x=Math.round(B.x*2)/2,I.y=Math.round(B.y*2)/2,c.location||(l.location=I,this.useOffsetScrolling?c.initializeLocation(new j(0,0,0)):c.initializeLocation(I));const We=l.getScreenPoint(I),Be=new j(0,0,0);We&&(Be.x=We.x,Be.y=We.y),(Ct.x<h.left||Ct.x>h.right)&&!c.centeredLocX||(Ct.y<h.top||Ct.y>h.bottom)&&!c.centeredLocY||ve&&!c.centeredLocX&&c.screenWd!=g||ss&&!c.centeredLocY&&c.screenHt!=E||c.roomWd!=m.width||c.roomHt!=m.height||c.screenWd!=g||c.screenHt!=E?(c.limitedLocationX=At,c.limitedLocationY=se,this.useOffsetScrolling?c.target=Be:c.target=I):(At||(c.limitedLocationX=!1),se||(c.limitedLocationY=!1))}c.centeredLocX=ve,c.centeredLocY=ss,c.screenWd=g,c.screenHt=E,c.scale=l.scale,c.geometryUpdateId=l.updateId,c.roomWd=m.width,c.roomHt=m.height,this._sessionDataManager.isCameraFollowDisabled||(this.useOffsetScrolling?c.update(i,8):c.update(i,.5)),this.useOffsetScrolling?this.setRoomInstanceRenderingCanvasOffset(this.activeRoomId,1,new wt(-c.location.x,-c.location.y)):l.adjustLocation(c.location,25)}else c.limitedLocationX=!1,c.limitedLocationY=!1,c.centeredLocX=!1,c.centeredLocY=!1}getRoomCanvasRectangle(t,e){const s=this.getRoomInstanceRenderingCanvas(t,e);return s?new Or(0,0,s.width,s.height):null}getRoomObjectBoundingRectangle(t,e,s,i){const n=this.getRoomInstanceGeometry(t,i);if(!n)return null;const o=this.getRoomObject(t,e,s);if(!o)return null;const l=o.visualization;if(!l)return null;const c=l.getBoundingRectangle(),u=this.getRoomInstanceRenderingCanvas(t,i),h=u?u.scale:1,d=n.getScreenPoint(o.getLocation());return!d||(d.x=Math.round(d.x),d.y=Math.round(d.y),c.x=c.x*h,c.y=c.y*h,c.width=c.width*h,c.height=c.height*h,d.x=d.x*h,d.y=d.y*h,c.x+=d.x,c.y+=d.y,!u)?null:(c.x+=Math.round(u.width/2)+u.screenOffsetX,c.y+=Math.round(u.height/2)+u.screenOffsetY,c)}getCanvasBoundingRectangle(t){return this.getRoomObjectBoundingRectangle(this._activeRoomId,re.ROOM_OBJECT_ID,W.ROOM,t)}getFurnitureFloorName(t){return this._roomContentLoader?this._roomContentLoader.getFurnitureFloorNameForTypeId(t):null}getFurnitureWallName(t,e=null){return this._roomContentLoader?this._roomContentLoader.getFurnitureWallNameForTypeId(t,e):null}getFurnitureFloorColorIndex(t){return this._roomContentLoader?this._roomContentLoader.getFurnitureFloorColorIndex(t):null}getFurnitureWallColorIndex(t){return this._roomContentLoader?this._roomContentLoader.getFurnitureWallColorIndex(t):null}getRoomInstanceData(t){const e=this._roomInstanceDatas.get(t);if(e)return e;const s=new rq(t);return this._roomInstanceDatas.set(s.roomId,s),s}getRoomInstanceModelName(t){const e=this.getRoomInstanceData(t);return e?e.modelName:null}setRoomInstanceModelName(t,e){const s=this.getRoomInstanceData(t);s&&s.setModelName(e)}getRoomTileObjectMap(t){const e=this.getRoomInstanceData(t);return e?e.tileObjectMap:null}getCurrentRoomCamera(){return this.getRoomCamera(this._activeRoomId)}getRoomCamera(t){const e=this.getRoomInstanceData(t);return e?e.roomCamera:null}getSelectedRoomObjectData(t){const e=this.getRoomInstanceData(t);return e?e.selectedObject:null}setSelectedRoomObjectData(t,e){const s=this.getRoomInstanceData(t);if(!s)return null;s.setSelectedObject(e),e&&s.setPlacedObject(null)}getPlacedRoomObjectData(t){const e=this.getRoomInstanceData(t);return e?e.placedObject:null}setPlacedRoomObjectData(t,e){const s=this.getRoomInstanceData(t);if(!s)return null;s.setPlacedObject(e)}cancelRoomObjectPlacement(){this._roomObjectEventHandler&&this._roomObjectEventHandler.cancelRoomObjectPlacement(this._activeRoomId)}getFurnitureStackingHeightMap(t){const e=this.getRoomInstanceData(t);return e?e.furnitureStackingHeightMap:null}setFurnitureStackingHeightMap(t,e){const s=this.getRoomInstanceData(t);if(!s)return null;s.setFurnitureStackingHeightMap(e)}getLegacyWallGeometry(t){const e=this.getRoomInstanceData(t);return e?e.legacyGeometry:null}createRoomObjectAndInitialize(t,e,s,i){const n=this.getRoomInstance(t);return n?n.createRoomObjectAndInitalize(e,s,i):null}getTotalObjectsForManager(t,e){const s=this.getRoomInstance(t);return s?s.getTotalObjectsForManager(e):0}getRoomObject(t,e,s){if(!this._ready)return null;let i=this.getRoomId(t);return t===0&&(i=re.TEMPORARY_ROOM),this.getObject(i,e,s)}getObject(t,e,s){let i=null;if(this._roomManager&&(i=this._roomManager.getRoomInstance(t)),!i)return null;let n=i.getRoomObject(e,s);if(!n)switch(s){case W.FLOOR:this.processPendingFurnitureFloor(this.getRoomIdFromString(t),e,null),n=i.getRoomObject(e,s);break;case W.WALL:this.processPendingFurnitureWall(this.getRoomIdFromString(t),e,null),n=i.getRoomObject(e,s);break}return n}getRoomObjectByIndex(t,e,s){const i=this.getRoomInstance(t);return i?i.getRoomObjectByIndex(e,s):null}getRoomObjectCategoryForType(t){return!t||!this._roomContentLoader?W.MINIMUM:this._roomContentLoader.getCategoryForType(t)}getRoomObjectCursor(t){return this.getObject(this.getRoomId(t),re.CURSOR_OBJECT_ID,W.CURSOR)}getRoomObjectSelectionArrow(t){return this.getObject(this.getRoomId(t),re.ARROW_OBJECT_ID,W.CURSOR)}getRoomOwnObject(t){return this.getObject(this.getRoomId(t),re.ROOM_OBJECT_ID,W.ROOM)}getRoomObjectUser(t,e){return this.getObject(this.getRoomId(t),e,W.UNIT)}removeRoomObjectUser(t,e){return this.removeRoomObject(t,e,W.UNIT)}createRoomObjectUser(t,e,s){return this.createRoomObjectAndInitialize(t,e,s,W.UNIT)}getRoomObjectFloor(t,e){return this.getObject(this.getRoomId(t),e,W.FLOOR)}createRoomObjectFloor(t,e,s){return this.createRoomObjectAndInitialize(t,e,s,W.FLOOR)}removeRoomObjectFloor(t,e,s=-1,i=!1){const n=this.getRoomInstanceData(t);if(n&&n.removePendingFunitureFloor(e),this._sessionDataManager&&s===this._sessionDataManager.userId&&!Rf.isBuilderClubId(e)){const o=this.getRoomObject(t,e,W.FLOOR);if(o){const l=this.getRoomObjectScreenLocation(t,e,W.FLOOR,this._activeRoomActiveCanvas);if(l&&!(o.model.getValue(C.FURNITURE_DISABLE_PICKING_ANIMATION)===1)){const u=o.model.getValue(C.FURNITURE_TYPE_ID),h=o.model.getValue(C.FURNITURE_EXTRAS),d=o.model.getValue(C.FURNITURE_DATA_FORMAT),g=Aa.getData(d),E=this.getFurnitureFloorIcon(u,null,h,g).data;if(E){const m=Ee.generateImage(E);if(this.events){const I=new kd(m,l.x,l.y);I.iconName=dg.INVENTORY,this.events.dispatchEvent(I)}}}}}this.removeRoomObject(t,e,W.FLOOR),this.setMouseDefault(t,W.FLOOR,e),i&&this.refreshTileObjectMap(t,"RoomEngine.disposeObjectFurniture()")}getRoomObjectWall(t,e){return this.getObject(this.getRoomId(t),e,W.WALL)}removeRoomObjectWall(t,e,s=-1){if(this._sessionDataManager&&s===this._sessionDataManager.userId&&!Rf.isBuilderClubId(e)){const i=this.getRoomObject(t,e,W.WALL);if(i&&i.type.indexOf("post_it")===-1&&i.type.indexOf("external_image_wallitem")===-1){const n=this.getRoomObjectScreenLocation(t,e,W.WALL,this._activeRoomActiveCanvas);if(n){const o=i.model.getValue(C.FURNITURE_TYPE_ID),l=i.model.getValue(C.FURNITURE_DATA),c=this.getFurnitureWallIcon(o,null,l).data;if(c){const u=Ee.generateImage(c);if(this.events){const h=new kd(u,n.x,n.y);h.iconName=dg.INVENTORY,this.events.dispatchEvent(h)}}}}}this.removeRoomObject(t,e,W.WALL),this.updateRoomObjectMask(t,e,!1),this.setMouseDefault(t,W.WALL,e)}createRoomObjectWall(t,e,s){return this.createRoomObjectAndInitialize(t,e,s,W.WALL)}removeRoomObject(t,e,s){const i=this.getRoomInstance(t);if(!i)return null;i.removeRoomObject(e,s),this.events&&this.events.dispatchEvent(new Rt(Rt.REMOVED,t,e,s))}addFurnitureFloor(t,e,s,i,n,o,l,c=NaN,u=-1,h=0,d=0,g="",E=!0,m=!0,I=-1,p=0,T=!1,R=""){const S=this.getRoomInstanceData(t);if(!S)return!1;const b=new Ap(e,s,null,i,n,o,l,c,u,h,d,g,E,m,I);return b.rareValue=p,b.validRare=T,b.winReason=R,S.addPendingFurnitureFloor(b),!0}addFurnitureFloorByTypeName(t,e,s,i,n,o,l,c=NaN,u=-1,h=0,d=0,g="",E=!0,m=!0,I=-1,p=0,T=!1,R=""){const S=this.getRoomInstanceData(t);if(!S)return!1;const b=new Ap(e,0,s,i,n,o,l,c,u,h,d,g,E,m,I);return b.rareValue=p,b.validRare=T,b.winReason=R,S.addPendingFurnitureFloor(b),!0}addFurnitureWall(t,e,s,i,n,o,l,c=-1,u=0,h=0,d="",g=!0,E=0,m=!1,I="",p=null){const T=this.getRoomInstanceData(t);if(!T)return!1;p??(p=new wi),p.setString(l);const R=new Ap(e,s,null,i,n,o,p,NaN,c,u,h,d,!0,g);return R.rareValue=E,R.validRare=m,R.winReason=I,T.addPendingFurnitureWall(R),!0}updateRoomObjectFloor(t,e,s,i,n,o,l=null){const c=this.getRoomObjectFloor(t,e);return c?(c.processUpdateMessage(new Ys(s,i)),c.processUpdateMessage(new je(n,o,l)),!0):!1}updateRoomObjectWall(t,e,s,i,n,o=null,l=null){const c=this.getRoomObjectWall(t,e);if(!c||!c.logic)return!1;const u=new Ys(s,i);l??(l=new wi);const h=new je(n,l);return l.setString(o),c.logic.processUpdateMessage(u),c.logic.processUpdateMessage(h),this.updateRoomObjectMask(t,e),!0}updateRoomObjectWallItemData(t,e,s){const i=this.getRoomObjectWall(t,e);return!i||!i.logic?!1:(i.logic.processUpdateMessage(new TO(s)),!0)}updateRoomObjectFloorHeight(t,e,s){const i=this.getRoomObjectFloor(t,e);return i?(i.processUpdateMessage(new VU(null,null,s)),!0):!1}updateRoomObjectFloorExpiration(t,e,s){const i=this.getRoomObjectFloor(t,e);return i?(i.model.setValue(C.FURNITURE_EXPIRY_TIME,s),i.model.setValue(C.FURNITURE_EXPIRTY_TIMESTAMP,Pt()),!0):!1}updateRoomObjectWallExpiration(t,e,s){const i=this.getRoomObjectWall(t,e);return i?(i.model.setValue(C.FURNITURE_EXPIRY_TIME,s),i.model.setValue(C.FURNITURE_EXPIRTY_TIMESTAMP,Pt()),!0):!1}updateRoomObjectMask(t,e,s=!0){const i=W.WALL+"_"+e,n=this.getRoomObjectWall(t,e);let o=null;if(n&&n.model){if(n.model.getValue(C.FURNITURE_USES_PLANE_MASK)>0){const c=n.model.getValue(C.FURNITURE_PLANE_MASK_TYPE),u=n.getLocation();s?o=new yi(yi.ADD_MASK,i,c,u):o=new yi(yi.REMOVE_MASK,i)}}else o=new yi(yi.REMOVE_MASK,i);const l=this.getRoomOwnObject(t);l&&l.logic&&o&&l.logic.processUpdateMessage(o)}rollRoomObjectFloor(t,e,s,i){const n=this.getRoomObjectFloor(t,e);n&&n.processUpdateMessage(new nl(s,i,null,!!i))}updateRoomObjectWallLocation(t,e,s){const i=this.getRoomObjectWall(t,e);return i?(i.logic&&i.logic.processUpdateMessage(new nl(s,null,null)),this.updateRoomObjectMask(t,e),!0):!1}addRoomObjectUser(t,e,s,i,n,o,l){if(this.getRoomObjectUser(t,e))return!1;let u=me.getTypeString(o);u===me.PET&&(u=this.getPetType(l));const h=this.createRoomObjectUser(t,e,u);return h?(h.processUpdateMessage(new cf(this.fixedUserLocation(t,s),null,i,n,!1,0)),l&&h.processUpdateMessage(new of(l)),this.events&&this.events.dispatchEvent(new Rt(Rt.ADDED,t,e,W.UNIT)),!0):!1}updateRoomObjectUserLocation(t,e,s,i,n=!1,o=0,l=null,c=NaN){const u=this.getRoomObjectUser(t,e);if(!u)return!1;s||(s=u.getLocation()),l||(l=u.getDirection()),isNaN(c)&&(c=u.model.getValue(C.HEAD_DIRECTION)),u.processUpdateMessage(new cf(this.fixedUserLocation(t,s),this.fixedUserLocation(t,i),l,c,n,o));const h=this._roomSessionManager&&this._roomSessionManager.getSession(t)||null;return h&&h.ownRoomIndex===e&&this._logicFactory.events.dispatchEvent(new ih(ih.ROAME_MOVE_TO,i)),!0}fixedUserLocation(t,e){if(!e)return null;const s=this.getFurnitureStackingHeightMap(t),i=this.getLegacyWallGeometry(t);if(!s||!i)return e;let n=e.z;const o=s.getTileHeight(e.x,e.y),l=i.getHeight(e.x,e.y);return Math.abs(n-o)<.1&&Math.abs(o-l)<.1&&(n=i.getFloorAltitude(e.x,e.y)),new j(e.x,e.y,n)}updateRoomObjectUserAction(t,e,s,i,n=null){const o=this.getRoomObjectUser(t,e);if(!o)return!1;let l=null;switch(s){case C.FIGURE_TALK:l=new EO(i);break;case C.FIGURE_SLEEP:l=new IO(i===1);break;case C.FIGURE_IS_TYPING:l=new BU(i===1);break;case C.FIGURE_IS_MUTED:l=new PU(i===1);break;case C.FIGURE_CARRY_OBJECT:l=new xU(i,n);break;case C.FIGURE_USE_OBJECT:l=new kU(i);break;case C.FIGURE_DANCE:l=new MU(i);break;case C.FIGURE_GAINED_EXPERIENCE:l=new DU(i);break;case C.FIGURE_NUMBER_VALUE:l=new wU(i);break;case C.FIGURE_SIGN:l=new GU(i);break;case C.FIGURE_EXPRESSION:l=new bU(i);break;case C.FIGURE_IS_PLAYING_GAME:l=new FU(i===1);break;case C.FIGURE_GUIDE_STATUS:l=new MX(i);break}return l?(o.processUpdateMessage(l),!0):!1}updateRoomObjectUserFigure(t,e,s,i=null,n=null,o=!1){const l=this.getRoomObjectUser(t,e);return l?(l.processUpdateMessage(new of(s,i,n,o)),!0):!1}updateRoomObjectUserFlatControl(t,e,s){const i=this.getRoomObjectUser(t,e);return i?(i.processUpdateMessage(new vU(parseInt(s))),!0):!1}updateRoomObjectUserEffect(t,e,s,i=0){const n=this.getRoomObjectUser(t,e);return n?(n.processUpdateMessage(new yU(s,i)),!0):!1}updateRoomObjectUserGesture(t,e,s){const i=this.getRoomObjectUser(t,e);return i?(i.processUpdateMessage(new LU(s)),!0):!1}updateRoomObjectUserPetGesture(t,e,s){const i=this.getRoomObjectUser(t,e);return i?(i.processUpdateMessage(new jU(s)),!0):!1}updateRoomObjectUserPosture(t,e,s,i=null){const n=this.getRoomObjectUser(t,e);return n?(n.processUpdateMessage(new pO(s,i)),!0):!1}updateRoomObjectUserOwn(t,e){const s=this.getRoomObjectUser(t,e);s&&s.processUpdateMessage(new UU)}useRoomObject(t,e){const s=this.getRoomObject(this._activeRoomId,t,e);if(s){const i=s.logic;if(i)return i.useObject(),!0}return!1}objectInitialized(t,e,s){const i=this.getRoomIdFromString(t);s===W.WALL&&this.updateRoomObjectMask(i,e);const n=this.getRoomObject(i,e,s);if(n&&n.model&&n.logic){const o=n.model.getValue(C.FURNITURE_DATA_FORMAT);if(!isNaN(o)){const l=Aa.getData(o);l.initializeFromRoomObjectModel(n.model),n.processUpdateMessage(new je(n.getState(0),l))}this.events.dispatchEvent(new Rt(Rt.CONTENT_UPDATED,i,e,s))}t!==re.TEMPORARY_ROOM&&this.addObjectToTileMap(i,n)}changeObjectModelData(t,e,s,i,n){const o=this.getObject(this.getRoomId(t),e,s);if(!o||!o.logic)return!1;const l=new HU(i,n);return o.processUpdateMessage(l),!0}changeObjectState(t,e,s){const i=this.getObject(this.getRoomId(t),e,s);if(!i||!i.model)return;let n=i.model.getValue(C.FURNITURE_AUTOMATIC_STATE_INDEX);isNaN(n)?n=1:n=n+1,i.model.setValue(C.FURNITURE_AUTOMATIC_STATE_INDEX,n);const o=i.model.getValue(C.FURNITURE_DATA_FORMAT),l=Aa.getData(o);l.initializeFromRoomObjectModel(i.model),i.logic&&i.logic.processUpdateMessage(new je(n,l))}loadRoomObjectBadgeImage(t,e,s,i,n=!0){if(!this._sessionDataManager)return;let o=null;if(t===0){const c=this._roomManager.getRoomInstance(re.TEMPORARY_ROOM);c&&(o=c.getRoomObject(e,s))}else o=this.getRoomObjectFloor(t,e);if(!o||!o.logic)return;let l=n?this._sessionDataManager.loadGroupBadgeImage(i):this._sessionDataManager.loadBadgeImage(i);if(l)this.putBadgeInObjectAssets(o,i,n);else{l="loading_icon",this._badgeListenerObjects||(this._badgeListenerObjects=new Map),this._badgeListenerObjects.size||this._sessionDataManager.events.addEventListener(Eo.IMAGE_READY,this.onBadgeImageReadyEvent);let c=this._badgeListenerObjects.get(i);c||(c=[]),c.push(new nq(o,n)),this._badgeListenerObjects.set(i,c)}o.logic.processUpdateMessage(new xc(i,l))}onBadgeImageReadyEvent(t){if(!this._sessionDataManager)return;const e=this._badgeListenerObjects&&this._badgeListenerObjects.get(t.badgeId);if(e){for(const s of e){if(!s)continue;this.putBadgeInObjectAssets(s.object,t.badgeId,s.groupBadge);const i=s.groupBadge?this._sessionDataManager.loadGroupBadgeImage(t.badgeId):this._sessionDataManager.loadBadgeImage(t.badgeId);s.object&&s.object.logic&&s.object.logic.processUpdateMessage(new xc(t.badgeId,i))}this._badgeListenerObjects.delete(t.badgeId),this._badgeListenerObjects.size||this._sessionDataManager.events.removeEventListener(Eo.IMAGE_READY,this.onBadgeImageReadyEvent)}}putBadgeInObjectAssets(t,e,s=!1){if(!this._roomContentLoader||!this._sessionDataManager)return;const i=s?this._sessionDataManager.loadGroupBadgeImage(e):this._sessionDataManager.loadBadgeImage(e),n=s?this._sessionDataManager.getGroupBadgeImage(e):this._sessionDataManager.getBadgeImage(e);n&&this._roomContentLoader.addAssetToCollection(t.type,i,n,!1)}dispatchMouseEvent(t,e,s,i,n,o,l,c){const u=this.getRoomInstanceRenderingCanvas(this._activeRoomId,t);if(!u)return;const h=this.getRenderingCanvasOverlay(u),d=this.getOverlayIconSprite(h,re.OBJECT_ICON_SPRITE);if(d){const g=d.getLocalBounds();d.x=e-g.width/2,d.y=s-g.height/2}if(!this.handleRoomDragging(u,e,s,i,n,o,l)&&!u.handleMouseEvent(e,s,i,n,o,l,c)){let g=null;i===at.MOUSE_CLICK?(this.events&&this.events.dispatchEvent(new Rt(Rt.DESELECTED,this._activeRoomId,-1,W.MINIMUM)),g=Gt.CLICK):i===at.MOUSE_MOVE?g=Gt.MOUSE_MOVE:i===at.MOUSE_DOWN?g=Gt.MOUSE_DOWN:i===at.MOUSE_DOWN_LONG?g=Gt.MOUSE_DOWN_LONG:i===at.MOUSE_UP&&(g=Gt.MOUSE_UP),this._roomObjectEventHandler.handleRoomObjectEvent(new Gt(g,this.getRoomObject(this._activeRoomId,re.ROOM_OBJECT_ID,W.ROOM),null,n),this._activeRoomId)}this._activeRoomActiveCanvas=t,this._activeRoomActiveCanvasMouseX=e,this._activeRoomActiveCanvasMouseY=s}handleRoomDragging(t,e,s,i,n,o,l){let c=e-this._activeRoomActiveCanvasMouseX,u=s-this._activeRoomActiveCanvasMouseY;if(i===at.MOUSE_DOWN)!n&&!o&&!l&&!this.isDecorating&&this._roomAllowsDragging&&(this._activeRoomIsDragged=!0,this._activeRoomWasDragged=!1,this._activeRoomDragStartX=this._activeRoomActiveCanvasMouseX,this._activeRoomDragStartY=this._activeRoomActiveCanvasMouseY);else if(i===at.MOUSE_UP){if(this._activeRoomIsDragged&&(this._activeRoomIsDragged=!1,this._activeRoomWasDragged)){const h=this.getRoomInstanceData(this._activeRoomId);if(h){const d=h.roomCamera;d&&(this.useOffsetScrolling&&(d.isMoving||(d.centeredLocX=!1,d.centeredLocY=!1),d.resetLocation(new j(-t.screenOffsetX,-t.screenOffsetY))),this._roomDraggingAlwaysCenters&&d.reset())}}}else if(i===at.MOUSE_MOVE)this._activeRoomIsDragged&&(this._activeRoomWasDragged||(c=e-this._activeRoomDragStartX,u=s-this._activeRoomDragStartY,(c<=-re.DRAG_THRESHOLD||c>=re.DRAG_THRESHOLD||u<=-re.DRAG_THRESHOLD||u>=re.DRAG_THRESHOLD)&&(this._activeRoomWasDragged=!0),c=0,u=0),(c!=0||u!=0)&&(this._activeRoomDragX+=c,this._activeRoomDragY+=u,this._activeRoomWasDragged=!0));else if((i===at.MOUSE_CLICK||i===at.DOUBLE_CLICK)&&(this._activeRoomIsDragged=!1,this._activeRoomWasDragged))return this._activeRoomWasDragged=!1,!0;return!1}updateMousePointer(t,e,s){const i=this.getRoomObjectCategoryForType(s);switch(t){case lt.MOUSE_BUTTON:this.setMouseButton(this._activeRoomId,i,e);return;default:this.setMouseDefault(this._activeRoomId,i,e);return}}setMouseButton(t,e,s){if(!this._roomSessionManager)return;const i=this._roomSessionManager.getSession(t);if(i&&(e!==W.FLOOR&&e!==W.WALL||i.controllerLevel>=Oe.GUEST)){const n=this.getRoomInstanceData(t);n&&n.addButtonMouseCursorOwner(e+"_"+s)&&(this._mouseCursorUpdate=!0)}}setMouseDefault(t,e,s){if(!this._roomSessionManager)return;const i=this.getRoomInstanceData(t);i&&i.removeButtonMouseCursorOwner(e+"_"+s)&&(this._mouseCursorUpdate=!0)}processRoomObjectOperation(t,e,s){if(!this._roomObjectEventHandler)return!1;this._roomObjectEventHandler.modifyRoomObject(this._activeRoomId,t,e,s)}modifyRoomObjectDataWithMap(t,e,s,i){if(!this._roomObjectEventHandler)return!1;e===W.FLOOR&&this._roomObjectEventHandler.modifyRoomObjectDataWithMap(this._activeRoomId,t,e,s,i)}modifyRoomObjectData(t,e,s,i){if(!this._roomObjectEventHandler)return!1;e===W.WALL&&this._roomObjectEventHandler.modifyWallItemData(this._activeRoomId,t,s,i)}processRoomObjectEvent(t){if(!this._roomObjectEventHandler)return;const e=this.getRoomObjectRoomId(t.object);if(!e)return;const s=this.getRoomIdFromString(e);this._roomObjectEventHandler.handleRoomObjectEvent(t,s)}processRoomObjectPlacement(t,e,s,i,n=null,o=null,l=-1,c=-1,u=null){const h=this.getRoomInstance(this._activeRoomId);return!h||h.model.getValue(cs.ROOM_IS_PUBLIC)!==0||!this._roomObjectEventHandler?!1:this._roomObjectEventHandler.processRoomObjectPlacement(t,this._activeRoomId,e,s,i,n,o,l,c,u)}getRoomObjectScreenLocation(t,e,s,i=-1){i==-1&&(i=this._activeRoomActiveCanvas);const n=this.getRoomInstanceGeometry(t,i);if(!n)return null;const o=this.getRoomObject(t,e,s);if(!o)return null;const l=n.getScreenPoint(o.getLocation());if(!l)return null;const c=this.getRoomInstanceRenderingCanvas(t,i);return c?(l.x=l.x*c.scale,l.y=l.y*c.scale,l.x+=c.width/2+c.screenOffsetX,l.y+=c.height/2+c.screenOffsetY,l.x=Math.round(l.x),l.y=Math.round(l.y),l):null}selectRoomObject(t,e,s){this._roomObjectEventHandler&&this._roomObjectEventHandler.setSelectedObject(t,e,s)}setSelectedAvatar(t,e){this._roomObjectEventHandler||this._roomObjectEventHandler.setSelectedAvatar(t,e,!0)}cancelRoomObjectInsert(){this._roomObjectEventHandler&&this._roomObjectEventHandler.cancelRoomObjectInsert(this._activeRoomId)}addOverlayIconSprite(t,e,s,i=1){if(!t||!s)return;let n=this.getOverlayIconSprite(t,e);return n?null:(n=new Xe(s),n.name=e,n.scale.set(i),t.addChild(n),n)}onRoomContentLoaded(t,e,s){if(!this._roomContentLoader||t===-1)return;this._thumbnailObjectIdBank.freeNumber(t-1);const i=this._thumbnailCallbacks.get(e);if(i){this._thumbnailCallbacks.delete(e);const n=this._roomContentLoader.getImage(e);if(n)for(const o of i)o&&o.imageReady(t,null,n)}}setObjectMoverIconSprite(t,e,s,i=null,n=null,o=-1,l=-1,c=null){let u=null,h=0,d=null;const g=1;if(s)d=this.getRoomObjectImage(this._activeRoomId,t,e,new j,1,null);else if(this._roomContentLoader)if(e===W.FLOOR?(u=this._roomContentLoader.getFurnitureFloorNameForTypeId(t),h=this._roomContentLoader.getFurnitureFloorColorIndex(t)):e===W.WALL&&(u=this._roomContentLoader.getFurnitureWallNameForTypeId(t,i),h=this._roomContentLoader.getFurnitureWallColorIndex(t)),e===W.UNIT)if(u=me.getTypeString(t),u==="pet"){u=this.getPetType(i);const p=new La(i);d=this.getRoomObjectPetImage(p.typeId,p.paletteId,p.color,new j(180),64,null,!0,0,p.customParts,c)}else d=this.getGenericRoomObjectImage(u,i,new j(180),64,null,0,null,n,o,l,c);else d=this.getGenericRoomObjectImage(u,h.toString(),new j,1,null,0,i,n,o,l,c);if(!d||!d.data)return;const E=this.getActiveRoomInstanceRenderingCanvas();if(!E)return;const m=this.getRenderingCanvasOverlay(E);this.removeOverlayIconSprite(m,re.OBJECT_ICON_SPRITE);const I=this.addOverlayIconSprite(m,re.OBJECT_ICON_SPRITE,d.data,g);I&&(I.x=this._activeRoomActiveCanvasMouseX-d.data.width/2,I.y=this._activeRoomActiveCanvasMouseY-d.data.height/2)}getRoomObjectImage(t,e,s,i,n,o,l=0){if(!this._roomManager)return null;let c=-1,u=null,h=null,d="",g=null;const E=this.getRoomId(t),m=this._roomManager.getRoomInstance(E);if(m){const I=m.getRoomObject(e,s);if(I&&I.model)switch(c=I.id,u=I.type,s){case W.FLOOR:case W.WALL:{d=I.model.getValue(C.FURNITURE_COLOR).toString(),g=I.model.getValue(C.FURNITURE_EXTRAS);const p=I.model.getValue(C.FURNITURE_DATA_FORMAT);p!==wi.FORMAT_KEY&&(h=Aa.getData(p),h.initializeFromRoomObjectModel(I.model));break}case W.UNIT:d=I.model.getValue(C.FIGURE);break}}return this.getGenericRoomObjectImage(u,d,i,n,o,l,g,h,-1,-1,null,c)}getFurnitureFloorIconUrl(t){let e=null,s="";return this._roomContentLoader?(e=this._roomContentLoader.getFurnitureFloorNameForTypeId(t),s=this._roomContentLoader.getFurnitureFloorColorIndex(t).toString(),this._roomContentLoader.getAssetIconUrl(e,s)):null}getFurnitureFloorIcon(t,e,s=null,i=null){return this.getFurnitureFloorImage(t,new j,1,e,0,s,-1,-1,i)}getFurnitureWallIconUrl(t,e=null){let s=null,i="";return this._roomContentLoader?(s=this._roomContentLoader.getFurnitureWallNameForTypeId(t,e),i=this._roomContentLoader.getFurnitureWallColorIndex(t).toString(),this._roomContentLoader.getAssetIconUrl(s,i)):null}getFurnitureWallIcon(t,e,s=null){return this.getFurnitureWallImage(t,new j,1,e,0,s)}getFurnitureFloorImage(t,e,s,i,n=0,o=null,l=-1,c=-1,u=null){let h=null,d="";return this._roomContentLoader&&(h=this._roomContentLoader.getFurnitureFloorNameForTypeId(t),d=this._roomContentLoader.getFurnitureFloorColorIndex(t).toString()),s===1&&i?this.getGenericRoomObjectThumbnail(h,d,i,o,u):this.getGenericRoomObjectImage(h,d,e,s,i,n,o,u,l,c)}getFurnitureWallImage(t,e,s,i,n=0,o=null,l=-1,c=-1){let u=null,h="";return this._roomContentLoader&&(u=this._roomContentLoader.getFurnitureWallNameForTypeId(t),h=this._roomContentLoader.getFurnitureWallColorIndex(t).toString()),s===1&&i?this.getGenericRoomObjectThumbnail(u,h,i,o,null):this.getGenericRoomObjectImage(u,h,e,s,i,n,o,null,l,c)}getRoomObjectPetImage(t,e,s,i,n,o,l=!1,c=0,u=null,h=null){let d=null,g=t+" "+e+" "+s.toString(16);if(l&&(g=g+" head"),u){g=g+(" "+u.length);for(const E of u)g=g+(" "+E.layerId+" "+E.partId+" "+E.paletteId)}return this._roomContentLoader&&(d=this._roomContentLoader.getPetNameForType(t)),this.getGenericRoomObjectImage(d,g,i,n,o,c,null,null,-1,-1,h)}getGenericRoomObjectImage(t,e,s,i,n,o=0,l=null,c=null,u=-1,h=-1,d=null,g=-1){if(!this._roomManager)return null;const E=new XC;if(E.id=-1,!this._ready||!t)return E;let m=this._roomManager.getRoomInstance(re.TEMPORARY_ROOM);if(!m&&(m=this._roomManager.createRoomInstance(re.TEMPORARY_ROOM),!m))return E;let I=this._imageObjectIdBank.reserveNumber();const p=this.getRoomObjectCategoryForType(t);if(I<0)return E;I++;const T=m.createRoomObjectAndInitalize(I,t,p);if(!T||!T.model||!T.logic)return E;const R=T.model;switch(p){case W.FLOOR:case W.WALL:R.setValue(C.FURNITURE_COLOR,parseInt(e)),R.setValue(C.FURNITURE_EXTRAS,l);break;case W.UNIT:if(t===me.USER||t===me.BOT||t===me.RENTABLE_BOT||t===me.PET)R.setValue(C.FIGURE,e);else{const P=new La(e);R.setValue(C.PET_PALETTE_INDEX,P.paletteId),R.setValue(C.PET_COLOR,P.color),P.headOnly&&R.setValue(C.PET_HEAD_ONLY,1),P.hasCustomParts&&(R.setValue(C.PET_CUSTOM_LAYER_IDS,P.customLayerIds),R.setValue(C.PET_CUSTOM_PARTS_IDS,P.customPartIds),R.setValue(C.PET_CUSTOM_PALETTE_IDS,P.customPaletteIds)),d&&R.setValue(C.FIGURE_POSTURE,d)}break}T.setDirection(s);const S=T.visualization;if(!S)return m.removeRoomObject(I,p),E;(u>-1||c)&&(c&&c.getLegacyString()!==""?T.logic.processUpdateMessage(new je(parseInt(c.getLegacyString()),c)):T.logic.processUpdateMessage(new je(u,c)));const b=new dl(i,new j(-135,30,0),new j(11,11,5));if(S.update(b,0,!0,!1),h>0){let P=0;for(;P<h;)S.update(b,0,!0,!1),P++}const N=S.getImage(o,g);if(E.data=N,E.id=I,!this.isRoomContentTypeLoaded(t)&&n){let P=this._imageCallbacks.get(I.toString());P||(P=[],this._imageCallbacks.set(I.toString(),P)),P.push(n),R.setValue(C.IMAGE_QUERY_SCALE,i)}else m.removeRoomObject(I,p),this._imageObjectIdBank.freeNumber(I-1),E.id=0;return b.dispose(),E}getGenericRoomObjectThumbnail(t,e,s,i=null,n=null){if(!this._roomManager)return null;const o=new XC;if(o.id=-1,!this._ready||!t)return o;let l=this._roomManager.getRoomInstance(re.TEMPORARY_ROOM);if(!l&&(l=this._roomManager.createRoomInstance(re.TEMPORARY_ROOM),!l))return o;let c=this._thumbnailObjectIdBank.reserveNumber();if(this.getRoomObjectCategoryForType(t),c<0)return o;c++,o.id=c,o.data=null,o.image=null;const u=[t,e].join("_"),h=this._roomContentLoader.getImage(u);if(!h&&s){let d=this._thumbnailCallbacks.get(u);d||(d=[],this._thumbnailCallbacks.set(u,d),this._roomContentLoader.downloadImage(c,t,e,null)),d.push(s)}else h&&(o.image=h),this._thumbnailObjectIdBank.freeNumber(c-1),o.id=0;return o}initalizeTemporaryObjectsByType(t,e){const s=this._roomManager.getRoomInstance(re.TEMPORARY_ROOM);if(!s||!this._roomContentLoader)return;const i=this._roomContentLoader.getCategoryForType(t),n=s.getManager(i);let o=null,l=0;if(n&&n.objects.length){for(const c of n.objects.getValues())if(c&&c.model&&c.type===t){const u=c.id,h=c.visualization;let d=null;if(h){const E=c.model.getValue(C.IMAGE_QUERY_SCALE);o&&l!==E&&(o.dispose(),o=null),o||(l=E,o=new dl(E,new j(-135,30,0),new j(11,11,5))),h.update(o,0,!0,!1),d=h.image}s.removeRoomObject(u,i),this._imageObjectIdBank.freeNumber(u-1);const g=this._imageCallbacks.get(u.toString());if(g){this._imageCallbacks.delete(u.toString());for(const E of g)E&&(d?E.imageReady(u,d):E.imageFailed(u))}}}o&&o.dispose()}setObjectMoverIconSpriteVisible(t){const e=this.getActiveRoomInstanceRenderingCanvas();if(!e)return;const s=this.getRenderingCanvasOverlay(e),i=this.getOverlayIconSprite(s,re.OBJECT_ICON_SPRITE);i&&(i.visible=t)}removeObjectMoverIconSprite(){const t=this.getActiveRoomInstanceRenderingCanvas();if(!t)return;const e=this.getRenderingCanvasOverlay(t);this.removeOverlayIconSprite(e,re.OBJECT_ICON_SPRITE)}getRenderingCanvasOverlay(t){if(!t)return null;const e=t.master;return e&&e.getChildByName(re.OVERLAY)||null}removeOverlayIconSprite(t,e){if(!t)return!1;let s=t.children.length-1;for(;s>=0;){const i=t.getChildAt(s);if(i&&i.name===e){if(t.removeChildAt(s),i.children.length){const n=i.getChildAt(0);n.parent.removeChild(n),n.destroy()}return!0}s--}return!1}getOverlayIconSprite(t,e){if(!t)return null;let s=t.children.length-1;for(;s>=0;){const i=t.getChildAt(s);if(i&&i.name===e)return i;s--}return null}getRoomObjects(t,e){if(this._ready){const s=this.getRoomId(t),i=this._roomManager.getRoomInstance(s);if(i)return i.getRoomObjectsForCategory(e)}return[]}addObjectToTileMap(t,e){const s=this.getRoomInstanceData(t).tileObjectMap;s&&s.addRoomObject(e)}refreshTileObjectMap(t,e){const s=this.getRoomInstanceData(t).tileObjectMap;s&&s.populate(this.getRoomObjects(t,W.FLOOR))}getRenderRoomMessage(t,e,s=!1,i=!0,n=!1,o=-1){let l=null;if(o>-1?l=this.getRoomInstanceRenderingCanvas(this._activeRoomId,o):l=this.getActiveRoomInstanceRenderingCanvas(),!l)return null;n&&l.skipSpriteVisibilityChecking();let c=-1;!i&&this._roomSessionManager.getSession(this._activeRoomId)!=null&&(c=this._roomSessionManager.getSession(this._activeRoomId).ownRoomIndex);const u=new GR,h=u.getFurniData(t,l,this,c),d=u.getRoomRenderingModifiers(this),g=u.getRoomPlanes(t,l,this,e);return n&&l.resumeSpriteVisibilityChecking(),dt.log(h,d,g),null}createTextureFromRoom(t,e=-1,s=null){let i=null;e>-1?i=this.getRoomInstanceRenderingCanvas(this._activeRoomId,e):i=this.getActiveRoomInstanceRenderingCanvas();let n=null;return s?n=Ee.generateTexture(i.master,s):n=i.getDisplayAsTexture(),n}saveTextureAsScreenshot(t,e=!1){let s=null;e?s=new bT:s=new nf,s.assignBitmap(t),this._communication.connection.send(s)}saveBase64AsScreenshot(t,e=!1){let s=null;e?s=new bT:s=new nf,s.assignBase64(t),this._communication.connection.send(s)}objectsInitialized(t){const e=this.getRoomIdFromString(t);this.events.dispatchEvent(new te(te.OBJECTS_INITIALIZED,e))}getRoomId(t){return t.toString()}getRoomIdFromString(t){if(!t)return-1;const e=t.split("_");return e.length<=0?-1:parseInt(e[0])||0}getRoomObjectRoomId(t){return!t||!t.model?null:t.model.getValue(C.OBJECT_ROOM_ID)}getRoomObjectAdUrl(t){return this._roomContentLoader.getRoomObjectAdUrl(t)}getPetTypeId(t){let e=-1;if(t){const s=t.split(" ");s.length>1&&(e=parseInt(s[0]))}return e}getPetType(t){if(!t)return null;const e=t.split(" ");if(e.length>1){const s=parseInt(e[0]);return this._roomContentLoader?this._roomContentLoader.getPetNameForType(s):"pet"}return null}isRoomContentTypeLoaded(t){return this._roomContentLoader?this._roomContentLoader.getCollection(t)!==null:!1}getPetColorResult(t,e){return this._roomContentLoader?this._roomContentLoader.getPetColorResult(t,e):null}getPetColorResultsForTag(t,e){return this._roomContentLoader?this._roomContentLoader.getPetColorResultsForTag(t,e):null}deleteRoomObject(t,e){return!this._roomObjectEventHandler||e!==W.WALL?!1:this._roomObjectEventHandler.deleteWallItem(this._activeRoomId,t)}get connection(){return this._communication.connection}get sessionDataManager(){return this._sessionDataManager}set sessionDataManager(t){this._sessionDataManager=t}get roomSessionManager(){return this._roomSessionManager}set roomSessionManager(t){this._roomSessionManager=t}get roomManager(){return this._roomManager}set roomManager(t){this._roomManager=t}get objectEventHandler(){return this._roomObjectEventHandler}get roomRendererFactory(){return this._roomRendererFactory}get visualizationFactory(){return this._visualizationFactory}get logicFactory(){return this._logicFactory}get activeRoomId(){return this._activeRoomId}get ready(){return this._ready}get roomContentLoader(){return this._roomContentLoader}get isDecorating(){if(!this._roomSessionManager)return!1;const t=this._roomSessionManager.getSession(this._activeRoomId);return t&&t.isDecorating||!1}get useOffsetScrolling(){return!0}get selectedAvatarId(){return this._roomObjectEventHandler?this._roomObjectEventHandler.selectedAvatarId:-1}getRoomObjectCount(t,e){return this._roomManager==null?0:this._roomManager.getRoomInstance(t.toString()).getRoomObjectsForCategory(e).length}};re.ROOM_OBJECT_ID=-1,re.ROOM_OBJECT_TYPE="room",re.CURSOR_OBJECT_ID=-2,re.CURSOR_OBJECT_TYPE="tile_cursor",re.ARROW_OBJECT_ID=-3,re.ARROW_OBJECT_TYPE="selection_arrow",re.OVERLAY="overlay",re.OBJECT_ICON_SPRITE="object_icon_sprite",re.DRAG_THRESHOLD=15,re.TEMPORARY_ROOM="temporary_room";let r_=re;const ct=class ct{constructor(t,e=1){this._previewRoomId=1,this._currentPreviewObjectType=0,this._currentPreviewObjectCategory=0,this._currentPreviewObjectData="",this._currentPreviewRectangle=null,this._currentPreviewCanvasWidth=0,this._currentPreviewCanvasHeight=0,this._currentPreviewScale=64,this._backgroundColor=305148561,this._backgroundSprite=null,this._disableUpdate=!1,this._roomEngine=t,this._planeParser=new Ws,this._previewRoomId=wn.makeRoomPreviewerId(e),this._addViewOffset=new wt(0,0),this.onRoomObjectAdded=this.onRoomObjectAdded.bind(this),this.onRoomInitializedonRoomInitialized=this.onRoomInitializedonRoomInitialized.bind(this),this.isRoomEngineReady&&this._roomEngine.events&&(this._roomEngine.events.addEventListener(Rt.ADDED,this.onRoomObjectAdded),this._roomEngine.events.addEventListener(Rt.CONTENT_UPDATED,this.onRoomObjectAdded),this._roomEngine.events.addEventListener(te.INITIALIZED,this.onRoomInitializedonRoomInitialized)),this.createRoomForPreview()}dispose(){this.reset(!0),this.isRoomEngineReady&&this._roomEngine.events&&(this._roomEngine.events.removeEventListener(Rt.ADDED,this.onRoomObjectAdded),this._roomEngine.events.removeEventListener(Rt.CONTENT_UPDATED,this.onRoomObjectAdded),this._roomEngine.events.removeEventListener(te.INITIALIZED,this.onRoomInitializedonRoomInitialized)),this._backgroundSprite&&(this._backgroundSprite.destroy(),this._backgroundSprite=null),this._planeParser&&(this._planeParser.dispose(),this._planeParser=null)}createRoomForPreview(){if(this.isRoomEngineReady){const e=new Ws;e.initializeTileMap(9,9);let s=1;for(;s<8;){let i=1;for(;i<8;)e.setTileHeight(i,s,0),i++;s++}e.initializeFromTileData(),this._roomEngine.createRoomInstance(this._previewRoomId,e.getMapData()),e.dispose()}}reset(t){this.isRoomEngineReady&&(this._roomEngine.removeRoomObjectFloor(this._previewRoomId,ct.PREVIEW_OBJECT_ID),this._roomEngine.removeRoomObjectWall(this._previewRoomId,ct.PREVIEW_OBJECT_ID),this._roomEngine.removeRoomObjectUser(this._previewRoomId,ct.PREVIEW_OBJECT_ID),t||this.updatePreviewRoomView()),this._currentPreviewObjectCategory=W.MINIMUM}updatePreviewModel(t,e,s=!0){const i=new Gg;i.flush(),i.parseModel(t,e,s);const n=this._roomEngine.getLegacyWallGeometry(this._previewRoomId);if(!n)return;this._planeParser.reset();const o=i.width,l=i.height;this._planeParser.initializeTileMap(o,l);const c=null;let u=-1,h=-1,d=0,g=0,E=0;for(;E<l;){let T=0;for(;T<o;){const R=i.getHeight(T,E);(E>0&&E<l-1||T>0&&T<o-1)&&R!=Ws.TILE_BLOCKED&&c==null&&(i.getHeight(T,E-1)==Ws.TILE_BLOCKED&&i.getHeight(T-1,E)==Ws.TILE_BLOCKED&&i.getHeight(T,E+1)==Ws.TILE_BLOCKED&&(u=T+.5,h=E,d=R,g=90),i.getHeight(T,E-1)==Ws.TILE_BLOCKED&&i.getHeight(T-1,E)==Ws.TILE_BLOCKED&&i.getHeight(T+1,E)==Ws.TILE_BLOCKED&&(u=T,h=E+.5,d=R,g=180)),this._planeParser.setTileHeight(T,E,R),T++}E++}this._planeParser.setTileHeight(Math.floor(u),Math.floor(h),d),this._planeParser.initializeFromTileData(i.wallHeight),this._planeParser.setTileHeight(Math.floor(u),Math.floor(h),d+this._planeParser.wallHeight),n.scale=i_.DEFAULT_SCALE,n.initialize(o,l,this._planeParser.floorHeight);let m=i.height-1;for(;m>=0;){let T=i.width-1;for(;T>=0;)n.setHeight(T,m,this._planeParser.getTileHeight(T,m)),T--;m--}const I=this._planeParser.getMapData();I.doors.push({x:u,y:h,z:d,dir:g});const p=this.getRoomPreviewOwnRoomObject();p&&p.processUpdateMessage(new uf(I))}addFurnitureIntoRoom(t,e,s=null,i=null){if(s||(s=new wi),this.isRoomEngineReady&&(this.reset(!1),this._currentPreviewObjectType=t,this._currentPreviewObjectCategory=W.FLOOR,this._currentPreviewObjectData="",this._roomEngine.addFurnitureFloor(this._previewRoomId,ct.PREVIEW_OBJECT_ID,t,new j(ct.PREVIEW_OBJECT_LOCATION_X,ct.PREVIEW_OBJECT_LOCATION_Y,0),e,0,s,NaN,-1,0,-1,"",!0,!1))){this._previousAutomaticStateChangeTime=Pt(),this._automaticStateChange=!0;const n=this._roomEngine.getRoomObject(this._previewRoomId,ct.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory);return n&&i&&n.model.setValue(C.FURNITURE_EXTRAS,i),this.updatePreviewRoomView(),ct.PREVIEW_OBJECT_ID}return-1}addWallItemIntoRoom(t,e,s){if(this.isRoomEngineReady){if(this._currentPreviewObjectCategory===W.WALL&&this._currentPreviewObjectType===t&&this._currentPreviewObjectData===s)return ct.PREVIEW_OBJECT_ID;if(this.reset(!1),this._currentPreviewObjectType=t,this._currentPreviewObjectCategory=W.WALL,this._currentPreviewObjectData=s,this._roomEngine.addFurnitureWall(this._previewRoomId,ct.PREVIEW_OBJECT_ID,t,new j(.5,2.3,1.8),e,0,s,0,0,-1,"",!1))return this._previousAutomaticStateChangeTime=Pt(),this._automaticStateChange=!0,this.updatePreviewRoomView(),ct.PREVIEW_OBJECT_ID}return-1}addAvatarIntoRoom(t,e){return this.isRoomEngineReady?(this.reset(!1),this._currentPreviewObjectType=1,this._currentPreviewObjectCategory=W.UNIT,this._currentPreviewObjectData=t,this._roomEngine.addRoomObjectUser(this._previewRoomId,ct.PREVIEW_OBJECT_ID,new j(ct.PREVIEW_OBJECT_LOCATION_X,ct.PREVIEW_OBJECT_LOCATION_Y,0),new j(90,0,0),135,me.getTypeNumber(me.USER),t)&&(this._previousAutomaticStateChangeTime=Pt(),this._automaticStateChange=!0,this.updateUserGesture(1),this.updateUserEffect(e),this.updateUserPosture("std")),this.updatePreviewRoomView(),ct.PREVIEW_OBJECT_ID):-1}addPetIntoRoom(t){return this.isRoomEngineReady?(this.reset(!1),this._currentPreviewObjectType=1,this._currentPreviewObjectCategory=W.UNIT,this._currentPreviewObjectData=t,this._roomEngine.addRoomObjectUser(this._previewRoomId,ct.PREVIEW_OBJECT_ID,new j(ct.PREVIEW_OBJECT_LOCATION_X,ct.PREVIEW_OBJECT_LOCATION_Y,0),new j(90,0,0),90,me.getTypeNumber(me.PET),t)&&(this._previousAutomaticStateChangeTime=Pt(),this._automaticStateChange=!1,this.updateUserGesture(1),this.updateUserPosture("std")),this.updatePreviewRoomView(),ct.PREVIEW_OBJECT_ID):-1}updateUserPosture(t,e=""){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserPosture(this._previewRoomId,ct.PREVIEW_OBJECT_ID,t,e)}updateUserGesture(t){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserGesture(this._previewRoomId,ct.PREVIEW_OBJECT_ID,t)}updateUserEffect(t){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserEffect(this._previewRoomId,ct.PREVIEW_OBJECT_ID,t)}updateObjectUserFigure(t,e=null,s=null,i=!1){return this.isRoomEngineReady?this._roomEngine.updateRoomObjectUserFigure(this._previewRoomId,ct.PREVIEW_OBJECT_ID,t,e,s,i):!1}updateObjectUserAction(t,e,s=null){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserAction(this._previewRoomId,ct.PREVIEW_OBJECT_ID,t,e,s)}updateObjectStuffData(t){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectFloor(this._previewRoomId,ct.PREVIEW_OBJECT_ID,null,null,t.state,t)}changeRoomObjectState(){this.isRoomEngineReady&&(this._automaticStateChange=!1,this._currentPreviewObjectCategory!==W.UNIT&&this._roomEngine.changeObjectState(this._previewRoomId,ct.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory))}changeRoomObjectDirection(){if(this.isRoomEngineReady){const t=this._roomEngine.getRoomObject(this._previewRoomId,ct.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory);if(!t)return;const e=this._roomEngine.objectEventHandler.getValidRoomObjectDirection(t,!0);switch(this._currentPreviewObjectCategory){case W.FLOOR:{const s=new j(ct.PREVIEW_OBJECT_LOCATION_X,ct.PREVIEW_OBJECT_LOCATION_Y),i=new j(e,e,e);this._roomEngine.updateRoomObjectFloor(this._previewRoomId,ct.PREVIEW_OBJECT_ID,s,i,null,null);return}case W.WALL:return}}}checkAutomaticRoomObjectStateChange(){if(this._automaticStateChange){const t=Pt();t>this._previousAutomaticStateChangeTime+ct.AUTOMATIC_STATE_CHANGE_INTERVAL&&(this._previousAutomaticStateChangeTime=t,this.isRoomEngineReady&&this._roomEngine.changeObjectState(this._previewRoomId,ct.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory))}}getRoomCanvas(t,e){if(this.isRoomEngineReady){const s=this._roomEngine.getRoomInstanceDisplay(this._previewRoomId,ct.PREVIEW_CANVAS_ID,t,e,this._currentPreviewScale);if(s&&this._backgroundColor!==null){let n=this._backgroundSprite;n||(n=new Xe(Es.WHITE),s.addChildAt(n,0)),n.width=t,n.height=e,n.tint=this._backgroundColor}this._roomEngine.setRoomInstanceRenderingCanvasMask(this._previewRoomId,ct.PREVIEW_CANVAS_ID,!0);const i=this._roomEngine.getRoomInstanceGeometry(this._previewRoomId,ct.PREVIEW_CANVAS_ID);return i&&i.adjustLocation(new j(ct.PREVIEW_OBJECT_LOCATION_X,ct.PREVIEW_OBJECT_LOCATION_Y,0),30),this._currentPreviewCanvasWidth=t,this._currentPreviewCanvasHeight=e,s}return null}modifyRoomCanvas(t,e){this.isRoomEngineReady&&(this._currentPreviewCanvasWidth=t,this._currentPreviewCanvasHeight=e,this._backgroundSprite&&(this._backgroundSprite.width=t,this._backgroundSprite.height=e),this._roomEngine.initializeRoomInstanceRenderingCanvas(this._previewRoomId,ct.PREVIEW_CANVAS_ID,t,e))}set addViewOffset(t){this._addViewOffset=t}get addViewOffset(){return this._addViewOffset}updatePreviewObjectBoundingRectangle(t){const e=this._roomEngine.getRoomObjectBoundingRectangle(this._previewRoomId,ct.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory,ct.PREVIEW_CANVAS_ID);if(e&&t)if(e.x+=-(this._currentPreviewCanvasWidth>>1),e.y+=-(this._currentPreviewCanvasHeight>>1),e.x+=-t.x,e.y+=-t.y,!this._currentPreviewRectangle)this._currentPreviewRectangle=e;else{const s=this._currentPreviewRectangle.clone().enlarge(e);(s.width-this._currentPreviewRectangle.width>this._currentPreviewCanvasWidth-this._currentPreviewRectangle.width>>1||s.height-this._currentPreviewRectangle.height>this._currentPreviewCanvasHeight-this._currentPreviewRectangle.height>>1||this._currentPreviewRectangle.width<1||this._currentPreviewRectangle.height<1)&&(this._currentPreviewRectangle=s)}}validatePreviewSize(t){if(this._currentPreviewRectangle.width<1||this._currentPreviewRectangle.height<1)return t;if(this.isRoomEngineReady){const e=this._roomEngine.getRoomInstanceGeometry(this._previewRoomId,ct.PREVIEW_CANVAS_ID);this._currentPreviewRectangle.width>this._currentPreviewCanvasWidth*(1+ct.ALLOWED_IMAGE_CUT)||this._currentPreviewRectangle.height>this._currentPreviewCanvasHeight*(1+ct.ALLOWED_IMAGE_CUT)?ct.ZOOM_ENABLED?this._roomEngine.getRoomInstanceRenderingCanvasScale(this._previewRoomId,ct.PREVIEW_CANVAS_ID)!==.5&&(this._roomEngine.setRoomInstanceRenderingCanvasScale(this._previewRoomId,ct.PREVIEW_CANVAS_ID,.5,null,null),this._currentPreviewScale=ct.SCALE_SMALL,this._currentPreviewNeedsZoomOut=!0,t.x=t.x>>1,t.y=t.y>>1,this._currentPreviewRectangle.x=this._currentPreviewRectangle.x>>2,this._currentPreviewRectangle.y=this._currentPreviewRectangle.y>>2,this._currentPreviewRectangle.width=this._currentPreviewRectangle.width>>2,this._currentPreviewRectangle.height=this._currentPreviewRectangle.height>>2):e.isZoomedIn()&&(e.performZoomOut(),this._currentPreviewScale=ct.SCALE_SMALL,this._currentPreviewNeedsZoomOut=!0):this._currentPreviewNeedsZoomOut||(ct.ZOOM_ENABLED?this._roomEngine.getRoomInstanceRenderingCanvasScale(this._previewRoomId,ct.PREVIEW_CANVAS_ID)!==1&&(this._roomEngine.setRoomInstanceRenderingCanvasScale(this._previewRoomId,ct.PREVIEW_CANVAS_ID,1,null,null),this._currentPreviewScale=ct.SCALE_NORMAL):e.isZoomedIn()||(e.performZoomIn(),this._currentPreviewScale=ct.SCALE_NORMAL))}return t}zoomIn(){this.isRoomEngineReady&&(ct.ZOOM_ENABLED?this._roomEngine.setRoomInstanceRenderingCanvasScale(this._previewRoomId,ct.PREVIEW_CANVAS_ID,1):this._roomEngine.getRoomInstanceGeometry(this._previewRoomId,ct.PREVIEW_CANVAS_ID).performZoomIn()),this._currentPreviewScale=ct.SCALE_NORMAL}zoomOut(){this.isRoomEngineReady&&(ct.ZOOM_ENABLED?this._roomEngine.setRoomInstanceRenderingCanvasScale(this._previewRoomId,ct.PREVIEW_CANVAS_ID,.5):this._roomEngine.getRoomInstanceGeometry(this._previewRoomId,ct.PREVIEW_CANVAS_ID).performZoomOut()),this._currentPreviewScale=ct.SCALE_SMALL}updateAvatarDirection(t,e){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserLocation(this._previewRoomId,ct.PREVIEW_OBJECT_ID,new j(ct.PREVIEW_OBJECT_LOCATION_X,ct.PREVIEW_OBJECT_LOCATION_Y,0),new j(ct.PREVIEW_OBJECT_LOCATION_X,ct.PREVIEW_OBJECT_LOCATION_Y,0),!1,0,new j(t*45,0,0),e*45)}updateObjectRoom(t=null,e=null,s=null,i=!1){return this.isRoomEngineReady?this._roomEngine.updateRoomInstancePlaneType(this._previewRoomId,t,e,s,i):!1}updateRoomWallsAndFloorVisibility(t,e=!0){this.isRoomEngineReady&&this._roomEngine.updateRoomInstancePlaneVisibility(this._previewRoomId,t,e)}getCanvasOffset(t){if(this._currentPreviewRectangle.width<1||this._currentPreviewRectangle.height<1)return t;let e=-(this._currentPreviewRectangle.left+this._currentPreviewRectangle.right)>>1,s=-(this._currentPreviewRectangle.top+this._currentPreviewRectangle.bottom)>>1;const i=this._currentPreviewCanvasHeight-this._currentPreviewRectangle.height>>1;i>10?s=s+Math.min(15,i-10):this._currentPreviewObjectCategory!==W.UNIT?s=s+(5-Math.max(0,i/2)):s=s-(5-Math.min(0,i/2)),s=s+this._addViewOffset.y,e=e+this._addViewOffset.x;const n=e-t.x,o=s-t.y;if(n!==0||o!==0){const l=Math.sqrt(n*n+o*o);return l>10&&(e=t.x+n*10/l,s=t.y+o*10/l),new wt(e,s)}return null}updatePreviewRoomView(t=!1){if(!(this._disableUpdate&&!t)&&(this.checkAutomaticRoomObjectStateChange(),this.isRoomEngineReady)){let e=this._roomEngine.getRoomInstanceRenderingCanvasOffset(this._previewRoomId,ct.PREVIEW_CANVAS_ID);if(e&&(this.updatePreviewObjectBoundingRectangle(e),this._currentPreviewRectangle)){const s=this._currentPreviewScale;e=this.validatePreviewSize(e);const i=this.getCanvasOffset(e);i&&this._roomEngine.setRoomInstanceRenderingCanvasOffset(this._previewRoomId,ct.PREVIEW_CANVAS_ID,i),this._currentPreviewScale!==s&&(this._currentPreviewRectangle=null)}}}set disableUpdate(t){this._disableUpdate=t}set disableRoomEngineUpdate(t){this.isRoomEngineReady&&this._roomEngine.disableUpdate(t)}onRoomInitializedonRoomInitialized(t){if(t)switch(t.type){case te.INITIALIZED:t.roomId===this._previewRoomId&&this.isRoomEngineReady&&this._roomEngine.updateRoomInstancePlaneType(this._previewRoomId,"110","99999");return}}onRoomObjectAdded(t){if(t.roomId===this._previewRoomId&&t.objectId===ct.PREVIEW_OBJECT_ID&&t.category===this._currentPreviewObjectCategory){this._currentPreviewRectangle=null,this._currentPreviewNeedsZoomOut=!1;const e=this._roomEngine.getRoomObject(t.roomId,t.objectId,t.category);if(e&&e.model&&t.category===W.WALL){const s=e.model.getValue(C.FURNITURE_SIZE_Z),i=e.model.getValue(C.FURNITURE_CENTER_Z);(s!==null||i!==null)&&this._roomEngine.updateRoomObjectWallLocation(t.roomId,t.objectId,new j(.5,2.3,(3.6-s)/2+i))}}}updateRoomEngine(){this.isRoomEngineReady&&this._roomEngine.runUpdate()}getRenderingCanvas(){const t=this._roomEngine.getRoomInstanceRenderingCanvas(this._previewRoomId,ct.PREVIEW_CANVAS_ID);return t||null}getGenericRoomObjectImage(t,e,s,i,n,o=0,l=null,c=null,u=-1,h=-1,d=null){return this.isRoomEngineReady?this._roomEngine.getGenericRoomObjectImage(t,e,s,i,n,o,l,c,u,h,d):null}getRoomObjectImage(t,e,s,i=0){return this.isRoomEngineReady?this._roomEngine.getRoomObjectImage(this._previewRoomId,ct.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory,t,e,s,i):null}getRoomObjectCurrentImage(){if(this.isRoomEngineReady){const t=this._roomEngine.getRoomObject(this._previewRoomId,ct.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory);if(t&&t.visualization)return t.visualization.getImage(16777215,-1)}return null}getRoomPreviewObject(){if(this.isRoomEngineReady){const t=this._roomEngine.getRoomObject(this._previewRoomId,ct.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory);if(t)return t}return null}getRoomPreviewOwnRoomObject(){if(this.isRoomEngineReady){const t=this._roomEngine.getRoomObject(this._previewRoomId,r_.ROOM_OBJECT_ID,W.ROOM);if(t)return t}return null}get isRoomEngineReady(){return this._roomEngine&&this._roomEngine.ready}get roomId(){return this._previewRoomId}get backgroundColor(){return this._backgroundColor}set backgroundColor(t){this._backgroundColor=t}get width(){return this._currentPreviewCanvasWidth}get height(){return this._currentPreviewCanvasHeight}};ct.SCALE_NORMAL=64,ct.SCALE_SMALL=32,ct.PREVIEW_COUNTER=0,ct.PREVIEW_CANVAS_ID=1,ct.PREVIEW_OBJECT_ID=1,ct.PREVIEW_OBJECT_LOCATION_X=2,ct.PREVIEW_OBJECT_LOCATION_Y=2,ct.ALLOWED_IMAGE_CUT=.25,ct.AUTOMATIC_STATE_CHANGE_INTERVAL=2500,ct.ZOOM_ENABLED=!0;let dh=ct;class tA{constructor(t,e){this._image=t,this._placeHolder=e}get image(){return this._image}get placeHolder(){return this._placeHolder}}class cq{constructor(t){this._code=t,this._parts=[]}get code(){return this._code}get parts(){return this._parts}}var rs;let Zu=(rs=class{constructor(t,e=0,s=0,i=0){this.type=t,this.key=e,this.color=s,this.position=i}get code(){return this.key===0?null:rs.getCode(this.type,this.key,this.color,this.position)}static getCode(t,e,s,i){return(t===rs.BASE?t:e>=100?rs.SYMBOL_ALT:rs.SYMBOL)+(e<10?"0":"")+(t===rs.BASE?e:e>=100?e-100:e)+(s<10?"0":"")+s+i}calculatePosition(t){const e=this.calculateGridPos(this.position);let s=rs.CELL_WIDTH*e.x+rs.CELL_WIDTH/2-t.width/2,i=rs.CELL_HEIGHT*e.y+rs.CELL_HEIGHT/2-t.height/2;return s<0&&(s=0),s+t.width>rs.IMAGE_WIDTH&&(s=rs.IMAGE_WIDTH-t.width),i<0&&(i=0),i+t.height>rs.IMAGE_HEIGHT&&(i=rs.IMAGE_HEIGHT-t.height),new ei(Math.floor(s),Math.floor(i))}calculateGridPos(t){const e=new ei;return e.x=Math.floor(t%3),e.y=Math.floor(t/3),e}},rs.BASE="b",rs.SYMBOL="s",rs.SYMBOL_ALT="t",rs.BASE_PART=0,rs.LAYER_PART=1,rs.IMAGE_WIDTH=39,rs.IMAGE_HEIGHT=39,rs.CELL_WIDTH=13,rs.CELL_HEIGHT=13,rs);const sn=class sn{constructor(t,e){this._assets=t,this._sessionDataManager=e,this._groupBases=new Map,this._groupSymbols=new Map,this._groupPartColors=new Map,this._requestedBadges=new Map,this._groupBadgesQueue=new Map,this._readyToGenerateGroupBadges=!1}init(){if(this._sessionDataManager&&this._sessionDataManager.communication){this._messages=[new LS(this.onGroupBadgePartsEvent.bind(this))];for(const t of this._messages)this._sessionDataManager.communication.registerMessageEvent(t)}}dispose(){if(this._messages&&this._messages.length){for(const t of this._messages)this._sessionDataManager.communication.removeMessageEvent(t);this._messages=null}this._sessionDataManager=null}getBadgeImage(t,e=sn.NORMAL_BADGE,s=!0){let i=this.getBadgeTexture(t,e);return!i&&s&&(i=this.getBadgePlaceholder()),i}getBadgeInfo(t){const e=this.getBadgeTexture(t);return e?new tA(e,!1):new tA(this.getBadgePlaceholder(),!0)}loadBadgeImage(t,e=sn.NORMAL_BADGE){return this._assets.getTexture(this.getBadgeUrl(t,e))?t:(this.getBadgeTexture(t,e),null)}getBadgeTexture(t,e=sn.NORMAL_BADGE){const s=this.getBadgeUrl(t,e);if(!s||!s.length)return null;const i=this._assets.getTexture(s);if(i)return i.clone();if(e===sn.NORMAL_BADGE){if(this._requestedBadges.get(t))return null;this._requestedBadges.set(t,!0),this._assets.downloadAsset(s).then(n=>{if(!n)return;this._requestedBadges.delete(t);const o=this._assets.getTexture(s);o&&this._sessionDataManager&&this._sessionDataManager.events.dispatchEvent(new Eo(t,o.clone()))}).catch(n=>{})}else if(e===sn.GROUP_BADGE){if(this._groupBadgesQueue.get(t))return;this._groupBadgesQueue.set(t,!0),this._readyToGenerateGroupBadges&&this.loadGroupBadge(t)}return null}getBadgePlaceholder(){const t=Dt.getValue("images.url")+"/loading_icon.png",e=this._assets.getTexture(t);return e?e.clone():null}getBadgeUrl(t,e=sn.NORMAL_BADGE){let s=null;switch(e){case sn.NORMAL_BADGE:s=Dt.getValue("badge.asset.url").replace("%badgename%",t);break;case sn.GROUP_BADGE:s=t;break}return s}loadGroupBadge(t){const e=new cq(t),s=[...t.matchAll(/[b|s][0-9]{4,6}/g)];for(const i of s){const n=i[0],o=n.length===6,l=n[0],c=parseInt(n.slice(1,o?3:4)),u=parseInt(n.slice(o?3:4,o?5:6)),h=n.length<6?0:parseInt(n.slice(o?5:6,o?6:7)),d=new Zu(l,c,u,h);e.parts.push(d)}this.renderGroupBadge(e)}renderGroupBadge(t){const e=new hn,s=new Xe(gS.EMPTY);s.width=Zu.IMAGE_WIDTH,s.height=Zu.IMAGE_HEIGHT,e.addChild(s);for(const n of t.parts){let o=!0;const l=n.type==="b"?this._groupBases.get(n.key):this._groupSymbols.get(n.key);if(l)for(const c of l){if(!c||!c.length)continue;const u=this._assets.getTexture(`badgepart_${c}`);if(!u)continue;const{x:h,y:d}=n.calculatePosition(u),g=new Xe(u);g.position.set(h,d),o&&(g.tint=parseInt(this._groupPartColors.get(n.color),16)),o=!1,e.addChild(g)}}this._requestedBadges.delete(t.code),this._groupBadgesQueue.delete(t.code);const i=Ee.generateTexture(e);this._assets.setTexture(t.code,i),this._sessionDataManager&&this._sessionDataManager.events.dispatchEvent(new Eo(t.code,i))}onGroupBadgePartsEvent(t){if(!t)return;const e=t.getParser();if(e){e.bases.forEach((s,i)=>this._groupBases.set(i,s.map(n=>n.replace(".png","").replace(".gif","")))),e.symbols.forEach((s,i)=>this._groupSymbols.set(i,s.map(n=>n.replace(".png","").replace(".gif","")))),this._groupPartColors=e.partColors,this._readyToGenerateGroupBadges=!0;for(const s of this._groupBadgesQueue.keys())this.loadGroupBadge(s)}}get disposed(){return!!this._sessionDataManager}};sn.GROUP_BADGE="group_badge",sn.NORMAL_BADGE="normal_badge";let su=sn;class eA{constructor(t,e,s,i,n,o,l,c,u,h,d,g,E,m,I,p,T,R,S,b,N,P,B,F,w,U,G,K,z){this._type=t,this._id=e,this._fullName=s,this._className=i,this._category=n,this._revision=c,this._tileSizeX=u,this._tileSizeY=h,this._tileSizeZ=d,this._colors=g,this._hasIndexedColor=E,this._colourIndex=m,this._localizedName=o,this._description=l,this._adUrl=I,this._purchaseOfferId=p,this._purchaseCouldBeUsedForBuyout=T,this._rentOfferId=R,this._rentCouldBeUsedForBuyout=S,this._customParams=N,this._specialType=P,this._availableForBuildersClub=b,this._canStandOn=B,this._canSitOn=F,this._canLayOn=w,this._excludedFromDynamic=U,this._furniLine=G,this._environment=K,this._rare=z}get type(){return this._type}get id(){return this._id}get className(){return this._className}set className(t){this._className=t}get fullName(){return this._fullName}get category(){return this._category}get hasIndexedColor(){return this._hasIndexedColor}get colorIndex(){return this._colourIndex}get revision(){return this._revision}get tileSizeX(){return this._tileSizeX}get tileSizeY(){return this._tileSizeY}get tileSizeZ(){return this._tileSizeZ}get colors(){return this._colors}get name(){return this._localizedName}get description(){return this._description}get adUrl(){return this._adUrl}get purchaseOfferId(){return this._purchaseOfferId}get customParams(){return this._customParams}get specialType(){return this._specialType}get rentOfferId(){return this._rentOfferId}get purchaseCouldBeUsedForBuyout(){return this._purchaseCouldBeUsedForBuyout}get rentCouldBeUsedForBuyout(){return this._rentCouldBeUsedForBuyout}get availableForBuildersClub(){return this._availableForBuildersClub}get canStandOn(){return this._canStandOn}get canSitOn(){return this._canSitOn}get canLayOn(){return this._canLayOn}get isExternalImage(){return this._className.indexOf("external_image")!==-1}get excludeDynamic(){return this._excludedFromDynamic}get furniLine(){return this._furniLine}get environment(){return this._environment}get rare(){return this._rare}}const Uu=class Uu extends nr{constructor(t,e,s){super(),this._floorItems=t,this._wallItems=e,this._localization=s}loadFurnitureData(t){t&&fetch(t).then(e=>e.json()).then(e=>this.onFurnitureDataLoaded(e)).catch(e=>this.onFurnitureDataError(e))}onFurnitureDataLoaded(t){t&&((typeof t.roomitemtypes>"u"||typeof t.wallitemtypes>"u")&&dt.warn("Could not find `roomitemtypes` or `wallitemtypes` in furnidata."),t.roomitemtypes&&this.parseFloorItems(t.roomitemtypes),t.wallitemtypes&&this.parseWallItems(t.wallitemtypes),this.dispatchEvent(new kt(Uu.FURNITURE_DATA_READY)))}onFurnitureDataError(t){t&&(dt.error(t),this.dispatchEvent(new kt(Uu.FURNITURE_DATA_ERROR)))}parseFloorItems(t){if(!(!t||!t.furnitype))for(const e of t.furnitype){if(!e)continue;const s=[];if(e.partcolors)for(const u of e.partcolors.color){let h=u;h.charAt(0)==="#"&&(h=h.replace("#","")),s.push(parseInt(h,16))}const i=e.classname.split("*"),n=i[0],o=i.length>1?parseInt(i[1]):0,l=i.length>1,c=new eA(oc.FLOOR,e.id,e.classname,n,e.category,e.name,e.description,e.revision,e.xdim,e.ydim,0,s,l,o,e.adurl,e.offerid,e.buyout,e.rentofferid,e.rentbuyout,e.bc,e.customparams,e.specialtype,e.canstandon,e.cansiton,e.canlayon,e.excludeddynamic,e.furniline,e.environment,e.rare);this._floorItems.set(c.id,c),this.updateLocalizations(c)}}parseWallItems(t){if(!(!t||!t.furnitype))for(const e of t.furnitype){if(!e)continue;const s=new eA(oc.WALL,e.id,e.classname,e.classname,e.category,e.name,e.description,e.revision,0,0,0,null,!1,0,e.adurl,e.offerid,e.buyout,e.rentofferid,e.rentbuyout,e.bc,null,e.specialtype,!1,!1,!1,e.excludeddynamic,e.furniline,e.environment,e.rare);this._wallItems.set(s.id,s),this.updateLocalizations(s)}}updateLocalizations(t){if(this._localization)switch(t.type){case oc.FLOOR:this._localization.setValue("roomItem.name."+t.id,t.name),this._localization.setValue("roomItem.desc."+t.id,t.description);return;case oc.WALL:this._localization.setValue("wallItem.name."+t.id,t.name),this._localization.setValue("wallItem.desc."+t.id,t.description);return}}};Uu.FURNITURE_DATA_READY="FDP_FURNITURE_DATA_READY",Uu.FURNITURE_DATA_ERROR="FDP_FURNITURE_DATA_ERROR";let bh=Uu;class uq{constructor(t){this._sessionDataManager=t,this._groupBadges=new Map}init(){if(this._sessionDataManager&&this._sessionDataManager.communication){this._messages=[new oh(this.onRoomReadyMessageEvent.bind(this)),new rb(this.onGroupBadgesEvent.bind(this))];for(const t of this._messages)this._sessionDataManager.communication.registerMessageEvent(t)}}dispose(){if(!this.disposed){if(this._messages&&this._messages.length){for(const t of this._messages)this._sessionDataManager.communication.removeMessageEvent(t);this._messages=null}this._groupBadges=null,this._sessionDataManager=null}}onRoomReadyMessageEvent(t){this._sessionDataManager.send(new EU)}onGroupBadgesEvent(t){const e=t.getParser();for(const[s,i]of e.badges.entries())this._groupBadges.set(s,i)}getGroupBadge(t){return this._groupBadges.get(t)}get disposed(){return!!this._sessionDataManager}}const Td=class Td{};Td.NO_CLUB=0,Td.CLUB=1,Td.VIP=2;let Fi=Td;class Yn extends Ar{constructor(t,e){super(),this._connection=t,this._listener=e,this._roomId=0}onDispose(){this._connection=null,this._listener=null}setRoomId(t){this._roomId=t}get connection(){return this._connection}get listener(){return this._listener}get roomId(){return this._roomId}}class hq extends Yn{constructor(t,e){super(t,e),t.addMessageEvent(new Hg(this.onRoomGenericError.bind(this)))}onRoomGenericError(t){if(!(t instanceof Hg))return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);if(!s)return;let i=null;switch(e.errorCode){case nI.KICKED_OUT_OF_ROOM:i=le.RSEME_KICKED;break;default:return}!i||i.length==0||this.listener.events.dispatchEvent(new le(i,s))}}class dq extends Yn{constructor(t,e){super(t,e),t.addMessageEvent(new Ky(this.onOpenPetPackageRequested.bind(this))),t.addMessageEvent(new Xy(this.onOpenPetPackageResult.bind(this)))}onOpenPetPackageRequested(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&this.listener.events.dispatchEvent(new Zo(Zo.RSOPPE_OPEN_PET_PACKAGE_REQUESTED,s,e.objectId,e.figureData,0,null))}onOpenPetPackageResult(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&this.listener.events.dispatchEvent(new Zo(Zo.RSOPPE_OPEN_PET_PACKAGE_RESULT,s,e.objectId,null,e.nameValidationStatus,e.nameValidationInfo))}}class _q extends Yn{constructor(t,e){super(t,e),t.addMessageEvent(new $y(this.onPollContentsEvent.bind(this))),t.addMessageEvent(new tD(this.onPollOfferEvent.bind(this))),t.addMessageEvent(new Zy(this.onPollErrorEvent.bind(this))),t.addMessageEvent(new nD(this.onStartRoomPollEvent.bind(this))),t.addMessageEvent(new rD(this.onRoomPollResultEvent.bind(this)))}onPollContentsEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const i=new vn(vn.CONTENT,e,s.id);i.startMessage=s.startMessage,i.endMessage=s.endMessage,i.numQuestions=s.numQuestions,i.questionArray=s.questionArray,i.npsPoll=s.npsPoll,this.listener.events.dispatchEvent(i)}onPollOfferEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const i=new vn(vn.OFFER,e,s.id);i.summary=s.headline,i.summary=s.summary,this.listener.events.dispatchEvent(i)}onPollErrorEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e||!t.getParser())return;const i=new vn(vn.ERROR,e,-1);i.headline="???",i.summary="???",this.listener.events.dispatchEvent(i)}onStartRoomPollEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const i=new Jc(Jc.VOTE_QUESTION,e,s.question,s.choices);this.listener.events.dispatchEvent(i)}onRoomPollResultEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const i=new Jc(Jc.VOTE_RESULT,e,s.question,s.choices,s.SafeStr_7651,s.SafeStr_7654);this.listener.events.dispatchEvent(i)}}class gq extends Yn{constructor(t,e){super(t,e),t.addMessageEvent(new WS(this.onRoomUnitChatEvent.bind(this))),t.addMessageEvent(new $g(this.onRoomUnitChatEvent.bind(this))),t.addMessageEvent(new Zg(this.onRoomUnitChatEvent.bind(this))),t.addMessageEvent(new LD(this.onRoomUnitHandItemReceivedEvent.bind(this))),t.addMessageEvent(new QS(this.onRespectReceivedEvent.bind(this))),t.addMessageEvent(new ub(this.onPetRespectNoficationEvent.bind(this))),t.addMessageEvent(new hb(this.onPetSupplementedNotificationEvent.bind(this))),t.addMessageEvent(new bD(this.onFloodControlEvent.bind(this))),t.addMessageEvent(new vD(this.onRemainingMuteEvent.bind(this)))}onRoomUnitChatEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;let i=ue.CHAT_TYPE_SPEAK;t instanceof $g?i=ue.CHAT_TYPE_SHOUT:t instanceof Zg&&(i=ue.CHAT_TYPE_WHISPER);const n=new ue(ue.CHAT_EVENT,e,s.roomIndex,s.message,i,s.bubble);this.listener.events.dispatchEvent(n)}onRoomUnitHandItemReceivedEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();s&&this.listener.events.dispatchEvent(new ue(ue.CHAT_EVENT,e,s.giverUserId,"",ue.CHAT_TYPE_HAND_ITEM_RECEIVED,Jo.GENERIC,null,s.handItemType))}onRespectReceivedEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const i=e.userDataManager.getUserData(s.userId);i&&this.listener.events.dispatchEvent(new ue(ue.CHAT_EVENT,e,i.roomIndex,"",ue.CHAT_TYPE_RESPECT,Jo.GENERIC))}onPetRespectNoficationEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const i=e.userDataManager.getPetData(s.petData.id);if(!i)return;let n=ue.CHAT_TYPE_PETRESPECT;s.isTreat&&(n=ue.CHAT_TYPE_PETTREAT),this.listener.events.dispatchEvent(new ue(ue.CHAT_EVENT,e,i.roomIndex,"",n,Jo.GENERIC))}onPetSupplementedNotificationEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const i=e.userDataManager.getPetData(s.petId);if(!i)return;let n=-1;const o=e.userDataManager.getUserData(s.userId);o&&(n=o.roomIndex);let l=ue.CHAT_TYPE_PETREVIVE;switch(s.supplementType){case yh.REVIVE:l=ue.CHAT_TYPE_PETREVIVE;break;case yh.REBREED_FERTILIZER:l=ue.CHAT_TYPE_PET_REBREED_FERTILIZE;break;case yh.SPEED_FERTILIZER:l=ue.CHAT_TYPE_PET_SPEED_FERTILIZE;break}this.listener.events.dispatchEvent(new ue(ue.CHAT_EVENT,e,i.roomIndex,"",l,Jo.GENERIC,null,n))}onFloodControlEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const i=s.seconds;this.listener.events.dispatchEvent(new ue(ue.FLOOD_EVENT,e,-1,i.toString(),0,0))}onRemainingMuteEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();s&&this.listener.events.dispatchEvent(new ue(ue.CHAT_EVENT,e,e.ownRoomIndex,"",ue.CHAT_TYPE_MUTE_REMAINING,Jo.GENERIC,null,s.seconds))}}class fq extends Yn{constructor(t,e){super(t,e),t.addMessageEvent(new po(this.onGetGuestRoomResultEvent.bind(this)))}onGetGuestRoomResultEvent(t){if(!(t instanceof po))return;const e=t.getParser();if(!e||e.roomForward)return;const s=this.listener.getSession(this.roomId);if(!s)return;const i=e.data;s.tradeMode=i.tradeMode,s.isGuildRoom=i.habboGroupId!==0,s.doorMode=i.doorMode,s.allowPets=i.allowPets,s.moderationSettings=e.moderation,this.listener.events.dispatchEvent(new Ng(Ng.RSDUE_ALLOW_PETS,s)),this.listener.events.dispatchEvent(new Mt(Mt.ROOM_DATA,s))}}class mq extends Yn{constructor(t,e){super(t,e),t.addMessageEvent(new TD(this.onRoomDimmerPresets.bind(this)))}onRoomDimmerPresets(t){if(!t)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);if(!s)return;const i=new Hd(Hd.ROOM_DIMMER_PRESETS,s);i.selectedPresetId=e.selectedPresetId;let n=0;for(;n<e.presetCount;){const o=e.getPreset(n);o&&i.storePreset(o.id,o.type,o.color,o.brightness),n++}this.listener&&this.listener.events.dispatchEvent(i)}}class Eq extends Yn{constructor(t,e){super(t,e),t.addMessageEvent(new sT(this.onRoomRightsEvent.bind(this))),t.addMessageEvent(new eT(this.onRoomRightsClearEvent.bind(this))),t.addMessageEvent(new iT(this.onRoomRightsOwnerEvent.bind(this)))}onRoomRightsEvent(t){if(!(t instanceof sT))return;const e=this.listener.getSession(this.roomId);e&&e.setControllerLevel(t.getParser().controllerLevel)}onRoomRightsClearEvent(t){if(!(t instanceof eT))return;const e=this.listener.getSession(this.roomId);e&&e.setControllerLevel(Oe.NONE)}onRoomRightsOwnerEvent(t){if(!(t instanceof iT))return;const e=this.listener.getSession(this.roomId);e&&e.setRoomOwner()}}class pq extends Yn{constructor(t,e){super(t,e),t&&t.addMessageEvent(new jM(this.onFurnitureGiftOpenedEvent.bind(this)))}onFurnitureGiftOpenedEvent(t){if(!t)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&this.listener&&this.listener.events&&this.listener.events.dispatchEvent(new Wd(Wd.RSPE_PRESENT_OPENED,s,e.classId,e.itemType,e.productCode,e.placedItemId,e.placedItemType,e.placedInRoom,e.petFigureString))}}const so=class so extends Yn{constructor(t,e){super(t,e),t.addMessageEvent(new Kg(this.onRoomEnterEvent.bind(this))),t.addMessageEvent(new oh(this.onRoomReadyMessageEvent.bind(this))),t.addMessageEvent(new $d(this.onDesktopViewEvent.bind(this))),t.addMessageEvent(new zg(this.onRoomDoorbellAcceptedEvent.bind(this))),t.addMessageEvent(new Yg(this.onRoomDoorbellRejectedEvent.bind(this))),t.addMessageEvent(new DD(this.onYouAreSpectatorMessageEvent.bind(this))),t.addMessageEvent(new lx(this.onBobbaPlaySound.bind(this)))}onBobbaPlaySound(t){if(!t)return;const e=t.getParser();e&&Et.instance.roomEngine.events.dispatchEvent(new un(un.PLAY_SOUNDBOARD,e.soundUrl))}onRoomEnterEvent(t){t instanceof Kg&&this.listener&&this.listener.sessionUpdate(this.roomId,so.RS_CONNECTED)}onRoomReadyMessageEvent(t){if(!(t instanceof oh))return;const e=this.roomId,s=t.getParser().roomId;this.listener&&(this.listener.sessionReinitialize(e,s),this.listener.sessionUpdate(this.roomId,so.RS_READY))}onDesktopViewEvent(t){t instanceof $d&&this.listener&&this.listener.sessionUpdate(this.roomId,so.RS_DISCONNECTED)}onRoomDoorbellAcceptedEvent(t){if(!(t instanceof zg)||!this.listener)return;const e=t.getParser();if(!e)return;const s=e.userName;if(!s||!s.length)this.connection.send(new FP(this.roomId));else if(this.listener.events){const i=this.listener.getSession(this.roomId);if(!i)return;this.listener.events.dispatchEvent(new jn(jn.RSDE_ACCEPTED,i,s))}}onRoomDoorbellRejectedEvent(t){if(!(t instanceof Yg)||!this.listener)return;const e=t.getParser();if(!e)return;const s=e.userName;if(!s||!s.length)this.listener.sessionUpdate(this.roomId,so.RS_DISCONNECTED);else if(this.listener.events){const i=this.listener.getSession(this.roomId);if(!i)return;this.listener.events.dispatchEvent(new jn(jn.RSDE_REJECTED,i,s))}}onYouAreSpectatorMessageEvent(t){if(this.listener){const e=this.listener.getSession(this.roomId);if(!e)return;e.isSpectator=!0,this.listener.events.dispatchEvent(new xg(xg.SPECTATOR_MODE,e))}}};so.RS_CONNECTED="RS_CONNECTED",so.RS_READY="RS_READY",so.RS_DISCONNECTED="RS_DISCONNECTED";let iu=so;class Iq{constructor(){this._adultLevel=7}get id(){return this._id}set id(t){this._id=t}get level(){return this._level}set level(t){this._level=t}get maximumLevel(){return this._maximumLevel}set maximumLevel(t){this._maximumLevel=t}get experience(){return this._experience}set experience(t){this._experience=t}get levelExperienceGoal(){return this._levelExperienceGoal}set levelExperienceGoal(t){this._levelExperienceGoal=t}get energy(){return this._energy}set energy(t){this._energy=t}get maximumEnergy(){return this._maximumEnergy}set maximumEnergy(t){this._maximumEnergy=t}get happyness(){return this._happyness}set happyness(t){this._happyness=t}get maximumHappyness(){return this._maximumHappyness}set maximumHappyness(t){this._maximumHappyness=t}get ownerId(){return this._ownerId}set ownerId(t){this._ownerId=t}get ownerName(){return this._ownerName}set ownerName(t){this._ownerName=t}get respect(){return this._respect}set respect(t){this._respect=t}get age(){return this._age}set age(t){this._age=t}get unknownRarity(){return this._unknownRarity}set unknownRarity(t){this._unknownRarity=t}get saddle(){return this._saddle}set saddle(t){this._saddle=t}get rider(){return this._rider}set rider(t){this._rider=t}get skillTresholds(){return this._skillThresholds}set skillTresholds(t){this._skillThresholds=t}get publiclyRideable(){return this._publiclyRideable}set publiclyRideable(t){this._publiclyRideable=t}get breedable(){return this._breedable}set breedable(t){this._breedable=t}get fullyGrown(){return this._fullyGrown}set fullyGrown(t){this._fullyGrown=t}get dead(){return this._dead}set dead(t){this._dead=t}get rarityLevel(){return this._rarityLevel}set rarityLevel(t){this._rarityLevel=t}get maximumTimeToLive(){return this._maximumTimeToLive}set maximumTimeToLive(t){this._maximumTimeToLive=t}get remainingTimeToLive(){return this._remainingTimeToLive}set remainingTimeToLive(t){this._remainingTimeToLive=t}get remainingGrowTime(){return this._remainingGrowTime}set remainingGrowTime(t){this._remainingGrowTime=t}get publiclyBreedable(){return this._publiclyBreedable}set publiclyBreedable(t){this._publiclyBreedable=t}get adultLevel(){return this._adultLevel}}class s0{constructor(t){this._roomIndex=-1,this._name="",this._type=0,this._sex="",this._figure="",this._custom="",this._webID=0,this._groupID=0,this._groupStatus=0,this._groupName="",this._ownerId=0,this._ownerName="",this._petLevel=0,this._rarityLevel=0,this._roomIndex=t}get roomIndex(){return this._roomIndex}get activityPoints(){return this._activityPoints}set activityPoints(t){this._activityPoints=t}get name(){return this._name}set name(t){this._name=t}get type(){return this._type}set type(t){this._type=t}get sex(){return this._sex}set sex(t){this._sex=t}get figure(){return this._figure}set figure(t){this._figure=t}get custom(){return this._custom}set custom(t){this._custom=t}get webID(){return this._webID}set webID(t){this._webID=t}get groupId(){return this._groupID}set groupId(t){this._groupID=t}get groupName(){return this._groupName}set groupName(t){this._groupName=t}get groupStatus(){return this._groupStatus}set groupStatus(t){this._groupStatus=t}get ownerId(){return this._ownerId}set ownerId(t){this._ownerId=t}get ownerName(){return this._ownerName}set ownerName(t){this._ownerName=t}get rarityLevel(){return this._rarityLevel}set rarityLevel(t){this._rarityLevel=t}get hasSaddle(){return this._hasSaddle}set hasSaddle(t){this._hasSaddle=t}get isRiding(){return this._isRiding}set isRiding(t){this._isRiding=t}get canBreed(){return this._canBreed}set canBreed(t){this._canBreed=t}get canHarvest(){return this._canHarvest}set canHarvest(t){this._canHarvest=t}get canRevive(){return this._canRevive}set canRevive(t){this._canRevive=t}get hasBreedingPermission(){return this._hasBreedingPermission}set hasBreedingPermission(t){this._hasBreedingPermission=t}get petLevel(){return this._petLevel}set petLevel(t){this._petLevel=t}get botSkills(){return this._botSkills}set botSkills(t){this._botSkills=t}get isModerator(){return this._isModerator}set isModerator(t){this._isModerator=t}}class Tq extends Yn{constructor(t,e){super(t,e),t.addMessageEvent(new ef(this.onRoomUnitEvent.bind(this))),t.addMessageEvent(new sf(this.onRoomUnitInfoEvent.bind(this))),t.addMessageEvent(new rf(this.onRoomUnitRemoveEvent.bind(this))),t.addMessageEvent(new tf(this.onRoomUnitDanceEvent.bind(this))),t.addMessageEvent(new KS(this.onUserCurrentBadgesEvent.bind(this))),t.addMessageEvent(new BS(this.onRoomDoorbellEvent.bind(this))),t.addMessageEvent(new $E(this.onUserNameChangeMessageEvent.bind(this))),t.addMessageEvent(new DS(this.onNewFriendRequestEvent.bind(this))),t.addMessageEvent(new xD(this.onPetInfoEvent.bind(this))),t.addMessageEvent(new MD(this.onPetStatusUpdateEvent.bind(this))),t.addMessageEvent(new A5(this.onPetBreedingMessageEvent.bind(this))),t.addMessageEvent(new qy(this.onPetLevelUpdateMessageEvent.bind(this))),t.addMessageEvent(new qz(this.onConfirmBreedingResultEvent.bind(this))),t.addMessageEvent(new Qz(this.onNestBreedingSuccessEvent.bind(this))),t.addMessageEvent(new Xz(this.onConfirmBreedingRequestEvent.bind(this))),t.addMessageEvent(new Jg(this.onPetFigureUpdateEvent.bind(this))),t.addMessageEvent(new AD(this.onPetBreedingResultEvent.bind(this))),t.addMessageEvent(new Hy(this.onPetPlacingError.bind(this))),t.addMessageEvent(new Uy(this.onBotError.bind(this))),t.addMessageEvent(new dD(this.onFavoriteMembershipUpdateMessageEvent.bind(this)))}onRoomUnitEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser().users,i=[];if(s&&s.length)for(const n of s){if(!n)continue;const o=new s0(n.roomIndex);o.name=n.name,o.custom=n.custom,o.activityPoints=n.activityPoints,o.figure=n.figure,o.type=n.userType,o.webID=n.webID,o.groupId=n.groupID,o.groupName=n.groupName,o.groupStatus=n.groupStatus,o.sex=n.sex,o.ownerId=n.ownerId,o.ownerName=n.ownerName,o.rarityLevel=n.rarityLevel,o.hasSaddle=n.hasSaddle,o.isRiding=n.isRiding,o.canBreed=n.canBreed,o.canHarvest=n.canHarvest,o.canRevive=n.canRevive,o.hasBreedingPermission=n.hasBreedingPermission,o.petLevel=n.petLevel,o.botSkills=n.botSkills,o.isModerator=n.isModerator,e.userDataManager.getUserData(n.roomIndex)||i.push(o),e.userDataManager.updateUserData(o)}this.listener.events.dispatchEvent(new yg(e,i))}onRoomUnitInfoEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();s&&(e.userDataManager.updateFigure(s.unitId,s.figure,s.gender,!1,!1),e.userDataManager.updateMotto(s.unitId,s.motto),e.userDataManager.updateAchievementScore(s.unitId,s.achievementScore),this.listener.events.dispatchEvent(new Dg(e,s.unitId,s.figure,s.gender,s.motto,s.achievementScore)))}onRoomUnitRemoveEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);e&&e.userDataManager.removeUserData(t.getParser().unitId)}onRoomUnitDanceEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&this.listener.events.dispatchEvent(new Sg(s,e.unitId,e.danceId))}onUserCurrentBadgesEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&(s.userDataManager.setUserBadges(e.userId,e.badges),this.listener.events.dispatchEvent(new Mg(s,e.userId,e.badges)))}onRoomDoorbellEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=e.userName;if(!s||!s.length)return;const i=this.listener.getSession(this.roomId);i&&this.listener.events.dispatchEvent(new jn(jn.DOORBELL,i,s))}onUserNameChangeMessageEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&s.userDataManager.updateName(e.id,e.newName)}onNewFriendRequestEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);if(!s)return;const i=e.request;this.listener.events.dispatchEvent(new uI(s,i.requestId,i.requesterUserId,i.requesterName))}onPetInfoEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);if(!s)return;const i=new Iq;i.id=e.id,i.level=e.level,i.maximumLevel=e.maximumLevel,i.experience=e.experience,i.levelExperienceGoal=e.levelExperienceGoal,i.energy=e.energy,i.maximumEnergy=e.maximumEnergy,i.happyness=e.happyness,i.maximumHappyness=e.maximumHappyness,i.ownerId=e.ownerId,i.ownerName=e.ownerName,i.respect=e.respect,i.age=e.age,i.unknownRarity=e.unknownRarity,i.saddle=e.saddle,i.rider=e.rider,i.breedable=e.breedable,i.fullyGrown=e.fullyGrown,i.rarityLevel=e.rarityLevel,i.dead=e.dead,i.skillTresholds=e.skillTresholds,i.publiclyRideable=e.publiclyRideable,i.maximumTimeToLive=e.maximumTimeToLive,i.remainingTimeToLive=e.remainingTimeToLive,i.remainingGrowTime=e.remainingGrowTime,i.publiclyBreedable=e.publiclyBreedable,this.listener.events.dispatchEvent(new Cg(s,i))}onPetStatusUpdateEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&(s.userDataManager.updatePetBreedingStatus(e.roomIndex,e.canBreed,e.canHarvest,e.canRevive,e.hasBreedingPermission),this.listener.events.dispatchEvent(new Ag(s,e.petId,e.canBreed,e.canHarvest,e.canRevive,e.hasBreedingPermission)))}onPetBreedingMessageEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&this.listener.events.dispatchEvent(new dI(s,e.state,e.ownPetId,e.otherPetId))}onPetLevelUpdateMessageEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&(s.userDataManager.updatePetLevel(e.roomIndex,e.level),this.listener.events.dispatchEvent(new fI(s,e.petId,e.level)))}onConfirmBreedingResultEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&this.listener.events.dispatchEvent(new cI(s,e.breedingNestStuffId,e.result))}onNestBreedingSuccessEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&this.listener.events.dispatchEvent(new hI(s,e.petId,e.rarityCategory))}onConfirmBreedingRequestEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&this.listener.events.dispatchEvent(new lI(s,e.nestId,e.pet1,e.pet2,e.rarityCategories,e.resultPetType))}onPetFigureUpdateEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);if(!s)return;const i=e.figureData.figuredata;s.userDataManager.updateFigure(e.roomIndex,i,"",e.hasSaddle,e.isRiding),this.listener.events.dispatchEvent(new gI(s,e.petId,i))}onPetBreedingResultEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&this.listener.events.dispatchEvent(new _I(s,e.resultData,e.otherResultData))}onPetPlacingError(t){if(!t||!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);if(!s)return;let i=null;switch(e.errorCode){case 0:i=le.RSEME_PETS_FORBIDDEN_IN_HOTEL;break;case 1:i=le.RSEME_PETS_FORBIDDEN_IN_FLAT;break;case 2:i=le.RSEME_MAX_PETS;break;case 3:i=le.RSEME_NO_FREE_TILES_FOR_PET;break;case 4:i=le.RSEME_SELECTED_TILE_NOT_FREE_FOR_PET;break;case 5:i=le.RSEME_MAX_NUMBER_OF_OWN_PETS;break}!i||i.length==0||this.listener.events.dispatchEvent(new le(i,s))}onBotError(t){if(!t||!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);if(!s)return;let i=null;switch(e.errorCode){case 0:i=le.RSEME_BOTS_FORBIDDEN_IN_HOTEL;break;case 1:i=le.RSEME_BOTS_FORBIDDEN_IN_FLAT;break;case 2:i=le.RSEME_BOT_LIMIT_REACHED;break;case 3:i=le.RSEME_SELECTED_TILE_NOT_FREE_FOR_BOT;break;case 4:i=le.RSEME_BOT_NAME_NOT_ACCEPTED;break}!i||i.length==0||this.listener.events.dispatchEvent(new le(i,s))}onFavoriteMembershipUpdateMessageEvent(t){if(!this.listener)return;const e=t.getParser(),s=this.listener.getSession(this.roomId);if(!s)return;const i=s.userDataManager.getUserDataByIndex(e.roomIndex);i&&(i.groupId=e.groupId,i.groupName=e.groupName,this.listener.events.dispatchEvent(new Og(s,e.roomIndex,e.groupId,e.status,e.groupName)))}}class Rq extends Yn{constructor(t,e){super(t,e),t.addMessageEvent(new sD(this.onQuestionEvent.bind(this))),t.addMessageEvent(new eD(this.onQuestionAnsweredEvent.bind(this))),t.addMessageEvent(new iD(this.onQuestionFinishedEvent.bind(this)))}onQuestionEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const i=new Ln(Ln.QUESTION,e,s.pollId);i.question=s.question,i.duration=s.duration,i.pollType=s.pollType,i.questionId=s.questionId,i.pollId=s.pollId,this.listener.events.dispatchEvent(i)}onQuestionAnsweredEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const i=new Ln(Ln.ANSWERED,e,s.userId);i.value=s.value,i.userId=s.userId,i.answerCounts=s.answerCounts,this.listener.events.dispatchEvent(i)}onQuestionFinishedEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const i=new Ln(Ln.FINISHED,e);i.questionId=s.questionId,i.answerCounts=s.answerCounts,this.listener.events.dispatchEvent(i)}}class Sq{constructor(t){this._sessionDataManager=t,this._ignoredUsers=[]}init(){if(this._sessionDataManager&&this._sessionDataManager.communication){this._messages=[new nb(this.onIgnoredUsersEvent.bind(this)),new qS(this.onIgnoreResultEvent.bind(this))];for(const t of this._messages)this._sessionDataManager.communication.registerMessageEvent(t)}}dispose(){if(!this.disposed){if(this._messages&&this._messages.length){for(const t of this._messages)this._sessionDataManager.communication.removeMessageEvent(t);this._messages=null}this._sessionDataManager=null}}requestIgnoredUsers(){this._sessionDataManager.send(new uU(this._sessionDataManager.userName))}onIgnoredUsersEvent(t){if(!t)return;const e=t.getParser();e&&(this._ignoredUsers=e.ignoredUsers)}onIgnoreResultEvent(t){if(!t)return;const e=t.getParser();if(!e)return;const s=e.name;switch(e.result){case 0:return;case 1:this.addUserToIgnoreList(s);return;case 2:this.addUserToIgnoreList(s),this._ignoredUsers.shift();return;case 3:this.removeUserFromIgnoreList(s);return}}addUserToIgnoreList(t){this._ignoredUsers.indexOf(t)<0&&this._ignoredUsers.push(t)}removeUserFromIgnoreList(t){const e=this._ignoredUsers.indexOf(t);e>=0&&this._ignoredUsers.splice(e,1)}ignoreUserId(t){this._sessionDataManager.send(new _U(t))}ignoreUser(t){this._sessionDataManager.send(new dU(t))}unignoreUser(t){this._sessionDataManager.send(new gU(t))}isIgnored(t){return this._ignoredUsers.indexOf(t)>=0}get disposed(){return!!this._sessionDataManager}}class Oq{constructor(t,e,s){this._type=t,this._name=e,this._description=s}get type(){return this._type}get name(){return this._name}get description(){return this._description}}const ju=class ju extends nr{constructor(t){super(),this._products=t}dispose(){this._products=null}loadProductData(t){t&&fetch(t).then(e=>e.json()).then(e=>this.onProductDataLoadedEvent(e)).catch(e=>this.onProductDataError(e))}onProductDataLoadedEvent(t){t&&(this.parseProducts(t.productdata),this.dispatchEvent(new kt(ju.PDP_PRODUCT_DATA_READY)))}onProductDataError(t){t&&this.dispatchEvent(new kt(ju.PDP_PRODUCT_DATA_FAILED))}parseProducts(t){if(t)for(const e of t.product)e&&this._products.set(e.code,new Oq(e.code,e.name,e.description))}};ju.PDP_PRODUCT_DATA_READY="PDP_PRODUCT_DATA_READY",ju.PDP_PRODUCT_DATA_FAILED="PDP_PRODUCT_DATA_FAILED";let vh=ju;const ha=class ha extends Ar{constructor(){super(),this._connection=null,this._userDataByType=new Map,this._userDataByRoomIndex=new Map,this._userBadges=new Map}onDispose(){this._connection=null}setConnection(t){this._connection=t}getUserData(t){return this.getDataByType(t,ha.TYPE_USER)}getPetData(t){return this.getDataByType(t,ha.TYPE_PET)}getBotData(t){return this.getDataByType(t,ha.TYPE_BOT)}getRentableBotData(t){return this.getDataByType(t,ha.TYPE_RENTABLE_BOT)}getDataByType(t,e){const s=this._userDataByType.get(e);if(!s)return null;const i=s.get(t);return i||null}getUserDataByIndex(t){const e=this._userDataByRoomIndex.get(t);return e||null}getUserDataByName(t){for(const e of this._userDataByRoomIndex.values())if(!(!e||e.name!==t))return e;return null}updateUserData(t){if(!t)return;this.removeUserData(t.roomIndex);let e=this._userDataByType.get(t.type);e||(e=new Map,this._userDataByType.set(t.type,e)),e.set(t.webID,t),this._userDataByRoomIndex.set(t.roomIndex,t)}removeUserData(t){const e=this.getUserDataByIndex(t);if(!e)return;this._userDataByRoomIndex.delete(t);const s=this._userDataByType.get(e.type);s&&s.delete(e.webID)}getUserBadges(t){this._connection&&this._connection.send(new gO(t));const e=this._userBadges.get(t);return e||[]}setUserBadges(t,e){this._userBadges.set(t,e)}updateFigure(t,e,s,i,n){const o=this.getUserDataByIndex(t);o&&(o.figure=e,o.sex=s,o.hasSaddle=i,o.isRiding=n)}updateName(t,e){const s=this.getUserDataByIndex(t);s&&(s.name=e)}updateMotto(t,e){const s=this.getUserDataByIndex(t);s&&(s.custom=e)}updateAchievementScore(t,e){const s=this.getUserDataByIndex(t);s&&(s.activityPoints=e)}updatePetLevel(t,e){const s=this.getUserDataByIndex(t);s&&(s.petLevel=e)}updatePetBreedingStatus(t,e,s,i,n){const o=this.getUserDataByIndex(t);o&&(o.canBreed=e,o.canHarvest=s,o.canRevive=i,o.hasBreedingPermission=n)}requestPetInfo(t){!this._connection||!this.getPetData(t)||this._connection.send(new UL(t))}get connection(){return this._connection}};ha.TYPE_USER=1,ha.TYPE_PET=2,ha.TYPE_BOT=3,ha.TYPE_RENTABLE_BOT=4;let BR=ha;class Cq extends Ar{constructor(){super(),this._connection=null,this._userData=new BR,this._roomId=0,this._password=null,this._state=Mt.CREATED,this._tradeMode=qu.NO_TRADING,this._doorMode=0,this._controllerLevel=Oe.NONE,this._ownRoomIndex=-1,this._isGuildRoom=!1,this._isRoomOwner=!1,this._isDecorating=!1,this._isSpectator=!1,this._moderationSettings=null}onDispose(){this._userData&&(this._userData.dispose(),this._userData=null),this._connection=null}setConnection(t){this._connection||!t||(this._connection=t,this._userData&&this._userData.setConnection(t))}setControllerLevel(t){if(t>=Oe.NONE&&t<=Oe.MODERATOR){this._controllerLevel=t;return}this._controllerLevel=Oe.NONE}setOwnRoomIndex(t){this._ownRoomIndex=t}setRoomOwner(){this._isRoomOwner=!0}start(){return this._state!==Mt.CREATED||!this._connection?!1:(this._state=Mt.STARTED,this.enterRoom())}enterRoom(){return this._connection?(this._connection.send(new YL(this._roomId,this._password)),!0):!1}reset(t){t!==this._roomId&&(this._roomId=t)}sendChatMessage(t,e){this._connection.send(new hO(t,e))}sendShoutMessage(t,e){this._connection.send(new GP(t,e))}sendWhisperMessage(t,e,s){this._connection.send(new kP(t,e,s))}sendChatTypingMessage(t){t?this._connection.send(new VP):this._connection.send(new HP)}sendMottoMessage(t){this._connection.send(new fU(t))}sendDanceMessage(t){this._connection.send(new YP(t))}sendExpressionMessage(t){this._connection.send(new WP(t))}sendSignMessage(t){t<0||t>17||this._connection.send(new QP(t))}sendPostureMessage(t){this._connection.send(new qP(t))}sendDoorbellApprovalMessage(t,e){this._connection.send(new WL(t,e))}sendAmbassadorAlertMessage(t){this._connection.send(new KL(t))}sendKickMessage(t){this._connection.send(new QL(t))}sendMuteMessage(t,e){this._connection.send(new JL(t,e,this._roomId))}sendBanMessage(t,e){this._connection.send(new XL(t,this._roomId,e))}sendGiveRightsMessage(t){this._connection.send(new iO(t))}sendTakeRightsMessage(t){this._connection.send(new rO(t))}sendPollStartMessage(t){this._connection.send(new kL(t))}sendPollRejectMessage(t){this._connection.send(new BL(t))}sendPollAnswerMessage(t,e,s){this._connection.send(new GL(t,e,s))}sendPeerUsersClassificationMessage(t){this._connection.send(new AU(t))}sendOpenPetPackageMessage(t,e){this._connection.send(new cO(t,e))}sendRoomUsersClassificationMessage(t){this._connection.send(new NU(t))}updateMoodlightData(t,e,s,i,n){let o="000000"+s.toString(16).toUpperCase();o="#"+o.substring(o.length-6),this.connection.send(new gP(t,e,o,i,n))}toggleMoodlightState(){this.connection.send(new fP)}pickupPet(t){this._connection&&this._connection.send(new lP(t))}pickupBot(t){this._connection&&this._connection.send(new ep(t))}requestMoodlightSettings(){this._connection&&this._connection.send(new _P)}openGift(t){this._connection.send(new DP(t))}mountPet(t){this._connection.send(new HT(t,!0))}dismountPet(t){this._connection.send(new HT(t,!1))}usePetProduct(t,e){this._connection.send(new FL(t,e))}removePetSaddle(t){this._connection.send(new PL(t))}togglePetBreeding(t){this._connection.send(new jL(t))}togglePetRiding(t){this._connection.send(new wL(t))}useMultistateItem(t){this._connection.send(new uh(t))}harvestPet(t){this._connection.send(new aP(t))}compostPlant(t){this._connection.send(new rP(t))}requestPetCommands(t){this._connection.send(new LL(t))}sendScriptProceed(){this._connection.send(new vL)}sendUpdateClothingChangeFurniture(t,e,s){this._connection.send(new uP(t,e,s))}changeQueue(t){this._connection.send(new wP(t))}votePoll(t){this._connection.send(new VL(t))}get connection(){return this._connection}get userDataManager(){return this._userData}get roomId(){return this._roomId}set roomId(t){this._roomId=t}get password(){return this._password}set password(t){this._password=t}get state(){return this._state}get isPrivateRoom(){return!0}get tradeMode(){return this._tradeMode}set tradeMode(t){this._tradeMode=t}get doorMode(){return this._doorMode}set doorMode(t){this._doorMode=t}get allowPets(){return this._allowPets}set allowPets(t){this._allowPets=t}get controllerLevel(){return this._controllerLevel}get ownRoomIndex(){return this._ownRoomIndex}get isGuildRoom(){return this._isGuildRoom}set isGuildRoom(t){this._isGuildRoom=t}get isRoomOwner(){return this._isRoomOwner}get isDecorating(){return this._isDecorating}set isDecorating(t){this._isDecorating=t}get isSpectator(){return this._isSpectator}set isSpectator(t){this._isSpectator=t}get moderationSettings(){return this._moderationSettings}set moderationSettings(t){this._moderationSettings=t}}class Aq extends Fa{constructor(t,e){super(),this._communication=t,this._roomEngine=e,this._handlers=[],this._sessions=new Map,this._pendingSession=null,this._sessionStarting=!1,this._viewerSession=null,this.onRoomEngineEvent=this.onRoomEngineEvent.bind(this)}onInit(){this.createHandlers(),this.processPendingSession(),this._roomEngine.events.addEventListener(te.ENGINE_INITIALIZED,this.onRoomEngineEvent)}onDispose(){this._roomEngine.events.removeEventListener(te.ENGINE_INITIALIZED,this.onRoomEngineEvent),super.onDispose()}createHandlers(){const t=this._communication&&this._communication.connection;t&&this._handlers.push(new gq(t,this),new fq(t,this),new mq(t,this),new Eq(t,this),new iu(t,this),new Tq(t,this),new pq(t,this),new hq(t,this),new Rq(t,this),new _q(t,this),new dq(t,this))}setHandlers(t){if(!(!this._handlers||!this._handlers.length))for(const e of this._handlers)e&&e.setRoomId(t.roomId)}onRoomEngineEvent(t){this.processPendingSession()}processPendingSession(){!this._pendingSession||!this._roomEngine.ready||(this.addSession(this._pendingSession),this._pendingSession=null)}getSession(t){const e=this._sessions.get(this.getRoomId(t));return e||null}createSession(t,e=null){const s=new Cq;return s.roomId=t,s.password=e,this.addSession(s)}addSession(t){return this._roomEngine.ready?(this._sessionStarting=!0,this._sessions.get(this.getRoomId(t.roomId))&&this.removeSession(t.roomId,!1),t.setConnection(this._communication.connection),this._sessions.set(this.getRoomId(t.roomId),t),this.events.dispatchEvent(new Mt(Mt.CREATED,t)),this._viewerSession=t,this.startSession(this._viewerSession),!0):(this._pendingSession=t,!1)}startSession(t){return t.state===Mt.STARTED?!1:(this._sessionStarting=!1,t.start()?(this.events.dispatchEvent(new Mt(Mt.STARTED,t)),this.setHandlers(t),!0):(this.removeSession(t.roomId),!1))}removeSession(t,e=!0){const s=this.getSession(t);s&&(this._sessions.delete(this.getRoomId(t)),this.events.dispatchEvent(new Mt(Mt.ENDED,s,e)),s.dispose())}sessionUpdate(t,e){if(this.getSession(t))switch(e){case iu.RS_CONNECTED:return;case iu.RS_READY:return;case iu.RS_DISCONNECTED:this.removeSession(t);return}}sessionReinitialize(t,e){const s=this.getSession(t);s&&(this._sessions.delete(this.getRoomId(t)),s.reset(e),this._sessions.set(this.getRoomId(e),s),this.setHandlers(s))}getRoomId(t){return"hard_coded_room_id"}get communication(){return this._communication}get roomEngine(){return this._roomEngine}get viewerSession(){return this._viewerSession}}const wu=class wu{static logEventLog(t){try{Zt.available&&Zt.call("logEventLog",t)}catch{dt.log("External interface not working, failed to log event log.")}}static openPage(t){try{Zt.available&&Zt.call("openPage",t)}catch{dt.log("Failed to open web page",t)}}static openWebPage(t){window.open(t)}static sendHeartBeat(){try{Zt.available&&Zt.call("heartBeat")}catch{dt.log("Failed to send heartbeat")}}static openWebPageAndMinimizeClient(t){try{Zt.available&&wu.openPage(t)}catch{dt.log("Failed to open web page",t)}}static closeWebPageAndRestoreClient(){try{Zt.available&&Zt.call("closeWebPageAndRestoreClient")}catch{dt.log("Failed to close web page and restore client!")}}static openHabblet(t,e=null){try{Zt.available&&Zt.call("openHabblet",t,e)}catch{dt.log("Failed to open Habblet",t)}}static closeHabblet(t,e=null){try{Zt.available&&Zt.call("closeHabblet",t,e)}catch{dt.log("Failed to close Habblet",t)}}static send(t,e){try{Zt.available&&Zt.call("disconnect",t,e)}catch{dt.log("Failed to close send ")}}static showGame(t){try{Zt.available&&Zt.callGame("showGame",t)}catch(e){dt.log("Failed to open game",e)}}static hideGame(){try{Zt.available&&Zt.callGame("hideGame")}catch{dt.log("Failed to hide game")}}static open(t){try{Zt.available&&Zt.call("openExternalLink",escape(t))}catch{dt.log("External interface not working. Could not request to open: "+t)}}static roomVisited(t){try{Zt.available&&Zt.call("roomVisited",t)}catch{dt.log("External interface not working. Could not store last room visit.")}}static openMinimail(t){try{Zt.available&&Zt.call("openMinimail",t)}catch{dt.log("External interface not working. Could not open minimail.")}}static openNews(){try{Zt.available&&Zt.call("openNews")}catch{dt.log("External interface not working. Could not open news.")}}static closeNews(){try{Zt.available&&Zt.call("closeNews")}catch{dt.log("External interface not working. Could not close news.")}}static openAvatars(){try{Zt.available&&Zt.call("openAvatars")}catch{dt.log("External interface not working. Could not open avatars.")}}static openRoomEnterAd(){try{Zt.available&&Zt.call("openRoomEnterAd")}catch{dt.log("External interface not working. Could not open roomenterad.")}}static updateFigure(t){try{Zt.available&&Zt.call("updateFigure",t)}catch{dt.log("External interface not working. Could not update figure.")}}};wu.ADVERTISEMENT="advertisement",wu.OPENLINK="openlink",wu.OPENROOM="openroom";let Hn=wu;class Nq extends Fa{constructor(t){super(),this._communication=t,this.resetUserInfo(),this._ignoredUsersManager=new Sq(this),this._groupInformationManager=new uq(this),this._clubLevel=0,this._securityLevel=0,this._isAmbassador=!1,this._noobnessLevel=-1,this._isEmailVerified=!1,this._systemOpen=!1,this._systemShutdown=!1,this._isAuthenticHabbo=!1,this._isRoomCameraFollowDisabled=!1,this._uiFlags=0,this._floorItems=new Map,this._wallItems=new Map,this._products=new Map,this._furnitureData=null,this._furnitureReady=!1,this._productsReady=!1,this._furnitureListenersNotified=!1,this._pendingFurnitureListeners=[],this._pendingProductListeners=[],this._tags=[],this._badgeImageManager=null,this.onFurnitureDataReadyEvent=this.onFurnitureDataReadyEvent.bind(this),this.onProductDataReadyEvent=this.onProductDataReadyEvent.bind(this),this.onNitroSettingsEvent=this.onNitroSettingsEvent.bind(this)}onInit(){this.loadFurnitureData(),this.loadProductData(),this.loadBadgeImageManager(),this._ignoredUsersManager&&this._ignoredUsersManager.init(),this._groupInformationManager&&this._groupInformationManager.init(),this._communication.registerMessageEvent(new xS(this.onUserFigureEvent.bind(this))),this._communication.registerMessageEvent(new lh(this.onUserInfoEvent.bind(this))),this._communication.registerMessageEvent(new YS(this.onUserPermissionsEvent.bind(this))),this._communication.registerMessageEvent(new ux(this.onAvailabilityStatusMessageEvent.bind(this))),this._communication.registerMessageEvent(new Qy(this.onPetRespectFailed.bind(this))),this._communication.registerMessageEvent(new Jd(this.onChangeNameUpdateEvent.bind(this))),this._communication.registerMessageEvent(new $E(this.onUserNameChangeMessageEvent.bind(this))),this._communication.registerMessageEvent(new tb(this.onUserTags.bind(this))),this._communication.registerMessageEvent(new oh(this.onRoomModelNameEvent.bind(this))),this._communication.registerMessageEvent(new ab(this.onInClientLinkEvent.bind(this))),this._communication.registerMessageEvent(new Ry(this.onMysteryBoxKeysEvent.bind(this))),this._communication.registerMessageEvent(new gM(this.onNoobnessLevelMessageEvent.bind(this))),this._communication.registerMessageEvent(new JD(this.onAccountSafetyLockStatusChangeMessageEvent.bind(this))),this._communication.registerMessageEvent(new eb(this.onEmailStatus.bind(this))),this._communication.registerMessageEvent(new nx(this.onBobbaCheckVip.bind(this))),this._communication.registerMessageEvent(new ax(this.onBobbaSoundCategories.bind(this))),this._communication.registerMessageEvent(new ox(this.onBobbaListCategories.bind(this))),this._communication.registerMessageEvent(new cx(this.onBobbaLanguages.bind(this))),Et.instance.events.addEventListener(il.SETTINGS_UPDATED,this.onNitroSettingsEvent)}onDispose(){this.destroyFurnitureData(),this._ignoredUsersManager&&(this._ignoredUsersManager.dispose(),this._ignoredUsersManager=null),this._groupInformationManager&&(this._groupInformationManager.dispose(),this._groupInformationManager=null),Et.instance.events.removeEventListener(il.SETTINGS_UPDATED,this.onNitroSettingsEvent),super.onDispose()}resetUserInfo(){this._userId=0,this._name=null,this._figure=null,this._gender=null,this._realName=null,this._canChangeName=!1,this._safetyLocked=!1}loadFurnitureData(){this.destroyFurnitureData(),this._furnitureData=new bh(this._floorItems,this._wallItems,Et.instance.localization),this._furnitureData.addEventListener(bh.FURNITURE_DATA_READY,this.onFurnitureDataReadyEvent),this._furnitureData.loadFurnitureData(Dt.getValue("furnidata.url"))}loadProductData(){this.destroyProductData(),this._productData=new vh(this._products),this._productData.addEventListener(vh.PDP_PRODUCT_DATA_READY,this.onProductDataReadyEvent),this._productData.loadProductData(Dt.getValue("productdata.url"))}loadBadgeImageManager(){this._badgeImageManager||(this._badgeImageManager=new su(Rr(),this),this._badgeImageManager.init())}hasProductData(t){return this._productsReady?!0:(t&&this._pendingProductListeners.indexOf(t)===-1&&this._pendingProductListeners.push(t),!1)}getAllFurnitureData(t){if(!this._furnitureReady)return this._pendingFurnitureListeners.indexOf(t)===-1&&this._pendingFurnitureListeners.push(t),null;const e=[];for(const s of this._floorItems.values())s&&e.push(s);for(const s of this._wallItems.values())s&&e.push(s);return e}removePendingFurniDataListener(t){if(!this._pendingFurnitureListeners)return;const e=this._pendingFurnitureListeners.indexOf(t);e!==-1&&this._pendingFurnitureListeners.splice(e,1)}onUserFigureEvent(t){!t||!t.connection||(this._figure=t.getParser().figure,this._gender=t.getParser().gender,Hn.updateFigure(this._figure))}onUserInfoEvent(t){if(!t||!t.connection)return;this.resetUserInfo();const e=t.getParser().userInfo;e&&(this._userId=e.userId,this._name=e.username,this._figure=e.figure,this._gender=e.gender,this._realName=e.realName,this._respectsReceived=e.respectsReceived,this._respectsLeft=e.respectsRemaining,this._respectsPetLeft=e.respectsPetRemaining,this._canChangeName=e.canChangeName,this._safetyLocked=e.safetyLocked,this._ignoredUsersManager&&this._ignoredUsersManager.requestIgnoredUsers())}onUserPermissionsEvent(t){!t||!t.connection||(this._clubLevel=t.getParser().clubLevel,this._securityLevel=t.getParser().securityLevel,this._isAmbassador=t.getParser().isAmbassador)}onAvailabilityStatusMessageEvent(t){if(!t||!t.connection)return;const e=t.getParser();e&&(this._systemOpen=e.isOpen,this._systemShutdown=e.onShutdown,this._isAuthenticHabbo=e.isAuthenticUser)}onPetRespectFailed(t){!t||!t.connection||this._respectsPetLeft++}onChangeNameUpdateEvent(t){if(!t||!t.connection)return;const e=t.getParser();e&&e.resultCode===Jd.NAME_OK&&(this._canChangeName=!1,this.events.dispatchEvent(new bg(e.name)))}onUserNameChangeMessageEvent(t){if(!t||!t.connection)return;const e=t.getParser();e&&e.webId===this.userId&&(this._name=e.newName,this._canChangeName=!1,this.events.dispatchEvent(new bg(this._name)))}onUserTags(t){if(!t||!t.connection)return;const e=t.getParser();e&&(this._tags=e.tags)}onRoomModelNameEvent(t){if(!t)return;const e=t.getParser();e&&Hn.roomVisited(e.roomId)}onFurnitureDataReadyEvent(t){if(this._furnitureData.removeEventListener(bh.FURNITURE_DATA_READY,this.onFurnitureDataReadyEvent),this._furnitureReady=!0,!this._furnitureListenersNotified&&(this._furnitureListenersNotified=!0,this._pendingFurnitureListeners&&this._pendingFurnitureListeners.length))for(const e of this._pendingFurnitureListeners)e&&e.loadFurnitureData();this._pendingProductListeners=[]}onProductDataReadyEvent(t){this._productData.removeEventListener(vh.PDP_PRODUCT_DATA_READY,this.onProductDataReadyEvent),this._productsReady=!0;for(const e of this._pendingProductListeners)e&&e.loadProductData();this._pendingProductListeners=[]}onInClientLinkEvent(t){if(!t)return;const e=t.getParser();e&&Et.instance.createLinkEvent(e.link)}onMysteryBoxKeysEvent(t){if(!t)return;const e=t.getParser();e&&this.events.dispatchEvent(new Rg(e.boxColor,e.keyColor))}onNoobnessLevelMessageEvent(t){this._noobnessLevel=t.getParser().noobnessLevel,this._noobnessLevel!==xh.OLD_IDENTITY&&Dt.setValue("new.identity",1)}onAccountSafetyLockStatusChangeMessageEvent(t){if(!t)return;const e=t.getParser();e&&(this._safetyLocked=e.status==jg.SAFETY_LOCK_STATUS_LOCKED)}onBobbaCheckVip(t){if(!t)return;const e=t.getParser();e&&(this._isVip=e.isVip)}onBobbaLanguages(t){if(!t)return;const e=t.getParser();e&&(this._languages=e.languages)}onBobbaSoundCategories(t){if(!t)return;const e=t.getParser();e&&(this._categories=e.soundCategories)}onBobbaListCategories(t){if(!t)return;const e=t.getParser();e&&(this._sounds=e.sounds)}onEmailStatus(t){if(!t)return;const e=t.getParser();e&&(this._isEmailVerified=e.isVerified)}onNitroSettingsEvent(t){this._isRoomCameraFollowDisabled=t.cameraFollow,this._uiFlags=t.flags,this.events.dispatchEvent(new mI(this._uiFlags))}destroyFurnitureData(){this._furnitureData&&(this._furnitureData.dispose(),this._furnitureData=null)}destroyProductData(){this._productData&&(this._productData.dispose(),this._productData=null)}getFloorItemData(t){const e=this._floorItems.get(t);return e||null}getFloorItemDataByName(t){if(!t||!this._floorItems||!this._floorItems.size)return null;for(const e of this._floorItems.values())if(!(!e||e.className!==t))return e}getWallItemData(t){const e=this._wallItems.get(t);return e||null}getWallItemDataByName(t){if(!t||!this._wallItems||!this._wallItems.size)return null;for(const e of this._wallItems.values())if(!(!e||e.className!==t))return e}getProductData(t){return this._productsReady||this.loadProductData(),this._products.get(t)}getBadgeUrl(t){return this._badgeImageManager.getBadgeUrl(t)}getGroupBadgeUrl(t){return this._badgeImageManager.getBadgeUrl(t,su.GROUP_BADGE)}getBadgeImage(t){return this._badgeImageManager.getBadgeImage(t)}getGroupBadgeImage(t){return this._badgeImageManager.getBadgeImage(t,su.GROUP_BADGE)}getUserTags(t){t<0||this.send(new hU(t))}loadBadgeImage(t){return this._badgeImageManager.loadBadgeImage(t)}loadGroupBadgeImage(t){return this._badgeImageManager.loadBadgeImage(t,su.GROUP_BADGE)}hasSecurity(t){return this._securityLevel>=t}giveRespect(t){t<0||this._respectsLeft<=0||(this.send(new CU(t)),this._respectsLeft--)}givePetRespect(t){t<0||this._respectsPetLeft<=0||(this.send(new S_(t)),this._respectsPetLeft--)}sendSpecialCommandMessage(t,e=0){this.send(new hO(t))}ignoreUser(t){this._ignoredUsersManager&&this._ignoredUsersManager.ignoreUser(t)}unignoreUser(t){this._ignoredUsersManager&&this._ignoredUsersManager.unignoreUser(t)}isUserIgnored(t){return this._ignoredUsersManager&&this._ignoredUsersManager.isIgnored(t)}getGroupBadge(t){return this._groupInformationManager&&this._groupInformationManager.getGroupBadge(t)}send(t){this._communication.connection.send(t)}get communication(){return this._communication}get userId(){return this._userId}get userName(){return this._name}get figure(){return this._figure}get gender(){return this._gender}get realName(){return this._realName}get ignoredUsersManager(){return this._ignoredUsersManager}get groupInformationManager(){return this._groupInformationManager}get respectsReceived(){return this._respectsReceived}get respectsLeft(){return this._respectsLeft}get respectsPetLeft(){return this._respectsPetLeft}get canChangeName(){return this._canChangeName}get clubLevel(){return this._clubLevel}get securityLevel(){return this._securityLevel}get isAmbassador(){return this._isAmbassador}get sounds(){return this._sounds}get categories(){return this._categories}get languages(){return this._languages}get isVip(){return this._isVip}get isEmailVerified(){return this._isEmailVerified}get isNoob(){return this._noobnessLevel!==xh.OLD_IDENTITY}get isRealNoob(){return this._noobnessLevel===xh.REAL_NOOB}get isSystemOpen(){return this._systemOpen}get isSystemShutdown(){return this._systemShutdown}get isAuthenticHabbo(){return this._isAuthenticHabbo}get isModerator(){return this._securityLevel>=Cc.MODERATOR}get isCameraFollowDisabled(){return this._isRoomCameraFollowDisabled}get uiFlags(){return this._uiFlags}get tags(){return this._tags}}class i0 extends JE{constructor(t,e,s,i,n=""){super(t,e,s,i),this._jukeboxDiskId=-1,this._songData=n}get id(){return this._id}get length(){return this._length}get name(){return this._name}get creator(){return this._creator}get songData(){return this._songData}set songData(t){this._songData=t}get diskId(){return this._jukeboxDiskId}set diskId(t){this._jukeboxDiskId=t}}class xq{constructor(t,e,s,i,n){this._songId=t,this._startPos=e,this._playLength=s,this._fadeInSeconds=i,this._fadeOutSeconds=n,this._playRequestTime=Date.now()}get songId(){return this._songId}get startPos(){return this._startPos<0?0:this._startPos+(Date.now()-this._playRequestTime)/1e3}get playLength(){return this._playLength}get playRequestTime(){return this._playRequestTime}get fadeInSeconds(){return this._fadeInSeconds}get fadeOutSeconds(){return this._fadeOutSeconds}}const pE=class pE extends kt{constructor(t,e){super(pE.NOTIFY_PLAYED_SONG),this._name=t,this._creator=e}get name(){return this._name}get creator(){return this._creator}};pE.NOTIFY_PLAYED_SONG="UIEW_NOTIFY_PLAYED_SONG";let Tf=pE;const Rd=class Rd extends kt{constructor(t,e,s,i){super(t),this._id=s,this._position=i,this._priority=e}get id(){return this._id}get position(){return this._position}get priority(){return this._priority}};Rd.NPE_USER_PLAY_SONG="NPE_USER_PLAY_SONG",Rd.NPW_USER_STOP_SONG="NPW_USER_STOP_SONG",Rd.NPE_SONG_CHANGED="NPE_SONG_CHANGED";let xa=Rd;const IE=class IE extends kt{constructor(t){super(t)}};IE.PLUE_PLAY_LIST_UPDATED="PLUE_PLAY_LIST_UPDATED",IE.PLUE_PLAY_LIST_FULL="PLUE_PLAY_LIST_FULL";let Ta=IE;const pC=class pC extends kt{constructor(t){super(t)}};pC.SDIR_SONG_DISK_INVENTORY_RECEIVENT_EVENT="SDIR_SONG_DISK_INVENTORY_RECEIVENT_EVENT";let _c=pC;const IC=class IC extends kt{constructor(t,e){super(t),this._id=e}get id(){return this._id}};IC.SIR_TRAX_SONG_INFO_RECEIVED="SIR_TRAX_SONG_INFO_RECEIVED";let bc=IC;const TC=class TC extends kt{constructor(t,e){super(t),this._id=e}get id(){return this._id}};TC.TRAX_SONG_COMPLETE="SME_TRAX_SONG_COMPLETE";let _h=TC;const ec=class ec{};ec.PRIORITY_ROOM_PLAYLIST=0,ec.PRIORITY_USER_PLAYLIST=1,ec.PRIORITY_SONG_PLAY=2,ec.PRIORITY_PURCHASE_PREVIEW=3,ec.PRIORITY_COUNT=4;let di=ec;class Mq{constructor(){this._isPlaying=!1,this._disposed=!1,this._entries=[],this._missingSongInfo=[],this._messageEvents=[new KD(this.onNowPlayingMessageEvent.bind(this)),new zD(this.onJukeboxSongDisksMessageEvent.bind(this)),new YD(this.onJukeboxPlayListFullMessageEvent.bind(this))],this.onSongInfoReceivedEvent=this.onSongInfoReceivedEvent.bind(this)}init(){this._messageEvents.forEach(t=>Et.instance.communication.connection.addMessageEvent(t)),Et.instance.soundManager.events.addEventListener(bc.SIR_TRAX_SONG_INFO_RECEIVED,this.onSongInfoReceivedEvent)}get priority(){return di.PRIORITY_ROOM_PLAYLIST}onNowPlayingMessageEvent(t){const e=t.getParser();this._isPlaying=e.currentSongId!==-1,e.currentSongId>=0?(Et.instance.soundManager.musicController.playSong(e.currentSongId,di.PRIORITY_ROOM_PLAYLIST,e.syncCount/1e3,0,1,1),this._currentEntryId=e.currentSongId):this.stopPlaying(),e.nextSongId>=0&&Et.instance.soundManager.musicController.addSongInfoRequest(e.nextSongId),this._playPosition=e.currentPosition,Et.instance.soundManager.events.dispatchEvent(new xa(xa.NPE_SONG_CHANGED,di.PRIORITY_ROOM_PLAYLIST,e.currentSongId,e.currentPosition))}onJukeboxSongDisksMessageEvent(t){const e=t.getParser();this._entries=[];for(let s=0;s<e.songDisks.length;s++){const i=e.songDisks.getWithIndex(s),n=e.songDisks.getKey(s);let o=Et.instance.soundManager.musicController.getSongInfo(i);o==null&&(o=new i0(i,-1,null,null,null),this._missingSongInfo.indexOf(i)<0&&(this._missingSongInfo.push(i),Et.instance.soundManager.musicController.requestSongInfoWithoutSamples(i))),o.diskId=n,this._entries.push(o)}this._missingSongInfo.length==0&&Et.instance.soundManager.events.dispatchEvent(new Ta(Ta.PLUE_PLAY_LIST_UPDATED))}onJukeboxPlayListFullMessageEvent(t){Et.instance.soundManager.events.dispatchEvent(new Ta(Ta.PLUE_PLAY_LIST_FULL))}onSongInfoReceivedEvent(t){for(let s=0;s<this.length;s++){const i=this._entries[s];if(i.id===t.id){const n=i.diskId,o=Et.instance.soundManager.musicController.getSongInfo(t.id);o!=null&&(o.diskId=n,this._entries[s]=o);break}}const e=this._missingSongInfo.indexOf(t.id);e>=0&&this._missingSongInfo.splice(e,1),this._missingSongInfo.length==0&&Et.instance.soundManager.events.dispatchEvent(new Ta(Ta.PLUE_PLAY_LIST_UPDATED))}stopPlaying(){Et.instance.soundManager.musicController.stop(this.priority),this._currentEntryId=-1,this._playPosition=-1,this._isPlaying=!1}get length(){return this._entries?this._entries.length:0}get playPosition(){return this._playPosition}get nowPlayingSongId(){return this._currentEntryId}get isPlaying(){return this._isPlaying}get entries(){return this._entries}getEntry(t){return t<0||t>=this._entries.length?null:this._entries[t]}requestPlayList(){Et.instance.communication.connection.send(new iU)}dispose(){this._disposed||(this._disposed=!0,this.stopPlaying(),Et.instance.soundManager.events&&Et.instance.soundManager.events.removeEventListener(bc.SIR_TRAX_SONG_INFO_RECEIVED,this.onSongInfoReceivedEvent),this._messageEvents.forEach(t=>Et.instance.communication.connection.removeMessageEvent(t)),this._messageEvents=null)}}class yq{constructor(t){this._id=t,this._items=[]}addChannelItem(t){this._items.push(t)}get items(){return this._items}}class Dq{constructor(t,e){this._id=t,this._length=e}get id(){return this._id}get length(){return this._length}}class kR{constructor(t){this._channels=[],this._metaData=new Map;let e=[];const s=t.split(":"),i=s[s.length-1];if(i.indexOf("meta")>-1){const n=i.split(";");for(const o of n){const l=o.split(",");this._metaData.set(l[0],l[1])}e=s.slice(0,s.length-1)}else e=s;for(let n=0;n<e.length/2;n++)if(e[n*2].length>0){const o=parseInt(e[n*2]),l=e[n*2+1].split(";"),c=new yq(o);for(const u of l){const h=u.split(",");if(h.length!==2)return;c.addChannelItem(new Dq(parseInt(h[0]),parseInt(h[1])))}this._channels.push(c)}}get channels(){return this._channels}getSampleIds(){const t=[];for(const e of this._channels)for(const s of e.items)t.indexOf(s.id)===-1&&t.push(s.id);return t}get hasMetaData(){return this._metaData.has("meta")}get metaCutMode(){return this._metaData.has("c")}get metaTempo(){const t=this._metaData.get("t");return t?parseInt(t):null}}class bq{constructor(t){this._sampleUrl=t,this._isPlaying=!1,this._startPos=0,this._currentPos=0,this._playLength=0,this._sequence=[],this._cache=new Map}async play(t,e,s=0,i=-1){this.reset(),this._currentSong=new kR(t),this._startPos=Math.trunc(s),this._playLength=i,this._currentPos=this._startPos,this._currentSongId=e,await this.preload(),this._isPlaying=!0,this.tick(),this._tickerInterval=window.setInterval(()=>this.tick(),1e3)}reset(){this._isPlaying=!1,window.clearInterval(this._tickerInterval),Hc.Howler.stop(),this._currentSongId=-1,this._currentSong=void 0,this._tickerInterval=void 0,this._startPos=0,this._playLength=0,this._sequence=[],this._currentPos=0}pause(){this._isPlaying=!1,Hc.Howler.stop()}resume(){this._isPlaying=!0}stop(){const t=this._currentSongId;this.reset(),Et.instance.soundManager.events.dispatchEvent(new _h(_h.TRAX_SONG_COMPLETE,t))}setVolume(t){Hc.Howler.volume(t)}getVolume(){return Hc.Howler.volume()}async getSample(t){let e=this._cache.get(t);return e||(e=await this.loadSong(t)),Promise.resolve(e)}async preload(){if(this._sequence=[],!!this._currentSong){for(const t of this._currentSong.channels){const e=[];for(const s of t.items){const i=await this.getSample(s.id),n=Math.ceil(s.length*2/Math.ceil(i.duration()));for(let o=0;o<n;o++)for(let l=0;l<Math.ceil(i.duration());l++)e.push({sampleId:s.id,offset:l})}this._sequence.push(e)}this._playLength<=0&&(this._playLength=Math.max(...this._sequence.map(t=>t.length)))}}async preloadSamplesForSong(t){const e=new kR(t);await Promise.all(e.getSampleIds().map(s=>this.getSample(s)))}async loadSong(t){return new Promise((e,s)=>{const i=new Hc.Howl({src:[this._sampleUrl.replace("%sample%",t.toString())],preload:!0});i.once("load",()=>{this._cache.set(t,i),e(i)}),i.once("loaderror",()=>{dt.error("failed to load sample "+t),s("failed to load sample "+t)})})}tick(){this._currentPos>this._playLength-1&&this.stop(),this._isPlaying&&(this._currentSong&&this.playPosition(this._currentPos),this._currentPos++)}playPosition(t){if(!(!this._currentSong||!this._sequence)&&Hc.Howler._audioUnlocked)for(const e of this._sequence){const s=e[t];if(!s||s.sampleId===-1||s.sampleId===0)continue;const i=this._cache.get(s.sampleId);i&&(s.offset===0?i.play():i.playing()||(i.seek(s.offset),i.play()))}}}const sc=class sc{constructor(){this._priorityPlaying=-1,this._requestNumberPlaying=-1,this._previousNotificationTime=-1,this._timerInstance=-1,this._songRequestList=[],this._requestedSongs=new Map,this._availableSongs=new Map,this._songDiskInventory=new hs,this._songRequestsPerPriority=[],this._songRequestCountsPerPriority=[],this._diskInventoryMissingData=[],this._songIdPlaying=-1,this._previousNotifiedSongId=-1,this._messageEvents=[new qD(this.onTraxSongInfoMessageEvent.bind(this)),new QD(this.onSongDiskInventoryMessage.bind(this))],this.onJukeboxInit=this.onJukeboxInit.bind(this),this.onJukeboxDispose=this.onJukeboxDispose.bind(this),this.onSoundMachineInit=this.onSoundMachineInit.bind(this),this.onSoundMachineDispose=this.onSoundMachineDispose.bind(this),this.onTraxSongComplete=this.onTraxSongComplete.bind(this)}init(){this._timerInstance=window.setInterval(this.onTick.bind(this),1e3),this._musicPlayer=new bq(Et.instance.getConfiguration("external.samples.url")),this._messageEvents.forEach(t=>Et.instance.communication.connection.addMessageEvent(t)),Et.instance.roomEngine.events.addEventListener(us.JUKEBOX_INIT,this.onJukeboxInit),Et.instance.roomEngine.events.addEventListener(us.JUKEBOX_DISPOSE,this.onJukeboxDispose),Et.instance.roomEngine.events.addEventListener(us.SOUND_MACHINE_INIT,this.onSoundMachineInit),Et.instance.roomEngine.events.addEventListener(us.SOUND_MACHINE_DISPOSE,this.onSoundMachineDispose),Et.instance.soundManager.events.addEventListener(_h.TRAX_SONG_COMPLETE,this.onTraxSongComplete)}getRoomItemPlaylist(t){return this._roomItemPlaylist}get songDiskInventory(){return this._songDiskInventory}getSongDiskInventorySize(){return this._songDiskInventory.length}getSongDiskInventoryDiskId(t){return t>=0&&t<this._songDiskInventory.length?this._songDiskInventory.getKey(t):-1}getSongDiskInventorySongId(t){return t>=0&&t<this._songDiskInventory.length?this._songDiskInventory.getWithIndex(t):-1}getSongInfo(t){const e=this.getSongDataEntry(t);return e||this.requestSongInfoWithoutSamples(t),e}getSongIdPlayingAtPriority(t){return t!==this._priorityPlaying?-1:this._songIdPlaying}stop(t){const e=t===this._priorityPlaying,s=this.getTopRequestPriority()===t;e?(this.resetSongStartRequest(t),this.stopSongAtPriority(t)):(this.resetSongStartRequest(t),s&&this.reRequestSongAtPriority(this._priorityPlaying))}addSongInfoRequest(t){this.requestSong(t,!0)}requestSongInfoWithoutSamples(t){this.requestSong(t,!1)}requestUserSongDisks(){Et.instance.communication.connection.send(new oU)}updateVolume(t){this._musicPlayer.setVolume(t)}dispose(){this._timerInstance&&(clearInterval(this._timerInstance),this._timerInstance=void 0),this._messageEvents.forEach(t=>Et.instance.communication.connection.removeMessageEvent(t)),Et.instance.roomEngine.events.removeEventListener(us.JUKEBOX_INIT,this.onJukeboxInit),Et.instance.roomEngine.events.removeEventListener(us.JUKEBOX_DISPOSE,this.onJukeboxDispose),Et.instance.roomEngine.events.removeEventListener(us.SOUND_MACHINE_INIT,this.onSoundMachineInit),Et.instance.roomEngine.events.removeEventListener(us.SOUND_MACHINE_DISPOSE,this.onSoundMachineDispose),Et.instance.soundManager.events.removeEventListener(_h.TRAX_SONG_COMPLETE,this.onTraxSongComplete)}get samplesIdsInUse(){let t,e,s=[];for(let i=0;i<this._songRequestsPerPriority.length;i++)if(this._songRequestsPerPriority[i]&&(t=this._songRequestsPerPriority[i],e=this._availableSongs.get(t.songId),e)){const n=e.songData;if(n.length>0){const o=new kR(n);s=s.concat(o.getSampleIds())}}return s}onSongLoaded(t){const e=this.getTopRequestPriority();if(e>=0){const s=this.getSongIdRequestedAtPriority(e);t===s&&this.playSongObject(e,t)}}samplesUnloaded(t){throw new Error("Method not implemented.")}onTraxSongComplete(t){if(this.getSongIdPlayingAtPriority(this._priorityPlaying)===t.id){this.getTopRequestPriority()===this._priorityPlaying&&this.getSongRequestCountAtPriority(this._priorityPlaying)==this._requestNumberPlaying&&this.resetSongStartRequest(this._priorityPlaying);const e=this._priorityPlaying;this.playSongWithHighestPriority(),e>=di.PRIORITY_SONG_PLAY&&Et.instance.soundManager.events.dispatchEvent(new xa(xa.NPW_USER_STOP_SONG,e,t.id,-1))}}onTraxSongInfoMessageEvent(t){const e=t.getParser();for(const s of e.songs){const i=!!this.getSongDataEntry(s.id);if(this.areSamplesRequested(s.id),!i){const n=new i0(s.id,s.length,s.name,s.creator,s.data);this._availableSongs.set(s.id,n);const o=this.getTopRequestPriority(),l=this.getSongIdRequestedAtPriority(o);for(s.id===l&&this.playSongObject(o,l),Et.instance.soundManager.events.dispatchEvent(new bc(bc.SIR_TRAX_SONG_INFO_RECEIVED,s.id));this._diskInventoryMissingData.indexOf(s.id)!=-1;)this._diskInventoryMissingData.splice(this._diskInventoryMissingData.indexOf(s.id),1),this._diskInventoryMissingData.length===0&&Et.instance.soundManager.events.dispatchEvent(new _c(_c.SDIR_SONG_DISK_INVENTORY_RECEIVENT_EVENT))}}}onSongDiskInventoryMessage(t){const e=t.getParser();this._songDiskInventory.reset();for(let s=0;s<e.songDiskCount;s++){const i=e.getDiskId(s),n=e.getSongId(s);this._songDiskInventory.add(i,n),this._availableSongs.get(n)||(this._diskInventoryMissingData.push(n),this.requestSongInfoWithoutSamples(n))}this._diskInventoryMissingData.length===0&&Et.instance.soundManager.events.dispatchEvent(new _c(_c.SDIR_SONG_DISK_INVENTORY_RECEIVENT_EVENT))}onTick(){this._songRequestList.length!==0&&(Et.instance.communication.connection.send(new aU(...this._songRequestList)),this._songRequestList=[])}requestSong(t,e){this._requestedSongs.get(t)===void 0&&(this._requestedSongs.set(t,e),this._songRequestList.push(t))}areSamplesRequested(t){return this._requestedSongs.get(t)?this._requestedSongs.get(t):!1}processSongEntryForPlaying(t,e=!0){return this.getSongDataEntry(t)?!0:(this.addSongInfoRequest(t),!1)}playSong(t,e,s=0,i=0,n=.5,o=.5){return!this.addSongStartRequest(e,t,s,i,n,o)||!this.processSongEntryForPlaying(t)?!1:(e>=this._priorityPlaying&&this.playSongObject(e,t),!0)}playSongObject(t,e){if(e===-1||t<0||t>=di.PRIORITY_COUNT)return!1;let s=!1;this.stopSongAtPriority(this._priorityPlaying)&&(s=!0);const i=this.getSongDataEntry(e);if(!i)return!1;if(s)return!0;this._musicPlayer.setVolume(Et.instance.soundManager.traxVolume);let n=sc.SKIP_POSITION_SET,o=0;const l=this.getSongStartRequest(t);return l&&(n=l.startPos,o=l.playLength,l.fadeInSeconds,l.fadeOutSeconds),n>=i.length/1e3?!1:(n<=sc.SKIP_POSITION_SET&&(n=0),n=Math.trunc(n),this._priorityPlaying=t,this._requestNumberPlaying=this.getSongRequestCountAtPriority(t),this._songIdPlaying=e,this._priorityPlaying<=sc.MAXIMUM_NOTIFY_PRIORITY&&this.notifySongPlaying(i),this._musicPlayer.preloadSamplesForSong(i.songData).then(()=>this._musicPlayer.play(i.songData,i.id,n,o)),t>di.PRIORITY_ROOM_PLAYLIST&&Et.instance.soundManager.events.dispatchEvent(new xa(xa.NPE_USER_PLAY_SONG,t,i.id,-1)),!0)}notifySongPlaying(t){const s=Date.now();t.length>=8e3&&(this._previousNotifiedSongId!=t.id||s>this._previousNotificationTime+8e3)&&(Et.instance.soundManager.events.dispatchEvent(new Tf(t.name,t.creator)),this._previousNotifiedSongId=t.id,this._previousNotificationTime=s)}addSongStartRequest(t,e,s,i,n,o){if(t<0||t>=di.PRIORITY_COUNT)return!1;const l=new xq(e,s,i,n,o);return this._songRequestsPerPriority[t]=l,this._songRequestCountsPerPriority[t]=this._songRequestCountsPerPriority[t]+1,!0}getSongDataEntry(t){let e;return this._availableSongs&&(e=this._availableSongs.get(t)),e}getSongStartRequest(t){return this._songRequestsPerPriority[t]}getTopRequestPriority(){return this._songRequestsPerPriority.length-1}getSongIdRequestedAtPriority(t){return t<0||t>=di.PRIORITY_COUNT||!this._songRequestsPerPriority[t]?-1:this._songRequestsPerPriority[t].songId}getSongRequestCountAtPriority(t){return t<0||t>=di.PRIORITY_COUNT?-1:this._songRequestCountsPerPriority[t]}playSongWithHighestPriority(){let t;this._priorityPlaying=-1,this._songIdPlaying=-1,this._requestNumberPlaying=-1;let s=this.getTopRequestPriority();for(;s>=0;){if(t=this.getSongIdRequestedAtPriority(s),t>=0&&this.playSongObject(s,t))return;s--}}resetSongStartRequest(t){t>=0&&t<di.PRIORITY_COUNT&&(this._songRequestsPerPriority[t]=void 0)}reRequestSongAtPriority(t){this._songRequestCountsPerPriority[t]=this._songRequestCountsPerPriority[t]+1}stopSongAtPriority(t){if(t===this._priorityPlaying&&this._priorityPlaying>=0){const e=this.getSongIdPlayingAtPriority(t);if(e>=0)return this.getSongDataEntry(e),this._musicPlayer.stop(),!0}return!1}onSoundMachineInit(t){this.disposeRoomPlaylist()}onSoundMachineDispose(t){this.disposeRoomPlaylist()}onJukeboxInit(t){this.disposeRoomPlaylist(),this._roomItemPlaylist=new Mq,this._roomItemPlaylist.init(),Et.instance.communication.connection.send(new rU)}onJukeboxDispose(t){this.disposeRoomPlaylist()}disposeRoomPlaylist(){this._roomItemPlaylist&&(this._roomItemPlaylist.dispose(),this._roomItemPlaylist=void 0)}};sc.SKIP_POSITION_SET=-1,sc.MAXIMUM_NOTIFY_PRIORITY=di.PRIORITY_ROOM_PLAYLIST;let VR=sc;class vq extends Fa{constructor(){super(),this._volumeSystem=.5,this._volumeFurni=.5,this._volumeTrax=.5,this._volumeSoundboard=.5,this._internalSamples=new hs,this._furniSamples=new hs,this._furnitureBeingPlayed=new hs,this._musicController=new VR,this.onEvent=this.onEvent.bind(this)}onInit(){this._musicController.init(),Et.instance.roomEngine.events.addEventListener(wr.PLAY_SAMPLE,this.onEvent),Et.instance.roomEngine.events.addEventListener(Rt.REMOVED,this.onEvent),Et.instance.roomEngine.events.addEventListener(te.DISPOSED,this.onEvent),Et.instance.events.addEventListener(il.SETTINGS_UPDATED,this.onEvent),Et.instance.events.addEventListener(un.PLAY_SOUND,this.onEvent),Et.instance.roomEngine.events.addEventListener(un.PLAY_SOUNDBOARD,this.onEvent)}onDispose(){this._musicController&&(this._musicController.dispose(),this._musicController=null),Et.instance.roomEngine.events.removeEventListener(wr.PLAY_SAMPLE,this.onEvent),Et.instance.roomEngine.events.removeEventListener(Rt.REMOVED,this.onEvent),Et.instance.roomEngine.events.removeEventListener(te.DISPOSED,this.onEvent),Et.instance.events.removeEventListener(il.SETTINGS_UPDATED,this.onEvent),Et.instance.events.removeEventListener(un.PLAY_SOUND,this.onEvent),Et.instance.roomEngine.events.removeEventListener(un.PLAY_SOUNDBOARD,this.onEvent)}onEvent(t){var e;switch(t.type){case wr.PLAY_SAMPLE:{const s=t;this.playFurniSample(s.objectId,s.sampleId,s.pitch);return}case Rt.REMOVED:{const s=t;this.stopFurniSample(s.objectId);return}case te.DISPOSED:{this._furnitureBeingPlayed.getKeys().forEach(s=>{this.stopFurniSample(s)});return}case il.SETTINGS_UPDATED:{const s=t,i=s.volumeFurni!==this._volumeFurni,n=s.volumeTrax!==this._volumeTrax;this._volumeSystem=s.volumeSystem/100,this._volumeFurni=s.volumeFurni/100,this._volumeTrax=s.volumeTrax/100,this._volumeSoundboard=s.volumeSoundboard/100,i&&this.updateFurniSamplesVolume(this._volumeFurni),n&&((e=this._musicController)==null||e.updateVolume(this._volumeTrax));return}case un.PLAY_SOUND:{const s=t;this.playInternalSample(s.sampleCode);return}case un.PLAY_SOUNDBOARD:{const s=t;this.playSoundBoard(s.sampleCode);return}}}playSample(t,e,s=1){t.volume=e,t.currentTime=0;try{t.play()}catch(i){dt.error(i)}}playSoundBoard(t){var e=new Audio(t);this.playSample(e,this._volumeSoundboard)}playInternalSample(t){let e=this._internalSamples.getValue(t);if(!e){const s=Dt.getValue("sounds.url");e=new Audio(s.replace("%sample%",t)),this._internalSamples.add(t,e)}this.playSample(e,this._volumeSystem)}playFurniSample(t,e,s){let i=this._furniSamples.getValue(e);if(!i){const n=Dt.getValue("external.samples.url");i=new Audio(n.replace("%sample%",e.toString())),this._furniSamples.add(e,i)}this._furnitureBeingPlayed.hasKey(t)||this._furnitureBeingPlayed.add(t,e),i.onended=n=>{this.stopFurniSample(t)},i.onpause=n=>{this.stopFurniSample(t)},i.onerror=n=>{this.stopFurniSample(t)},this.playSample(i,this._volumeFurni,s)}stopInternalSample(t){const e=this._internalSamples.getValue(t);if(e)try{e.pause()}catch(s){dt.error(s)}}stopFurniSample(t){const e=this._furnitureBeingPlayed.getValue(t);if(!e)return;const s=this._furniSamples.getValue(e);if(this._furnitureBeingPlayed.remove(t),!!s)try{s.pause()}catch(i){dt.error(i)}}updateInternalSamplesVolume(t){this._internalSamples.getValues().forEach(e=>{e.volume=t})}updateFurniSamplesVolume(t){this._furniSamples.getValues().forEach(e=>{e.volume=t})}get traxVolume(){return this._volumeTrax}get musicController(){return this._musicController}}Zt.available;WE.SCALE_MODE=window.devicePixelRatio%1?Jp.LINEAR:Jp.NEAREST;WE.ROUND_PIXELS=!0;WE.GC_MAX_IDLE=120;const rn=class rn{constructor(t,e){rn.INSTANCE||(rn.INSTANCE=this),this._application=new ws(e),this._core=t,this._events=new nr,this._communication=new AX(t.communication),this._localization=new xX(this._communication),this._avatar=new WR,this._roomEngine=new r_(this._communication),this._sessionDataManager=new Nq(this._communication),this._roomSessionManager=new Aq(this._communication,this._roomEngine),this._roomManager=new NI(this._roomEngine,this._roomEngine.visualizationFactory,this._roomEngine.logicFactory),this._cameraManager=new a1,this._soundManager=new vq,this._linkTrackers=[],this._isReady=!1,this._isDisposed=!1,this._core.configuration.events.addEventListener(dn.LOADED,this.onConfigurationLoadedEvent.bind(this)),this._roomEngine.events.addEventListener(te.ENGINE_INITIALIZED,this.onRoomEngineReady.bind(this))}static bootstrap(){rn.INSTANCE&&(rn.INSTANCE.dispose(),rn.INSTANCE=null);const t=document.createElement("canvas"),e=new this(new Aw,{autoDensity:!1,width:window.innerWidth,height:window.innerHeight,resolution:window.devicePixelRatio,view:t});t.addEventListener("webglcontextlost",()=>e.events.dispatchEvent(new kt(rn.WEBGL_CONTEXT_LOST)))}init(){if(!(this._isReady||this._isDisposed)){if(this._avatar&&this._avatar.init(),this._soundManager&&this._soundManager.init(),this._roomEngine&&(this._roomEngine.sessionDataManager=this._sessionDataManager,this._roomEngine.roomSessionManager=this._roomSessionManager,this._roomEngine.roomManager=this._roomManager,this._sessionDataManager&&this._sessionDataManager.init(),this._roomSessionManager&&this._roomSessionManager.init(),this._roomEngine.init()),!this._communication.connection)throw new Error("No connection found");new NX(this._communication.connection),this._isReady=!0}}dispose(){this._isDisposed||(this._roomManager&&(this._roomManager.dispose(),this._roomManager=null),this._roomSessionManager&&(this._roomSessionManager.dispose(),this._roomSessionManager=null),this._sessionDataManager&&(this._sessionDataManager.dispose(),this._sessionDataManager=null),this._roomEngine&&(this._roomEngine.dispose(),this._roomEngine=null),this._avatar&&(this._avatar.dispose(),this._avatar=null),this._soundManager&&(this._soundManager.dispose(),this._soundManager=null),this._communication&&(this._communication.dispose(),this._communication=null),this._application&&(this._application.destroy(),this._application=null),this._isDisposed=!0,this._isReady=!1)}onConfigurationLoadedEvent(t){fi().maxFPS=Dt.getValue("system.fps.max",24),dt.LOG_DEBUG=Dt.getValue("system.log.debug",!0),dt.LOG_WARN=Dt.getValue("system.log.warn",!1),dt.LOG_ERROR=Dt.getValue("system.log.error",!1),dt.LOG_EVENTS=Dt.getValue("system.log.events",!1),dt.LOG_PACKETS=Dt.getValue("system.log.packets",!1),If.LANDSCAPES_ENABLED=Dt.getValue("room.landscapes.enabled",!0)}onRoomEngineReady(t){this.startSendingHeartBeat()}getConfiguration(t,e=null){return Dt.getValue(t,e)}getLocalization(t){return this._localization.getValue(t)}getLocalizationWithParameter(t,e,s){return this._localization.getValueWithParameter(t,e,s)}getLocalizationWithParameters(t,e,s){return this._localization.getValueWithParameters(t,e,s)}addLinkEventTracker(t){this._linkTrackers.indexOf(t)>=0||this._linkTrackers.push(t)}removeLinkEventTracker(t){const e=this._linkTrackers.indexOf(t);e!==-1&&this._linkTrackers.splice(e,1)}createLinkEvent(t){if(!(!t||t===""))for(const e of this._linkTrackers){if(!e)continue;const s=e.eventUrlPrefix;s.length>0?t.substr(0,s.length)===s&&e.linkReceived(t):e.linkReceived(t)}}startSendingHeartBeat(){this.sendHeartBeat(),setInterval(this.sendHeartBeat,1e4)}sendHeartBeat(){Hn.sendHeartBeat()}get application(){return this._application}get core(){return this._core}get events(){return this._events}get localization(){return this._localization}get communication(){return this._communication}get avatar(){return this._avatar}get roomEngine(){return this._roomEngine}get sessionDataManager(){return this._sessionDataManager}get roomSessionManager(){return this._roomSessionManager}get roomManager(){return this._roomManager}get cameraManager(){return this._cameraManager}get soundManager(){return this._soundManager}get width(){return this._application.renderer.width}get height(){return this._application.renderer.height}get isReady(){return this._isReady}get isDisposed(){return this._isDisposed}static get instance(){return this.INSTANCE||null}};rn.WEBGL_CONTEXT_LOST="NE_WEBGL_CONTEXT_LOST",rn.WEBGL_UNAVAILABLE="NE_WEBGL_UNAVAILABLE",rn.READY="NE_READY!",rn.INSTANCE=null;let Et=rn;const Qt=class Qt{static format(t,e="",s=3){return t>s*Qt.YEAR?Qt.getLocalization("friendlytime.years"+e,Math.round(t/Qt.YEAR)):t>s*Qt.MONTH?Qt.getLocalization("friendlytime.months"+e,Math.round(t/Qt.MONTH)):t>s*Qt.DAY?Qt.getLocalization("friendlytime.days"+e,Math.round(t/Qt.DAY)):t>s*Qt.HOUR?Qt.getLocalization("friendlytime.hours"+e,Math.round(t/Qt.HOUR)):t>s*Qt.MINUTE?Qt.getLocalization("friendlytime.minutes"+e,Math.round(t/Qt.MINUTE)):Qt.getLocalization("friendlytime.seconds"+e,Math.round(t))}static shortFormat(t,e="",s=3){return t>s*Qt.YEAR?Qt.getLocalization("friendlytime.years.short"+e,Math.round(t/Qt.YEAR)):t>s*Qt.MONTH?Qt.getLocalization("friendlytime.months.short"+e,Math.round(t/Qt.MONTH)):t>s*Qt.DAY?Qt.getLocalization("friendlytime.days.short"+e,Math.round(t/Qt.DAY)):t>s*Qt.HOUR?Qt.getLocalization("friendlytime.hours.short"+e,Math.round(t/Qt.HOUR)):t>s*Qt.MINUTE?Qt.getLocalization("friendlytime.minutes.short"+e,Math.round(t/Qt.MINUTE)):Qt.getLocalization("friendlytime.seconds.short"+e,Math.round(t))}static getLocalization(t,e){return Et.instance.getLocalizationWithParameter(t,"amount",e.toString())}};Qt.MINUTE=60,Qt.HOUR=60*Qt.MINUTE,Qt.DAY=24*Qt.HOUR,Qt.WEEK=7*Qt.DAY,Qt.MONTH=30*Qt.DAY,Qt.YEAR=365*Qt.DAY;let Vr=Qt;const TE=class TE{static isBuilderClubId(t){return t>=TE.BUILDER_CLUB_FURNI_ID_BASE}};TE.BUILDER_CLUB_FURNI_ID_BASE=2147418112;let Rf=TE;const Lq=a=>a>>>0,r0=a=>{const t=Lq(a);return t>=Math.pow(2,31)?t-Math.pow(2,32):t};class OO{constructor(t){if(this._id=t.id,this._isMain=t.main||!1,this._avatarSets=new Map,this._bodyParts=[],this._allBodyParts=[],t.avatarSets&&t.avatarSets.length>0)for(const s of t.avatarSets){if(!s)continue;const i=new OO(s);this._avatarSets.set(i.id,i)}if(t.bodyParts&&t.bodyParts.length>0)for(const s of t.bodyParts)s&&this._bodyParts.push(s.id);let e=this._bodyParts.concat();for(const s of this._avatarSets.values())s&&(e=e.concat(s.getBodyParts()));this._allBodyParts=e}findAvatarSet(t){if(t===this._id)return this;for(const e of this._avatarSets.values())if(e&&e.findAvatarSet(t))return e;return null}getBodyParts(){return this._allBodyParts.concat()}get id(){return this._id}get isMain(){if(this._isMain)return!0;for(const t of this._avatarSets.values())if(t&&t.isMain)return!0;return!1}}class Hr{constructor(t=0,e=0,s=0){this._x=t,this._y=e,this._z=s}static dot(t,e){return t.x*e.x+t.y*e.y+t.z*e.z}static cross(t,e){const s=new Hr;return s.x=t.y*e.z-t.z*e.y,s.y=t.z*e.x-t.x*e.z,s.z=t.x*e.y-t.y*e.x,s}static subtract(t,e){return new Hr(t.x-e.x,t.y-e.y,t.z-e.z)}dot(t){return this._x*t.x+this._y*t.y+this._z*t.z}cross(t){const e=new Hr;return e.x=this._y*t.z-this._z*t.y,e.y=this._z*t.x-this._x*t.z,e.z=this._x*t.y-this._y*t.x,e}subtract(t){this._x=this._x-t.x,this._y=this._y-t.y,this._z=this._z-t.z}add(t){this._x=this._x+t.x,this._y=this._y+t.y,this._z=this._z+t.z}normalize(){const t=1/this.length();this._x=this._x*t,this._y=this._y*t,this._z=this._z*t}scaleBy(t){this._x*=t,this._y*=t,this._z*=t}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z)}toString(){return"Vector3D: ("+this._x+","+this._y+","+this._z+")"}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}get z(){return this._z}set z(t){this._z=t}}class n0{constructor(t,e,s){this._location=new Hr(t,e,s),this._transformedLocation=new Hr,this._needsTransformation=!1,(t!=0||e!=0||s!=0)&&(this._needsTransformation=!0)}get location(){return this._location}get transformedLocation(){return this._transformedLocation}applyTransform(t){this._needsTransformation&&(this._transformedLocation=t.vectorMultiplication(this._location))}}class sA extends n0{constructor(t,e=!1){super(parseFloat(t.x),parseFloat(t.y),parseFloat(t.z)),this._id=t.id,this._radius=parseFloat(t.radius),this._normal=new Hr(parseFloat(t.nx),parseFloat(t.ny),parseFloat(t.nz)),this._isDoubleSided=t.double||!1,this._isDynamic=e}getDistance(t){const e=Math.abs(t.z-this.transformedLocation.z-this._radius),s=Math.abs(t.z-this.transformedLocation.z+this._radius);return Math.min(e,s)}get id(){return this._id}get normal(){return this._normal}get isDoubleSided(){return this._isDoubleSided}toString(){return this._id+": "+this.location+" - "+this.transformedLocation}get isDynamic(){return this._isDynamic}}class Pq extends n0{constructor(t){if(super(parseFloat(t.x),parseFloat(t.y),parseFloat(t.z)),this._id=t.id,this._radius=parseFloat(t.radius),this._parts=new Map,this._dynamicParts=new Map,t.items&&t.items.length>0)for(const e of t.items){if(!e)continue;const s=new sA(e);this._parts.set(s.id,s)}}getDynamicParts(t){const e=this._dynamicParts.get(t),s=[];if(e)for(const i in e){const n=e[i];n&&s.push(n)}return s}getPartIds(t){const e=[];for(const s of this._parts.values())s&&e.push(s.id);if(t){const s=this._dynamicParts.get(t);if(s)for(const i in s){const n=s[i];n&&e.push(n.id)}}return e}removeDynamicParts(t){return this._dynamicParts.delete(t),!0}addPart(t,e){if(this.hasPart(t.id,e))return!1;let s=this._dynamicParts.get(e);return s||(s={},this._dynamicParts.set(e,s)),s[t.id]=new sA(t,!0),!0}hasPart(t,e){let s=this._parts.get(t)||null;return!s&&this._dynamicParts.get(e)!==void 0&&(s=this._dynamicParts.get(e)[t]||null),s!==null}getParts(t,e,s,i){const n=[];for(const c of this._parts.values())c&&(c.applyTransform(t),n.push([c.getDistance(e),c]));const o=this._dynamicParts.get(i);if(o)for(const c in o){const u=o[c];u&&(u.applyTransform(t),n.push([u.getDistance(e),u]))}n.sort((c,u)=>{const h=c[0],d=u[0];return h<d?-1:h>d?1:0});const l=[];for(const c of n)c&&l.push(c[1].id);return l}getDistance(t){const e=Math.abs(t.z-this.transformedLocation.z-this._radius),s=Math.abs(t.z-this.transformedLocation.z+this._radius);return Math.min(e,s)}get id(){return this._id}get radius(){return this._radius}}const jr=class jr{constructor(t=0,e=0,s=0,i=0,n=0,o=0,l=0,c=0,u=0){this._data=[t,e,s,i,n,o,l,c,u]}static getXRotationMatrix(t){const e=t*Math.PI/180,s=Math.cos(e),i=Math.sin(e);return new jr(1,0,0,0,s,-i,0,i,s)}static getYRotationMatrix(t){const e=t*Math.PI/180,s=Math.cos(e),i=Math.sin(e);return new jr(s,0,i,0,1,0,-i,0,s)}static getZRotationMatrix(t){const e=t*Math.PI/180,s=Math.cos(e),i=Math.sin(e);return new jr(s,-i,0,i,s,0,0,0,1)}identity(){return this._data=[1,0,0,0,1,0,0,0,1],this}vectorMultiplication(t){const e=t.x*this._data[0]+t.y*this._data[3]+t.z*this._data[6],s=t.x*this._data[1]+t.y*this._data[4]+t.z*this._data[7],i=t.x*this._data[2]+t.y*this._data[5]+t.z*this._data[8];return new Hr(e,s,i)}multiply(t){const e=this._data[0]*t.data[0]+this._data[1]*t.data[3]+this._data[2]*t.data[6],s=this._data[0]*t.data[1]+this._data[1]*t.data[4]+this._data[2]*t.data[7],i=this._data[0]*t.data[2]+this._data[1]*t.data[5]+this._data[2]*t.data[8],n=this._data[3]*t.data[0]+this._data[4]*t.data[3]+this._data[5]*t.data[6],o=this._data[3]*t.data[1]+this._data[4]*t.data[4]+this._data[5]*t.data[7],l=this._data[3]*t.data[2]+this._data[4]*t.data[5]+this._data[5]*t.data[8],c=this._data[6]*t.data[0]+this._data[7]*t.data[3]+this._data[8]*t.data[6],u=this._data[6]*t.data[1]+this._data[7]*t.data[4]+this._data[8]*t.data[7],h=this._data[6]*t.data[2]+this._data[7]*t.data[5]+this._data[8]*t.data[8];return new jr(e,s,i,n,o,l,c,u,h)}scalarMultiply(t){let e=0;for(;e<this._data.length;)this._data[e]=this._data[e]*t,e++}rotateX(t){const e=t*Math.PI/180,s=Math.cos(e),i=Math.sin(e);return new jr(1,0,0,0,s,-i,0,i,s).multiply(this)}rotateY(t){const e=t*Math.PI/180,s=Math.cos(e),i=Math.sin(e);return new jr(s,0,i,0,1,0,-i,0,s).multiply(this)}rotateZ(t){const e=t*Math.PI/180,s=Math.cos(e),i=Math.sin(e);return new jr(s,-i,0,i,s,0,0,0,1).multiply(this)}skew(){}transpose(){return new jr(this._data[0],this._data[3],this._data[6],this._data[1],this._data[4],this._data[7],this._data[2],this._data[5],this._data[8])}equals(t){return!1}get data(){return this._data}};jr.IDENTITY=new jr(1,0,0,0,1,0,0,0,1),jr.TOLERANS=1e-18;let Lh=jr;class Uq{constructor(t){this._camera=new Hr(0,0,10),this._avatarSet=new OO(t.avatarSets[0]),this._geometryTypes=new Map,this._itemIdToBodyPartMap=new Map,this._transformation=new Lh,this._canvases=new Map;const e=t.camera;if(e&&(this._camera.x=parseFloat(e.x),this._camera.y=parseFloat(e.y),this._camera.z=parseFloat(e.z)),t.canvases&&t.canvases.length>0)for(const s of t.canvases){if(!s)continue;const i=s.scale,n=new Map;if(s.geometries&&s.geometries.length>0)for(const o of s.geometries){if(!o)continue;const l=new kw(o,i);n.set(l.id,l)}this._canvases.set(i,n)}if(t.types&&t.types.length>0)for(const s of t.types){if(!s)continue;const i=new Map,n=new Map;if(s.bodyParts&&s.bodyParts.length>0)for(const o of s.bodyParts){if(!o)continue;const l=new Pq(o);i.set(l.id,l);for(const c of l.getPartIds(null))n.set(c,l)}this._geometryTypes.set(s.id,i),this._itemIdToBodyPartMap.set(s.id,n)}}removeDynamicItems(t){for(const e of this._geometryTypes.values())if(e)for(const s of e.values())s&&s.removeDynamicParts(t)}getBodyPartIdsInAvatarSet(t){const e=this._avatarSet.findAvatarSet(t);return e?e.getBodyParts():[]}isMainAvatarSet(t){const e=this._avatarSet.findAvatarSet(t);return e?e.isMain:!1}getCanvas(t,e){const s=this._canvases.get(t);return s&&s.get(e)||null}typeExists(t){return!!this._geometryTypes.get(t)}hasBodyPart(t,e){if(this.typeExists(t)){const s=this._geometryTypes.get(t);if(s&&s.get(e))return!0}return!1}getBodyPartIDs(t){const e=this.getBodyPartsOfType(t),s=[];if(e)for(const i of e.values())i&&s.push(i.id);return s}getBodyPartsOfType(t){return this.typeExists(t)?this._geometryTypes.get(t):new Map}getBodyPart(t,e){return this.getBodyPartsOfType(t).get(e)||null}getBodyPartOfItem(t,e,s){const i=this._itemIdToBodyPartMap.get(t);if(i){const n=i.get(e);if(n)return n;const o=this.getBodyPartsOfType(t);if(o){for(const l of o.values())if(l&&l.hasPart(e,s))return l}}return null}getBodyPartsInAvatarSet(t,e){const s=this.getBodyPartIdsInAvatarSet(e),i=[];for(const n of s){if(!n)continue;const o=t.get(n);o&&i.push(o)}return i}getBodyPartsAtAngle(t,e,s){if(!s)return[];const i=this.getBodyPartsOfType(s),n=this.getBodyPartsInAvatarSet(i,t),o=[],l=[];this._transformation=Lh.getYRotationMatrix(e);for(const c of n.values())c&&(c.applyTransform(this._transformation),o.push([c.getDistance(this._camera),c]));o.sort((c,u)=>{const h=c[0],d=u[0];return h<d?-1:h>d?1:0});for(const c of o)c&&l.push(c[1].id);return l}getParts(t,e,s,i,n){if(this.hasBodyPart(t,e)){const o=this.getBodyPartsOfType(t).get(e);return this._transformation=Lh.getYRotationMatrix(s),o.getParts(this._transformation,this._camera,i,n)}return[]}}class jq extends nr{constructor(t){super(),this._renderManager=t,this._geometry=null,this._figureData=new Yw,this._partSetsData=new zw,this._animationData=new Bw,this._animationManager=new Uw,this._mandatorySetTypeIds={},this._actionManager=null,this._defaultAction=null}init(){}dispose(){this.disposed||(super.dispose(),this._renderManager=null,this._figureData=null,this._partSetsData=null,this._animationData=null,this._mandatorySetTypeIds=null)}initGeometry(t){t&&(this._geometry=new Uq(t))}initActions(t,e){e&&(this._actionManager=new Mw(t,e),this._defaultAction=this._actionManager.getDefaultAction())}updateActions(t){this._actionManager.updateActions(t),this._defaultAction=this._actionManager.getDefaultAction()}initPartSets(t){return t&&this._partSetsData.parse(t)?(this._partSetsData.getPartDefinition("ri").appendToFigure=!0,this._partSetsData.getPartDefinition("li").appendToFigure=!0,!0):!1}initAnimation(t){return t?this._animationData.parse(t):!1}initFigureData(t){return t?this._figureData.parse(t):!1}injectFigureData(t){this._figureData.injectJSON(t)}registerAnimations(t,e="fx",s=200){let i=0;for(;i<s;){const n=t.getCollection(e+i);if(n){const o=n.data;this._animationManager.registerAnimation(this,o.animations)}i++}}registerAnimation(t){this._animationManager.registerAnimation(this,t)}getPartColor(t,e,s=0){const i=t.getPartColorIds(e);if(!i||i.length<s)return null;const n=this._figureData.getSetType(e);if(n==null)return null;const o=this._figureData.getPalette(n.paletteID);return o?o.getColor(i[s]):null}getBodyPartData(t,e,s){return this._animationManager.getLayerData(t,e,s)}getAnimation(t){return this._animationManager.getAnimation(t)}getActionDefinition(t){return this._actionManager.getActionDefinition(t)}getActionDefinitionWithState(t){return this._actionManager.getActionDefinitionWithState(t)}isMainAvatarSet(t){return this._geometry.isMainAvatarSet(t)}sortActions(t){return this._actionManager.sortActions(t)}maxFrames(t){let e=0;for(const s of t)e=Math.max(e,this._animationData.getFrameCount(s.definition));return e}getMandatorySetTypeIds(t,e){return this._mandatorySetTypeIds[t]||(this._mandatorySetTypeIds[t]=[]),this._mandatorySetTypeIds[t][e]?this._mandatorySetTypeIds[t][e]:(this._mandatorySetTypeIds[t][e]=this._figureData.getMandatorySetTypeIds(t,e),this._mandatorySetTypeIds[t][e])}getDefaultPartSet(t,e){return this._figureData.getDefaultPartSet(t,e)}getCanvasOffsets(t,e,s){return this._actionManager.getCanvasOffsets(t,e,s)}getCanvas(t,e){return this._geometry.getCanvas(t,e)}removeDynamicItems(t){this._geometry.removeDynamicItems(t)}getActiveBodyPartIds(t,e){let s=[];const i=[],n=t.definition.geometryType;if(t.definition.isAnimation){const o=t.definition.state+"."+t.actionParameter,l=this._animationManager.getAnimation(o);if(l&&(s=l.getAnimatedBodyPartIds(0,t.overridingAction),l.hasAddData())){const c={id:"",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:1},u={setType:""};for(const h of l.addData){const d=this._geometry.getBodyPart(n,h.align);if(d){c.id=h.id,d.addPart(c,e),u.setType=h.id;const g=this._partSetsData.addPartDefinition(u);g.appendToFigure=!0,h.base===""&&(g.staticId=1),i.indexOf(d.id)===-1&&i.push(d.id)}}}for(const c of s){const u=this._geometry.getBodyPart(n,c);u&&i.indexOf(u.id)===-1&&i.push(u.id)}}else{s=this._partSetsData.getActiveParts(t.definition);for(const o of s){const l=this._geometry.getBodyPartOfItem(n,o,e);l&&i.indexOf(l.id)===-1&&i.push(l.id)}}return i}getBodyPartsUnordered(t){return this._geometry.getBodyPartIdsInAvatarSet(t)}getBodyParts(t,e,s){const i=_n.DIRECTION_TO_ANGLE[s];return this._geometry.getBodyPartsAtAngle(t,i,e)}getFrameBodyPartOffset(t,e,s,i){const n=this._animationData.getAction(t.definition);return n?n.getFrameBodyPartOffset(e,s,i):Yd.DEFAULT_OFFSET}getParts(t,e,s,i,n,o,l,c=null){let u=null,h=[],d=null;if(!s==null)return[];const g=this._partSetsData.getActiveParts(s.definition),E=[];let m=[0];const I=this._animationData.getAction(s.definition);if(s.definition.isAnimation){const S=s.definition.state+"."+s.actionParameter,b=this._animationManager.getAnimation(S);if(b){m=this.getPopulatedArray(b.frameCount(s.overridingAction));for(const N of b.getAnimatedBodyPartIds(0,s.overridingAction))if(N===t){const P=this._geometry.getBodyPart(i,N);if(P)for(const B of P.getDynamicParts(l))g.push(B.id)}}}const p=this._geometry.getParts(i,t,n,g,l),T=e.getPartTypeIds();for(const S of T){if(c&&c.get(S))continue;const b=e.getPartSetId(S),N=e.getPartColorIds(S),P=this._figureData.getSetType(S);if(P){const B=this._figureData.getPalette(P.paletteID);if(B){const F=P.getPartSet(b);if(F){o=o.concat(F.hiddenLayers);for(const w of F.parts)if(p.indexOf(w.type)>-1){if(I){const et=I.getPart(w.type);et?h=et.frames:h=m}else h=m;u=s.definition,g.indexOf(w.type)===-1&&(u=this._defaultAction);const U=this._partSetsData.getPartDefinition(w.type);let G=U?U.flippedSetType:w.type;(!G||G==="")&&(G=w.type),N&&N.length>w.colorLayerIndex-1&&(d=B.getColor(N[w.colorLayerIndex-1]));const K=w.colorLayerIndex>0,z=new Sp(t,w.type,w.id.toString(),d,h,u,K,w.paletteMap,G);E.push(z)}}}}}const R=[];for(const S of p){let b=null,N=!1;const P=c&&c.get(S);for(const B of E)B.partType===S&&(P?b=B.color:(N=!0,o.indexOf(S)===-1&&R.push(B)));if(!N){if(P){const B=c.get(S);let F=0,w=0;for(;w<B.length;)F=F+B.charCodeAt(w),w++;if(I){const G=I.getPart(S);G?h=G.frames:h=m}else h=m;const U=new Sp(t,S,B,b,h,s.definition,b!=null,-1,S,!1,1);R.push(U)}else if(g.indexOf(S)>-1){const B=this._geometry.getBodyPartOfItem(i,S,l);if(t===B.id){const F=this._partSetsData.getPartDefinition(S);let w=!1,U=1;if(F.appendToFigure){let G="1";if(s.actionParameter!==""&&(G=s.actionParameter),F.hasStaticId()&&(G=F.staticId.toString()),I){const z=I.getPart(S);z?h=z.frames:h=m}else h=m;const K=new Sp(t,S,G,null,h,s.definition,!1,-1,S,w,U);R.push(K)}}}}}return R}getPopulatedArray(t){const e=[];let s=0;for(;s<t;)e.push(s),s++;return e}getItemIds(){if(this._actionManager){const t=this._actionManager.getActionDefinition("CarryItem").params,e=[];for(const s of t.values())e.push(s);return e}return[]}get renderManager(){return this._renderManager}get figureData(){return this._figureData}get partData(){return this._partSetsData}get animationManager(){return this._animationManager}}const wq={animations:[{id:"Move",parts:[{setType:"bd",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"bds",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"ss",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"lg",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"sh",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"lh",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"lhs",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"ls",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"lc",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"rh",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"rhs",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"rs",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"rc",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"ch",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]}]},{id:"Wave",parts:[{setType:"lh",frames:[{number:0,assetPartDefinition:"wav"},{number:1,assetPartDefinition:"wav"}]},{setType:"lhs",frames:[{number:0,assetPartDefinition:"wav"},{number:1,assetPartDefinition:"wav"}]},{setType:"ls",frames:[{number:0,assetPartDefinition:"wav"},{number:1,assetPartDefinition:"wav"}]},{setType:"lc",frames:[{number:0,assetPartDefinition:"wav"},{number:1,assetPartDefinition:"wav"}]},{setType:"ch",frames:[{number:0,assetPartDefinition:"wav"},{number:1,assetPartDefinition:"wav"},{number:2,assetPartDefinition:"wav"},{number:3,assetPartDefinition:"wav"}]}]},{id:"Talk",parts:[{setType:"hd",frames:[{number:0,assetPartDefinition:"spk"},{number:1,assetPartDefinition:"spk"}]},{setType:"fc",frames:[{number:0,assetPartDefinition:"spk"},{number:1,assetPartDefinition:"spk"}]},{setType:"fa",frames:[{number:0,assetPartDefinition:"spk"},{number:1,assetPartDefinition:"spk"}]}]},{id:"Sign",parts:[{setType:"lh",frames:[{number:0,assetPartDefinition:"sig"}]},{setType:"li",frames:[{number:0,assetPartDefinition:"sig"}]},{setType:"ls",frames:[{number:0,assetPartDefinition:"wav"}]},{setType:"lc",frames:[{number:0,assetPartDefinition:"wav"}]}]},{id:"Respect",parts:[{setType:"lh",frames:[{number:0,assetPartDefinition:"respect",repeats:15},{number:1,assetPartDefinition:"respect",repeats:15}]},{setType:"ls",frames:[{number:0,assetPartDefinition:"wav",repeats:15},{number:1,assetPartDefinition:"wav",repeats:15}]},{setType:"lc",frames:[{number:0,assetPartDefinition:"wav",repeats:15},{number:1,assetPartDefinition:"wav",repeats:15}]}]},{id:"Blow",parts:[{setType:"rh",frames:[{number:0,assetPartDefinition:"blw",repeats:10},{number:1,assetPartDefinition:"blw",repeats:10}]},{setType:"rs",frames:[{number:0,assetPartDefinition:"drk"}]},{setType:"rc",frames:[{number:0,assetPartDefinition:"drk"}]},{setType:"ri",frames:[{number:0,assetPartDefinition:""}]},{setType:"ey",frames:[{number:0,assetPartDefinition:"std",repeats:10},{number:0,assetPartDefinition:"eyb",repeats:10}]},{setType:"fc",frames:[{number:0,assetPartDefinition:"std",repeats:10},{number:0,assetPartDefinition:"blw",repeats:10}]}]},{id:"Laugh",parts:[{setType:"rh",frames:[{number:0,assetPartDefinition:"blw"}]},{setType:"rs",frames:[{number:0,assetPartDefinition:"drk"}]},{setType:"rc",frames:[{number:0,assetPartDefinition:"drk"}]},{setType:"ri",frames:[{number:0,assetPartDefinition:""}]},{setType:"ey",frames:[{number:0,assetPartDefinition:"std",repeats:2}]},{setType:"fc",frames:[{number:0,assetPartDefinition:"sml"}]}],offsets:{frames:[{id:0,directions:[{id:0,bodyParts:[{id:"head",dx:0,dy:1}]},{id:1,bodyParts:[{id:"head",dx:0,dy:1}]},{id:2,bodyParts:[{id:"head",dx:0,dy:1}]},{id:3,bodyParts:[{id:"head",dx:0,dy:1}]},{id:4,bodyParts:[{id:"head",dx:0,dy:1}]},{id:5,bodyParts:[{id:"head",dx:0,dy:1}]},{id:6,bodyParts:[{id:"head",dx:0,dy:1}]},{id:7,bodyParts:[{id:"head",dx:0,dy:1}]}]},{id:1,directions:[{id:0,bodyParts:[{id:"head",dx:0,dy:0}]},{id:1,bodyParts:[{id:"head",dx:0,dy:0}]},{id:2,bodyParts:[{id:"head",dx:0,dy:0}]},{id:3,bodyParts:[{id:"head",dx:0,dy:0}]},{id:4,bodyParts:[{id:"head",dx:0,dy:0}]},{id:5,bodyParts:[{id:"head",dx:0,dy:0}]},{id:6,bodyParts:[{id:"head",dx:0,dy:0}]},{id:7,bodyParts:[{id:"head",dx:0,dy:0}]}]}]}}]},Fq={geometry:{direction:0,camera:{x:0,y:0,z:10},canvases:[{scale:"h",geometries:[{id:"vertical",width:90,height:130,dx:0,dy:0},{id:"sitting",width:90,height:130,dx:0,dy:0},{id:"horizontal",width:128,height:80,dx:30,dy:0},{id:"swhorizontal",width:192,height:120,dx:0,dy:-40}]},{scale:"sh",geometries:[{id:"vertical",width:45,height:72,dx:0,dy:0},{id:"sitting",width:45,height:72,dx:0,dy:0},{id:"horizontal",width:64,height:50,dx:15,dy:-10},{id:"swhorizontal",width:96,height:70,dx:0,dy:-20},{id:"swim",width:64,height:70,dx:25,dy:10}]}],avatarSets:[{id:"full",avatarSets:[{id:"body",main:!0,bodyParts:[{id:"top"},{id:"bottom"},{id:"behind"},{id:"torso"},{id:"leftitem"},{id:"rightitem"},{id:"leftarm"},{id:"rightarm"}]},{id:"head",bodyParts:[{id:"head"}]}]}],types:[{id:"vertical",bodyParts:[{id:"top",x:0,y:0,z:0,radius:2},{id:"bottom",x:0,y:0,z:0,radius:.001},{id:"behind",x:0,y:0,z:.2,radius:.3},{id:"torso",x:0,y:0,z:0,radius:.4,items:[{id:"bd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"bds",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"ch",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"sh",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"lg",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"ss",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"cp",x:0,y:0,z:0,radius:.045,nx:0,ny:0,nz:-1,double:!1},{id:"wa",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!1},{id:"cc",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ca",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"li",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"ri",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftarm",x:-1,y:0,z:-.51,radius:.5,items:[{id:"lh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"lhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"ls",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"lc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightarm",x:1,y:0,z:-.51,radius:.5,items:[{id:"rh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rs",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"rc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"head",x:0,y:0,z:0,radius:.5,items:[{id:"hd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"fc",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ey",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"hr",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!0},{id:"hrb",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!0},{id:"fa",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ea",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1},{id:"ha",x:0,y:0,z:0,radius:.08,nx:0,ny:0,nz:-1,double:!1},{id:"he",x:0,y:0,z:0,radius:.09,nx:0,ny:0,nz:-1,double:!1}]}]},{id:"sitting",bodyParts:[{id:"top",x:0,y:0,z:0,radius:2},{id:"bottom",x:0,y:0,z:0,radius:.001},{id:"behind",x:0,y:0,z:.2,radius:.3},{id:"torso",x:0,y:0,z:0,radius:.4,items:[{id:"bd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"bds",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"ch",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"sh",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"lg",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ss",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"cp",x:0,y:0,z:0,radius:.045,nx:0,ny:0,nz:-1,double:!1},{id:"wa",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!1},{id:"cc",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ca",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"li",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"ri",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftarm",x:-1,y:0,z:-.51,radius:.5,items:[{id:"lh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"lhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"ls",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"lc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightarm",x:1,y:0,z:-.51,radius:.5,items:[{id:"rh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rs",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"rc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"head",x:0,y:0,z:0,radius:.5,items:[{id:"hd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"fc",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ey",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"hr",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!0},{id:"hrb",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!0},{id:"fa",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ea",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1},{id:"ha",x:0,y:0,z:0,radius:.08,nx:0,ny:0,nz:-1,double:!1},{id:"he",x:0,y:0,z:0,radius:.09,nx:0,ny:0,nz:-1,double:!1}]}]},{id:"horizontal",bodyParts:[{id:"torso",x:0,y:0,z:0,radius:.4,items:[{id:"bd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"bds",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"ch",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"cp",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1},{id:"sh",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"lg",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"ss",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"wa",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!1},{id:"cc",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ca",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"li",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"ri",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftarm",x:-1,y:0,z:-.51,radius:.6,items:[{id:"lh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"lhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"ls",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"lc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightarm",x:1,y:0,z:-.51,radius:.6,items:[{id:"rh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rs",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"rc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"head",x:0,y:0,z:0,radius:.5,items:[{id:"hd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"fc",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ey",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"hr",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!0},{id:"hrb",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!0},{id:"fa",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ea",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1},{id:"ha",x:0,y:0,z:0,radius:.08,nx:0,ny:0,nz:-1,double:!1},{id:"he",x:0,y:0,z:0,radius:.09,nx:0,ny:0,nz:-1,double:!1}]}]},{id:"swhorizontal",bodyParts:[{id:"torso",x:0,y:0,z:0,radius:.4,items:[{id:"bd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"bds",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"ch",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"cp",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1},{id:"sh",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"lg",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"ss",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"wa",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!1},{id:"cc",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ca",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"li",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"ri",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftarm",x:-1,y:0,z:-.51,radius:.6,items:[{id:"lh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"lhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"ls",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"lc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightarm",x:1,y:0,z:-.51,radius:.6,items:[{id:"rh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rs",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"rc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"head",x:0,y:0,z:0,radius:.5,items:[{id:"hd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"fc",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ey",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"hr",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!0},{id:"hrb",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!0},{id:"fa",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ea",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1},{id:"ha",x:0,y:0,z:0,radius:.08,nx:0,ny:0,nz:-1,double:!1},{id:"he",x:0,y:0,z:0,radius:.09,nx:0,ny:0,nz:-1,double:!1}]}]},{id:"swim",bodyParts:[{id:"torso",x:0,y:0,z:0,radius:.4,items:[{id:"bds",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"ss",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1}]},{id:"head",x:0,y:0,z:0,radius:.5,items:[{id:"hd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"fc",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ey",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"hr",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!0},{id:"hrb",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!0},{id:"fa",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ea",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1},{id:"ha",x:0,y:0,z:0,radius:.08,nx:0,ny:0,nz:-1,double:!1},{id:"he",x:0,y:0,z:0,radius:.09,nx:0,ny:0,nz:-1,double:!1}]}]}]}},Gq={partSets:{partSet:[{setType:"ri",flippedSetType:"ri"},{setType:"ri",flippedSetType:"ri"},{setType:"rh",flippedSetType:"lh"},{setType:"rhs",flippedSetType:"lhs"},{setType:"rs",swim:"0",flippedSetType:"ls"},{setType:"rc",flippedSetType:"lc"},{setType:"bd"},{setType:"bds"},{setType:"ss"},{setType:"sh"},{setType:"lg"},{setType:"ch"},{setType:"cp"},{setType:"cc"},{setType:"hd"},{setType:"fc"},{setType:"ey"},{setType:"hr"},{setType:"hrb",removeSetType:"hr"},{setType:"li",flippedSetType:"li"},{setType:"lh",flippedSetType:"rh"},{setType:"lhs",flippedSetType:"rhs"},{setType:"ls",flippedSetType:"rs"},{setType:"lc",flippedSetType:"rc"},{setType:"wa"},{setType:"ea"},{setType:"ca"},{setType:"fa"},{setType:"ha"},{setType:"he"}],activePartSets:[{id:"figure",activeParts:[{setType:"rh"},{setType:"rh"},{setType:"rhs"},{setType:"rs"},{setType:"rc"},{setType:"bd"},{setType:"bds"},{setType:"ss"},{setType:"sh"},{setType:"lg"},{setType:"ch"},{setType:"cp"},{setType:"cc"},{setType:"wa"},{setType:"hd"},{setType:"fc"},{setType:"ey"},{setType:"hr"},{setType:"hrb"},{setType:"lh"},{setType:"lhs"},{setType:"ls"},{setType:"lc"},{setType:"ea"},{setType:"ca"},{setType:"fa"},{setType:"ha"},{setType:"he"}]},{id:"head",activeParts:[{setType:"hd"},{setType:"fc"},{setType:"ey"},{setType:"hr"},{setType:"hrb"},{setType:"ea"},{setType:"fa"},{setType:"ha"},{setType:"he"}]},{id:"speak",activeParts:[{setType:"hd"},{setType:"hr"},{setType:"hrb"},{setType:"fc"},{setType:"fa"},{setType:"ha"}]},{id:"gesture",activeParts:[{setType:"ey"},{setType:"fc"}]},{id:"eye",activeParts:[{setType:"ey"}]},{id:"handRight",activeParts:[{setType:"rh"},{setType:"rhs"},{setType:"rs"},{setType:"rc"},{setType:"ri"}]},{id:"handRightAndHead",activeParts:[{setType:"rh"},{setType:"rhs"},{setType:"rs"},{setType:"rc"},{setType:"ri"},{setType:"ey"},{setType:"fc"},{setType:"hd"}]},{id:"handLeft",activeParts:[{setType:"lh"},{setType:"lhs"},{setType:"ls"},{setType:"lc"},{setType:"li"}]},{id:"walk",activeParts:[{setType:"bd"},{setType:"bds"},{setType:"ss"},{setType:"lg"},{setType:"lh"},{setType:"lhs"},{setType:"rh"},{setType:"rhs"},{setType:"ls"},{setType:"lc"},{setType:"rs"},{setType:"rc"},{setType:"sh"}]},{id:"sit",activeParts:[{setType:"bd"},{setType:"bds"},{setType:"ss"},{setType:"lg"},{setType:"sh"},{setType:"cc"}]},{id:"itemRight",activeParts:[{setType:"ri"}]}]}},mr=class mr extends nr{constructor(t,e,s,i){super(),this._state=mr.NOT_LOADED,this._libraryName=t,this._revision=e,this._downloadUrl=i,this._assets=s,this._animation=null,this._downloadUrl=this._downloadUrl.replace(/%libname%/gi,this._libraryName),this._downloadUrl=this._downloadUrl.replace(/%revision%/gi,this._revision),this._assets.getCollection(this._libraryName)&&(this._state=mr.LOADED)}async downloadAsset(){if(!this._assets||this._state===mr.LOADING||this._state===mr.LOADED)return;if(this._assets.getCollection(this._libraryName)){this._state=mr.LOADED,this.dispatchEvent(new lc(lc.DOWNLOAD_COMPLETE,this));return}if(this._state=mr.LOADING,!await this._assets.downloadAsset(this._downloadUrl))return;this._state=mr.LOADED;const s=this._assets.getCollection(this._libraryName);s&&(this._animation=s.data.animations),this.dispatchEvent(new lc(lc.DOWNLOAD_COMPLETE,this))}get libraryName(){return this._libraryName}get animation(){return this._animation}get isLoaded(){return this._state===mr.LOADED}};mr.DOWNLOAD_COMPLETE="EADL_DOWNLOAD_COMPLETE",mr.NOT_LOADED=0,mr.LOADING=1,mr.LOADED=2;let HR=mr;const ic=class ic extends nr{constructor(t,e){super(),this._assets=t,this._structure=e,this._missingMandatoryLibs=Dt.getValue("avatar.mandatory.effect.libraries"),this._effectMap=new Map,this._effectListeners=new Map,this._incompleteEffects=new Map,this._initDownloadBuffer=[],this._pendingDownloadQueue=[],this._currentDownloads=[],this._libraryNames=[],this._isReady=!1,this.onLibraryLoaded=this.onLibraryLoaded.bind(this),this.onAvatarRenderReady=this.onAvatarRenderReady.bind(this),this.loadEffectMap(),this._structure.renderManager.events.addEventListener(Gd.AVATAR_RENDER_READY,this.onAvatarRenderReady)}loadEffectMap(){const t=new XMLHttpRequest;try{t.open("GET",Dt.getValue("avatar.effectmap.url")),t.send(),t.onloadend=e=>{if(t.responseText){const s=JSON.parse(t.responseText);this.processEffectMap(s.effects),this.processMissingLibraries(),this._isReady=!0,this.dispatchEvent(new kt(ic.DOWNLOADER_READY))}},t.onerror=e=>{throw new Error("invalid_avatar_effect_map")}}catch(e){dt.error(e)}}processEffectMap(t){if(t)for(const e of t){if(!e)continue;const s=e.id,i=e.lib,n=e.revision||"";if(this._libraryNames.indexOf(i)>=0)continue;this._libraryNames.push(i);const o=new HR(i,n,this._assets,Dt.getValue("avatar.asset.effect.url"));o.addEventListener(lc.DOWNLOAD_COMPLETE,this.onLibraryLoaded);let l=this._effectMap.get(s);l||(l=[]),l.push(o),this._effectMap.set(s,l)}}downloadAvatarEffect(t,e){if(!this._isReady||!this._structure.renderManager.isReady){this._initDownloadBuffer.push([t,e]);return}const s=this.getAvatarEffectPendingLibraries(t);if(s&&s.length){if(e&&!e.disposed){let i=this._effectListeners.get(t.toString());i||(i=[]),i.push(e),this._effectListeners.set(t.toString(),i)}this._incompleteEffects.set(t.toString(),s);for(const i of s)i&&this.downloadLibrary(i)}else e&&!e.disposed&&e.resetEffect(t)}onAvatarRenderReady(t){if(t){for(const[e,s]of this._initDownloadBuffer)this.downloadAvatarEffect(e,s);this._initDownloadBuffer=[]}}onLibraryLoaded(t){if(!t||!t.library)return;const e=[];this._structure.registerAnimation(t.library.animation);for(const[i,n]of this._incompleteEffects.entries()){let o=!0;for(const l of n)if(!(!l||l.isLoaded)){o=!1;break}if(o){e.push(i);const l=this._effectListeners.get(i);for(const c of l)!c||c.disposed||c.resetEffect(parseInt(i));this._effectListeners.delete(i),this.dispatchEvent(new kt(ic.LIBRARY_LOADED))}}for(const i of e)this._incompleteEffects.delete(i);let s=0;for(;s<this._currentDownloads.length;){const i=this._currentDownloads[s];i&&i.libraryName===t.library.libraryName&&this._currentDownloads.splice(s,1),s++}}processMissingLibraries(){const t=this._missingMandatoryLibs.slice();for(const e of t){if(!e)continue;const s=this._effectMap.get(e);if(s)for(const i of s)i&&this.downloadLibrary(i)}}isAvatarEffectReady(t){return!this._isReady||!this._structure.renderManager.isReady?!1:!this.getAvatarEffectPendingLibraries(t).length}getAvatarEffectPendingLibraries(t){const e=[];if(!this._structure)return e;const s=this._effectMap.get(t.toString());if(s)for(const i of s)!i||i.isLoaded||e.indexOf(i)===-1&&e.push(i);return e}downloadLibrary(t){!t||t.isLoaded||this._pendingDownloadQueue.indexOf(t)>=0||this._currentDownloads.indexOf(t)>=0||(this._pendingDownloadQueue.push(t),this.processDownloadQueue())}processDownloadQueue(){for(;this._pendingDownloadQueue.length;)this._pendingDownloadQueue[0].downloadAsset(),this._currentDownloads.push(this._pendingDownloadQueue.shift())}};ic.DOWNLOADER_READY="EADM_DOWNLOADER_READY",ic.LIBRARY_LOADED="EADM_LIBRARY_LOADED",ic.MAX_DOWNLOADS=2;let vl=ic;class Bq extends vg{constructor(t,e,s,i,n){super(t,e,s,i,n,null)}isPlaceholder(){return!0}}const RE=class RE extends Fa{constructor(){super(),this._structure=null,this._avatarAssetDownloadManager=null,this._placeHolderFigure=null,this._figureMapReady=!1,this._effectMapReady=!1,this._actionsReady=!1,this._geometryReady=!1,this._partSetsReady=!1,this._animationsReady=!1,this._isReady=!1,this.onAvatarAssetDownloaderReady=this.onAvatarAssetDownloaderReady.bind(this),this.onAvatarAssetDownloaded=this.onAvatarAssetDownloaded.bind(this),this.onEffectAssetDownloaderReady=this.onEffectAssetDownloaderReady.bind(this),this.onEffectAssetDownloaded=this.onEffectAssetDownloaded.bind(this),this.onAvatarStructureDownloadDone=this.onAvatarStructureDownloadDone.bind(this)}onInit(){this._structure=new jq(this),this.loadGeometry(),this.loadPartSets(),this.loadActions(),this.loadAnimations(),this.loadFigureData(),this._aliasCollection=new Dw(this,Rr()),this._aliasCollection.init(),this._avatarAssetDownloadManager||(this._avatarAssetDownloadManager=new yl(Rr(),this._structure),this._avatarAssetDownloadManager.addEventListener(yl.DOWNLOADER_READY,this.onAvatarAssetDownloaderReady),this._avatarAssetDownloadManager.addEventListener(yl.LIBRARY_LOADED,this.onAvatarAssetDownloaded)),this._effectAssetDownloadManager||(this._effectAssetDownloadManager=new vl(Rr(),this._structure),this._effectAssetDownloadManager.addEventListener(vl.DOWNLOADER_READY,this.onEffectAssetDownloaderReady),this._effectAssetDownloadManager.addEventListener(vl.LIBRARY_LOADED,this.onEffectAssetDownloaded)),this.checkReady()}onDispose(){this._avatarAssetDownloadManager&&(this._avatarAssetDownloadManager.removeEventListener(yl.DOWNLOADER_READY,this.onAvatarAssetDownloaderReady),this._avatarAssetDownloadManager.removeEventListener(yl.LIBRARY_LOADED,this.onAvatarAssetDownloaded)),this._effectAssetDownloadManager&&(this._effectAssetDownloadManager.removeEventListener(vl.DOWNLOADER_READY,this.onEffectAssetDownloaderReady),this._effectAssetDownloadManager.removeEventListener(vl.LIBRARY_LOADED,this.onEffectAssetDownloaded))}loadGeometry(){this._structure&&(this._structure.initGeometry(Fq.geometry),this._geometryReady=!0,this.checkReady())}loadPartSets(){this._structure&&(this._structure.initPartSets(Gq.partSets),this._partSetsReady=!0,this.checkReady())}loadActions(){const t=Dt.getValue("avatar.default.actions");t&&this._structure.initActions(Rr(),t);const e=new XMLHttpRequest;try{e.open("GET",Dt.getValue("avatar.actions.url")),e.send(),e.onloadend=s=>{this._structure&&(this._structure.updateActions(JSON.parse(e.responseText)),this._actionsReady=!0,this.checkReady())},e.onerror=s=>{throw new Error("invalid_avatar_actions")}}catch(s){dt.error(s)}}loadAnimations(){this._structure&&(this._structure.initAnimation(wq.animations),this._animationsReady=!0,this.checkReady())}loadFigureData(){const t=Dt.getValue("avatar.default.figuredata");if(!t||typeof t=="string"){dt.error("XML figuredata is no longer supported");return}this._structure&&this._structure.initFigureData(t),new Lg(Dt.getValue("avatar.figuredata.url"),this._structure.figureData).addEventListener(Lg.AVATAR_STRUCTURE_DONE,this.onAvatarStructureDownloadDone)}onAvatarStructureDownloadDone(t){this._structureReady=!0,this._structure.init(),this.checkReady()}onAvatarAssetDownloaderReady(t){t&&(this._figureMapReady=!0,this.checkReady())}onAvatarAssetDownloaded(t){t&&this._aliasCollection.reset()}onEffectAssetDownloaderReady(t){t&&(this._effectMapReady=!0,this.checkReady())}onEffectAssetDownloaded(t){t&&this._aliasCollection.reset()}checkReady(){this._isReady||!this._geometryReady||!this._partSetsReady||!this._actionsReady||!this._animationsReady||!this._figureMapReady||!this._effectMapReady||!this._structureReady||(this._isReady=!0,this.events&&this.events.dispatchEvent(new kt(Gd.AVATAR_RENDER_READY)))}createFigureContainer(t){return new Mh(t)}isFigureContainerReady(t){return this._avatarAssetDownloadManager?this._avatarAssetDownloadManager.isAvatarFigureContainerReady(t):!1}createAvatarImage(t,e,s,i=null,n=null){if(!this._structure||!this._avatarAssetDownloadManager)return null;const o=new Mh(t);return s&&this.validateAvatarFigure(o,s),this._avatarAssetDownloadManager.isAvatarFigureContainerReady(o)?new vg(this._structure,this._aliasCollection,o,e,this._effectAssetDownloadManager,n):(this._placeHolderFigure||(this._placeHolderFigure=new Mh(RE.DEFAULT_FIGURE)),this._avatarAssetDownloadManager.downloadAvatarFigure(o,i),new Bq(this._structure,this._aliasCollection,this._placeHolderFigure,e,this._effectAssetDownloadManager))}downloadAvatarFigure(t,e){this._avatarAssetDownloadManager&&this._avatarAssetDownloadManager.downloadAvatarFigure(t,e)}validateAvatarFigure(t,e){let s=!1;const i=this._structure.getMandatorySetTypeIds(e,2);if(i){const n=this._structure.figureData;for(const o of i)if(t.hasPartType(o)){const l=n.getSetType(o);if(l&&!l.getPartSet(t.getPartSetId(o))){const u=this._structure.getDefaultPartSet(o,e);u&&(t.updatePart(o,u.id,[0]),s=!0)}}else{const l=this._structure.getDefaultPartSet(o,e);l&&(t.updatePart(o,l.id,[0]),s=!0)}}return!s}getFigureClubLevel(t,e,s=null){if(!this._structure)return 0;const i=this._structure.figureData,n=Array.from(t.getPartTypeIds());let o=0;for(const l of n){const c=i.getSetType(l);if(!c)continue;const u=t.getPartSetId(l),h=c.getPartSet(u);if(h){o=Math.max(h.clubLevel,o);const d=i.getPalette(c.paletteID),g=t.getPartColorIds(l);for(const E of g){const m=d.getColor(E);m&&(o=Math.max(m.clubLevel,o))}}}s||(s=this._structure.getBodyPartsUnordered(si.FULL));for(const l of s){const c=i.getSetType(l);c&&n.indexOf(l)===-1&&(o=Math.max(c.optionalFromClubLevel(e),o))}return o}isValidFigureSetForGender(t,e){const i=this.structureData.getFigurePartSet(t);return!!(i&&(i.gender.toUpperCase()==="U"||i.gender.toUpperCase()===e.toUpperCase()))}getFigureStringWithFigureIds(t,e,s){const i=new RI;i.loadAvatarData(t,e);const n=this.resolveFigureSets(s);for(const o of n)i.savePartData(o.type,o.id,i.getColourIds(o.type));return i.getFigureString()}resolveFigureSets(t){const e=this.structureData,s=[];for(const i of t){const n=e.getFigurePartSet(i);n&&s.push(n)}return s}getMandatoryAvatarPartSetIds(t,e){return this._structure?this._structure.getMandatorySetTypeIds(t,e):null}getAssetByName(t){return this._aliasCollection.getAsset(t)}get assets(){return Rr()}get isReady(){return this._isReady}get structure(){return this._structure}get structureData(){return this._structure?this._structure.figureData:null}get downloadManager(){return this._avatarAssetDownloadManager}};RE.DEFAULT_FIGURE="hd-99999-99999";let WR=RE;class ng{constructor(t,e,s){this._layerId=t,this._partId=e,this._paletteId=s}get layerId(){return this._layerId}set layerId(t){this._layerId=t}get partId(){return this._partId}set partId(t){this._partId=t}get paletteId(){return this._paletteId}set paletteId(t){this._paletteId=t}}class La{constructor(t){this._typeId=this.getTypeId(t),this._paletteId=this.getPaletteId(t),this._color=this.getColor(t),this._headOnly=this.getHeadOnly(t);const e=this.getCustomData(t);this._customLayerIds=this.getCustomLayerIds(e),this._customPartIds=this.getCustomPartIds(e),this._customPaletteIds=this.getCustomPaletteIds(e),this._customParts=[];let s=0;for(;s<this._customLayerIds.length;)this._customParts.push(new ng(this._customLayerIds[s],this._customPartIds[s],this._customPaletteIds[s])),s++}get typeId(){return this._typeId}get paletteId(){return this._paletteId}get color(){return this._color}get customLayerIds(){return this._customLayerIds}get customPartIds(){return this._customPartIds}get customPaletteIds(){return this._customPaletteIds}get customParts(){return this._customParts}getCustomPart(t){if(this._customParts){for(const e of this._customParts)if(e.layerId===t)return e}return null}get hasCustomParts(){return this._customLayerIds!=null&&this._customLayerIds.length>0}get headOnly(){return this._headOnly}get figureString(){let t=this.typeId+" "+this.paletteId+" "+this.color.toString(16);t=t+(" "+this.customParts.length);for(const e of this.customParts)t=t+(" "+e.layerId+" "+e.partId+" "+e.paletteId);return t}getCustomData(t){let e=[];if(t){const s=t.split(" "),i=this._headOnly?1:0,n=4+i;if(s.length>n){const o=3+i,l=parseInt(s[o]);e=s.slice(n,n+l*3)}}return e}getCustomLayerIds(t){const e=[];let s=0;for(;s<t.length;)e.push(parseInt(t[s+0])),s=s+3;return e}getCustomPartIds(t){const e=[];let s=0;for(;s<t.length;)e.push(parseInt(t[s+1])),s=s+3;return e}getCustomPaletteIds(t){const e=[];let s=0;for(;s<t.length;)e.push(parseInt(t[s+2])),s=s+3;return e}getTypeId(t){if(t){const e=t.split(" ");if(e.length>=1)return parseInt(e[0])}return 0}getPaletteId(t){if(t){const e=t.split(" ");if(e.length>=2)return parseInt(e[1])}return 0}getColor(t){if(t){const e=t.split(" ");if(e.length>=3)return parseInt(e[2],16)}return 16777215}getHeadOnly(t){if(t){const e=t.split(" ");if(e.length>=4)return e[3]==="head"}return!1}}class sp{constructor(t){this._complete=!0,this._target=t}get running(){return this._running&&!!this._target}get complete(){return this._complete}set target(t){this._target=t}get target(){return this._target}set tag(t){this._tag=t}get tag(){return this._tag}start(){this._running=!0}update(t){}stop(){this._target=null,this._running=!1}tick(t){}}class kq extends sp{constructor(t){super(t)}tick(t){super.tick(t),this.target&&(this.target.remove(),this.target=null)}}class CO extends sp{constructor(t,e){super(t),this._complete=!1,this._duration=e}get duration(){return this._duration}start(){super.start(),this._complete=!1,this._startTimeMs=Pt()}tick(t){super.tick(t);const e=(t-this._startTimeMs)/this._duration;e<1?this.update(e):(this.update(1),this._complete=!0)}}class Vq extends CO{constructor(t,e,s){super(t,e),this._height=s}start(){super.start(),this._offset=0,this.target.style.top=this._offset-this._height+"px"}update(t){super.update(t),this.target.style.top=this._offset-this._height+this.getBounceOffset(t)*this._height+"px"}getBounceOffset(t){return t<.364?7.5625*t*t:t<.727?(t=t-.545,7.5625*t*t+.75):t<.909?(t=t-.9091,7.5625*t*t+.9375):(t=t-.955,7.5625*t*t+.984375)}stop(){this.target.style.top=this._offset+"px",super.stop()}}class Hq extends CO{constructor(t){super(t.target,t.duration),this._interval=t}start(){super.start(),this._interval.start()}update(t){super.update(t),this._interval.update(t)}stop(){super.stop(),this._interval.stop()}}class Wq extends Hq{constructor(t,e){super(t),this._rate=e}}class Yq extends Wq{constructor(t,e){super(t,e)}update(t){this._interval.update(Math.pow(t,1/this._rate))}}class zq extends CO{constructor(t,e,s,i,n,o){super(t,e),this._deltaX=s,this._deltaY=i,this._height=-n,this._numJumps=o}start(){super.start(),this._startX=this.target.offsetLeft,this._startY=this.target.offsetTop}update(t){super.update(t),this.target.style.left=this._startX+this._deltaX*t+"px",this.target.style.top=this._startY+this._height*Math.abs(Math.sin(t*Math.PI*this._numJumps))+this._deltaY*t+"px"}}const Ht=class Ht{static get TIMER_TIME(){return 1e3/aw()}static runMotion(t){return Ht._RUNNING_MOTIONS.indexOf(t)===-1&&Ht._QUEUED_MOTIONS.indexOf(t)===-1&&(Ht._IS_UPDATING?Ht._QUEUED_MOTIONS.push(t):(Ht._RUNNING_MOTIONS.push(t),t.start()),Ht.startTimer()),t}static removeMotion(t){let e=Ht._RUNNING_MOTIONS.indexOf(t);e>-1?Ht._IS_UPDATING?(e=Ht._REMOVED_MOTIONS.indexOf(t),e==-1&&Ht._REMOVED_MOTIONS.push(t)):(Ht._RUNNING_MOTIONS.splice(e,1),t.running&&t.stop(),Ht._RUNNING_MOTIONS.length||Ht.stopTimer()):(e=Ht._QUEUED_MOTIONS.indexOf(t),e>-1&&Ht._QUEUED_MOTIONS.splice(e,1))}static getMotionByTag(t){for(const e of Ht._RUNNING_MOTIONS)if(e.tag==t)return e;for(const e of Ht._QUEUED_MOTIONS)if(e.tag==t)return e;return null}static getMotionByTarget(t){for(const e of Ht._RUNNING_MOTIONS)if(e.target==t)return e;for(const e of Ht._QUEUED_MOTIONS)if(e.target==t)return e;return null}static getMotionByTagAndTarget(t,e){for(const s of Ht._RUNNING_MOTIONS)if(s.tag==t&&s.target==e)return s;for(const s of Ht._QUEUED_MOTIONS)if(s.tag==t&&s.target==e)return s;return null}static get isRunning(){return!!Ht._TIMER}static get isUpdating(){return Ht._IS_UPDATING}static onTick(){Ht._IS_UPDATING=!0;const t=Pt();let e=null;for(;e=Ht._QUEUED_MOTIONS.pop();)Ht._RUNNING_MOTIONS.push(e);for(;e=Ht._REMOVED_MOTIONS.pop();)Ht._RUNNING_MOTIONS.splice(Ht._RUNNING_MOTIONS.indexOf(e),1),e.running&&e.stop();for(e of Ht._RUNNING_MOTIONS)e.running?(e.tick(t),e.complete&&Ht.removeMotion(e)):Ht.removeMotion(e);Ht._RUNNING_MOTIONS.length||Ht.stopTimer(),Ht._IS_UPDATING=!1}static startTimer(){Ht._TIMER||(Ht._TIMER=setInterval(Ht.onTick,Ht.TIMER_TIME))}static stopTimer(){Ht._TIMER&&(clearInterval(Ht._TIMER),Ht._TIMER=null)}getNumRunningMotions(t){let e=0;for(const s of Ht._RUNNING_MOTIONS)s.target===t&&e++;return e}};Ht._QUEUED_MOTIONS=[],Ht._RUNNING_MOTIONS=[],Ht._REMOVED_MOTIONS=[],Ht._TIMER=null,Ht._IS_UPDATING=!1;let Ph=Ht;class iA extends sp{constructor(...t){super(t?t[0].target:null),this._queue=[];for(const e of t)this._queue.push(e);this._motion=t[0],this._complete=!this._motion}get running(){return this._running&&this._motion?this._motion.running:!1}start(){super.start(),this._motion.start()}update(t){super.update(t),this._motion.running&&this._motion.update(t)}stop(){super.stop(),this._motion.stop()}tick(t){if(super.tick(t),this._motion.tick(t),this._motion.complete){this._motion.stop();const e=this._queue.indexOf(this._motion);e<this._queue.length-1?(this._motion=this._queue[e+1],this._target=this._motion.target,this._motion.start()):this._complete=!0}}}class Kq extends sp{constructor(t){super(null),this._waitTimeMs=t}get running(){return this._running}start(){super.start(),this._complete=!1,this._startTimeMs=Pt()}tick(t){super.tick(t),this._complete=t-this._startTimeMs>=this._waitTimeMs,this._complete&&this.stop()}}function Jt(){return Et.instance}function Os(a){Jt().addLinkEventTracker(a)}function Gs(){return Jt().avatar}function rA(a){return Gs().structureData.getPalette(a)}function nA(a){return Gs().structureData.getSetType(a)}function Uh(){return Jt().cameraManager}function Xq(){return Jt().core}function qq(){return Xq().configuration}function ut(a){a=a.startsWith("event:")?a.substring(6):a,Jt().createLinkEvent(a)}function n_(){var a;return(a=Jt())==null?void 0:a.communication}function it(a,t=null){return Dt.getValue(a,t)}function YR(){var a;return(a=n_())==null?void 0:a.connection}function a0(){return Jt().localization}const wc=a=>{!a||!a.length||(a.startsWith("http")?Hn.openWebPage(a):ut(a))};function Cs(a){Jt().removeLinkEventTracker(a)}function tt(){return Jt().roomEngine}let xp=!1,U_=0,j_=0;const w_=(a,t=1)=>{const e=a.clientX,s=a.clientY;let i=a.type;switch(i===at.MOUSE_CLICK&&(U_&&(j_=1,U_>=Date.now()-300&&j_++),U_=Date.now(),j_===2&&(xp||(i=at.DOUBLE_CLICK),j_=0,U_=null)),i){case at.MOUSE_CLICK:break;case at.DOUBLE_CLICK:break;case at.MOUSE_MOVE:xp=!0;break;case at.MOUSE_DOWN:xp=!1;break;case at.MOUSE_UP:break;case at.RIGHT_CLICK:break;default:return}tt().dispatchMouseEvent(t,e,s,i,a.altKey,a.ctrlKey||a.metaKey,a.shiftKey,!1)};let Mp=!1,F_=0,G_=0;const B_=(a,t=1,e=!1,s=!1,i=!1,n=!1)=>{let o=0,l=0;a.touches[0]?(o=a.touches[0].clientX,l=a.touches[0].clientY):a.changedTouches[0]&&(o=a.changedTouches[0].clientX,l=a.changedTouches[0].clientY);let c=a.type;switch(e&&(c=Zi.TOUCH_LONG),(c===at.MOUSE_CLICK||c===Zi.TOUCH_END)&&(c=at.MOUSE_CLICK,F_&&(G_=1,F_>=Date.now()-300&&G_++),F_=Date.now(),G_===2&&(Mp||(c=at.DOUBLE_CLICK),G_=0,F_=null)),c){case at.MOUSE_CLICK:break;case at.DOUBLE_CLICK:break;case Zi.TOUCH_START:c=at.MOUSE_DOWN,Mp=!1;break;case Zi.TOUCH_MOVE:c=at.MOUSE_MOVE,Mp=!0;break;case Zi.TOUCH_END:c=at.MOUSE_UP;break;case Zi.TOUCH_LONG:c=at.MOUSE_DOWN_LONG;break;default:return}c===Zi.TOUCH_START&&tt().dispatchMouseEvent(t,o,l,c,s,i,n,!1),tt().dispatchMouseEvent(t,o,l,c,s,i,n,!1)};function Oi(a){if(!a||!a.model)return!1;const t=q().userId,e=a.model.getValue(C.FURNITURE_OWNER_ID);return t===e}function a_(a,t,e){return a?a.isRoomOwner||a.controllerLevel>=Oe.GUEST||q().isModerator||Oi(tt().getRoomObject(a.roomId,t,e)):!1}function Fc(){return Jt().roomSessionManager}function gc(a,t=null){Fc().createSession(a,t)}function Qq(){const a=Gc();return a?a.model.getValue(C.FIGURE_CAN_STAND_UP):mt.POSTURE_STAND}function yp(){const a=Gc();if(!a)return!1;const e=a.model.getValue(C.FIGURE_EFFECT);return!(e===29||e===30||e===185)}function q(){return Jt().sessionDataManager}function Wr(){return it("hc.disabled",!1)?Fi.VIP:q().clubLevel}const io=class io{};io.OKAY=0,io.MISSING_OFFER=1,io.FURNI_LIMIT_REACHED=2,io.NOT_IN_ROOM=3,io.NOT_ROOM_OWNER=4,io.GUILD_ROOM=5,io.VISITORS_IN_ROOM=6;let Wa=io;class Jq{constructor(t,e,s){this._depth=0,this._localization="",this._pageId=-1,this._pageName="",this._iconId=0,this._depth=e,this._parent=s,this._localization=t.localization,this._pageId=t.pageId,this._pageName=t.pageName,this._iconId=t.icon,this._children=[],this._offerIds=t.offerIds,this._isVisible=t.visible,this._isActive=!1,this._isOpen=!1}activate(){this._isActive=!0}deactivate(){this._isActive=!1}open(){this._isOpen=!0}close(){this._isOpen=!1}addChild(t){t&&this._children.push(t)}get depth(){return this._depth}get isBranch(){return this._children.length>0}get isLeaf(){return this._children.length===0}get localization(){return this._localization}get pageId(){return this._pageId}get pageName(){return this._pageName}get iconId(){return this._iconId}get children(){return this._children}get offerIds(){return this._offerIds}get parent(){return this._parent}get isVisible(){return this._isVisible}get isActive(){return this._isActive}get isOpen(){return this._isOpen}}const SE=class SE{constructor(t,e,s,i,n,o=-1){this._pageId=t,this._layoutCode=e,this._localization=s,this._offers=i,this._acceptSeasonCurrencyAsCredits=n;for(const l of i)l.page=this;o===-1?this._mode=SE.MODE_NORMAL:this._mode=o}get pageId(){return this._pageId}get layoutCode(){return this._layoutCode}get localization(){return this._localization}get offers(){return this._offers}get acceptSeasonCurrencyAsCredits(){return this._acceptSeasonCurrencyAsCredits}get mode(){return this._mode}};SE.MODE_NORMAL=0;let Sf=SE;const ds=class ds{};ds.DUCKET_INFO="ducket_info",ds.CREDITS="credits",ds.AVATAR_EFFECTS="avatar_effects",ds.HC_MEMBERSHIP="hc_membership",ds.CLUB_GIFTS="club_gifts",ds.LIMITED_SOLD="limited_sold",ds.PET_ACCESSORIES="pet_accessories",ds.TRAX_SONGS="trax_songs",ds.NEW_ADDITIONS="new_additions",ds.QUEST_SHELL="quest_shell",ds.QUEST_SNOWFLAKES="quest_snowflakes",ds.VAL_QUESTS="val_quests",ds.GUILD_CUSTOM_FURNI="guild_custom_furni",ds.GIFT_SHOP="gift_shop",ds.HORSE_STYLES="horse_styles",ds.HORSE_SHOE="horse_shoe",ds.SET_EASTER="set_easter",ds.ECOTRON_TRANSFORM="ecotron_transform",ds.LOYALTY_INFO="loyalty_info",ds.ROOM_BUNDLES="room_bundles",ds.ROOM_BUNDLES_MOBILE="room_bundles_mobile",ds.HABBO_CLUB_DESKTOP="habbo_club_desktop",ds.MOBILE_SUBSCRIPTIONS="mobile_subscriptions";let Of=ds;class $q{constructor(t,e){this.breed=t,this.palettes=e}}const ro=class ro{};ro.NONE=0,ro.CONFIRM=1,ro.PURCHASE=2,ro.NO_CREDITS=3,ro.NO_POINTS=4,ro.SOLD_OUT=5,ro.FAILED=6;let $e=ro;const OE=class OE{};OE.NORMAL="NORMAL",OE.BUILDER="BUILDERS_CLUB";let ln=OE;const Zq=a=>"",t7=a=>"",aA=(a,t)=>{const e=a.get(t),s=[];if(e&&e.length)for(const i of e)i.isVisible&&s.push(i);return s},o0=(a,t,e,s)=>{if(e.isVisible&&e.pageId>0){let i=!1;const n=[e.pageName,e.localization].join(" ").toLowerCase().replace(/ /gi,"");if(n.indexOf(a)>-1&&(s.push(e),i=!0),!i){for(const o of t)if(n.indexOf(o)>=0){s.push(e);break}}}for(const i of e.children)o0(a,t,i,s)};function e7(a){if(!a.length)return 0;let t=a.length-1;for(;t>=0&&!isNaN(parseInt(a.charAt(t)));)t--;return t>0?parseInt(a.substring(t+1)):-1}function s7(a,t){switch(a){case 0:return[[16743226],[16750435],[16764339],[16094464],[16498012],[16704690],[15586304],[16115545],[16513201],[8694111],[11585939],[14413767],[6664599],[9553845],[12971486],[8358322],[10002885],[13292268],[10780600],[12623573],[14403561],[12418717],[14327229],[15517403],[14515069],[15764368],[16366271],[11250603],[13948116],[16777215],[14256481],[14656129],[15848130],[14005087],[14337152],[15918540],[15118118],[15531929],[9764857],[11258085]];case 1:return[[16743226],[16750435],[16764339],[16094464],[16498012],[16704690],[15586304],[16115545],[16513201],[8694111],[11585939],[14413767],[6664599],[9553845],[12971486],[8358322],[10002885],[13292268],[10780600],[12623573],[14403561],[12418717],[14327229],[15517403],[14515069],[15764368],[16366271],[11250603],[13948116],[16777215],[14256481],[14656129],[15848130],[14005087],[14337152],[15918540],[15118118],[15531929],[9764857],[11258085]];case 2:return[[16579283],[15378351],[8830016],[15257125],[9340985],[8949607],[6198292],[8703620],[9889626],[8972045],[12161285],[13162269],[8620113],[12616503],[8628101],[13827840],[9764857]];case 3:return[[16777215],[15658734],[14540253]];case 4:return[[16777215],[16053490],[15464440],[16248792],[15396319],[15007487]];case 5:return[[16777215],[15658734],[14540253]];case 6:return[[16777215],[15658734],[14540253],[16767177],[16770205],[16751331]];case 7:return[[13421772],[11447982],[16751331],[10149119],[16763290],[16743786]];default:{const e=[];for(const s of t){const i=tt().getPetColorResult(a,s.paletteId);i&&(i.primaryColor===i.secondaryColor?e.push([i.primaryColor]):e.push([i.primaryColor,i.secondaryColor]))}return e}}}const da=class da{};da.WALL="i",da.FLOOR="s",da.EFFECT="e",da.HABBO_CLUB="h",da.BADGE="b",da.GAME_TOKEN="GAME_TOKEN",da.PET="p",da.ROBOT="r";let Yt=da;const CE=class CE{constructor(t,e,s,i,n,o,l=!1,c=0,u=0){this._productType=t.toLowerCase(),this._productClassId=e,this._extraParam=s,this._productCount=i,this._productData=n,this._furnitureData=o,this._isUniqueLimitedItem=l,this._uniqueLimitedItemSeriesSize=c,this._uniqueLimitedItemsLeft=u}static stripAddonProducts(t){return t.length===1?t:t.filter(e=>e.productType!==Yt.BADGE&&e.productType!==Yt.EFFECT&&e.productClassId!==CE.EFFECT_CLASSID_NINJA_DISAPPEAR)}getIconUrl(t=null,e=null){switch(this._productType){case Yt.FLOOR:return tt().getFurnitureFloorIconUrl(this.productClassId);case Yt.WALL:{if(t&&this._furnitureData){let s="";switch(this._furnitureData.className){case"floor":s=["th",this._furnitureData.className,t.product.extraParam].join("_");break;case"wallpaper":s=["th","wall",t.product.extraParam].join("_");break;case"landscape":s=["th",this._furnitureData.className,(t.product.extraParam||"").replace(".","_"),"001"].join("_");break}if(s!=="")return`${it("catalog.asset.url")}/${s}.png`}return tt().getFurnitureWallIconUrl(this.productClassId,this._extraParam)}case Yt.EFFECT:return Zq(this.productClassId);case Yt.HABBO_CLUB:return t7(this.productClassId);case Yt.BADGE:return q().getBadgeUrl(this._extraParam);case Yt.ROBOT:return null}return null}get productType(){return this._productType}get productClassId(){return this._productClassId}get extraParam(){return this._extraParam}set extraParam(t){this._extraParam=t}get productCount(){return this._productCount}get productData(){return this._productData}get furnitureData(){return this._furnitureData}get isUniqueLimitedItem(){return this._isUniqueLimitedItem}get uniqueLimitedItemSeriesSize(){return this._uniqueLimitedItemSeriesSize}get uniqueLimitedItemsLeft(){return this._uniqueLimitedItemsLeft}set uniqueLimitedItemsLeft(t){this._uniqueLimitedItemsLeft=t}};CE.EFFECT_CLASSID_NINJA_DISAPPEAR=108;let ll=CE;const Ks=class Ks{constructor(t,e,s,i,n,o,l,c,u,h){this._clubLevel=0,this._bundlePurchaseAllowed=!1,this._offerId=t,this._localizationId=e,this._isRentOffer=s,this._priceInCredits=i,this._priceInActivityPoints=n,this._activityPointType=o,this._giftable=l,this._clubLevel=c,this._products=u,this._bundlePurchaseAllowed=h,this.setPricingModelForProducts(),this.setPricingType();for(const d of u)if(d.productType===Yt.BADGE){this._badgeCode=d.extraParam;break}}activate(){}get clubLevel(){return this._clubLevel}get page(){return this._page}set page(t){this._page=t}get offerId(){return this._offerId}get localizationId(){return this._localizationId}get priceInCredits(){return this._priceInCredits}get priceInActivityPoints(){return this._priceInActivityPoints}get activityPointType(){return this._activityPointType}get giftable(){return this._giftable}get product(){if(!this._products||!this._products.length)return null;if(this._products.length===1)return this._products[0];const t=ll.stripAddonProducts(this._products);return t.length?t[0]:null}get pricingModel(){return this._pricingModel}get priceType(){return this._priceType}get bundlePurchaseAllowed(){return this._bundlePurchaseAllowed}get isRentOffer(){return this._isRentOffer}get badgeCode(){return this._badgeCode}get localizationName(){const t=th(this._localizationId);return t?t.name:f(this._localizationId)}get localizationDescription(){const t=th(this._localizationId);return t?t.description:f(this._localizationId)}get isLazy(){return!1}get products(){return this._products}setPricingModelForProducts(){const t=ll.stripAddonProducts(this._products);t.length===1?t[0].productCount===1?this._pricingModel=Ks.PRICING_MODEL_SINGLE:this._pricingModel=Ks.PRICING_MODEL_MULTI:t.length>1?this._pricingModel=Ks.PRICING_MODEL_BUNDLE:this._pricingModel=Ks.PRICING_MODEL_UNKNOWN}setPricingType(){this._priceInCredits>0&&this._priceInActivityPoints>0?this._priceType=Ks.PRICE_TYPE_CREDITS_ACTIVITYPOINTS:this._priceInCredits>0?this._priceType=Ks.PRICE_TYPE_CREDITS:this._priceInActivityPoints>0?this._priceType=Ks.PRICE_TYPE_ACTIVITYPOINTS:this._priceType=Ks.PRICE_TYPE_NONE}clone(){const t=[],e=th(this.localizationId);for(const i of this._products){const n=zR(i.productClassId,i.productType);t.push(new ll(i.productType,i.productClassId,i.extraParam,i.productCount,e,n))}const s=new Ks(this.offerId,this.localizationId,this.isRentOffer,this.priceInCredits,this.priceInActivityPoints,this.activityPointType,this.giftable,this.clubLevel,t,this.bundlePurchaseAllowed);return s.page=this.page,s}};Ks.PRICING_MODEL_UNKNOWN="pricing_model_unknown",Ks.PRICING_MODEL_SINGLE="pricing_model_single",Ks.PRICING_MODEL_MULTI="pricing_model_multi",Ks.PRICING_MODEL_BUNDLE="pricing_model_bundle",Ks.PRICING_MODEL_FURNITURE="pricing_model_furniture",Ks.PRICE_TYPE_NONE="price_type_none",Ks.PRICE_TYPE_CREDITS="price_type_credits",Ks.PRICE_TYPE_ACTIVITYPOINTS="price_type_activitypoints",Ks.PRICE_TYPE_CREDITS_ACTIVITYPOINTS="price_type_credits_and_activitypoints";let _i=Ks;class i7{constructor(t){this._furniData=t,this._product=new ll(this._furniData.type,this._furniData.id,this._furniData.customParams,1,th(this._furniData.className),this._furniData)}activate(){k(new Pb(this._furniData.rentOfferId>-1?this._furniData.rentOfferId:this._furniData.purchaseOfferId))}get offerId(){return this.isRentOffer?this._furniData.rentOfferId:this._furniData.purchaseOfferId}get priceInActivityPoints(){return 0}get activityPointType(){return 0}get priceInCredits(){return 0}get page(){return this._page}set page(t){this._page=t}get priceType(){return""}get product(){return this._product}get products(){return[this._product]}get localizationId(){return"roomItem.name."+this._furniData.id}get bundlePurchaseAllowed(){return!1}get isRentOffer(){return this._furniData.rentOfferId>-1}get giftable(){return!1}get pricingModel(){return _i.PRICING_MODEL_FURNITURE}get clubLevel(){return 0}get badgeCode(){return""}get localizationName(){return this._furniData.name}get localizationDescription(){return this._furniData.description}get isLazy(){return!0}}const r7=(a,t,e=null)=>{let s=null;switch(a.toLocaleLowerCase()){case Yt.FLOOR:s=tt().getFurnitureFloorIconUrl(t);break;case Yt.WALL:s=tt().getFurnitureWallIconUrl(t,e);break}return s};class n7{constructor(t){this._isEnabled=!1,this._price=null,this._stuffTypes=null,this._boxTypes=null,this._ribbonTypes=null,this._defaultStuffTypes=null,this._isEnabled=t.isEnabled,this._price=t.price,this._boxTypes=t.boxTypes,this._ribbonTypes=t.ribbonTypes,this._stuffTypes=t.giftWrappers,this._defaultStuffTypes=t.giftFurnis}get isEnabled(){return this._isEnabled}get price(){return this._price}get stuffTypes(){return this._stuffTypes}get boxTypes(){return this._boxTypes}get ribbonTypes(){return this._ribbonTypes}get defaultStuffTypes(){return this._defaultStuffTypes}}const AE=class AE{constructor(t,e,s,i,n,o,l,c,u=-1){this._timeLeftMinutes=-1,this._offerId=t,this._furniId=e,this._furniType=s,this._extraData=i,this._stuffData=n,this._price=o,this._status=l,this._averagePrice=c,this._offerCount=u}get offerId(){return this._offerId}set offerId(t){this._offerId=t}get furniId(){return this._furniId}get furniType(){return this._furniType}get extraData(){return this._extraData}get stuffData(){return this._stuffData}get price(){return this._price}set price(t){this._price=t}get averagePrice(){return this._averagePrice}get image(){return this._image}set image(t){this._image=t}get imageCallback(){return this._imageCallback}set imageCallback(t){this._imageCallback=t}get status(){return this._status}get timeLeftMinutes(){return this._timeLeftMinutes}set timeLeftMinutes(t){this._timeLeftMinutes=t}get offerCount(){return this._offerCount}set offerCount(t){this._offerCount=t}get isUniqueLimitedItem(){return this.stuffData&&this.stuffData.uniqueSeries>0}};AE.TYPE_FLOOR=1,AE.TYPE_WALL=2;let o_=AE;const Fu=class Fu{};Fu.ONGOING=1,Fu.ONGOING_OWN=1,Fu.SOLD=2,Fu.EXPIRED=3;let l_=Fu;const Sd=class Sd{};Sd.BY_ACTIVITY=1,Sd.BY_VALUE=2,Sd.ADVANCED=3;let Si=Sd;class l0{constructor(t,e){this._images=t,this._texts=e}getText(t){let e=this._texts[t]||"";return e&&e.length&&(e=e.replace(/\r\n|\r|\n/g,"<br />")),e}getImage(t){const e=this._images[t]||"";if(!e||!e.length)return null;let s=it("catalog.asset.image.url");return s=s.replace("%name%",e),s}}class a7{constructor(t,e,s,i,n,o,l,c){this.roomId=t,this.objectId=e,this.category=s,this.wallLocation=i,this.x=n,this.y=o,this.direction=l,this.offer=c}get offerId(){return this.offer.offerId}get productClassId(){return this.offer.product.productClassId}get productData(){return this.offer.product.productData}get furniData(){return this.offer.product.furnitureData}get extraParam(){return this.offer.product.extraParam}}const Nn=class Nn{constructor(){this._requestType=Nn.REQUEST_TYPE_NONE}resetRequest(){this._requestType=Nn.REQUEST_TYPE_NONE,this._requestById=-1,this._requestedByOfferId=-1,this._requestByName=null}get requestType(){return this._requestType}get requestById(){return this._requestById}set requestById(t){this._requestType=Nn.REQUEST_TYPE_ID,this._requestById=t}get requestedByOfferId(){return this._requestedByOfferId}set requestedByOfferId(t){this._requestType=Nn.REQUEST_TYPE_OFFER,this._requestedByOfferId=t}get requestByName(){return this._requestByName}set requestByName(t){this._requestType=Nn.REQUEST_TYPE_NAME,this._requestByName=t}};Nn.REQUEST_TYPE_NONE=0,Nn.REQUEST_TYPE_ID=1,Nn.REQUEST_TYPE_OFFER=2,Nn.REQUEST_TYPE_NAME=3;let Ll=Nn;class o7{constructor(t,e,s){this.searchValue=t,this.offers=e,this.filteredNodes=s}}function zR(a,t){let e=null;switch(t.toLowerCase()){case Yt.FLOOR:e=q().getFloorItemData(a);break;case Yt.WALL:e=q().getWallItemData(a);break}return e}function ip(a,t,e){const s=tt().getRoomObject(a,t,e);if(!s)return;const i=s.model.getValue(C.FURNITURE_TYPE_ID);switch(e){case W.FLOOR:return q().getFloorItemData(i);case W.WALL:return q().getWallItemData(i)}return null}function l7(){const a=Gc();return a?a.model.getValue(C.FIGURE_POSTURE):mt.POSTURE_STAND}function th(a){return a?q().getProductData(a):null}function ie(){return Fc().getSession(-1)}function KR(){k(new Yb)}function fc(){return q().clubLevel>=Fi.CLUB}function k_(){return q().clubLevel>=Fi.VIP}function c7(a){const t=tt().getRoomObject(ie().roomId,a,W.FLOOR);if(!t||!t.model)return!1;const e=q().userId,s=t.model.getValue(C.FURNITURE_OWNER_ID);return e===s}function u7(){const a=Gc();return a?a.model.getValue(C.FIGURE_EFFECT)===77:!1}function h7(a){Fc().startSession(a)}const AO=()=>{ie()&&(KR(),Fc().removeSession(-1))};function Gc(){const a=q().userId,t=tt().activeRoomId,e=W.UNIT,s=tt().getTotalObjectsForManager(t,e);let i=0;for(;i<s;){const n=tt().getRoomObjectByIndex(t,i,e);if(n){const o=ie().userDataManager.getUserDataByIndex(n.id);if(o&&o.webID===a)return n}i++}return null}const NO=(a,t,e,s=1)=>{const i=tt().getRoomObjectBoundingRectangle(a,t,e,s);return i?(i.x=Math.round(i.x),i.y=Math.round(i.y),i):null},c0=(a,t,e,s=1)=>{const i=tt().getRoomObjectScreenLocation(a,t,e,s);return i?(i.x=Math.round(i.x),i.y=Math.round(i.y),i):null},d7=(a,t,e=1)=>{const s=tt(),i=s.activeRoomId;s.initializeRoomInstanceRenderingCanvas(i,e,a,t)};function _7(a){let t=!1;const e=tt().getRoomObject(a.roomId,a.objectId,a.category);return e&&e.model.getValue(C.FURNITURE_SELECTION_DISABLED)===1&&(t=!0,q().isModerator&&(t=!1)),t}function ru(a,t,e){tt().processRoomObjectOperation(a,t,e)}function oA(a){tt().setActiveRoomId(a)}const k=a=>YR().send(a);class Sr{static getAchievementBadgeCode(t){if(!t)return null;let e=t.badgeId;return t.finalLevel||(e=a0().getPreviousLevelBadgeId(e)),e}static getAchievementCategoryImageUrl(t,e=null,s=!1){const i=it("achievements.images.url");let n=s?"achicon_":"achcategory_";return n+=t.code,e!==null&&(n+=`_${e>0?"active":"inactive"}`),i.replace("%image%",n)}static getAchievementCategoryMaxProgress(t){if(!t)return 0;let e=0;for(const s of t.achievements)e+=s.levelCount;return e}static getAchievementCategoryProgress(t){if(!t)return 0;let e=0;for(const s of t.achievements)e+=s.finalLevel?s.level:s.level-1;return e}static getAchievementCategoryTotalUnseen(t){if(!t)return 0;let e=0;for(const s of t.achievements)s.unseen>0&&e++;return e}static getAchievementHasStarted(t){return t?!!(t.finalLevel||t.level-1>0):!1}static getAchievementIsIgnored(t){if(!t)return!1;const e=it("achievements.unseen.ignored"),s=t.badgeId.replace(/[0-9]/g,"");return e.indexOf(s)>=0}static getAchievementLevel(t){return t?t.finalLevel?t.level:t.level-1:0}}class lA{constructor(t){this._code=t,this._achievements=[]}getProgress(){return Sr.getAchievementCategoryProgress(this)}getMaxProgress(){return Sr.getAchievementCategoryMaxProgress(this)}get code(){return this._code}get achievements(){return this._achievements}set achievements(t){this._achievements=t}}const Gu=class Gu{};Gu.ACTION_SAVE="AEA_ACTION_SAVE",Gu.ACTION_CLEAR="AEA_ACTION_CLEAR",Gu.ACTION_RESET="AEA_ACTION_RESET",Gu.ACTION_RANDOMIZE="AEA_ACTION_RANDOMIZE";let Qn=Gu;class g7{constructor(t,e=!1){this._partColor=t,this._isDisabled=e,this._isHC=this._partColor.clubLevel>0,this._isSelected=!1}dispose(){this._partColor=null}get partColor(){return this._partColor}get color(){return ii.int2rgb(this._partColor.rgb)}get isDisabled(){return this._isDisabled}get isHC(){return this._isHC}get isSelected(){return this._isSelected}set isSelected(t){this._isSelected=t,this.notify&&this.notify()}get notify(){return this._notifier}set notify(t){this._notifier=t}}class xO{constructor(t,e,s){this._selectedPartIndex=-1,this._name=t,this._parts=e,this._palettes=s,this._selectedPartIndex=-1}static defaultColorId(t,e){if(!t||!t.length)return-1;let s=0;for(;s<t.length;){const i=t[s];if(i.partColor&&i.partColor.clubLevel<=e)return i.partColor.id;s++}return-1}init(){for(const t of this._parts)t&&t.init()}dispose(){if(this._parts){for(const t of this._parts)t.dispose();this._parts=null}if(this._palettes){for(const t of this._palettes)for(const e of t)e.dispose();this._palettes=null}this._selectedPartIndex=-1,this._paletteIndexes=null}selectPartId(t){if(!this._parts)return;let e=0;for(;e<this._parts.length;){if(this._parts[e].id===t){this.selectPartIndex(e);return}e++}}selectColorIds(t){if(!t||!this._palettes)return;this._paletteIndexes=new Array(t.length);let e=0;for(;e<this._palettes.length;){const s=this.getPalette(e);if(s){let i=0;if(t.length>e)i=t[e];else{const o=s[0];o&&o.partColor&&(i=o.partColor.id)}let n=0;for(;n<s.length;){const o=s[n];o.partColor.id===i?(this._paletteIndexes[e]=n,o.isSelected=!0):o.isSelected=!1,n++}}e++}this.updatePartColors()}selectPartIndex(t){if(!this._parts)return null;if(this._selectedPartIndex>=0&&this._parts.length>this._selectedPartIndex){const e=this._parts[this._selectedPartIndex];e&&(e.isSelected=!1)}if(this._parts.length>t){const e=this._parts[t];if(e)return e.isSelected=!0,this._selectedPartIndex=t,e}return null}selectColorIndex(t,e){const s=this.getPalette(e);if(!s||s.length<=t)return null;this.deselectColorIndex(this._paletteIndexes[e],e),this._paletteIndexes[e]=t;const i=s[t];return i?(i.isSelected=!0,this.updatePartColors(),i):null}getCurrentColorIndex(t){return this._paletteIndexes[t]}deselectColorIndex(t,e){const s=this.getPalette(e);if(!s||s.length<=t)return;const i=s[t];i&&(i.isSelected=!1)}getSelectedColorIds(){if(!this._paletteIndexes||!this._paletteIndexes.length||!this._palettes||!this._palettes.length)return null;const t=this._palettes[0];if(!t||!t.length)return null;const e=t[0];if(!e||!e.partColor)return null;const s=e.partColor.id,i=[];let n=0;for(;n<this._paletteIndexes.length;){const l=this._palettes[n];if(!(!l||l.length<=n))if(l.length>this._paletteIndexes[n]){const c=l[this._paletteIndexes[n]];c&&c.partColor?i.push(c.partColor.id):i.push(s)}else i.push(s);n++}const o=this.getCurrentPart();return o?i.slice(0,Math.max(o.maxColorIndex,1)):null}getSelectedColors(){const t=[];let e=0;for(;e<this._paletteIndexes.length;){const s=this.getSelectedColor(e);s?t.push(s.partColor):t.push(null),e++}return t}getSelectedColor(t){const e=this.getPalette(t);return!e||e.length<=this._paletteIndexes[t]?null:e[this._paletteIndexes[t]]}getSelectedColorId(t){const e=this.getSelectedColor(t);return e&&e.partColor?e.partColor.id:0}getPalette(t){return!this._paletteIndexes||!this._palettes||this._palettes.length<=t?null:this._palettes[t]}getCurrentPart(){return this._parts[this._selectedPartIndex]}updatePartColors(){const t=this.getSelectedColors();for(const e of this._parts)e&&(e.partColors=t)}hasClubSelectionsOverLevel(t){let e=!1;const s=this.getSelectedColors();if(s){let n=0;for(;n<s.length;){const o=s[n];o&&o.clubLevel>t&&(e=!0),n++}}const i=this.getCurrentPart();if(i&&i.partSet){const n=i.partSet;n&&n.clubLevel>t&&(e=!0)}return e}hasInvalidSelectedItems(t){const e=this.getCurrentPart();if(!e)return!1;const s=e.partSet;if(!(!s||!s.isSellable))return t.indexOf(s.id)>-1}stripClubItemsOverLevel(t){const e=this.getCurrentPart();if(e&&e.partSet&&e.partSet.clubLevel>t){const i=this.selectPartIndex(0);return i&&!i.partSet&&this.selectPartIndex(1),!0}return!1}stripClubColorsOverLevel(t){const e=[],s=this.getSelectedColors(),i=this.getPalette(0);let n=!1;const o=xO.defaultColorId(i,t);if(o===-1)return!1;let l=0;for(;l<s.length;){const c=s[l];c?c.clubLevel>t?(e.push(o),n=!0):e.push(c.id):(e.push(o),n=!0),l++}return n&&this.selectColorIds(e),n}get name(){return this._name}get parts(){return this._parts}get selectedPartIndex(){return this._selectedPartIndex}}const Bu=class Bu{static getGender(t){switch(t){case ce.MALE:case"m":case"M":t=ce.MALE;break;case ce.FEMALE:case"f":case"F":t=ce.FEMALE;break;default:t=ce.MALE}return t}static hasFigureSetId(t){return this.FIGURE_SET_IDS.indexOf(t)>=0}static createCategory(t,e){if(!t||!e||!this.CURRENT_FIGURE)return null;const s=[],i=[];let n=0;for(;n<this.MAX_PALETTES;)i.push([]),n++;const o=nA(e);if(!o)return null;const l=rA(o.paletteID);if(!l)return null;let c=this.CURRENT_FIGURE.getColorIds(e);c||(c=[]);const u=new Array(c.length),h=this.clubItemsDimmed,d=Wr();for(const T of l.colors.getValues())if(T.isSelectable&&(h||d>=T.clubLevel)){let R=0;for(;R<this.MAX_PALETTES;){const S=d<T.clubLevel,b=new g7(T,S);i[R].push(b),R++}if(e!==ce.FACE){let S=0;for(;S<c.length;)T.id===c[S]&&(u[S]=T),S++}}let g=[];if(h?g=Gs().getMandatoryAvatarPartSetIds(this.CURRENT_FIGURE.gender,2):g=Gs().getMandatoryAvatarPartSetIds(this.CURRENT_FIGURE.gender,d),g.indexOf(e)===-1){const T=new Cf(null,null,!1);T.isClear=!0,s.push(T)}const m=e!==ce.FACE,I=o.partSets;for(n=I.length-1;n>=0;){const T=I.getWithIndex(n);let R=!1;if((T.gender===ce.UNISEX||T.gender===this.CURRENT_FIGURE.gender)&&(R=!0),T.isSelectable&&R&&(h||d>=T.clubLevel)){const S=d<T.clubLevel;let b=!0;T.isSellable&&(b=this.hasFigureSetId(T.id)),b&&s.push(new Cf(T,u,m,S))}n--}for(s.sort(this.clubItemsFirst?this.clubSorter:this.noobSorter),n=0;n<this.MAX_PALETTES;)i[n].sort(this.colorSorter),n++;return new xO(e,s,i)}static clubSorter(t,e){const s=t.partSet?t.partSet.clubLevel:9999999999,i=e.partSet?e.partSet.clubLevel:9999999999,n=t.partSet?t.partSet.isSellable:!1,o=e.partSet?e.partSet.isSellable:!1;return n&&!o?1:o&&!n||s>i?-1:s<i?1:t.partSet.id>e.partSet.id?-1:t.partSet.id<e.partSet.id?1:0}static colorSorter(t,e){const s=t.partColor?t.partColor.clubLevel:-1,i=e.partColor?e.partColor.clubLevel:-1;return s<i?-1:s>i?1:t.partColor.index<e.partColor.index?-1:t.partColor.index>e.partColor.index?1:0}static noobSorter(t,e){const s=t.partSet?t.partSet.clubLevel:-1,i=e.partSet?e.partSet.clubLevel:-1,n=t.partSet?t.partSet.isSellable:!1,o=e.partSet?e.partSet.isSellable:!1;return n&&!o?1:o&&!n||s<i?-1:s>i?1:t.partSet.id<e.partSet.id?-1:t.partSet.id>e.partSet.id?1:0}static avatarSetFirstSelectableColor(t){const e=nA(t);if(!e)return-1;const s=rA(e.paletteID);if(!s)return-1;for(const i of s.colors.getValues())if(!(!i.isSelectable||Wr()<i.clubLevel))return i.id;return-1}static get clubItemsFirst(){return it("avatareditor.show.clubitems.first",!0)}static get clubItemsDimmed(){return it("avatareditor.show.clubitems.dimmed",!0)}};Bu.MAX_PALETTES=2,Bu.CURRENT_FIGURE=null,Bu.FIGURE_SET_IDS=[],Bu.BOUND_FURNITURE_NAMES=[];let js=Bu;const bt=class bt{constructor(){this._gender="M",this._direction=bt.DEFAULT_DIRECTION,this._avatarEffectType=-1,this._notifier=null}loadAvatarData(t,e){this._data=new Map,this._colors=new Map,this._gender=e,this.parseFigureString(t),this.updateView()}parseFigureString(t){if(!t)return;const e=t.split(".");if(!(!e||!e.length))for(const s of e){const i=s.split("-");if(!i.length)continue;const n=i[0],o=parseInt(i[1]),l=[];let c=2;for(;c<i.length;)l.push(parseInt(i[c])),c++;l.length||l.push(0),this.savePartSetId(n,o,!1),this.savePartSetColourId(n,l,!1)}}getPartSetId(t){const e=this._data.get(t);return e!==void 0?e:-1}getColorIds(t){const e=this._colors.get(t);return e!==void 0?e:[js.avatarSetFirstSelectableColor(t)]}getFigureString(){let t="";const e=[];for(const[i,n]of this._data.entries()){const o=this._colors.get(i);let l=i+"-"+n;if(o&&o.length){let c=0;for(;c<o.length;)l=l+("-"+o[c]),c++}e.push(l)}let s=0;for(;s<e.length;)t=t+e[s],s<e.length-1&&(t=t+"."),s++;return t}savePartData(t,e,s,i=!1){this.savePartSetId(t,e,i),this.savePartSetColourId(t,s,i)}savePartSetId(t,e,s=!0){switch(t){case bt.FACE:case bt.HAIR:case bt.HAT:case bt.HEAD_ACCESSORIES:case bt.EYE_ACCESSORIES:case bt.FACE_ACCESSORIES:case bt.SHIRT:case bt.JACKET:case bt.CHEST_ACCESSORIES:case bt.CHEST_PRINTS:case bt.TROUSERS:case bt.SHOES:case bt.TROUSER_ACCESSORIES:e>=0?this._data.set(t,e):this._data.delete(t);break}s&&this.updateView()}savePartSetColourId(t,e,s=!0){switch(t){case bt.FACE:case bt.HAIR:case bt.HAT:case bt.HEAD_ACCESSORIES:case bt.EYE_ACCESSORIES:case bt.FACE_ACCESSORIES:case bt.SHIRT:case bt.JACKET:case bt.CHEST_ACCESSORIES:case bt.CHEST_PRINTS:case bt.TROUSERS:case bt.SHOES:case bt.TROUSER_ACCESSORIES:this._colors.set(t,e);break}s&&this.updateView()}getFigureStringWithFace(t,e=!0){let s="";const i=[bt.FACE],n=[];for(const l of i){const c=this._colors.get(l);if(!c)continue;let u=this._data.get(l);l===bt.FACE&&e&&(u=t);let h=l+"-"+u;if(u>=0){let d=0;for(;d<c.length;)h=h+("-"+c[d]),d++}n.push(h)}let o=0;for(;o<n.length;)s=s+n[o],o<n.length-1&&(s=s+"."),o++;return s}updateView(){this.notify&&this.notify()}get gender(){return this._gender}get direction(){return this._direction}set direction(t){this._direction=t,this.updateView()}set avatarEffectType(t){this._avatarEffectType=t}get avatarEffectType(){return this._avatarEffectType}get notify(){return this._notifier}set notify(t){this._notifier=t}};bt.DEFAULT_DIRECTION=4,bt.MALE="M",bt.FEMALE="F",bt.UNISEX="U",bt.SCALE="h",bt.STD="std",bt.DEFAULT_FRAME="0",bt.FACE="hd",bt.HAIR="hr",bt.HAT="ha",bt.HEAD_ACCESSORIES="he",bt.EYE_ACCESSORIES="ea",bt.FACE_ACCESSORIES="fa",bt.JACKET="cc",bt.SHIRT="ch",bt.CHEST_ACCESSORIES="ca",bt.CHEST_PRINTS="cp",bt.TROUSERS="lg",bt.SHOES="sh",bt.TROUSER_ACCESSORIES="wa",bt.SET_TYPES=[bt.FACE,bt.HAIR,bt.HAT,bt.HEAD_ACCESSORIES,bt.EYE_ACCESSORIES,bt.FACE_ACCESSORIES,bt.JACKET,bt.SHIRT,bt.CHEST_ACCESSORIES,bt.CHEST_PRINTS,bt.TROUSERS,bt.SHOES,bt.TROUSERS];let ce=bt;const _a=class _a{constructor(t,e,s=!0,i=!1){if(this._renderManager=Gs(),this._partSet=t,this._partColors=e,this._useColors=s,this._isDisabled=i,this._thumbContainer=null,this._imageUrl=null,this._maxColorIndex=0,this._isValidFigure=!1,this._isHC=!1,this._isSellable=!1,this._isClear=!1,this._isSelected=!1,this._disposed=!1,this._isInitalized=!1,t){const n=t.parts;for(const o of n)this._maxColorIndex=Math.max(this._maxColorIndex,o.colorLayerIndex)}}init(){this._isInitalized||(this._isInitalized=!0,this.update())}dispose(){this._disposed||(this._renderManager=null,this._partSet=null,this._partColors=null,this._imageUrl=null,this._disposed=!0,this._isInitalized=!1,this._thumbContainer&&(this._thumbContainer.destroy(),this._thumbContainer=null))}update(){this.updateThumbVisualization()}analyzeFigure(){if(!this._renderManager||!this._partSet||!this._partSet.parts||!this._partSet.parts.length)return!1;const t=this._renderManager.createFigureContainer(this.partSet.type+"-"+this.partSet.id);return this._renderManager.isFigureContainerReady(t)?(this._isValidFigure=!0,!0):(this._renderManager.downloadAvatarFigure(t,this),!1)}renderThumb(){if(!this._renderManager||!this._partSet||!this._isValidFigure&&!this.analyzeFigure())return null;const t=this._partSet.parts.concat().sort(this.sortByDrawOrder),e=new hn;for(const s of t){if(!s)continue;let i=null,n=0,o=!1;for(;!o&&n<_a.THUMB_DIRECTIONS.length;){const d=ce.SCALE+"_"+ce.STD+"_"+s.type+"_"+s.id+"_"+_a.THUMB_DIRECTIONS[n]+"_"+ce.DEFAULT_FRAME;i=this._renderManager.getAssetByName(d),i&&i.texture?o=!0:n++}if(!o)continue;const l=i.offsetX,c=i.offsetY;let u=null;if(this._useColors&&s.colorLayerIndex>0){const d=this._partColors[s.colorLayerIndex-1];d&&(u=d)}const h=new Xe(i.texture);h.position.set(l,c),u&&(h.tint=u.rgb),e.addChild(h)}return e}updateThumbVisualization(){if(!this._isInitalized)return;let t=this._thumbContainer;t||(t=this.renderThumb()),t&&(this._partSet?(this._isHC=this._partSet.clubLevel>0,this._isSellable=this._partSet.isSellable):(this._isHC=!1,this._isSellable=!1),this._isDisabled&&this.setAlpha(t,.2),this._imageUrl=Ee.generateImageUrl(t),this.notify&&this.notify())}setAlpha(t,e){return t.filters=[_a.ALPHA_FILTER],t}sortByDrawOrder(t,e){const s=_a.DRAW_ORDER.indexOf(t.type),i=_a.DRAW_ORDER.indexOf(e.type);return s<i?-1:s>i?1:t.index<e.index?-1:t.index>e.index?1:0}resetFigure(t){this.analyzeFigure()&&this.update()}get disposed(){return this._disposed}get id(){return this._partSet?this._partSet.id:-1}get partSet(){return this._partSet}set partColors(t){this._partColors=t,this.update()}get isDisabled(){return this._isDisabled}set thumbContainer(t){this._thumbContainer=t,this.update()}get imageUrl(){return this._imageUrl}get maxColorIndex(){return this._maxColorIndex}get isHC(){return this._isHC}get isSellable(){return this._isSellable}get isClear(){return this._isClear}set isClear(t){this._isClear=t}get isSelected(){return this._isSelected}set isSelected(t){this._isSelected=t,this.notify&&this.notify()}get notify(){return this._notifier}set notify(t){this._notifier=t}};_a.ALPHA_FILTER=new ow(.2),_a.THUMB_DIRECTIONS=[2,6,0,4,3,1],_a.DRAW_ORDER=[Kt.LEFT_HAND_ITEM,Kt.LEFT_HAND,Kt.LEFT_SLEEVE,Kt.LEFT_COAT_SLEEVE,Kt.BODY,Kt.SHOES,Kt.LEGS,Kt.CHEST,Kt.CHEST_ACCESSORY,Kt.COAT_CHEST,Kt.CHEST_PRINT,Kt.WAIST_ACCESSORY,Kt.RIGHT_HAND,Kt.RIGHT_SLEEVE,Kt.RIGHT_COAT_SLEEVE,Kt.HEAD,Kt.FACE,Kt.EYES,Kt.HAIR,Kt.HAIR_BIG,Kt.FACE_ACCESSORY,Kt.EYE_ACCESSORY,Kt.HEAD_ACCESSORY,Kt.HEAD_ACCESSORY_EXTRA,Kt.RIGHT_HAND_ITEM];let Cf=_a;class rp{constructor(){this._isInitalized=!1,this._maxPaletteCount=0}dispose(){this._categories=null,this._disposed=!0}get disposed(){return this._disposed}init(){this._categories||(this._categories=new Map)}reset(){if(this._isInitalized=!1,this._categories)for(const t of this._categories.values())t&&t.dispose();this._categories=new Map}addCategory(t){let e=this._categories.get(t);e||(e=js.createCategory(this,t),e&&(this._categories.set(t,e),this.updateSelectionsFromFigure(t)))}updateSelectionsFromFigure(t){const e=this._categories.get(t);if(!e)return;const s=js.CURRENT_FIGURE.getPartSetId(t);let i=js.CURRENT_FIGURE.getColorIds(t);i||(i=[]),e.selectPartId(s),e.selectColorIds(i)}hasClubSelectionsOverLevel(t){if(!this._categories)return!1;for(const e of this._categories.values())if(e&&e.hasClubSelectionsOverLevel(t))return!0;return!1}hasInvalidSelectedItems(t){if(!this._categories)return!1;for(const e of this._categories.values())if(e.hasInvalidSelectedItems(t))return!0;return!1}stripClubItemsOverLevel(t){if(!this._categories)return!1;let e=!1;for(const[s,i]of this._categories.entries()){let n=!1;if(i.stripClubItemsOverLevel(t)&&(n=!0),i.stripClubColorsOverLevel(t)&&(n=!0),n){const o=i.getCurrentPart();o&&js.CURRENT_FIGURE&&js.CURRENT_FIGURE.savePartData(s,o.id,i.getSelectedColorIds(),!0),e=!0}}return e}stripInvalidSellableItems(){if(!this._categories)return!1;let t=!1;for(const[e,s]of this._categories.entries());return t}selectPart(t,e){const s=this._categories.get(t);if(!s)return;const i=s.selectedPartIndex;s.selectPartIndex(e);const n=s.getCurrentPart();if(n){if(n.isDisabled){s.selectPartIndex(i);return}this._maxPaletteCount=n.maxColorIndex,js.CURRENT_FIGURE.savePartData(t,n.id,s.getSelectedColorIds(),!0)}}selectColor(t,e,s){const i=this._categories.get(t);if(!i)return;const n=i.getCurrentColorIndex(s);if(i.selectColorIndex(e,s),i.getSelectedColor(s).isDisabled){i.selectColorIndex(n,s);return}js.CURRENT_FIGURE.savePartSetColourId(t,i.getSelectedColorIds(),!0)}getCategoryData(t){return this._isInitalized||this.init(),this._categories?this._categories.get(t):null}get categories(){return this._categories}get canSetGender(){return!1}get maxPaletteCount(){return this._maxPaletteCount||1}set maxPaletteCount(t){this._maxPaletteCount=t}get name(){return null}}class f7 extends rp{constructor(){super(...arguments),this._imageCallBackHandled=!1}init(){super.init(),this.addCategory(ce.FACE),this._isInitalized=!0}selectColor(t,e,s){super.selectColor(t,e,s),this.updateSelectionsFromFigure(ce.FACE)}updateSelectionsFromFigure(t){if(!this._categories||!js.CURRENT_FIGURE)return;const e=this._categories.get(t);if(!e)return;const s=js.CURRENT_FIGURE.getPartSetId(t);let i=js.CURRENT_FIGURE.getColorIds(t);i||(i=[]),e.selectPartId(s),e.selectColorIds(i);for(const n of e.parts){const o=l=>{const c=js.CURRENT_FIGURE.getFigureStringWithFace(n.id),u=Gs().createAvatarImage(c,kr.LARGE,null,{resetFigure:o,dispose:null,disposed:!1}),h=u.getImageAsSprite(si.HEAD);h&&(h.y=10,n.thumbContainer=h,setTimeout(()=>u.dispose(),0))};o()}}get canSetGender(){return!0}get name(){return Pn.GENERIC}}const ji=a=>{if(a==null||typeof a!="object")return a;const t=new a.constructor;for(const e in a)a.hasOwnProperty(e)&&(t[e]=a[e]);return t};class ir{static makeColorHex(t){return"#"+t}static makeColorNumberHex(t){return"#"+t.toString(16).padStart(6,"0")}static convertFromHex(t){return parseInt(t.replace("#",""),16)}static uintHexColor(t){const e=t>>>0;return ir.makeColorHex(e.toString(16).substring(2))}static int_to_8BitVals(t){const e=t>>24&255,s=t>>16&255,i=t>>8&255,n=t&255;return[e,s,i,n]}static eight_bitVals_to_int(t,e,s,i){return(t<<24)+(e<<16)+(s<<8)+(i|0)}static int2rgb(t){t>>>=0;const e=t&255,s=(t&65280)>>>8;return"rgba("+[(t&16711680)>>>16,s,e,1].join(",")+")"}}const Nl=a=>{let t=Math.floor(a/86400),e=Math.floor(a%86400/3600),s=Math.floor(a%86400%3600/60),i=a%86400%3600%60;return t.toString().padStart(2,"0")+":"+e.toString().padStart(2,"0")+":"+s.toString().padStart(2,"0")+":"+i.toString().padStart(2,"0")},Af=a=>{try{JSON.parse(window.localStorage.getItem(a))}catch{return null}},MO=a=>{let t=Jt().localization.getBadgeDesc(a);return(!t||!t.length)&&(t=`badge_desc_${a}`),t},gh=a=>{let t=Jt().localization.getBadgeName(a);return(!t||!t.length)&&(t=`badge_name_${a}`),t};function Nf(a){return!a||isNaN(a)?"0":a.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")}function m7(a){if(!a||isNaN(a))return"0";let t=Math.abs(a);const e=Math.pow(10,1),s=a<0;let i="";const n=[{key:"Q",value:Math.pow(10,15)},{key:"T",value:Math.pow(10,12)},{key:"B",value:Math.pow(10,9)},{key:"M",value:Math.pow(10,6)},{key:"K",value:1e3}];for(const o of n){let l=t/o.value;if(l=Math.round(l*e)/e,l>=1){t=l,i=o.key;break}}return(s?"-":"")+t+i}function f(a,t=null,e=null){return Jt().getLocalizationWithParameters(a,t,e)}const NE=class NE{};NE.CATALOG_PLACE_MULTIPLE_OBJECTS="catalogPlaceMultipleObjects",NE.CATALOG_SKIP_PURCHASE_CONFIRMATION="catalogSkipPurchaseConfirmation";let c_=NE;const u0=(a,t)=>a.dispatchEvent(t),XR=a=>u0(Jt().events,a),Pa=new nr,Fs=a=>u0(Pa,a);let h0=!1;const Ua=a=>{h0&&XR(new un(un.PLAY_SOUND,a))},cA=[at.MOUSE_CLICK],E7=()=>{const a=()=>cA.forEach(e=>window.removeEventListener(e,t)),t=e=>(h0=!0)&&a();cA.forEach(e=>window.addEventListener(e,t))};E7();const _s=class _s{};_s.DEFAULT=1,_s.WALL_PAPER=2,_s.FLOOR=3,_s.LANDSCAPE=4,_s.POST_IT=5,_s.POSTER=6,_s.SOUND_SET=7,_s.TRAX_SONG=8,_s.PRESENT=9,_s.ECOTRON_BOX=10,_s.TROPHY=11,_s.CREDIT_FURNI=12,_s.PET_SHAMPOO=13,_s.PET_CUSTOM_PART=14,_s.PET_CUSTOM_PART_SHAMPOO=15,_s.PET_SADDLE=16,_s.GUILD_FURNI=17,_s.GAME_FURNI=18,_s.MONSTERPLANT_SEED=19,_s.MONSTERPLANT_REVIVAL=20,_s.MONSTERPLANT_REBREED=21,_s.MONSTERPLANT_FERTILIZE=22,_s.FIGURE_PURCHASABLE_SET=23;let vt=_s;class u_{constructor(t){t&&(this._locked=!1,this._id=t.itemId,this._type=t.spriteId,this._ref=t.ref,this._category=t.category,this._groupable=t.isGroupable&&!t.rentable,this._tradeable=t.tradable,this._recyclable=t.isRecycleable,this._sellable=t.sellable,this._stuffData=t.stuffData,this._extra=t.extra,this._secondsToExpiration=t.secondsToExpiration,this._expirationTimeStamp=t.expirationTimeStamp,this._hasRentPeriodStarted=t.hasRentPeriodStarted,this._creationDay=t.creationDay,this._creationMonth=t.creationMonth,this._creationYear=t.creationYear,this._slotId=t.slotId,this._songId=t.songId,this._flatId=t.flatId,this._isRented=t.rentable,this._isWallItem=t.isWallItem)}get rentable(){return this._isRented}get id(){return this._id}get ref(){return this._ref}get category(){return this._category}get type(){return this._type}get stuffData(){return this._stuffData}set stuffData(t){this._stuffData=t}get extra(){return this._extra}get recyclable(){return this._recyclable}get isTradable(){return this._tradeable}get isGroupable(){return this._groupable}get sellable(){return this._sellable}get secondsToExpiration(){if(this._secondsToExpiration===-1)return-1;let t=-1;return this._hasRentPeriodStarted?(t=this._secondsToExpiration-(Pt()-this._expirationTimeStamp)/1e3,t<0&&(t=0)):t=this._secondsToExpiration,t}get creationDay(){return this._creationDay}get creationMonth(){return this._creationMonth}get creationYear(){return this._creationYear}get slotId(){return this._slotId}get songId(){return this._songId}get locked(){return this._locked}set locked(t){this._locked=t}get flatId(){return this._flatId}get isWallItem(){return this._isWallItem}get hasRentPeriodStarted(){return this._hasRentPeriodStarted}get expirationTimeStamp(){return this._expirationTimeStamp}update(t){this._type=t.spriteId,this._ref=t.ref,this._category=t.category,this._groupable=t.isGroupable&&!t.rentable,this._tradeable=t.tradable,this._recyclable=t.isRecycleable,this._sellable=t.sellable,this._stuffData=t.stuffData,this._extra=t.extra,this._secondsToExpiration=t.secondsToExpiration,this._expirationTimeStamp=t.expirationTimeStamp,this._hasRentPeriodStarted=t.hasRentPeriodStarted,this._creationDay=t.creationDay,this._creationMonth=t.creationMonth,this._creationYear=t.creationYear,this._slotId=t.slotId,this._songId=t.songId,this._flatId=t.flatId,this._isRented=t.rentable,this._isWallItem=t.isWallItem}clone(){const t=new u_(null);return t._expirationTimeStamp=this._expirationTimeStamp,t._isWallItem=this._isWallItem,t._songId=this._songId,t._locked=this._locked,t._id=this._id,t._ref=this._ref,t._category=this._category,t._type=this._type,t._stuffData=this._stuffData,t._extra=this._extra,t._recyclable=this._recyclable,t._tradeable=this._tradeable,t._groupable=this._groupable,t._sellable=this._sellable,t._secondsToExpiration=this._secondsToExpiration,t._hasRentPeriodStarted=this._hasRentPeriodStarted,t._creationDay=this._creationDay,t._creationMonth=this._creationMonth,t._creationYear=this._creationYear,t._slotId=this._slotId,t._isRented=this._isRented,t._flatId=this._flatId,t}}class yO{constructor(t=-1,e=-1,s=null,i=null,n=-1){this._type=t,this._category=e,this._roomEngine=s,this._stuffData=i,this._extra=n,this._isWallItem=!1,this._iconUrl=null,this._name=null,this._description=null,this._locked=!1,this._selected=!1,this._hasUnseenItems=!1,this._items=[]}clone(){const t=new yO;return t._type=this._type,t._category=this._category,t._roomEngine=this._roomEngine,t._stuffData=this._stuffData,t._extra=this._extra,t._isWallItem=this._isWallItem,t._iconUrl=this._iconUrl,t._name=this._name,t._description=this._description,t._locked=this._locked,t._selected=this._selected,t._hasUnseenItems=this._hasUnseenItems,t._items=this._items,t}prepareGroup(){this.setIcon(),this.setName(),this.setDescription()}dispose(){}getItemByIndex(t){return this._items[t]}getItemById(t){for(const e of this._items)if(e.id===t)return e;return null}getTradeItems(t){const e=[],s=this.getLastItem();if(!s)return e;let i=0,n=0;for(;n<this._items.length&&!(i>=t);){const o=this.getItemByIndex(n);!o.locked&&o.isTradable&&o.type===s.type&&(e.push(o),i++),n++}return e}push(t){const e=[...this._items];let s=0;for(;s<e.length;){let i=e[s];if(i.id===t.id){i=i.clone(),i.locked=!1,e.splice(s,1),e.push(i),this._items=e;return}s++}e.push(t),this._items=e,this._items.length===1&&this.prepareGroup()}pop(){const t=[...this._items];let e=null;if(t.length>0){const s=t.length-1;e=t[s],t.splice(s,1)}return this._items=t,e}remove(t){const e=[...this._items];let s=0;for(;s<e.length;){let i=e[s];if(i.id===t)return e.splice(s,1),this._items=e,i;s++}return null}getTotalCount(){if(this._category===vt.POST_IT){let t=0,e=0;for(;e<this._items.length;){const s=this.getItemByIndex(e);t=t+parseInt(s.stuffData.getLegacyString()),e++}return t}return this._items.length}getUnlockedCount(){if(this.category===vt.POST_IT)return this.getTotalCount();let t=0,e=0;for(;e<this._items.length;)this.getItemByIndex(e).locked||t++,e++;return t}getLastItem(){return this._items.length?this.getItemByIndex(this._items.length-1):null}unlockAllItems(){const t=[...this._items];let e=0;for(;e<t.length;){const s=t[e];if(s.locked){const i=s.clone();i.locked=!1,t[e]=i}e++}this._items=t}lockItemIds(t){const e=[...this._items];let s=0,i=!1;for(;s<e.length;){const n=e[s],o=t.indexOf(n.ref)>=0;if(n.locked!==o){i=!0;const l=n.clone();l.locked=o,e[s]=l}s++}return this._items=e,i}setName(){const t=this.getLastItem();if(!t){this._name="";return}let e="";switch(this._category){case vt.POSTER:e="poster_"+t.stuffData.getLegacyString()+"_name";break;case vt.TRAX_SONG:this._name="SONG_NAME";return;default:this.isWallItem?e="wallItem.name."+t.type:e="roomItem.name."+t.type}this._name=f(e)}setDescription(){this._description=""}setIcon(){if(this._iconUrl)return;let t=null;this.isWallItem?t=this._roomEngine.getFurnitureWallIconUrl(this._type,this._stuffData.getLegacyString()):t=this._roomEngine.getFurnitureFloorIconUrl(this._type),t&&(this._iconUrl=t)}get type(){return this._type}get category(){return this._category}get stuffData(){return this._stuffData}get extra(){return this._extra}get iconUrl(){return this._iconUrl}get name(){return this._name}get description(){return this._description}get hasUnseenItems(){return this._hasUnseenItems}set hasUnseenItems(t){this._hasUnseenItems=t}get locked(){return this._locked}set locked(t){this._locked=t}get selected(){return this._selected}set selected(t){this._selected=t}get isWallItem(){const t=this.getItemByIndex(0);return t?t.isWallItem:!1}get isGroupable(){const t=this.getItemByIndex(0);return t?t.isGroupable:!1}get isSellable(){const t=this.getItemByIndex(0);return t?t.sellable:!1}get items(){return this._items}set items(t){this._items=t}}const DO=(a,t,e,s=NaN)=>new yO(a,t,tt(),e,s),p7=(a,t,e)=>{const s=[];for(const n of a)n.type===t.type&&s.push(n);for(const n of s)if(n.getItemById(t.id))return n;const i=DO(t.type,t.category,t.stuffData,t.extra);return i.push(t),e?(i.hasUnseenItems=!0,a.unshift(i)):a.push(i),i},I7=(a,t,e)=>{let s=null;for(const i of a)if(i.type===t.type&&i.isWallItem===t.isWallItem&&i.isGroupable)if(t.category===vt.POSTER){if(i.stuffData.getLegacyString()===t.stuffData.getLegacyString()){s=i;break}}else if(t.category===vt.GUILD_FURNI){if(t.stuffData.compare(i.stuffData)){s=i;break}}else{s=i;break}if(s){if(s.push(t),e){s.hasUnseenItems=!0;const i=a.indexOf(s);i>=0&&a.splice(i,1),a.unshift(s)}return s}return s=DO(t.type,t.category,t.stuffData,t.extra),s.push(t),e?(s.hasUnseenItems=!0,a.unshift(s)):a.push(s),s},uA=(a,t,e)=>{t.isGroupable?I7(a,t,e):p7(a,t,e)},T7=(a,t,e,s)=>{if(t===1)return a;s[e]=a;for(const n of s)if(!n)return null;const i=new Map;for(const n of s){for(const[o,l]of n)i.set(o,l);n.clear()}return s=null,i},R7=a=>{const t=[];for(const e of a){let s=e.getTotalCount();e.category===vt.POST_IT&&(s=1);let i=0;for(;i<s;)t.push(e.getItemByIndex(i).id),i++}return t};let d0=!1,_0=-1;const S7=()=>d0,O_=a=>d0=a,fh=()=>_0,np=a=>_0=a,h_=()=>{fh()!==-1&&(tt().cancelRoomObjectPlacement(),np(-1),O_(!1))},qR=(a,t=!1)=>{const e=a.petData;if(!e)return!1;const s=Fc().getSession(1);return!s||!s.isRoomOwner&&!s.allowPets?!1:(ut("inventory/hide"),tt().processRoomObjectPlacement(hl.INVENTORY,-e.id,W.UNIT,be.PET,e.figureData.figuredata)&&(np(e.id),O_(!0)),!0)},mh=(a,t=!1)=>{if(!a||!a.getUnlockedCount())return!1;const e=a.getLastItem();if(!e)return!1;if(e.category===vt.FLOOR||e.category===vt.WALL_PAPER||e.category===vt.LANDSCAPE)return t||k(new Dh(e.id)),!1;{ut("inventory/hide");let s=0,i=!1;e.isWallItem?s=W.WALL:s=W.FLOOR,e.category===vt.POSTER?i=tt().processRoomObjectPlacement(hl.INVENTORY,e.id,s,e.type,e.stuffData.getLegacyString()):i=tt().processRoomObjectPlacement(hl.INVENTORY,e.id,s,e.type,e.extra.toString(),e.stuffData),i&&(np(e.ref),O_(!0))}return!0},QR=(a,t=!1)=>{const e=a.botData;if(!e)return!1;const s=Fc().getSession(1);return!s||!s.isRoomOwner?!1:(ut("inventory/hide"),tt().processRoomObjectPlacement(hl.INVENTORY,-e.id,W.UNIT,be.RENTABLE_BOT,e.figure)&&(np(e.id),O_(!0)),!0)},Ko=class Ko{};Ko.FURNI=1,Ko.RENTABLE=2,Ko.PET=3,Ko.BADGE=4,Ko.BOT=5,Ko.GAMES=6;let os=Ko;const O7=a=>a.map(t=>t.petData.id),g0=(a,t,e=!0)=>{const s={petData:a};return e?t.unshift(s):t.push(s),s},f0=(a,t)=>{let e=0;for(;e<t.length;){const s=t[e];if(s&&s.petData.id===a)return fh()===s.petData.id&&(h_(),ut("inventory/open")),t.splice(e,1),s;e++}return null},C7=(a,t,e)=>{const s=O7(a),i=[],n=[];for(const o of t.keys())s.indexOf(o)===-1&&i.push(o);for(const o of s)!t.get(o)&&n.push(o);s.length;for(const o of n)f0(o,a);for(const o of i){const l=t.get(o);l&&g0(l,a,e(os.PET,l.id))}return a},A7=(a,t,e,s)=>{if(t===1)return a;s[e]=a;for(const n of s)if(!n)return null;const i=new Map;for(const n of s){for(const[o,l]of n)i.set(o,l);n.clear()}return s=null,i},no=class no{};no.TRADING_STATE_READY=0,no.TRADING_STATE_RUNNING=1,no.TRADING_STATE_COUNTDOWN=2,no.TRADING_STATE_CONFIRMING=3,no.TRADING_STATE_CONFIRMED=4,no.TRADING_STATE_COMPLETED=5,no.TRADING_STATE_CANCELLED=6;let Ps=no;class hA{constructor(t=-1,e="",s=new hs,i=0,n=0,o=!1,l=!1){this.userId=t,this.userName=e,this.userItems=s,this.itemCount=i,this.creditsCount=n,this.accepts=o,this.canTrade=l}}const xn=class xn{};xn.ALERT_SCAM=0,xn.HOTEL_TRADING_DISABLED=1,xn.YOU_NOT_ALLOWED=2,xn.THEY_NOT_ALLOWED=4,xn.ROOM_DISABLED=6,xn.YOU_OPEN=7,xn.THEY_OPEN=8,xn.ERROR_WHILE_COMMIT=9,xn.THEY_CANCELLED=10;let Ji=xn;const dA=a=>{var t;return((t=q().getWallItemData(a))==null?void 0:t.isExternalImage)||!1},_A=a=>{const t=new hs;if(a.length)for(const s of a){const i=s.spriteId,n=s.category;let o=s.furniType+i;(!s.isGroupable||dA(i))&&(o="itemid"+s.itemId),s.category===vt.POSTER?o=s.itemId+"poster"+s.stuffData.getLegacyString():s.category===vt.GUILD_FURNI&&(o="");let l=s.isGroupable&&!dA(s.spriteId)?t.getValue(o):null;l||(l=DO(i,n,s.stuffData),t.add(o,l)),l.push(new u_(s))}return t},N7=(a,t)=>{let e=a.toString();if(!(t instanceof Vn))return e;let s=1;for(;s<5;)e=e+(","+t.getValue(s)),s++;return e};class ag{static getProductImageUrl(t,e,s){let i=null;switch(t){case Un.S:i=tt().getFurnitureFloorIconUrl(e);break;case Un.I:this.getProductCategory(Un.I,e)===1&&(i=tt().getFurnitureWallIconUrl(e,s));break}return i}static getProductCategory(t,e){if(t===Un.S)return 1;if(t===Un.I){if(e===3001)return vt.WALL_PAPER;if(e===3002)return vt.FLOOR;if(e===4057)return vt.LANDSCAPE}return 1}}class xf{static getRandomNumber(t){return Math.floor(Math.random()*t)}static getRandomElement(t){return t[this.getRandomNumber(t.length)]}static getRandomElements(t,e){const s=new Array(e);let i=t.length;const n=new Array(i);for(;e--;){var o=this.getRandomNumber(i);s[e]=t[o in n?n[o]:o],n[o]=--i in n?n[i]:i}return s}}const Bs=new Map;Bs.set("r","red");Bs.set("b","blue");Bs.set("g","green");Bs.set("y","yellow");Bs.set("w","white");Bs.set("o","orange");Bs.set("c","cyan");Bs.set("br","brown");Bs.set("pr","purple");Bs.set("pk","pink");Bs.set("red","red");Bs.set("blue","blue");Bs.set("green","green");Bs.set("yellow","yellow");Bs.set("white","white");Bs.set("orange","orange");Bs.set("cyan","cyan");Bs.set("brown","brown");Bs.set("purple","purple");Bs.set("pink","pink");const x7=/<font\s+color="#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})">/g,M7=/<\/font>/g,y7=/<b>/g,D7=/<\/b>/g,b7=a=>{const t={};let e=0;const s=l=>{const c=`__PLACEHOLDER_${e}__`;return t[c]=l,e++,c};return a.replace(x7,s).replace(M7,s).replace(y7,s).replace(D7,s).replace(/([\u00A0-\u9999<>&])/g,l=>`&#${l.charCodeAt(0)};`).replace(/__PLACEHOLDER_(\d+)__/g,l=>t[l])},v7=a=>{let t="";if(a=b7(a),a.startsWith("@")&&a.indexOf("@",1)>-1){let e=null;const s=/@([a-zA-Z]+)@/g;for(;(e=s.exec(a))!==null;){e[0];const i=e[1].toLowerCase(),n=a.substring(s.lastIndex);Bs.has(i)?t=`<span style="color: ${Bs.get(i)}">${n}</span>`:t=n;break}}else t=a;return t},m0=(a,t)=>window.localStorage.setItem(a,JSON.stringify(t)),Xo=class Xo{};Xo.CAMERA_SHUTTER="camera_shutter",Xo.CREDITS="credits",Xo.DUCKETS="duckets",Xo.MESSENGER_NEW_THREAD="messenger_new_thread",Xo.MESSENGER_MESSAGE_RECEIVED="messenger_message_received",Xo.MODTOOLS_NEW_TICKET="modtools_new_ticket";let ja=Xo;function L7(a){const t=a.parts;let e=0;for(const s of t)e=Math.max(e,s.colorLayerIndex);return e}function P7(a,t){return t=t.filter(e=>a.indexOf(e)===-1),[...a,...xf.getRandomElements(t,xf.getRandomNumber(t.length)+1)]}function U7(a,t,e=0,s=[]){if(!a)return null;const i=a.partSets.getValues().filter(n=>!n.isSelectable||n.gender!=="U"&&n.gender!==t||n.clubLevel>e||n.isSellable&&s.indexOf(n.id)===-1?null:n);return!i||!i.length?null:xf.getRandomElement(i)}function j7(a,t,e=0){if(!a)return[];const s=a.colors.getValues().filter(i=>!i.isSelectable||i.clubLevel>e?null:i);return!s||!s.length?null:xf.getRandomElements(s,L7(t))}function w7(a,t,e=0,s=[],i=[]){const n=Gs().structure,o=new Mh(""),l=P7(n.getMandatorySetTypeIds(t,e),ce.SET_TYPES);for(const c of i){const u=a.getPartSetId(c),h=a.getColorIds(c);o.updatePart(c,u,h)}for(const c of l){if(o.hasPartType(c))continue;const u=n.figureData.getSetType(c),h=U7(u,t,e,s);if(!h)continue;let d=[];h.isColorable&&(d=j7(n.figureData.getPalette(u.paletteID),h,e).map(g=>g.id)),o.updatePart(u.type,h.id,d)}return o.getFigureString()}class F7 extends rp{init(){super.init(),this.addCategory(ce.HAIR),this.addCategory(ce.HAT),this.addCategory(ce.HEAD_ACCESSORIES),this.addCategory(ce.EYE_ACCESSORIES),this.addCategory(ce.FACE_ACCESSORIES),this._isInitalized=!0}get name(){return Pn.HEAD}}class G7 extends rp{init(){super.init(),this.addCategory(ce.TROUSERS),this.addCategory(ce.SHOES),this.addCategory(ce.TROUSER_ACCESSORIES),this._isInitalized=!0}get name(){return Pn.LEGS}}class B7 extends rp{init(){super.init(),this.addCategory(ce.SHIRT),this.addCategory(ce.CHEST_PRINTS),this.addCategory(ce.JACKET),this.addCategory(ce.CHEST_ACCESSORIES),this._isInitalized=!0}get name(){return Pn.TORSO}}const xE=class xE{};xE.COLORMATRIX="colormatrix",xE.COMPOSITE="composite";let d_=xE;class k7{constructor(t,e){this.texture=t,this.imageUrl=e}}class V7{constructor(t,e){this.effectName=t,this.thumbnailUrl=e}}class H7{constructor(t,e,s){this._productName=t,this._customImage=e,this._furnitureClassName=s}get productName(){return this._productName}get customImage(){return this._customImage}get furnitureClassName(){return this._furnitureClassName}}const ku=class ku{};ku.STATE_UNLOCKED=1,ku.STATE_LOCKED_AVAILABLE=2,ku.STATE_LOCKED_EXPIRED=3,ku.STATE_LOCKED_FUTURE=4;let vi=ku;const Od=class Od{};Od.TYPE_CHAT=1,Od.TYPE_ROOM_INFO=2,Od.TYPE_IM=3;let Bn=Od;const E0=()=>{const a=new Date;return`${a.getHours().toString().padStart(2,"0")}:${a.getMinutes().toString().padStart(2,"0")}`},gA=(a=0)=>{const t=a?new Date(Date.now()-a*1e3):new Date;return`${t.getHours().toString().padStart(2,"0")}:${t.getMinutes().toString().padStart(2,"0")}`},p0=a=>{if(!a||!a.length)return null;const t=a.split("/"),e=t[0],s=t[1],i=parseInt(t[2]);return{username:e,figure:s,userId:i}},Vu=class Vu{constructor(){this.id=-1,this.name=null,this.gender=0,this.online=!1,this.followingAllowed=!1,this.figure=null,this.categoryId=0,this.motto=null,this.realName=null,this.lastAccess=null,this.persistedMessageUser=!1,this.vipMember=!1,this.pocketHabboUser=!1,this.relationshipStatus=-1,this.unread=0}populate(t){this.id=t.id,this.name=t.name,this.gender=t.gender,this.online=t.online,this.followingAllowed=t.followingAllowed,this.figure=t.figure,this.categoryId=t.categoryId,this.motto=t.motto,this.realName=t.realName,this.lastAccess=t.lastAccess,this.persistedMessageUser=t.persistedMessageUser,this.vipMember=t.vipMember,this.pocketHabboUser=t.pocketHabboUser,this.relationshipStatus=t.relationshipStatus}};Vu.RELATIONSHIP_NONE=0,Vu.RELATIONSHIP_HEART=1,Vu.RELATIONSHIP_SMILE=2,Vu.RELATIONSHIP_BOBBA=3;let er=Vu;const ME=class ME{};ME.GROUP_CHAT=0,ME.PRIVATE_CHAT=1;let pc=ME;const Cd=class Cd{};Cd.HIDDEN=0,Cd.SHOW=1,Cd.UNREAD=2;let Ma=Cd;class fA{populate(t){return t?(this._id=t.requestId,this._name=t.requesterName,this._figureString=t.figureString,this._requesterUserId=t.requesterUserId,!0):!1}get id(){return this._id}get name(){return this._name}get requesterUserId(){return this._requesterUserId}get figureString(){return this._figureString}}class W7{constructor(t=0,e=0,s=0,i=[]){this.userFriendLimit=t,this.normalFriendLimit=e,this.extendedFriendLimit=s,this.categories=i}}const Hu=class Hu{constructor(t,e,s=0,i=null,n=0){this._type=n,this._senderId=t,this._message=e,this._secondsSinceSent=s,this._extraData=i,this._date=new Date}get type(){return this._type}get senderId(){return this._senderId}get message(){return this._message}get secondsSinceSent(){return this._secondsSinceSent}get extraData(){return this._extraData}get date(){return this._date}};Hu.CHAT=0,Hu.ROOM_INVITE=1,Hu.STATUS_NOTIFICATION=2,Hu.SECURITY_NOTIFICATION=3;let mo=Hu;class Y7{constructor(t,e=pc.PRIVATE_CHAT){this._userId=t,this._chats=[],this._type=e}addChat(t){this._chats.push(t)}get userId(){return this._userId}get chats(){return this._chats}get type(){return this._type}set type(t){this._type=t}}const Ad=class Ad{constructor(t){this._threadId=++Ad.THREAD_ID,this._participant=t,this._groups=[],this._lastUpdated=new Date,this._unreadCount=0}addMessage(t,e,s=0,i=null,n=0){const o=t<0&&i,l=o?p0(i).userId:t,c=this.getLastGroup(l);if(!c)return;o&&(c.type=pc.GROUP_CHAT);const u=new mo(t,e,s,i,n);return c.addChat(u),this._lastUpdated=new Date,this._unreadCount++,u}getLastGroup(t){let e=this._groups[this._groups.length-1];return e&&e.userId===t||(e=new Y7(t),this._groups.push(e)),e}setRead(){this._unreadCount=0}get threadId(){return this._threadId}get participant(){return this._participant}get groups(){return this._groups}get lastUpdated(){return this._lastUpdated}get unreadCount(){return this._unreadCount}get unread(){return this._unreadCount>0}};Ad.MESSAGE_RECEIVED="MT_MESSAGE_RECEIVED",Ad.THREAD_ID=0;let JR=Ad;function ap(a=0){ut(a===0?"friends-messenger/toggle":`friends-messenger/${a}`)}const z7=()=>rh.RENDERER_VERSION,I0=()=>"2.1.1";function C_(a){k(new ch(a,!0))}function T0(a){ut(`groups/manage/${a}`)}function mA(a,t){ut(t?`group-members/${a}/${t}`:`group-members/${a}`)}const Wu=class Wu{constructor(t,e,s,i){this.type=t,this.key=e||0,this.color=s||0,this.position=i||4}get code(){return this.key===0&&this.type!==Wu.BASE?null:Wu.getCode(this.type,this.key,this.color,this.position)}static getCode(t,e,s,i){return t+(e<10?"0":"")+e+(s<10?"0":"")+s+i}};Wu.BASE="b",Wu.SYMBOL="s";let Di=Wu;const Nd=class Nd{};Nd.NOT_MEMBER=0,Nd.MEMBER=1,Nd.REQUEST_PENDING=2;let Qs=Nd;const xd=class xd{};xd.REGULAR=0,xd.EXCLUSIVE=1,xd.PRIVATE=2;let Fr=xd;const K7=a=>{k(a.favourite?new Ov(a.groupId):new gv(a.groupId))},bO=a=>k(new fv(a)),bs=class bs{};bs.NONE="NONE",bs.ERROR="ERROR",bs.REJECTED="REJECTED",bs.USER_CREATE="USER_CREATE",bs.USER_PENDING="USER_PENDING",bs.USER_ONGOING="USER_ONGOING",bs.USER_FEEDBACK="USER_FEEDBACK",bs.USER_NO_HELPERS="USER_NO_HELPERS",bs.USER_SOMETHING_WRONG="USER_SOMETHING_WRONG",bs.USER_THANKS="USER_THANKS",bs.USER_GUIDE_DISCONNECTED="USER_GUIDE_DISCONNECTED",bs.GUIDE_TOOL_MENU="GUIDE_TOOL_MENU",bs.GUIDE_ACCEPT="GUIDE_ACCEPT",bs.GUIDE_ONGOING="GUIDE_ONGOING",bs.GUIDE_CLOSED="GUIDE_CLOSED",bs.GUARDIAN_CHAT_REVIEW_ACCEPT="GUARDIAN_CHAT_REVIEW_ACCEPT",bs.GUARDIAN_CHAT_REVIEW_WAIT_FOR_VOTERS="GUARDIAN_CHAT_REVIEW_WAIT_FOR_VOTERS",bs.GUARDIAN_CHAT_REVIEW_VOTE="GUARDIAN_CHAT_REVIEW_VOTE",bs.GUARDIAN_CHAT_REVIEW_WAIT_FOR_RESULTS="GUARDIAN_CHAT_REVIEW_WAIT_FOR_RESULTS",bs.GUARDIAN_CHAT_REVIEW_RESULTS="GUARDIAN_CHAT_REVIEW_RESULTS";let Ae=bs;class EA{constructor(t,e){this._message=t,this._roomId=e}get message(){return this._message}get roomId(){return this._roomId}}class pA{constructor(t){this._userId=t,this._messages=[]}addChat(t){this._messages.push(t)}get userId(){return this._userId}get messages(){return this._messages}}const Md=class Md{};Md.ACTIVE="active",Md.NONE="none",Md.EXPIRED="expired";let Sa=Md;const X7="HC1",q7=["ACH_VipHC1","ACH_VipHC2","ACH_VipHC3","ACH_VipHC4","ACH_VipHC5","HC1","HC2","HC3","HC4","HC5"],Q7=a=>{let t=null;return q7.forEach(e=>a.indexOf(e)>-1&&(t=e)),t||X7},yE=class yE{};yE.TOO_MANY_PENDING_CALLS_CODE=1,yE.HAS_ABUSIVE_CALL_CODE=2;let Mf=yE;const J7=a=>a===1?"useless":a===2?"abusive":"resolved",rc=class rc{};rc.SELECT_USER=0,rc.SELECT_CHATS=1,rc.SELECT_TOPICS=2,rc.INPUT_REPORT_MESSAGE=3,rc.REPORT_SUMMARY=4;let Ci=rc;const ga=class ga{};ga.EMERGENCY=1,ga.GUIDE=2,ga.IM=3,ga.ROOM=4,ga.BULLY=6,ga.THREAD=7,ga.MESSAGE=8,ga.PHOTO=9;let as=ga;const $7=a=>{switch(a){case 1:case 2:return"Normal";case 3:return"Automatic";case 4:return"Automatic IM";case 5:return"Guide System";case 6:return"IM";case 7:return"Room";case 8:return"Panic";case 9:return"Guardian";case 10:return"Automatic Helper";case 11:return"Discussion";case 12:return"Selfie";case 14:return"Photo";case 15:return"Ambassador"}return"Unknown"},qo=class qo{constructor(t,e,s,i,n){this._actionId=t,this._name=e,this._actionType=s,this._sanctionTypeId=i,this._actionLengthHours=n}get actionId(){return this._actionId}get name(){return this._name}get actionType(){return this._actionType}get sanctionTypeId(){return this._sanctionTypeId}get actionLengthHours(){return this._actionLengthHours}};qo.ALERT=1,qo.MUTE=2,qo.BAN=3,qo.KICK=4,qo.TRADE_LOCK=5,qo.MESSAGE=6;let Pe=qo;const Mn=class Mn{};Mn.NONE=0,Mn.START_DOORBELL=1,Mn.START_PASSWORD=2,Mn.STATE_PENDING_SERVER=3,Mn.UPDATE_STATE=4,Mn.STATE_WAITING=5,Mn.STATE_NO_ANSWER=6,Mn.STATE_WRONG_PASSWORD=7,Mn.STATE_ACCEPTED=8;let Fe=Mn;const yd=class yd{};yd.LIST=0,yd.THUMBNAILS=1,yd.FORCED_THUMBNAILS=2;let yo=yd;const Z7=()=>{const a=[];for(let t=10;t<=100;t=t+10)a.push(t);return a},IA=Z7(),Wc=[{name:"anything",query:null},{name:"room.name",query:"roomname"},{name:"owner",query:"owner"},{name:"tag",query:"tag"},{name:"group",query:"group"}];function Yr(a){k(new Zd(a,!1,!0))}const fa=class fa{};fa.DEFAULT="default",fa.MOTD="motd",fa.MODERATION="moderation",fa.EVENT="event",fa.NITRO="nitro",fa.SEARCH="search",fa.ALERT="alert",fa.TABLE="table";let Bt=fa;const Dd=class Dd{constructor(t,e=Bt.DEFAULT,s=null,i=null,n=null,o=null,l=null,c=null){Dd.ITEM_ID+=1,this._id=Dd.ITEM_ID,this._messages=t,this._alertType=e,this._clickUrl=s,this._clickUrlText=i,this._title=n,this._imageUrl=o,this._columns=l,this._rows=c}get id(){return this._id}get messages(){return this._messages}set alertType(t){this._alertType=t}get alertType(){return this._alertType}get clickUrl(){return this._clickUrl}get clickUrlText(){return this._clickUrlText}get title(){return this._title}get imageUrl(){return this._imageUrl}get columns(){return this._columns}get rows(){return this._rows}};Dd.ITEM_ID=-1;let jh=Dd;const ci=class ci{};ci.FRIENDOFFLINE="friendoffline",ci.FRIENDONLINE="friendonline",ci.THIRDPARTYFRIENDOFFLINE="thirdpartyfriendoffline",ci.THIRDPARTYFRIENDONLINE="thirdpartyfriendonline",ci.ACHIEVEMENT="achievement",ci.BADGE_RECEIVED="badge_received",ci.INFO="info",ci.RECYCLEROK="recyclerok",ci.RESPECT="respect",ci.CLUB="club",ci.SOUNDMACHINE="soundmachine",ci.PETLEVEL="petlevel",ci.CLUBGIFT="clubgift",ci.BUYFURNI="buyfurni",ci.VIP="vip",ci.ROOMMESSAGESPOSTED="roommessagesposted";let bi=ci;const bd=class bd{constructor(t,e=bi.INFO,s=null,i=null,n="#1c1c20f2"){bd.ITEM_ID+=1,this._id=bd.ITEM_ID,this._message=t,this._notificationType=e,this._iconUrl=s,this._linkUrl=i,this._color=n}get id(){return this._id}get message(){return this._message}get notificationType(){return this._notificationType}get iconUrl(){return this._iconUrl}get linkUrl(){return this._linkUrl}get color(){return this._color}};bd.ITEM_ID=-1;let $R=bd;const vd=class vd{constructor(t,e,s,i,n,o,l){vd.ITEM_ID+=1,this._id=vd.ITEM_ID,this._confirmType=t,this._message=e,this._onConfirm=s,this._onCancel=i,this._confirmText=n,this._cancelText=o,this._title=l}get id(){return this._id}get confirmType(){return this._confirmType}get message(){return this._message}get onConfirm(){return this._onConfirm}get onCancel(){return this._onCancel}get confirmText(){return this._confirmText}get cancelText(){return this._cancelText}get title(){return this._title}};vd.ITEM_ID=-1;let ZR=vd;const RC=class RC{};RC.DEFAULT="default";let TA=RC;class vO{constructor(){this._credits=0,this._activityPoints=new Map,this._clubDays=0,this._clubPeriods=0,this._isVIP=!1,this._pastClubDays=0,this._pastVipDays=0,this._isExpiring=!1,this._minutesUntilExpiration=0,this._minutesSinceLastModified=0,this._lastUpdated=0}static from(t){const e=new vO;return e._credits=t._credits,e._activityPoints=t._activityPoints,e._clubDays=t._clubDays,e._clubPeriods=t._clubPeriods,e._isVIP=t._isVIP,e._pastClubDays=t._pastClubDays,e._pastVipDays=t._pastVipDays,e._isExpiring=t._isExpiring,e._minutesUntilExpiration=t._minutesUntilExpiration,e._minutesSinceLastModified=t._minutesSinceLastModified,e._lastUpdated=t._lastUpdated,e}get credits(){return this._credits}set credits(t){this._lastUpdated=Pt(),this._credits=t}get activityPoints(){return this._activityPoints}set activityPoints(t){this._lastUpdated=Pt(),this._activityPoints=t}get clubDays(){return this._clubDays}set clubDays(t){this._lastUpdated=Pt(),this._clubDays=t}get clubPeriods(){return this._clubPeriods}set clubPeriods(t){this._lastUpdated=Pt(),this._clubPeriods=t}get hasClubLeft(){return this._clubDays>0||this._clubPeriods>0}get isVip(){return this._isVIP}set isVip(t){this._isVIP=t}get pastClubDays(){return this._pastClubDays}set pastClubDays(t){this._lastUpdated=Pt(),this._pastClubDays=t}get pastVipDays(){return this._pastVipDays}set pastVipDays(t){this._lastUpdated=Pt(),this._pastVipDays=t}get isExpiring(){return this._isExpiring}set isExpiring(t){this._isExpiring=t}get minutesUntilExpiration(){var t=(Pt()-this._lastUpdated)/6e4,e=this._minutesUntilExpiration-t;return e>0?e:0}set minutesUntilExpiration(t){this._lastUpdated=Pt(),this._minutesUntilExpiration=t}get minutesSinceLastModified(){return this._minutesSinceLastModified}set minutesSinceLastModified(t){this._lastUpdated=Pt(),this._minutesSinceLastModified=t}get lastUpdated(){return this._lastUpdated}get clubLevel(){return this.clubDays===0&&this.clubPeriods===0?Fi.NO_CLUB:this.isVip?Fi.VIP:Fi.CLUB}}class A_ extends kt{}const Ld=class Ld extends A_{constructor(t,e){super(t),this._id=-1,this._numQuestions=0,this._startMessage="",this._endMessage="",this._questionArray=null,this._pollType="",this._npsPoll=!1,this._id=e}get id(){return this._id}get summary(){return this._summary}set summary(t){this._summary=t}get headline(){return this._headline}set headline(t){this._headline=t}get numQuestions(){return this._numQuestions}set numQuestions(t){this._numQuestions=t}get startMessage(){return this._startMessage}set startMessage(t){this._startMessage=t}get endMessage(){return this._endMessage}set endMessage(t){this._endMessage=t}get questionArray(){return this._questionArray}set questionArray(t){this._questionArray=t}get pollType(){return this._pollType}set pollType(t){this._pollType=t}get npsPoll(){return this._npsPoll}set npsPoll(t){this._npsPoll=t}};Ld.OFFER="RWPUW_OFFER",Ld.ERROR="RWPUW_ERROR",Ld.CONTENT="RWPUW_CONTENT";let Do=Ld;const DE=class DE extends A_{constructor(t,e=0,s=0,i=0){super(t),this._hue=e,this._saturation=s,this._lightness=i}get hue(){return this._hue}get saturation(){return this._saturation}get lightness(){return this._lightness}};DE.PREVIEW="RWUBCPE_PREVIEW",DE.CLEAR_PREVIEW="RWUBCPE_CLEAR_PREVIEW";let el=DE;const Yu=class Yu extends A_{constructor(t,e){super(Yu.CHAT_INPUT_CONTENT),this._chatMode="",this._userName="",this._chatMode=t,this._userName=e}get chatMode(){return this._chatMode}get userName(){return this._userName}};Yu.CHAT_INPUT_CONTENT="RWUCICE_CHAT_INPUT_CONTENT",Yu.WHISPER="whisper",Yu.SHOUT="shout";let Ic=Yu;const bE=class bE extends A_{constructor(t,e,s,i,n,o,l){super(bE.UPDATE_CHAT),this._objectId=t,this._category=e,this._botId=s,this._chat=i,this._automaticChat=n,this._chatDelay=o,this._mixSentences=l}get objectId(){return this._objectId}get category(){return this._category}get botId(){return this._botId}get chat(){return this._chat}get automaticChat(){return this._automaticChat}get chatDelay(){return this._chatDelay}get mixSentences(){return this._mixSentences}};bE.UPDATE_CHAT="RWURBCE_UPDATE_CHAT";let yf=bE;const nn=class nn extends A_{constructor(t,e,s,i){super(t),this._id=e,this._category=s,this._roomId=i}get id(){return this._id}get category(){return this._category}get roomId(){return this._roomId}};nn.OBJECT_SELECTED="RWUROE_OBJECT_SELECTED",nn.OBJECT_DESELECTED="RWUROE_OBJECT_DESELECTED",nn.USER_REMOVED="RWUROE_USER_REMOVED",nn.FURNI_REMOVED="RWUROE_FURNI_REMOVED",nn.FURNI_ADDED="RWUROE_FURNI_ADDED",nn.USER_ADDED="RWUROE_USER_ADDED",nn.OBJECT_ROLL_OVER="RWUROE_OBJECT_ROLL_OVER",nn.OBJECT_ROLL_OUT="RWUROE_OBJECT_ROLL_OUT",nn.OBJECT_REQUEST_MANIPULATION="RWUROE_OBJECT_REQUEST_MANIPULATION",nn.OBJECT_DOUBLE_CLICKED="RWUROE_OBJECT_DOUBLE_CLICKED";let Ue=nn;const SC=class SC{constructor(t){this.type=t,this.id=0,this.category=0,this.name="",this.description="",this.image=null,this.isWallItem=!1,this.isStickie=!1,this.isRoomOwner=!1,this.roomControllerLevel=0,this.isAnyRoomController=!1,this.expiration=-1,this.purchaseCatalogPageId=-1,this.purchaseOfferId=-1,this.extraParam="",this.isOwner=!1,this.stuffData=null,this.groupId=0,this.ownerId=0,this.ownerName="",this.usagePolicy=0,this.rentCatalogPageId=-1,this.rentOfferId=-1,this.purchaseCouldBeUsedForBuyout=!1,this.rentCouldBeUsedForBuyout=!1,this.availableForBuildersClub=!1,this.tileSizeX=1,this.tileSizeY=1,this.rareValue=0,this.validRare=!1,this.winReason=""}};SC.FURNI="IFI_FURNI";let vc=SC;class R0{constructor(t,e,s,i,n,o=!1){this.roomIndex=t,this.category=e,this.id=s,this.name=i,this.userType=n,this.isFriend=o}}const OC=class OC{constructor(t){this.type=t,this.level=0,this.maximumLevel=0,this.experience=0,this.levelExperienceGoal=0,this.energy=0,this.maximumEnergy=0,this.happyness=0,this.maximumHappyness=0,this.respectsPetLeft=0,this.respect=0,this.age=0,this.name="",this.id=-1,this.image=null,this.petType=0,this.petBreed=0,this.petFigure="",this.posture="std",this.isOwner=!1,this.ownerId=-1,this.ownerName="",this.canRemovePet=!1,this.roomIndex=0,this.unknownRarityLevel=0,this.saddle=!1,this.rider=!1,this.breedable=!1,this.skillTresholds=[],this.publiclyRideable=0,this.fullyGrown=!1,this.dead=!1,this.rarityLevel=0,this.maximumTimeToLive=0,this.remainingTimeToLive=0,this.remainingGrowTime=0,this.publiclyBreedable=!1}};OC.PET_INFO="IPI_PET_INFO";let Lc=OC;const CC=class CC{constructor(t){this.type=t,this.name="",this.motto="",this.webID=0,this.figure="",this.badges=[],this.carryItem=0,this.roomIndex=0,this.amIOwner=!1,this.amIAnyRoomController=!1,this.roomControllerLevel=0,this.ownerId=-1,this.ownerName="",this.botSkills=[]}};CC.RENTABLE_BOT="IRBI_RENTABLE_BOT";let Pc=CC;const ma=class ma{constructor(t){this.type=t,this.name="",this.motto="",this.achievementScore=0,this.webID=0,this.xp=0,this.userType=-1,this.figure="",this.badges=[],this.groupId=0,this.groupName="",this.groupBadgeId="",this.carryItem=0,this.roomIndex=0,this.isSpectatorMode=!1,this.allowNameChange=!1,this.amIOwner=!1,this.amIAnyRoomController=!1,this.roomControllerLevel=0,this.canBeKicked=!1,this.canBeBanned=!1,this.canBeMuted=!1,this.respectLeft=0,this.isIgnored=!1,this.isGuildRoom=!1,this.canTrade=!1,this.canTradeReason=0,this.targetRoomControllerLevel=0,this.isAmbassador=!1}get isOwnUser(){return this.type===ma.OWN_USER}};ma.OWN_USER="IUI_OWN_USER",ma.PEER="IUI_PEER",ma.BOT="IUI_BOT",ma.TRADE_REASON_OK=0,ma.TRADE_REASON_SHUTDOWN=2,ma.TRADE_REASON_NO_TRADING=3,ma.DEFAULT_BOT_BADGE_ID="BOT";let Ls=ma;class Yc{static getObjectName(t,e){const s=ie();let i=-1,n=null,o=0;switch(e){case W.FLOOR:case W.WALL:{const l=tt().getRoomObject(s.roomId,t,e);if(!l)break;if(l.type.indexOf("poster")===0)n=f("${poster_"+parseInt(l.type.replace("poster",""))+"_name}");else{let c=null;const u=l.model.getValue(C.FURNITURE_TYPE_ID);if(e===W.FLOOR?c=q().getFloorItemData(u):e===W.WALL&&(c=q().getWallItemData(u)),!c)break;i=c.id,n=c.name}break}case W.UNIT:{const l=s.userDataManager.getUserDataByIndex(t);if(!l)break;i=l.webID,n=l.name,o=l.type;break}}return!n||!n.length?null:new R0(t,e,i,n,o)}static getFurniInfo(t,e){const s=ie(),i=new vc(vc.FURNI);i.id=t,i.category=e;const n=tt().getRoomObject(s.roomId,t,e);if(!n)return;const o=n.model;o.getValue(Ms.INFOSTAND_EXTRA_PARAM)&&(i.extraParam=o.getValue(Ms.INFOSTAND_EXTRA_PARAM));const l=o.getValue(C.FURNITURE_DATA_FORMAT),c=Aa.getData(l);c.initializeFromRoomObjectModel(o),i.stuffData=c;const u=n.type;if(u.indexOf("poster")===0){const m=parseInt(u.replace("poster",""));i.name=f("${poster_"+m+"_name}"),i.description=f("${poster_"+m+"_desc}")}else{const m=o.getValue(C.FURNITURE_TYPE_ID);let I=null;e===W.FLOOR?I=q().getFloorItemData(m):e===W.WALL&&(I=q().getWallItemData(m)),I&&(i.name=I.name,i.description=I.description,i.purchaseOfferId=I.purchaseOfferId,i.purchaseCouldBeUsedForBuyout=I.purchaseCouldBeUsedForBuyout,i.rentOfferId=I.rentOfferId,i.rentCouldBeUsedForBuyout=I.rentCouldBeUsedForBuyout,i.availableForBuildersClub=I.availableForBuildersClub,i.tileSizeX=I.tileSizeX,i.tileSizeY=I.tileSizeY)}u.indexOf("post_it")>-1&&(i.isStickie=!0);const h=o.getValue(C.FURNITURE_EXPIRY_TIME),d=o.getValue(C.FURNITURE_EXPIRTY_TIMESTAMP);i.expiration=h<0?h:Math.max(0,h-(Pt()-d)/1e3);let g=tt().getRoomObjectImage(s.roomId,t,e,new j(180),64,null);(!g.data||g.data.width>140||g.data.height>200)&&(g=tt().getRoomObjectImage(s.roomId,t,e,new j(180),1,null)),i.image=g.getImage(),i.isWallItem=e===W.WALL,i.isRoomOwner=s.isRoomOwner,i.roomControllerLevel=s.controllerLevel,i.isAnyRoomController=q().isModerator,i.ownerId=o.getValue(C.FURNITURE_OWNER_ID),i.ownerName=o.getValue(C.FURNITURE_OWNER_NAME),i.usagePolicy=o.getValue(C.FURNITURE_USAGE_POLICY),i.rareValue=o.getValue(C.FURNITURE_RARE_VALUE),i.validRare=o.getValue(C.FURNITURE_VALID_RARE),i.winReason=o.getValue(C.FURNITURE_WIN_REASON);const E=o.getValue(C.FURNITURE_GUILD_CUSTOMIZED_GUILD_ID);return E!==0&&(i.groupId=E),Oi(n)&&(i.isOwner=!0),i}static getUserInfo(t,e){const s=ie();let i=Ls.OWN_USER;e.webID!==q().userId&&(i=Ls.PEER);const n=new Ls(i);n.isSpectatorMode=s.isSpectator,n.name=e.name,n.motto=e.custom,n.achievementScore=e.activityPoints,n.webID=e.webID,n.roomIndex=e.roomIndex,n.userType=be.USER;const o=tt().getRoomObject(s.roomId,e.roomIndex,t);if(o&&(n.carryItem=o.model.getValue(C.FIGURE_CARRY_OBJECT)||0),i===Ls.OWN_USER&&(n.allowNameChange=q().canChangeName),n.amIOwner=s.isRoomOwner,n.isGuildRoom=s.isGuildRoom,n.roomControllerLevel=s.controllerLevel,n.amIAnyRoomController=q().isModerator,n.isAmbassador=q().isAmbassador,i===Ls.PEER){if(o){const u=o.model.getValue(C.FIGURE_FLAT_CONTROL);u!==null&&(n.targetRoomControllerLevel=u),n.canBeMuted=this.canBeMuted(n),n.canBeKicked=this.canBeKicked(n),n.canBeBanned=this.canBeBanned(n)}n.isIgnored=q().isUserIgnored(e.name),n.respectLeft=q().respectsLeft;const l=q().isSystemShutdown,c=s.tradeMode;if(l)n.canTrade=!1;else switch(c){case qu.ROOM_CONTROLLER_REQUIRED:{const u=n.roomControllerLevel!==Oe.NONE&&n.roomControllerLevel!==Oe.GUILD_MEMBER,h=n.targetRoomControllerLevel!==Oe.NONE&&n.targetRoomControllerLevel!==Oe.GUILD_MEMBER;n.canTrade=u||h;break}case qu.NO_TRADING:n.canTrade=!0;break;default:n.canTrade=!1;break}n.canTradeReason=Ls.TRADE_REASON_OK,l&&(n.canTradeReason=Ls.TRADE_REASON_SHUTDOWN),c!==qu.FREE_TRADING&&(n.canTradeReason=Ls.TRADE_REASON_NO_TRADING)}return n.groupId=e.groupId,n.groupBadgeId=q().getGroupBadge(n.groupId),n.groupName=e.groupName,n.badges=s.userDataManager.getUserBadges(e.webID),n.figure=e.figure,n}static getBotInfo(t,e){const s=ie(),i=new Ls(Ls.BOT);i.name=e.name,i.motto=e.custom,i.webID=e.webID,i.roomIndex=e.roomIndex,i.userType=e.type;const n=tt().getRoomObject(s.roomId,e.roomIndex,t);return n&&(i.carryItem=n.model.getValue(C.FIGURE_CARRY_OBJECT)||0),i.amIOwner=s.isRoomOwner,i.isGuildRoom=s.isGuildRoom,i.roomControllerLevel=s.controllerLevel,i.amIAnyRoomController=q().isModerator,i.isAmbassador=q().isAmbassador,i.badges=[Ls.DEFAULT_BOT_BADGE_ID],i.figure=e.figure,i}static getRentableBotInfo(t,e){const s=ie(),i=new Pc(Pc.RENTABLE_BOT);i.name=e.name,i.motto=e.custom,i.webID=e.webID,i.roomIndex=e.roomIndex,i.ownerId=e.ownerId,i.ownerName=e.ownerName,i.botSkills=e.botSkills;const n=tt().getRoomObject(s.roomId,e.roomIndex,t);return n&&(i.carryItem=n.model.getValue(C.FIGURE_CARRY_OBJECT)||0),i.amIOwner=s.isRoomOwner,i.roomControllerLevel=s.controllerLevel,i.amIAnyRoomController=q().isModerator,i.badges=[Ls.DEFAULT_BOT_BADGE_ID],i.figure=e.figure,i}static getPetInfo(t){const e=ie(),s=e.userDataManager.getPetData(t.id);if(!s)return;const i=new La(s.figure);let n=null;i.typeId===xs.MONSTERPLANT&&(t.level>=t.adultLevel?n="std":n="grw"+t.level);const o=t.ownerId===q().userId,l=new Lc(Lc.PET_INFO);return l.name=s.name,l.id=t.id,l.ownerId=t.ownerId,l.ownerName=t.ownerName,l.rarityLevel=t.rarityLevel,l.petType=i.typeId,l.petBreed=i.paletteId,l.petFigure=s.figure,l.posture=n,l.isOwner=o,l.roomIndex=s.roomIndex,l.level=t.level,l.maximumLevel=t.maximumLevel,l.experience=t.experience,l.levelExperienceGoal=t.levelExperienceGoal,l.energy=t.energy,l.maximumEnergy=t.maximumEnergy,l.happyness=t.happyness,l.maximumHappyness=t.maximumHappyness,l.respect=t.respect,l.respectsPetLeft=q().respectsPetLeft,l.age=t.age,l.saddle=t.saddle,l.rider=t.rider,l.breedable=t.breedable,l.fullyGrown=t.fullyGrown,l.dead=t.dead,l.rarityLevel=t.rarityLevel,l.skillTresholds=t.skillTresholds,l.canRemovePet=!1,l.publiclyRideable=t.publiclyRideable,l.maximumTimeToLive=t.maximumTimeToLive,l.remainingTimeToLive=t.remainingTimeToLive,l.remainingGrowTime=t.remainingGrowTime,l.publiclyBreedable=t.publiclyBreedable,(o||e.isRoomOwner||q().isModerator||e.controllerLevel>=Oe.GUEST)&&(l.canRemovePet=!0),l}static checkGuildSetting(t){return t.isGuildRoom?t.roomControllerLevel>=Oe.GUILD_ADMIN:t.roomControllerLevel>=Oe.GUEST}static isValidSetting(t,e){const s=ie();if(!s.isPrivateRoom)return!1;const i=s.moderationSettings;let n=!1;return i&&(n=e(t,i)),n&&t.targetRoomControllerLevel<Oe.ROOM_OWNER}static canBeMuted(t){const e=(s,i)=>{switch(i.allowMute){case tr.MODERATION_LEVEL_USER_WITH_RIGHTS:return this.checkGuildSetting(s);default:return s.roomControllerLevel>=Oe.ROOM_OWNER}};return this.isValidSetting(t,e)}static canBeKicked(t){const e=(s,i)=>{switch(i.allowKick){case tr.MODERATION_LEVEL_ALL:return!0;case tr.MODERATION_LEVEL_USER_WITH_RIGHTS:return this.checkGuildSetting(s);default:return s.roomControllerLevel>=Oe.ROOM_OWNER}};return this.isValidSetting(t,e)}static canBeBanned(t){const e=(s,i)=>{switch(i.allowBan){case tr.MODERATION_LEVEL_USER_WITH_RIGHTS:return this.checkGuildSetting(s);default:return s.roomControllerLevel>=Oe.ROOM_OWNER}};return this.isValidSetting(t,e)}}const Ri=class Ri{};Ri.GENERIC_SKILL=0,Ri.DRESS_UP=1,Ri.SETUP_CHAT=2,Ri.RANDOM_WALK=3,Ri.DANCE=4,Ri.CHANGE_BOT_NAME=5,Ri.SERVE_BEVERAGE=6,Ri.INCLIENT_LINK=7,Ri.NUX_PROCEED=8,Ri.CHANGE_BOT_MOTTO=9,Ri.NUX_TAKE_TOUR=10,Ri.NO_PICK_UP=12,Ri.NAVIGATOR_SEARCH=14,Ri.DONATE_TO_USER=24,Ri.DONATE_TO_ALL=25;let Ke=Ri;const vE=class vE{constructor(t=-1,e=-1,s=-1,i="",n="",o="",l=null,c=0,u=0,h=null,d=null){this.senderId=t,this.senderCategory=e,this.roomId=s,this.text=i,this.formattedText=n,this.username=o,this.location=l,this.type=c,this.styleId=u,this.imageUrl=h,this.color=d,this.id=-1,this.width=0,this.height=0,this.elementRef=null,this.skipMovement=!1,this._top=0,this._left=0,this.id=++vE.BUBBLE_COUNTER}get top(){return this._top}set top(t){this._top=t,this.elementRef&&(this.elementRef.style.top=this._top+"px")}get left(){return this._left}set left(t){this._left=t,this.elementRef&&(this.elementRef.style.left=this._left+"px")}};vE.BUBBLE_COUNTER=0;let tS=vE;const Pd=class Pd{};Pd.CHAT_DEFAULT=0,Pd.CHAT_WHISPER=1,Pd.CHAT_SHOUT=2;let Oa=Pd;class RA{constructor(t=0,e=0,s=0,i=0){this.id=t,this.type=e,this.color=s,this.light=i}}const t8=(a,t,e,s=0)=>!(a.left+s+a.width<t.left+s||a.left+s>t.left+s+t.width||a.top+a.height<t.top+e||a.top>t.top+e+t.height),zu=class zu{static savePreset(t,e,s,i,n){ie().updateMoodlightData(t,e,s,i,n)}static changeState(){ie().toggleMoodlightState()}static previewDimmer(t,e,s){tt().updateObjectRoomColor(ie().roomId,t,e,s)}static scaleBrightness(t){return~~((t-this.MIN_BRIGHTNESS)*100/(this.MAX_BRIGHTNESS-this.MIN_BRIGHTNESS)+0)}};zu.AVAILABLE_COLORS=[7665141,21495,15161822,15353138,15923281,8581961,0],zu.HTML_COLORS=["#74F5F5","#0053F7","#E759DE","#EA4532","#F2F851","#82F349","#000000"],zu.MIN_BRIGHTNESS=76,zu.MAX_BRIGHTNESS=255;let on=zu;const e8=130,s8=100,i8=130,r8=100,n8=130,a8=100,S0=a=>{let t=0,e=0,s=0,i=0;for(;i<a.length;){switch(i%3){case 0:t=t+a.charCodeAt(i)*37;break;case 1:e=e+a.charCodeAt(i)*37;break;case 2:s=s+a.charCodeAt(i)*37;break}i++}return t=t%s8+e8,e=e%r8+i8,s=s%a8+n8,`rgb(${t},${e},${s})`},LE=class LE{static getMergedMannequinFigureContainer(t,e){const s=Gs().createFigureContainer(t),i=Gs().createFigureContainer(e);for(const n of this.MANNEQUIN_CLOTHING_PART_TYPES)s.removePart(n);for(const n of i.getPartTypeIds())s.updatePart(n,i.getPartSetId(n),i.getPartColorIds(n));return s}static transformAsMannequinFigure(t){for(const e of t.getPartTypeIds())this.MANNEQUIN_CLOTHING_PART_TYPES.indexOf(e)>=0||t.removePart(e);t.updatePart(this.MANNEQUIN_FIGURE[0],this.MANNEQUIN_FIGURE[1],this.MANNEQUIN_FIGURE[2])}};LE.MANNEQUIN_FIGURE=["hd",99999,[99998]],LE.MANNEQUIN_CLOTHING_PART_TYPES=[Kt.CHEST_ACCESSORY,Kt.COAT_CHEST,Kt.CHEST,Kt.LEGS,Kt.SHOES,Kt.WAIST_ACCESSORY];let eh=LE;const PE=class PE{};PE.WATER=0,PE.LIGHT=1;let SA=PE;const UE=class UE{};UE.POSTURE_STAND=0,UE.POSTURE_SIT=1;let Df=UE;class nu{constructor(t,e,s){this._id=t,this._category=e,this._name=s}get id(){return this._id}get category(){return this._category}get name(){return this._name}}class o8{constructor(t,e,s,i,n,o,l){this.id=t,this.category=e,this.name=s,this.requestRoomObjectId=i,this.targetRoomObjectId=n,this.requestInventoryStripId=o,this.replace=l}}const bf="0",O0="1",Qo=class Qo{};Qo.UNSTARTED=-1,Qo.ENDED=0,Qo.PLAYING=1,Qo.PAUSED=2,Qo.BUFFERING=3,Qo.CUED=5;let sl=Qo;function rr(a){k(new mU(a))}const N_=a=>{const t=Math.floor(a/2);return a%2?(t+.5).toString():t.toString()},Le=class Le{};Le.TOGGLE_FURNI_STATE=0,Le.RESET=1,Le.SET_FURNI_STATE=3,Le.MOVE_FURNI=4,Le.GIVE_SCORE=6,Le.CHAT=7,Le.TELEPORT=8,Le.JOIN_TEAM=9,Le.LEAVE_TEAM=10,Le.CHASE=11,Le.FLEE=12,Le.MOVE_AND_ROTATE_FURNI=13,Le.GIVE_SCORE_TO_PREDEFINED_TEAM=14,Le.TOGGLE_TO_RANDOM_STATE=15,Le.MOVE_FURNI_TO=16,Le.GIVE_REWARD=17,Le.CALL_ANOTHER_STACK=18,Le.KICK_FROM_ROOM=19,Le.MUTE_USER=20,Le.BOT_TELEPORT=21,Le.BOT_MOVE=22,Le.BOT_TALK=23,Le.BOT_GIVE_HAND_ITEM=24,Le.BOT_FOLLOW_AVATAR=25,Le.BOT_CHANGE_FIGURE=26,Le.BOT_TALK_DIRECT_TO_AVTR=27,Le.GIVE_SCORE_CUSTOM=28,Le.FREEZE=29,Le.ONE_CONDITION_TRUE=30,Le.GIVE_REWARD_CUSTOM=31;let ke=Le;const ze=class ze{};ze.STATES_MATCH=0,ze.FURNIS_HAVE_AVATARS=1,ze.ACTOR_IS_ON_FURNI=2,ze.TIME_ELAPSED_MORE=3,ze.TIME_ELAPSED_LESS=4,ze.USER_COUNT_IN=5,ze.ACTOR_IS_IN_TEAM=6,ze.HAS_STACKED_FURNIS=7,ze.STUFF_TYPE_MATCHES=8,ze.STUFFS_IN_FORMATION=9,ze.ACTOR_IS_GROUP_MEMBER=10,ze.ACTOR_IS_WEARING_BADGE=11,ze.ACTOR_IS_WEARING_EFFECT=12,ze.NOT_STATES_MATCH=13,ze.FURNI_NOT_HAVE_HABBO=14,ze.NOT_ACTOR_ON_FURNI=15,ze.NOT_USER_COUNT_IN=16,ze.NOT_ACTOR_IN_TEAM=17,ze.NOT_HAS_STACKED_FURNIS=18,ze.NOT_FURNI_IS_OF_TYPE=19,ze.NOT_STUFFS_IN_FORMATION=20,ze.NOT_ACTOR_IN_GROUP=21,ze.NOT_ACTOR_WEARS_BADGE=22,ze.NOT_ACTOR_WEARING_EFFECT=23,ze.DATE_RANGE_ACTIVE=24,ze.ACTOR_HAS_HANDITEM=25,ze.ONE_CONDITION_TRUE=30;let is=ze;const OA=a=>`${a.getFullYear()}/${("0"+(a.getMonth()+1)).slice(-2)}/${("0"+a.getDate()).slice(-2)} ${("0"+a.getHours()).slice(-2)}:${("0"+a.getMinutes()).slice(-2)}`,Ku=class Ku{};Ku.STUFF_SELECTION_OPTION_NONE=0,Ku.STUFF_SELECTION_OPTION_BY_ID=1,Ku.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE=2,Ku.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT=3;let xt=Ku;const l8=`
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
uniform mat3 projectionMatrix;
varying vec2 vTextureCoord;
void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,c8=`
varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec3 lineColor;
uniform vec3 color;
void main(void) {
    vec4 currentColor = texture2D(uSampler, vTextureCoord);
    vec3 colorLine = lineColor * currentColor.a;
    vec3 colorOverlay = color * currentColor.a;

    if(currentColor.r == 0.0 && currentColor.g == 0.0 && currentColor.b == 0.0 && currentColor.a > 0.0) {
        gl_FragColor = vec4(colorLine.r, colorLine.g, colorLine.b, currentColor.a);
    } else if(currentColor.a > 0.0) {
        gl_FragColor = vec4(colorOverlay.r, colorOverlay.g, colorOverlay.b, currentColor.a);
    }
}`;class u8 extends WN{constructor(t,e){super(l8,c8),this.uniforms.lineColor=new Float32Array(3),this.uniforms.color=new Float32Array(3),this.lineColor=t,this.color=e}get lineColor(){return this._lineColor}set lineColor(t){const e=this.uniforms.lineColor;typeof t=="number"?(ii.hex2rgb(t,e),this._lineColor=t):(e[0]=t[0],e[1]=t[1],e[2]=t[2],this._lineColor=ii.rgb2hex(e))}get color(){return this._color}set color(t){const e=this.uniforms.color;typeof t=="number"?(ii.hex2rgb(t,e),this._color=t):(e[0]=t[0],e[1]=t[1],e[2]=t[2],this._color=ii.rgb2hex(e))}}const an=class an{static show(t){an.applySelectionShader(an.getRoomObject(t))}static hide(t){an.clearSelectionShader(an.getRoomObject(t))}static clearSelectionShaderFromFurni(t){for(const e of t)an.clearSelectionShader(an.getRoomObject(e))}static applySelectionShaderToFurni(t){for(const e of t)an.applySelectionShader(an.getRoomObject(e))}static getRoomObject(t){const e=tt();return e.getRoomObject(e.activeRoomId,t,W.FLOOR)}static applySelectionShader(t){if(!t)return;const e=t.visualization;if(e)for(const s of e.sprites)s.blendMode!==1&&(s.filters=[an._selectionShader])}static clearSelectionShader(t){if(!t)return;const e=t.visualization;if(e)for(const s of e.sprites)s.filters=[]}};an._selectionShader=new u8([1,1,1],[.6,.6,.6]);let Tc=an;const Eh="	",xi=class xi{};xi.AVATAR_SAYS_SOMETHING=0,xi.AVATAR_WALKS_ON_FURNI=1,xi.AVATAR_WALKS_OFF_FURNI=2,xi.EXECUTE_ONCE=3,xi.TOGGLE_FURNI=4,xi.EXECUTE_PERIODICALLY=6,xi.AVATAR_ENTERS_ROOM=7,xi.GAME_STARTS=8,xi.GAME_ENDS=9,xi.SCORE_ACHIEVED=10,xi.COLLISION=11,xi.EXECUTE_PERIODICALLY_LONG=12,xi.BOT_REACHED_STUFF=13,xi.BOT_REACHED_AVATAR=14;let Ni=xi;const H=a=>{const{ref:t=null,innerRef:e=null,display:s=null,fit:i=!1,fitV:n=!1,grow:o=!1,shrink:l=!1,fullWidth:c=!1,fullHeight:u=!1,overflow:h=null,position:d=null,float:g=null,pointer:E=!1,visible:m=null,textColor:I=null,classNames:p=[],className:T="",style:R={},children:S=null,...b}=a,N=_.useMemo(()=>{const F=[];return s&&s.length&&F.push("d-"+s),(i||c)&&F.push("w-100"),(i||u)&&F.push("h-100"),n&&F.push("vw-100","vh-100"),o&&F.push("flex-grow-1"),l&&F.push("flex-shrink-0"),h&&F.push("overflow-"+h),d&&F.push("position-"+d),g&&F.push("float-"+g),E&&F.push("cursor-pointer"),m!==null&&F.push(m?"visible":"invisible"),I&&F.push("text-"+I),p.length&&F.push(...p),F},[s,i,n,o,l,c,u,h,d,g,E,m,I,p]),P=_.useMemo(()=>{let F=N.join(" ");return T.length&&(F+=" "+T),F.trim()},[N,T]),B=_.useMemo(()=>{let F={};return Object.keys(R).length&&(F={...F,...R}),F},[R]);return r.jsx("div",{ref:e,className:P,style:B,...b,children:S})},C0=_.createContext({isCssGrid:!1}),h8=a=>r.jsx(C0.Provider,{value:a.value,children:a.children}),d8=()=>_.useContext(C0),_t=a=>{const{inline:t=!1,gap:e=2,maxContent:s=!1,columnCount:i=0,center:n=!1,alignSelf:o=null,alignItems:l=null,justifyContent:c=null,fullHeight:u=!0,classNames:h=[],style:d={},...g}=a,E=_.useMemo(()=>{const I=[];return t?I.push("inline-grid"):I.push("grid"),e?I.push("gap-"+e):e===0&&I.push("gap-0"),s&&I.push("flex-basis-max-content"),o&&I.push("align-self-"+o),l&&I.push("align-items-"+l),c&&I.push("justify-content-"+c),!l&&!c&&n&&I.push("align-items-center","justify-content-center"),h.length&&I.push(...h),I},[t,e,s,o,l,c,n,h]),m=_.useMemo(()=>{let I={};return i&&(I["--bs-columns"]=i.toString()),Object.keys(d).length&&(I={...I,...d}),I},[i,d]);return r.jsx(h8,{value:{isCssGrid:!0},children:r.jsx(H,{fullHeight:u,classNames:E,style:m,...g})})},Ce=a=>{const{columnMinWidth:t=40,columnMinHeight:e=40,columnCount:s=0,fullHeight:i=!1,maxContent:n=!0,overflow:o="auto",style:l={},...c}=a,u=_.useMemo(()=>{let h={};return h["--nitro-grid-column-min-height"]=e+"px",s>1&&(h.gridTemplateColumns=`repeat(auto-fill, minmax(${t}px, 1fr))`),Object.keys(l).length&&(h={...h,...l}),h},[t,e,s,l]);return r.jsx(_t,{columnCount:s,fullHeight:i,overflow:o,style:u,...c})},M=a=>{const{display:t="flex",column:e=void 0,reverse:s=!1,gap:i=null,center:n=!1,alignSelf:o=null,alignItems:l=null,justifyContent:c=null,classNames:u=[],...h}=a,d=_.useMemo(()=>{const g=[];return e?s?g.push("flex-column-reverse"):g.push("flex-column"):s&&g.push("flex-row-reverse"),i&&g.push("gap-"+i),o&&g.push("align-self-"+o),l&&g.push("align-items-"+l),c&&g.push("justify-content-"+c),!l&&!c&&n&&g.push("align-items-center","justify-content-center"),u.length&&g.push(...u),g},[e,s,i,n,o,l,c,u]);return r.jsx(H,{display:t,classNames:d,...h})},V=a=>{const{variant:t="primary",size:e="sm",active:s=!1,disabled:i=!1,classNames:n=[],...o}=a,l=_.useMemo(()=>{const c=["btn"];return t&&c.push("btn-"+t),e&&c.push("btn-"+e),s&&c.push("active"),i&&c.push("disabled"),n.length&&c.push(...n),c},[t,e,s,i,n]);return r.jsx(M,{center:!0,classNames:l,...o})},Da=a=>{const{classNames:t=[],...e}=a,s=_.useMemo(()=>{const i=["btn-group"];return t.length&&i.push(...t),i},[t]);return r.jsx(H,{classNames:s,...e})},A0=_.createContext({closers:null,setClosers:null,closeAll:null}),_8=a=>r.jsx(A0.Provider,{...a}),g8=()=>_.useContext(A0),vf=a=>{const{alignItems:t="center",gap:e=1,children:s=null,...i}=a;return r.jsx(M,{alignItems:t,gap:e,...i,children:s})},Lf=a=>{const{headerText:t="",isExpanded:e=!1,gap:s=0,classNames:i=[],children:n=null,...o}=a,[l,c]=_.useState(!1),{setClosers:u=null,closeAll:h=null}=g8(),d=()=>{h(),c(m=>!m)},g=_.useCallback(()=>c(!1),[]),E=_.useMemo(()=>{const m=["nitro-card-accordion-set"];return l&&m.push("active"),i&&i.length&&m.push(...i),m},[l,i]);return _.useEffect(()=>{c(e)},[e]),_.useEffect(()=>{const m=g;return u(I=>{const p=[...I];return p.push(m),p}),()=>{u(I=>{const p=[...I],T=p.indexOf(m);return T>=0&&p.splice(T,1),p})}},[g,u]),r.jsxs(A,{classNames:E,gap:s,...o,children:[r.jsxs(M,{pointer:!0,justifyContent:"between",className:"nitro-card-accordion-set-header px-2 py-1",onClick:d,children:[r.jsx(O,{children:t}),l&&r.jsx(aS,{className:"fa-icon"}),!l&&r.jsx(oS,{className:"fa-icon"})]}),l&&r.jsx(A,{fullHeight:!0,overflow:"auto",gap:0,className:"nitro-card-accordion-set-content",children:n})]})},f8=a=>{const{...t}=a,[e,s]=_.useState([]),i=_.useCallback(()=>{for(const n of e)n()},[e]);return r.jsx(_8,{value:{closers:e,setClosers:s,closeAll:i},children:r.jsx(A,{gap:0,...t})})},pt=a=>{const{overflow:t="auto",classNames:e=[],...s}=a,i=_.useMemo(()=>{const n=["container-fluid","content-area"];return e.length&&n.push(...e),n},[e]);return r.jsx(A,{classNames:i,overflow:t,...s})},m8=_.createContext({theme:null}),E8=a=>r.jsx(m8.Provider,{value:a.value,children:a.children}),St=a=>{const{headerText:t=null,isGalleryPhoto:e=!1,noCloseButton:s=!1,onReportPhoto:i=null,onCloseClick:n=null,justifyContent:o="center",alignItems:l="center",classNames:c=[],children:u=null,...h}=a,d=_.useMemo(()=>{const E=["drag-handler","container-fluid","nitro-card-header"];return c.length&&E.push(...c),E},[c]),g=E=>{E.stopPropagation(),E.nativeEvent.stopImmediatePropagation()};return r.jsx(A,{center:!0,position:"relative",classNames:d,...h,children:r.jsxs(M,{fullWidth:!0,center:!0,children:[r.jsx("span",{className:"nitro-card-header-text",children:t}),e&&r.jsx(H,{position:"absolute",className:"end-4 nitro-card-header-report-camera",onClick:i,children:r.jsx(vj,{className:"fa-icon"})}),r.jsx(M,{center:!0,position:"absolute",className:"end-2 nitro-card-header-close",onMouseDownCapture:g,onClick:n,children:r.jsx(zr,{className:"fa-icon w-12 h-12"})})]})})},N0=a=>{const{justifyContent:t="center",classNames:e=[],variant:s="muted",...i}=a,n=_.useMemo(()=>{const o=["container-fluid","p-1"];return e.length&&o.push(...e),o.push("bg-"+s),o},[e,s]);return r.jsx(M,{justifyContent:t,classNames:n,...i})},Xu=class Xu{};Xu.CENTER="DWP_CENTER",Xu.TOP_CENTER="DWP_TOP_CENTER",Xu.TOP_LEFT="DWP_TOP_LEFT",Xu.NOTHING="DWP_NOTHING";let ri=Xu;const ka=[],CA=0,AA=0,ml=a=>{const{uniqueKey:t=null,handleSelector:e=".drag-handler",windowPosition:s=ri.CENTER,disableDrag:i=!1,dragStyle:n={},children:o=null,offsetLeft:l=0,offsetTop:c=0}=a,[u,h]=_.useState(null),[d,g]=_.useState(null),[E,m]=_.useState({x:0,y:0}),[I,p]=_.useState(!1),[T,R]=_.useState(null),S=_.useRef(),b=_.useCallback(()=>{let J=400;for(const Ct of ka)J+=1,Ct.style.zIndex=J.toString()},[]),N=_.useCallback(()=>{const J=ka.indexOf(S.current);if(J===-1)ka.push(S.current);else{if(J===ka.length-1)return;J>=0&&(ka.splice(J,1),ka.push(S.current))}b()},[b]),P=_.useCallback(J=>{N()},[N]),B=_.useCallback(J=>{N()},[N]),F=_.useCallback((J,Ct)=>{m({x:J,y:Ct}),p(!0)},[]),w=_.useCallback(J=>{F(J.clientX,J.clientY)},[F]),U=_.useCallback(J=>{const Ct=J.touches[0];F(Ct.clientX,Ct.clientY)},[F]),G=_.useCallback(J=>{h({x:J.clientX-E.x,y:J.clientY-E.y})},[E]),K=_.useCallback(J=>{const Ct=J.touches[0];h({x:Ct.clientX-E.x,y:Ct.clientY-E.y})},[E]),z=_.useCallback(()=>{if(!S.current||!T)return;let J=d.x+u.x,Ct=d.y+u.y;const At=S.current.offsetLeft+J,se=S.current.offsetTop+Ct;if(se<CA?Ct=-S.current.offsetTop:se+T.offsetHeight>=document.body.offsetHeight-CA&&(Ct=document.body.offsetHeight-S.current.offsetHeight-S.current.offsetTop),At+S.current.offsetWidth<AA?J=-S.current.offsetLeft:At>=document.body.offsetWidth-AA&&(J=document.body.offsetWidth-S.current.offsetWidth-S.current.offsetLeft),h({x:0,y:0}),g({x:J,y:Ct}),p(!1),t!==null){const ve={...Af(`nitro.windows.${t}`)};ve.offset={x:J,y:Ct},m0(`nitro.windows.${t}`,ve)}},[T,u,d,t]),et=_.useCallback(J=>{z()},[z]),rt=_.useCallback(J=>{z()},[z]);return _.useEffect(()=>{const J=S.current;if(!J)return;if(ka.push(J),b(),!i){const se=J.querySelector(e);se&&R(se)}let Ct=0,At=0;switch(s){case ri.TOP_CENTER:J.style.top=50+c+"px",J.style.left=`calc(50vw - ${J.offsetWidth/2+l}px)`;break;case ri.CENTER:J.style.top=`calc(50vh - ${J.offsetHeight/2+c}px)`,J.style.left=`calc(50vw - ${J.offsetWidth/2+l}px)`;break;case ri.TOP_LEFT:J.style.top=50+c+"px",J.style.left=50+l+"px";break}return h({x:0,y:0}),g({x:Ct,y:At}),()=>{const se=ka.indexOf(J);se>=0&&ka.splice(se,1)}},[e,s,t,i,l,c,b]),_.useEffect(()=>{if(!d&&!u)return;const J=S.current;J&&(J.style.transform=`translate(${d.x+u.x}px, ${d.y+u.y}px)`,J.style.visibility="visible")},[d,u]),_.useEffect(()=>{if(T)return T.addEventListener(at.MOUSE_DOWN,w),T.addEventListener(Zi.TOUCH_START,U),()=>{T.removeEventListener(at.MOUSE_DOWN,w),T.removeEventListener(Zi.TOUCH_START,U)}},[T,w,U]),_.useEffect(()=>{if(I)return document.addEventListener(at.MOUSE_UP,et),document.addEventListener(Zi.TOUCH_END,rt),document.addEventListener(at.MOUSE_MOVE,G),document.addEventListener(Zi.TOUCH_MOVE,K),()=>{document.removeEventListener(at.MOUSE_UP,et),document.removeEventListener(Zi.TOUCH_END,rt),document.removeEventListener(at.MOUSE_MOVE,G),document.removeEventListener(Zi.TOUCH_MOVE,K)}},[I,et,G,rt,K]),_.useEffect(()=>{if(!t)return;const J=Af(`nitro.windows.${t}`);!J||!J.offset||(h({x:0,y:0}),J.offset&&g(J.offset))},[t]),lS.createPortal(r.jsx(H,{position:"absolute",innerRef:S,className:"draggable-window",onMouseDownCapture:P,onTouchStartCapture:B,style:n,children:o}),document.getElementById("draggable-windows-container"))},Ot=a=>{const{theme:t="primary",uniqueKey:e=null,handleSelector:s=".drag-handler",windowPosition:i=ri.CENTER,disableDrag:n=!1,overflow:o="hidden",position:l="relative",gap:c=0,classNames:u=[],...h}=a,d=_.useRef(),g=_.useMemo(()=>{const E=["nitro-card","rounded","shadow"];return E.push(`theme-${t||"primary"}`),u.length&&E.push(...u),E},[t,u]);return r.jsx(E8,{value:{theme:t},children:r.jsx(ml,{uniqueKey:e,handleSelector:s,windowPosition:i,disableDrag:n,children:r.jsx(A,{innerRef:d,overflow:o,position:l,gap:c,classNames:g,...h})})})},ls=a=>{const{figure:t="",gender:e="M",headOnly:s=!1,direction:i=0,scale:n=1,classNames:o=[],style:l={},...c}=a,[u,h]=_.useState(null),[d,g]=_.useState(-1),E=_.useRef(!1),m=_.useMemo(()=>{const p=["avatar-image"];return o.length&&p.push(...o),p},[o]),I=_.useMemo(()=>{let p={};return u&&u.length&&(p.backgroundImage=`url('${u}')`),n!==1&&(p.transform=`scale(${n})`,n%1||(p.imageRendering="pixelated")),Object.keys(l).length&&(p={...p,...l}),p},[u,n,l]);return _.useEffect(()=>{const p=Gs().createAvatarImage(t,kr.LARGE,e,{resetFigure:S=>{E.current||g(Math.random())},dispose:()=>{},disposed:!1},null);if(!p)return;let T=si.FULL;s&&(T=si.HEAD),p.setDirection(T,i);const R=p.getCroppedImage(T);R&&h(R.src),p.dispose()},[t,e,i,s,d]),_.useEffect(()=>(E.current=!1,()=>{E.current=!0}),[]),r.jsx(H,{classNames:m,style:I,...c})},x0=a=>{const{imageUrl:t=null,fit:e=!0,style:s=null,...i}=a,n=_.useMemo(()=>{const o={...s};return t&&(o.background=`url(${t}) center no-repeat`),o},[s,t]);return r.jsx(H,{fit:e,style:n,...i})},Ge=a=>{const{badgeCode:t=null,isGroup:e=!1,showInfo:s=!1,customTitle:i=null,isGrayscale:n=!1,scale:o=1,classNames:l=[],style:c={},children:u=null,...h}=a,[d,g]=_.useState(null),E=_.useMemo(()=>{const I=["badge-image"];return e&&I.push("group-badge"),n&&I.push("grayscale"),l.length&&I.push(...l),I},[l,e,n]),m=_.useMemo(()=>{let I={};return d&&(I.backgroundImage=`url(${e?d.src:it("badge.asset.url").replace("%badgename%",t.toString())})`,I.width=d.width,I.height=d.height,o!==1&&(I.transform=`scale(${o})`,o%1||(I.imageRendering="pixelated"),I.width=d.width*o,I.height=d.height*o)),Object.keys(c).length&&(I={...I,...c}),I},[d,o,c]);return _.useEffect(()=>{if(!t||!t.length)return;let I=!1;const p=R=>{if(R.badgeId!==t)return;const S=Ee.generateImage(new Xe(R.image));S.onload=()=>g(S),I=!0,q().events.removeEventListener(Eo.IMAGE_READY,p)};q().events.addEventListener(Eo.IMAGE_READY,p);const T=e?q().getGroupBadgeImage(t):q().getBadgeImage(t);if(T&&!I){const R=Ee.generateImage(new Xe(T));R.onload=()=>g(R)}return()=>q().events.removeEventListener(Eo.IMAGE_READY,p)},[t,e]),r.jsxs(H,{classNames:E,style:m,...h,children:[s&&it("badge.descriptions.enabled",!0)&&r.jsxs(H,{className:"badge-information text-black py-1 px-2 small",children:[r.jsx("div",{className:"fw-bold mb-1",children:e?i:gh(t)}),r.jsx("div",{children:e?f("group.badgepopup.body"):MO(t)})]}),u]})},p8=a=>{const{day:t="00",hour:e="00",minutes:s="00",seconds:i="00",classNames:n=[],children:o=null,...l}=a,c=_.useMemo(()=>{const u=["nitro-counter-time"];return n.length&&u.push(...n),u},[n]);return r.jsxs(M,{gap:1,children:[r.jsx(H,{classNames:c,...l,children:r.jsxs("div",{children:[t!="00"?t:e,t!="00"?f("countdown_clock_unit_days"):f("countdown_clock_unit_hours")]})}),r.jsx(H,{style:{marginTop:"3px"},children:":"}),r.jsx(H,{classNames:c,...l,children:r.jsxs("div",{children:[s,f("countdown_clock_unit_minutes")]})}),r.jsx(H,{style:{marginTop:"3px"},children:":"}),r.jsx(H,{classNames:c,...l,children:r.jsxs("div",{children:[i,f("countdown_clock_unit_seconds")]})}),o]})},ps=a=>{const{type:t="",classNames:e=[],style:s={},...i}=a,n=_.useMemo(()=>{const c=["nitro-currency-icon"];return e.length&&c.push(...e),c},[e]),o=_.useMemo(()=>{let c=it("currency.asset.icon.url","");return c=c.replace("%type%",t.toString()),`url(${c})`},[t]),l=_.useMemo(()=>{let c={};return c.backgroundImage=o,Object.keys(s).length&&(c={...c,...s}),c},[s,o]);return r.jsx(H,{classNames:n,style:l,...i})},LO=a=>{const{productType:t="s",productClassId:e=-1,direction:s=2,extraData:i="",scale:n=1,style:o={},...l}=a,[c,u]=_.useState(null),h=_.useMemo(()=>{var g;let d={};return(g=c==null?void 0:c.src)!=null&&g.length&&(d.backgroundImage=`url('${c.src}')`,d.width=c.width,d.height=c.height),n!==1&&(d.transform=`scale(${n})`,n%1||(d.imageRendering="pixelated")),Object.keys(o).length&&(d={...d,...o}),d},[c,n,o]);return _.useEffect(()=>{let d=null;const g={imageReady:(E,m,I)=>{!I&&m&&(I=Ee.generateImage(m)),I.onload=()=>u(I)},imageFailed:null};switch(t.toLocaleLowerCase()){case Yt.FLOOR:d=tt().getFurnitureFloorImage(e,new j(s),64,g,0,i);break;case Yt.WALL:d=tt().getFurnitureWallImage(e,new j(s),64,g,0,i);break}if(d){const E=d.getImage();E.onload=()=>u(E)}},[t,e,s,i]),c?r.jsx(H,{classNames:["furni-image"],style:h,...l}):null},M0=a=>{const{figure:t=null,userName:e=null,message:s=null,editable:i=!1,onChange:n=null}=a;return r.jsxs(M,{overflow:"hidden",className:"nitro-gift-card text-black",children:[r.jsxs("div",{className:"d-flex align-items-center justify-content-center gift-face flex-shrink-0",children:[!e&&r.jsx("div",{className:"gift-incognito"}),t&&r.jsx("div",{className:"gift-avatar",children:r.jsx(ls,{figure:t,direction:2,headOnly:!0})})]}),r.jsx(M,{overflow:"hidden",className:"w-100 pt-4 pb-4 pe-4 ps-3",children:r.jsxs(A,{grow:!0,overflow:"auto",justifyContent:"between",children:[!i&&r.jsx(O,{textBreak:!0,className:"gift-message",children:s}),i&&n!==null&&r.jsx("textarea",{className:"gift-message h-100",maxLength:140,value:s,onChange:o=>n(o.target.value),placeholder:f("catalog.gift_wrapping_new.message_hint")}),e&&r.jsx(O,{italics:!0,textEnd:!0,className:"pe-1",children:f("catalog.gift_wrapping_new.message_from",["name"],[e])})]})})]})},A=a=>{const{size:t=0,offset:e=0,column:s=!0,gap:i=2,classNames:n=[],...o}=a,{isCssGrid:l=!1}=d8(),c=_.useMemo(()=>{const u=[];if(t){let h=`col-${t}`;l&&(h=`g-${h}`),u.push(h)}if(e){let h=`offset-${e}`;l&&(h=`g-start-${e}`),u.push(h)}return n.length&&u.push(...n),u},[t,e,l,n]);return r.jsx(M,{classNames:c,column:s,gap:i,...o})},cl=a=>{const{count:t=0,position:e="absolute",classNames:s=[],children:i=null,...n}=a,o=_.useMemo(()=>{const l=["badge","border","border-black","bg-danger","px-1","nitro-item-count"];return s.length&&l.push(...s),l},[s]);return r.jsxs(H,{position:"absolute",classNames:o,...n,children:[t,i]})},__=a=>{const{value:t=0}=a,e=t.toString().split("");return r.jsx(r.Fragment,{children:e.map((s,i)=>r.jsx("i",{className:"limited-edition-number n-"+s},i))})},y0=a=>{const{uniqueNumber:t=0,uniqueSeries:e=0,classNames:s=[],children:i=null,...n}=a,o=_.useMemo(()=>{const l=["unique-compact-plate","z-index-1"];return s.length&&l.push(...s),l},[s]);return r.jsxs(H,{classNames:o,...n,children:[r.jsx("div",{children:r.jsx(__,{value:t})}),r.jsx("div",{children:r.jsx(__,{value:e})}),i]})},I8=a=>{const{uniqueLimitedItemsLeft:t=0,uniqueLimitedSeriesSize:e=0,classNames:s=[],...i}=a,n=_.useMemo(()=>{const o=["unique-complete-plate"];return s.length&&o.push(...s),o},[s]);return r.jsx(H,{classNames:n,...i,children:r.jsxs(A,{className:"plate-container",gap:0,children:[r.jsxs(M,{justifyContent:"between",alignItems:"center",children:[f("unique.items.left"),r.jsx("div",{children:r.jsx(__,{value:t})})]}),r.jsxs(M,{justifyContent:"between",alignItems:"center",children:[f("unique.items.number.sold"),r.jsx("div",{children:r.jsx(__,{value:e})})]})]})})},ee=a=>{const{itemImage:t=void 0,itemColor:e=void 0,itemActive:s=!1,itemCount:i=1,itemCountMinimum:n=1,itemUniqueSoldout:o=!1,itemUniqueNumber:l=-2,itemUnseen:c=!1,itemHighlight:u=!1,disabled:h=!1,center:d=!0,column:g=!0,style:E={},classNames:m=[],position:I="relative",overflow:p="hidden",children:T=null,...R}=a,S=_.useMemo(()=>{const N=["layout-grid-item","border","border-2","border-muted","rounded"];return s&&N.push("active"),(o||l>0)&&N.push("unique-item"),o&&N.push("sold-out"),c&&N.push("unseen"),u&&N.push("has-highlight"),h&&N.push("disabled"),t===null&&N.push("icon","loading-icon"),m.length&&N.push(...m),N},[s,o,l,c,u,h,t,m]),b=_.useMemo(()=>{let N={...E};return t&&!(o||l>0)&&(N.backgroundImage=`url(${t})`),e&&(N.backgroundColor=e),Object.keys(E).length&&(N={...N,...E}),N},[E,t,e,o,l]);return r.jsxs(A,{center:d,pointer:!0,position:I,overflow:p,column:g,classNames:S,style:b,...R,children:[i>n&&r.jsx(cl,{count:i}),l>0&&r.jsxs(r.Fragment,{children:[r.jsx(H,{fit:!0,className:"unique-bg-override",style:{backgroundImage:`url(${t})`}}),r.jsx("div",{className:"position-absolute bottom-0 unique-item-counter",children:r.jsx(__,{value:l})})]}),T]})},Ga=a=>{const{imageUrl:t=null,className:e="",...s}=a;return r.jsx("img",{src:t,className:"no-select "+e,alt:"",...s})},PO=a=>{const{...t}=a;return r.jsxs(H,{classNames:["spinner-container"],...t,children:[r.jsx(H,{className:"spinner"}),r.jsx(H,{className:"spinner"}),r.jsx(H,{className:"spinner"})]})},T8=a=>{const{roomId:t=-1,textureReceiver:e=null,onClose:s=null}=a,i=_.useRef(),n=()=>{if(!i||!i.current)return null;const l=i.current.getBoundingClientRect();return new YN(Math.floor(l.x),Math.floor(l.y),Math.floor(l.width),Math.floor(l.height))},o=()=>{Ua(ja.CAMERA_SHUTTER),e(tt().createTextureFromRoom(t,1,n()))};return r.jsx(ml,{handleSelector:".nitro-room-thumbnail-camera",children:r.jsxs("div",{className:"nitro-room-thumbnail-camera px-2",children:[r.jsx("div",{ref:i,className:"camera-frame"}),r.jsxs("div",{className:"d-flex align-items-end h-100 pb-2",children:[r.jsx("button",{className:"btn btn-sm btn-danger w-100 mb-1 me-2",onClick:s,children:f("cancel")}),r.jsx("button",{className:"btn btn-sm btn-success w-100 mb-1",onClick:o,children:f("navigator.thumbeditor.save")})]})]})})},x_=a=>{const{title:t="",onClose:e=null,classNames:s=[],children:i=null,type:n=Bt.DEFAULT,...o}=a,l=_.useMemo(()=>{const c=["nitro-alert"];return c.push("nitro-alert-"+n),s.length&&c.push(...s),c},[s,n]);return r.jsxs(Ot,{classNames:l,...o,children:[r.jsx(St,{headerText:t,onCloseClick:e}),r.jsx(pt,{grow:!0,justifyContent:"between",overflow:"hidden",className:"text-black",gap:0,children:i})]})},Ea=class Ea{};Ea.BOUNCE="bounce",Ea.SLIDE_LEFT="slideLeft",Ea.SLIDE_RIGHT="slideRight",Ea.FLIP_X="flipX",Ea.FADE_IN="fadeIn",Ea.FADE_DOWN="fadeDown",Ea.FADE_UP="fadeUp",Ea.HEAD_SHAKE="headShake";let $i=Ea;function R8(a,t,e=300){switch(a){case $i.BOUNCE:switch(t){default:return{};case No:return{animationName:"bounceIn",animationDuration:`${e}ms`};case Al:return{animationName:"bounceOut",animationDuration:`${e}ms`}}case $i.SLIDE_LEFT:switch(t){default:return{};case No:return{animationName:"slideInLeft",animationDuration:`${e}ms`};case Al:return{animationName:"slideOutLeft",animationDuration:`${e}ms`}}case $i.SLIDE_RIGHT:switch(t){default:return{};case No:return{animationName:"slideInRight",animationDuration:`${e}ms`};case Al:return{animationName:"slideOutRight",animationDuration:`${e}ms`}}case $i.FLIP_X:switch(t){default:return{};case No:return{animationName:"flipInX",animationDuration:`${e}ms`};case Al:return{animationName:"flipOutX",animationDuration:`${e}ms`}}case $i.FADE_UP:switch(t){default:return{};case No:return{animationName:"fadeInUp",animationDuration:`${e}ms`};case Al:return{animationName:"fadeOutDown",animationDuration:`${e}ms`}}case $i.FADE_IN:switch(t){default:return{};case No:return{animationName:"fadeIn",animationDuration:`${e}ms`};case Al:return{animationName:"fadeOut",animationDuration:`${e}ms`}}case $i.FADE_DOWN:switch(t){default:return{};case No:return{animationName:"fadeInDown",animationDuration:`${e}ms`};case Al:return{animationName:"fadeOutUp",animationDuration:`${e}ms`}}case $i.HEAD_SHAKE:switch(t){default:return{};case No:return{animationName:"headShake",animationDuration:`${e}ms`}}}return null}const M_=a=>{const{type:t=null,inProp:e=!1,timeout:s=300,className:i=null,children:n=null}=a,[o,l]=_.useState(!1);return _.useEffect(()=>{let c=null;return e?l(!0):c=setTimeout(()=>{l(!1),clearTimeout(s)},s),()=>{c&&clearTimeout(c)}},[e,s]),r.jsx(Lj,{in:e,timeout:s,children:c=>r.jsx("div",{className:(i??"")+" animate__animated",style:{...R8(t,c,s)},children:o&&n})})},UO=a=>{const{style:t=null,fadesOut:e=!0,timeoutMs:s=8e3,onClose:i=null,overflow:n="hidden",classNames:o=[],...l}=a,[c,u]=_.useState(!1),h=_.useMemo(()=>{const d=["nitro-notification-bubble","rounded"];return o.length&&d.push(...o),d},[o]);return _.useEffect(()=>(u(!0),()=>u(!1)),[]),_.useEffect(()=>{if(!e)return;const d=setTimeout(()=>{u(!1),setTimeout(()=>i(),300)},s);return()=>clearTimeout(d)},[e,s,i]),r.jsx(M_,{type:$i.FADE_IN,inProp:c,timeout:300,children:r.jsx(M,{style:t,overflow:n,classNames:h,onClick:i,...l})})},Ca=a=>{const{figure:t="",typeId:e=-1,paletteId:s=-1,petColor:i=16777215,customParts:n=[],posture:o="std",headOnly:l=!1,direction:c=0,scale:u=1,style:h={},...d}=a,[g,E]=_.useState(null),[m,I]=_.useState(0),[p,T]=_.useState(0),R=_.useRef(!1),S=_.useMemo(()=>{let b={};return g&&g.length&&(b.backgroundImage=`url(${g})`),u!==1&&(b.transform=`scale(${u})`,u%1||(b.imageRendering="pixelated")),b.width=m,b.height=p,Object.keys(h).length&&(b={...b,...h}),b},[g,u,h,m,p]);return _.useEffect(()=>{let b=e,N=s,P=i,B=n,F=l;if(t&&t.length){const U=new La(t);b=U.typeId,N=U.paletteId,P=U.color,B=U.customParts}b===16&&(F=!1);const w=tt().getRoomObjectPetImage(b,N,P,new j(c*45),64,{imageReady:(U,G,K)=>{R.current||(K?(E(K.src),I(K.width),T(K.height)):G&&(E(Ee.generateImageUrl(G)),I(G.width),T(G.height)))},imageFailed:U=>{}},F,0,B,o);if(w){const U=w.getImage();U&&(E(U.src),I(U.width),T(U.height))}},[t,e,s,i,n,o,l,c]),_.useEffect(()=>(R.current=!1,()=>{R.current=!0}),[]),r.jsx(H,{classNames:["pet-image"],style:S,...d})},jO=a=>{const{text:t="",progress:e=0,maxProgress:s=100,position:i="relative",justifyContent:n="center",classNames:o=[],children:l=null,...c}=a,u=_.useMemo(()=>{const h=["nitro-progress-bar","text-white"];return o.length&&h.push(...o),h},[o]);return r.jsxs(A,{position:i,justifyContent:n,classNames:u,...c,children:[t&&t.length>0&&r.jsx(M,{fit:!0,center:!0,position:"absolute",className:"nitro-progress-bar-text small",children:t}),r.jsx(H,{className:"nitro-progress-bar-inner",style:{width:~~((e-0)*100/(s-0)+0)+"%"}}),l]})},wO=a=>{const{level:t=0,classNames:e=[],children:s=null,...i}=a,n=_.useMemo(()=>{const o=["nitro-rarity-level"];return e.length&&o.push(...e),o},[e]);return r.jsxs(H,{classNames:n,...i,children:[r.jsx("div",{children:t}),s]})},op=a=>{const{roomPreviewer:t=null,height:e=0,children:s=null}=a,[i,n]=_.useState(null),o=_.useRef(),l=c=>{t&&(c.shiftKey?t.changeRoomObjectDirection():t.changeRoomObjectState())};return _.useEffect(()=>{if(!t)return;const c=h=>{!t||!i||!o.current||(t.updatePreviewRoomView(),i.canvasUpdated&&(o.current.style.backgroundImage=`url(${Ee.generateImageUrl(i.master)})`))};if(!i&&o.current&&t){let d=document.defaultView.getComputedStyle(o.current,null).backgroundColor;d=ii.rgbStringToHex(d),d=d.replace("#","0x"),t.backgroundColor=parseInt(d,16);const g=o.current.parentElement.clientWidth;t.getRoomCanvas(g,e);const E=t.getRenderingCanvas();n(E),E.canvasUpdated=!0,c()}fi().add(c);const u=new ResizeObserver(()=>{if(!t||!o.current)return;const h=o.current.parentElement.offsetWidth;t.modifyRoomCanvas(h,e),c()});return u.observe(o.current),()=>{u.disconnect(),fi().remove(c)}},[i,t,o,e]),r.jsxs("div",{className:"room-preview-container",children:[r.jsx("div",{ref:o,className:"room-preview-image",style:{height:e},onClick:l}),s]})},lp=a=>{const{roomId:t=-1,customUrl:e=null,shrink:s=!0,overflow:i="hidden",classNames:n=[],children:o=null,...l}=a,c=_.useMemo(()=>{const h=["room-thumbnail","rounded","border"];return n.length&&h.push(...n),h},[n]),u=_.useMemo(()=>e&&e.length?e:it("thumbnails.url").replace("%thumbnail%",t.toString()),[e,t]);return r.jsxs(H,{shrink:s,overflow:i,classNames:c,...l,children:[u&&r.jsx("img",{alt:"",src:u}),o]})},D0=a=>{const{color:t="",message:e="",date:s="",senderName:i="",customTitle:n=null,onCloseClick:o=null}=a;return r.jsx(ml,{handleSelector:".drag-handler",children:r.jsxs(A,{gap:0,alignItems:"center",className:`nitro-layout-trophy trophy-${t}`,children:[r.jsxs(M,{center:!0,fullWidth:!0,position:"relative",className:"trophy-header drag-handler",children:[r.jsx(H,{position:"absolute",pointer:!0,className:"trophy-close",onClick:o}),r.jsx(O,{bold:!0,children:f("widget.furni.trophy.title")})]}),r.jsxs(A,{className:"trophy-content py-1",gap:1,children:[n&&r.jsx(O,{bold:!0,children:n}),e]}),r.jsxs(M,{alignItems:"center",justifyContent:"between",className:"trophy-footer mt-1",children:[r.jsx(O,{bold:!0,children:s}),r.jsx(O,{bold:!0,children:i})]})]})})},Cr=a=>{const{userId:t=0,userName:e=null,classNames:s=[],pointer:i=!0,children:n=null,...o}=a,l=_.useMemo(()=>{const c=["nitro-friends-spritesheet","icon-profile-sm"];return s.length&&c.push(...s),c},[s]);return r.jsx(H,{classNames:l,pointer:i,onClick:c=>rr(t),...o,children:n})},Wn=a=>{const{isActive:t=!1,count:e=0,overflow:s="hidden",position:i="relative",pointer:n=!0,classNames:o=[],children:l=null,...c}=a,u=_.useMemo(()=>{const h=["nav-item","rounded-top","border"];return t&&h.push("active"),o.length&&h.push(...o),h},[t,o]);return r.jsxs(M,{overflow:s,pointer:n,position:i,classNames:u,...c,children:[r.jsx(M,{shrink:!0,center:!0,children:l}),e>0&&r.jsx(cl,{count:e})]})},Ro=a=>{const{justifyContent:t="center",gap:e=1,classNames:s=[],children:i=null,...n}=a,o=_.useMemo(()=>{const l=["container-fluid","nitro-card-tabs","pt-1"];return s.length&&l.push(...s),l},[s]);return r.jsx(M,{justifyContent:t,gap:e,classNames:o,...n,children:i})},qs=(...a)=>a.filter(Boolean).join(" "),S8=a=>{const{classNames:t=[],...e}=a,s=_.useMemo(()=>{const i=["form-group"];return t.length&&i.push(...t),i},[t]);return r.jsx(M,{classNames:s,...e})},O8=a=>{const{variant:t="black",height:e=1,classNames:s=[],style:i={},...n}=a,o=_.useMemo(()=>{const c=[];return t&&c.push("bg-"+t),s.length&&c.push(...s),c},[t,s]),l=_.useMemo(()=>{let c={display:"list-item"};return e>0&&(c.height=e),Object.keys(i).length&&(c={...c,...i}),c},[e,i]);return r.jsx(H,{classNames:o,style:l,...n})},cp=a=>{var c;const{rows:t=[],overscan:e=5,scrollToBottom:s=!1,rowRender:i=null}=a;_.useState(t.length-1);const n=_.useRef(null),o=Pj({count:t.length,overscan:e,getScrollElement:()=>n.current,estimateSize:()=>45}),l=o.getVirtualItems();return r.jsx(H,{fit:!0,innerRef:n,position:"relative",overflow:"auto",children:r.jsx("div",{style:{height:o.getTotalSize(),width:"100%",position:"relative"},children:r.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",transform:`translateY(${((c=l[0])==null?void 0:c.start)??0}px)`},children:l.map(u=>r.jsx("div",{"data-index":u.index,ref:o.measureElement,children:i(t[u.index])},u.key))})})})},O=a=>{const{variant:t="black",fontWeight:e=null,fontSize:s=0,align:i=null,bold:n=!1,underline:o=!1,italics:l=!1,truncate:c=!1,center:u=!1,textEnd:h=!1,small:d=!1,wrap:g=!1,noWrap:E=!1,textBreak:m=!1,...I}=a,p=_.useMemo(()=>{const T=["d-inline"];return t&&T.push("text-"+t),n&&T.push("fw-bold"),e&&T.push("fw-"+e),s&&T.push("fs-"+s),i&&T.push("text-"+i),o&&T.push("text-decoration-underline"),l&&T.push("fst-italic"),c&&T.push("text-truncate"),u&&T.push("text-center"),h&&T.push("text-end"),d&&T.push("small"),g&&T.push("text-wrap"),E&&T.push("text-nowrap"),m&&T.push("text-break"),T},[t,e,s,i,n,o,l,c,u,h,d,g,E,m]);return r.jsx(H,{classNames:p,...I})},C8=a=>{const{isError:t=!1,message:e="",percent:s=0}=a;return r.jsx(A,{fullHeight:!0,position:"relative",className:"nitro-loading",children:r.jsx(H,{fullHeight:!0,className:"container h-100",children:r.jsxs(A,{fullHeight:!0,alignItems:"center",justifyContent:"end",children:[r.jsx(H,{className:"connecting-duck"}),r.jsx(A,{size:6,className:"loading-container text-center py-4",children:t&&e&&e.length?r.jsx(H,{className:"fs-4 text-shadow",children:e}):r.jsxs(r.Fragment,{children:[r.jsxs(O,{fontSize:4,variant:"white",className:"text-shadow",children:[s.toFixed(),"%"]}),r.jsx(jO,{progress:s,className:"mt-2"})]})})]})})})},So=(a,t,e,s=!0)=>{_.useEffect(()=>{if(s)return Array.isArray(a)?a.map(i=>t.addEventListener(i,e)):t.addEventListener(a,e),()=>{Array.isArray(a)?a.map(i=>t.removeEventListener(i,e)):t.removeEventListener(a,e)}},[a,t,s,e])},NA=(a,t)=>So(a,qq().events,t),A8=(a,t)=>So(a,Jt().cameraManager.events,t),N8=(a,t)=>So(a,Jt().localization.events,t),xl=(a,t)=>So(a,Jt().events,t),ne=(a,t)=>So(a,tt().events,t),we=(a,t)=>So(a,Fc().events,t),x8=(a,t)=>So(a,q().events,t),Pl=(a,t,e=!0)=>So(a,Jt().soundManager.events,t,e),Y=(a,t)=>{_.useEffect(()=>{const e=new a(t);return n_().registerMessageEvent(e),()=>n_().removeMessageEvent(e)},[a,t])},Is=(a,t,e=!0)=>So(a,Pa,t,e),M8=()=>{const[a,t]=_.useState(!0),[e,s]=_.useState([]),[i,n]=_.useState(null),[o,l]=_.useState(-1),[c,u]=_.useState(0),h=_.useMemo(()=>{let T=0;return e.forEach(R=>T+=Sr.getAchievementCategoryTotalUnseen(R)),T},[e]),d=_.useMemo(()=>{let T=0;return e.forEach(R=>T+=R.getProgress()),T},[e]),g=_.useMemo(()=>{let T=0;return e.forEach(R=>T+=R.getMaxProgress()),T},[e]),E=_.useMemo(()=>~~((d-0)*100/(g-0)+0),[d,g]),m=_.useMemo(()=>i===null?null:e.find(T=>T.code===i),[e,i]),I=_.useMemo(()=>o===-1||!m?null:m.achievements.find(T=>T.achievementId===o),[m,o]),p=_.useCallback((T,R)=>{s(S=>{const b=[...S];for(const N of b)if(N.code===T)for(const P of N.achievements)P.achievementId===R&&(P.unseen=0);return b})},[]);return Y(MM,T=>{const S=T.getParser().achievement;s(b=>{const N=[...b],P=N.findIndex(B=>B.code===S.category);if(P===-1){const B=new lA(S.category);B.achievements.push(S),N.push(B)}else{const B=ji(N[P]),F=[...B.achievements],w=F.findIndex(G=>G.achievementId===S.achievementId);let U=null;w===-1?F.push(S):(U=F[w],F[w]=S),Sr.getAchievementIsIgnored(S)||(S.unseen++,U&&(S.unseen+=U.unseen)),B.achievements=F,N[P]=B}return N})}),Y(yM,T=>{const R=T.getParser(),S=[];for(const b of R.achievements){const N=b.category;let P=S.find(B=>B.code===N);P||(P=new lA(N),S.push(P)),P.achievements.push(b)}s(S)}),Y(DM,T=>{const R=T.getParser();u(R.score)}),_.useEffect(()=>{a&&(k(new mb),t(!1))},[a]),_.useEffect(()=>{!i||o===-1||p(i,o)},[i,o,p]),{achievementCategories:e,selectedCategoryCode:i,setSelectedCategoryCode:n,selectedAchievementId:o,setSelectedAchievementId:l,achievementScore:c,getTotalUnseen:h,getProgress:d,getMaxProgress:g,scaledProgressPercent:E,selectedCategory:m,selectedAchievement:I,setAchievementSeen:p}},up=()=>Ts(M8),y8=()=>{const[a,t]=_.useState([]),[e,s]=_.useState([]),[i,n]=_.useState(-1),[o,l]=_.useState(10),[c,u]=_.useState(null);return A8(Bd.INITIALIZED,h=>{t(Array.from(Uh().effects.values()))}),Y(Ax,h=>{const d=h.getParser();u({credits:d.creditPrice,duckets:d.ducketPrice,publishDucketPrice:d.publishDucketPrice})}),_.useEffect(()=>{if(!Uh().isLoaded){Uh().init(),k(new Ob);return}},[]),{availableEffects:a,cameraRoll:e,setCameraRoll:s,selectedPictureIndex:i,setSelectedPictureIndex:n,myLevel:o,price:c}},b0=()=>Ts(y8),yn=class yn extends kt{};yn.SHOW_CATALOG="CE_SHOW_CATALOG",yn.HIDE_CATALOG="CE_HIDE_CATALOG",yn.TOGGLE_CATALOG="CE_TOGGLE_CATALOG",yn.SOLD_OUT="CE_SOLD_OUT",yn.APPROVE_NAME_RESULT="CE_APPROVE_NAME_RESULT",yn.PURCHASE_APPROVED="CE_PURCHASE_APPROVED",yn.INIT_GIFT="CE_INIT_GIFT",yn.CATALOG_RESET="CE_RESET",yn.CATALOG_INVISIBLE_PAGE_VISITED="CE_CATALOG_INVISIBLE_PAGE_VISITED";let Uc=yn;class D8 extends Uc{constructor(t,e,s){super(Uc.INIT_GIFT),this._pageId=t,this._offerId=e,this._extraData=s}get pageId(){return this._pageId}get offerId(){return this._offerId}get extraData(){return this._extraData}}const jE=class jE extends Uc{constructor(t){super(jE.POST_MARKETPLACE),this._item=t}get item(){return this._item}};jE.POST_MARKETPLACE="CE_POST_MARKETPLACE";let Pf=jE;const wE=class wE extends kt{constructor(t){super(wE.PURCHASE_SUCCESS),this._purchase=t}get purchase(){return this._purchase}};wE.PURCHASE_SUCCESS="CPE_PURCHASE_SUCCESS";let wa=wE;const FE=class FE extends kt{constructor(t){super(FE.PURCHASE_FAILED),this._code=t}get code(){return this._code}};FE.PURCHASE_FAILED="CPFE_PURCHASE_FAILED";let _l=FE;const GE=class GE extends kt{constructor(t){super(GE.NOT_ALLOWED),this._code=t}get code(){return this._code}};GE.NOT_ALLOWED="CPNAE_NOT_ALLOWED";let g_=GE;const Ns=class Ns extends kt{};Ns.WIDGETS_INITIALIZED="CWE_CWE_WIDGETS_INITIALIZED",Ns.SELECT_PRODUCT="CWE_SELECT_PRODUCT",Ns.SET_EXTRA_PARM="CWE_CWE_SET_EXTRA_PARM",Ns.PURCHASE="CWE_PURCHASE",Ns.COLOUR_ARRAY="CWE_COLOUR_ARRAY",Ns.MULTI_COLOUR_ARRAY="CWE_MULTI_COLOUR_ARRAY",Ns.COLOUR_INDEX="CWE_COLOUR_INDEX",Ns.TEXT_INPUT="CWE_TEXT_INPUT",Ns.DROPMENU_SELECT="CWE_CWE_DROPMENU_SELECT",Ns.PURCHASE_OVERRIDE="CWE_PURCHASE_OVERRIDE",Ns.SELLABLE_PET_PALETTES="CWE_SELLABLE_PET_PALETTES",Ns.UPDATE_ROOM_PREVIEW="CWE_UPDATE_ROOM_PREVIEW",Ns.GUILD_SELECTED="CWE_GUILD_SELECTED",Ns.TOTAL_PRICE_WIDGET_INITIALIZED="CWE_TOTAL_PRICE_WIDGET_INITIALIZED",Ns.PRODUCT_OFFER_UPDATED="CWE_CWE_PRODUCT_OFFER_UPDATED",Ns.SET_PREVIEWER_STUFFDATA="CWE_CWE_SET_PREVIEWER_STUFFDATA",Ns.EXTRA_PARAM_REQUIRED_FOR_BUY="CWE_CWE_EXTRA_PARAM_REQUIRED_FOR_BUY",Ns.TOGGLE="CWE_CWE_TOGGLE",Ns.BUILDER_SUBSCRIPTION_UPDATED="CWE_CWE_BUILDER_SUBSCRIPTION_UPDATED",Ns.ROOM_CHANGED="CWE_CWE_ROOM_CHANGED",Ns.SHOW_WARNING_TEXT="CWE_CWE_SHOW_WARNING_TEXT";let xA=Ns;const BE=class BE extends kt{constructor(){super(BE.SOLD_OUT)}};BE.SOLD_OUT="CPSOE_SOLD_OUT";let f_=BE;const kE=class kE extends kt{constructor(t,e){super(kE.UPDATE_STUFF_DATA),this._offer=t,this._stuffData=e}get offer(){return this._offer}get stuffData(){return this._stuffData}};kE.UPDATE_STUFF_DATA="SRPSA_UPDATE_STUFF_DATA";let MA=kE;const nc=class nc extends kt{};nc.SHOW_GUIDE_TOOL="GTE_SHOW_GUIDE_TOOL",nc.HIDE_GUIDE_TOOL="GTE_HIDE_GUIDE_TOOL",nc.TOGGLE_GUIDE_TOOL="GTE_TOGGLE_GUIDE_TOOL",nc.CREATE_HELP_REQUEST="GTE_CREATE_HELP_REQUEST",nc.CREATE_BULLY_REQUEST="GTE_CREATE_BULLY_REQUEST";let Er=nc;const AC=class AC extends kt{};AC.INIT="HC_NAME_CHANGE_INIT";let m_=AC;const VE=class VE extends kt{constructor(t,e,s){super(VE.FURNI_ADDED),this.id=t,this.spriteId=e,this.category=s}};VE.FURNI_ADDED="IFAE_FURNI_ADDED";let E_=VE;const Ud=class Ud extends kt{};Ud.SHOW_THUMBNAIL="NE_SHOW_THUMBNAIL",Ud.HIDE_THUMBNAIL="NE_HIDE_THUMBNAIL",Ud.TOGGLE_THUMBNAIL="NE_TOGGLE_THUMBNAIL";let Ra=Ud;const yA=a=>a&&a.length?a.replace(/\\r/g,"\r"):"",DA=a=>{const t="0"+a;return t.substr(t.length-2,t.length)};let Ch=null;const b8=()=>{const[a,t]=_.useState([]),[e,s]=_.useState([]),[i,n]=_.useState([]),[o,l]=_.useState(!1),[c,u]=_.useState(!1),h=()=>it("notification",{}),d=w=>{const U=h();return U?U[w]:null},g=(w,U,G,K)=>{if(w.has(G))return w.get(G);const z=["notification",U,G].join(".");return Jt().localization.hasValue(z)||K?f(z,Array.from(w.keys()),Array.from(w.values())):null},E=(w,U)=>{let G=w.get("image");return G||(G=it("image.library.notifications.url","").replace("%image%",U.replace(/\./g,"_"))),f(G)},m=_.useCallback((w,U=null,G=null,K=null,z=null,et=null)=>{(!z||!z.length)&&(z=f("notifications.broadcast.title")),(!U||!U.length)&&(U=Bt.DEFAULT);const rt=new jh([yA(w)],U,G,K,z,et);t(J=>[rt,...J])},[]),I=_.useCallback(()=>m(null,Bt.NITRO),[m]),p=_.useCallback((w,U,G=null,K=null,z="#1c1c20f2")=>{if(o)return;const et=new $R(w,U,G,K,z);s(rt=>[et,...rt])},[o]),T=(w,U=null)=>{U||(U=new Map);const G=d("notification."+w);if(G)for(const Ct in G)U.set(Ct,G[Ct]);w==="floorplan_editor.error"&&U.set("message",U.get("message").replace(/[^a-zA-Z._ ]/g,""));const K=g(U,w,"title",!0),z=g(U,w,"message",!0).replace(/\\r/g,"\r"),et=g(U,w,"linkTitle",!1),rt=g(U,w,"linkUrl",!1),J=E(U,w);if(U.get("display")==="BUBBLE"){const Ct=g(U,w,"color",!1);p(f(z),bi.INFO,J,rt,Ct)}else m(f(z),w,rt,et,K,J);U.get("sound")&&Ua(U.get("sound"))},R=_.useCallback((w,U,G,K=null,z=null,et=null,rt=null)=>{(!K||!K.length)&&(K=f("generic.confirm")),(!z||!z.length)&&(z=f("generic.cancel")),(!et||!et.length)&&(et=f("notifications.broadcast.title"));const J=new ZR(rt,w,U,G,K,z,et);n(Ct=>[J,...Ct])},[]),S=(w,U=null,G=!0)=>{m(w,Bt.DEFAULT,U,f("mod.alert.link"),f("mod.alert.title"))},b=_.useCallback((w,U="")=>{switch(w){case Ji.ALERT_SCAM:m(f("inventory.trading.warning.other_not_offering"),null,null,null,f("inventory.trading.notification.title"));return;case Ji.HOTEL_TRADING_DISABLED:case Ji.YOU_NOT_ALLOWED:case Ji.THEY_NOT_ALLOWED:case Ji.ROOM_DISABLED:case Ji.YOU_OPEN:case Ji.THEY_OPEN:m(f(`inventory.trading.openfail.${w}`,["otherusername"],[U]),null,null,null,f("inventory.trading.openfail.title"));return;case Ji.ERROR_WHILE_COMMIT:m(`${f("inventory.trading.notification.caption")}, ${f("inventory.trading.notification.commiterror.info")}`,null,null,null,f("inventory.trading.notification.title"));return;case Ji.THEY_CANCELLED:m(f("inventory.trading.info.closed"),null,null,null,f("inventory.trading.notification.title"));return}},[m]),N=_.useCallback(w=>{t(U=>{const G=[...U],K=G.findIndex(z=>w===z);return K>=0&&G.splice(K,1),G})},[]),P=_.useCallback(w=>{s(U=>{const G=[...U],K=G.findIndex(z=>w===z);return K>=0&&G.splice(K,1),G})},[]),B=_.useCallback(w=>{n(U=>{const G=[...U],K=G.findIndex(z=>w===z);return K>=0&&G.splice(K,1),G})},[]);Y(QS,w=>{const U=w.getParser();if(U.userId!==q().userId)return;const G=f("notifications.text.respect.1"),K=f("notifications.text.respect.2",["count"],[U.respectsReceived.toString()]);p(G,bi.RESPECT),p(K,bi.RESPECT)}),Y(Fy,w=>{const U=w.getParser();m(U.message.replace(/\\r/g,"\r"),null,null,f("notifications.broadcast.title"))}),Y(Py,w=>{const U=w.getParser(),G=f("achievements.levelup.desc"),K=gh(U.data.badgeCode),z=q().getBadgeUrl(U.data.badgeCode),et="questengine/achievements/"+U.data.category;p(G+" "+K,bi.ACHIEVEMENT,z,et)}),Y(jy,w=>{const U=w.getParser();U.numGifts<=0||p(U.numGifts.toString(),bi.CLUBGIFT,null,"catalog/open/"+it("catalog.links")["hc.hc_gifts"])}),Y(hy,w=>{const U=w.getParser();S(U.message,U.url,!1)}),Y(kS,w=>{const U=w.getParser();if(U.amountChanged<=0||U.type!==5)return;const G=it("currency.asset.icon.url","").replace("%type%",U.type.toString());p(f("notifications.text.loyalty.received",["AMOUNT"],[U.amountChanged.toString()]),bi.INFO,G)}),Y(Ey,w=>{const U=w.getParser();S(U.message)}),Y(dx,w=>{const U=w.getParser();m(f("opening.hours."+(U.userThrowOutAtClose?"disconnected":"closed"),["h","m"],[DA(U.openHour),DA(U.openMinute)]),Bt.DEFAULT,null,null,f("opening.hours.title"))}),Y(GM,w=>{const U=w.getParser(),G=f("notifications.text."+(U.boughtAsGift?"petbought":"petreceived"));let K=null;const z=tt().getRoomObjectPetImage(U.pet.typeId,U.pet.paletteId,parseInt(U.pet.color,16),new j(45*3),64,null,!0);z&&(K=z.getImage().src),p(G,bi.PETLEVEL,K)}),Y(zy,w=>{const U=w.getParser(),G=new jh([],Bt.TABLE,null,null,f("notifications.motd.title"),null,U.columns,U.rows);t(K=>[G,...K])}),Y(By,w=>{const G=w.getParser().messages.map(z=>yA(z)),K=new jh(G,Bt.MOTD,null,null,f("notifications.motd.title"));t(z=>[K,...z])}),Y(Vy,w=>{const U=w.getParser();let G=null;const K=tt().getRoomObjectPetImage(U.figureData.typeId,U.figureData.paletteId,parseInt(U.figureData.color,16),new j(45*3),64,null,!0);K&&(G=K.getImage().src),p(f("notifications.text.petlevel",["pet_name","level"],[U.petName,U.level.toString()]),bi.PETLEVEL,G)}),Y(Gy,w=>{const U=w.getParser();l(!U.enabled)}),Y(Px,w=>{const U=w.getParser();if(!U.products||!U.products.length)return;const G=U.products[0];G&&p(f("notifications.text.club_gift.selected"),bi.INFO,ag.getProductImageUrl(G.productType,G.furniClassId,G.extraParam))}),Y(gx,w=>{const U=w.getParser();m(f("maintenance.shutdown",["m","d"],[U.minutesUntilMaintenance.toString(),U.duration.toString()]),Bt.DEFAULT,null,null,f("opening.hours.title"))}),Y(cy,w=>{const U=w.getParser();S(U.message,U.url)}),Y(ky,w=>{const U=w.getParser();T(U.type,U.parameters)}),Y(_x,w=>{const U=w.getParser();m(f("opening.hours.shutdown",["m"],[U.openMinute.toString()]),Bt.DEFAULT,null,null,f("opening.hours.title"))}),Y(hx,w=>{const U=w.getParser();m(f("opening.hours.disconnected",["h","m"],[U.openHour.toString(),U.openMinute.toString()]),Bt.DEFAULT,null,null,f("opening.hours.title"))}),Y(wy,w=>{const U=w.getParser();switch(U.errorCode){default:case 0:m(f("connection.server.error.desc",["errorCode"],[U.errorCode.toString()]),Bt.ALERT,null,null,f("connection.server.error.title"));break;case 1001:case 1002:case 1003:case 1004:case 1005:case 1006:case 1007:case 1008:case 1009:case 1010:case 1011:case 1012:case 1013:case 1014:case 1015:case 1016:case 1017:case 1018:case 1019:w.connection.dispose();break;case 4013:m(f("connection.room.maintenance.desc"),Bt.ALERT,null,null,f("connection.room.maintenance.title"));break}}),Y(Wy,w=>{const U=w.getParser();m(f(U.alertMessage),Bt.DEFAULT,null,null,f(U.titleMessage?U.titleMessage:"notifications.broadcast.title"))});const F=_.useCallback(()=>{if(!c)if(Br.isRunning()){if(Ch)return;Ch=setTimeout(()=>{F()},Br.totalRunningTime+5e3)}else Ch&&(clearTimeout(Ch),Ch=null),p(f("mod.chatdisclaimer"),bi.INFO),u(!0)},[c,p]);return Y(Kg,F),{alerts:a,bubbleAlerts:e,confirms:i,simpleAlert:m,showNitroAlert:I,showNotification:T,showTradeAlert:b,showConfirm:R,showSingleBubble:p,closeAlert:N,closeBubbleAlert:P,closeConfirm:B}},He=()=>Ts(b8),v8=(a,t)=>{const[e,s]=_.useState(()=>{if(typeof window>"u")return t;try{return Af(a)??t}catch{return t}});return[e,n=>{try{const o=n instanceof Function?n(e):n;s(o),typeof window<"u"&&m0(a,o)}catch(o){dt.error(o)}}]},hp=v8,L8=()=>hp(c_.CATALOG_PLACE_MULTIPLE_OBJECTS,!1),v0=()=>Ts(L8),P8=()=>hp(c_.CATALOG_SKIP_PURCHASE_CONFIRMATION,!1),L0=()=>Ts(P8),U8=-12345678,j8=()=>{const[a,t]=_.useState(!1),[e,s]=_.useState(!1),[i,n]=_.useState(-1),[o,l]=_.useState(-1),[c,u]=_.useState(ln.NORMAL),[h,d]=_.useState(null),[g,E]=_.useState(null),[m,I]=_.useState(null),[p,T]=_.useState(null),[R,S]=_.useState([]),[b,N]=_.useState(null),[P,B]=_.useState([]),[F,w]=_.useState(null),[U,G]=_.useState(!1),[K,z]=_.useState({quantity:1,extraData:null,extraParamRequired:!1,previewStuffData:null}),[et,rt]=_.useState({}),[J,Ct]=_.useState(!1),[At,se]=v0(),[ve,ss]=L0(),[qe,ni]=_.useState(null),[ge,Rs]=_.useState(null),[mi,pe]=_.useState(0),[Wt,We]=_.useState(0),[Be,In]=_.useState(0),[pl,Th]=_.useState(0),[Ut,It]=_.useState(0),[jt,Vs]=_.useState(0),{simpleAlert:xr=null}=He(),Ai=_.useRef(new Ll),b_=_.useCallback(()=>{n(-1),l(-1),d(null),E(null),I(null),T(null),S([]),N(null),B([]),t(!1)},[]),Rh=_.useCallback($=>{if(!$)return Wa.MISSING_OFFER;if(mi<0||mi>=Wt)return Wa.FURNI_LIMIT_REACHED;const st=ie();if(!st)return Wa.NOT_IN_ROOM;if(!st.isRoomOwner)return Wa.NOT_ROOM_OWNER;if(pl<=0){const ot=tt();let yt=ot.getRoomObjectCount(st.roomId,W.UNIT);for(;yt>0;){const fe=ot.getRoomObjectByIndex(st.roomId,yt,W.UNIT),Ye=st.userDataManager.getUserDataByIndex(fe.id);if(Ye&&Ye.type===be.USER&&Ye.roomIndex!==st.ownRoomIndex&&!Ye.isModerator)return Wa.VISITORS_IN_ROOM;yt--}}return Wa.OKAY},[mi,Wt,pl]),Sh=_.useCallback($=>{const st=ie();return!!((st&&$.page&&$.page.layoutCode!=="sold_ltd_items"&&c===ln.NORMAL&&(st.isRoomOwner||st.isGuildRoom&&st.controllerLevel>=Oe.GUILD_MEMBER)||c===ln.BUILDER&&Rh($)===Wa.OKAY)&&$.pricingModel!==_i.PRICING_MODEL_BUNDLE&&$.product.productType!==Yt.EFFECT&&$.product.productType!==Yt.HABBO_CLUB)},[c,Rh]),Il=_.useCallback($=>{if(!Sh($))return;const st=$.product;if(!st)return;let ot=0;switch(st.productType){case Yt.FLOOR:ot=W.FLOOR;break;case Yt.WALL:ot=W.WALL;break}tt().processRoomObjectPlacement(hl.CATALOG,-$.offerId,ot,st.productClassId,st.extraParam)&&(ni($),Ct(!0),t(!1))},[Sh]),Vc=_.useCallback(($,st)=>{const ot=tt();let yt=ot.getRoomInstanceVariable(ot.activeRoomId,C.ROOM_WALL_TYPE),fe=ot.getRoomInstanceVariable(ot.activeRoomId,C.ROOM_FLOOR_TYPE),Ye=ot.getRoomInstanceVariable(ot.activeRoomId,C.ROOM_LANDSCAPE_TYPE);switch(yt=yt&&yt.length?yt:"101",fe=fe&&fe.length?fe:"101",Ye=Ye&&Ye.length?Ye:"1.1",$){case"floor":ot.updateRoomInstancePlaneType(ot.activeRoomId,st,yt,Ye,!0);return;case"wallpaper":ot.updateRoomInstancePlaneType(ot.activeRoomId,fe,st,Ye,!0);return;case"landscape":ot.updateRoomInstancePlaneType(ot.activeRoomId,fe,yt,st,!0);return;default:ot.updateRoomInstancePlaneType(ot.activeRoomId,fe,yt,Ye,!0);return}},[]),Tl=_.useCallback(()=>{qe&&(tt().cancelRoomObjectInsert(),Ct(!1),ni(null))},[qe]),Rl=_.useCallback(($=!0)=>{Ct(st=>(st&&$&&ut("catalog/open"),!1))},[]),Oh=_.useCallback(($=!1)=>{$||Rl(),Rs(st=>{if(st)switch(st.category){case W.FLOOR:tt().removeRoomObjectFloor(st.roomId,st.objectId);break;case W.WALL:{switch(st.furniData.className){case"floor":case"wallpaper":case"landscape":Vc("reset","");break;default:tt().removeRoomObjectWall(st.roomId,st.objectId);break}break}default:tt().deleteRoomObject(st.objectId,st.category);break}return null})},[Rl,Vc]),Sl=_.useCallback(($,st)=>{if(st.pageId===$&&st!==h)return st;for(const ot of st.children){const yt=Sl($,ot);if(yt)return yt}return null},[h]),Ao=_.useCallback(($,st)=>{if(st.pageName===$&&st!==h)return st;for(const ot of st.children){const yt=Ao($,ot);if(yt)return yt}return null},[h]),Ol=_.useCallback(($,st=!1)=>{if(!g||!g.size)return null;if(st){const ot=[],yt=g.get($);if(yt&&yt.length)for(const fe of yt)fe.isVisible&&ot.push(fe);if(ot.length)return ot}return g.get($)},[g]),Bi=_.useCallback(($,st)=>{$<0||(s(!0),n($),$>-1&&k(new bb($,st,c)))},[c]),Cl=_.useCallback(($,st,ot,yt,fe,Ye)=>{const zs=new Sf($,st,ot,yt,Ye);if(I(zs),l($t=>$!==-1?$:$t),G(!1),fe>-1&&zs.offers.length){for(const $t of zs.offers)if($t.offerId===fe){T($t);break}}},[]),Mr=_.useCallback(($,st=-1)=>{if(Tl(),$.parent.pageName==="root"&&$.children.length){for(const fe of $.children)if(fe.isVisible){$=fe;break}}const ot=[];let yt=$;for(;yt&&yt.pageName!=="root";)ot.push(yt),yt=yt.parent;ot.reverse(),S(fe=>{const Ye=fe.indexOf($)>=0,zs=$.isOpen;for(const $t of fe)$t.deactivate(),ot.indexOf($t)===-1&&$t.close();for(const $t of ot)$t.activate(),$t.parent&&$t.open(),$t===$.parent&&$t.children.length&&$t.open();return Ye&&zs?$.close():$.open(),ot}),$.pageId>-1&&Bi($.pageId,st)},[S,Bi,Tl]),yr=_.useCallback($=>{if($!==-1&&N(null),!a)Ai.current.requestById=$,t(!0);else{const st=Sl($,h);st&&Mr(st)}},[a,h,Sl,Mr]),pp=_.useCallback($=>{if(N(null),!a)Ai.current.requestByName=$,t(!0);else{const st=Ao($,h);st&&Mr(st)}},[a,h,Ao,Mr]),Ip=_.useCallback($=>{if(N(null),!a)Ai.current.requestedByOfferId=$,t(!0);else{const st=Ol($);if(!st||!st.length)return;Mr(st[0],$)}},[a,Ol,Mr]),NC=_.useCallback(()=>{},[]);return Y(vx,$=>{const st=$.getParser(),ot=new Map,yt=(fe,Ye,zs)=>{const $t=new Jq(fe,Ye,zs);for(const qr of $t.offerIds)ot.has(qr)?ot.get(qr).push($t):ot.set(qr,[$t]);Ye++;for(const qr of fe.children)$t.addChild(yt(qr,Ye,$t));return $t};d(yt(st.root,0,null)),E(ot)}),Y(bx,$=>{const st=$.getParser();if(st.catalogType!==c)return;const ot=[];for(const yt of st.offers){const fe=[],Ye=th(yt.localizationId);for(const $t of yt.products){const qr=zR($t.furniClassId,$t.productType);fe.push(new ll($t.productType,$t.furniClassId,$t.extraParam,$t.productCount,Ye,qr,$t.uniqueLimitedItem,$t.uniqueLimitedSeriesSize,$t.uniqueLimitedItemsLeft))}if(!fe.length)continue;const zs=new _i(yt.offerId,yt.localizationId,yt.rent,yt.priceCredits,yt.priceActivityPoints,yt.priceActivityPointsType,yt.giftable,yt.clubLevel,fe,yt.bundlePurchaseAllowed);(c===ln.NORMAL||zs.pricingModel!==_i.PRICING_MODEL_BUNDLE&&zs.pricingModel!==_i.PRICING_MODEL_MULTI)&&ot.push(zs)}st.frontPageItems&&st.frontPageItems.length&&B(st.frontPageItems),s(!1),i===st.pageId&&Cl(st.pageId,st.layoutCode,new l0(st.localization.images.concat(),st.localization.texts.concat()),ot,st.offerId,st.acceptSeasonCurrencyAsCredits)}),Y(Vx,$=>{const st=$.getParser();Fs(new wa(st.offer))}),Y(Bx,$=>{const st=$.getParser();Fs(new _l(st.code))}),Y(kx,$=>{const st=$.getParser();Fs(new g_(st.code))}),Y(Fx,$=>{$.getParser(),Fs(new f_)}),Y(Gx,$=>{const ot=$.getParser().offer;if(!ot||!ot.products.length)return;ot.products[0].uniqueLimitedItem;const fe=[],Ye=th(ot.localizationId);for(const $t of ot.products){const qr=zR($t.furniClassId,$t.productType);fe.push(new ll($t.productType,$t.furniClassId,$t.extraParam,$t.productCount,Ye,qr,$t.uniqueLimitedItem,$t.uniqueLimitedSeriesSize,$t.uniqueLimitedItemsLeft))}const zs=new _i(ot.offerId,ot.localizationId,ot.rent,ot.priceCredits,ot.priceActivityPoints,ot.priceActivityPointsType,ot.giftable,ot.clubLevel,fe,ot.bundlePurchaseAllowed);(c===ln.NORMAL||zs.pricingModel!==_i.PRICING_MODEL_BUNDLE&&zs.pricingModel!==_i.PRICING_MODEL_MULTI)&&(zs.page=m,T(zs),zs.product&&zs.product.productType===Yt.WALL&&z($t=>{const qr={...$t};return qr.extraData=zs.product.extraParam||null,qr}))}),Y(Wx,$=>{const st=$.getParser(),ot=new $q(st.productCode,st.palettes.slice());rt(yt=>{const fe=[];yt.petPalettes&&fe.push(...yt.petPalettes);for(let Ye=0;Ye<fe.length;Ye++)if(fe[Ye].breed===ot.breed){fe.splice(Ye,1);break}return fe.push(ot),{...yt,petPalettes:fe}})}),Y(wx,$=>{const st=$.getParser();rt(ot=>{const yt=st.offers;return{...ot,clubOffers:yt}})}),Y(ib,$=>{const st=$.getParser();rt(ot=>{const yt=st.groups;return{...ot,groups:yt}})}),Y(jx,$=>{const st=$.getParser();rt(ot=>{const yt=new n7(st);return{...ot,giftConfiguration:yt}})}),Y(ey,$=>{const st=$.getParser();if(!st)return;let ot="";st.result===1?ot=f("inventory.marketplace.result.title.success"):ot=f("inventory.marketplace.result.title.failure");const yt=f(`inventory.marketplace.result.${st.result}`);xr(yt,Bt.DEFAULT,null,null,ot)}),Y(MS,$=>{const st=$.getParser();rt(ot=>({...ot,clubGifts:st}))}),Y(Lx,$=>{const st=a;b_(),st&&xr(f("catalog.alert.published.description"),Bt.ALERT,null,null,f("catalog.alert.published.title"))}),Y(yx,$=>{const st=$.getParser();pe(st.furniCount),NC()}),Y(Dx,$=>{const st=$.getParser();We(st.furniLimit),In(st.maxFurniLimit),Th(st.secondsLeft),It(Pt()),Vs(st.secondsLeftWithGrace),NC()}),Is(wa.PURCHASE_SUCCESS,$=>Ua(ja.CREDITS)),ne(oI.PLACED,$=>{if(!J||$.type!==oI.PLACED)return;if(Oh(!0),!qe){Rl();return}let st=!1;const ot=qe.product;if($.category===W.WALL)switch(ot.furnitureData.className){case"floor":case"wallpaper":case"landscape":st=$.placedOnFloor||$.placedOnWall;break;default:st=$.placedInRoom;break}else st=$.placedInRoom;if(!st){Rl();return}switch(Rs(new a7($.roomId,$.objectId,$.category,$.wallLocation,$.x,$.y,$.direction,qe)),c){case ln.NORMAL:{switch($.category){case W.FLOOR:tt().addFurnitureFloor($.roomId,$.objectId,ot.productClassId,new j($.x,$.y,$.z),new j($.direction),0,new wi);break;case W.WALL:switch(ot.furnitureData.className){case"floor":case"wallpaper":case"landscape":Vc(ot.furnitureData.className,ot.extraParam);break;default:tt().addFurnitureWall($.roomId,$.objectId,ot.productClassId,new j($.x,$.y,$.z),new j($.direction*45),0,$.instanceData,0);break}}const yt=tt().getRoomObject($.roomId,$.objectId,$.category);yt&&yt.model.setValue(C.FURNITURE_ALPHA_MULTIPLIER,.5),ve&&k(new R_(i,qe.offerId,ot.extraParam,1)),At&&Il(qe);break}case ln.BUILDER:{let yt=qe.page.pageId;switch(yt===U8&&(yt=-1),$.category){case W.FLOOR:k(new Nb(yt,qe.offerId,ot.extraParam,$.x,$.y,$.direction));break;case W.WALL:k(new xb(yt,qe.offerId,ot.extraParam,$.wallLocation));break}At&&Il(qe);break}}}),Is(E_.FURNI_ADDED,$=>{const st=tt();if(!(!ge||ge.productClassId!==$.spriteId||ge.roomId!==st.activeRoomId)){switch($.category){case vt.FLOOR:{const ot=st.getRoomInstanceVariable(st.activeRoomId,C.ROOM_FLOOR_TYPE);ge.extraParam!==ot&&k(new Dh($.id));break}case vt.WALL_PAPER:{const ot=st.getRoomInstanceVariable(st.activeRoomId,C.ROOM_WALL_TYPE);ge.extraParam!==ot&&k(new Dh($.id));break}case vt.LANDSCAPE:{const ot=st.getRoomInstanceVariable(st.activeRoomId,C.ROOM_LANDSCAPE_TYPE);ge.extraParam!==ot&&k(new Dh($.id));break}default:k(new lO($.id,ge.category,ge.wallLocation,ge.x,ge.y,ge.direction))}At||Oh()}}),_.useEffect(()=>()=>T(null),[m]),_.useEffect(()=>{if(!(!a||!h||!g||!Ai.current))switch(Ai.current.requestType){case Ll.REQUEST_TYPE_NONE:if(m)return;if(h.isBranch){for(const $ of h.children)if($&&$.isVisible){Mr($);return}}return;case Ll.REQUEST_TYPE_ID:yr(Ai.current.requestById),Ai.current.resetRequest();return;case Ll.REQUEST_TYPE_OFFER:Ip(Ai.current.requestedByOfferId),Ai.current.resetRequest();return;case Ll.REQUEST_TYPE_NAME:pp(Ai.current.requestByName),Ai.current.resetRequest();return}},[a,h,g,m,Mr,yr,Ip,pp]),_.useEffect(()=>{!b&&m&&m.pageId===-1&&yr(o)},[b,m,o,yr]),_.useEffect(()=>{p&&z({quantity:1,extraData:p.product.extraParam,extraParamRequired:!1,previewStuffData:null})},[p]),_.useEffect(()=>{!a||h||(k(new Lb),k(new JS),k(new Db(c)),k(new Mb))},[a,h,c]),_.useEffect(()=>(w(new dh(tt(),++dh.PREVIEW_COUNTER)),()=>{w($=>($.dispose(),null))}),[]),{isVisible:a,setIsVisible:t,isBusy:e,pageId:i,previousPageId:o,currentType:c,rootNode:h,offersToNodes:g,currentPage:m,setCurrentPage:I,currentOffer:p,setCurrentOffer:T,activeNodes:R,searchResult:b,setSearchResult:N,frontPageItems:P,roomPreviewer:F,navigationHidden:U,setNavigationHidden:G,purchaseOptions:K,setPurchaseOptions:z,catalogOptions:et,setCatalogOptions:rt,getNodeById:Sl,getNodeByName:Ao,activateNode:Mr,openPageById:yr,openPageByName:pp,openPageByOfferId:Ip,requestOfferToMover:Il}},Ne=()=>Ts(j8),w8=1e3,F8=10,G8=1e3;let B8=0,k8=0;const V8=()=>{const[a,t]=_.useState([]),[e,s]=_.useState([]),[i,n]=_.useState([]),[o,l]=_.useState(!1),c=d=>{d.id=B8++,t(g=>{const E=[...g];return E.push(d),E.length>w8&&E.shift(),E})},u=d=>{s(g=>{const E=[...g];return E.push(d),E.length>F8&&E.shift(),E})},h=d=>{d.id=k8++,n(g=>{const E=[...g];return E.push(d),E.length>G8&&E.shift(),E})};return we(Mt.STARTED,d=>l(!0)),Y(po,d=>{if(!o)return;const g=d.getParser();e.length&&e[e.length-1].id===g.data.roomId||(c({id:-1,webId:-1,entityId:-1,name:g.data.roomName,timestamp:E0(),type:Bn.TYPE_ROOM_INFO,roomId:g.data.roomId}),u({id:g.data.roomId,name:g.data.roomName}),l(!1))}),Y(yS,d=>{const g=d.getParser();h({id:-1,webId:g.senderId,entityId:-1,name:"",message:g.messageText,roomId:-1,timestamp:gA(g.secondsSinceSent),type:Bn.TYPE_IM})}),Y(bS,d=>{const g=d.getParser();h({id:-1,webId:g.senderId,entityId:-1,name:"",message:g.messageText,roomId:-1,timestamp:gA(),type:Bn.TYPE_IM})}),{addChatEntry:c,chatHistory:a,roomHistory:e,messengerHistory:i}},dp=()=>Ts(V8),H8=()=>{const[a,t]=_.useState([]),[e,s]=_.useState([]),[i,n]=_.useState([]),[o,l]=_.useState([]),[c,u]=_.useState(null),h=_.useMemo(()=>{const R=a.filter(S=>S.online);return R.sort((S,b)=>S.name<b.name?-1:S.name>b.name?1:0),R},[a]),d=_.useMemo(()=>{const R=a.filter(S=>!S.online);return R.sort((S,b)=>S.name<b.name?-1:S.name>b.name?1:0),R},[a]),g=R=>k(new ZE(R.id)),E=(R,S)=>S!==R.relationshipStatus&&k(new tu(R.id,S)),m=R=>{for(const S of a)if(S.id===R)return S;return null},I=R=>!(R===q().userId||m(R)||e.find(S=>S.requesterUserId===R)||i.indexOf(R)>=0),p=(R,S)=>{if(!I(R))return!1;n(b=>{const N=[...b];return N.push(R),N}),k(new ZS(S))},T=(R,S)=>{R===-1&&!S?(k(new LT(!0)),s([])):s(b=>{const N=[...b],P=N.findIndex(B=>B.id===R);return P===-1?b:(k(S?new Kb(N[P].id):new LT(!1,N[P].id)),N.splice(P,1),N)})};return Y(iM,R=>{const S=R.getParser();u(new W7(S.userFriendLimit,S.normalFriendLimit,S.extendedFriendLimit,S.categories)),k(new qb)}),Y(Zx,R=>{const S=R.getParser();t(b=>{const N=[...b];for(const P of S.fragment){const B=N.findIndex(w=>w.id===P.id),F=new er;F.populate(P),B>-1?N[B]=F:N.push(F)}return N})}),Y(tM,R=>{const S=R.getParser();t(b=>{const N=[...b],P=B=>{const F=N.findIndex(w=>w.id===B.id);if(F===-1){const w=new er;w.populate(B),N.unshift(w)}else N[F].populate(B)};for(const B of S.addedFriends)P(B);for(const B of S.updatedFriends)P(B);for(const B of S.removedFriendIds){const F=N.findIndex(w=>w.id===B);F>-1&&N.splice(F,1)}return N})}),Y(eM,R=>{const S=R.getParser();s(b=>{const N=[...b];for(const P of S.requests){const B=N.findIndex(F=>F.requesterUserId===P.requesterUserId);if(B>0)N[B]=ji(N[B]),N[B].populate(P);else{const F=new fA;F.populate(P),N.push(F)}}return N})}),Y(DS,R=>{const b=R.getParser().request;s(N=>{const P=[...N];if(P.findIndex(F=>F.requesterUserId===b.requesterUserId)===-1){const F=new fA;F.populate(b),P.push(F)}return P})}),_.useEffect(()=>{k(new Jb);const R=setInterval(()=>k(new Xb),12e4);return()=>{clearInterval(R)}},[]),{friends:a,requests:e,sentRequests:i,dismissedRequestIds:o,setDismissedRequestIds:l,settings:c,onlineFriends:h,offlineFriends:d,getFriend:m,canRequestFriend:I,requestFriend:p,requestResponse:T,followFriend:g,updateRelationship:E}},ar=()=>Ts(H8),W8=()=>{const[a,t]=_.useState([]),[e,s]=_.useState(-1),[i,n]=_.useState([]),[o,l]=_.useState(Ma.HIDDEN),{getFriend:c=null}=ar(),{simpleAlert:u=null}=He(),h=_.useMemo(()=>a.filter(I=>i.indexOf(I.threadId)===-1),[a,i]),d=_.useMemo(()=>e>0&&h.find(I=>I.threadId===e||null),[e,h]),g=I=>{let p=a.find(T=>T.participant&&T.participant.id===I);if(p){const T=i.indexOf(p.threadId);T>=0&&n(R=>{const S=[...R];return S.splice(T,1),S})}else{const T=c(I);if(!T)return null;p=new JR(T),p.addMessage(null,f("messenger.moderationinfo"),0,null,mo.SECURITY_NOTIFICATION),p.setRead(),t(R=>{const S=[...R];return S.push(p),S})}return p},E=I=>{n(p=>{const T=[...p];return T.indexOf(I)>=0?p:(T.push(I),T)}),e===I&&s(-1)},m=(I,p,T,R=0,S=null,b=mo.CHAT)=>{if(!I||!T||!T.length)return;const N=p===q().userId;N&&T.length<=255&&k(new Zb(I.participant.id,T)),t(P=>{const B=[...P],F=B.findIndex(w=>w.threadId===I.threadId);return F===-1?P:(I=ji(B[F]),N&&I.groups.length===1&&Ua(ja.MESSENGER_NEW_THREAD),I.addMessage(b===mo.ROOM_INVITE?null:p,T,R,S,b),e===I.threadId&&I.setRead(),B[F]=I,!N&&I.unread&&Ua(ja.MESSENGER_MESSAGE_RECEIVED),B)})};return Y(yS,I=>{const p=I.getParser(),T=g(p.senderId);T&&m(T,p.senderId,p.messageText,p.secondsSinceSent,p.extraData)}),Y(bS,I=>{const p=I.getParser(),T=g(p.senderId);T&&m(T,p.senderId,p.messageText,0,null,mo.ROOM_INVITE)}),Y(rM,I=>{const p=I.getParser();u(`Received room invite error: ${p.errorCode},recipients: ${p.failedRecipients}`,Bt.DEFAULT,null,null,f("friendlist.alert.title"))}),_.useEffect(()=>{e<=0||t(I=>{const p=[...I],T=p.findIndex(R=>R.threadId===e);return T>=0&&(p[T]=ji(p[T]),p[T].setRead()),p})},[e]),_.useEffect(()=>{l(I=>{if(!h.length)return Ma.HIDDEN;let p=!1;for(const T of h)if(T.unreadCount>0){p=!0;break}return p?Ma.UNREAD:Ma.SHOW})},[h]),{messageThreads:a,activeThread:d,iconState:o,visibleThreads:h,getMessageThread:g,setActiveThreadId:s,closeThread:E,sendMessage:m}},P0=()=>Ts(W8),Y8=()=>{const[a,t]=_.useState(!1),[e,s]=_.useState(null),[i,n]=_.useState(null),[o,l]=_.useState(null),[c,u]=_.useState(!1),[h,d]=_.useState(null);return Y(aM,g=>{let E=g.getParser();!E||E&&!E.games.length||(n(E.games[0]),s(E.games))}),Y(nM,g=>{let E=g.getParser();E&&l(E)}),Y(oM,g=>{let E=g.getParser();E&&u(E.isInMaintenance)}),Y(vS,g=>{let E=g.getParser();if(E)switch(E.gameTypeId){case 2:return console.log("snowwar");default:return d(E.url)}}),_.useEffect(()=>{a&&(k(new iv),AO())},[a]),{isVisible:a,setIsVisible:t,games:e,accountStatus:o,selectedGame:i,setSelectedGame:n,gameOffline:c,gameURL:h,setGameURL:d}},_p=()=>Ts(Y8),z8=()=>{const[a,t]=_.useState(null);return Y(LS,e=>{const s=e.getParser(),i={badgeBases:[],badgeSymbols:[],badgePartColors:[],groupColorsA:[],groupColorsB:[]};s.bases.forEach((o,l)=>i.badgeBases.push({id:l,images:o})),s.symbols.forEach((o,l)=>i.badgeSymbols.push({id:l,images:o})),s.partColors.forEach((o,l)=>i.badgePartColors.push({id:l,color:o})),s.colorsA.forEach((o,l)=>i.groupColorsA.push({id:l,color:o})),s.colorsB.forEach((o,l)=>i.groupColorsB.push({id:l,color:o}));const n=(o,l)=>o.id<l.id?-1:o.id>l.id?1:0;i.badgeBases.sort(n),i.badgeSymbols.sort(n),i.badgePartColors.sort(n),i.groupColorsA.sort(n),i.groupColorsB.sort(n),t(i)}),_.useEffect(()=>{k(new cv)},[]),{groupCustomize:a}},y_=()=>Ts(z8),K8=()=>{const[a,t]=_.useState(null),[e,s]=_.useState(null),{simpleAlert:i=null,showConfirm:n=null}=He(),o=(l,c)=>{const u={reportType:l,reportedUserId:-1,reportedChats:[],cfhCategory:-1,cfhTopic:-1,roomId:-1,roomName:"",messageId:-1,threadId:-1,groupId:-1,extraData:"",roomObjectId:-1,message:"",currentStep:0};switch(l){case as.BULLY:case as.EMERGENCY:case as.IM:u.reportedUserId=c.reportedUserId,u.currentStep=Ci.SELECT_CHATS;break;case as.ROOM:u.roomId=c.roomId,u.roomName=c.roomName,u.currentStep=Ci.SELECT_TOPICS;break;case as.THREAD:u.groupId=c.groupId,u.threadId=c.threadId,u.currentStep=Ci.SELECT_TOPICS;break;case as.MESSAGE:u.groupId=c.groupId,u.threadId=c.threadId,u.messageId=c.messageId,u.currentStep=Ci.SELECT_TOPICS;break;case as.PHOTO:u.extraData=c.extraData,u.roomId=c.roomId,u.reportedUserId=c.reportedUserId,u.roomObjectId=c.roomObjectId,u.currentStep=Ci.SELECT_TOPICS;break}t(u)};return Y(IM,l=>{const c=l.getParser();let u=c.messageText;switch(c.resultType){case Mf.TOO_MANY_PENDING_CALLS_CODE:k(new Pv),i(f("help.cfh.error.pending"),Bt.MODERATION,null,null,f("help.cfh.error.title"));break;case Mf.HAS_ABUSIVE_CALL_CODE:i(f("help.cfh.error.abusive"),Bt.MODERATION,null,null,f("help.cfh.error.title"));break;default:u.trim().length===0&&(u=f("help.cfh.sent.text")),i(u,Bt.MODERATION,null,null,f("help.cfh.sent.title"))}}),Y(xM,l=>{const c=l.getParser(),u=c.messageText.length===0?f("help.cfh.closed."+J7(c.closeReason)):c.messageText;i(u,Bt.MODERATION,null,null,f("mod.alert.title"))}),Y(EM,l=>{const c=l.getParser();c.count>0&&n(f("help.emergency.pending.title")+`
`+c.pendingCalls[0].message,()=>{k(new Lv)},null,f("help.emergency.pending.button.discard"),f("help.emergency.pending.button.keep"),f("help.emergency.pending.message.subtitle"))}),Y(mM,l=>{i("Your pending calls were deleted",Bt.MODERATION,null,null,f("mod.alert.title"))}),Y(pM,l=>{const c=l.getParser();i(c.message,Bt.MODERATION,null,null,f("help.cfh.reply.title"))}),Y(fM,l=>{const c=l.getParser();i(f("help.emergency.global_mute.message"),Bt.MODERATION,c.infoUrl,f("help.emergency.global_mute.link"),f("help.emergency.global_mute.subtitle"))}),Y(Rx,l=>{const c=l.getParser();s(c)}),{activeReport:a,setActiveReport:t,sanctionInfo:e,setSanctionInfo:s,report:o}},En=()=>Ts(K8),gp=()=>{const[a,t]=_.useState([]),e=_.useMemo(()=>!!a.length,[a]),s=_.useCallback(()=>{let n=-1;return t(o=>{const l=[...o];return n=l.length?l[l.length-1]+1:0,l.push(n),l}),n},[]),i=_.useCallback(n=>{t(o=>{const l=[...o],c=l.indexOf(n);return c===-1?o:(l.splice(c,1),l)})},[]);return{isVisible:e,activate:s,deactivate:i}},X8=a=>k(new tL(a)),q8=(a,t)=>k(new eL(a,...t)),Q8=()=>{const[a,t]=_.useState(new Map),e=_.useCallback(c=>{var u;return((u=a.get(c))==null?void 0:u.length)||0},[a]),s=_.useMemo(()=>{let c=0;for(const u of a.keys())c+=e(u);return c},[a,e]),i=_.useCallback(c=>{let u=!0;return t(h=>{if(!h.has(c))return u=!1,h;const d=new Map(h);return d.delete(c),X8(c),d}),u},[]),n=_.useCallback((c,u)=>{let h=!0;return t(d=>{if(!d.has(c))return h=!1,d;const g=new Map(d),E=g.get(c);if(E)for(const m of u)E.splice(E.indexOf(m),1);return q8(c,u),g}),h},[]),o=_.useCallback((c,u)=>a.has(c)?a.get(c).indexOf(u)>=0:!1,[a]),l=_.useCallback((c,u)=>{t(h=>{if(!h.has(c))return h;const d=new Map(h),g=d.get(c),E=g.indexOf(u);return E>=0&&g.splice(E,1),d})},[]);return Y(Yy,c=>{const u=c.getParser();t(h=>{const d=new Map(h);for(const g of u.categories){let E=d.get(g);E||(E=[],d.set(g,E));const m=u.getItemsByCategory(g);for(const I of m)E.indexOf(I)===-1&&E.push(I)}return d})}),{getCount:e,getFullCount:s,resetCategory:i,resetItems:n,isUnseen:o,removeUnseen:l}},Kr=()=>Ts(Q8),J8=()=>{const[a,t]=_.useState(!0),[e,s]=_.useState([]),[i,n]=_.useState(new Map),[o,l]=_.useState([]),[c,u]=_.useState(null),{isVisible:h=!1,activate:d=null,deactivate:g=null}=gp(),{isUnseen:E=null,resetCategory:m=null}=Kr(),I=it("user.badges.max.slots",5),p=b=>o.indexOf(b)>=0,T=()=>o.length<I,R=b=>{l(N=>{const P=[...N],B=P.indexOf(b);if(B===-1){if(!T())return N;P.push(b)}else P.splice(B,1);const F=new Wv;for(let w=0;w<I;w++)F.addActivatedBadge(P[w]??"");return k(F),P})},S=b=>e.indexOf(b)===-1?0:i.get(b)??0;return Y(vM,b=>{const N=b.getParser(),P=[];n(B=>{const F=new Map(B);return N.getAllBadgeCodes().forEach(w=>{const U=e.indexOf(w)>=0,G=N.getBadgeId(w);F.set(w,G),!U&&P.push(w)}),F}),l(N.getActiveBadgeCodes()),s(B=>[...B,...P])}),Y(bM,b=>{const N=b.getParser(),P=E(os.BADGE,N.badgeId);s(B=>{const F=[...B];return P?F.unshift(N.badgeCode):F.push(N.badgeCode),F}),n(B=>{const F=new Map(B);return F.set(N.badgeCode,N.badgeId),F})}),_.useEffect(()=>{!e||!e.length||u(b=>{let N=b;return N&&e.indexOf(N)===-1&&(N=null),N||(N=e[0]),N})},[e]),_.useEffect(()=>{if(h)return()=>{m(os.BADGE)}},[h,m]),_.useEffect(()=>{!h||!a||(k(new Hv),t(!1))},[h,a]),{badgeCodes:e,activeBadgeCodes:o,selectedBadgeCode:c,setSelectedBadgeCode:u,isWearingBadge:p,canWearBadges:T,toggleBadge:R,getBadgeId:S,activate:d,deactivate:g}},fp=()=>Ts(J8),$8=()=>{const[a,t]=_.useState(!0),[e,s]=_.useState([]),[i,n]=_.useState(null),{isVisible:o=!1,activate:l=null,deactivate:c=null}=gp(),{isUnseen:u=null,resetCategory:h=null}=Kr();return Y(Ex,d=>{const g=d.getParser();s(E=>{const m=[...E],I=m.map(T=>T.botData.id),p=[];for(const T of g.items.values())I.indexOf(T.id)===-1&&p.push(T);for(const T of I){let R=!0;for(const N of g.items.values())if(N.id===T){R=!1;break}if(!R)continue;const S=m.findIndex(N=>N.botData.id===T),b=m[S];S===-1||!b||(fh()===b.botData.id&&(h_(),ut("inventory/open")),m.splice(S,1))}for(const T of p){const R={botData:T};u(os.BOT,T.id)?m.unshift(R):m.push(R)}return m})}),Y(mx,d=>{const g=d.getParser();s(E=>{const m=[...E];if(m.findIndex(R=>R.botData.id===g.item.id)>=0)return E;const p={botData:g.item};return u(os.BOT,p.botData.id)?m.unshift(p):m.push(p),m})}),Y(px,d=>{const g=d.getParser();s(E=>{const m=[...E],I=m.findIndex(p=>p.botData.id===g.itemId);return I===-1?E:(m.splice(I,1),fh()===g.itemId&&(h_(),ut("inventory/show")),m)})}),_.useEffect(()=>{!e||!e.length||n(d=>{let g=d;return g&&e.indexOf(g)===-1&&(g=null),g||(g=e[0]),g})},[e]),_.useEffect(()=>{if(o)return()=>{h(os.BOT)}},[o,h]),_.useEffect(()=>{!o||!a||(k(new FT),t(!1))},[o,a]),{botItems:e,selectedBot:i,setSelectedBot:n,activate:l,deactivate:c}},U0=()=>Ts($8);let V_=null;const Z8=()=>{const[a,t]=_.useState(!0),[e,s]=_.useState([]),[i,n]=_.useState(null),{isVisible:o=!1,activate:l=null,deactivate:c=null}=gp(),{isUnseen:u=null,resetCategory:h=null}=Kr(),d=m=>{if(!(!e||!e.length))return e.filter(I=>I.type===m)},g=m=>{if(!(!e||!e.length)){for(const I of e){const p=I.getItemById(m);if(p&&p.isWallItem)return I}return null}},E=m=>{if(!(!e||!e.length)){for(const I of e){const p=I.getItemById(m);if(p&&!p.isWallItem)return I}return null}};return Y(FS,m=>{const I=m.getParser();s(p=>{const T=[...p];for(const R of I.items){let S=0,b=null;for(;S<T.length;){const N=T[S];let P=0;for(;P<N.items.length;){const B=N.items[P];if(B.id===R.itemId){B.update(R);const F=[...N.items];F[P]=B,N.items=F,b=N;break}P++}if(b)break;S++}if(b)b.hasUnseenItems=!0,T[S]=ji(b);else{const N=new u_(R);uA(T,N,u(os.FURNI,R.itemId)),Fs(new E_(N.id,N.type,N.category))}}return T})}),Y(Wg,m=>{const I=m.getParser();V_||(V_=new Array(I.totalFragments));const p=T7(I.fragment,I.totalFragments,I.fragmentNumber,V_);p&&(s(T=>{const R=[...T],S=R7(R);for(const b of S){if(p.get(b))continue;let N=0;for(;N<R.length;){const P=R[N],B=P.remove(b);if(!B){N++;continue}fh()===B.ref&&(h_(),mh(P)||ut("inventory/show")),P.getTotalCount()<=0&&(R.splice(N,1),P.dispose());break}}for(const b of p.keys()){if(S.indexOf(b)>=0)continue;const N=p.get(b);if(!N)continue;const P=new u_(N);uA(R,P,u(os.FURNI,b)),Fs(new E_(P.id,P.type,P.category))}return R}),V_=null)}),Y(PM,m=>{t(!0)}),Y(GS,m=>{const I=m.getParser();s(p=>{const T=[...p];let R=0;for(;R<T.length;){const S=T[R],b=S.remove(I.itemId);if(!b){R++;continue}fh()===b.ref&&(h_(),mh(S)||ut("inventory/show")),S.getTotalCount()<=0&&(T.splice(R,1),S.dispose());break}return T})}),Y(UM,m=>{}),_.useEffect(()=>{!e||!e.length||n(m=>{let I=m;return I&&e.indexOf(I)===-1&&(I=null),I||(I=e[0]),I})},[e]),_.useEffect(()=>{if(o)return()=>{h(os.FURNI)&&s(m=>{const I=[...m];for(const p of I)p.hasUnseenItems=!1;return I})}},[o,h]),_.useEffect(()=>{!o||!a||(k(new Yv),t(!1))},[o,a]),{isVisible:o,groupItems:e,setGroupItems:s,selectedItem:i,setSelectedItem:n,activate:l,deactivate:c,getWallItemById:g,getFloorItemById:E,getItemsByType:d}},Bc=()=>Ts(Z8);let H_=null;const t9=()=>{const[a,t]=_.useState(!0),[e,s]=_.useState([]),[i,n]=_.useState(null),{isVisible:o=!1,activate:l=null,deactivate:c=null}=gp(),{isUnseen:u=null,resetCategory:h=null}=Kr();return Y(FM,d=>{const g=d.getParser();H_||(H_=new Array(g.totalFragments));const E=A7(g.fragment,g.totalFragments,g.fragmentNumber,H_);E&&(s(m=>{const I=[...m];return C7(I,E,u),I}),H_=null)}),Y(wM,d=>{const g=d.getParser();s(E=>{const m=[...E];return g0(g.pet,m,u(os.PET,g.pet.id)),m})}),Y(BM,d=>{const g=d.getParser();s(E=>{const m=[...E];return f0(g.petId,m),m})}),_.useEffect(()=>{!e||!e.length||n(d=>{let g=d;return g&&e.indexOf(g)===-1&&(g=null),g||(g=e[0]),g})},[e]),_.useEffect(()=>{if(o)return()=>{h(os.PET)}},[o,h]),_.useEffect(()=>{!o||!a||(k(new GT),t(!1))},[o,a]),{petItems:e,selectedPet:i,setSelectedPet:n,activate:l,deactivate:c}},j0=()=>Ts(t9),e9=()=>{const[a,t]=_.useState(null),[e,s]=_.useState(null),[i,n]=_.useState(Ps.TRADING_STATE_READY),{groupItems:o=[],setGroupItems:l=null,activate:c=null,deactivate:u=null}=Bc(),{simpleAlert:h=null,showTradeAlert:d=null}=He(),g=i>=Ps.TRADING_STATE_RUNNING,E=()=>{switch(i){case Ps.TRADING_STATE_RUNNING:!e.itemCount&&!a.accepts&&h(f("inventory.trading.warning.other_not_offering"),null,null,null),a.accepts?k(new Zv):k(new zv);return;case Ps.TRADING_STATE_CONFIRMING:k(new qv),n(Ps.TRADING_STATE_CONFIRMED);return}},m=p=>{const T=p.getLastItem();T&&k(new Jv(T.id))},I=()=>{if(g)switch(i){case Ps.TRADING_STATE_RUNNING:k(new Xv);return;default:k(new Kv);return}};return Y(kM,p=>{const T=p.getParser();!a||!e||(a.userId===T.userID?t(R=>{const S=ji(R);return S.accepts=T.userAccepts,S}):e.userId===T.userID&&s(R=>{const S=ji(R);return S.accepts=T.userAccepts,S}))}),Y(VM,p=>{const T=p.getParser();T.reason===kg.ERROR_WHILE_COMMIT?d(Ji.ERROR_WHILE_COMMIT):a&&T.userID!==a.userId&&d(Ji.THEY_CANCELLED),t(null),s(null),n(Ps.TRADING_STATE_READY)}),Y(HM,p=>{p.getParser(),t(null),s(null),n(Ps.TRADING_STATE_READY)}),Y(WM,p=>{p.getParser(),n(Ps.TRADING_STATE_COUNTDOWN)}),Y(YM,p=>{const T=p.getParser(),R=_A(T.firstUserItemArray),S=_A(T.secondUserItemArray);t(b=>{const N=ji(b);N.userId===T.firstUserID?(N.creditsCount=T.firstUserNumCredits,N.itemCount=T.firstUserNumItems,N.userItems=R):(N.creditsCount=T.secondUserNumCredits,N.itemCount=T.secondUserNumItems,N.userItems=S);const P=[];for(const B of N.userItems.getValues()){let F=0;for(;F<B.getTotalCount();){const w=B.getItemByIndex(F);w&&P.push(w.ref),F++}}return l(B=>{const F=[...B];for(const w of F)w.lockItemIds(P);return F}),N}),s(b=>{const N=ji(b);return N.userId===T.firstUserID?(N.creditsCount=T.firstUserNumCredits,N.itemCount=T.firstUserNumItems,N.userItems=R):(N.creditsCount=T.secondUserNumCredits,N.itemCount=T.secondUserNumItems,N.userItems=S),N})}),Y(zM,p=>{p.getParser()}),Y(KM,p=>{const T=p.getParser(),R=new hA,S=ie().userDataManager.getUserData(T.userID);R.userItems=new hs;const b=new hA,N=ie().userDataManager.getUserData(T.otherUserID);b.userItems=new hs,S.webID===q().userId?(R.userId=S.webID,R.userName=S.name,R.canTrade=T.userCanTrade,b.userId=N.webID,b.userName=N.name,b.canTrade=T.otherUserCanTrade):N.webID===q().userId&&(R.userId=N.webID,R.userName=N.name,R.canTrade=T.otherUserCanTrade,b.userId=S.webID,b.userName=S.name,b.canTrade=T.userCanTrade),t(R),s(b),n(Ps.TRADING_STATE_RUNNING)}),Y(XM,p=>{const T=p.getParser();d(T.reason,T.otherUserName)}),Y(qM,p=>{p.getParser(),d(Ji.THEY_NOT_ALLOWED)}),Y(QM,p=>{p.getParser(),d(Ji.YOU_NOT_ALLOWED)}),_.useEffect(()=>{if(i===Ps.TRADING_STATE_READY)return;const p=c();return()=>u(p)},[i,c,u]),{ownUser:a,otherUser:e,tradeState:i,setTradeState:n,isTrading:g,groupItems:o,progressTrade:E,removeItem:m,stopTrading:I}},w0=()=>Ts(e9),s9=()=>{const[a,t]=_.useState(null),[e,s]=_.useState([]),[i,n]=_.useState([]),[o,l]=_.useState([]),[c,u]=_.useState([]),[h,d]=_.useState([]),[g,E]=_.useState([]),{simpleAlert:m=null}=He(),I=G=>{e.indexOf(G)>=0||s(K=>[...K,G])},p=G=>{s(K=>{const z=[...K],et=z.indexOf(G);return et>=0&&z.splice(et),z})},T=G=>{e.indexOf(G)>=0?p(G):I(G)},R=G=>{i.indexOf(G)>=0||n(K=>[...K,G])},S=G=>{n(K=>{const z=[...K],et=z.indexOf(G);return et>=0&&z.splice(et),z})},b=G=>{i.indexOf(G)>=0?S(G):R(G)},N=G=>{o.indexOf(G)>=0||l(K=>[...K,G])},P=G=>{l(K=>{const z=[...K],et=z.indexOf(G);return et>=0&&z.splice(et),z})},B=G=>{o.indexOf(G)>=0?P(G):N(G)},F=G=>{c.indexOf(G)>=0||u(K=>[...K,G])},w=G=>{u(K=>{const z=[...K],et=z.indexOf(G);return et>=0&&z.splice(et),z})},U=G=>{i.indexOf(G)>=0?w(G):F(G)};return Y(uy,G=>{const z=G.getParser().data;t(z),d(z.issues)}),Y(ay,G=>{const K=G.getParser();d(z=>{const et=[...z],rt=et.findIndex(J=>J.issueId===K.issueData.issueId);return rt>=0?et[rt]=K.issueData:(et.push(K.issueData),Ua(ja.MODTOOLS_NEW_TICKET)),et})}),Y(_y,G=>{G.getParser()}),Y(oy,G=>{G.getParser()&&m("Failed to pick issue",Bt.DEFAULT,null,null,"Error")}),Y(ny,G=>{const K=G.getParser();d(z=>{const et=[...z],rt=et.findIndex(J=>J.issueId===K.issueId);return rt>=0&&et.splice(rt,1),et})}),Y(ly,G=>{G.getParser().success?m("Moderation action was successfull",Bt.MODERATION,null,null,"Success"):m("There was a problem applying tht moderation action",Bt.MODERATION,null,null,"Error")}),Y(Tx,G=>{const K=G.getParser();E(K.callForHelpCategories)}),Y(Ix,G=>{G.getParser()}),{settings:a,openRooms:e,openRoomChatlogs:i,openUserChatlogs:c,openUserInfos:o,cfhCategories:g,tickets:h,openRoomInfo:I,closeRoomInfo:p,toggleRoomInfo:T,openRoomChatlog:R,closeRoomChatlog:S,toggleRoomChatlog:b,openUserInfo:N,closeUserInfo:P,toggleUserInfo:B,openUserChatlog:F,closeUserChatlog:w,toggleUserChatlog:U}},Ih=()=>Ts(s9),i9=()=>{const[a,t]=_.useState(null),[e,s]=_.useState(null),[i,n]=_.useState(null),[o,l]=_.useState(null),[c,u]=_.useState({roomInfo:null,state:Fe.NONE}),[h,d]=_.useState(null),[g,E]=_.useState({settingsReceived:!1,homeRoomId:0,enteredGuestRoom:null,currentRoomOwner:!1,currentRoomId:0,currentRoomIsStaffPick:!1,createdFlatId:0,avatarId:0,roomPicker:!1,eventMod:!1,currentRoomRating:0,canRate:!0}),{simpleAlert:m=null}=He();return Y(by,I=>{const p=I.getParser();k(new Zd(p.roomId,!1,!1))}),Y(Oy,I=>{const p=I.getParser();p.canCreate||m(f(`navigator.cannotcreateevent.error.${p.errorCode}`),null,null,null,f("navigator.cannotcreateevent.title"))}),Y(lh,I=>{k(new NL),k(new sO)}),Y(YS,I=>{const p=I.getParser();E(T=>{const R={...T};return R.eventMod=p.securityLevel>=Cc.MODERATOR,R.roomPicker=p.securityLevel>=Cc.COMMUNITY,R})}),Y(lD,I=>{const p=I.getParser();Yr(p.roomId)}),Y(HS,I=>{const p=I.getParser();E(T=>{const R={...T};return R.enteredGuestRoom=null,R.currentRoomOwner=p.isOwner,R.currentRoomId=p.roomId,R}),k(new Zd(p.roomId,!0,!1)),Zt.available&&Zt.call("legacyTrack","navigator","private",[p.roomId])}),Y(po,I=>{const p=I.getParser();if(p.roomEnter)u({roomInfo:null,state:Fe.NONE}),E(T=>{const R={...T};return R.enteredGuestRoom=p.data,R.currentRoomIsStaffPick=p.staffPick,!(R.createdFlatId===p.data.roomId)&&p.data.displayRoomEntryAd&&it("roomenterad.habblet.enabled",!1)&&Hn.openRoomEnterAd(),R.createdFlatId=0,R.enteredGuestRoom&&R.enteredGuestRoom.habboGroupId>0,R});else if(p.roomForward){if(p.data.ownerName!==q().userName&&!p.isGroupMember)switch(p.data.doorMode){case De.DOORBELL_STATE:u(T=>{const R={...T};return R.roomInfo=p.data,R.state=Fe.START_DOORBELL,R});return;case De.PASSWORD_STATE:u(T=>{const R={...T};return R.roomInfo=p.data,R.state=Fe.START_PASSWORD,R});return}if(p.data.doorMode===De.NOOB_STATE&&!q().isAmbassador&&!q().isRealNoob&&!q().isModerator)return;gc(p.data.roomId)}else E(T=>{const R={...T};return R.enteredGuestRoom=p.data,R.currentRoomIsStaffPick=p.staffPick,R})}),Y(hD,I=>{const p=I.getParser();E(T=>{const R={...T};return R.currentRoomRating=p.totalLikes,R.canRate=p.canLike,R})}),Y(BS,I=>{const p=I.getParser();(!p.userName||p.userName.length===0)&&u(T=>{const R={...T};return R.state=Fe.STATE_WAITING,R})}),Y(zg,I=>{const p=I.getParser();(!p.userName||p.userName.length===0)&&u(T=>{const R={...T};return R.state=Fe.STATE_ACCEPTED,R})}),Y(Yg,I=>{const p=I.getParser();(!p.userName||p.userName.length===0)&&u(T=>{const R={...T};return R.state=Fe.STATE_NO_ANSWER,R})}),Y(Hg,I=>{switch(I.getParser().errorCode){case-100002:u(T=>{const R={...T};return R.state=Fe.STATE_WRONG_PASSWORD,R});return;case 4009:m(f("navigator.alert.need.to.be.vip"),Bt.DEFAULT,null,null,f("generic.alert.title"));return;case 4010:m(f("navigator.alert.invalid_room_name"),Bt.DEFAULT,null,null,f("generic.alert.title"));return;case 4011:m(f("navigator.alert.cannot_perm_ban"),Bt.DEFAULT,null,null,f("generic.alert.title"));return;case 4013:m(f("navigator.alert.room_in_maintenance"),Bt.DEFAULT,null,null,f("generic.alert.title"));return}}),Y(Ny,I=>{const p=I.getParser();l(p.topLevelContexts),n(p.topLevelContexts.length?p.topLevelContexts[0]:null)}),Y(My,I=>{const p=I.getParser();n(T=>{let R=T;if(R||(R=o&&o.length&&o[0]||null),!R)return null;if(p.result.code!==R.code&&o&&o.length)for(const S of o)S.code===p.result.code&&(R=S);for(const S of o)S.code===p.result.code&&(R=S);return R}),d(p.result)}),Y(Ly,I=>{const p=I.getParser();t(p.categories)}),Y(vy,I=>{const p=I.getParser();s(p.categories)}),Y(Cy,I=>{const p=I.getParser();gc(p.roomId)}),Y(Ay,I=>{const p=I.getParser();let T=!1;if(E(b=>{T=b.settingsReceived;const N={...b};return N.homeRoomId=p.homeRoomId,N.settingsReceived=!0,N}),T)return;let R=-1,S=-1;it("friend.id")!==void 0&&parseInt(it("friend.id"))>0&&(R=0,k(new ZE(parseInt(it("friend.id"))))),it("forward.type")!==void 0&&it("forward.id")!==void 0&&(R=parseInt(it("forward.type")),S=parseInt(it("forward.id"))),R===2?Yr(S):R===-1&&p.roomIdToEnter>0&&(ut("navigator/close"),p.roomIdToEnter!==p.homeRoomId?gc(p.roomIdToEnter):gc(p.homeRoomId))}),Y(oD,I=>{const p=I.getParser();switch(p.reason){case Ju.REASON_FULL:m(f("navigator.guestroomfull.text"),Bt.DEFAULT,null,null,f("navigator.guestroomfull.title"));break;case Ju.REASON_QUEUE_ERROR:m(f(`room.queue.error.${p.parameter}`),Bt.DEFAULT,null,null,f("room.queue.error.title"));break;case Ju.REASON_BANNED:m(f("navigator.banned.text"),Bt.DEFAULT,null,null,f("navigator.banned.title"));break;default:m(f("room.queue.error.title"),Bt.DEFAULT,null,null,f("room.queue.error.title"));break}AO()}),Y(xy,I=>ut("navigator/show")),{categories:a,doorData:c,setDoorData:u,topLevelContext:i,topLevelContexts:o,searchResult:h,navigatorData:g}},pn=()=>Ts(i9),r9=()=>{const[a,t]=_.useState(new vO),e=_.useMemo(()=>it("hc.disabled",!1),[]),s=_.useMemo(()=>e||a.clubDays>0?Sa.ACTIVE:a.pastVipDays>0||a.pastVipDays>0?Sa.EXPIRED:Sa.NONE,[a,e]),i=n=>{if(n===-1)return a.credits;for(const[o,l]of a.activityPoints.entries())if(o===n)return l;return 0};return Y(ob,n=>{const o=n.getParser();t(l=>{const c=ji(l);return c.credits=parseFloat(o.credits),l.credits!==c.credits&&Ua(ja.CREDITS),c})}),Y(lb,n=>{const o=n.getParser();t(l=>{const c=ji(l);return c.activityPoints=o.currencies,c})}),Y(kS,n=>{const o=n.getParser();t(l=>{const c=ji(l);return c.activityPoints=new Map(c.activityPoints),c.activityPoints.set(o.type,o.amount),o.type===0&&Ua(ja.DUCKETS),c})}),Y(cb,n=>{const o=n.getParser(),l=o.productName;l!=="club_habbo"&&l!=="habbo_club"||t(c=>{const u=ji(c);return u.clubDays=Math.max(0,o.daysToPeriodEnd),u.clubPeriods=Math.max(0,o.periodsSubscribedAhead),u.isVip=o.isVip,u.pastClubDays=o.pastClubDays,u.pastVipDays=o.pastVipDays,u.isExpiring=o.responseType===wg.RESPONSE_TYPE_DISCOUNT_AVAILABLE,u.minutesUntilExpiration=o.minutesUntilExpiration,u.minutesSinceLastModified=o.minutesSinceLastModified,u})}),_.useEffect(()=>{if(e)return;k(new qT("habbo_club"));const n=setInterval(()=>k(new qT("habbo_club")),5e4);return()=>clearInterval(n)},[e]),_.useEffect(()=>{k(new pU)},[]),{purse:a,hcDisabled:e,clubStatus:s,getCurrencyAmount:i}},kc=()=>Ts(r9),n9=(a,t)=>{_.useEffect(()=>{if(!a)return;const e=s=>t(s);return Pa.addEventListener(Ue.FURNI_ADDED,e),()=>{Pa.removeEventListener(Ue.FURNI_ADDED,e)}},[a,t])},Xr=(a,t)=>{_.useEffect(()=>{if(!a)return;const e=s=>t(s);return Pa.addEventListener(Ue.FURNI_REMOVED,e),()=>{Pa.removeEventListener(Ue.FURNI_REMOVED,e)}},[a,t])},a9=a=>{Is(Ue.OBJECT_DESELECTED,a)},o9=a=>{Is(Ue.OBJECT_ROLL_OUT,a)},l9=a=>{Is(Ue.OBJECT_ROLL_OVER,a)},FO=a=>{Is(Ue.OBJECT_SELECTED,a)},F0=(a,t)=>{_.useEffect(()=>{if(!a)return;const e=s=>t(s);return Pa.addEventListener(Ue.USER_ADDED,e),()=>{Pa.removeEventListener(Ue.USER_ADDED,e)}},[a,t])},G0=(a,t)=>{_.useEffect(()=>{if(!a)return;const e=s=>t(s);return Pa.addEventListener(Ue.USER_REMOVED,e),()=>{Pa.removeEventListener(Ue.USER_REMOVED,e)}},[a,t])},c9=()=>{const[a,t]=_.useState(null),[e,s]=_.useState(!1);return Y(yy,i=>{const n=i.getParser();n&&t(n)}),{promoteInformation:a,isExtended:e,setPromoteInformation:t,setIsExtended:s}},GO=()=>Ts(c9),u9=()=>{const[a,t]=_.useState(null),[e,s]=_.useState(null),[i,n]=_.useState(null),[o,l]=_.useState(0),c=(h,d,g,E=!1)=>{if(!e)return;const m=ii.hslToRGB(((h&255)<<16)+((d&255)<<8)+(g&255));E&&l(m),!h&&!d&&!g?e.tint=0:e.tint=m},u=h=>{if(!i)return;const d=h>>16&255,g=h>>8&255,E=h&255;i.red=d/255,i.green=g/255,i.blue=E/255};return Is(el.PREVIEW,h=>c(h.hue,h.saturation,h.lightness)),Is(el.CLEAR_PREVIEW,h=>{e&&(e.tint=o)}),ne(Vd.ROOM_BACKGROUND_COLOR,h=>{wn.isRoomPreviewerId(h.roomId)||(h.enable?c(h.hue,h.saturation,h.lightness,!0):c(0,0,0,!0))}),ne(pg.ROOM_COLOR,h=>{if(wn.isRoomPreviewerId(h.roomId))return;let d=0,g=255;h.bgOnly||(d=h.color,g=h.brightness),u(ii.hslToRGB((ii.rgbToHSL(d)&16776960)+g))}),ne([te.INITIALIZED,te.DISPOSED],h=>{if(wn.isRoomPreviewerId(h.roomId))return;const d=ie();if(d)switch(h.type){case te.INITIALIZED:oA(h.roomId),t(d);return;case te.DISPOSED:t(null);return}}),we([Mt.CREATED,Mt.ENDED],h=>{switch(h.type){case Mt.CREATED:h7(h.session);return;case Mt.ENDED:t(null);return}}),ne([Rt.SELECTED,Rt.DESELECTED,Rt.ADDED,Rt.REMOVED,Rt.PLACED,Rt.REQUEST_MOVE,Rt.REQUEST_ROTATE,Rt.MOUSE_ENTER,Rt.MOUSE_LEAVE,Rt.DOUBLE_CLICK],h=>{if(wn.isRoomPreviewerId(h.roomId))return;let d=null;switch(h.type){case Rt.SELECTED:_7(h)||(d=new Ue(Ue.OBJECT_SELECTED,h.objectId,h.category,h.roomId));break;case Rt.DESELECTED:d=new Ue(Ue.OBJECT_DESELECTED,h.objectId,h.category,h.roomId);break;case Rt.ADDED:{let g=null;switch(h.category){case W.FLOOR:case W.WALL:g=Ue.FURNI_ADDED;break;case W.UNIT:g=Ue.USER_ADDED;break}g&&(d=new Ue(g,h.objectId,h.category,h.roomId));break}case Rt.REMOVED:{let g=null;switch(h.category){case W.FLOOR:case W.WALL:g=Ue.FURNI_REMOVED;break;case W.UNIT:g=Ue.USER_REMOVED;break}g&&(d=new Ue(g,h.objectId,h.category,h.roomId));break}case Rt.REQUEST_MOVE:a_(a,h.objectId,h.category)&&ru(h.objectId,h.category,Ft.OBJECT_MOVE);break;case Rt.REQUEST_ROTATE:a_(a,h.objectId,h.category)&&ru(h.objectId,h.category,Ft.OBJECT_ROTATE_POSITIVE);break;case Rt.MOUSE_ENTER:d=new Ue(Ue.OBJECT_ROLL_OVER,h.objectId,h.category,h.roomId);break;case Rt.MOUSE_LEAVE:d=new Ue(Ue.OBJECT_ROLL_OUT,h.objectId,h.category,h.roomId);break;case Rt.DOUBLE_CLICK:d=new Ue(Ue.OBJECT_DOUBLE_CLICKED,h.objectId,h.category,h.roomId);break}d&&Fs(d)}),_.useEffect(()=>{if(!a)return;const h=Jt(),d=tt(),g=a.roomId,E=1,m=Math.floor(window.innerWidth),I=Math.floor(window.innerHeight),p=h.application.renderer;p&&(p.view.style.width=`${m}px`,p.view.style.height=`${I}px`,p.resolution=window.devicePixelRatio,p.resize(m,I));const T=d.getRoomInstanceDisplay(g,E,m,I,dl.SCALE_ZOOMED_IN),R=tt().getRoomInstanceRenderingCanvas(g,E);if(!T||!R)return;const S=new Xe(gS.WHITE),b=new HN,N=R.master;S.tint=0,S.width=m,S.height=I,N.addChildAt(S,0),N.filters=[b],s(S),n(b);const P=d.getRoomInstanceGeometry(g,E);if(P){const w=d.getRoomInstanceVariable(g,cs.ROOM_MIN_X)||0,U=d.getRoomInstanceVariable(g,cs.ROOM_MAX_X)||0,G=d.getRoomInstanceVariable(g,cs.ROOM_MIN_Y)||0,K=d.getRoomInstanceVariable(g,cs.ROOM_MAX_Y)||0;let z=(w+U)/2,et=(G+K)/2;const rt=20;z=z+(rt-1),et=et+(rt-1);const J=Math.sqrt(rt*rt+rt*rt)*Math.tan(30/180*Math.PI);P.location=new j(z,et,J)}const B=h.application.stage;if(!B)return;B.addChild(T),oA(a.roomId);const F=w=>{const U=Math.floor(window.innerWidth),G=Math.floor(window.innerHeight);p.view.style.width=`${U}px`,p.view.style.height=`${G}px`,p.resolution=window.devicePixelRatio,p.resize(U,G),S.width=U,S.height=G,d7(U,G,1),h.application.render()};return window.addEventListener("resize",F),()=>{s(null),n(null),l(0),window.removeEventListener("resize",F)}},[a]),{roomSession:a}},ye=()=>Ts(u9),h9=()=>{const[a,t]=_.useState(-1),[e,s]=_.useState(-1),[i,n]=_.useState(0),{roomSession:o=null}=ye(),l=()=>{const h=ii.rgbToHSL(i),[d,g,E,m]=ir.int_to_8BitVals(h);k(new bP(a,g,E,m))},c=()=>o.useMultistateItem(a),u=()=>{Fs(new el(el.CLEAR_PREVIEW)),t(-1),s(-1),n(0)};return ne(nt.REQUEST_BACKGROUND_COLOR,h=>{if(!a_(o,h.objectId,h.category))return;const g=tt().getRoomObject(h.roomId,h.objectId,h.category).model;t(h.objectId),s(h.category);const E=parseInt(g.getValue(C.FURNITURE_ROOM_BACKGROUND_COLOR_HUE)),m=parseInt(g.getValue(C.FURNITURE_ROOM_BACKGROUND_COLOR_SATURATION)),I=parseInt(g.getValue(C.FURNITURE_ROOM_BACKGROUND_COLOR_LIGHTNESS)),p=ir.eight_bitVals_to_int(0,E,m,I),T=ii.hslToRGB(p);n(T)}),Xr(a!==-1&&e!==-1,h=>{h.id!==a||h.category!==e||u()}),_.useEffect(()=>{if(a===-1||e===-1)return;const h=ii.rgbToHSL(i),[d,g,E,m]=ir.int_to_8BitVals(h);Fs(new el(el.PREVIEW,g,E,m))},[a,e,i]),{objectId:a,color:i,setColor:n,applyToner:l,toggleToner:c,onClose:u}},d9=h9,_9=()=>{const[a,t]=_.useState(-1),[e,s]=_.useState(-1),[i,n]=_.useState("1"),[o,l]=_.useState(""),[c,u]=_.useState(""),[h,d]=_.useState(""),[g,E]=_.useState(""),{simpleAlert:m=null}=He(),I=()=>{t(-1),s(-1),n("1"),l(""),u(""),d(""),E("")};return ne([nt.REQUEST_BADGE_DISPLAY_ENGRAVING,nt.REQUEST_ACHIEVEMENT_RESOLUTION_ENGRAVING],p=>{const T=tt().getRoomObject(p.roomId,p.objectId,p.category);if(!T)return;const R=new Vn;R.initializeFromRoomObjectModel(T.model),t(p.objectId),s(p.category),n("1"),l(gh(R.getValue(1))),u(MO(R.getValue(1))),d(R.getValue(2)),E(R.getValue(3))}),ne(nt.REQUEST_ACHIEVEMENT_RESOLUTION_FAILED,p=>{const T=tt().getRoomObject(p.roomId,p.objectId,p.category);!T||T.model.getValue(C.FURNITURE_OWNER_ID)!==q().userId||m(`${f("resolution.failed.subtitle")} ${f("resolution.failed.text")}`,null,null,null,f("resolution.failed.title"))}),Xr(a!==-1&&e!==-1,p=>{p.id!==a||p.category!==e||I()}),{objectId:a,category:e,color:i,badgeName:o,badgeDesc:c,date:h,senderName:g,onClose:I}},g9=_9,eS="MONSTERPLANT_SEED_CONFIRMATION",sS="PURCHASABLE_CLOTHING_CONFIRMATION",B0="GROUP_FURNITURE",k0="EFFECTBOX_OPEN",iS="MYSTERYTROPHY_OPEN_DIALOG",f9=()=>{const[a,t]=_.useState(-1),[e,s]=_.useState(null),[i,n]=_.useState(null),[o,l]=_.useState(-1),[c,u]=_.useState(null),[h,d]=_.useState(!1),[g,E]=_.useState(-1),{roomSession:m=null}=ye(),I=()=>{t(-1),u(null),d(!1),s(null)},p=()=>{n(null),l(-1)},T=R=>{if(R)switch(R){case"use_friend_furni":m.useMultistateItem(a);break;case"use_monsterplant_seed":n(eS),l(a);break;case"use_random_teleport":tt().useRoomObject(a,W.FLOOR);break;case"use_purchaseable_clothing":n(sS),l(a);break;case"use_mystery_box":m.useMultistateItem(a);break;case"use_mystery_trophy":n(iS),l(a);break;case"join_group":bO(c.guildId),d(!0);return;case"go_to_group_homeroom":c&&Yr(c.guildHomeRoomId);break}I()};return ne([nt.OPEN_FURNI_CONTEXT_MENU,nt.CLOSE_FURNI_CONTEXT_MENU,nt.REQUEST_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG,nt.REQUEST_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG,nt.REQUEST_EFFECTBOX_OPEN_DIALOG,nt.REQUEST_MYSTERYBOX_OPEN_DIALOG,nt.REQUEST_MYSTERYTROPHY_OPEN_DIALOG],R=>{const S=tt().getRoomObject(m.roomId,R.objectId,R.category);if(S)switch(E(S.model.getValue(C.FURNITURE_OWNER_ID)),R.type){case nt.REQUEST_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG:if(!Oi(S))return;l(S.id),n(eS),I();return;case nt.REQUEST_EFFECTBOX_OPEN_DIALOG:if(!Oi(S))return;l(S.id),n(k0),I();return;case nt.REQUEST_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG:if(!Oi(S))return;l(S.id),n(sS),I();return;case nt.REQUEST_MYSTERYBOX_OPEN_DIALOG:m.useMultistateItem(S.id),I();return;case nt.REQUEST_MYSTERYTROPHY_OPEN_DIALOG:if(!Oi(S))return;l(S.id),n(iS),I();return;case nt.OPEN_FURNI_CONTEXT_MENU:switch(t(S.id),R.contextMenu){case ts.FRIEND_FURNITURE:s(ts.FRIEND_FURNITURE);return;case ts.MONSTERPLANT_SEED:Oi(S)&&s(ts.MONSTERPLANT_SEED);return;case ts.MYSTERY_BOX:s(ts.MYSTERY_BOX);return;case ts.MYSTERY_TROPHY:Oi(S)&&s(ts.MYSTERY_TROPHY);return;case ts.RANDOM_TELEPORT:s(ts.RANDOM_TELEPORT);return;case ts.PURCHASABLE_CLOTHING:Oi(S)&&s(ts.PURCHASABLE_CLOTHING);return}return;case nt.CLOSE_FURNI_CONTEXT_MENU:S.id===a&&I();return}}),Y(fD,R=>{const S=R.getParser();t(S.objectId),u(S),d(S.userIsMember),s(B0)}),{objectId:a,mode:e,confirmMode:i,confirmingObjectId:o,groupData:c,isGroupMember:h,objectOwnerId:g,closeConfirm:p,processAction:T,onClose:I}},m9=f9,E9=()=>{const[a,t]=_.useState(-1),[e,s]=_.useState([]),[i,n]=_.useState(null),[o,l]=_.useState([]),[c,u]=_.useState(null),[h,d]=_.useState(new Map),[g,E]=_.useState(!1),{groupItems:m=[],getItemsByType:I=null,activate:p=null,deactivate:T=null}=Bc(),{simpleAlert:R=null}=He(),S=i&&h.get(i.name)||null,b=()=>{s([]),n(null),l([]),d(new Map)},N=()=>{t(-1),b()},P=()=>{E(!0),k(new Vb(a,i.name))},B=F=>{n(F),h.get(F.name)||k(new Wb(F.name))};return ne(nt.OPEN_WIDGET,F=>{F.widget===Fd.CRAFTING&&(t(F.objectId),b(),k(new Hb(F.objectId)))}),Y(qx,F=>{const w=F.getParser();if(!w.isActive()){t(-1);return}s(U=>{const G=[];for(const K of w.recipes){const z=tt().roomContentLoader._activeObjectTypeIds.get(K.itemName),et=tt().getFurnitureFloorIconUrl(z);G.push({name:K.recipeName,localizedName:f("roomItem.name."+z),iconUrl:et})}return G}),u(w.ingredients)}),Y(Qx,F=>{const w=F.getParser();d(U=>{const G=new Map(U);return G.set(i.name,w.ingredients),G})}),Y($x,F=>{n(null),E(!1),F.getParser().result&&R(f("crafting.info.result.ok"))}),Y(Jx,F=>{}),_.useEffect(()=>{!c||!c.length||l(F=>{const w=[];for(const U of c){const G=tt().roomContentLoader._activeObjectTypeIds.get(U),K=tt().getFurnitureFloorIconUrl(G),z=I(G);let et=0;if(z)for(const rt of z)et+=rt.items.length;w.push({name:U,iconUrl:K,count:et})}return w})},[m,c,I]),_.useEffect(()=>{if(a===-1)return;const F=p();return()=>T(F)},[a,p,T]),{objectId:a,recipes:e,ingredients:o,selectedRecipe:i,requiredIngredients:S,isCrafting:g,selectRecipe:B,craft:P,onClose:N}},p9=E9,I9=()=>{const[a,t]=_.useState([]),[e,s]=_.useState(0),[i,n]=_.useState(0),[o,l]=_.useState(0),[c,u]=_.useState(0),[h,d]=_.useState(16777215),[g,E]=_.useState(255),[m,I]=_.useState(0),[p,T]=_.useState(0),[R,S]=_.useState(0),{roomSession:b=null}=ye(),N=()=>b.isRoomOwner||b.controllerLevel>=Oe.GUEST||q().isModerator,P=F=>{const w=a[F-1];w&&(s(w.id),I(w.type),T(w.color),S(w.light))},B=()=>{if(i===0)return;const F=e-1;if(e<1||e>a.length)return;const w=a[F];!w||m===w.type&&p===w.color&&R===w.light||(t(U=>{const G=[...U];return G[F]=new RA(w.id,m,p,R),G}),on.savePreset(w.id,m,p,R,!0))};return ne(nt.REQUEST_DIMMER,F=>{N()&&b.requestMoodlightSettings()}),we(Hd.ROOM_DIMMER_PRESETS,F=>{const w=[];let U=0;for(;U<F.presetCount;){const G=F.getPreset(U);G&&w.push(new RA(G.id,G.type,G.color,G.brightness)),U++}t(w),s(F.selectedPresetId)}),ne(Tg.ROOM_COLOR,F=>{wn.isRoomPreviewerId(F.roomId)||(l(i),n(F.state),s(F.presetId),u(F.effectId),I(F.effectId),d(F.color),T(F.color),E(F.brightness),S(F.brightness))}),_.useEffect(()=>{i===0&&o===0||on.previewDimmer(p,R,m===2)},[i,o,p,R,m]),{presets:a,selectedPresetId:e,dimmerState:i,lastDimmerState:o,effectId:c,color:h,brightness:g,selectedEffectId:m,setSelectedEffectId:I,selectedColor:p,setSelectedColor:T,selectedBrightness:R,setSelectedBrightness:S,selectPresetId:P,applyChanges:B}},T9=I9,R9=()=>{const[a,t]=_.useState(-1),[e,s]=_.useState(-1),[i,n]=_.useState(0),o=()=>{t(-1),s(-1),n(0)},l=()=>{ie().connection.send(new OP(a)),o()};return ne(nt.REQUEST_CREDITFURNI,c=>{const u=tt().getRoomObject(c.roomId,c.objectId,c.category);!u||!Oi(u)||(t(c.objectId),s(c.category),n(u.model.getValue(C.FURNITURE_CREDIT_VALUE)||0))}),Xr(a!==-1&&e!==-1,c=>{c.id!==a||c.category!==e||o()}),{objectId:a,value:i,redeem:l,onClose:o}},S9=R9,O9=()=>{const[a,t]=_.useState(-1),[e,s]=_.useState(-1),[i,n]=_.useState(-1),[o,l]=_.useState([]),{roomSession:c=null}=ye(),u=()=>{t(-1),s(-1),n(-1),l([])};return ne(nt.REQUEST_EXTERNAL_IMAGE,h=>{const d=tt().getRoomObject(h.roomId,h.objectId,h.category),g=tt().getRoomObjects(c==null?void 0:c.roomId,W.WALL);if(!d)return;const E=[];g.forEach(I=>{if(I.type!=="external_image_wallitem_poster_small")return null;const p=I.model.getValue(C.FURNITURE_DATA),T=JSON.parse(p);E.push(T)}),t(h.objectId),s(h.category),l(E);const m=JSON.parse(d.model.getValue(C.FURNITURE_DATA));n(I=>{let p=0;return m&&(p=E.findIndex(T=>T.u===m.u)),p<0&&(p=0),p})}),Xr(a!==-1&&e!==-1,h=>{h.id!==a||h.category!==e||u()}),{objectId:a,currentPhotoIndex:i,currentPhotos:o,onClose:u}},C9=O9,A9=()=>{const[a,t]=_.useState(-1),[e,s]=_.useState(-1),[i,n]=_.useState(0),[o,l]=_.useState([]),[c,u]=_.useState([]),[h,d]=_.useState(null),[g,E]=_.useState(0),m=()=>{t(-1),s(-1),n(0),l([]),u([]),d(null)},I=p=>{ie().connection.send(new zb(a,p)),m()};return Y(pD,p=>{const T=p.getParser();t(T.furniId),E(T.start?1:2)}),Y(mD,p=>m()),Y(ED,p=>m()),ne(nt.REQUEST_FRIEND_FURNITURE_ENGRAVING,p=>{const T=tt().getRoomObject(p.roomId,p.objectId,p.category);if(!T)return;const R=T.model.getValue(C.FURNITURE_DATA),S=T.model.getValue(C.FURNITURE_FRIENDFURNI_ENGRAVING);R[0]!=="1"||R.length!==6||(t(p.objectId),s(p.category),n(S),l([R[1],R[2]]),u([R[3],R[4]]),d(R[5]),E(0))}),Xr(a!==-1&&e!==-1,p=>{p.id!==a||p.category!==e||m()}),{objectId:a,type:i,usernames:o,figures:c,date:h,stage:g,onClose:m,respond:I}},N9=A9,x9=["perteam","mostwins","classic"],M9=["alltime","daily","weekly","monthly"],y9=()=>{const[a,t]=_.useState(new Map),{roomSession:e=null}=ye(),s=n=>x9[n],i=n=>M9[n];return ne(nt.REQUEST_HIGH_SCORE_DISPLAY,n=>{const o=tt().getRoomObject(n.roomId,n.objectId,n.category);if(!o)return;const l=o.model.getValue(C.FURNITURE_DATA_FORMAT),c=Aa.getData(l);c.initializeFromRoomObjectModel(o.model),t(u=>{const h=new Map(u);return h.set(o.id,c),h})}),ne(nt.REQUEST_HIDE_HIGH_SCORE_DISPLAY,n=>{n.roomId===e.roomId&&t(o=>{const l=new Map(o);return l.delete(n.objectId),l})}),{stuffDatas:a,getScoreType:s,getClearType:i}},D9=y9,b9="internalLink",v9=()=>(ne(nt.REQUEST_INTERNAL_LINK,a=>{const t=tt().getRoomObject(a.roomId,a.objectId,a.category);if(!t)return;let s=t.model.getValue(C.FURNITURE_DATA)[b9];(!s||!s.length)&&(s=t.model.getValue(C.FURNITURE_INTERNAL_LINK)),s&&s.length&&ut(s)}),{}),L9=v9,P9=()=>{const[a,t]=_.useState(-1),[e,s]=_.useState(-1),[i,n]=_.useState(null),[o,l]=_.useState(null),[c,u]=_.useState(Fi.NO_CLUB),[h,d]=_.useState(null),g=()=>{t(-1),s(-1),n(null),l(null),d(null)},E=()=>{a!==-1&&(k(new xP(a)),g())},m=()=>{a!==-1&&(k(new uh(a)),g())},I=()=>{a!==-1&&k(new MP(a,h))};return ne(nt.REQUEST_MANNEQUIN,p=>{const T=tt().getRoomObject(p.roomId,p.objectId,p.category);if(!T)return;const R=T.model,S=R.getValue(C.FURNITURE_MANNEQUIN_FIGURE)||null,b=R.getValue(C.FURNITURE_MANNEQUIN_GENDER)||null,N=Gs().createFigureContainer(S),P=Gs().getFigureClubLevel(N,b,eh.MANNEQUIN_CLOTHING_PART_TYPES);t(p.objectId),s(p.category),n(S),l(b),u(P),d(R.getValue(C.FURNITURE_MANNEQUIN_NAME)||null)}),Xr(a!==-1&&e!==-1,p=>{p.id!==a||p.category!==e||g()}),{objectId:a,figure:i,gender:o,clubLevel:c,name:h,setName:d,saveFigure:E,wearFigure:m,saveName:I,onClose:g}},U9=P9,j9=()=>{const[a,t]=_.useState(-1),[e,s]=_.useState(-1),[i,n]=_.useState(-1),[o,l]=_.useState(new hs),[c,u]=_.useState([]),{roomSession:h=null}=ye(),{showSingleBubble:d=null,simpleAlert:g=null}=He(),E=()=>{t(-1),s(-1)},m=_.useCallback((R,S)=>k(new sU(R,S)),[]),I=_.useCallback(R=>k(new lU(R)),[]),p=_.useCallback((R,S)=>k(new uh(R,S)),[]);ne(nt.REQUEST_PLAYLIST_EDITOR,R=>{var b,N,P;const S=tt().getRoomObject(R.roomId,R.objectId,R.category);if(S){if(Oi(S)){t(R.objectId),s(R.category),(b=Jt().soundManager.musicController)==null||b.requestUserSongDisks(),(P=(N=Jt().soundManager.musicController)==null?void 0:N.getRoomItemPlaylist())==null||P.requestPlayList();return}(h.isRoomOwner||h.controllerLevel>=Oe.GUEST||q().isModerator)&&k(new uh(R.objectId,-2))}}),Xr(a!==-1&&e!==-1,R=>{R.id!==a||R.category!==e||E()}),Pl(xa.NPE_SONG_CHANGED,R=>{n(R.position)}),Pl(Tf.NOTIFY_PLAYED_SONG,R=>{d(f("soundmachine.notification.playing",["songname","songauthor"],[R.name,R.creator]),bi.SOUNDMACHINE)}),Pl(_c.SDIR_SONG_DISK_INVENTORY_RECEIVENT_EVENT,R=>{var S;l((S=Jt().soundManager.musicController)==null?void 0:S.songDiskInventory.clone())}),Pl(Ta.PLUE_PLAY_LIST_UPDATED,R=>{var S,b;u((b=(S=Jt().soundManager.musicController)==null?void 0:S.getRoomItemPlaylist())==null?void 0:b.entries.concat())}),Pl(Ta.PLUE_PLAY_LIST_FULL,R=>{g(f("playlist.editor.alert.playlist.full"),Bt.ALERT,"","",f("playlist.editor.alert.playlist.full.title"))});const T=R=>{var S,b;a!==-1&&(R instanceof Wg?R.getParser().fragmentNumber===0&&((S=Jt().soundManager.musicController)==null||S.requestUserSongDisks()):(b=Jt().soundManager.musicController)==null||b.requestUserSongDisks())};return Y(Wg,T),Y(GS,T),Y(FS,T),{objectId:a,diskInventory:o,playlist:c,currentPlayingIndex:i,onClose:E,addToPlaylist:m,removeFromPlaylist:I,togglePlayPause:p}},w9=j9,bA="floor",F9="wallpaper",vA="landscape",G9="poster",B9=()=>{const[a,t]=_.useState(-1),[e,s]=_.useState(-1),[i,n]=_.useState(null),[o,l]=_.useState(null),[c,u]=_.useState(!1),[h,d]=_.useState(null),[g,E]=_.useState(null),[m,I]=_.useState(-1),[p,T]=_.useState(null),[R,S]=_.useState(!1),[b,N]=_.useState(null),{roomSession:P=null}=ye(),B=()=>{t(-1),s(-1),n(null),l(null),u(!1),d(null),E(null),I(-1),T(null),S(!1),N(null)},F=()=>{a!==-1&&(P.openGift(a),tt().changeObjectModelData(tt().activeRoomId,a,W.FLOOR,C.FURNITURE_DISABLE_PICKING_ANIMATION,1))},w=_.useMemo(()=>({imageReady:(U,G,K)=>{!K&&G&&(K=Ee.generateImage(G)),N(K.src)},imageFailed:null}),[]);return we(Wd.RSPE_PRESENT_OPENED,U=>{let G=null;U.itemType===Yt.FLOOR?G=q().getFloorItemData(U.classId):U.itemType===Yt.WALL&&(G=q().getWallItemData(U.classId));let K=!1;if(U.placedInRoom){const z=tt().getRoomObject(P.roomId,U.placedItemId,W.FLOOR);z&&(K=Oi(z))}switch(U.itemType){case Yt.WALL:{if(G)switch(G.className){case bA:case vA:case F9:let z=null;G.className===bA?z=f("inventory.furni.item.floor.name"):G.className===vA?z=f("inventory.furni.item.landscape.name"):z=f("inventory.furni.item.wallpaper.name"),l(z);break;case G9:{const et=U.productCode;let rt=null;et.indexOf("poster")===0&&(rt=et.replace("poster",""));const J=q().getProductData(et);let Ct=null;J?Ct=J.name:G&&(Ct=G.name),l(Ct),N(tt().getFurnitureWallIconUrl(U.classId,rt));break}default:{l(G.name||null),N(tt().getFurnitureWallIconUrl(U.classId));break}}break}case Yt.HABBO_CLUB:l(f("widget.furni.present.hc"));break;default:{if(U.placedItemType===Yt.PET){const et=U.petFigureString;if(et&&et.length){const rt=new La(et),J=tt().getRoomObjectPetImage(rt.typeId,rt.paletteId,rt.color,new j(90),64,w,!0,0,rt.customParts);J&&N(J.getImage().src)}}else{const et=tt().getFurnitureFloorImage(U.classId,new j(90),64,w);et&&N(et.getImage().src)}const z=q().getProductData(U.productCode);l(z&&z.name||G.name);break}}t(0),s(U.classId),n(U.itemType),u(K),I(U.placedItemId),T(U.placedItemType),S(U.placedInRoom)}),ne(nt.REQUEST_PRESENT,U=>{const G=tt().getRoomObject(U.roomId,U.objectId,U.category);if(!G)return null;B(),t(U.objectId),s(-1),l(G.model.getValue(C.FURNITURE_DATA)||""),u(Oi(G)),d(G.model.getValue(C.FURNITURE_PURCHASER_NAME)||null),E(G.model.getValue(C.FURNITURE_PURCHASER_FIGURE)||null)}),Xr(a!==-1,U=>{U.id===a&&B(),U.id===m&&R&&S(!1)}),{objectId:a,classId:e,itemType:i,text:o,isOwnerOfFurniture:c,senderName:h,senderFigure:g,placedItemId:m,placedItemType:p,placedInRoom:R,imageUrl:b,openPresent:F,onClose:B}},k9=B9,V9="internalLink",H9=()=>{const[a,t]=_.useState(0);return ne(nt.REQUEST_ROOM_LINK,e=>{const s=tt().getRoomObject(e.roomId,e.objectId,e.category);if(!s)return;let n=s.model.getValue(C.FURNITURE_DATA)[V9];(!n||!n.length)&&(n=s.model.getValue(C.FURNITURE_INTERNAL_LINK)),!(!n||!n.length)&&(n=parseInt(n,10),!isNaN(n)&&(t(n),k(new Zd(n,!1,!1))))}),Y(po,e=>{!a||e.getParser().data.roomId!==a||t(0)}),{}},W9=H9,Y9=()=>{const[a,t]=_.useState(-1),[e,s]=_.useState(-1),[i,n]=_.useState(""),[o,l]=_.useState(""),[c,u]=_.useState("0"),[h,d]=_.useState(""),[g,E]=_.useState(!1),{getWallItemById:m=null}=Bc(),I=()=>{k(new dP(a,o,c,h)),t(-1),s(-1),n(""),l(""),u("0"),d(""),E(!1)};return Y(ID,p=>{const T=p.getParser();t(T.itemId),s(W.WALL);const R=m(T.itemId);let S="post_it";if(R){const b=tt().getFurnitureWallName(R.type);b.match("post_it_")&&(S=b)}n(S),l(T.location),u("FFFF33"),d(""),E(!0)}),{objectId:a,color:c,setColor:u,text:h,setText:d,canModify:g,onClose:I}},z9=Y9,Dp=60,K9=()=>{const[a,t]=_.useState(-1),[e,s]=_.useState(-1),[i,n]=_.useState(0),[o,l]=_.useState(-1),c=()=>{t(-1),s(-1),n(0),l(-1)},u=(h,d=!1)=>{h||(h=0),h=Math.abs(h),d||h>Dp&&(h=Dp),n(parseFloat(h.toFixed(2))),d||l(h*100)};return Y(gD,h=>{const d=h.getParser();a===d.furniId&&u(d.height,!0)}),ne(nt.REQUEST_STACK_HEIGHT,h=>{if(!a_(ie(),h.objectId,h.category))return;const d=tt().getRoomObject(h.roomId,h.objectId,h.category);d&&(t(h.objectId),s(h.category),n(d.getLocation().z),l(-1))}),Xr(a!==-1&&e!==-1,h=>{h.id!==a||h.category!==e||c()}),_.useEffect(()=>{if(a===-1||o===-1)return;const h=setTimeout(()=>k(new af(a,~~o)),10);return()=>clearTimeout(h)},[a,o]),{objectId:a,height:i,maxHeight:Dp,onClose:c,updateHeight:u}},X9=K9,q9=()=>{const[a,t]=_.useState(-1),[e,s]=_.useState(-1),[i,n]=_.useState("0"),[o,l]=_.useState(""),[c,u]=_.useState(""),[h,d]=_.useState(!1),g=()=>{t(-1),s(-1),n("0"),l(""),u(""),d(!1)},E=p=>{p!==i&&(n(p),tt().modifyRoomObjectData(a,e,p,o))},m=p=>{l(p),tt().modifyRoomObjectData(a,e,i,p)},I=()=>tt().deleteRoomObject(a,e);return ne(nt.REQUEST_STICKIE,p=>{const T=tt().getRoomObject(p.roomId,p.objectId,p.category);if(!T)return;const R=T.model.getValue(C.FURNITURE_ITEMDATA);if(R.length<6)return;let S=null,b=null;R.indexOf(" ")>0?(S=R.slice(0,R.indexOf(" ")),b=R.slice(R.indexOf(" ")+1,R.length)):S=R,t(p.objectId),s(p.category),n(S||"0"),l(b||""),u(T.type||"post_it"),d(ie().isRoomOwner||q().isModerator||Oi(T))}),Xr(a!==-1&&e!==-1,p=>{p.id!==a||p.category!==e||g()}),{objectId:a,color:i,text:o,type:c,canModify:h,updateColor:E,updateText:m,trash:I,onClose:g}},Q9=q9,J9=()=>{const[a,t]=_.useState(-1),[e,s]=_.useState(-1),[i,n]=_.useState("1"),[o,l]=_.useState(""),[c,u]=_.useState(""),[h,d]=_.useState(""),g=()=>{t(-1),s(-1),n("1"),l(""),u(""),d("")};return ne(nt.REQUEST_TROPHY,E=>{const m=tt().getRoomObject(E.roomId,E.objectId,E.category);if(!m)return;let I=m.model.getValue(C.FURNITURE_DATA);m.model.getValue(C.FURNITURE_EXTRAS),t(E.objectId),s(E.category),n(m.model.getValue(C.FURNITURE_COLOR)||"1");const p=I.substring(0,I.indexOf("	"));I=I.substring(p.length+1,I.length);const T=I.substring(0,I.indexOf("	")),R=I.substr(T.length+1,I.length);l(p),u(T),d(R)}),Xr(a!==-1&&e!==-1,E=>{E.id!==a||E.category!==e||g()}),{objectId:a,color:i,senderName:o,date:c,message:h,onClose:g}},$9=J9,Z9=0,tQ=1,eQ=2,sQ=3,iQ=()=>{const[a,t]=_.useState(-1),[e,s]=_.useState(-1),[i,n]=_.useState(null),[o,l]=_.useState(null),[c,u]=_.useState(null),[h,d]=_.useState(-1),[g,E]=_.useState(null),[m,I]=_.useState(null),[p,T]=_.useState(!1),R=()=>{t(-1),s(-1),n(null),l(null),u(null),d(-1),E(null),I(null),T(!1)},S=()=>k(new Ah(a,Z9)),b=()=>k(new Ah(a,tQ)),N=()=>p&&i&&i.length&&k(new Ah(a,eQ)),P=()=>p&&i&&i.length&&k(new Ah(a,sQ)),B=F=>{if(g===F){E(null),k(new zT(a,""));return}E(F),k(new zT(a,F))};return ne(nt.REQUEST_YOUTUBE,F=>{if(wn.isRoomPreviewerId(F.roomId))return;const w=tt().getRoomObject(F.roomId,F.objectId,F.category);w&&(t(F.objectId),s(F.category),T(q().hasSecurity(Cc.EMPLOYEE)||Oi(w)),k(new LP(F.objectId)))}),Y(OD,F=>{const w=F.getParser();a===-1||a!==w.furniId||(n(w.videoId),l(w.startAtSeconds),u(w.endAtSeconds),d(w.state))}),Y(SD,F=>{const w=F.getParser();a===-1||a!==w.furniId||(I(w.playlists),E(w.selectedPlaylistId),n(null),d(-1),u(null),l(null))}),Y(RD,F=>{const w=F.getParser();if(!(a===-1||a!==w.furniId))switch(w.commandId){case 1:d(sl.PLAYING);break;case 2:d(sl.PAUSED);break}}),Xr(a!==-1&&e!==-1,F=>{F.id!==a||F.category!==e||R()}),{objectId:a,videoId:i,videoStart:o,videoEnd:c,currentVideoState:h,selectedVideo:g,playlists:m,onClose:R,previous:S,next:b,pause:N,play:P,selectVideo:B}},rQ=iQ,nQ=()=>{const[a,t]=_.useState(null),[e,s]=_.useState([]),[i,n]=_.useState(""),[o,l]=_.useState([]),[c,u]=_.useState(0),[h,d]=_.useState(xt.STUFF_SELECTION_OPTION_NONE),{showConfirm:g=null}=He(),E=()=>{const I=p=>{p&&(p instanceof NS?k(new ZP(p.id,e,i,o,c,p.stuffTypeSelectionCode)):p instanceof AS?k(new eU(p.id,e,i,o,p.stuffTypeSelectionCode)):p instanceof CS&&k(new tU(p.id,e,i,o,p.stuffTypeSelectionCode)))};c7(a.id)?I(a):g(f("wiredfurni.nonowner.change.confirm.body"),()=>{I(a)},null,null,null,f("wiredfurni.nonowner.change.confirm.title"))},m=(I,p)=>{if(!a||!h||I<=0)return;const T=[...o],R=o.indexOf(I);R>=0?(T.splice(R,1),Tc.hide(I)):T.length<a.maximumItemSelectionCount&&(T.push(I),Tc.show(I)),l(T)};return Y(wD,I=>{I.getParser(),t(null)}),Y(PD,I=>{const p=I.getParser();t(p.definition)}),Y(UD,I=>{const p=I.getParser();t(p.definition)}),Y(jD,I=>{const p=I.getParser();t(p.definition)}),_.useEffect(()=>{if(a)return()=>{s([]),n(""),u(0),l(I=>(I&&I.length&&Tc.clearSelectionShaderFromFurni(I),[])),d(xt.STUFF_SELECTION_OPTION_NONE)}},[a]),{trigger:a,setTrigger:t,intParams:e,setIntParams:s,stringParam:i,setStringParam:n,furniIds:o,setFurniIds:l,actionDelay:c,setActionDelay:u,setAllowsFurni:d,saveWired:E,selectObjectForWired:m}},Xt=()=>Ts(nQ),aQ=()=>{const[a,t]=_.useState(null),[e,s]=_.useState(null),[i,n]=_.useState([]),[o,l]=_.useState([]),[c,u]=_.useState(null),[h,d]=_.useState(-1),[g,E]=_.useState(!1),{friends:m=[]}=ar(),{selectObjectForWired:I=null}=Xt(),{roomSession:p=null}=ye(),T=P=>{n(B=>{const F=[...B];return F.splice(P,1),F})},R=P=>{l(B=>{const F=[...B],w=F.splice(P,1)[0];return c===w&&u(null),F})},S=P=>{u(P),l([])},b=(P,B)=>{const F=Yc.getObjectName(P,B);F&&(s(F),B!==W.UNIT&&l([]))},N=(P,B)=>{let F=null;switch(B){case W.FLOOR:case W.WALL:F=Yc.getFurniInfo(P,B),F&&I(P,B);break;case W.UNIT:{const w=p.userDataManager.getUserDataByIndex(P);if(!w)break;switch(w.type){case be.PET:p.userDataManager.requestPetInfo(w.webID),d(w.webID);break;case be.USER:F=Yc.getUserInfo(B,w);break;case be.BOT:F=Yc.getBotInfo(B,w);break;case be.RENTABLE_BOT:F=Yc.getRentableBotInfo(B,w);break}}}F&&t(F)};return we(yg.USER_DATA_UPDATED,P=>{if(!P.addedUsers.length)return;let B=[];P.addedUsers.forEach(F=>{F.webID!==q().userId&&m.find(w=>w.id===F.webID)&&B.push(new R0(F.roomIndex,W.UNIT,F.webID,F.name,F.type,!0))}),B.length&&n(F=>{const w=[...F];return B.forEach(U=>{const G=w.findIndex(K=>K.id===U.id);G>-1&&w.splice(G,1),w.push(U)}),w})}),we(Cg.PET_INFO,P=>{const B=P.petInfo;if(!B||B.id!==h)return;const F=Yc.getPetInfo(B);F&&(t(F),d(-1))}),we(Ag.PET_STATUS_UPDATE,P=>{}),ne(sh.USE_PRODUCT_FROM_INVENTORY,P=>{}),ne(sh.USE_PRODUCT_FROM_ROOM,P=>{const B=tt().getRoomObject(p.roomId,P.objectId,W.FLOOR);if(!B||!Oi(B))return;const F=B.model.getValue(C.FURNITURE_OWNER_ID),w=B.model.getValue(C.FURNITURE_TYPE_ID),U=q().getFloorItemData(w),G=U.customParams.split(" "),K=G.length?parseInt(G[0]):-1;if(K===-1)return;const z=[],et=tt().getRoomObjects(p.roomId,W.UNIT);for(const rt of et){const J=p.userDataManager.getUserDataByIndex(rt.id);let Ct=!1;if(!(!J||J.type!==be.PET)){if(J.ownerId===F){J.hasSaddle&&U.specialType===vt.PET_SADDLE&&(Ct=!0);const At=J.figure.split(" ");if((At.length?parseInt(At[0]):-1)===K){if(U.specialType===vt.MONSTERPLANT_REVIVAL&&!J.canRevive||U.specialType===vt.MONSTERPLANT_REBREED&&(J.petLevel<7||J.canRevive||J.canBreed)||U.specialType===vt.MONSTERPLANT_FERTILIZE&&(J.petLevel>=7||J.canRevive))continue;z.push(new o8(J.roomIndex,W.UNIT,J.name,P.objectId,rt.id,-1,Ct))}}}}u(null),z.length&&l(z)}),ne(Rt.REQUEST_MANIPULATION,P=>{a_(p,P.objectId,P.category)&&E(!0)}),FO(P=>{N(P.id,P.category)}),a9(P=>{t(null),l([])}),l9(P=>{a||P.category!==W.UNIT||b(P.id,P.category)}),o9(P=>{!e||P.category!==W.UNIT||e.roomIndex!==P.id||s(null)}),Is([Ue.FURNI_REMOVED,Ue.USER_REMOVED],P=>{if(e&&e.category===P.category&&e.roomIndex===P.id&&s(null),P.category===W.UNIT){let B=i.findIndex(F=>F.roomIndex===P.id);B>-1&&n(F=>F.filter(w=>w.roomIndex===P.id)),B=o.findIndex(F=>F.id===P.id),B>-1&&l(F=>F.filter(w=>w.id!==P.id))}else P.category===W.FLOOR&&o.findIndex(F=>F.id===P.id)>-1&&l(F=>F.filter(w=>w.requestRoomObjectId!==P.id));a&&(a instanceof vc?a.id===P.id&&t(null):(a instanceof Ls||a instanceof Pc||a instanceof Lc)&&a.roomIndex===P.id&&t(null))}),_.useEffect(()=>{a&&(s(null),n([]),l([]))},[a]),_.useEffect(()=>{e&&n([])},[e]),_.useEffect(()=>{p.isDecorating=g},[p,g]),{avatarInfo:a,setAvatarInfo:t,activeNameBubble:e,setActiveNameBubble:s,nameBubbles:i,productBubbles:o,confirmingProduct:c,isDecorating:g,setIsDecorating:E,removeNameBubble:T,removeProductBubble:R,updateConfirmingProduct:S,getObjectName:b}},V0=aQ,oQ=()=>{const[a,t]=_.useState(""),[e,s]=_.useState(!1),[i,n]=_.useState(!1),[o,l]=_.useState(!1),[c,u]=_.useState(!1),[h,d]=_.useState(0),{showNitroAlert:g=null,showConfirm:E=null}=He(),{roomSession:m=null}=ye();V0();const I=(p,T,R="",S=0)=>{if(p==="")return null;const b=p.split(" ");if(b.length>0){const N=b[0];let P="";if(b.length>1&&(P=b[1]),N.charAt(0)===":"&&P==="x"){const B=tt().selectedAvatarId;if(B>-1){const F=m.userDataManager.getUserDataByIndex(B);F&&(P=F.name,p=p.replace(" x"," "+F.name))}}switch(N.toLowerCase()){case":shake":return ah.init(2500,5e3),ah.turnVisualizationOn(),null;case":rotate":return zd.init(2500,5e3),zd.turnVisualizationOn(),null;case":d":case";d":Wr()===Fi.VIP&&m.sendExpressionMessage(cn.LAUGH.ordinal);break;case"o/":case"_o/":return m.sendExpressionMessage(cn.WAVE.ordinal),null;case":kiss":if(Wr()===Fi.VIP)return m.sendExpressionMessage(cn.BLOW.ordinal),null;break;case":jump":if(Wr()===Fi.VIP)return m.sendExpressionMessage(cn.JUMP.ordinal),null;break;case":idle":return m.sendExpressionMessage(cn.IDLE.ordinal),null;case"_b":return m.sendExpressionMessage(cn.RESPECT.ordinal),null;case":sign":return m.sendSignMessage(parseInt(P)),null;case":iddqd":case":flip":return tt().events.dispatchEvent(new Ac(m.roomId,-1,!0)),null;case":zoom":return tt().events.dispatchEvent(new Ac(m.roomId,parseFloat(P),!1)),null;case":screenshot":const B=tt().createTextureFromRoom(m.roomId,1),F=new Image;return F.src=Ee.generateImageUrl(B),window.open("").document.write(F.outerHTML),null;case":pickall":return(m.isRoomOwner||q().isModerator)&&E(f("room.confirm.pick_all"),()=>{q().sendSpecialCommandMessage(":pickall")},null,null,null,f("generic.alert.title")),null;case":ejectall":return(m.isRoomOwner||q().isModerator||m.controllerLevel>=Oe.GUEST)&&E(f("room.confirm.eject_all"),()=>{q().sendSpecialCommandMessage(":ejectall")},null,null,null,f("generic.alert.title")),null;case":furni":return ut("furni-chooser/"),null;case":chooser":return ut("user-chooser/"),null;case":floor":case":bcfloor":return m.controllerLevel>=Oe.ROOM_OWNER&&ut("floor-editor/show"),null;case":togglefps":return fi().maxFPS>0?fi().maxFPS=0:fi().maxFPS=it("system.animation.fps"),null;case":client":case":nitro":case":billsonnn":return g(),null;case":ct":return tt().setRoomEngineGameMode(ie().roomId,!0),null;case":settings":return(m.isRoomOwner||q().isModerator)&&k(new aO(m.roomId)),null}}switch(T){case Oa.CHAT_DEFAULT:m.sendChatMessage(p,S);break;case Oa.CHAT_SHOUT:m.sendShoutMessage(p,S);break;case Oa.CHAT_WHISPER:m.sendWhisperMessage(R,p,S);break}};return we(ue.FLOOD_EVENT,p=>{u(!0),d(parseFloat(p.message))}),FO(p=>{if(p.category!==W.UNIT)return;const T=m.userDataManager.getUserDataByIndex(p.id);T&&t(T.name)}),ne(Rt.DESELECTED,p=>t("")),_.useEffect(()=>{if(!c)return;let p=0;const T=setInterval(()=>{d(R=>(p=(R||0)-1,p)),p<0&&(clearInterval(T),u(!1))},1e3);return()=>clearInterval(T)},[c]),_.useEffect(()=>{if(!o)return;let p=null;return o&&(p=setTimeout(()=>{l(!1),s(!1)},1e4)),()=>clearTimeout(p)},[o]),_.useEffect(()=>{e?i||(n(!0),m.sendChatTypingMessage(e)):i&&(n(!1),m.sendChatTypingMessage(e))},[m,e,i]),{selectedUsername:a,floodBlocked:c,floodBlockedSeconds:h,setIsTyping:s,setIsIdle:l,sendChat:I}},lQ=oQ,LA=new Map,PA=new Map,UA=new Map,cQ=()=>{const[a,t]=_.useState([]),[e,s]=_.useState({mode:ns.CHAT_MODE_FREE_FLOW,weight:ns.CHAT_BUBBLE_WIDTH_NORMAL,speed:ns.CHAT_SCROLL_SPEED_NORMAL,distance:50,protection:ns.FLOOD_FILTER_NORMAL}),{roomSession:i=null}=ye(),{addChatEntry:n}=dp(),o=_.useRef(!1),l=_.useMemo(()=>{if(!e)return 6e3;switch(e.speed){case ns.CHAT_SCROLL_SPEED_FAST:return 3e3;case ns.CHAT_SCROLL_SPEED_NORMAL:return 6e3;case ns.CHAT_SCROLL_SPEED_SLOW:return 12e3}},[e]),c=d=>{const g=Gs().createAvatarImage(d,kr.LARGE,null,{resetFigure:I=>{o.current||c(I)},dispose:()=>{},disposed:!1});if(!g)return;const E=g.getCroppedImage(si.HEAD),m=g.getPartColor(Kt.CHEST);return LA.set(d,m&&m.rgb||16777215),g.dispose(),PA.set(d,E.src),E.src},u=d=>{let g=PA.get(d);return g||(g=c(d)),g},h=(d,g,E,m=64,I=null)=>{let p=UA.get(d+I);if(p)return p;const T=new La(d),R=T.typeId,S=tt().getRoomObjectPetImage(R,T.paletteId,T.color,new j(g*45),m,null,!1,0,T.customParts,I);return S&&(p=Ee.generateImageUrl(S.data),UA.set(d+I,p)),p};return we(ue.CHAT_EVENT,d=>{const g=tt().getRoomObject(i.roomId,d.objectId,W.UNIT),E=g?c0(i.roomId,g==null?void 0:g.id,W.UNIT):new ei,m=g?i.userDataManager.getUserDataByIndex(d.objectId):new s0(-1);let I="",p=0,T=null,R=d.chatType,S=d.style,b=0,N=d.message;if(m){b=m.type;const w=m.figure;switch(b){case be.PET:T=h(w,2,!0,64,g.model.getValue(C.FIGURE_POSTURE)),new La(w).typeId;break;case be.USER:T=u(w);break;case be.RENTABLE_BOT:case be.BOT:S=Jo.BOT;break}p=LA.get(w),I=m.name}switch(R){case ue.CHAT_TYPE_RESPECT:N=f("widgets.chatbubble.respect",["username"],[I]),it("respect.options").enabled&&Ua(it("respect.options").sound);break;case ue.CHAT_TYPE_PETREVIVE:case ue.CHAT_TYPE_PET_REBREED_FERTILIZE:case ue.CHAT_TYPE_PET_SPEED_FERTILIZE:{let w="widget.chatbubble.petrevived";R===ue.CHAT_TYPE_PET_REBREED_FERTILIZE?w="widget.chatbubble.petrefertilized;":R===ue.CHAT_TYPE_PET_SPEED_FERTILIZE&&(w="widget.chatbubble.petspeedfertilized");let U=null;if(tt().getRoomObject(i.roomId,d.extraParam,W.UNIT)){const K=i.userDataManager.getUserDataByIndex(g.id);K&&(U=K.name)}N=f(w,["petName","userName"],[I,U]);break}case ue.CHAT_TYPE_PETRESPECT:N=f("widget.chatbubble.petrespect",["petname"],[I]);break;case ue.CHAT_TYPE_PETTREAT:N=f("widget.chatbubble.pettreat",["petname"],[I]);break;case ue.CHAT_TYPE_HAND_ITEM_RECEIVED:N=f("widget.chatbubble.handitem",["username","handitem"],[I,f("handitem"+d.extraParam)]);break;case ue.CHAT_TYPE_MUTE_REMAINING:{const w=(d.extraParam>0?Math.floor(d.extraParam/3600):0).toString(),U=(d.extraParam>0?Math.floor(d.extraParam%3600/60):0).toString(),G=(d.extraParam%60).toString();N=f("widget.chatbubble.mutetime",["hours","minutes","seconds"],[w,U,G]);break}}const P=v7(N),B=p&&("#"+p.toString(16).padStart(6,"0")||null),F=new tS(m.roomIndex,W.UNIT,i.roomId,N,P,I,new ei(E.x,E.y),R,S,T,B);t(w=>[...w,F]),n({id:-1,webId:m.webID,entityId:m.roomIndex,name:I,imageUrl:T,style:S,chatType:R,entityType:m.type,message:P,timestamp:E0(),type:Bn.TYPE_CHAT,roomId:i.roomId,color:B})}),ne(Ig.ROOM_DRAG,d=>{if(!a.length||d.roomId!==i.roomId)return;const g=d.offsetX;a.forEach(E=>E.elementRef&&(E.left+=g))}),Y(po,d=>{const g=d.getParser();g.roomEnter&&s(g.chat)}),Y(uD,d=>{const g=d.getParser();s(g.chat)}),_.useEffect(()=>(o.current=!1,()=>{o.current=!0}),[]),{chatMessages:a,setChatMessages:t,chatSettings:e,getScrollSpeed:l}},uQ=cQ,hQ=()=>{const[a,t]=_.useState([]),e=n=>{a.indexOf(n)>=0||t([...a,n])},s=n=>{const o=a.indexOf(n);if(o===-1)return;const l=[...a];l.splice(o,1),t(l)},i=(n,o)=>{ie().sendDoorbellApprovalMessage(n,o),s(n)};return we(jn.DOORBELL,n=>e(n.userName)),we(jn.RSDE_REJECTED,n=>s(n.userName)),we(jn.RSDE_ACCEPTED,n=>s(n.userName)),{users:a,addUser:e,removeUser:s,answer:i}},dQ=hQ,_Q=()=>{const[a,t]=_.useState(null),[e,s]=_.useState(!1),i=()=>s(!1);return Y(Dy,n=>{const o=n.getParser();s(!0),t(o.words)}),{wordsFilter:a,isVisible:e,setWordsFilter:t,onClose:i}},gQ=_Q,fQ=()=>{const[a,t]=_.useState([]),{requests:e=[],dismissedRequestIds:s=[],setDismissedRequestIds:i=null}=ar(),n=_.useMemo(()=>a.filter(l=>s.indexOf(l.request.requesterUserId)===-1),[a,s]),o=l=>{i(c=>{if(c.indexOf(l)>=0)return c;const u=[...c];return u.push(l),u})};return F0(!0,l=>{if(l.category!==W.UNIT)return;const c=ie().userDataManager.getUserDataByIndex(l.id);if(!c||c.type!==me.getTypeNumber(me.USER))return;const u=e.find(d=>d.requesterUserId===c.webID);if(!u||a.find(d=>d.request.requesterUserId===c.webID))return;const h=[...a];h.push({roomIndex:c.roomIndex,request:u}),t(h)}),G0(!0,l=>{if(l.category!==W.UNIT)return;const c=a.findIndex(h=>h.roomIndex===l.id);if(c===-1)return;const u=[...a];u.splice(c,1),t(u)}),_.useEffect(()=>{const l=[];for(const c of e){const u=ie().userDataManager.getUserData(c.requesterUserId);u&&l.push({roomIndex:u.roomIndex,request:c})}t(l)},[e]),{displayedRequests:n,hideFriendRequest:o}},mQ=fQ,EQ=()=>{const[a,t]=_.useState(null),{roomSession:e=null}=ye(),s=()=>t(null),i=o=>o&&tt().selectRoomObject(ie().roomId,o.id,o.category),n=()=>{const o=q(),l=tt().getRoomObjects(e.roomId,W.WALL),c=tt().getRoomObjects(e.roomId,W.FLOOR),u=l.map(d=>{if(d.id<0)return null;let g=d.type;if(g.startsWith("poster"))g=f(`poster_${g.replace("poster","")}_name`);else{const E=d.model.getValue(C.FURNITURE_TYPE_ID),m=o.getWallItemData(E);m&&m.name.length&&(g=m.name)}return new nu(d.id,W.WALL,g)}),h=c.map(d=>{if(d.id<0)return null;let g=d.type;const E=d.model.getValue(C.FURNITURE_TYPE_ID),m=o.getFloorItemData(E);return m&&m.name.length&&(g=m.name),new nu(d.id,W.FLOOR,g)});t([...u,...h].sort((d,g)=>d.name<g.name?-1:1))};return n9(!!a,o=>{if(o.id<0)return;const l=tt().getRoomObject(ie().roomId,o.id,o.category);if(!l)return;let c=null;switch(o.category){case W.WALL:{let u=l.type;if(u.startsWith("poster"))u=f(`poster_${u.replace("poster","")}_name`);else{const h=l.model.getValue(C.FURNITURE_TYPE_ID),d=q().getWallItemData(h);d&&d.name.length&&(u=d.name)}c=new nu(l.id,W.WALL,u);break}case W.FLOOR:{let u=l.type;const h=l.model.getValue(C.FURNITURE_TYPE_ID),d=q().getFloorItemData(h);d&&d.name.length&&(u=d.name),c=new nu(l.id,W.FLOOR,u)}}t(u=>[...u,c].sort((h,d)=>h.name<d.name?-1:1))}),Xr(!!a,o=>{o.id<0||t(l=>{const c=[...l];for(let u=0;u<c.length;u++){const h=c[u];if(!(h.id!==o.id||h.category!==o.category)){c.splice(u,1);break}}return c})}),{items:a,onClose:s,selectItem:i,populateChooser:n}},pQ=EQ,IQ=()=>{const[a,t]=_.useState(!1),[e,s]=_.useState(-1),[i,n]=_.useState(""),[o,l]=_.useState(""),[c,u]=_.useState(""),h=()=>{u(""),l(""),n(""),s(-1),t(!1)},d=()=>{k(new cO(e,o))},g=m=>{l(m),c.length>0&&u("")},E=m=>{if(!(!m||m===0))switch(m){case 1:return f("catalog.alert.petname.long");case 2:return f("catalog.alert.petname.short");case 3:return f("catalog.alert.petname.chars");case 4:default:return f("catalog.alert.petname.bobba")}};return we(Zo.RSOPPE_OPEN_PET_PACKAGE_REQUESTED,m=>{if(!m)return;const I=tt().getRoomObject(m.session.roomId,m.objectId,W.FLOOR);s(m.objectId),n(I.type),t(!0)}),we(Zo.RSOPPE_OPEN_PET_PACKAGE_RESULT,m=>{m&&(m.nameValidationStatus===0&&h(),m.nameValidationStatus!==0&&u(E(m.nameValidationStatus)))}),{isVisible:a,errorResult:c,petName:o,objectType:i,onChangePetName:g,onConfirm:d,onClose:h}},TQ=IQ,RQ=()=>{const{roomSession:a=null}=ye(),t=i=>a.sendPollStartMessage(i),e=i=>a.sendPollRejectMessage(i),s=(i,n,o)=>a.sendPollAnswerMessage(i,n,o);return we(vn.OFFER,i=>{const n=new Do(Do.OFFER,i.id);n.summary=i.summary,n.headline=i.headline,Fs(n)}),we(vn.ERROR,i=>{const n=new Do(Do.ERROR,i.id);n.summary=i.summary,n.headline=i.headline,Fs(n)}),we(vn.CONTENT,i=>{const n=new Do(Do.CONTENT,i.id);n.startMessage=i.startMessage,n.endMessage=i.endMessage,n.numQuestions=i.numQuestions,n.questionArray=i.questionArray,n.npsPoll=i.npsPoll,Fs(n)}),{startPoll:t,rejectPoll:e,answerPoll:s}},SQ=RQ,OQ=()=>{const[a,t]=_.useState(null);ye();const e=()=>t(null),s=n=>n&&tt().selectRoomObject(ie().roomId,n.id,n.category),i=()=>{const n=ie(),o=tt().getRoomObjects(n.roomId,W.UNIT);t(o.map(l=>{if(l.id<0)return null;const c=n.userDataManager.getUserDataByIndex(l.id);return c?new nu(c.roomIndex,W.UNIT,c.name):null}).sort((l,c)=>l.name<c.name?-1:1))};return F0(!!a,n=>{if(n.id<0)return;const o=ie().userDataManager.getUserDataByIndex(n.id);o&&t(l=>{const c=[...l];return c.push(new nu(o.roomIndex,W.UNIT,o.name)),c.sort((u,h)=>u.name<h.name?-1:1),c})}),G0(!!a,n=>{n.id<0||t(o=>{const l=[...o];for(let c=0;c<l.length;c++){const u=l[c];if(!(u.id!==n.id||u.category!==n.category)){l.splice(c,1);break}}return l})}),{items:a,onClose:e,selectItem:s,populateChooser:i}},CQ=OQ,jA=4e3,AQ=3,NQ=()=>{const[a,t]=_.useState(-1),[e,s]=_.useState(null),[i,n]=_.useState(!1),[o,l]=_.useState(null),[c,u]=_.useState(new Map),[h,d]=_.useState(new Map),{answerPoll:g=null}=SQ(),{roomSession:E=null}=ye(),m=()=>{t(-1),s(null)},I=p=>{i||!e||(g(a,e.id,[p]),n(!0))};return we(Ln.ANSWERED,p=>{const T=E.userDataManager.getUserData(p.userId);T&&(u(p.answerCounts),d(R=>{if(!R.has(T.roomIndex)){const S=new Map(h);return S.set(T.roomIndex,{value:p.value,secondsLeft:AQ}),S}return R}),tt().updateRoomObjectUserGesture(E.roomId,T.roomIndex,mt.getGestureId(p.value==="0"?mt.GESTURE_SAD:mt.GESTURE_SMILE)))}),we(Ln.FINISHED,p=>{e&&e.id===p.questionId&&(u(p.answerCounts),n(!0),l(T=>(T&&clearTimeout(T),setTimeout(()=>m(),jA)))),d(new Map)}),we(Ln.QUESTION,p=>{t(p.id),s(p.question),n(!1),u(new Map),d(new Map),l(T=>{if(T&&clearTimeout(T),p.duration>0){const R=p.duration<1e3?jA:p.duration;return setTimeout(()=>m(),R)}return null})}),_.useEffect(()=>{const p=()=>{d(R=>{const S=[];if(R.forEach((N,P)=>{N.secondsLeft--,N.secondsLeft<=0&&S.push(P)}),S.length===0)return R;const b=new Map(R);return S.forEach(N=>b.delete(N)),b})},T=setInterval(()=>p(),1e3);return()=>clearInterval(T)},[]),_.useEffect(()=>()=>{l(p=>(p&&clearTimeout(p),null))},[]),{question:e,answerSent:i,answerCounts:c,userAnswers:h,vote:I}},xQ=NQ,MQ=()=>{const[a,t]=_.useState(null),[e,s]=_.useState(null),[i,n]=_.useState(0),[o,l]=_.useState(0),[c,u]=_.useState(0),[h,d]=hp("nitro.screensize",{width:window.innerWidth,height:window.innerHeight}),g=I=>{n(I),k(new BP(I))},E=I=>{q().giveRespect(I),l(q().respectsLeft)},m=I=>{q().givePetRespect(I),u(q().respectsPetLeft)};return Y(lh,I=>{const p=I.getParser();t(p.userInfo),s(p.userInfo.figure),l(p.userInfo.respectsRemaining),u(p.userInfo.respectsPetRemaining)}),Y(xS,I=>{const p=I.getParser();s(p.figure)}),Y(XS,I=>{const p=I.getParser();n(p.chatType)}),_.useEffect(()=>{const I=Af("nitro.screensize");if(I&&(I.width!==window.innerWidth||I.height!==window.innerHeight)){let T=window.localStorage.length;for(;T>0;){const R=window.localStorage.key(T);R&&R.startsWith("nitro.window")&&window.localStorage.removeItem(R),T--}}const p=T=>d({width:window.innerWidth,height:window.innerHeight});return window.addEventListener("resize",p),()=>{window.removeEventListener("resize",p)}},[d]),{userInfo:a,userFigure:e,chatStyleId:i,userRespectRemaining:o,petRespectRemaining:c,respectUser:E,respectPet:m,updateChatStyleId:g}},Oo=()=>Ts(MQ),yQ=a=>_.useEffect(a,[]),H0=a=>yQ(()=>a()),W0=a=>{const{achievement:t=null,scale:e=1,...s}=a;return t?r.jsx(Ge,{badgeCode:Sr.getAchievementBadgeCode(t),isGrayscale:!Sr.getAchievementHasStarted(t),scale:e,...s}):null},DQ=a=>{const{achievement:t=null}=a,{selectedAchievement:e=null,setSelectedAchievementId:s=null}=up();return t?r.jsx(ee,{itemActive:e===t,itemUnseen:t.unseen>0,onClick:i=>s(t.achievementId),children:r.jsx(W0,{achievement:t})}):null},bQ=a=>{const{achievements:t=null}=a;return r.jsx(Ce,{columnCount:6,columnMinWidth:50,columnMinHeight:50,children:t&&t.length>0&&t.map((e,s)=>r.jsx(DQ,{achievement:e},s))})},vQ=a=>{const{achievement:t=null}=a;return t?r.jsxs(M,{shrink:!0,className:"bg-muted rounded p-2 text-black",gap:2,overflow:"hidden",children:[r.jsxs(A,{center:!0,gap:1,children:[r.jsx(W0,{className:"nitro-achievements-badge-image",achievement:t,scale:2}),r.jsx(O,{fontWeight:"bold",children:f("achievements.details.level",["level","limit"],[Sr.getAchievementLevel(t).toString(),t.levelCount.toString()])})]}),r.jsxs(A,{fullWidth:!0,justifyContent:"center",overflow:"hidden",children:[r.jsxs(A,{gap:1,children:[r.jsx(O,{fontWeight:"bold",truncate:!0,children:gh(Sr.getAchievementBadgeCode(t))}),r.jsx(O,{textBreak:!0,children:MO(Sr.getAchievementBadgeCode(t))})]}),(t.levelRewardPoints>0||t.scoreLimit>0)&&r.jsxs(A,{gap:1,children:[t.levelRewardPoints>0&&r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx(O,{truncate:!0,className:"small",children:f("achievements.details.reward")}),r.jsxs(M,{center:!0,className:"fw-bold small",gap:1,children:[t.levelRewardPoints,r.jsx(ps,{type:t.levelRewardPointType})]})]}),t.scoreLimit>0&&r.jsx(jO,{text:f("achievements.details.progress",["progress","limit"],[(t.currentPoints+t.scoreAtStartOfLevel).toString(),(t.scoreLimit+t.scoreAtStartOfLevel).toString()]),progress:t.currentPoints+t.scoreAtStartOfLevel,maxProgress:t.scoreLimit+t.scoreAtStartOfLevel})]})]})]}):null},LQ=a=>{const{category:t=null}=a,{selectedAchievement:e=null,setSelectedAchievementId:s=null}=up();return _.useEffect(()=>{var i,n;t&&(e||s((n=(i=t==null?void 0:t.achievements)==null?void 0:i[0])==null?void 0:n.achievementId))},[t,e,s]),t?r.jsxs(A,{fullHeight:!0,justifyContent:"between",children:[r.jsx(bQ,{achievements:t.achievements}),!!e&&r.jsx(vQ,{achievement:e})]}):null},PQ=a=>{const{category:t=null,selectedCategoryCode:e=null,setSelectedCategoryCode:s=null}=a;if(!t)return null;const i=Sr.getAchievementCategoryProgress(t),n=Sr.getAchievementCategoryMaxProgress(t),o=Sr.getAchievementCategoryImageUrl(t,i),l=Sr.getAchievementCategoryTotalUnseen(t);return r.jsxs(ee,{itemActive:e===t.code,itemCount:l,itemCountMinimum:0,gap:1,onClick:c=>s(t.code),children:[r.jsx(O,{fullWidth:!0,center:!0,small:!0,className:"pt-1",children:f(`quests.${t.code}.name`)}),r.jsx(x0,{position:"relative",imageUrl:o,children:r.jsxs(O,{fullWidth:!0,center:!0,position:"absolute",variant:"white",style:{fontSize:12,bottom:9},children:[i," / ",n]})})]})},UQ=a=>{const{categories:t=null,selectedCategoryCode:e=null,setSelectedCategoryCode:s=null}=a;return r.jsx(Ce,{columnCount:3,columnMinWidth:90,columnMinHeight:100,children:t&&t.length>0&&t.map((i,n)=>r.jsx(PQ,{category:i,selectedCategoryCode:e,setSelectedCategoryCode:s},n))})},jQ=a=>{const[t,e]=_.useState(!1),{achievementCategories:s=[],selectedCategoryCode:i=null,setSelectedCategoryCode:n=null,achievementScore:o=0,getProgress:l=0,getMaxProgress:c=0,selectedCategory:u=null}=up();return _.useEffect(()=>{const h={linkReceived:d=>{const g=d.split("/");if(!(g.length<2))switch(g[1]){case"show":e(!0);return;case"hide":e(!1);return;case"toggle":e(E=>!E);return}},eventUrlPrefix:"achievements/"};return Os(h),()=>Cs(h)},[]),t?r.jsxs(Ot,{uniqueKey:"achievements",className:"nitro-achievements",children:[r.jsx(St,{headerText:f("inventory.achievements"),onCloseClick:h=>e(!1)}),u&&r.jsxs(N0,{position:"relative",className:"justify-content-center align-items-center cursor-pointer",gap:3,children:[r.jsx(H,{onClick:h=>n(null),className:"nitro-achievements-back-arrow"}),r.jsxs(A,{grow:!0,gap:0,children:[r.jsx(O,{fontSize:4,fontWeight:"bold",className:"text-small",children:f(`quests.${u.code}.name`)}),r.jsx(O,{children:f("achievements.details.categoryprogress",["progress","limit"],[u.getProgress().toString(),u.getMaxProgress().toString()])})]}),r.jsx(Ga,{imageUrl:Sr.getAchievementCategoryImageUrl(u,null,!0)})]}),r.jsxs(pt,{gap:1,children:[!u&&r.jsxs(r.Fragment,{children:[r.jsx(UQ,{categories:s,selectedCategoryCode:i,setSelectedCategoryCode:n}),r.jsxs(A,{grow:!0,justifyContent:"end",gap:1,children:[r.jsx(O,{small:!0,center:!0,children:f("achievements.categories.score",["score"],[o.toString()])}),r.jsx(jO,{text:f("achievements.categories.totalprogress",["progress","limit"],[l.toString(),c.toString()]),progress:l,maxProgress:c})]})]}),u&&r.jsx(LQ,{category:u})]})]}):null},ul=a=>{const{icon:t=null,selected:e=!1,classNames:s=[],children:i=null,...n}=a,o=_.useMemo(()=>{const l=["nitro-avatar-editor-spritesheet"];return t&&t.length&&l.push(t+"-icon"),e&&l.push("selected"),s.length&&l.push(...s),l},[t,e,s]);return r.jsx(H,{classNames:o,...n})},wQ=a=>{const{figureData:t=null}=a,[e,s]=_.useState(-1),i=n=>{n<_n.MIN_DIRECTION&&(n=_n.MAX_DIRECTION+(n+1)),n>_n.MAX_DIRECTION&&(n=n-(_n.MAX_DIRECTION+1)),t.direction=n};return _.useEffect(()=>{if(t)return t.notify=()=>s(n=>n+1),()=>{t.notify=null}},[t]),r.jsxs(A,{className:"figure-preview-container",overflow:"hidden",position:"relative",children:[r.jsx(ls,{figure:t.getFigureString(),direction:t.direction,scale:2}),r.jsx(ul,{className:"avatar-spotlight",icon:"spotlight"}),r.jsx(H,{className:"avatar-shadow"}),r.jsxs(H,{className:"arrow-container",children:[r.jsx(ul,{pointer:!0,icon:"arrow-left",onClick:n=>i(t.direction+1)}),r.jsx(ul,{pointer:!0,icon:"arrow-right",onClick:n=>i(t.direction-1)})]})]})},FQ=a=>{const{partItem:t=null,children:e=null,...s}=a,[i,n]=_.useState(-1),o=it("hc.disabled",!1);return _.useEffect(()=>{const l=()=>n(c=>c+1);return t.notify=l,()=>t.notify=null},[t]),r.jsxs(ee,{itemImage:t.isClear?void 0:t.imageUrl,itemActive:t.isSelected,...s,children:[!o&&t.isHC&&r.jsx(ps,{className:"position-absolute end-1 bottom-1",type:"hc"}),t.isClear&&r.jsx(ul,{icon:"clear"}),t.isSellable&&r.jsx(ul,{icon:"sellable",position:"absolute",className:"end-1 bottom-1"}),e]})},GQ=a=>{const{model:t=null,category:e=null,setMaxPaletteCount:s=null}=a,i=_.useRef(null),n=_.useCallback(o=>{const l=e.parts.indexOf(o);if(l===-1)return;t.selectPart(e.name,l);const c=e.getCurrentPart();s(c.maxColorIndex||1)},[t,e,s]);return _.useEffect(()=>{!t||!e||!i||!i.current||(i.current.scrollTop=0)},[t,e]),r.jsx(Ce,{innerRef:i,columnCount:3,columnMinHeight:50,children:e.parts.length>0&&e.parts.map((o,l)=>r.jsx(FQ,{partItem:o,onClick:c=>n(o)},l))})},BQ=a=>{const{colorItem:t=null,children:e=null,...s}=a,[i,n]=_.useState(-1),o=it("hc.disabled",!1);return _.useEffect(()=>{const l=()=>n(c=>c+1);return t.notify=l,()=>t.notify=null},[t]),r.jsxs(ee,{itemHighlight:!0,itemColor:t.color,itemActive:t.isSelected,className:"clear-bg",...s,children:[!o&&t.isHC&&r.jsx(ps,{className:"position-absolute end-1 bottom-1",type:"hc"}),e]})},wA=a=>{const{model:t=null,category:e=null,paletteSet:s=[],paletteIndex:i=-1}=a,n=_.useRef(null),o=_.useCallback(l=>{const c=s.indexOf(l);c!==-1&&t.selectColor(e.name,c,i)},[t,e,s,i]);return _.useEffect(()=>{!t||!e||!n||!n.current||(n.current.scrollTop=0)},[t,e]),r.jsx(Ce,{innerRef:n,gap:1,columnCount:5,columnMinWidth:30,children:s.length>0&&s.map((l,c)=>r.jsx(BQ,{colorItem:l,onClick:u=>o(l)},c))})},kQ=a=>{const{model:t=null,gender:e=null,setGender:s=null}=a,[i,n]=_.useState(null),[o,l]=_.useState(1),c=_.useCallback(u=>{const h=t.categories.get(u);if(h){h.init(),n(h);for(const d of h.parts)if(!(!d||!d.isSelected)){l(d.maxColorIndex||1);break}}},[t]);return _.useEffect(()=>{t.init();for(const u of t.categories.keys()){c(u);break}},[t,c]),!t||!i?null:r.jsxs(_t,{children:[r.jsxs(A,{size:2,children:[t.canSetGender&&r.jsxs(r.Fragment,{children:[r.jsx(M,{center:!0,pointer:!0,className:"category-item",onClick:u=>s(ce.MALE),children:r.jsx(ul,{icon:"male",selected:e===ce.MALE})}),r.jsx(M,{center:!0,pointer:!0,className:"category-item",onClick:u=>s(ce.FEMALE),children:r.jsx(ul,{icon:"female",selected:e===ce.FEMALE})})]}),!t.canSetGender&&t.categories&&t.categories.size>0&&Array.from(t.categories.keys()).map(u=>{const h=t.categories.get(u);return r.jsx(M,{center:!0,pointer:!0,className:"category-item",onClick:d=>c(u),children:r.jsx(ul,{icon:h.name,selected:i===h})},u)})]}),r.jsx(A,{size:5,overflow:"hidden",children:r.jsx(GQ,{model:t,category:i,setMaxPaletteCount:l})}),r.jsxs(A,{size:5,overflow:"hidden",children:[o>=1&&r.jsx(wA,{model:t,category:i,paletteSet:i.getPalette(0),paletteIndex:0}),o===2&&r.jsx(wA,{model:t,category:i,paletteSet:i.getPalette(1),paletteIndex:1})]})]})},VQ=a=>{const{figureData:t=null,savedFigures:e=[],setSavedFigures:s=null,loadAvatarInEditor:i=null}=a,n=it("hc.disabled",!1),o=_.useCallback(u=>{if(u>=e.length||u<0)return;const[h,d]=e[u];i(h.getFigureString(),d)},[e,i]),l=_.useCallback(u=>{if(!t||u>=e.length||u<0)return;const h=[...e],d=t.getFigureString(),g=t.gender;h[u]=[Gs().createFigureContainer(d),g],s(h),k(new Tb(u+1,d,g))},[t,e,s]),c=_.useMemo(()=>{if(!e||!e.length)return[];const u=[];return e.forEach(([h,d],g)=>{let E=0;h&&(E=Gs().getFigureClubLevel(h,d)),u.push(r.jsxs(ee,{position:"relative",overflow:"hidden",className:"nitro-avatar-editor-wardrobe-figure-preview",children:[h&&r.jsx(ls,{figure:h.getFigureString(),gender:d,direction:2}),r.jsx(H,{className:"avatar-shadow"}),!n&&E>0&&r.jsx(ps,{className:"position-absolute top-1 start-1",type:"hc"}),r.jsxs(M,{gap:1,className:"button-container",children:[r.jsx(V,{variant:"link",fullWidth:!0,onClick:m=>l(g),children:f("avatareditor.wardrobe.save")}),h&&r.jsx(V,{variant:"link",fullWidth:!0,onClick:m=>o(g),disabled:E>Wr(),children:f("generic_usable.button.use")})]})]},g))}),u},[e,n,l,o]);return r.jsx(Ce,{columnCount:5,columnMinWidth:80,columnMinHeight:140,children:c})},HQ="hr-100.hd-180-7.ch-215-66.lg-270-79.sh-305-62.ha-1002-70.wa-2007",WQ="hr-515-33.hd-600-1.ch-635-70.lg-716-66-62.sh-735-68",YQ=a=>{const[t,e]=_.useState(!1),[s,i]=_.useState(null),[n,o]=_.useState(null),[l,c]=_.useState(null),[u,h]=_.useState(null),[d,g]=_.useState([]),[E,m]=_.useState([]),[I,p]=_.useState([]),[T,R]=_.useState(!1),[S,b]=_.useState(null),[N,P]=_.useState(null),[B,F]=_.useState(!0),[w,U]=_.useState(!1),G=_.useMemo(()=>it("avatar.wardrobe.max.slots",10),[]);Y(LM,At=>{const se=At.getParser();g(se.figureSetIds),m(se.boundsFurnitureNames)}),Y(_b,At=>{const se=At.getParser(),ve=[];let ss=0;for(;ss<G;)ve.push([null,null]),ss++;for(let[qe,[ni,ge]]of se.looks.entries()){const Rs=Gs().createFigureContainer(ni);ve[qe-1]=[Rs,ge]}p(ve)});const K=_.useCallback(At=>{l&&h(l.get(At))},[l]),z=_.useCallback(()=>{const At=new Map;At.set(Pn.GENERIC,new f7),At.set(Pn.HEAD,new F7),At.set(Pn.TORSO,new B7),At.set(Pn.LEGS,new G7),c(At)},[]),et=_.useCallback(()=>{const At=new Map,se=new ce,ve=new ce;se.loadAvatarData(HQ,ce.MALE),ve.loadAvatarData(WQ,ce.FEMALE),At.set(ce.MALE,se),At.set(ce.FEMALE,ve),i(At),o(At.get(ce.MALE))},[]),rt=_.useCallback((At,se,ve=!0)=>{se=js.getGender(se);let ss=n;se!==ss.gender&&(ss=s.get(se)),At!==ss.getFigureString()&&ss.loadAvatarData(At,se),ss!==n&&o(ss),ve&&(b(n.getFigureString()),P(n.gender))},[s,n]),J=_.useCallback(At=>{switch(At){case Qn.ACTION_CLEAR:rt(n.getFigureStringWithFace(0,!1),n.gender,!1),z();return;case Qn.ACTION_RESET:rt(S,N),z();return;case Qn.ACTION_RANDOMIZE:const se=w7(n,n.gender,Wr(),d,[ce.FACE]);rt(se,n.gender,!1),z();return;case Qn.ACTION_SAVE:k(new fO(n.gender,n.getFigureString())),e(!1);return}},[n,S,N,d,rt,z]),Ct=_.useCallback(At=>{At=js.getGender(At),o(s.get(At))},[s]);return _.useEffect(()=>{const At={linkReceived:se=>{const ve=se.split("/");if(!(ve.length<2))switch(ve[1]){case"show":e(!0);return;case"hide":e(!1);return;case"toggle":e(ss=>!ss);return}},eventUrlPrefix:"avatar-editor/"};return Os(At),()=>Cs(At)},[]),_.useEffect(()=>{p(new Array(G))},[G]),_.useEffect(()=>{T&&(h(null),k(new Ib))},[T]),_.useEffect(()=>{u&&R(!1)},[u]),_.useEffect(()=>{l&&K(Pn.GENERIC)},[l,K]),_.useEffect(()=>{if(n)return js.CURRENT_FIGURE=n,z(),()=>js.CURRENT_FIGURE=null},[n,z]),_.useEffect(()=>(js.FIGURE_SET_IDS=d,js.BOUND_FURNITURE_NAMES=E,z(),()=>{js.FIGURE_SET_IDS=null,js.BOUND_FURNITURE_NAMES=null}),[d,E,z]),_.useEffect(()=>{if(t&&!s){et(),U(!0);return}},[t,s,et]),_.useEffect(()=>{!t||!w||!B||(rt(q().figure,q().gender),F(!1))},[t,w,B,rt]),_.useEffect(()=>{if(!t)return()=>{F(!0)}},[t]),!t||!n?null:r.jsxs(Ot,{uniqueKey:"avatar-editor",className:"nitro-avatar-editor",children:[r.jsx(St,{headerText:f("avatareditor.title"),onCloseClick:At=>e(!1)}),r.jsxs(Ro,{children:[l&&l.size>0&&Array.from(l.keys()).map(At=>{const se=u&&u.name===At;return r.jsx(Wn,{isActive:se,onClick:ve=>K(At),children:f(`avatareditor.category.${At}`)},At)}),r.jsx(Wn,{isActive:T,onClick:At=>R(!0),children:f("avatareditor.category.wardrobe")})]}),r.jsx(pt,{children:r.jsxs(_t,{children:[r.jsxs(A,{size:9,overflow:"hidden",children:[u&&!T&&r.jsx(kQ,{model:u,gender:n.gender,setGender:Ct}),T&&r.jsx(VQ,{figureData:n,savedFigures:I,setSavedFigures:p,loadAvatarInEditor:rt})]}),r.jsxs(A,{size:3,overflow:"hidden",children:[r.jsx(wQ,{figureData:n}),r.jsxs(A,{grow:!0,gap:1,children:[r.jsxs(Da,{children:[r.jsx(V,{variant:"secondary",onClick:At=>J(Qn.ACTION_RESET),children:r.jsx(Uj,{className:"fa-icon"})}),r.jsx(V,{variant:"secondary",onClick:At=>J(Qn.ACTION_CLEAR),children:r.jsx(cS,{className:"fa-icon"})}),r.jsx(V,{variant:"secondary",onClick:At=>J(Qn.ACTION_RANDOMIZE),children:r.jsx(jj,{className:"fa-icon"})})]}),r.jsx(V,{className:"w-100",variant:"success",onClick:At=>J(Qn.ACTION_SAVE),children:f("avatareditor.save")})]})]})]})})]})},zQ=5,KQ=a=>{const{onClose:t=null,onEdit:e=null,onDelete:s=null}=a,{cameraRoll:i=null,setCameraRoll:n=null,selectedPictureIndex:o=-1,setSelectedPictureIndex:l=null}=b0(),{simpleAlert:c=null}=He(),u=_.useRef(),h=o>-1?i[o]:null,d=()=>{if(!u||!u.current)return null;const E=u.current.getBoundingClientRect();return new YN(Math.floor(E.x),Math.floor(E.y),Math.floor(E.width),Math.floor(E.height))},g=()=>{if(o>-1){l(-1);return}const E=tt().createTextureFromRoom(ie().roomId,1,d()),m=[...i];m.length>=zQ&&(c(f("camera.full.body")),m.pop()),Ua(ja.CAMERA_SHUTTER),m.push(new k7(E,Ee.generateImageUrl(E))),n(m)};return r.jsx(ml,{uniqueKey:"nitro-camera-capture",children:r.jsxs(A,{center:!0,className:"nitro-camera-capture",gap:0,children:[h&&r.jsx("img",{alt:"",className:"camera-area",src:h.imageUrl}),r.jsxs("div",{className:"camera-canvas drag-handler",children:[r.jsx("div",{className:"position-absolute header-close",onClick:t,children:r.jsx(zr,{className:"fa-icon"})}),!h&&r.jsx("div",{ref:u,className:"camera-area camera-view-finder"}),h&&r.jsx("div",{className:"camera-area camera-frame",children:r.jsxs("div",{className:"camera-frame-preview-actions w-100 position-absolute bottom-0 py-2 text-center",children:[r.jsx("button",{className:"btn btn-success me-3",title:f("camera.editor.button.tooltip"),onClick:e,children:f("camera.editor.button.text")}),r.jsx("button",{className:"btn btn-danger",onClick:s,children:f("camera.delete.button.text")})]})}),r.jsx("div",{className:"d-flex justify-content-center",children:r.jsx("div",{className:"camera-button",title:f("camera.take.photo.button.tooltip"),onClick:g})})]}),i.length>0&&r.jsx(M,{gap:2,justifyContent:"center",className:"camera-roll d-flex justify-content-center py-2",children:i.map((E,m)=>r.jsx("img",{alt:"",src:E.imageUrl,onClick:I=>l(m)},m))})]})})},XQ=a=>{const{base64Url:t=null,onCloseClick:e=null,onCancelClick:s=null,price:i=null}=a,[n,o]=_.useState(null),[l,c]=_.useState(null),[u,h]=_.useState(0),[d,g]=_.useState(!1),[E,m]=_.useState(!1),[I,p]=_.useState(0),T=_.useMemo(()=>it("camera.publish.disabled",!1),[]);Y(Ox,S=>{h(b=>b+1),m(!1)}),Y(Sx,S=>{const b=S.getParser();c(b.extraDataId),p(b.secondsToWait),g(b.ok),m(!1)}),Y(Cx,S=>{const b=S.getParser();o(it("camera.url")+"/"+b.url)});const R=(S,b=null)=>{switch(S){case"close":e();return;case"buy":if(E)return;m(!0),k(new Sb(""));return;case"publish":if(E)return;m(!0),k(new Rb);return;case"cancel":s();return}};return _.useEffect(()=>{t&&tt().saveBase64AsScreenshot(t)},[t]),i?r.jsxs(Ot,{className:"nitro-camera-checkout",children:[r.jsx(St,{headerText:f("camera.confirm_phase.title"),onCloseClick:S=>R("close")}),r.jsxs(pt,{children:[r.jsxs(M,{center:!0,children:[n&&n.length&&r.jsx(Ga,{className:"picture-preview border",imageUrl:n}),(!n||!n.length)&&r.jsx(M,{center:!0,className:"picture-preview border",children:r.jsx(O,{bold:!0,children:f("camera.loading")})})]}),r.jsxs(M,{justifyContent:"between",alignItems:"center",className:"bg-muted rounded p-2",children:[r.jsxs(A,{size:T?10:6,gap:1,children:[r.jsx(O,{bold:!0,children:f("camera.purchase.header")}),(i.credits>0||i.duckets>0)&&r.jsxs(M,{gap:1,children:[r.jsx(O,{children:f("catalog.purchase.confirmation.dialog.cost")}),i.credits>0&&r.jsxs(M,{gap:1,children:[r.jsx(O,{bold:!0,children:i.credits}),r.jsx(ps,{type:-1})]}),i.duckets>0&&r.jsxs(M,{gap:1,children:[r.jsx(O,{bold:!0,children:i.duckets}),r.jsx(ps,{type:5})]})]}),u>0&&r.jsxs(O,{children:[r.jsx(O,{bold:!0,children:f("camera.purchase.count.info")})," ",u,r.jsx("u",{className:"ms-1 cursor-pointer",onClick:()=>ut("inventory/toggle"),children:f("camera.open.inventory")})]})]}),r.jsx(M,{alignItems:"center",children:r.jsx(V,{variant:"success",disabled:E,onClick:S=>R("buy"),children:f(u?"camera.buy.another.button.text":"buy")})})]}),!T&&r.jsxs(M,{justifyContent:"between",alignItems:"center",className:"bg-muted rounded p-2",children:[r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f(d?"camera.publish.successful":"camera.publish.explanation")}),r.jsx(O,{children:f(d?"camera.publish.success.short.info":"camera.publish.detailed.explanation")}),d&&r.jsx("a",{href:l,rel:"noreferrer",target:"_blank",children:f("camera.link.to.published")}),!d&&i.publishDucketPrice>0&&r.jsxs(M,{gap:1,children:[r.jsx(O,{children:f("catalog.purchase.confirmation.dialog.cost")}),r.jsxs(M,{gap:1,children:[r.jsx(O,{bold:!0,children:i.publishDucketPrice}),r.jsx(ps,{type:5})]})]}),I>0&&r.jsx("div",{className:"mt-1 text-center fw-bold",children:f("camera.publish.wait",["minutes"],[Math.ceil(I/60).toString()])})]}),!d&&r.jsx(M,{className:"d-flex align-items-end",children:r.jsx(V,{variant:"success",disabled:E||I>0,onClick:S=>R("publish"),children:f("camera.publish.button.text")})})]}),r.jsx(O,{center:!0,children:f("camera.warning.disclaimer")}),r.jsx(M,{justifyContent:"end",children:r.jsx(V,{onClick:S=>R("cancel"),children:f("generic.cancel")})})]})]}):null},qQ=a=>{const{effect:t=null,thumbnailUrl:e=null,isActive:s=!1,isLocked:i=!1,selectEffect:n=null,removeEffect:o=null}=a;return r.jsxs(ee,{title:f(i?`camera.effect.required.level ${t.minLevel}`:`camera.effect.name.${t.name}`),itemActive:s,onClick:l=>!s&&n(),children:[s&&r.jsx(V,{variant:"danger",className:"rounded-circle remove-effect",onClick:o,children:r.jsx(zr,{className:"fa-icon"})}),!i&&e&&e.length>0&&r.jsx("div",{className:"effect-thumbnail-image border",children:r.jsx("img",{alt:"",src:e})}),i&&r.jsxs(O,{center:!0,bold:!0,children:[r.jsx("div",{children:r.jsx(jN,{className:"fa-icon"})}),t.minLevel]})]})},QQ=a=>{const{myLevel:t=0,selectedEffects:e=[],effects:s=[],thumbnails:i=[],processAction:n=null}=a;return r.jsx(_t,{columnCount:3,overflow:"auto",children:s&&s.length>0&&s.map((o,l)=>{const c=i.find(h=>h.effectName===o.name),u=e.findIndex(h=>h.effect.name===o.name)>-1;return r.jsx(qQ,{effect:o,thumbnailUrl:c&&c.thumbnailUrl||null,isActive:u,isLocked:o.minLevel>t,selectEffect:()=>n("select_effect",o.name),removeEffect:()=>n("remove_effect",o.name)},l)})})},FA=[d_.COLORMATRIX,d_.COMPOSITE],JQ=a=>{const{picture:t=null,availableEffects:e=null,myLevel:s=1,onClose:i=null,onCancel:n=null,onCheckout:o=null}=a,[l,c]=_.useState(FA[0]),[u,h]=_.useState(null),[d,g]=_.useState([]),[E,m]=_.useState([]),[I,p]=_.useState(!1),T=_.useMemo(()=>e.filter(U=>U.colorMatrix),[e]),R=_.useMemo(()=>e.filter(U=>U.texture),[e]),S=_.useCallback(()=>l===d_.COLORMATRIX?T:R,[l,T,R]),b=_.useCallback(U=>!U||!U.length||!d||!d.length?-1:d.findIndex(G=>G.effect.name===U),[d]),N=_.useMemo(()=>b(u),[u,b]),P=_.useMemo(()=>u&&d[N]||null,[u,N,d]),B=_.useCallback(U=>{const G=N;G!==-1&&g(K=>{const z=[...K],et=z[G];return z[N]=new Op(et.effect,U),z})},[N,g]),F=_.useMemo(()=>Uh().applyEffects(t.texture,d,I).src,[t,d,I]),w=_.useCallback((U,G=null)=>{switch(U){case"close":i();return;case"cancel":n();return;case"checkout":o(F);return;case"change_tab":c(String(G));return;case"select_effect":{if(b(G)>=0)return;const z=e.find(et=>et.name===G);if(!z)return;g(et=>[...et,new Op(z,1)]),h(z.name);return}case"remove_effect":{let K=b(G);if(K===-1)return;g(z=>{const et=[...z];return et.splice(K,1),et}),u===G&&h(null);return}case"clear_effects":h(null),g([]);return;case"download":{const K=new Image;K.src=F,window.open("").document.write(K.outerHTML);return}case"zoom":p(!I);return}},[I,e,u,F,b,n,o,i,p,g]);return _.useEffect(()=>{const U=[];for(const G of e)U.push(new V7(G.name,Uh().applyEffects(t.texture,[new Op(G,1)],!1).src));m(U)},[t,e]),r.jsxs(Ot,{className:"nitro-camera-editor",children:[r.jsx(St,{headerText:f("camera.editor.button.text"),onCloseClick:U=>w("close")}),r.jsx(Ro,{children:FA.map(U=>r.jsx(Wn,{isActive:l===U,onClick:G=>w("change_tab",U),children:r.jsx("i",{className:"icon icon-camera-"+U})},U))}),r.jsx(pt,{children:r.jsxs(_t,{children:[r.jsx(A,{size:5,overflow:"hidden",children:r.jsx(QQ,{myLevel:s,selectedEffects:d,effects:S(),thumbnails:E,processAction:w})}),r.jsxs(A,{size:7,justifyContent:"between",overflow:"hidden",children:[r.jsxs(A,{center:!0,children:[r.jsx(Ga,{imageUrl:F,className:"picture-preview"}),u&&r.jsxs(A,{center:!0,fullWidth:!0,gap:1,children:[r.jsx(O,{children:f("camera.effect.name."+u)}),r.jsx(Js,{className:"nitro-slider",min:0,max:1,step:.01,value:P.alpha,onChange:U=>B(U),renderThumb:(U,G)=>r.jsx("div",{...U,children:G.valueNow})})]})]}),r.jsxs(M,{justifyContent:"between",children:[r.jsxs(Da,{children:[r.jsx(V,{onClick:U=>w("clear_effects"),children:r.jsx(cS,{className:"fa-icon"})}),r.jsx(V,{onClick:U=>w("download"),children:r.jsx(wj,{className:"fa-icon"})}),r.jsxs(V,{onClick:U=>w("zoom"),children:[I&&r.jsx(Fj,{className:"fa-icon"}),!I&&r.jsx(Gj,{className:"fa-icon"})]})]}),r.jsxs(M,{gap:1,children:[r.jsx(V,{onClick:U=>w("cancel"),children:f("generic.cancel")}),r.jsx(V,{onClick:U=>w("checkout"),children:f("camera.preview.button.text")})]})]})]})]})})]})},zc=0,W_=1,GA=2,BA=3,$Q=a=>{const[t,e]=_.useState(zc),[s,i]=_.useState(null),{availableEffects:n=[],selectedPictureIndex:o=-1,cameraRoll:l=[],setCameraRoll:c=null,myLevel:u=0,price:h={credits:0,duckets:0,publishDucketPrice:0}}=b0(),d=E=>{switch(E){case"close":e(zc);return;case"edit":e(GA);return;case"delete":c(m=>{const I=[...m];return I.splice(o,1),I});return;case"editor_cancel":e(W_);return}},g=E=>{i(E),e(BA)};return we(Mt.ENDED,E=>e(zc)),_.useEffect(()=>{const E={linkReceived:m=>{const I=m.split("/");if(!(I.length<2))switch(I[1]){case"show":e(W_);return;case"hide":e(zc);return;case"toggle":e(p=>p?zc:W_);return}},eventUrlPrefix:"camera/"};return Os(E),()=>Cs(E)},[]),t===zc?null:r.jsxs(r.Fragment,{children:[t===W_&&r.jsx(KQ,{onClose:()=>d("close"),onEdit:()=>d("edit"),onDelete:()=>d("delete")}),t===GA&&r.jsx(JQ,{picture:l[o],myLevel:u,onClose:()=>d("close"),onCancel:()=>d("editor_cancel"),onCheckout:g,availableEffects:n}),t===BA&&r.jsx(XQ,{base64Url:s,onCloseClick:()=>d("close"),onCancelClick:()=>d("editor_cancel"),price:h})]})},ZQ=a=>{const{itemId:t=-1,state:e=null,product:s=null,active:i=!1,onClick:n=null}=a,o=l=>{let c=q().getFloorItemDataByName(l),u=null;return c?u=tt().getFurnitureFloorIconUrl(c.id):(c=q().getWallItemDataByName(l),c&&(u=tt().getFurnitureWallIconUrl(c.id))),u};return r.jsxs(A,{fit:!0,center:!0,pointer:!0,className:`campaign-spritesheet campaign-day-generic-bg rounded calendar-item ${i?"active":""}`,onClick:()=>n(t),children:[e===vi.STATE_UNLOCKED&&r.jsx(M,{center:!0,className:"campaign-spritesheet unlocked-bg",children:r.jsx(M,{center:!0,className:"campaign-spritesheet campaign-opened",children:s&&r.jsx(Ga,{imageUrl:s.customImage?it("image.library.url")+s.customImage:o(s.productName)})})}),e!==vi.STATE_UNLOCKED&&r.jsxs(M,{center:!0,className:"campaign-spritesheet locked-bg",children:[e===vi.STATE_LOCKED_AVAILABLE&&r.jsx(H,{className:"campaign-spritesheet available"}),(e===vi.STATE_LOCKED_EXPIRED||e===vi.STATE_LOCKED_FUTURE)&&r.jsx(H,{className:"campaign-spritesheet unavailable"})]})]})},bp=5,tJ=a=>{const{onClose:t=null,campaignName:e=null,currentDay:s=null,numDays:i=null,missedDays:n=null,openedDays:o=null,openPackage:l=null,receivedProducts:c=null}=a,[u,h]=_.useState(s),[d,g]=_.useState(Math.max(0,u-1)),E=S=>o.includes(S)?vi.STATE_UNLOCKED:S>s?vi.STATE_LOCKED_FUTURE:n.includes(S)?vi.STATE_LOCKED_EXPIRED:vi.STATE_LOCKED_AVAILABLE,m=S=>{switch(E(S)){case vi.STATE_UNLOCKED:return f("campaign.calendar.info.unlocked");case vi.STATE_LOCKED_FUTURE:return f("campaign.calendar.info.future");case vi.STATE_LOCKED_EXPIRED:return f("campaign.calendar.info.expired");default:return f("campaign.calendar.info.available.desktop")}},I=()=>{const S=u+1;S!==i&&(h(S),d+bp<S+1&&g(d+1))},p=()=>{const S=u-1;S<0||(h(S),d>S&&g(d-1))},T=S=>{if(u===S){E(S)===vi.STATE_LOCKED_AVAILABLE&&l(S,!1);return}h(S)},R=()=>{const S=u;E(S)!==vi.STATE_UNLOCKED&&l(S,!0)};return r.jsxs(Ot,{className:"nitro-campaign-calendar",children:[r.jsx(St,{headerText:f(`campaign.calendar.${e}.title`),onCloseClick:t}),r.jsxs(pt,{children:[r.jsxs(_t,{fullHeight:!1,justifyContent:"between",alignItems:"center",children:[r.jsx(A,{size:1}),r.jsx(A,{size:10,children:r.jsxs(M,{justifyContent:"between",alignItems:"center",gap:1,children:[r.jsxs(A,{gap:1,children:[r.jsx(O,{fontSize:3,children:f("campaign.calendar.heading.day",["number"],[(u+1).toString()])}),r.jsx(O,{children:m(u)})]}),r.jsx("div",{children:q().isModerator&&r.jsx(V,{variant:"danger",onClick:R,children:"Force open"})})]})}),r.jsx(A,{size:1})]}),r.jsxs(M,{fullHeight:!0,gap:2,children:[r.jsx(M,{center:!0,children:r.jsx(H,{pointer:!0,className:"campaign-spritesheet prev",onClick:p})}),r.jsx(A,{center:!0,fullWidth:!0,children:r.jsx(_t,{fit:!0,columnCount:bp,gap:1,children:[...Array(bp)].map((S,b)=>{const N=d+b;return r.jsx(A,{overflow:"hidden",children:r.jsx(ZQ,{itemId:N,state:E(N),active:u===N,product:c.has(N)?c.get(N):null,onClick:T})},b)})})}),r.jsx(M,{center:!0,children:r.jsx(H,{pointer:!0,className:"campaign-spritesheet next",onClick:I})})]})]})]})},eJ=a=>{const[t,e]=_.useState(null),[s,i]=_.useState(-1),[n,o]=_.useState(new Map),[l,c]=_.useState(!1),u=(h,d=!1)=>{t&&(i(h),k(d?new Cb(t.campaignName,h):new Ab(t.campaignName,h)))};return Y(Nx,h=>{const d=h.getParser();d&&e(d.calendarData)}),Y(xx,h=>{const d=h.getParser();if(!d)return;const g=s;d.doorOpened&&(e(E=>{const m=E.clone();return m.openedDays.push(s),m}),o(E=>{const m=new Map(E);return m.set(g,new H7(d.productName,d.customImage,d.furnitureClassName)),m})),i(-1)}),_.useEffect(()=>{const h={linkReceived:d=>{const g=d.split("/");if(!(g.length<2))switch(g[1]){case"calendar":c(!0);break}},eventUrlPrefix:"openView/"};return Os(h),()=>Cs(h)},[]),r.jsx(r.Fragment,{children:t&&l&&r.jsx(tJ,{onClose:()=>c(!1),campaignName:t.campaignName,currentDay:t.currentDay,numDays:t.campaignDays,openedDays:t.openedDays,missedDays:t.missedDays,openPackage:u,receivedProducts:n})})},Y0=a=>{const{icon:t=0}=a,e=_.useMemo(()=>it("catalog.asset.icon.url").replace("%name%",t.toString()),[t]);return r.jsx(Ga,{imageUrl:e,style:{width:20,height:20}})},sJ=a=>{const[t,e]=_.useState(!1),[s,i]=_.useState(0),[n,o]=_.useState(0),[l,c]=_.useState(""),[u,h]=_.useState(""),[d,g]=_.useState(!0),[E,m]=_.useState(""),[I,p]=_.useState([]),[T,R]=_.useState(0),[S,b]=_.useState(0),[N,P]=_.useState(0),[B,F]=_.useState(0),[w,U]=_.useState(0),[G,K]=_.useState(!1),{catalogOptions:z=null}=Ne(),{friends:et}=ar(),{giftConfiguration:rt=null}=z,[J,Ct]=_.useState([]),[At,se]=_.useState([]),[ve,ss]=_.useState(!0),qe=_.useCallback(()=>{e(!1),i(0),o(0),c(""),h(""),g(!0),m(""),R(0),b(0),ss(!1),se([]),I.length&&P(I[0].id)},[I]),ni=_.useMemo(()=>rt?rt.defaultStuffTypes.findIndex(It=>It===J[T])>-1:!1,[J,rt,T]),ge=_.useMemo(()=>rt?(J[T]*1e3+rt.ribbonTypes[S]).toString():"",[rt,T,S,J]),Rs=_.useMemo(()=>{if(!rt||ni)return!1;const It=J[T];return!(It===8||It>=3&&It<=6)},[rt,T,ni,J]),mi=_.useMemo(()=>ni?J[T]:N,[ni,J,T,N]),pe=et.filter(It=>It.id!==-1),Wt=It=>{const jt=It.target.value;let Vs=[];jt.length>0&&(Vs=pe.sort().filter(xr=>xr.name.includes(jt))),h(jt),ss(!0),se(Vs)},We=It=>{h(It),ss(!1)},Be=_.useCallback(It=>{switch(It){case"prev_box":R(jt=>jt===0?B:jt-1);return;case"next_box":R(jt=>jt===B?0:jt+1);return;case"prev_ribbon":b(jt=>jt===0?w:jt-1);return;case"next_ribbon":b(jt=>jt===w?0:jt+1);return;case"buy":if(!u||u.length===0){K(!0);return}k(new wb(s,n,l,u,E,mi,T,S,d));return}},[mi,l,B,w,E,n,s,u,T,S,d]);Y(Ux,It=>K(!0)),Is([wa.PURCHASE_SUCCESS,Uc.INIT_GIFT],It=>{switch(It.type){case wa.PURCHASE_SUCCESS:qe();return;case Uc.INIT_GIFT:const jt=It;qe(),i(jt.pageId),o(jt.offerId),c(jt.extraData),e(!0);return}}),_.useEffect(()=>{K(!1)},[u]);const In=_.useCallback(()=>{rt&&Ct(It=>{let jt=[...rt.boxTypes];return jt.push(rt.defaultStuffTypes[Math.floor(Math.random()*(rt.defaultStuffTypes.length-1))]),F(jt.length-1),U(jt.length-1),jt})},[rt]);if(_.useEffect(()=>{if(!rt)return;const It=[];for(const jt of rt.stuffTypes){const Vs=q().getFloorItemData(jt);Vs&&Vs.colors&&Vs.colors.length>0&&It.push({id:jt,color:ir.makeColorNumberHex(Vs.colors[0])})}In(),It.length&&(P(It[0].id),p(It))},[rt,In]),_.useEffect(()=>{t&&In()},[In,t]),!rt||!rt.isEnabled||!t)return null;const pl="catalog.gift_wrapping_new.box."+(ni?"default":J[T]),Th=`catalog.gift_wrapping_new.ribbon.${S}`,Ut="catalog.gift_wrapping_new."+(ni?"freeprice":"price");return r.jsxs(Ot,{uniqueKey:"catalog-gift",className:"nitro-catalog-gift",children:[r.jsx(St,{headerText:f("catalog.gift_wrapping.title"),onCloseClick:qe}),r.jsxs(pt,{className:"text-black",children:[r.jsxs(S8,{column:!0,children:[r.jsx(O,{children:f("catalog.gift_wrapping.receiver")}),r.jsx("input",{type:"text",className:qs("form-control form-control-sm",G&&"is-invalid"),value:u,onChange:It=>Wt(It)}),At.length>0&&ve&&r.jsx(A,{className:"autocomplete-gift-container",children:At.map(It=>r.jsx(H,{className:"autocomplete-gift-item",onClick:jt=>We(It.name),children:It.name},It.id))}),G&&r.jsx(H,{className:"invalid-feedback",children:f("catalog.gift_wrapping.receiver_not_found.title")})]}),r.jsx(M0,{figure:q().figure,userName:q().userName,message:E,editable:!0,onChange:It=>m(It)}),r.jsxs(H,{className:"form-check",children:[r.jsx("input",{className:"form-check-input",type:"checkbox",name:"showMyFace",checked:d,onChange:It=>g(jt=>!jt)}),r.jsx("label",{className:"form-check-label",children:f("catalog.gift_wrapping.show_face.title")})]}),r.jsxs(M,{alignItems:"center",gap:2,children:[N&&r.jsx(H,{className:"gift-preview",children:r.jsx(LO,{productType:Yt.FLOOR,productClassId:mi,extraData:ge})}),r.jsxs(A,{gap:1,children:[r.jsxs(M,{gap:2,children:[r.jsxs(Da,{children:[r.jsx(V,{variant:"primary",onClick:()=>Be("prev_box"),children:r.jsx(pr,{className:"fa-icon"})}),r.jsx(V,{variant:"primary",onClick:()=>Be("next_box"),children:r.jsx(Ir,{className:"fa-icon"})})]}),r.jsxs(A,{gap:1,children:[r.jsx(O,{fontWeight:"bold",children:f(pl)}),r.jsxs(M,{alignItems:"center",gap:1,children:[f(Ut,["price"],[rt.price.toString()]),r.jsx(ps,{type:-1})]})]})]}),r.jsxs(M,{alignItems:"center",gap:2,className:Rs?"":"opacity-50 pointer-events-none",children:[r.jsxs(Da,{children:[r.jsx(V,{variant:"primary",onClick:()=>Be("prev_ribbon"),children:r.jsx(pr,{className:"fa-icon"})}),r.jsx(V,{variant:"primary",onClick:()=>Be("next_ribbon"),children:r.jsx(Ir,{className:"fa-icon"})})]}),r.jsx(O,{fontWeight:"bold",children:f(Th)})]})]})]}),r.jsxs(A,{gap:1,className:Rs?"":"opacity-50 pointer-events-none",children:[r.jsx(O,{fontWeight:"bold",children:f("catalog.gift_wrapping.pick_color")}),r.jsx(Da,{fullWidth:!0,children:I.map(It=>r.jsx(V,{variant:"dark",active:It.id===N,disabled:!Rs,style:{backgroundColor:It.color},onClick:()=>P(It.id)},It.id))})]}),r.jsxs(M,{justifyContent:"between",alignItems:"center",children:[r.jsx(V,{variant:"link",onClick:qe,className:"text-black",children:f("cancel")}),r.jsx(V,{variant:"success",onClick:()=>Be("buy"),children:f("catalog.gift_wrapping.give_gift")})]})]})]})},iJ=a=>{const[t,e]=_.useState(""),{currentType:s=null,rootNode:i=null,offersToNodes:n=null,searchResult:o=null,setSearchResult:l=null,setCurrentPage:c=null}=Ne();return _.useEffect(()=>{let u=t==null?void 0:t.toLocaleLowerCase().replace(" ","");if(!u||!u.length){l(null);return}const h=setTimeout(()=>{const d=q().getAllFurnitureData({loadFurnitureData:null});if(!d||!d.length)return;const g=[],E=[];for(const p of d){if(s===ln.BUILDER&&!p.availableForBuildersClub||s===ln.NORMAL&&p.excludeDynamic)continue;const T=[p.className,p.name,p.description].join(" ").replace(/ /gi,"").toLowerCase();if(s===ln.BUILDER&&p.purchaseOfferId===-1&&p.rentOfferId===-1)p.furniLine!==""&&E.indexOf(p.furniLine)<0&&T.indexOf(u)>=0&&E.push(p.furniLine);else if([...aA(n,p.purchaseOfferId),...aA(n,p.rentOfferId)].length&&(T.indexOf(u)>=0&&g.push(p),g.length===250))break}const m=[];for(const p of g)m.push(new i7(p));let I=[];o0(u,E,i,I),l(new o7(u,m,I.filter(p=>p.isVisible))),c(new Sf(-1,"default_3x3",new l0([],[]),m,!1,1))},300);return()=>clearTimeout(h)},[n,s,i,t,c,l]),r.jsxs(M,{gap:1,children:[r.jsx(M,{fullWidth:!0,alignItems:"center",position:"relative",children:r.jsx("input",{type:"text",className:"form-control form-control-sm",placeholder:f("generic.search"),value:t,onChange:u=>e(u.target.value)})}),(!t||!t.length)&&r.jsx(V,{variant:"primary",className:"catalog-search-button",children:r.jsx(YE,{className:"fa-icon"})}),t&&!!t.length&&r.jsx(V,{variant:"primary",className:"catalog-search-button",onClick:u=>e(""),children:r.jsx(zr,{className:"fa-icon"})})]})},z0=a=>{const{node:t=null,child:e=!1}=a;return r.jsx(r.Fragment,{children:t&&t.children.length>0&&t.children.map((s,i)=>s.isVisible?r.jsx(K0,{node:s,child:e},i):null)})},K0=a=>{const{node:t=null,child:e=!1}=a,{activateNode:s=null}=Ne();return r.jsxs(H,{className:"nitro-catalog-navigation-section",children:[r.jsxs(ee,{gap:1,column:!1,itemActive:t.isActive,onClick:i=>s(t),className:e?"inset":"",children:[r.jsx(Y0,{icon:t.iconId}),r.jsx(O,{grow:!0,truncate:!0,children:t.localization}),t.isBranch&&r.jsxs(r.Fragment,{children:[t.isOpen&&r.jsx(aS,{className:"fa-icon"}),!t.isOpen&&r.jsx(oS,{className:"fa-icon"})]})]}),t.isOpen&&t.isBranch&&r.jsx(z0,{node:t,child:!0})]})},rJ=a=>{const{node:t=null}=a,{searchResult:e=null}=Ne();return r.jsxs(r.Fragment,{children:[r.jsx(iJ,{}),r.jsx(A,{fullHeight:!0,className:"nitro-catalog-navigation-grid-container rounded p-1",overflow:"hidden",children:r.jsxs(Ce,{id:"nitro-catalog-main-navigation",gap:1,columnCount:1,children:[e&&e.filteredNodes.length>0&&e.filteredNodes.map((s,i)=>r.jsx(K0,{node:s},i)),!e&&r.jsx(z0,{node:t})]})})]})},nJ=a=>{const{columnCount:t=5,...e}=a,[s,i]=_.useState(!1),[n,o]=_.useState(null),{currentOffer:l=null,setPurchaseOptions:c=null}=Ne(),{badgeCodes:u=[],activate:h=null,deactivate:d=null}=fp(),g=_.useMemo(()=>{if(!n)return null;const E=new Vn;return E.setValue(["0",n,"",""]),E},[n]);return _.useEffect(()=>{l&&c(E=>{const m={...E};return m.extraParamRequired=!0,m.extraData=g&&g.getValue(1)||null,m.previewStuffData=g,m})},[l,g,c]),_.useEffect(()=>{if(!s)return;const E=h();return()=>d(E)},[s,h,d]),_.useEffect(()=>(i(!0),()=>i(!1)),[]),r.jsx(Ce,{columnCount:t,...e,children:u&&u.length>0&&u.map((E,m)=>r.jsx(ee,{itemActive:n===E,onClick:I=>o(E),children:r.jsx(Ge,{badgeCode:E})},m))})},mp=a=>{const{currentPage:t=null,setCurrentOffer:e=null}=Ne();return _.useEffect(()=>{!t||!t.offers.length||e(t.offers[0])},[t,e]),null},BO=a=>{const{offer:t=null,selectOffer:e=null,itemActive:s=!1,...i}=a,[n,o]=_.useState(!1),{requestOfferToMover:l=null}=Ne(),{isVisible:c=!1}=Bc(),u=_.useMemo(()=>t.pricingModel===_i.PRICING_MODEL_BUNDLE?null:t.product.getIconUrl(t),[t]),h=g=>{switch(g.type){case at.MOUSE_DOWN:e(t),o(!0);return;case at.MOUSE_UP:o(!1);return;case at.ROLL_OUT:if(!n||!s||!c)return;l(t);return}},d=t.product;return d?r.jsx(ee,{itemImage:u,itemCount:t.pricingModel===_i.PRICING_MODEL_MULTI?d.productCount:1,itemUniqueSoldout:d.uniqueLimitedItemSeriesSize&&!d.uniqueLimitedItemsLeft,itemUniqueNumber:d.uniqueLimitedItemSeriesSize,itemActive:s,onMouseDown:h,onMouseUp:h,onMouseOut:h,...i,children:t.product.productType===Yt.ROBOT&&r.jsx(ls,{figure:t.product.extraParam,headOnly:!0,direction:3})}):null},D_=a=>{const{columnCount:t=5,children:e=null,...s}=a,{currentOffer:i=null,setCurrentOffer:n=null,currentPage:o=null,setPurchaseOptions:l=null}=Ne(),c=_.useRef();if(_.useEffect(()=>{c&&c.current&&(c.current.scrollTop=0)},[o]),!o)return null;const u=h=>{h.activate(),!h.isLazy&&(n(h),h.product&&h.product.productType===Yt.WALL&&l(d=>{const g={...d};return g.extraData=h.product.extraParam||null,g}))};return r.jsxs(Ce,{innerRef:c,columnCount:t,...s,children:[o.offers&&o.offers.length>0&&o.offers.map((h,d)=>r.jsx(BO,{itemActive:i&&i.offerId===h.offerId,offer:h,selectOffer:u},d)),e]})},Ep=a=>{const{children:t=null,...e}=a,{currentOffer:s=null}=Ne();return!s||s.pricingModel!==_i.PRICING_MODEL_SINGLE||!s.product.isUniqueLimitedItem?null:r.jsxs(H,{...e,children:[r.jsx(I8,{className:"mx-auto",uniqueLimitedItemsLeft:s.product.uniqueLimitedItemsLeft,uniqueLimitedSeriesSize:s.product.uniqueLimitedItemSeriesSize}),t]})},zn=a=>{const{noGiftOption:t=!1,purchaseCallback:e=null}=a;_.useState(!1);const[s,i]=_.useState($e.NONE);hp(c_.CATALOG_SKIP_PURCHASE_CONFIRMATION,!1);const{currentOffer:n=null,currentPage:o=null,purchaseOptions:l=null,setPurchaseOptions:c=null}=Ne(),{getCurrencyAmount:u=null}=kc(),h=_.useCallback(m=>{switch(m.type){case wa.PURCHASE_SUCCESS:i($e.NONE);return;case _l.PURCHASE_FAILED:i($e.FAILED);return;case g_.NOT_ALLOWED:i($e.FAILED);return;case f_.SOLD_OUT:i($e.SOLD_OUT);return}},[]);Is(wa.PURCHASE_SUCCESS,h),Is(_l.PURCHASE_FAILED,h),Is(g_.NOT_ALLOWED,h),Is(f_.SOLD_OUT,h);const d=_.useMemo(()=>{if(!n||l.extraParamRequired&&(!l.extraData||!l.extraData.length))return!1;if(n.pricingModel===_i.PRICING_MODEL_SINGLE){const m=n.product;if(m&&m.isUniqueLimitedItem)return!m.uniqueLimitedItemsLeft}return!1},[n,l]),g=(m=!1)=>{if(!n)return;if(Wr()<n.clubLevel){ut("habboUI/open/hccenter");return}if(m){Fs(new D8(n.page.pageId,n.offerId,l.extraData));return}if(i($e.PURCHASE),e){e();return}let I=n.page.pageId;k(new R_(I,n.offerId,l.extraData,l.quantity))};if(_.useEffect(()=>{n&&i($e.NONE)},[n,c]),_.useEffect(()=>{let m=null;return(s===$e.CONFIRM||s===$e.FAILED)&&(m=setTimeout(()=>i($e.NONE),3e3)),()=>{m&&clearTimeout(m)}},[s]),!n)return null;const E=()=>{const m=n.priceInCredits*l.quantity,I=n.priceInActivityPoints*l.quantity;if(Wr()<n.clubLevel)return r.jsx(V,{variant:"danger",disabled:!0,children:f("catalog.alert.hc.required")});if(d)return r.jsx(V,{variant:"danger",disabled:!0,children:f("catalog.alert.limited_edition_sold_out.title")});if(m>u(-1))return r.jsx(V,{variant:"danger",disabled:!0,children:f("catalog.alert.notenough.title")});if(I>u(n.activityPointType))return r.jsx(V,{variant:"danger",disabled:!0,children:f("catalog.alert.notenough.activitypoints.title."+n.activityPointType)});switch(s){case $e.CONFIRM:return r.jsx(V,{variant:"warning",onClick:p=>g(),children:f("catalog.marketplace.confirm_title")});case $e.PURCHASE:return r.jsx(V,{disabled:!0,children:r.jsx(PO,{})});case $e.FAILED:return r.jsx(V,{variant:"danger",children:f("generic.failed")});case $e.SOLD_OUT:return r.jsx(V,{variant:"danger",children:f("generic.failed")+" - "+f("catalog.alert.limited_edition_sold_out.title")});case $e.NONE:default:return r.jsx(V,{disabled:l.extraParamRequired&&(!l.extraData||!l.extraData.length),onClick:p=>i($e.CONFIRM),children:f("catalog.purchase_confirmation."+(n.isRentOffer?"rent":"buy"))})}};return r.jsxs(r.Fragment,{children:[r.jsx(E,{}),!t&&!n.isRentOffer&&r.jsx(V,{disabled:l.quantity>1||!n.giftable||d||l.extraParamRequired&&(!l.extraData||!l.extraData.length),onClick:m=>g(!0),children:f("catalog.purchase_confirmation.gift")})]})},X0=a=>{const{offer:t=null,separator:e=!1}=a,{purchaseOptions:s=null}=Ne(),{quantity:i=1}=s;return t?r.jsxs(r.Fragment,{children:[t.priceInCredits>0&&r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx(O,{bold:!0,children:t.priceInCredits*i}),r.jsx(ps,{type:-1})]}),e&&t.priceInCredits>0&&t.priceInActivityPoints>0&&r.jsx(p_,{size:"xs",color:"black",className:"fa-icon"}),t.priceInActivityPoints>0&&r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx(O,{bold:!0,children:t.priceInActivityPoints*i}),r.jsx(ps,{type:t.activityPointType})]})]}):null},Co=a=>{const{gap:t=1,...e}=a,{currentOffer:s=null}=Ne();return r.jsx(A,{gap:t,...e,children:r.jsx(X0,{offer:s})})},El=a=>{const{currentOffer:t=null,roomPreviewer:e=null,purchaseOptions:s=null}=Ne(),{previewStuffData:i=null}=s;return _.useEffect(()=>{if(!t||t.pricingModel===_i.PRICING_MODEL_BUNDLE||!e)return;const n=t.product;if(n)switch(e.reset(!1),n.productType){case Yt.FLOOR:{if(!n.furnitureData)return;if(n.furnitureData.specialType===vt.FIGURE_PURCHASABLE_SET){const l=q().getFloorItemData(n.furnitureData.id).customParams.split(",").map(h=>parseInt(h)),c=[];for(const h of l)Gs().isValidFigureSetForGender(h,q().gender)&&c.push(h);const u=Gs().getFigureStringWithFigureIds(q().figure,q().gender,c);e.addAvatarIntoRoom(u,n.productClassId)}else e.addFurnitureIntoRoom(n.productClassId,new j(90),i,n.extraParam);return}case Yt.WALL:{if(!n.furnitureData)return;switch(n.furnitureData.specialType){case vt.FLOOR:e.updateObjectRoom(n.extraParam);return;case vt.WALL_PAPER:e.updateObjectRoom(null,n.extraParam);return;case vt.LANDSCAPE:{e.updateObjectRoom(null,null,n.extraParam);const o=q().getWallItemDataByName("window_double_default");o&&e.addWallItemIntoRoom(o.id,new j(90),o.customParams);return}default:e.updateObjectRoom("default","default","default"),e.addWallItemIntoRoom(n.productClassId,new j(90),n.extraParam);return}}case Yt.ROBOT:e.addAvatarIntoRoom(n.extraParam,0);return;case Yt.EFFECT:e.addAvatarIntoRoom(q().figure,n.productClassId);return}},[t,i,e]),t?t.pricingModel===_i.PRICING_MODEL_BUNDLE?r.jsx(A,{fit:!0,overflow:"hidden",className:"bg-muted p-2 rounded",children:r.jsx(Ce,{fullWidth:!0,columnCount:4,className:"nitro-catalog-layout-bundle-grid",children:t.products.length>0&&t.products.map((n,o)=>r.jsx(ee,{itemImage:n.getIconUrl(t),itemCount:n.productCount},o))})}):r.jsx(op,{roomPreviewer:e,height:140}):null},aJ=a=>{const{page:t=null}=a,{currentOffer:e=null}=Ne();return r.jsxs(r.Fragment,{children:[r.jsx(mp,{}),r.jsxs(_t,{children:[r.jsxs(A,{size:7,overflow:"hidden",children:[r.jsx(D_,{shrink:!0}),r.jsxs(A,{gap:1,overflow:"hidden",children:[r.jsx(O,{truncate:!0,shrink:!0,fontWeight:"bold",children:f("catalog_selectbadge")}),r.jsx(nJ,{})]})]}),r.jsxs(A,{center:!e,size:5,overflow:"hidden",children:[!e&&r.jsxs(r.Fragment,{children:[!!t.localization.getImage(1)&&r.jsx("img",{alt:"",src:t.localization.getImage(1)}),r.jsx(O,{center:!0,dangerouslySetInnerHTML:{__html:t.localization.getText(0)}})]}),e&&r.jsxs(r.Fragment,{children:[r.jsx(H,{position:"relative",overflow:"hidden",children:r.jsx(El,{})}),r.jsxs(A,{grow:!0,gap:1,children:[r.jsx(Ep,{fullWidth:!0}),r.jsx(O,{grow:!0,truncate:!0,children:e.localizationName}),r.jsx(M,{justifyContent:"end",children:r.jsx(Co,{alignItems:"end"})}),r.jsx(zn,{})]})]})]})]})]})},gl=a=>{const{...t}=a,{currentOffer:e=null}=Ne();return!e||!e.badgeCode||!e.badgeCode.length?null:r.jsx(Ge,{badgeCode:e.badgeCode,...t})},oJ=1,lJ=100,kO=a=>{const{currentOffer:t=null,purchaseOptions:e=null,setPurchaseOptions:s=null}=Ne(),{quantity:i=1}=e,n=o=>{isNaN(o)&&(o=1),o=Math.max(o,oJ),o=Math.min(o,lJ),o!==i&&s(l=>{const c={...l};return c.quantity=o,c})};return!t||!t.bundlePurchaseAllowed?null:r.jsxs(r.Fragment,{children:[r.jsx(O,{children:f("catalog.bundlewidget.spinner.select.amount")}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx(wN,{className:"text-black cursor-pointer fa-icon",onClick:o=>n(i-1)}),r.jsx("input",{type:"number",className:"form-control form-control-sm quantity-input",value:i,onChange:o=>n(o.target.valueAsNumber)}),r.jsx(FN,{className:"text-black cursor-pointer fa-icon",onClick:o=>n(i+1)})]})]})},cJ=a=>{const{page:t=null}=a,[e,s]=_.useState(new Map),{currentOffer:i=null,setCurrentOffer:n=null}=Ne(),[o,l]=_.useState(!1),c=(E,m)=>!E.product.furnitureData.colorIndex||!m.product.furnitureData.colorIndex||E.product.furnitureData.colorIndex>m.product.furnitureData.colorIndex?1:E==m?0:-1,u=(E,m)=>E.product.furnitureData.className>m.product.furnitureData.className?1:E==m?0:-1,h=E=>{E.activate(),n(E)},d=(E,m)=>{const I=`${m}*${E}`,p=t.offers.findIndex(T=>T.product.furnitureData.fullName===I);p>-1&&h(t.offers[p])},g=_.useMemo(()=>{const E=[],m=new Map,I=new Map;return t.offers.sort(c),t.offers.forEach(p=>{if(!p.product)return;const T=p.product.furnitureData;if(!T||!T.hasIndexedColor)E.push(p);else{const R=T.className,S=T.colorIndex;I.has(R)||I.set(R,[]);let b=16777215;if(T.colors){for(let N of T.colors)N!==16777215&&(b=N);I.get(R).indexOf(b)===-1&&(I.get(R)[S]=b)}m.has(R)||(E.push(p),m.set(R,!0))}}),E.sort(u),s(I),E},[t.offers]);return r.jsxs(_t,{children:[r.jsx(A,{size:7,overflow:"hidden",children:r.jsxs(Ce,{columnCount:5,children:[(!o||!i||!e.has(i.product.furnitureData.className))&&g.map((E,m)=>r.jsx(BO,{itemActive:i&&(i.product.furnitureData.hasIndexedColor?i.product.furnitureData.className===E.product.furnitureData.className:i.offerId===E.offerId),offer:E,selectOffer:h},m)),o&&i&&e.has(i.product.furnitureData.className)&&e.get(i.product.furnitureData.className).map((E,m)=>r.jsx(ee,{itemHighlight:!0,itemActive:i.product.furnitureData.colorIndex===m,itemColor:ii.int2rgb(E),className:"clear-bg",onClick:I=>d(m,i.product.furnitureData.className)},m))]})}),r.jsxs(A,{center:!i,size:5,overflow:"hidden",children:[!i&&r.jsxs(r.Fragment,{children:[!!t.localization.getImage(1)&&r.jsx("img",{alt:"",src:t.localization.getImage(1)}),r.jsx(O,{center:!0,dangerouslySetInnerHTML:{__html:t.localization.getText(0)}})]}),i&&r.jsxs(r.Fragment,{children:[r.jsxs(H,{position:"relative",overflow:"hidden",children:[r.jsx(El,{}),r.jsx(gl,{position:"absolute",className:"bg-muted rounded bottom-1 end-1"}),i.product.furnitureData.hasIndexedColor&&r.jsx(V,{position:"absolute",className:"bottom-1 start-1",onClick:E=>l(m=>!m),children:r.jsx(GN,{className:"fa-icon"})})]}),r.jsxs(A,{grow:!0,gap:1,children:[r.jsx(Ep,{fullWidth:!0}),r.jsx(O,{grow:!0,truncate:!0,children:i.localizationName}),r.jsxs(M,{justifyContent:"between",children:[r.jsx(A,{gap:1,children:r.jsx(kO,{})}),r.jsx(Co,{justifyContent:"end",alignItems:"end"})]}),r.jsx(zn,{})]})]})]})]})},q0=a=>{const{imageUrl:t=null}=a,[e,s]=_.useState("");return _.useEffect(()=>{s(t??it("catalog.asset.image.url").replace("%name%","catalog_header_roombuilder"))},[t]),r.jsx(M,{center:!0,fullWidth:!0,className:"nitro-catalog-header",children:r.jsx("img",{src:e,onError:({currentTarget:i})=>{i.src=it("catalog.asset.image.url").replace("%name%","catalog_header_roombuilder")}})})},uJ=a=>{const{page:t=null}=a,{currentOffer:e=null,currentPage:s=null}=Ne();return r.jsx(r.Fragment,{children:r.jsxs(_t,{children:[r.jsxs(A,{size:7,overflow:"hidden",children:[it("catalog.headers")&&r.jsx(q0,{imageUrl:s.localization.getImage(0)}),r.jsx(D_,{})]}),r.jsxs(A,{center:!e,size:5,overflow:"hidden",children:[!e&&r.jsxs(r.Fragment,{children:[!!t.localization.getImage(1)&&r.jsx(Ga,{imageUrl:t.localization.getImage(1)}),r.jsx(O,{center:!0,dangerouslySetInnerHTML:{__html:t.localization.getText(0)}})]}),e&&r.jsxs(r.Fragment,{children:[r.jsxs(M,{center:!0,overflow:"hidden",style:{height:140},children:[e.product.productType!==Yt.BADGE&&r.jsxs(r.Fragment,{children:[r.jsx(El,{}),r.jsx(gl,{className:"bg-muted rounded bottom-1 end-1"})]}),e.product.productType===Yt.BADGE&&r.jsx(gl,{className:"scale-2"})]}),r.jsxs(A,{grow:!0,gap:1,children:[r.jsx(Ep,{fullWidth:!0}),r.jsx(O,{bold:!0,children:e.localizationName}),r.jsx(O,{grow:!0,small:!0,children:e.localizationDescription}),r.jsxs(M,{justifyContent:"between",children:[r.jsx(A,{gap:1,children:r.jsx(kO,{})}),r.jsx(Co,{justifyContent:"end",alignItems:"end"})]}),r.jsx(zn,{})]})]})]})]})})},hJ=a=>{const{...t}=a,{currentOffer:e=null,purchaseOptions:s=null}=Ne(),{previewStuffData:i=null}=s,n=_.useMemo(()=>{if(!e||!i)return null;const o=i.getValue(2);return!o||!o.length?null:o},[e,i]);return n?r.jsx(Ge,{badgeCode:n,isGroup:!0,...t}):null},Q0=a=>{const[t,e]=_.useState(0),{currentOffer:s=null,catalogOptions:i=null,setPurchaseOptions:n=null}=Ne(),{groups:o=null}=i,l=_.useMemo(()=>{if(!o||!o.length)return null;const u=o[t];if(!u)return null;const h=new Vn;return h.setValue(["0",u.groupId.toString(),u.badgeCode,u.colorA,u.colorB]),h},[t,o]);if(_.useEffect(()=>{s&&n(u=>{const h={...u};return h.extraParamRequired=!0,h.extraData=l&&l.getValue(1)||null,h.previewStuffData=l,h})},[s,l,n]),_.useEffect(()=>{k(new _O)},[]),!o||!o.length)return r.jsxs(H,{className:"bg-muted rounded p-1 text-black text-center",children:[f("catalog.guild_selector.members_only"),r.jsx(V,{className:"mt-1",children:f("catalog.guild_selector.find_groups")})]});const c=o[t];return r.jsxs(M,{gap:1,children:[!!c&&r.jsxs(M,{overflow:"hidden",className:"rounded border",children:[r.jsx(H,{fullHeight:!0,style:{width:"20px",backgroundColor:"#"+c.colorA}}),r.jsx(H,{fullHeight:!0,style:{width:"20px",backgroundColor:"#"+c.colorB}})]}),r.jsx("select",{className:"form-select form-select-sm",value:t,onChange:u=>e(parseInt(u.target.value)),children:o.map((u,h)=>r.jsx("option",{value:h,children:u.groupName},h))})]})},dJ=a=>{const{page:t=null}=a,{currentOffer:e=null}=Ne();return r.jsxs(_t,{children:[r.jsx(A,{size:7,overflow:"hidden",children:r.jsx(D_,{})}),r.jsxs(A,{center:!e,size:5,overflow:"hidden",children:[!e&&r.jsxs(r.Fragment,{children:[!!t.localization.getImage(1)&&r.jsx("img",{alt:"",src:t.localization.getImage(1)}),r.jsx(O,{center:!0,dangerouslySetInnerHTML:{__html:t.localization.getText(0)}})]}),e&&r.jsxs(r.Fragment,{children:[r.jsxs(H,{position:"relative",overflow:"hidden",children:[r.jsx(El,{}),r.jsx(hJ,{position:"absolute",className:"bottom-1 end-1"})]}),r.jsxs(A,{grow:!0,gap:1,children:[r.jsx(O,{truncate:!0,children:e.localizationName}),r.jsx(H,{grow:!0,children:r.jsx(Q0,{})}),r.jsx(M,{justifyContent:"end",children:r.jsx(Co,{alignItems:"end"})}),r.jsx(zn,{})]})]})]})]})},_J=a=>{const{page:t=null}=a;_.useState(0);const{currentOffer:e=null,setCurrentOffer:s=null,catalogOptions:i=null}=Ne();return _.useEffect(()=>{k(new _O)},[t]),r.jsxs(r.Fragment,{children:[r.jsx(mp,{}),r.jsxs(_t,{children:[r.jsx(A,{className:"bg-muted rounded p-2 text-black",size:7,overflow:"hidden",children:r.jsx(H,{className:"overflow-auto",dangerouslySetInnerHTML:{__html:t.localization.getText(1)}})}),r.jsx(A,{size:5,overflow:"hidden",gap:1,children:!!e&&r.jsx(r.Fragment,{children:r.jsxs(A,{grow:!0,gap:1,children:[r.jsx(O,{truncate:!0,children:e.localizationName}),r.jsx(H,{grow:!0,children:r.jsx(Q0,{})}),r.jsx(M,{justifyContent:"end",children:r.jsx(Co,{alignItems:"end"})}),r.jsx(zn,{noGiftOption:!0})]})})})]})]})},gJ=a=>{const{page:t=null}=a;return r.jsxs(_t,{children:[r.jsxs(A,{size:7,overflow:"hidden",className:"bg-muted rounded p-2 text-black",children:[r.jsx(H,{dangerouslySetInnerHTML:{__html:t.localization.getText(2)}}),r.jsx(H,{overflow:"auto",dangerouslySetInnerHTML:{__html:t.localization.getText(0)}}),r.jsx(H,{dangerouslySetInnerHTML:{__html:t.localization.getText(1)}})]}),r.jsxs(A,{center:!0,size:5,overflow:"hidden",children:[r.jsx(Ga,{imageUrl:t.localization.getImage(1)}),r.jsx(V,{onClick:()=>ut("groups/create"),children:f("catalog.start.guild.purchase.button")})]})]})},fJ=a=>{const{page:t=null}=a;return r.jsx("div",{className:"h-100 nitro-catalog-layout-info-loyalty text-black d-flex flex-row",children:r.jsx("div",{className:"overflow-auto h-100 d-flex flex-column info-loyalty-content",children:r.jsx("div",{dangerouslySetInnerHTML:{__html:t.localization.getText(0)}})})})},J0=a=>{const{page:t=null}=a,e=t.localization.getImage(1);return r.jsxs(A,{grow:!0,className:"bg-muted rounded text-black p-2",overflow:"hidden",children:[r.jsxs(M,{alignItems:"center",gap:2,children:[e&&r.jsx("img",{alt:"",src:e}),r.jsx(H,{className:"fs-5",dangerouslySetInnerHTML:{__html:t.localization.getText(1)}})]}),r.jsx(A,{grow:!0,alignItems:"center",overflow:"auto",children:r.jsx(H,{dangerouslySetInnerHTML:{__html:t.localization.getText(2)}})}),r.jsx(M,{alignItems:"center",children:r.jsx(H,{className:"fw-bold",dangerouslySetInnerHTML:{__html:t.localization.getText(3)}})})]})},mJ=a=>r.jsx(J0,{...a}),EJ=a=>{const{page:t=null}=a,[e,s]=_.useState(""),[i,n]=_.useState(""),[o,l]=_.useState(-1),[c,u]=_.useState([]),[h,d]=_.useState(!1),[g,E]=_.useState(1),{categories:m=null}=pn(),{setIsVisible:I=null}=Ne(),{promoteInformation:p,isExtended:T,setIsExtended:R}=GO();_.useEffect(()=>{T&&(l(p.data.flatId),s(p.data.eventName),n(p.data.eventDescription),E(p.data.categoryId),d(T),R(!1))},[T,e,i,g]);const S=()=>{l(-1),s(""),n(""),E(1),R(!1),I(!1)},b=()=>{const N=t.pageId,P=t.offers.length>=1?t.offers[0].offerId:-1,B=o,F=e,w=i,U=g;k(new Fb(N,P,B,F,h,w,U)),S()};return Y(Hx,N=>{const P=N.getParser();P&&u(P.rooms)}),_.useEffect(()=>{k(new Ub),k(new sO)},[]),r.jsxs(r.Fragment,{children:[r.jsx(O,{bold:!0,center:!0,children:f("roomad.catalog_header")}),r.jsxs(A,{size:12,overflow:"hidden",className:"text-black",children:[r.jsx(H,{children:f("roomad.catalog_text",["duration"],["120"])}),r.jsxs(H,{className:"bg-muted rounded p-1",children:[r.jsxs(A,{gap:2,children:[r.jsx(O,{bold:!0,children:f("navigator.category")}),r.jsx("select",{className:"form-select form-select-sm",value:g,onChange:N=>E(parseInt(N.target.value)),disabled:h,children:m&&m.map((N,P)=>r.jsx("option",{value:N.id,children:f(N.name)},P))})]}),r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("roomad.catalog_name")}),r.jsx("input",{type:"text",className:"form-control form-control-sm",maxLength:64,value:e,onChange:N=>s(N.target.value),readOnly:h})]}),r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("roomad.catalog_description")}),r.jsx("textarea",{className:"form-control form-control-sm",maxLength:64,value:i,onChange:N=>n(N.target.value),readOnly:h})]}),r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("roomad.catalog_roomname")}),r.jsxs("select",{className:"form-select form-select-sm",value:o,onChange:N=>l(parseInt(N.target.value)),disabled:h,children:[r.jsx("option",{value:-1,disabled:!0,children:f("roomad.catalog_roomname")}),c&&c.map((N,P)=>r.jsx("option",{value:N.roomId,children:N.roomName},P))]})]}),r.jsx(A,{gap:1,children:r.jsx(V,{variant:!e||!i||o===-1?"danger":"success",onClick:b,disabled:!e||!i||o===-1,children:f(h?"roomad.extend.event":"buy")})})]})]})]})},$0=a=>{const{columnCount:t=5,children:e=null,...s}=a,{currentOffer:i=null}=Ne(),n=_.useRef();return _.useEffect(()=>{n&&n.current&&(n.current.scrollTop=0)},[i]),i?r.jsxs(Ce,{innerRef:n,columnCount:5,...s,children:[i.products&&i.products.length>0&&i.products.map((o,l)=>r.jsx(ee,{itemImage:o.getIconUrl(),itemCount:o.productCount},l)),e]}):null},Z0=a=>{const{gap:t=1,...e}=a,{currentOffer:s=null}=Ne();return r.jsx(M,{gap:t,alignItems:"center",classNames:["bg-muted","p-1","rounded"],...e,children:r.jsx(X0,{separator:!0,offer:s})})},pJ=a=>{const{page:t=null}=a;return r.jsxs(r.Fragment,{children:[r.jsx(mp,{}),r.jsxs(_t,{children:[r.jsxs(A,{size:7,overflow:"hidden",children:[!!t.localization.getText(2)&&r.jsx(O,{dangerouslySetInnerHTML:{__html:t.localization.getText(2)}}),r.jsx(A,{grow:!0,overflow:"hidden",className:"bg-muted p-2 rounded",children:r.jsx($0,{fullWidth:!0,className:"nitro-catalog-layout-bundle-grid"})})]}),r.jsxs(A,{size:5,overflow:"hidden",gap:1,children:[!!t.localization.getText(1)&&r.jsx(O,{center:!0,small:!0,overflow:"auto",children:t.localization.getText(1)}),r.jsxs(A,{grow:!0,position:"relative",overflow:"hidden",gap:0,children:[!!t.localization.getImage(1)&&r.jsx("img",{alt:"",className:"flex-grow-1",src:t.localization.getImage(1)}),r.jsx(gl,{position:"absolute",className:"bg-muted rounded bottom-0 start-0"}),r.jsx(Z0,{position:"absolute",className:"bottom-0 end-0"})]}),r.jsx(A,{gap:1,children:r.jsx(zn,{})})]})]})]})},IJ=a=>{const{page:t=null}=a;return r.jsxs(r.Fragment,{children:[r.jsx(mp,{}),r.jsxs(_t,{children:[r.jsxs(A,{size:7,overflow:"hidden",children:[!!t.localization.getText(2)&&r.jsx(O,{dangerouslySetInnerHTML:{__html:t.localization.getText(2)}}),r.jsx(A,{grow:!0,overflow:"hidden",className:"bg-muted p-2 rounded",children:r.jsx($0,{fullWidth:!0,className:"nitro-catalog-layout-bundle-grid"})})]}),r.jsxs(A,{size:5,overflow:"hidden",gap:1,children:[!!t.localization.getText(1)&&r.jsx(O,{center:!0,small:!0,overflow:"auto",children:t.localization.getText(1)}),r.jsxs(A,{grow:!0,position:"relative",overflow:"hidden",gap:0,children:[!!t.localization.getImage(1)&&r.jsx("img",{alt:"",className:"flex-grow-1",src:t.localization.getImage(1)}),r.jsx(gl,{position:"absolute",className:"bg-muted rounded bottom-0 start-0"}),r.jsx(Z0,{position:"absolute",className:"bottom-0 end-0"})]}),r.jsx(A,{gap:1,children:r.jsx(zn,{})})]})]})]})},TJ=a=>{const{page:t=null}=a,[e,s]=_.useState(-1),[i,n]=_.useState(""),{currentOffer:o=null,currentPage:l=null}=Ne(),c=u=>{var h;return(h=Jt().soundManager.musicController)==null?void 0:h.playSong(u,di.PRIORITY_PURCHASE_PREVIEW,15,0,0,0)};return Y(XD,u=>{const h=u.getParser();h.officialSongId===i&&s(h.songId)}),_.useEffect(()=>{if(!o)return;const u=o.product;if(u){if(u.extraParam.length>0){const h=parseInt(u.extraParam);h>0?s(h):(n(u.extraParam),k(new nU(u.extraParam)))}else n(""),s(-1);return()=>{var h;return(h=Jt().soundManager.musicController)==null?void 0:h.stop(di.PRIORITY_PURCHASE_PREVIEW)}}},[o]),_.useEffect(()=>()=>{var u;return(u=Jt().soundManager.musicController)==null?void 0:u.stop(di.PRIORITY_PURCHASE_PREVIEW)},[]),r.jsx(r.Fragment,{children:r.jsxs(_t,{children:[r.jsxs(A,{size:7,overflow:"hidden",children:[it("catalog.headers")&&r.jsx(q0,{imageUrl:l.localization.getImage(0)}),r.jsx(D_,{})]}),r.jsxs(A,{center:!o,size:5,overflow:"hidden",children:[!o&&r.jsxs(r.Fragment,{children:[!!t.localization.getImage(1)&&r.jsx(Ga,{imageUrl:t.localization.getImage(1)}),r.jsx(O,{center:!0,dangerouslySetInnerHTML:{__html:t.localization.getText(0)}})]}),o&&r.jsxs(r.Fragment,{children:[r.jsxs(M,{center:!0,overflow:"hidden",style:{height:140},children:[o.product.productType!==Yt.BADGE&&r.jsxs(r.Fragment,{children:[r.jsx(El,{}),r.jsx(gl,{className:"bg-muted rounded bottom-1 end-1"})]}),o.product.productType===Yt.BADGE&&r.jsx(gl,{className:"scale-2"})]}),r.jsxs(A,{grow:!0,gap:1,children:[r.jsx(Ep,{fullWidth:!0}),r.jsx(O,{grow:!0,truncate:!0,children:o.localizationName}),e>-1&&r.jsx(V,{onClick:()=>c(e),children:f("play_preview_button")}),r.jsxs(M,{justifyContent:"between",children:[r.jsx(A,{gap:1,children:r.jsx(kO,{})}),r.jsx(Co,{justifyContent:"end",alignItems:"end"})]}),r.jsx(zn,{})]})]})]})]})})},RJ=["floors","walls","views"],SJ=a=>{const{columnCount:t=5,children:e=null,...s}=a,[i,n]=_.useState(null),[o,l]=_.useState(-1),[c,u]=_.useState(null),{currentPage:h=null,currentOffer:d=null,setCurrentOffer:g=null,setPurchaseOptions:E=null}=Ne(),m=_.useRef(),I=T=>{T&&u(R=>{const S=[...R];return S[o]=T,S})};if(_.useEffect(()=>{if(!h)return;const T=[[],[],[]];for(const R of h.offers){if(R.pricingModel!==_i.PRICING_MODEL_SINGLE&&R.pricingModel!==_i.PRICING_MODEL_MULTI)continue;const S=R.product;if(!S||S.productType!==Yt.WALL&&S.productType!==Yt.FLOOR||!S.furnitureData)continue;switch(S.furnitureData.className){case"floor":T[0].push(R);break;case"wallpaper":T[1].push(R);break;case"landscape":T[2].push(R);break}}n(T),l(0),u([T[0][0],T[1][0],T[2][0]])},[h]),_.useEffect(()=>{o===-1||!c||g(c[o])},[o,c,g]),_.useEffect(()=>{o===-1||!c||!d||E(T=>{const R={...T};return R.extraData=c[o].product.extraParam,R.extraParamRequired=!0,R})},[d,o,c,E]),_.useEffect(()=>{m&&m.current&&(m.current.scrollTop=0)},[o]),!i||o===-1)return null;const p=i[o];return r.jsxs(r.Fragment,{children:[r.jsx(Da,{children:RJ.map((T,R)=>r.jsx(V,{active:o===R,onClick:S=>l(R),children:f(`catalog.spaces.tab.${T}`)},R))}),r.jsxs(Ce,{innerRef:m,columnCount:t,...s,children:[p&&p.length>0&&p.map((T,R)=>r.jsx(BO,{itemActive:d&&d===T,offer:T,selectOffer:S=>I(S)},R)),e]})]})},OJ=a=>{const{page:t=null}=a,{currentOffer:e=null,roomPreviewer:s=null}=Ne();return _.useEffect(()=>{s.updatePreviewObjectBoundingRectangle(new ei)},[s]),r.jsxs(_t,{children:[r.jsx(A,{size:7,overflow:"hidden",children:r.jsx(SJ,{})}),r.jsxs(A,{center:!e,size:5,overflow:"hidden",children:[!e&&r.jsxs(r.Fragment,{children:[!!t.localization.getImage(1)&&r.jsx("img",{alt:"",src:t.localization.getImage(1)}),r.jsx(O,{center:!0,dangerouslySetInnerHTML:{__html:t.localization.getText(0)}})]}),e&&r.jsxs(r.Fragment,{children:[r.jsx(H,{position:"relative",overflow:"hidden",children:r.jsx(El,{})}),r.jsxs(A,{grow:!0,gap:1,children:[r.jsx(O,{grow:!0,truncate:!0,children:e.localizationName}),r.jsx(M,{justifyContent:"end",children:r.jsx(Co,{alignItems:"end"})}),r.jsx(zn,{})]})]})]})]})},CJ=a=>{const{page:t=null}=a,[e,s]=_.useState(""),{currentOffer:i=null,setPurchaseOptions:n=null}=Ne();return _.useEffect(()=>{i&&n(o=>{const l={...o};return l.extraData=e,l})},[i,e,n]),r.jsxs(_t,{children:[r.jsxs(A,{size:7,overflow:"hidden",children:[r.jsx(D_,{}),r.jsx("textarea",{className:"flex-grow-1 form-control w-100",defaultValue:e||"",onChange:o=>s(o.target.value)})]}),r.jsxs(A,{center:!i,size:5,overflow:"hidden",children:[!i&&r.jsxs(r.Fragment,{children:[!!t.localization.getImage(1)&&r.jsx("img",{alt:"",src:t.localization.getImage(1)}),r.jsx(O,{center:!0,dangerouslySetInnerHTML:{__html:t.localization.getText(0)}})]}),i&&r.jsxs(r.Fragment,{children:[r.jsx(El,{}),r.jsxs(A,{grow:!0,gap:1,children:[r.jsx(O,{grow:!0,truncate:!0,children:i.localizationName}),r.jsx(M,{justifyContent:"end",children:r.jsx(Co,{alignItems:"end"})}),r.jsx(zn,{})]})]})]})]})},AJ=a=>{const[t,e]=_.useState(null),[s,i]=_.useState($e.NONE),{currentPage:n=null,catalogOptions:o=null}=Ne(),{purse:l=null,getCurrencyAmount:c=null}=kc(),{clubOffers:u=null}=o,h=_.useCallback(R=>{switch(R.type){case wa.PURCHASE_SUCCESS:i($e.NONE);return;case _l.PURCHASE_FAILED:i($e.FAILED);return}},[]);Is(wa.PURCHASE_SUCCESS,h),Is(_l.PURCHASE_FAILED,h);const d=_.useCallback(R=>{let S="";return R.months>0&&(S=f("catalog.vip.item.header.months",["num_months"],[R.months.toString()])),R.extraDays>0&&(S!==""&&(S+=" "),S+=" "+f("catalog.vip.item.header.days",["num_days"],[R.extraDays.toString()])),S},[]),g=_.useCallback(()=>{if(!l)return"";const R=l.clubDays>0||l.clubPeriods>0?"extension.":"subscription.",S=t.months===0?"days":"months",b=t.months===0?t.extraDays:t.months;return f("catalog.vip.buy.confirm."+R+S).replace("%NUM_"+S.toUpperCase()+"%",b.toString())},[t,l]),E=_.useCallback(()=>{let R=f("catalog.vip.buy.confirm.end_date");return R=R.replace("%month%",t.month.toString()),R=R.replace("%day%",t.day.toString()),R=R.replace("%year%",t.year.toString()),R},[t]),m=_.useMemo(()=>{const R=l.clubDays,b=l.clubPeriods*31+R;return f("catalog.vip.extend.info",["days"],[b.toString()])},[l]),I=_.useCallback(()=>{t&&(i($e.PURCHASE),k(new R_(n.pageId,t.offerId,null,1)))},[t,n]),p=_.useCallback(R=>{i($e.NONE),e(R)},[]),T=_.useCallback(()=>{if(!t)return null;if(t.priceCredits>c(-1))return r.jsx(V,{fullWidth:!0,variant:"danger",children:f("catalog.alert.notenough.title")});if(t.priceActivityPoints>c(t.priceActivityPointsType))return r.jsx(V,{fullWidth:!0,variant:"danger",children:f("catalog.alert.notenough.activitypoints.title."+t.priceActivityPointsType)});switch(s){case $e.CONFIRM:return r.jsx(V,{fullWidth:!0,variant:"warning",onClick:I,children:f("catalog.marketplace.confirm_title")});case $e.PURCHASE:return r.jsx(V,{fullWidth:!0,variant:"primary",disabled:!0,children:r.jsx(PO,{})});case $e.FAILED:return r.jsx(V,{fullWidth:!0,variant:"danger",disabled:!0,children:f("generic.failed")});case $e.NONE:default:return r.jsx(V,{fullWidth:!0,variant:"success",onClick:()=>i($e.CONFIRM),children:f("buy")})}},[t,s,I,c]);return _.useEffect(()=>{u||k(new vb(1))},[u]),r.jsxs(_t,{children:[r.jsxs(A,{fullHeight:!0,size:7,overflow:"hidden",justifyContent:"between",children:[r.jsx(Ce,{columnCount:1,className:"nitro-catalog-layout-vip-buy-grid",children:u&&u.length>0&&u.map((R,S)=>r.jsxs(ee,{column:!1,center:!1,alignItems:"center",justifyContent:"between",itemActive:t===R,className:"p-1",onClick:()=>p(R),children:[r.jsx("i",{className:"icon-hc-banner"}),r.jsxs(A,{justifyContent:"end",gap:0,children:[r.jsx(O,{textEnd:!0,children:d(R)}),r.jsxs(M,{justifyContent:"end",gap:1,children:[R.priceCredits>0&&r.jsxs(M,{alignItems:"center",justifyContent:"end",gap:1,children:[r.jsx(O,{children:R.priceCredits}),r.jsx(ps,{type:-1})]}),R.priceActivityPoints>0&&r.jsxs(M,{alignItems:"center",justifyContent:"end",gap:1,children:[r.jsx(O,{children:R.priceActivityPoints}),r.jsx(ps,{type:R.priceActivityPointsType})]})]})]})]},S))}),r.jsx(O,{center:!0,dangerouslySetInnerHTML:{__html:f("catalog.vip.buy.hccenter")}})]}),r.jsxs(A,{size:5,overflow:"hidden",children:[r.jsxs(A,{fullHeight:!0,center:!0,overflow:"hidden",children:[n.localization.getImage(1)&&r.jsx("img",{alt:"",src:n.localization.getImage(1)}),r.jsx(O,{center:!0,overflow:"auto",dangerouslySetInnerHTML:{__html:m}})]}),t&&r.jsxs(A,{fullWidth:!0,grow:!0,justifyContent:"end",children:[r.jsxs(M,{alignItems:"end",children:[r.jsxs(A,{grow:!0,gap:0,children:[r.jsx(O,{fontWeight:"bold",children:g()}),r.jsx(O,{children:E()})]}),r.jsxs(A,{gap:1,children:[t.priceCredits>0&&r.jsxs(M,{alignItems:"center",justifyContent:"end",gap:1,children:[r.jsx(O,{children:t.priceCredits}),r.jsx(ps,{type:-1})]}),t.priceActivityPoints>0&&r.jsxs(M,{alignItems:"center",justifyContent:"end",gap:1,children:[r.jsx(O,{children:t.priceActivityPoints}),r.jsx(ps,{type:t.priceActivityPointsType})]})]})]}),T()]})]})]})},NJ=a=>{const{text:t=null}=a,[e,s]=_.useState(""),[i,n]=_.useState(!1),{simpleAlert:o=null}=He(),l=()=>{!e||!e.length||i||(k(new Bb(e)),n(!0))};return Y(Kx,c=>{const u=c.getParser();let h=f("catalog.alert.voucherredeem.ok.description");u.productName&&(h=f("catalog.alert.voucherredeem.ok.description.furni",["productName","productDescription"],[u.productName,u.productDescription])),o(h,null,null,null,f("catalog.alert.voucherredeem.ok.title")),n(!1),s("")}),Y(zx,c=>{const u=c.getParser();o(f(`catalog.alert.voucherredeem.error.description.${u.errorCode}`),null,null,null,f("catalog.alert.voucherredeem.error.title")),n(!1)}),r.jsxs(M,{gap:1,children:[r.jsx("input",{type:"text",className:"form-control form-control-sm",placeholder:t,value:e,onChange:c=>s(c.target.value)}),r.jsx(V,{variant:"primary",onClick:l,disabled:i,children:r.jsx(Bj,{className:"fa-icon"})})]})},Y_=a=>{const{item:t=null,position:e="relative",pointer:s=!0,overflow:i="hidden",fullHeight:n=!0,classNames:o=[],children:l=null,...c}=a,u=_.useMemo(()=>{const d=["rounded","nitro-front-page-item"];return o.length&&d.push(...o),d},[o]);if(!t)return null;const h=it("image.library.url")+t.itemPromoImage;return r.jsxs(x0,{imageUrl:h,classNames:u,position:e,fullHeight:n,pointer:s,overflow:i,...c,children:[r.jsx(O,{position:"absolute",variant:"white",className:"bg-dark rounded p-2 m-2 bottom-0",children:t.itemName}),l]})},xJ=a=>{const{page:t=null,hideNavigation:e=null}=a,{frontPageItems:s=[]}=Ne(),i=_.useCallback(n=>{switch(n.type){case Kd.ITEM_CATALOGUE_PAGE:ut(`catalog/open/${n.catalogPageLocation}`);return;case Kd.ITEM_PRODUCT_OFFER:ut(`catalog/open/${n.productOfferId}`);return}},[]);return _.useEffect(()=>{e()},[t,e]),r.jsxs(_t,{children:[r.jsx(A,{size:4,children:s[0]&&r.jsx(Y_,{item:s[0],onClick:n=>i(s[0])})}),r.jsxs(A,{size:8,children:[s[1]&&r.jsx(Y_,{item:s[1],onClick:n=>i(s[1])}),s[2]&&r.jsx(Y_,{item:s[2],onClick:n=>i(s[2])}),s[3]&&r.jsx(Y_,{item:s[3],onClick:n=>i(s[3])}),r.jsx(NJ,{text:t.localization.getText(1)})]})]})},rS=1,og=2,tj=a=>{const{offerData:t=null,type:e=og,onClick:s=null}=a,i=_.useMemo(()=>t?f((t.furniType===2?"wallItem":"roomItem")+`.name.${t.furniId}`):"",[t]),n=_.useCallback(()=>{if(!t)return"";if(t.status===l_.SOLD)return f("catalog.marketplace.offer.sold");if(t.timeLeftMinutes<=0)return f("catalog.marketplace.offer.expired");const o=Math.max(1,t.timeLeftMinutes),l=Math.floor(o/60);let u=o-l*60+" "+f("catalog.marketplace.offer.minutes");return l>0&&(u=l+" "+f("catalog.marketplace.offer.hours")+" "+u),f("catalog.marketplace.offer.time_left",["time"],[u])},[t]);return r.jsxs(ee,{shrink:!0,center:!1,column:!1,alignItems:"center",className:"p-1",children:[r.jsx(A,{style:{width:40,height:40},children:r.jsx(ee,{column:!1,itemImage:r7(t.furniType===o_.TYPE_FLOOR?Yt.FLOOR:Yt.WALL,t.furniId,t.extraData),itemUniqueNumber:t.isUniqueLimitedItem?t.stuffData.uniqueNumber:0})}),r.jsxs(A,{grow:!0,gap:0,children:[r.jsx(O,{fontWeight:"bold",children:i}),e===rS&&r.jsxs(r.Fragment,{children:[r.jsx(O,{children:f("catalog.marketplace.offer.price_own_item",["price"],[t.price.toString()])}),r.jsx(O,{children:n()})]}),e===og&&r.jsxs(r.Fragment,{children:[r.jsx(O,{children:f("catalog.marketplace.offer.price_public_item",["price","average"],[t.price.toString(),t.averagePrice>0?t.averagePrice.toString():"-"])}),r.jsx(O,{children:f("catalog.marketplace.offer_count",["count"],[t.offerCount.toString()])})]})]}),r.jsxs(A,{gap:1,children:[e===rS&&t.status!==l_.SOLD&&r.jsx(V,{variant:"secondary",onClick:()=>s(t),children:f("catalog.marketplace.offer.pick")}),e===og&&r.jsxs(r.Fragment,{children:[r.jsx(V,{variant:"secondary",onClick:()=>s(t),children:f("buy")}),r.jsx(V,{variant:"secondary",disabled:!0,children:f("catalog.marketplace.view_more")})]})]})]})},MJ=a=>{const[t,e]=_.useState(0),[s,i]=_.useState([]),{simpleAlert:n=null}=He();Y(iy,u=>{const h=u.getParser();if(!h)return;const d=h.offers.map(g=>{const E=new o_(g.offerId,g.furniId,g.furniType,g.extraData,g.stuffData,g.price,g.status,g.averagePrice,g.offerCount);return E.timeLeftMinutes=g.timeLeftMinutes,E});e(h.creditsWaiting),i(d)}),Y(ZM,u=>{const h=u.getParser();if(h){if(!h.success){n(f("catalog.marketplace.cancel_failed"),Bt.DEFAULT,null,null,f("catalog.marketplace.operation_failed.topic"));return}i(d=>d.filter(g=>g.offerId!==h.offerId))}});const o=_.useMemo(()=>s.filter(u=>u.status===l_.SOLD),[s]),l=_.useCallback(()=>{i(u=>{const h=o.map(d=>d.offerId);return u.filter(d=>h.indexOf(d.offerId)===-1)}),k(new lL)},[o]),c=u=>{k(new iL(u.offerId))};return _.useEffect(()=>{k(new aL)},[]),r.jsxs(A,{overflow:"hidden",children:[t<=0&&r.jsx(O,{center:!0,className:"bg-muted rounded p-1",children:f("catalog.marketplace.redeem.no_sold_items")}),t>0&&r.jsxs(A,{center:!0,gap:1,className:"bg-muted rounded p-2",children:[r.jsx(O,{children:f("catalog.marketplace.redeem.get_credits",["count","credits"],[o.length.toString(),t.toString()])}),r.jsx(V,{className:"mt-1",onClick:l,children:f("catalog.marketplace.offer.redeem")})]}),r.jsxs(A,{gap:1,overflow:"hidden",children:[r.jsx(O,{truncate:!0,shrink:!0,fontWeight:"bold",children:f("catalog.marketplace.items_found",["count"],[s.length.toString()])}),r.jsx(A,{overflow:"auto",className:"nitro-catalog-layout-marketplace-grid",children:s.length>0&&s.map(u=>r.jsx(tj,{offerData:u,type:rS,onClick:c},u.offerId))})]})]})},yJ=a=>{const{searchType:t=null,sortTypes:e=null,onSearch:s=null}=a,[i,n]=_.useState(e?e[0]:3),[o,l]=_.useState(""),[c,u]=_.useState(0),[h,d]=_.useState(0),g=_.useCallback(m=>{n(m),(t===Si.BY_ACTIVITY||t===Si.BY_VALUE)&&s({minPrice:-1,maxPrice:-1,query:"",type:m})},[s,t]),E=_.useCallback(()=>{const m=c>0?c:-1,I=h>0?h:-1;s({minPrice:m,maxPrice:I,type:i,query:o})},[h,c,s,o,i]);return _.useEffect(()=>{if(!e||!e.length)return;const m=e[0];n(m),(t===Si.BY_ACTIVITY||Si.BY_VALUE===t)&&s({minPrice:-1,maxPrice:-1,query:"",type:m})},[s,t,e]),r.jsxs(A,{gap:1,children:[r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx(O,{className:"col-3",children:f("catalog.marketplace.sort_order")}),r.jsx("select",{className:"form-select form-select-sm",value:i,onChange:m=>g(parseInt(m.target.value)),children:e.map(m=>r.jsx("option",{value:m,children:f(`catalog.marketplace.sort.${m}`)},m))})]}),t===Si.ADVANCED&&r.jsxs(r.Fragment,{children:[r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx(O,{className:"col-3",children:f("catalog.marketplace.search_name")}),r.jsx("input",{className:"form-control form-control-sm",type:"text",value:o,onChange:m=>l(m.target.value)})]}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx(O,{className:"col-3",children:f("catalog.marketplace.search_price")}),r.jsxs(M,{fullWidth:!0,gap:1,children:[r.jsx("input",{className:"form-control form-control-sm",type:"number",min:0,value:c,onChange:m=>u(m.target.valueAsNumber)}),r.jsx("input",{className:"form-control form-control-sm",type:"number",min:0,value:h,onChange:m=>d(m.target.valueAsNumber)})]})]}),r.jsx(V,{variant:"secondary",className:"mx-auto",onClick:E,children:f("generic.search")})]})]})},DJ=[1,2],bJ=[3,4,5,6],vJ=[1,2,3,4,5,6],LJ=a=>{const[t,e]=_.useState(Si.BY_ACTIVITY),[s,i]=_.useState(0),[n,o]=_.useState(new Map),[l,c]=_.useState({minPrice:-1,maxPrice:-1,query:"",type:3}),{getCurrencyAmount:u=null}=kc(),{simpleAlert:h=null,showConfirm:d=null}=He(),g=_.useCallback(I=>{c(I),k(new nL(I.minPrice,I.maxPrice,I.query,I.type))},[]),E=_.useMemo(()=>{switch(t){case Si.BY_ACTIVITY:return bJ;case Si.BY_VALUE:return DJ;case Si.ADVANCED:return vJ}return[]},[t]),m=_.useCallback(I=>{if(I.price>u(-1)){h(f("catalog.alert.notenough.credits.description"),Bt.DEFAULT,null,null,f("catalog.alert.notenough.title"));return}const p=I.offerId;d(f("catalog.marketplace.confirm_header"),()=>{k(new kT(p))},null,null,null,f("catalog.marketplace.confirm_title"))},[u,h,d]);return Y(sy,I=>{const p=I.getParser();if(!p)return;const T=new Map;p.offers.forEach(R=>{const S=new o_(R.offerId,R.furniId,R.furniType,R.extraData,R.stuffData,R.price,R.status,R.averagePrice,R.offerCount);S.timeLeftMinutes=R.timeLeftMinutes,T.set(R.offerId,S)}),i(p.totalItemsFound),o(T)}),Y($M,I=>{const p=I.getParser();if(p)switch(p.result){case 1:g(l);break;case 2:o(T=>{const R=new Map(T);return R.delete(p.requestedOfferId),R}),h(f("catalog.marketplace.not_available_header"),Bt.DEFAULT,null,null,f("catalog.marketplace.not_available_title"));break;case 3:o(T=>{const R=new Map(T),S=R.get(p.requestedOfferId);return S&&(S.offerId=p.offerId,S.price=p.newPrice,S.offerCount--,R.set(S.offerId,S)),R.delete(p.requestedOfferId),R}),d(f("catalog.marketplace.confirm_higher_header")+`
`+f("catalog.marketplace.confirm_price",["price"],[p.newPrice.toString()]),()=>{k(new kT(p.offerId))},null,null,null,f("catalog.marketplace.confirm_higher_title"));break;case 4:h(f("catalog.alert.notenough.credits.description"),Bt.DEFAULT,null,null,f("catalog.alert.notenough.title"));break}}),r.jsxs(r.Fragment,{children:[r.jsxs(Da,{children:[r.jsx(V,{active:t===Si.BY_ACTIVITY,onClick:()=>e(Si.BY_ACTIVITY),children:f("catalog.marketplace.search_by_activity")}),r.jsx(V,{active:t===Si.BY_VALUE,onClick:()=>e(Si.BY_VALUE),children:f("catalog.marketplace.search_by_value")}),r.jsx(V,{active:t===Si.ADVANCED,onClick:()=>e(Si.ADVANCED),children:f("catalog.marketplace.search_advanced")})]}),r.jsx(yJ,{sortTypes:E,searchType:t,onSearch:g}),r.jsxs(A,{gap:1,overflow:"hidden",children:[r.jsx(O,{truncate:!0,shrink:!0,fontWeight:"bold",children:f("catalog.marketplace.items_found",["count"],[n.size.toString()])}),r.jsx(A,{className:"nitro-catalog-layout-marketplace-grid",overflow:"auto",children:Array.from(n.values()).map((I,p)=>r.jsx(tj,{offerData:I,type:og,onClick:m},p))})]})]})},PJ=a=>{const{page:t=null}=a,[e,s]=_.useState(-1),[i,n]=_.useState([]),[o,l]=_.useState(-1),[c,u]=_.useState([]),[h,d]=_.useState(-1),[g,E]=_.useState(!1),[m,I]=_.useState("");_.useState(!0);const[p,T]=_.useState(-1),{currentOffer:R=null,setCurrentOffer:S=null,setPurchaseOptions:b=null,catalogOptions:N=null,roomPreviewer:P=null}=Ne(),{petPalettes:B=null}=N,F=_.useMemo(()=>!c.length||h===-1?16777215:c[h][0],[c,h]),w=_.useMemo(()=>e===-1||!i.length||o===-1?"":f(`pet.breed.${e}.${i[o].breedId}`),[e,i,o]),U=_.useMemo(()=>{if(!i.length||o===-1)return"";const z=i[o].paletteId;let et=16777215;if(e<=7){if(h===-1)return"";et=c[h][0]}let rt=et.toString(16).toUpperCase();for(;rt.length<6;)rt="0"+rt;return`${z}
${rt}`},[i,o,e,c,h]),G=_.useMemo(()=>{let z="";switch(p){case 1:z="catalog.alert.petname.long";break;case 2:z="catalog.alert.petname.short";break;case 3:z="catalog.alert.petname.chars";break;case 4:z="catalog.alert.petname.bobba";break}return!z||!z.length?"":f(z)},[p]),K=_.useCallback(()=>{if(p===-1){k(new cU(m,1));return}if(p===0){k(new R_(t.pageId,R.offerId,`${m}
${U}`,1));return}},[t,R,m,U,p]);return Y($D,z=>{const et=z.getParser();T(et.result),et.result===0?K():Fs(new _l(-1))}),_.useEffect(()=>{if(!t||!t.offers.length)return;const z=t.offers[0];S(z),s(e7(z.localizationId)),E(!1)},[t,S]),_.useEffect(()=>{if(!R)return;const z=R.product.productData;if(z){if(B)for(const et of B){if(et.breed!==z.type)continue;const rt=[];for(const J of et.palettes)J.sellable&&rt.push(J);l(rt.length?0:-1),n(rt);return}l(-1),n([]),k(new jb(z.type))}},[R,B]),_.useEffect(()=>{if(e===-1)return;const z=s7(e,i);d(z.length?0:-1),u(z)},[e,i]),_.useEffect(()=>{if(!P||(P.reset(!1),e===-1||!i.length||o===-1))return;let z=`${e} ${i[o].paletteId}`;e<=7&&(z+=` ${F.toString(16)}`),P.addPetIntoRoom(z)},[P,e,i,o,F]),_.useEffect(()=>{T(-1)},[m]),R?r.jsxs(_t,{children:[r.jsx(A,{size:7,overflow:"hidden",children:r.jsxs(Ce,{columnCount:5,children:[!g&&i.length>0&&i.map((z,et)=>r.jsx(ee,{itemActive:o===et,onClick:rt=>l(et),children:r.jsx(Ca,{typeId:e,paletteId:z.paletteId,direction:2,headOnly:!0})},et)),g&&c.length>0&&c.map((z,et)=>r.jsx(ee,{itemHighlight:!0,itemActive:h===et,itemColor:ii.int2rgb(z[0]),className:"clear-bg",onClick:rt=>d(et)},et))]})}),r.jsxs(A,{center:!R,size:5,overflow:"hidden",children:[!R&&r.jsxs(r.Fragment,{children:[!!t.localization.getImage(1)&&r.jsx("img",{alt:"",src:t.localization.getImage(1)}),r.jsx(O,{center:!0,dangerouslySetInnerHTML:{__html:t.localization.getText(0)}})]}),R&&r.jsxs(r.Fragment,{children:[r.jsxs(H,{position:"relative",overflow:"hidden",children:[r.jsx(El,{}),r.jsx(gl,{position:"absolute",className:"bg-muted rounded bottom-1 end-1"}),e>-1&&e<=7&&r.jsx(V,{position:"absolute",className:"bottom-1 start-1",onClick:z=>E(!g),children:r.jsx(GN,{className:"fa-icon"})})]}),r.jsxs(A,{grow:!0,gap:1,children:[r.jsx(O,{truncate:!0,children:w}),r.jsxs(A,{grow:!0,gap:1,children:[r.jsx("input",{type:"text",className:"form-control form-control-sm w-100",placeholder:f("widgets.petpackage.name.title"),value:m,onChange:z=>I(z.target.value)}),p>0&&r.jsx(H,{className:"invalid-feedback d-block m-0",children:G})]}),r.jsx(M,{justifyContent:"end",children:r.jsx(Co,{justifyContent:"end",alignItems:"end"})}),r.jsx(zn,{purchaseCallback:K})]})]})]})]}):null},UJ=a=>{const{offer:t=null,isAvailable:e=!1,daysRequired:s=0,onSelect:i=null}=a,n=_.useCallback(()=>{if(!t||!t.products.length)return"";const l=t.products[0];return ag.getProductImageUrl(l.productType,l.furniClassId,l.extraParam)},[t]),o=_.useCallback(()=>{if(!t||!t.products.length)return"";const l=t.products[0],c=ag.getProductCategory(l.productType,l.furniClassId)===2?"wallItem.name."+l.furniClassId:"roomItem.name."+l.furniClassId;return f(c)},[t]);return _.useCallback(()=>{if(!t||!t.products.length)return"";const l=t.products[0],c=ag.getProductCategory(l.productType,l.furniClassId)===2?"wallItem.desc."+l.furniClassId:"roomItem.desc."+l.furniClassId;return f(c)},[t]),_.useCallback(()=>Math.floor(s/31),[s]),r.jsxs(ee,{center:!1,column:!1,alignItems:"center",className:"p-1",children:[r.jsx(Ga,{imageUrl:n()}),r.jsx(O,{grow:!0,fontWeight:"bold",children:o()}),r.jsx(V,{variant:"secondary",onClick:()=>i(t.localizationId),disabled:!e,children:f("catalog.club_gift.select")})]})},jJ=a=>{const{purse:t=null}=kc(),{catalogOptions:e=null,setCatalogOptions:s=null}=Ne(),{clubGifts:i=null}=e,{showConfirm:n=null}=He(),o=_.useCallback(()=>i?i.giftsAvailable>0?f("catalog.club_gift.available",["amount"],[i.giftsAvailable.toString()]):i.daysUntilNextGift>0?f("catalog.club_gift.days_until_next",["days"],[i.daysUntilNextGift.toString()]):t.isVip?f("catalog.club_gift.not_available"):f("catalog.club_gift.no_club"):"",[i,t]),l=_.useCallback(u=>{n(f("catalog.club_gift.confirm"),()=>{k(new kb(u)),s(h=>(h.clubGifts.giftsAvailable--,{...h}))},null)},[s,n]),c=_.useMemo(()=>i.offers.sort((h,d)=>i.getOfferExtraData(h.offerId).daysRequired-i.getOfferExtraData(d.offerId).daysRequired),[i]);return r.jsxs(r.Fragment,{children:[r.jsx(O,{truncate:!0,shrink:!0,fontWeight:"bold",children:o()}),r.jsx(Ce,{columnCount:1,className:"nitro-catalog-layout-vip-gifts-grid",children:i.offers.length>0&&c.map(u=>r.jsx(UJ,{offer:u,isAvailable:i.getOfferExtraData(u.offerId).isSelectable&&i.giftsAvailable>0,onSelect:l,daysRequired:i.getOfferExtraData(u.offerId).daysRequired},u.offerId))})]})},wJ=(a,t)=>{if(!a)return null;const e={page:a,hideNavigation:t};switch(a.layoutCode){case"frontpage_featured":return null;case"frontpage4":return r.jsx(xJ,{...e});case"pets":return r.jsx(PJ,{...e});case"pets2":return r.jsx(mJ,{...e});case"pets3":return r.jsx(J0,{...e});case"vip_buy":return r.jsx(AJ,{...e});case"guild_frontpage":return r.jsx(gJ,{...e});case"guild_forum":return r.jsx(_J,{...e});case"guild_custom_furni":return r.jsx(dJ,{...e});case"club_gifts":return r.jsx(jJ,{...e});case"marketplace_own_items":return r.jsx(MJ,{...e});case"marketplace":return r.jsx(LJ,{...e});case"single_bundle":return r.jsx(IJ,{...e});case"room_bundle":return r.jsx(pJ,{...e});case"spaces_new":return r.jsx(OJ,{...e});case"trophies":return r.jsx(CJ,{...e});case"info_loyalty":return r.jsx(fJ,{...e});case"badge_display":return r.jsx(aJ,{...e});case"roomads":return r.jsx(EJ,{...e});case"default_3x3_color_grouping":return r.jsx(cJ,{...e});case"soundmachine":return r.jsx(TJ,{...e});case"bots":case"default_3x3":default:return r.jsx(uJ,{...e})}},FJ=a=>{const[t,e]=_.useState(null),[s,i]=_.useState(0),[n,o]=_.useState("0"),{catalogOptions:l=null,setCatalogOptions:c=null}=Ne(),{marketplaceConfiguration:u=null}=l,{showConfirm:h=null}=He(),d=p=>{o(p);const T=parseInt(p);isNaN(T)||T===s||i(parseInt(p))};if(Y(ty,p=>{const T=p.getParser();c(R=>{const S={...R};return S.marketplaceConfiguration=T,S})}),Is(Pf.POST_MARKETPLACE,p=>e(p.item)),_.useEffect(()=>{!t||u||k(new rL)},[t,u]),_.useEffect(()=>{if(t)return()=>i(0)},[t]),!u||!t)return null;const g=t?f(t.isWallItem?"wallItem.name."+t.type:"roomItem.name."+t.type):"",E=t?f(t.isWallItem?"wallItem.desc."+t.type:"roomItem.desc."+t.type):"",m=()=>Math.max(Math.ceil(u.commission*.01*s),1),I=()=>{!t||s<u.minimumPrice||h(f("inventory.marketplace.confirm_offer.info",["furniname","price"],[g,s.toString()]),()=>{k(new oL(s,t.isWallItem?2:1,t.id)),e(null)},()=>{e(null)},null,null,f("inventory.marketplace.confirm_offer.title"))};return r.jsxs(Ot,{className:"nitro-catalog-layout-marketplace-post-offer",children:[r.jsx(St,{headerText:f("inventory.marketplace.make_offer.title"),onCloseClick:p=>e(null)}),r.jsx(pt,{overflow:"hidden",children:r.jsxs(_t,{fullHeight:!0,children:[r.jsx(A,{center:!0,className:"bg-muted rounded p-2",size:4,overflow:"hidden",children:r.jsx(LO,{productType:t.isWallItem?Yt.WALL:Yt.FLOOR,productClassId:t.type,extraData:t.extra.toString()})}),r.jsxs(A,{size:8,justifyContent:"between",overflow:"hidden",children:[r.jsxs(A,{grow:!0,gap:1,children:[r.jsx(O,{fontWeight:"bold",children:g}),r.jsx(O,{truncate:!0,shrink:!0,children:E})]}),r.jsxs(A,{overflow:"auto",children:[r.jsx(O,{italics:!0,children:f("inventory.marketplace.make_offer.expiration_info",["time"],[u.offerTime.toString()])}),r.jsxs("div",{className:"input-group has-validation",children:[r.jsx("input",{className:"form-control form-control-sm",type:"number",min:0,value:n,onChange:p=>d(p.target.value),placeholder:f("inventory.marketplace.make_offer.price_request")}),(s<u.minimumPrice||isNaN(s))&&r.jsx(H,{className:"invalid-feedback d-block",children:f("inventory.marketplace.make_offer.min_price",["minprice"],[u.minimumPrice.toString()])}),s>u.maximumPrice&&!isNaN(s)&&r.jsx(H,{className:"invalid-feedback d-block",children:f("inventory.marketplace.make_offer.max_price",["maxprice"],[u.maximumPrice.toString()])}),!(s<u.minimumPrice||s>u.maximumPrice||isNaN(s))&&r.jsx(H,{className:"invalid-feedback d-block",children:f("inventory.marketplace.make_offer.final_price",["commission","finalprice"],[m().toString(),(s+m()).toString()])})]}),r.jsx(V,{disabled:s<u.minimumPrice||s>u.maximumPrice||isNaN(s),onClick:I,children:f("inventory.marketplace.make_offer.post")})]})]})]})})]})},GJ=a=>{const{isVisible:t=!1,setIsVisible:e=null,rootNode:s=null,currentPage:i=null,navigationHidden:n=!1,setNavigationHidden:o=null,activeNodes:l=[],searchResult:c=null,setSearchResult:u=null,openPageByName:h=null,openPageByOfferId:d=null,activateNode:g=null,getNodeById:E}=Ne();return _.useEffect(()=>{const m={linkReceived:I=>{const p=I.split("/");if(!(p.length<2))switch(p[1]){case"show":e(!0);return;case"hide":e(!1);return;case"toggle":e(T=>!T);return;case"open":if(p.length>2)if(p.length===4)switch(p[2]){case"offerId":d(parseInt(p[3]));return}else h(p[2]);else e(!0);return}},eventUrlPrefix:"catalog/"};return Os(m),()=>Cs(m)},[e,d,h]),r.jsxs(r.Fragment,{children:[t&&r.jsxs(Ot,{uniqueKey:"catalog",className:"nitro-catalog",style:it("catalog.headers")?{width:710}:{},children:[r.jsx(St,{headerText:f("catalog.title"),onCloseClick:m=>e(!1)}),r.jsx(Ro,{children:s&&s.children.length>0&&s.children.map(m=>m.isVisible?r.jsx(Wn,{isActive:m.isActive,onClick:I=>{c&&u(null),g(m)},children:r.jsxs(M,{gap:it("catalog.tab.icons")?1:0,alignItems:"center",children:[it("catalog.tab.icons")&&r.jsx(Y0,{icon:m.iconId}),m.localization]})},m.pageId):null)}),r.jsx(pt,{children:r.jsxs(_t,{children:[!n&&r.jsx(A,{size:3,overflow:"hidden",children:l&&l.length>0&&r.jsx(rJ,{node:l[0]})}),r.jsx(A,{size:n?12:9,overflow:"hidden",children:wJ(i,()=>o(!0))})]})})]}),r.jsx(sJ,{}),r.jsx(FJ,{})]})},BJ=a=>{const[t,e]=_.useState(!1),s=_.useRef(null);_.useEffect(()=>{const n={linkReceived:o=>{const l=o.split("/");if(!(l.length<2))switch(l[1]){case"show":e(!0);return;case"hide":e(!1);return;case"toggle":e(c=>!c);return}},eventUrlPrefix:"change-language/"};return Os(n),()=>Cs(n)},[]);var i=n=>{k(new fb(n))};return t?r.jsxs(Ot,{uniqueKey:"change-language",className:"nitro-change-language",children:[r.jsx(St,{headerText:f("room.language.change"),onCloseClick:n=>e(!1)}),r.jsx(pt,{innerRef:s,overflow:"hidden",gap:2,children:q().languages.map(n=>r.jsx(V,{onClick:()=>i(n.id),gap:1,className:"position-relative",children:n.name}))})]}):null},kJ=a=>{const[t,e]=_.useState(!1),[s,i]=_.useState(""),{chatHistory:n=[]}=dp(),o=_.useRef(null),l=_.useMemo(()=>{if(s.length===0)return n;let c=s.toLowerCase();return n.filter(u=>u.message&&u.message.toLowerCase().includes(c)||u.name&&u.name.toLowerCase().includes(c))},[n,s]);return _.useEffect(()=>{o&&o.current&&t&&(o.current.scrollTop=o.current.scrollHeight)},[t]),_.useEffect(()=>{const c={linkReceived:u=>{const h=u.split("/");if(!(h.length<2))switch(h[1]){case"show":e(!0);return;case"hide":e(!1);return;case"toggle":e(d=>!d);return}},eventUrlPrefix:"chat-history/"};return Os(c),()=>Cs(c)},[]),t?r.jsxs(Ot,{uniqueKey:"chat-history",className:"nitro-chat-history",children:[r.jsx(St,{headerText:f("room.chathistory.button.text"),onCloseClick:c=>e(!1)}),r.jsxs(pt,{innerRef:o,overflow:"hidden",gap:2,children:[r.jsx("input",{type:"text",className:"form-control form-control-sm",placeholder:f("generic.search"),value:s,onChange:c=>i(c.target.value)}),r.jsx(cp,{rows:l,scrollToBottom:!0,rowRender:c=>r.jsxs(M,{alignItems:"center",className:"p-1",gap:2,children:[r.jsx(O,{variant:"muted",children:c.timestamp}),c.type===Bn.TYPE_CHAT&&r.jsxs("div",{className:"bubble-container",style:{position:"relative"},children:[c.style===0&&r.jsx("div",{className:"user-container-bg",style:{backgroundColor:c.color}}),r.jsxs("div",{className:`chat-bubble bubble-${c.style} type-${c.chatType}`,style:{maxWidth:"100%"},children:[r.jsx("div",{className:"user-container",children:c.imageUrl&&c.imageUrl.length>0&&r.jsx("div",{className:"user-image",style:{backgroundImage:`url(${c.imageUrl})`}})}),r.jsxs("div",{className:"chat-content",children:[r.jsx("b",{className:"username mr-1",dangerouslySetInnerHTML:{__html:`${c.name}: `}}),r.jsx("span",{className:"message",dangerouslySetInnerHTML:{__html:`${c.message}`}})]})]})]}),c.type===Bn.TYPE_ROOM_INFO&&r.jsxs(r.Fragment,{children:[r.jsx("i",{className:"icon icon-small-room"}),r.jsx(O,{textBreak:!0,wrap:!0,grow:!0,children:c.name})]})]})})]})]}):null},Li=32,Va=80,wh="x0123456789abcdefghijklmnopq",ac=class ac{};ac.DOOR=0,ac.UP=1,ac.DOWN=2,ac.SET=3,ac.UNSET=4;let Hs=ac;const VJ={x:"101010",0:"0065ff",1:"0091ff",2:"00bcff",3:"00e8ff",4:"00ffea",5:"00ffbf",6:"00ff93",7:"00ff68",8:"00ff3d",9:"19ff00",a:"44ff00",b:"70ff00",c:"9bff00",d:"f2ff00",e:"ffe000",f:"ffb500",g:"ff8900",h:"ff5e00",i:"ff3200",j:"ff0700",k:"ff0023",l:"ff007a",m:"ff00a5",n:"ff00d1",o:"ff00fc",p:"d600ff",q:"aa00ff"};class HJ{constructor(){this._currentAction=Hs.SET,this._currentHeight=wh[1]}get currentAction(){return this._currentAction}set currentAction(t){this._currentAction=t}get currentHeight(){return this._currentHeight}set currentHeight(t){this._currentHeight=t}clear(){this._currentAction=Hs.SET,this._currentHeight=wh[1]}}class z_{constructor(t,e){this._height=t,this._isBlocked=e}get height(){return this._height}set height(t){this._height=t}get isBlocked(){return this._isBlocked}set isBlocked(t){this._isBlocked=t}}const vp=(a,t)=>{let e=a*Li/2-t*Li/2;const s=a*Li/4+t*Li/4;return e=e+1024,[e,s]},WJ=(a,t)=>{const e=a-1024,s=(e/(Li/2)+t/(Li/4))/2,i=(t/(Li/4)-e/(Li/2))/2;return[s,i]},Uf=a=>{switch(a=parseInt(a.toString()),a){case 0:return-2;case 1:return-1;case 3:return 1;default:return 0}},K_=a=>{switch(a){case .25:return 0;case .5:return 1;case 2:return 3;default:return 2}},Dn=class Dn extends ws{constructor(){const t=Li*Va+1500,e=Li*Va/2+200;super({width:t,height:e,backgroundColor:0,antialias:!0,autoDensity:!0,resolution:1,sharedLoader:!0,sharedTicker:!0}),this._tilemap=[],this._doorLocation=new ei(0,0),this._width=0,this._height=0,this._isHolding=!1,this._lastUsedTile=new ei(-1,-1),this._actionSettings=new HJ,this._isSelecting=!1,this._selectionStart=new ei(-1,-1),this._selectionEnd=new ei(-1,-1),this._selectionGraphics=null,this._selectedTiles=new Set}initialize(){if(this._isInitialized)return;const t=Rr().getCollection("floor_editor");t&&(this._assetCollection=t,this._tilemapRenderer=new cw(t.baseTexture),this._selectionGraphics=new lg,this.stage.addChild(this._tilemapRenderer),this.stage.addChild(this._selectionGraphics),this.registerEventListeners(),this._isInitialized=!0)}registerEventListeners(){const t=new ei;this._tilemapRenderer.containsPoint=e=>(this._tilemapRenderer.worldTransform.applyInverse(e,t),this.tileHitDetection(t,!1)),this._tilemapRenderer.interactive=!0,this._tilemapRenderer.buttonMode=!0,this.stage.interactive=!0,this._tilemapRenderer.on("pointerup",e=>{this._isSelecting&&this.finishSelection(),this._isHolding=!1}),this._tilemapRenderer.on("pointerdown",e=>{if(!(e.data.originalEvent instanceof PointerEvent)&&!(e.data.originalEvent instanceof TouchEvent))return;const s=e.data.originalEvent;if(s instanceof MouseEvent&&s.button===2)return;const i=e.data.global;this.startSelection(i)}),this._tilemapRenderer.on("pointermove",e=>{if(this._isSelecting){const s=e.data.global;this.updateSelection(s)}}),this._tilemapRenderer.on("click",e=>{if(!(!(e.data.originalEvent instanceof PointerEvent)||e.data.originalEvent.button===2)&&!this._isSelecting){const i=e.data.global;this.handleSingleClick(i)}}),this.stage.on("pointerdown",e=>{if(!(e.data.originalEvent instanceof PointerEvent)&&!(e.data.originalEvent instanceof TouchEvent))return;const s=e.data.originalEvent;if(s instanceof MouseEvent&&s.button===2)return;const i=e.data.global;this.startSelection(i)}),this.stage.on("click",e=>{if(!this._isSelecting){const s=e.data.global;this.handleSingleClick(s)}}),setTimeout(()=>{const e=this.view;e&&(e.addEventListener("mousedown",s=>{if(s.button===2)return;const i=e.getBoundingClientRect(),n=s.clientX-i.left,o=s.clientY-i.top,l=new ei(n,o);this.startSelection(l)}),e.addEventListener("mouseup",s=>{this._isSelecting&&this.finishSelection(),this._isHolding=!1}),e.addEventListener("mousemove",s=>{if(this._isSelecting){const i=e.getBoundingClientRect(),n=s.clientX-i.left,o=s.clientY-i.top,l=new ei(n,o);this.updateSelection(l)}}),e.addEventListener("mouseleave",s=>{this._isSelecting&&this.finishSelection()}),e.addEventListener("click",s=>{if(s.button===2)return;const i=e.getBoundingClientRect(),n=s.clientX-i.left,o=s.clientY-i.top;if(!this._isSelecting){const l=new ei(n,o);this.handleSingleClick(l)}}))},1e3)}startSelection(t){const e=this.getTileFromScreenPosition(t);e&&(this._isSelecting=!0,this._isHolding=!0,this._selectionStart.set(e.x,e.y),this._selectionEnd.set(e.x,e.y)),this.updateSelectionHighlight()}updateSelection(t){if(!this._isSelecting)return;const e=this.getTileFromScreenPosition(t);e&&(this._selectionEnd.set(e.x,e.y),this.updateSelectionHighlight())}finishSelection(){this._isSelecting&&(this._isSelecting=!1,this._isHolding=!1,this.applyActionToSelection(),this._selectedTiles.clear(),this._selectionStart.set(-1,-1),this._selectionEnd.set(-1,-1),this.renderTiles())}updateSelectionHighlight(){if(this._selectionStart.x===-1||this._selectionEnd.x===-1)return;this._selectedTiles.clear();const t=Math.min(this._selectionStart.x,this._selectionEnd.x),e=Math.max(this._selectionStart.x,this._selectionEnd.x),s=Math.min(this._selectionStart.y,this._selectionEnd.y),i=Math.max(this._selectionStart.y,this._selectionEnd.y);for(let n=s;n<=i;n++)for(let o=t;o<=e;o++)n>=0&&n<this._tilemap.length&&o>=0&&o<this._tilemap[n].length&&this._selectedTiles.add(`${o},${n}`);this.renderTiles()}drawSelectionRect(){const t=Math.min(this._selectionStart.x,this._selectionEnd.x),e=Math.max(this._selectionStart.x,this._selectionEnd.x),s=Math.min(this._selectionStart.y,this._selectionEnd.y),i=Math.max(this._selectionStart.y,this._selectionEnd.y);try{const[n,o]=vp(t,s),[l,c]=vp(e+1,i+1),u=l-n,h=c-o,g=this.view.getBoundingClientRect(),E=g.left+n,m=g.top+o}catch(n){console.error("❌ Errore nel disegnare il rettangolo:",n)}}applyActionToSelection(){if(this._selectionStart.x===-1||this._selectionEnd.x===-1)return;const t=Math.min(this._selectionStart.x,this._selectionEnd.x),e=Math.max(this._selectionStart.x,this._selectionEnd.x),s=Math.min(this._selectionStart.y,this._selectionEnd.y),i=Math.max(this._selectionStart.y,this._selectionEnd.y);for(let n=s;n<=i;n++)for(let o=t;o<=e;o++)n>=0&&n<this._tilemap.length&&o>=0&&o<this._tilemap[n].length&&this.applyActionToTile(o,n);this.renderTiles()}handleSingleClick(t){const e=this.getTileFromScreenPosition(t);e&&(this.applyActionToTile(e.x,e.y),this.renderTiles())}getTileFromScreenPosition(t){const e=new ei;this._tilemapRenderer.worldTransform.applyInverse(t,e);const s=this._tilemapRenderer.pointsBuf;if(!s)return null;const i=kj,n=s.length;for(let o=0;o<n;o+=i){const l=o+i,c=s.slice(o,l),u=Li,h=Li/2,d=Math.floor(e.x),g=Math.floor(e.y),E=c[2],m=c[3],I=E+u/2,p=m+h/2,T=Math.abs(d-I),R=Math.abs(g-p);if(T/(u*.5)+R/(h*.5)<=1){const[b,N]=WJ(E,m);return new ei(b,N)}}return null}applyActionToTile(t,e){const s=this._tilemap[e][t],i=wh.indexOf(s.height);let n=0;switch(this._actionSettings.currentAction){case Hs.DOOR:s.height!=="x"&&(this._doorLocation.x=t,this._doorLocation.y=e);return;case Hs.UP:if(s.height==="x")return;n=i+1;break;case Hs.DOWN:if(s.height==="x"||i<=1)return;n=i-1;break;case Hs.SET:n=wh.indexOf(this._actionSettings.currentHeight);break;case Hs.UNSET:n=0;break}if(n===-1||i===n)return;n>0&&(t+1>this._width&&(this._width=t+1),e+1>this._height&&(this._height=e+1));const o=wh[n];o&&(s.isBlocked||(this._tilemap[e][t].height=o))}tileHitDetection(t,e,s=!1){return this.getTileFromScreenPosition(t)!==null}onClick(t,e){this.applyActionToTile(t,e)}renderTiles(){let t=this.view.width,e=this.view.height,s=Li*Va,i=Li*Va/2+100,n=(t-s)/2,o=(e-i)/2;this.stage.position.set(n,o),this._tilemapRenderer.clear(),this._selectionGraphics.clear();for(let c=0;c<this._tilemap.length;c++)for(let u=0;u<this._tilemap[c].length;u++){const h=this._tilemap[c][u];let d=h.height;const g=this._selectedTiles.has(`${u},${c}`);this._doorLocation.x===u&&this._doorLocation.y===c&&(d=Dn.TILE_DOOR),h.isBlocked&&(d=Dn.TILE_BLOCKED);const[E,m]=vp(u,c),I=this._assetCollection.getTexture(`floor_editor_${d}`);if(this._tilemapRenderer.tile(I,E,m),g&&this._isSelecting)try{if(this._actionSettings.currentAction===Hs.UNSET){var l=this._assetCollection.getTexture("floor_editor_j");this._tilemapRenderer.tile(l,E,m)}else{const p=this.createColoredTexture(8900331,.4);this._tilemapRenderer.tile(p,E,m)}}catch(p){console.warn("Non riesco a creare overlay colorato:",p)}}}createColoredTexture(t,e){try{const s=new globalThis.PIXI.Graphics;return s.beginFill(t,e),s.drawRect(0,0,Li,Li/2),s.endFill(),s.generateCanvasTexture()}catch{return this._assetCollection.getTexture("floor_editor_0")}}setTilemap(t,e){this._tilemap=[];const s=t.split("\r");let i=0,n=s.length;for(let o=0;o<n;o++){const l=s[o];if(l.length===0){s.splice(o,1),n=s.length,o--;continue}l.length>i&&(i=l.length)}for(let o=0;o<n;o++){this._tilemap[o]=[];const l=s[o];for(let c=0;c<i;c++){const u=e[o]&&e[o][c]||!1,h=l[c];h!=="x"&&h!=="X"&&h?this._tilemap[o][c]=new z_(h,u):this._tilemap[o][c]=new z_("x",u)}for(let c=i;c<Va;c++)this.tilemap[o][c]=new z_("x",!1)}for(let o=n;o<Va;o++){this.tilemap[o]||(this.tilemap[o]=[]);for(let l=0;l<Va;l++)this.tilemap[o][l]=new z_("x",!1)}this._width=i,this._height=n}getCurrentTilemapString(){if(this._tilemap[this._height-1][this._width-1].height==="x"){this._width=-1,this._height=-1;for(let s=Va-1;s>=0;s--)if(this._tilemap[s])for(let i=Va-1;i>=0;i--){if(!this._tilemap[s][i])continue;this._tilemap[s][i].height!=="x"&&(i+1>this._width&&(this._width=i+1),s+1>this._height&&(this._height=s+1))}}const e=[];for(let s=0;s<this._height;s++){const i=[];for(let n=0;n<this._width;n++){const o=this._tilemap[s][n];i[n]=o.height}e[s]=i.join("")}return e.join("\r")}clear(){this._tilemapRenderer.interactive=!1,this._tilemap=[],this._doorLocation.set(-1,-1),this._width=0,this._height=0,this._isHolding=!1,this._lastUsedTile.set(-1,-1),this._actionSettings.clear(),this._tilemapRenderer.clear(),this._selectionGraphics&&this._selectionGraphics.clear(),this._selectedTiles.clear(),this._isSelecting=!1,this._selectionStart.set(-1,-1),this._selectionEnd.set(-1,-1)}get tilemapRenderer(){return this._tilemapRenderer}get tilemap(){return this._tilemap}get doorLocation(){return this._doorLocation}set doorLocation(t){this._doorLocation=t}get actionSettings(){return this._actionSettings}static get instance(){return Dn._INSTANCE||(Dn._INSTANCE=new Dn),Dn._INSTANCE}};Dn._INSTANCE=null,Dn.TILE_BLOCKED="r_blocked",Dn.TILE_DOOR="r_door";let gi=Dn;const ej=_.createContext({originalFloorplanSettings:null,setOriginalFloorplanSettings:null,visualizationSettings:null,setVisualizationSettings:null}),YJ=a=>r.jsx(ej.Provider,{...a}),VO=()=>_.useContext(ej),zJ=a=>{const{gap:t=1,children:e=null,...s}=a,[i,n]=_.useState(!1),[o,l]=_.useState(!1),{originalFloorplanSettings:c=null,setOriginalFloorplanSettings:u=null,setVisualizationSettings:h=null}=VO(),d=_.useRef(null);Y(CD,E=>{const m=E.getParser();u(I=>{const p={...I};return p.reservedTiles=m.blockedTilesMap,gi.instance.setTilemap(p.tilemap,p.reservedTiles),p}),n(!0),d.current.scrollTo(gi.instance.view.width/3,0)}),Y(qg,E=>{const m=E.getParser();u(I=>{const p={...I};return p.entryPoint=[m.x,m.y],p.entryPointDir=m.direction,p}),h(I=>{const p={...I};return p.entryPointDir=m.direction,p}),gi.instance.doorLocation=new ei(m.x,m.y),l(!0)});const g=E=>{const m=d.current;if(m)switch(E){case"up":m.scrollBy({top:-10});break;case"down":m.scrollBy({top:10});break;case"left":m.scrollBy({left:-10});break;case"right":m.scrollBy({left:10});break}};return _.useEffect(()=>()=>{gi.instance.clear(),h(E=>({wallHeight:c.wallHeight,thicknessWall:c.thicknessWall,thicknessFloor:c.thicknessFloor,entryPointDir:E.entryPointDir}))},[c.thicknessFloor,c.thicknessWall,c.wallHeight,h]),_.useEffect(()=>{!o||!i||gi.instance.renderTiles()},[o,i]),_.useEffect(()=>{k(new UP),k(new PP),gi.instance.tilemapRenderer.interactive=!0,d.current&&d.current.appendChild(gi.instance.renderer.view)},[]),r.jsxs(A,{gap:t,...s,children:[r.jsxs(_t,{overflow:"hidden",gap:1,children:[r.jsx(A,{center:!0,size:1,children:r.jsx(V,{className:"d-md-none",onClick:E=>g("left"),children:r.jsx(BN,{className:"fa-icon"})})}),r.jsxs(A,{overflow:"hidden",size:10,gap:1,children:[r.jsx(M,{justifyContent:"center",className:"d-md-none",children:r.jsx(V,{shrink:!0,onClick:E=>g("up"),children:r.jsx(Vj,{className:"fa-icon"})})}),r.jsx(H,{overflow:"auto",innerRef:d}),r.jsx(M,{justifyContent:"center",className:"d-md-none",children:r.jsx(V,{shrink:!0,onClick:E=>g("down"),children:r.jsx(Hj,{className:"fa-icon"})})})]}),r.jsx(A,{center:!0,size:1,children:r.jsx(V,{className:"d-md-none",onClick:E=>g("right"),children:r.jsx(kN,{className:"fa-icon"})})})]}),e]})},kA=a=>a.replace(/\r\n|\r|\n/g,`
`).toLowerCase(),KJ=a=>{const{onCloseClick:t=null}=a,[e,s]=_.useState(""),{originalFloorplanSettings:i=null}=VO(),n=()=>{k(new uO(e.split(`
`).join("\r"),i.entryPoint[0],i.entryPoint[1],i.entryPointDir,Uf(i.thicknessWall),Uf(i.thicknessFloor),i.wallHeight-1))};return H0(()=>{s(kA(i.tilemap))}),r.jsxs(Ot,{className:"floorplan-import-export",children:[r.jsx(St,{headerText:f("floor.plan.editor.import.export"),onCloseClick:t}),r.jsxs(pt,{children:[r.jsx("textarea",{className:"h-100",value:e,onChange:o=>s(o.target.value)}),r.jsxs(M,{justifyContent:"between",children:[r.jsx(V,{onClick:o=>s(kA(i.tilemap)),children:f("floor.plan.editor.revert.to.last.received.map")}),r.jsx(V,{onClick:n,children:f("floor.plan.editor.save")})]})]})]})},VA=0,X_=16,XJ=0,qJ=26,QJ=a=>{const{visualizationSettings:t=null,setVisualizationSettings:e=null}=VO(),[s,i]=_.useState(Hs.SET),[n,o]=_.useState(0),l=I=>{i(I),gi.instance.actionSettings.currentAction=I},c=()=>{e(I=>{const p={...I};return p.entryPointDir<7?++p.entryPointDir:p.entryPointDir=0,p})},u=I=>{(isNaN(I)||I<=0)&&(I=0),I>26&&(I=26),o(I),gi.instance.actionSettings.currentHeight=I.toString(36)},h=I=>{e(p=>{const T={...p};return T.thicknessFloor=I,T})},d=I=>{e(p=>{const T={...p};return T.thicknessWall=I,T})},g=I=>{(isNaN(I)||I<=0)&&(I=VA),I>X_&&(I=X_),e(p=>{const T={...p};return T.wallHeight=I,T})},E=()=>{let I=t.wallHeight+1;I>X_&&(I=X_),g(I)},m=()=>{let I=t.wallHeight-1;I<=0&&(I=VA),g(I)};return r.jsxs(A,{children:[r.jsxs(M,{gap:1,children:[r.jsxs(A,{size:5,gap:1,children:[r.jsx(O,{bold:!0,children:f("floor.plan.editor.draw.mode")}),r.jsxs(M,{gap:3,children:[r.jsxs(M,{gap:1,children:[r.jsx(ee,{itemActive:s===Hs.SET,onClick:I=>l(Hs.SET),children:r.jsx("i",{className:"icon icon-set-tile"})}),r.jsx(ee,{itemActive:s===Hs.UNSET,onClick:I=>l(Hs.UNSET),children:r.jsx("i",{className:"icon icon-unset-tile"})})]}),r.jsxs(M,{gap:1,children:[r.jsx(ee,{itemActive:s===Hs.UP,onClick:I=>l(Hs.UP),children:r.jsx("i",{className:"icon icon-increase-height"})}),r.jsx(ee,{itemActive:s===Hs.DOWN,onClick:I=>l(Hs.DOWN),children:r.jsx("i",{className:"icon icon-decrease-height"})})]}),r.jsx(ee,{itemActive:s===Hs.DOOR,onClick:I=>l(Hs.DOOR),children:r.jsx("i",{className:"icon icon-set-door"})})]})]}),r.jsxs(A,{alignItems:"center",size:4,children:[r.jsx(O,{bold:!0,children:f("floor.plan.editor.enter.direction")}),r.jsx("i",{className:`icon icon-door-direction-${t.entryPointDir} cursor-pointer`,onClick:c})]}),r.jsxs(A,{size:3,children:[r.jsx(O,{bold:!0,children:f("floor.editor.wall.height")}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx(wN,{className:"cursor-pointer fa-icon",onClick:m}),r.jsx("input",{type:"number",className:"form-control form-control-sm quantity-input",value:t.wallHeight,onChange:I=>g(I.target.valueAsNumber)}),r.jsx(FN,{className:"cursor-pointer fa-icon",onClick:E})]})]})]}),r.jsxs(M,{gap:1,children:[r.jsxs(A,{size:6,children:[r.jsxs(O,{bold:!0,children:[f("floor.plan.editor.tile.height"),": ",n]}),r.jsx(Js,{className:"nitro-slider",min:XJ,max:qJ,step:1,value:n,onChange:I=>u(I),renderThumb:({style:I,...p},T)=>r.jsx("div",{style:{backgroundColor:`#${VJ[T.valueNow.toString(33)]}`,...I},...p,children:T.valueNow})})]}),r.jsxs(A,{size:6,children:[r.jsx(O,{bold:!0,children:f("floor.plan.editor.room.options")}),r.jsxs(M,{className:"align-items-center",children:[r.jsxs("select",{className:"form-control form-control-sm",value:t.thicknessWall,onChange:I=>d(parseInt(I.target.value)),children:[r.jsx("option",{value:0,children:f("navigator.roomsettings.wall_thickness.thinnest")}),r.jsx("option",{value:1,children:f("navigator.roomsettings.wall_thickness.thin")}),r.jsx("option",{value:2,children:f("navigator.roomsettings.wall_thickness.normal")}),r.jsx("option",{value:3,children:f("navigator.roomsettings.wall_thickness.thick")})]}),r.jsxs("select",{className:"form-control form-control-sm",value:t.thicknessFloor,onChange:I=>h(parseInt(I.target.value)),children:[r.jsx("option",{value:0,children:f("navigator.roomsettings.floor_thickness.thinnest")}),r.jsx("option",{value:1,children:f("navigator.roomsettings.floor_thickness.thin")}),r.jsx("option",{value:2,children:f("navigator.roomsettings.floor_thickness.normal")}),r.jsx("option",{value:3,children:f("navigator.roomsettings.floor_thickness.thick")})]})]})]})]})]})},JJ=a=>{const[t,e]=_.useState(!1),[s,i]=_.useState(!1),[n,o]=_.useState({tilemap:"",reservedTiles:[],entryPoint:[0,0],entryPointDir:2,wallHeight:-1,thicknessWall:1,thicknessFloor:1}),[l,c]=_.useState({entryPointDir:2,wallHeight:-1,thicknessWall:1,thicknessFloor:1}),u=()=>{k(new uO(gi.instance.getCurrentTilemapString(),gi.instance.doorLocation.x,gi.instance.doorLocation.y,l.entryPointDir,Uf(l.thicknessWall),Uf(l.thicknessFloor),l.wallHeight-1))},h=()=>{c({wallHeight:n.wallHeight,thicknessWall:n.thicknessWall,thicknessFloor:n.thicknessFloor,entryPointDir:n.entryPointDir}),gi.instance.doorLocation=new ei(n.entryPoint[0],n.entryPoint[1]),gi.instance.setTilemap(n.tilemap,n.reservedTiles),gi.instance.renderTiles()};return ne(te.DISPOSED,d=>e(!1)),Y(Xg,d=>{const g=d.getParser();o(E=>{const m={...E};return m.tilemap=g.model,m.wallHeight=g.wallHeight+1,m}),c(E=>{const m={...E};return m.wallHeight=g.wallHeight+1,m})}),Y(Qg,d=>{const g=d.getParser();o(E=>{const m={...E};return m.thicknessFloor=K_(g.thicknessFloor),m.thicknessWall=K_(g.thicknessWall),m}),c(E=>{const m={...E};return m.thicknessFloor=K_(g.thicknessFloor),m.thicknessWall=K_(g.thicknessWall),m})}),_.useEffect(()=>{const d={linkReceived:g=>{const E=g.split("/");if(!(E.length<2))switch(E[1]){case"show":e(!0);return;case"hide":e(!1);return;case"toggle":e(m=>!m);return}},eventUrlPrefix:"floor-editor/"};return Os(d),()=>Cs(d)},[]),_.useEffect(()=>{gi.instance.initialize()},[]),r.jsxs(YJ,{value:{originalFloorplanSettings:n,setOriginalFloorplanSettings:o,visualizationSettings:l,setVisualizationSettings:c},children:[t&&r.jsxs(Ot,{uniqueKey:"floorpan-editor",className:"nitro-floorplan-editor",children:[r.jsx(St,{headerText:f("floor.plan.editor.title"),onCloseClick:()=>e(!1)}),r.jsxs(pt,{overflow:"hidden",children:[r.jsx(QJ,{}),r.jsx(zJ,{overflow:"hidden"}),r.jsxs(M,{justifyContent:"between",children:[r.jsx(V,{onClick:h,children:f("floor.plan.editor.reload")}),r.jsxs(Da,{children:[r.jsx(V,{disabled:!0,children:f("floor.plan.editor.preview")}),r.jsx(V,{onClick:d=>i(!0),children:f("floor.plan.editor.import.export")}),r.jsx(V,{onClick:u,children:f("floor.plan.editor.save")})]})]})]})]}),s&&r.jsx(KJ,{onCloseClick:()=>i(!1)})]})},$J=a=>{const{friend:t=null}=a,[e,s]=_.useState(!1),{followFriend:i=null}=ar(),n=_.useRef();return _.useEffect(()=>{const o=l=>{const c=n.current;c&&l.target!==c&&!c.contains(l.target)&&s(!1)};return document.addEventListener(at.MOUSE_CLICK,o),()=>document.removeEventListener(at.MOUSE_CLICK,o)},[]),t?r.jsxs("div",{ref:n,className:"btn btn-success friend-bar-item "+(e?"friend-bar-item-active":""),onClick:o=>s(l=>!l),children:[r.jsxs("div",{className:`friend-bar-item-head position-absolute ${t.id>0?"avatar":"group"}`,children:[t.id>0&&r.jsx(ls,{headOnly:!0,figure:t.figure,direction:2}),t.id<=0&&r.jsx(Ge,{isGroup:!0,badgeCode:t.figure})]}),r.jsx("div",{className:"text-truncate",children:t.name}),e&&r.jsxs("div",{className:"d-flex justify-content-between",children:[r.jsx(H,{className:"nitro-friends-spritesheet icon-friendbar-chat cursor-pointer",onClick:o=>ap(t.id)}),t.followingAllowed&&r.jsx(H,{className:"nitro-friends-spritesheet icon-friendbar-visit cursor-pointer",onClick:o=>i(t)}),r.jsx(H,{className:"nitro-friends-spritesheet icon-profile cursor-pointer",onClick:o=>rr(t.id)})]})]}):r.jsxs("div",{ref:n,className:"btn btn-primary friend-bar-item friend-bar-search",children:[r.jsx("div",{className:"friend-bar-item-head position-absolute"}),r.jsx("div",{className:"text-truncate",children:f("friend.bar.find.title")})]})},Lp=3,ZJ=a=>{const{onlineFriends:t=null}=a,[e,s]=_.useState(0),i=_.useRef();return r.jsxs(M,{innerRef:i,alignItems:"center",className:"friend-bar",children:[r.jsx(V,{variant:"black",className:"friend-bar-button",disabled:e<=0,onClick:n=>s(e-1),children:r.jsx(pr,{className:"fa-icon"})}),Array.from(Array(Lp),(n,o)=>r.jsx($J,{friend:t[e+o]||null},o)),r.jsx(V,{variant:"black",className:"friend-bar-button",disabled:!(t.length>Lp&&e+Lp<=t.length-1),onClick:n=>s(e+1),children:r.jsx(Ir,{className:"fa-icon"})})]})},t$=a=>{const{friend:t=null,selected:e=!1,selectFriend:s=null}=a,[i,n]=_.useState(!1),{followFriend:o=null,updateRelationship:l=null}=ar(),c=E=>{E.stopPropagation(),o(t)},u=E=>{E.stopPropagation(),ap(t.id)},h=E=>{E.stopPropagation(),n(!0)},d=(E,m)=>{E.stopPropagation(),l(t,m),n(!1)},g=()=>{if(!t)return"none";switch(t.relationshipStatus){case er.RELATIONSHIP_HEART:return"heart";case er.RELATIONSHIP_SMILE:return"smile";case er.RELATIONSHIP_BOBBA:return"bobba";default:return"none"}};return t?r.jsxs(vf,{justifyContent:"between",className:`px-2 py-1 ${e&&"bg-primary text-white"}`,onClick:E=>s(t.id),children:[r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx(H,{onClick:E=>E.stopPropagation(),children:r.jsx(Cr,{userId:t.id})}),r.jsx("div",{children:t.name})]}),r.jsxs(M,{alignItems:"center",gap:1,children:[!i&&r.jsxs(r.Fragment,{children:[t.followingAllowed&&r.jsx(H,{pointer:!0,onClick:c,className:"nitro-friends-spritesheet icon-follow",title:f("friendlist.tip.follow")}),t.online&&r.jsx(H,{pointer:!0,className:"nitro-friends-spritesheet icon-chat",onClick:u,title:f("friendlist.tip.im")}),t.id>0&&r.jsx(H,{className:`nitro-friends-spritesheet icon-${g()} cursor-pointer`,onClick:h,title:f("infostand.link.relationship")})]}),i&&r.jsxs(r.Fragment,{children:[r.jsx(H,{pointer:!0,className:"nitro-friends-spritesheet icon-heart",onClick:E=>d(E,er.RELATIONSHIP_HEART)}),r.jsx(H,{pointer:!0,className:"nitro-friends-spritesheet icon-smile",onClick:E=>d(E,er.RELATIONSHIP_SMILE)}),r.jsx(H,{pointer:!0,className:"nitro-friends-spritesheet icon-bobba",onClick:E=>d(E,er.RELATIONSHIP_BOBBA)}),r.jsx(H,{pointer:!0,className:"nitro-friends-spritesheet icon-none",onClick:E=>d(E,er.RELATIONSHIP_NONE)})]})]})]}):null},HA=a=>{const{list:t=null,selectedFriendsIds:e=null,selectFriend:s=null}=a;return!t||!t.length?null:r.jsx(r.Fragment,{children:t.map((i,n)=>r.jsx(t$,{friend:i,selected:e&&e.indexOf(i.id)>=0,selectFriend:s},n))})},e$=a=>{const{request:t=null}=a,{requestResponse:e=null}=ar();return t?r.jsxs(vf,{justifyContent:"between",className:"px-2 py-1",children:[r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx(Cr,{userId:t.id}),r.jsx("div",{children:t.name})]}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx(H,{className:"nitro-friends-spritesheet icon-accept cursor-pointer",onClick:s=>e(t.id,!0)}),r.jsx(H,{className:"nitro-friends-spritesheet icon-deny cursor-pointer",onClick:s=>e(t.id,!1)})]})]}):null},s$=a=>{const{children:t=null,...e}=a,{requests:s=[],requestResponse:i=null}=ar();return s.length?r.jsxs(Lf,{...e,children:[r.jsxs(A,{fullHeight:!0,justifyContent:"between",gap:1,children:[r.jsx(A,{gap:0,children:s.map((n,o)=>r.jsx(e$,{request:n},o))}),r.jsx(M,{justifyContent:"center",className:"px-2 py-1",children:r.jsx(V,{onClick:n=>i(-1,!1),children:f("friendlist.requests.dismissall")})})]}),t]}):null},i$=a=>{const{selectedFriendsIds:t=null,removeFriendsText:e=null,removeSelectedFriends:s=null,onCloseClick:i=null}=a;return r.jsxs(Ot,{className:"nitro-friends-remove-confirmation",children:[r.jsx(St,{headerText:f("friendlist.removefriendconfirm.title"),onCloseClick:i}),r.jsxs(pt,{className:"text-black",children:[r.jsx("div",{children:e}),r.jsxs(M,{gap:1,children:[r.jsx(V,{fullWidth:!0,variant:"danger",disabled:t.length===0,onClick:s,children:f("generic.ok")}),r.jsx(V,{fullWidth:!0,onClick:i,children:f("generic.cancel")})]})]})]})},r$=a=>{const{selectedFriendsIds:t=null,onCloseClick:e=null,sendRoomInvite:s=null}=a,[i,n]=_.useState("");return r.jsxs(Ot,{className:"nitro-friends-room-invite",uniqueKey:"nitro-friends-room-invite",children:[r.jsx(St,{headerText:f("friendlist.invite.title"),onCloseClick:e}),r.jsxs(pt,{className:"text-black",children:[f("friendlist.invite.summary",["count"],[t.length.toString()]),r.jsx("textarea",{className:"form-control",value:i,maxLength:255,onChange:o=>n(o.target.value)}),r.jsx(O,{center:!0,className:"bg-muted rounded p-1",children:f("friendlist.invite.note")}),r.jsxs(M,{gap:1,children:[r.jsx(V,{fullWidth:!0,variant:"success",disabled:i.length===0||t.length===0,onClick:()=>s(i),children:f("friendlist.invite.send")}),r.jsx(V,{fullWidth:!0,onClick:e,children:f("generic.cancel")})]})]})]})},n$=a=>{const{...t}=a,[e,s]=_.useState(""),[i,n]=_.useState(null),[o,l]=_.useState(null),{canRequestFriend:c=null,requestFriend:u=null}=ar();return Y(sM,h=>{const d=h.getParser();n(d.friends),l(d.others)}),_.useEffect(()=>{if(!e||!e.length)return;const h=setTimeout(()=>{!e||!e.length||k(new Qb(e))},500);return()=>clearTimeout(h)},[e]),r.jsxs(Lf,{...t,children:[r.jsx("input",{type:"text",className:"search-input form-control form-control-sm w-100 rounded-0",placeholder:f("generic.search"),value:e,maxLength:50,onChange:h=>s(h.target.value)}),r.jsxs(A,{children:[i&&r.jsxs(r.Fragment,{children:[i.length===0&&r.jsx(O,{bold:!0,small:!0,className:"px-2 py-1",children:f("friendlist.search.nofriendsfound")}),i.length>0&&r.jsxs(A,{gap:0,children:[r.jsx(O,{bold:!0,small:!0,className:"px-2 py-1",children:f("friendlist.search.friendscaption",["cnt"],[i.length.toString()])}),r.jsx("hr",{className:"mx-2 mt-0 mb-1 text-black"}),r.jsx(A,{gap:0,children:i.map(h=>r.jsxs(vf,{justifyContent:"between",className:"px-2 py-1",children:[r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx(Cr,{userId:h.avatarId}),r.jsx("div",{children:h.avatarName})]}),r.jsx(M,{alignItems:"center",gap:1,children:h.isAvatarOnline&&r.jsx(H,{className:"nitro-friends-spritesheet icon-chat cursor-pointer",onClick:d=>ap(h.avatarId),title:f("friendlist.tip.im")})})]},h.avatarId))})]})]}),o&&r.jsxs(r.Fragment,{children:[o.length===0&&r.jsx(O,{bold:!0,small:!0,className:"px-2 py-1",children:f("friendlist.search.noothersfound")}),o.length>0&&r.jsxs(A,{gap:0,children:[r.jsx(O,{bold:!0,small:!0,className:"px-2 py-1",children:f("friendlist.search.otherscaption",["cnt"],[o.length.toString()])}),r.jsx("hr",{className:"mx-2 mt-0 mb-1 text-black"}),r.jsx(A,{gap:0,children:o.map(h=>r.jsxs(vf,{justifyContent:"between",className:"px-2 py-1",children:[r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx(Cr,{userId:h.avatarId}),r.jsx("div",{children:h.avatarName})]}),r.jsx(M,{alignItems:"center",gap:1,children:c(h.avatarId)&&r.jsx(H,{className:"nitro-friends-spritesheet icon-add cursor-pointer",onClick:d=>u(h.avatarId,h.avatarName),title:f("friendlist.tip.addfriend")})})]},h.avatarId))})]})]})]})]})},a$=a=>{const[t,e]=_.useState(!1),[s,i]=_.useState([]),[n,o]=_.useState(!1),[l,c]=_.useState(!1),{onlineFriends:u=[],offlineFriends:h=[],requests:d=[],requestFriend:g=null}=ar(),E=_.useMemo(()=>{if(!s||!s.length)return"";const T=[];for(const R of s){let S=u.find(b=>b.id===R);S||(S=h.find(b=>b.id===R)),S&&T.push(S.name)}return f("friendlist.removefriendconfirm.userlist",["user_names"],[T.join(", ")])},[h,u,s]),m=_.useCallback(T=>{T<0||i(R=>{const S=[...R],b=S.indexOf(T);return b>-1?S.splice(b,1):S.push(T),S})},[i]),I=T=>{!s.length||!T||!T.length||T.length>255||(k(new tv(T,s)),o(!1))},p=()=>{s.length!==0&&(i(T=>(k(new $b(...T)),[])),c(!1))};return _.useEffect(()=>{const T={linkReceived:R=>{const S=R.split("/");if(!(S.length<2))switch(S[1]){case"show":e(!0);return;case"hide":e(!1);return;case"toggle":e(b=>!b);return;case"request":if(S.length<4)return;g(parseInt(S[2]),S[3])}},eventUrlPrefix:"friends/"};return Os(T),()=>Cs(T)},[g]),t?r.jsxs(r.Fragment,{children:[r.jsxs(Ot,{className:"nitro-friends",uniqueKey:"nitro-friends",children:[r.jsx(St,{headerText:f("friendlist.friends"),onCloseClick:T=>e(!1)}),r.jsxs(pt,{overflow:"hidden",gap:1,className:"text-black p-0",children:[r.jsxs(f8,{fullHeight:!0,overflow:"hidden",children:[r.jsx(Lf,{headerText:f("friendlist.friends")+` (${u.length})`,isExpanded:!0,children:r.jsx(HA,{list:u,selectedFriendsIds:s,selectFriend:m})}),r.jsx(Lf,{headerText:f("friendlist.friends.offlinecaption")+` (${h.length})`,children:r.jsx(HA,{list:h,selectedFriendsIds:s,selectFriend:m})}),r.jsx(s$,{headerText:f("friendlist.tab.friendrequests")+` (${d.length})`,isExpanded:!0}),r.jsx(n$,{headerText:f("people.search.title")})]}),s&&s.length>0&&r.jsxs(M,{gap:1,className:"p-1",children:[r.jsx(V,{fullWidth:!0,onClick:()=>o(!0),children:f("friendlist.tip.invite")}),r.jsx(V,{fullWidth:!0,variant:"danger",onClick:T=>c(!0),children:f("generic.delete")})]})]})]}),n&&r.jsx(r$,{selectedFriendsIds:s,onCloseClick:()=>o(!1),sendRoomInvite:I}),l&&r.jsx(i$,{selectedFriendsIds:s,removeFriendsText:E,onCloseClick:()=>c(!1),removeSelectedFriends:p})]}):null},o$=a=>{const{thread:t=null,group:e=null}=a,s=_.useMemo(()=>e.type===pc.GROUP_CHAT&&p0(e.chats[0].extraData),[e]),i=_.useMemo(()=>!t||!e?!1:!!(e.type===pc.PRIVATE_CHAT&&e.userId===q().userId||s&&e.chats.length&&s.userId===q().userId),[t,e,s]);return!t||!e?null:e.userId?r.jsxs(M,{fullWidth:!0,justifyContent:i?"end":"start",gap:2,children:[r.jsxs(H,{shrink:!0,className:"message-avatar",children:[e.type===pc.PRIVATE_CHAT&&!i&&r.jsx(ls,{figure:t.participant.figure,direction:2}),s&&!i&&r.jsx(ls,{figure:s.figure,direction:2})]}),r.jsxs(H,{className:"bg-light text-black border-radius mb-2 rounded py-1 px-2 messages-group-"+(i?"right":"left"),children:[r.jsxs(H,{className:"fw-bold",children:[i&&q().userName,!i&&(s?s.username:t.participant.name)]}),e.chats.map((n,o)=>r.jsx(H,{className:"text-break",children:n.message},o))]}),i&&r.jsx(H,{shrink:!0,className:"message-avatar",children:r.jsx(ls,{figure:q().figure,direction:4})})]}):r.jsx(r.Fragment,{children:e.chats.map((n,o)=>r.jsx(M,{fullWidth:!0,gap:2,justifyContent:"start",children:r.jsxs(H,{className:"w-100 text-break",children:[n.type===mo.SECURITY_NOTIFICATION&&r.jsxs(M,{gap:2,alignItems:"center",className:"bg-light rounded mb-2 px-2 py-1 small text-muted",children:[r.jsx(H,{className:"nitro-friends-spritesheet icon-warning flex-shrink-0"}),r.jsx(H,{children:n.message})]}),n.type===mo.ROOM_INVITE&&r.jsxs(M,{gap:2,alignItems:"center",className:"bg-light rounded mb-2 px-2 py-1 small text-black",children:[r.jsx(H,{className:"messenger-notification-icon flex-shrink-0"}),r.jsxs(H,{children:[f("messenger.invitation")+" ",n.message]})]})]})},o))})},l$=a=>{const{thread:t=null}=a;return t.setRead(),r.jsx(r.Fragment,{children:t.groups.length>0&&t.groups.map((e,s)=>r.jsx(o$,{thread:t,group:e},s))})},c$=a=>{const[t,e]=_.useState(!1),[s,i]=_.useState(-1),[n,o]=_.useState(""),{visibleThreads:l=[],activeThread:c=null,getMessageThread:u=null,sendMessage:h=null,setActiveThreadId:d=null,closeThread:g=null}=P0(),{report:E=null}=En(),m=_.useRef(),I=()=>c&&c.participant&&k(new ZE(c.participant.id)),p=()=>c&&c.participant&&rr(c.participant.id),T=()=>{!c||!n.length||(h(c,q().userId,n),o(""))},R=S=>{S.key==="Enter"&&T()};return _.useEffect(()=>{const S={linkReceived:b=>{const N=b.split("/");if(N.length===2){if(N[1]==="open"){e(!0);return}if(N[1]==="toggle"){e(B=>!B);return}const P=u(parseInt(N[1]));if(!P)return;d(P.threadId),e(!0)}},eventUrlPrefix:"friends-messenger/"};return Os(S),()=>Cs(S)},[u,d]),_.useEffect(()=>{!t||!c||(m.current.scrollTop=m.current.scrollHeight)},[t,c]),_.useEffect(()=>{if(t&&!c){s>0?d(s):l.length>0&&d(l[0].threadId);return}!t&&c&&(i(c.threadId),d(-1))},[t,c,s,l,d]),t?r.jsxs(Ot,{className:"nitro-friends-messenger",uniqueKey:"nitro-friends-messenger",children:[r.jsx(St,{headerText:f("messenger.window.title",["OPEN_CHAT_COUNT"],[l.length.toString()]),onCloseClick:S=>e(!1)}),r.jsx(pt,{children:r.jsxs(_t,{overflow:"hidden",children:[r.jsxs(A,{size:4,overflow:"hidden",children:[r.jsx(O,{bold:!0,children:f("toolbar.icon.label.messenger")}),r.jsx(A,{fit:!0,overflow:"auto",children:r.jsx(A,{children:l&&l.length>0&&l.map(S=>r.jsxs(ee,{itemActive:c===S,onClick:b=>d(S.threadId),children:[S.unread&&r.jsx(cl,{count:S.unreadCount}),r.jsxs(M,{fullWidth:!0,alignItems:"center",gap:1,children:[r.jsxs(M,{alignItems:"center",className:"friend-head px-1",children:[S.participant.id>0&&r.jsx(ls,{figure:S.participant.figure,headOnly:!0,direction:3}),S.participant.id<=0&&r.jsx(Ge,{isGroup:!0,badgeCode:S.participant.figure})]}),r.jsx(O,{truncate:!0,grow:!0,children:S.participant.name})]})]},S.threadId))})})]}),r.jsx(A,{size:8,overflow:"hidden",children:c&&r.jsxs(r.Fragment,{children:[r.jsx(O,{bold:!0,center:!0,children:f("messenger.window.separator",["FRIEND_NAME"],[c.participant.name])}),r.jsxs(M,{alignItems:"center",justifyContent:"between",gap:1,children:[r.jsxs(M,{gap:1,children:[r.jsxs(Da,{children:[r.jsx(V,{onClick:I,children:r.jsx(H,{className:"nitro-friends-spritesheet icon-follow"})}),r.jsx(V,{onClick:p,children:r.jsx(H,{className:"nitro-friends-spritesheet icon-profile-sm"})})]}),r.jsx(V,{variant:"danger",onClick:()=>E(as.IM,{reportedUserId:c.participant.id}),children:f("messenger.window.button.report")})]}),r.jsx(V,{onClick:S=>g(c.threadId),children:r.jsx(zr,{className:"fa-icon"})})]}),r.jsx(A,{fit:!0,className:"bg-muted p-2 rounded chat-messages",children:r.jsx(A,{innerRef:m,overflow:"auto",children:r.jsx(l$,{thread:c})})}),r.jsxs(M,{gap:1,children:[r.jsx("input",{type:"text",className:"form-control form-control-sm",maxLength:255,placeholder:f("messenger.window.input.default",["FRIEND_NAME"],[c.participant.name]),value:n,onChange:S=>o(S.target.value),onKeyDown:R}),r.jsx(V,{variant:"success",onClick:T,children:f("widgets.chatinput.say")})]})]})})]})})]}):null},u$=a=>{const{settings:t=null,onlineFriends:e=[]}=ar();return t?r.jsxs(r.Fragment,{children:[lS.createPortal(r.jsx(ZJ,{onlineFriends:e}),document.getElementById("toolbar-friend-bar-container")),r.jsx(a$,{}),r.jsx(c$,{})]}):null},h$=()=>{const{games:a,selectedGame:t,setSelectedGame:e}=_p(),s=n=>{let o=["game-icon"];return t===n&&o.push("selected"),o.join(" ")},i=n=>`url(${n.assetUrl}${n.gameNameId}_icon.png)`;return r.jsxs(H,{fullWidth:!0,className:"gameList-container bg-dark p-1",children:[f("gamecenter.game_list_title"),r.jsx(M,{gap:3,children:a&&a.map((n,o)=>r.jsx(H,{className:s(n),onClick:l=>e(n),style:{backgroundImage:i(n)}},o))})]})},d$=()=>{const{gameURL:a,setGameURL:t}=_p(),[e,s]=_.useState(0),i=_.useRef();return _.useEffect(()=>{if(!i||i&&!i.current)return;s(0);let n=document.createElement("iframe");n.src=a,n.classList.add("game-center-stage"),n.classList.add("h-100"),n.onload=()=>{s(o=>o+=1)},i.current.innerHTML="",i.current.appendChild(n)},[i,a]),_.useEffect(()=>{e>1&&(t(null),k(new ev))},[e,t]),a?r.jsx(H,{innerRef:i,className:"game-center-stage"}):null},_$=()=>{const{selectedGame:a,accountStatus:t}=_p();_.useEffect(()=>{a&&(k(new rv(a.gameId)),k(new sv(a.gameId)))},[a]);const e=()=>ir.uintHexColor(a.bgColor),s=()=>`url(${a.assetUrl}${a.gameNameId}_theme.png)`,i=()=>ir.uintHexColor(a.textColor),n=()=>{k(new av(a.gameId))};return r.jsxs(M,{className:"game-view py-4",fullHeight:!0,style:{backgroundColor:e(),backgroundImage:s(),color:i()},children:[r.jsxs(M,{className:"w-75",column:!0,alignItems:"center",gap:2,children:[r.jsx(O,{bold:!0,children:f(`gamecenter.${a.gameNameId}.description_title`)}),r.jsx("img",{src:a.assetUrl+a.gameNameId+"_logo.png"}),(t.hasUnlimitedGames||t.freeGamesLeft>0)&&r.jsx(r.Fragment,{children:r.jsxs(V,{variant:"light",position:"relative",className:"px-4",onClick:n,children:[f("gamecenter.play_now"),!t.hasUnlimitedGames&&r.jsx(cl,{className:"me-n1 mt-n1",count:t.freeGamesLeft})]})}),r.jsx(O,{bold:!0,className:"w-50",center:!0,children:f(`gamecenter.${a.gameNameId}.description_content`)})]}),r.jsx(H,{className:"w-25"})]})},g$=()=>{const{isVisible:a,setIsVisible:t,games:e,accountStatus:s}=_p();if(_.useEffect(()=>{const i=()=>{t(o=>!o)},n={linkReceived:o=>{switch(o.split("/")[1]){case"toggle":i();break}},eventUrlPrefix:"games/"};return Os(n),()=>Cs(n)},[]),!(!a||!e||!s))return r.jsxs(M,{position:"absolute",className:"top-0 bottom-0 start-0 end-0 bg-black",justifyContent:"center",children:[r.jsxs(M,{className:"game-center-main",column:!0,children:[r.jsx(_$,{}),r.jsx(h$,{})]}),r.jsx(d$,{})]})},f$=[0,1,2,3,4,5,6,7,8],m$=a=>{const{badgeParts:t=[],setBadgeParts:e=null}=a,[s,i]=_.useState(-1),{groupCustomize:n=null}=y_(),o=(l,c,u)=>{const h=[...t];h[l][c]=u,e(h),c==="key"&&i(-1)};return!t||!t.length?null:r.jsxs(r.Fragment,{children:[s<0&&t&&t.length>0&&t.map((l,c)=>r.jsxs(M,{alignItems:"center",justifyContent:"between",gap:2,className:"bg-muted rounded px-2 py-1",children:[r.jsxs(M,{pointer:!0,center:!0,className:"bg-muted rounded p-1",onClick:u=>i(c),children:[t[c].code&&t[c].code.length>0&&r.jsx(Ge,{badgeCode:t[c].code,isGroup:!0}),(!t[c].code||!t[c].code.length)&&r.jsx(M,{center:!0,className:"badge-image group-badge",children:r.jsx(p_,{className:"fa-icon"})})]}),l.type!==Di.BASE&&r.jsx(_t,{gap:1,columnCount:3,children:f$.map((u,h)=>r.jsx(H,{pointer:!0,className:`group-badge-position-swatch ${t[c].position===u?"active":""}`,onClick:d=>o(c,"position",u)},h))}),r.jsx(_t,{gap:1,columnCount:8,children:n.badgePartColors.length>0&&n.badgePartColors.map((u,h)=>r.jsx(H,{pointer:!0,className:`group-badge-color-swatch ${t[c].color===h+1?"active":""}`,style:{backgroundColor:"#"+u.color},onClick:d=>o(c,"color",h+1)},h))})]},c)),s>=0&&r.jsxs(_t,{gap:1,columnCount:5,children:[t[s].type===Di.SYMBOL&&r.jsx(A,{pointer:!0,center:!0,className:"bg-muted rounded p-1",onClick:l=>o(s,"key",0),children:r.jsx(M,{center:!0,className:"badge-image group-badge",children:r.jsx(zr,{className:"fa-icon"})})}),(t[s].type===Di.BASE?n.badgeBases:n.badgeSymbols).map((l,c)=>r.jsx(A,{pointer:!0,center:!0,className:"bg-muted rounded p-1",onClick:u=>o(s,"key",l.id),children:r.jsx(Ge,{badgeCode:Di.getCode(t[s].type,l.id,t[s].color,4),isGroup:!0})},c))]})]})},sj=a=>{const{groupData:t=null,setGroupData:e=null,setCloseAction:s=null,skipDefault:i=null}=a,[n,o]=_.useState(null),{groupCustomize:l=null}=y_(),c=()=>{if(!n||!n.length)return"";let h="";return n.forEach(d=>d.code&&(h+=d.code)),h},u=_.useCallback(()=>{if(!t||!n||!n.length)return!1;if(t.groupBadgeParts===n)return!0;if(t.groupId<=0)return e(d=>{const g={...d};return g.groupBadgeParts=n,g}),!0;const h=[];return n.forEach(d=>{d.code&&(h.push(d.key),h.push(d.color),h.push(d.position))}),k(new pv(t.groupId,h)),!0},[t,n,e]);return _.useEffect(()=>{if(t.groupBadgeParts)return;const h=[new Di(Di.BASE,l.badgeBases[0].id,l.badgePartColors[0].id),new Di(Di.SYMBOL,0,l.badgePartColors[0].id),new Di(Di.SYMBOL,0,l.badgePartColors[0].id),new Di(Di.SYMBOL,0,l.badgePartColors[0].id),new Di(Di.SYMBOL,0,l.badgePartColors[0].id)];e(d=>({...d,groupBadgeParts:h}))},[t.groupBadgeParts,l,e]),_.useEffect(()=>{if(t.groupId<=0){o(t.groupBadgeParts?[...t.groupBadgeParts]:null);return}o(t.groupBadgeParts)},[t]),_.useEffect(()=>(s({action:u}),()=>s(null)),[s,u]),r.jsxs(_t,{overflow:"hidden",gap:1,children:[r.jsx(A,{size:2,children:r.jsx(M,{center:!0,className:"bg-muted rounded p-1",children:r.jsx(Ge,{badgeCode:c(),isGroup:!0})})}),r.jsx(A,{size:10,overflow:"auto",children:r.jsx(m$,{badgeParts:n,setBadgeParts:o})})]})},ij=a=>{const{groupData:t=null,setGroupData:e=null,setCloseAction:s=null}=a,[i,n]=_.useState(null),{groupCustomize:o=null}=y_(),l=h=>h===0?o.groupColorsA.find(d=>d.id===i[h]).color:o.groupColorsB.find(d=>d.id===i[h]).color,c=(h,d)=>{n(g=>{const E=[...g];return E[h]=d,E})},u=_.useCallback(()=>!t||!i||!i.length?!1:t.groupColors===i?!0:t.groupId<=0?(e(h=>{const d={...h};return d.groupColors=[...i],d}),!0):(k(new Iv(t.groupId,i[0],i[1])),!0),[t,i,e]);return _.useEffect(()=>{if(!o.groupColorsA||!o.groupColorsB||t.groupColors)return;const h=[o.groupColorsA[0].id,o.groupColorsB[0].id];e(d=>({...d,groupColors:h}))},[o,t.groupColors,e]),_.useEffect(()=>{if(t.groupId<=0){n(t.groupColors?[...t.groupColors]:null);return}n(t.groupColors)},[t]),_.useEffect(()=>(s({action:u}),()=>s(null)),[s,u]),i?r.jsxs(_t,{overflow:"hidden",children:[r.jsxs(A,{size:2,gap:1,children:[r.jsx(O,{bold:!0,children:f("group.edit.color.guild.color")}),t.groupColors&&t.groupColors.length>0&&r.jsxs(M,{overflow:"hidden",className:"rounded border",children:[r.jsx(H,{className:"group-color-swatch",style:{backgroundColor:"#"+l(0)}}),r.jsx(H,{className:"group-color-swatch",style:{backgroundColor:"#"+l(1)}})]})]}),r.jsxs(A,{size:5,gap:1,overflow:"hidden",children:[r.jsx(O,{bold:!0,children:f("group.edit.color.primary.color")}),r.jsx(Ce,{gap:1,columnCount:7,columnMinWidth:16,columnMinHeight:16,children:t.groupColors&&o.groupColorsA&&o.groupColorsA.map((h,d)=>r.jsx("div",{className:qs("group-badge-color-swatch cursor-pointer",t.groupColors[0]===h.id&&"active"),style:{backgroundColor:"#"+h.color},onClick:()=>c(0,h.id)},d))})]}),r.jsxs(A,{size:5,gap:1,overflow:"hidden",children:[r.jsx(O,{bold:!0,children:f("group.edit.color.secondary.color")}),r.jsx(Ce,{gap:1,columnCount:7,columnMinWidth:16,columnMinHeight:16,children:t.groupColors&&o.groupColorsB&&o.groupColorsB.map((h,d)=>r.jsx("div",{className:qs("group-badge-color-swatch cursor-pointer",t.groupColors[1]===h.id&&"active"),style:{backgroundColor:"#"+h.color},onClick:()=>c(1,h.id)},d))})]})]}):null},E$=a=>{const{groupData:t=null,setGroupData:e=null,purchaseCost:s=0}=a,{groupCustomize:i=null}=y_(),n=()=>{if(!t||!t.groupBadgeParts||!t.groupBadgeParts.length)return"";let l="";return t.groupBadgeParts.forEach(c=>c.code&&(l+=c.code)),l},o=l=>l===0?i.groupColorsA.find(c=>c.id===t.groupColors[l]).color:i.groupColorsB.find(c=>c.id===t.groupColors[l]).color;return t?r.jsxs(_t,{overflow:"hidden",gap:1,children:[r.jsxs(A,{size:3,children:[r.jsxs(A,{center:!0,className:"bg-muted rounded p-1",gap:2,children:[r.jsx(O,{bold:!0,center:!0,children:f("group.create.confirm.guildbadge")}),r.jsx(Ge,{badgeCode:n(),isGroup:!0})]}),r.jsxs(A,{center:!0,className:"bg-muted rounded p-1",gap:2,children:[r.jsx(O,{bold:!0,center:!0,children:f("group.edit.color.guild.color")}),r.jsxs(M,{overflow:"hidden",className:"rounded border",children:[r.jsx(H,{className:"group-color-swatch",style:{backgroundColor:"#"+o(0)}}),r.jsx(H,{className:"group-color-swatch",style:{backgroundColor:"#"+o(1)}})]})]})]}),r.jsxs(A,{size:9,justifyContent:"between",children:[r.jsxs(A,{children:[r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:t.groupName}),r.jsx(O,{children:t.groupDescription})]}),r.jsx(O,{overflow:"auto",children:f("group.create.confirm.info")})]}),r.jsx(O,{center:!0,variant:"white",className:"bg-primary rounded p-1",children:f("group.create.confirm.buyinfo",["amount"],[s.toString()])})]})]}):null},rj=a=>{const{groupData:t=null,setGroupData:e=null,setCloseAction:s=null,onClose:i=null,isCreator:n=!1,availableRooms:o=[]}=a,[l,c]=_.useState(""),[u,h]=_.useState(""),[d,g]=_.useState(-1),{showConfirm:E=null}=He(),m=()=>{!t||t.groupId<=0||E(f("group.deleteconfirm.desc"),()=>{k(new _v(t.groupId)),i&&i()},null,null,null,f("group.deleteconfirm.title"))},I=_.useCallback(()=>!t||!l||!l.length?!1:l===t.groupName&&u===t.groupDescription?!0:t.groupId<=0?d<=0?!1:(e(p=>{const T={...p};return T.groupName=l,T.groupDescription=u,T.groupHomeroomId=d,T}),!0):(k(new Tv(t.groupId,l,u||"")),!0),[t,l,u,d,e]);return _.useEffect(()=>{c(t.groupName||""),h(t.groupDescription||""),g(t.groupHomeroomId)},[t]),_.useEffect(()=>(s({action:I}),()=>s(null)),[s,I]),t?r.jsxs(A,{justifyContent:"between",overflow:"auto",children:[r.jsxs(A,{gap:1,children:[r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx(O,{center:!0,className:"col-3",children:f("group.edit.name")}),r.jsx("input",{type:"text",className:"form-control form-control-sm",value:l,maxLength:29,onChange:p=>c(p.target.value)})]}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx(O,{center:!0,className:"col-3",children:f("group.edit.desc")}),r.jsx("textarea",{className:"form-control form-control-sm",value:u,maxLength:254,onChange:p=>h(p.target.value)})]}),n&&r.jsxs(r.Fragment,{children:[r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx(O,{center:!0,className:"col-3",children:f("group.edit.base")}),r.jsx(A,{fullWidth:!0,gap:1,children:r.jsxs("select",{className:"form-select form-select-sm",value:d,onChange:p=>g(parseInt(p.target.value)),children:[r.jsx("option",{value:-1,disabled:!0,children:f("group.edit.base.select.room")}),o&&o.map((p,T)=>r.jsx("option",{value:p.id,children:p.name},T))]})})]}),r.jsxs(M,{gap:1,children:[r.jsx(H,{className:"col-3",children:" "}),r.jsx(O,{small:!0,children:f("group.edit.base.warning")})]})]})]}),!n&&r.jsx(V,{variant:"danger",onClick:m,children:f("group.delete")}),n&&r.jsx(O,{underline:!0,center:!0,fullWidth:!0,pointer:!0,onClick:p=>ut("navigator/create"),children:f("group.createroom")})]}):null},p$=[1,2,3,4],I$=a=>{const{onClose:t=null}=a,[e,s]=_.useState(1),[i,n]=_.useState(null),[o,l]=_.useState(null),[c,u]=_.useState(null),[h,d]=_.useState(0),g=()=>{n(null),l(null),t&&t()},E=()=>{if(!o)return;const p=[];o.groupBadgeParts.forEach(T=>{T.code&&(p.push(T.key),p.push(T.color),p.push(T.position))}),k(new uv(o.groupName,o.groupDescription,o.groupHomeroomId,o.groupColors[0],o.groupColors[1],p))},m=()=>{if(!(i&&i.action&&!i.action())){if(e===1){t();return}s(p=>p-1)}},I=()=>{if(!(i&&i.action&&!i.action())){if(e===4){E();return}s(p=>p===4?p:p+1)}};return Y(lM,p=>{const T=p.getParser(),R=[];T.availableRooms.forEach((S,b)=>R.push({id:b,name:S})),u(R),d(T.groupCost)}),_.useEffect(()=>{s(1),l({groupId:-1,groupName:null,groupDescription:null,groupHomeroomId:-1,groupState:1,groupCanMembersDecorate:!0,groupColors:null,groupBadgeParts:null}),k(new hv)},[l]),o?r.jsxs(Ot,{className:"nitro-group-creator",children:[r.jsx(St,{headerText:f("group.create.title"),onCloseClick:g}),r.jsxs(pt,{children:[r.jsx(M,{center:!0,className:"creator-tabs",children:p$.map((p,T)=>r.jsx(M,{center:!0,className:`tab tab-${p===1?"blue-flat":p===4?"yellow":"blue-arrow"} ${e===p?"active":""}`,children:r.jsx(O,{variant:"white",children:f(`group.create.steplabel.${p}`)})},T))}),r.jsxs(A,{overflow:"hidden",children:[r.jsxs(M,{alignItems:"center",gap:2,children:[r.jsx(H,{className:`nitro-group-tab-image tab-${e}`}),r.jsxs(A,{grow:!0,gap:0,children:[r.jsx(O,{bold:!0,fontSize:4,children:f(`group.create.stepcaption.${e}`)}),r.jsx(O,{children:f(`group.create.stepdesc.${e}`)})]})]}),r.jsxs(A,{overflow:"hidden",children:[e===1&&r.jsx(rj,{groupData:o,setGroupData:l,setCloseAction:n,onClose:null,isCreator:!0,availableRooms:c}),e===2&&r.jsx(sj,{groupData:o,setGroupData:l,setCloseAction:n}),e===3&&r.jsx(ij,{groupData:o,setGroupData:l,setCloseAction:n}),e===4&&r.jsx(E$,{groupData:o,setGroupData:l,purchaseCost:h})]}),r.jsxs(M,{justifyContent:"between",children:[r.jsx(V,{variant:"link",className:"text-black",onClick:m,children:f(e===1?"generic.cancel":"group.create.previousstep")}),r.jsx(V,{disabled:e===4&&!fc(),variant:e===4?fc()?"success":"danger":"primary",onClick:I,children:f(e===4?fc()?"group.create.confirm.buy":"group.create.confirm.viprequired":"group.create.nextstep")})]})]})]})]}):null},T$=["regular","exclusive","private"],nj=a=>{const{groupInformation:t=null,onClose:e=null,overflow:s="hidden",...i}=a,{showConfirm:n=null}=He(),o=t&&t.ownerName===q().userName,l=()=>t&&bO(t.id),c=()=>{n(f("group.leaveconfirm.desc"),()=>{k(new tp(t.id,q().userId)),e&&e()},null)},u=()=>t.membershipType===Qs.NOT_MEMBER||t.membershipType===Qs.REQUEST_PENDING?null:o?r.jsx("i",{className:"icon icon-group-owner",title:f("group.youareowner")}):t.isAdmin?r.jsx("i",{className:"icon icon-group-admin",title:f("group.youareadmin")}):r.jsx("i",{className:"icon icon-group-member",title:f("group.youaremember")}),h=()=>{if(o)return"group.youareowner";if(t.type===Fr.PRIVATE&&t.membershipType!==Qs.MEMBER)return"";if(t.membershipType===Qs.MEMBER)return"group.leave";if(t.membershipType===Qs.NOT_MEMBER&&t.type===Fr.REGULAR)return"group.join";if(t.membershipType===Qs.REQUEST_PENDING)return"group.membershippending";if(t.membershipType===Qs.NOT_MEMBER&&t.type===Fr.EXCLUSIVE)return"group.requestmembership"},d=()=>{if(!(t.type===Fr.PRIVATE&&t.membershipType===Qs.NOT_MEMBER)){if(t.membershipType===Qs.MEMBER){c();return}l()}},g=E=>{switch(E){case"members":mA(t.id);break;case"members_pending":mA(t.id,2);break;case"manage":T0(t.id);break;case"homeroom":Yr(t.roomId);break;case"furniture":ut("catalog/open/"+Of.GUILD_CUSTOM_FURNI);break;case"popular_groups":ut("navigator/search/groups");break}};return t?r.jsxs(_t,{overflow:s,...i,children:[r.jsxs(A,{center:!0,size:3,overflow:"hidden",children:[r.jsx(M,{alignItems:"center",overflow:"hidden",className:"group-badge",children:r.jsx(Ge,{badgeCode:t.badge,isGroup:!0,scale:2})}),r.jsxs(A,{alignItems:"center",gap:1,children:[r.jsx(O,{small:!0,underline:!0,pointer:!0,onClick:()=>g("members"),children:f("group.membercount",["totalMembers"],[t.membersCount.toString()])}),t.pendingRequestsCount>0&&r.jsx(O,{small:!0,underline:!0,pointer:!0,onClick:()=>g("members_pending"),children:f("group.pendingmembercount",["amount"],[t.pendingRequestsCount.toString()])}),t.isOwner&&r.jsx(O,{small:!0,underline:!0,pointer:!0,onClick:()=>g("manage"),children:f("group.manage")})]}),u()]}),r.jsxs(A,{size:9,justifyContent:"between",overflow:"auto",children:[r.jsxs(A,{overflow:"hidden",children:[r.jsxs(A,{gap:1,children:[r.jsxs(M,{alignItems:"center",gap:2,children:[r.jsx(O,{bold:!0,children:t.title}),r.jsxs(M,{gap:1,children:[r.jsx("i",{className:"icon icon-group-type-"+t.type,title:f(`group.edit.settings.type.${T$[t.type]}.help`)}),t.canMembersDecorate&&r.jsx("i",{className:"icon icon-group-decorate",title:f("group.memberscandecorate")})]})]}),r.jsx(O,{small:!0,children:f("group.created",["date","owner"],[t.createdAt,t.ownerName])})]}),r.jsx(O,{small:!0,overflow:"auto",className:"group-description",children:t.description})]}),r.jsxs(A,{children:[r.jsxs(A,{gap:1,children:[r.jsx(O,{small:!0,underline:!0,pointer:!0,onClick:()=>g("homeroom"),children:f("group.linktobase")}),r.jsx(O,{small:!0,underline:!0,pointer:!0,onClick:()=>g("furniture"),children:f("group.buyfurni")}),r.jsx(O,{small:!0,underline:!0,pointer:!0,onClick:()=>g("popular_groups"),children:f("group.showgroups")})]}),(t.type!==Fr.PRIVATE||t.type===Fr.PRIVATE&&t.membershipType===Qs.MEMBER)&&r.jsx(V,{disabled:t.membershipType===Qs.REQUEST_PENDING||o,onClick:d,children:f(h())})]})]})]}):null},R$=a=>{const[t,e]=_.useState(null);return Y(ph,s=>{const i=s.getParser();(t&&t.id===i.id||i.flag)&&e(i)}),t?r.jsxs(Ot,{className:"nitro-group-information-standalone",children:[r.jsx(St,{headerText:f("group.window.title"),onCloseClick:s=>e(null)}),r.jsx(pt,{children:r.jsx(nj,{groupInformation:t,onClose:()=>e(null)})})]}):null},S$=["regular","exclusive","private"],O$=a=>{const{groupData:t=null,setGroupData:e=null,setCloseAction:s=null}=a,[i,n]=_.useState(t.groupState),[o,l]=_.useState(t.groupCanMembersDecorate),c=_.useCallback(()=>t?i===t.groupState&&o===t.groupCanMembersDecorate?!0:t.groupId<=0?(e(u=>{const h={...u};return h.groupState=i,h.groupCanMembersDecorate=o,h}),!0):(k(new Rv(t.groupId,i,o?0:1)),!0):!1,[t,i,o,e]);return _.useEffect(()=>{n(t.groupState),l(t.groupCanMembersDecorate)},[t]),_.useEffect(()=>(s({action:c}),()=>s(null)),[s,c]),r.jsxs(A,{overflow:"auto",children:[r.jsx(A,{children:S$.map((u,h)=>r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"radio",name:"groupState",checked:i===h,onChange:d=>n(h)}),r.jsxs(A,{gap:0,children:[r.jsxs(M,{gap:1,children:[r.jsx("i",{className:`icon icon-group-type-${h}`}),r.jsx(O,{bold:!0,children:f(`group.edit.settings.type.${u}.label`)})]}),r.jsx(O,{children:f(`group.edit.settings.type.${u}.help`)})]})]},h))}),r.jsx(O8,{}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"checkbox",checked:o,onChange:u=>l(h=>!h)}),r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("group.edit.settings.rights.caption")}),r.jsx(O,{children:f("group.edit.settings.rights.members.help")})]})]})]})},C$=[1,2,3,5],A$=a=>{const[t,e]=_.useState(1),[s,i]=_.useState(null),[n,o]=_.useState(null),l=()=>{i(u=>(u&&u.action&&u.action(),null)),o(null)},c=u=>{s&&s.action&&s.action(),e(u)};return Y(ph,u=>{const h=u.getParser();!n||n.groupId!==h.id||o(d=>{const g={...d};return g.groupName=h.title,g.groupDescription=h.description,g.groupState=h.type,g.groupCanMembersDecorate=h.canMembersDecorate,g})}),Y(dM,u=>{const h=u.getParser(),d=[];h.badgeParts.forEach((g,E)=>{d.push(new Zu(g.isBase?Zu.BASE:Zu.SYMBOL,g.key,g.color,g.position))}),o({groupId:h.id,groupName:h.title,groupDescription:h.description,groupHomeroomId:h.roomId,groupState:h.state,groupCanMembersDecorate:h.canMembersDecorate,groupColors:[h.colorA,h.colorB],groupBadgeParts:d})}),!n||n.groupId<=0?null:r.jsxs(Ot,{className:"nitro-group-manager",children:[r.jsx(St,{headerText:f("group.window.title"),onCloseClick:l}),r.jsx(Ro,{children:C$.map(u=>r.jsx(Wn,{isActive:t===u,onClick:()=>c(u),children:f(`group.edit.tab.${u}`)},u))}),r.jsxs(pt,{children:[r.jsxs(M,{alignItems:"center",gap:2,children:[r.jsx(H,{className:`nitro-group-tab-image tab-${t}`}),r.jsxs(A,{grow:!0,gap:0,children:[r.jsx(O,{bold:!0,fontSize:4,children:f(`group.edit.tabcaption.${t}`)}),r.jsx(O,{children:f(`group.edit.tabdesc.${t}`)})]})]}),r.jsxs(A,{grow:!0,overflow:"hidden",children:[t===1&&r.jsx(rj,{groupData:n,setGroupData:o,setCloseAction:i,onClose:l}),t===2&&r.jsx(sj,{groupData:n,setGroupData:o,setCloseAction:i,skipDefault:!0}),t===3&&r.jsx(ij,{groupData:n,setGroupData:o,setCloseAction:i}),t===5&&r.jsx(O$,{groupData:n,setGroupData:o,setCloseAction:i})]})]})]})},N$=a=>{const[t,e]=_.useState(-1),[s,i]=_.useState(-1),[n,o]=_.useState(null),[l,c]=_.useState(-1),[u,h]=_.useState(0),[d,g]=_.useState(""),[E,m]=_.useState(null),{showConfirm:I=null}=He(),p=N=>{if(N.rank===Ei.OWNER)return"group.members.owner";if(n.admin){if(N.rank===Ei.ADMIN)return"group.members.removerights";if(N.rank===Ei.MEMBER)return"group.members.giverights"}return""},T=_.useCallback(()=>{t===-1||s===-1||l===-1||k(new jT(t,l,d,s))},[t,s,l,d]),R=N=>{!n.admin||N.rank===Ei.OWNER||(N.rank!==Ei.ADMIN?k(new ov(n.groupId,N.id)):k(new lv(n.groupId,N.id)),T())},S=N=>{!n.admin||N.rank!==Ei.REQUESTED||(k(new mv(n.groupId,N.id)),T())},b=N=>{if(n.admin){if(N.rank===Ei.REQUESTED){k(new Ev(n.groupId,N.id)),T();return}m(N.name),k(new dv(n.groupId,N.id))}};return Y(uM,N=>{const P=N.getParser();o(P),i(P.level),h(Math.ceil(P.totalMembersCount/P.pageSize))}),Y(cM,N=>{const P=N.getParser();I(f(P.furnitureCount>0?"group.kickconfirm.desc":"group.kickconfirm_nofurni.desc",["user","amount"],[E,P.furnitureCount.toString()]),()=>{k(new tp(n.groupId,P.userId)),T()},null),m(null)}),_.useEffect(()=>{const N={linkReceived:P=>{const B=P.split("/");if(B.length<2)return;const F=parseInt(B[1])||-1,w=parseInt(B[2])||3;e(F),i(w),c(0)},eventUrlPrefix:"group-members/"};return Os(N),()=>Cs(N)},[]),_.useEffect(()=>{c(0)},[t,s,d]),_.useEffect(()=>{t===-1||s===-1||l===-1||k(new jT(t,l,d,s))},[t,s,l,d]),_.useEffect(()=>{t!==-1&&(i(-1),o(null),h(0),g(""),m(null))},[t]),t===-1||!n?null:r.jsxs(Ot,{className:"nitro-group-members",children:[r.jsx(St,{headerText:f("group.members.title",["groupName"],[n?n.groupTitle:""]),onCloseClick:N=>e(-1)}),r.jsxs(pt,{overflow:"hidden",children:[r.jsxs(M,{gap:2,children:[r.jsx(M,{center:!0,className:"group-badge",children:r.jsx(Ge,{badgeCode:n.badge,isGroup:!0,className:"mx-auto d-block"})}),r.jsxs(A,{fullWidth:!0,gap:1,children:[r.jsx("input",{type:"text",className:"form-control form-control-sm w-100",placeholder:f("group.members.searchinfo"),value:d,onChange:N=>g(N.target.value)}),r.jsxs("select",{className:"form-select form-select-sm w-100",value:s,onChange:N=>i(parseInt(N.target.value)),children:[r.jsx("option",{value:"0",children:f("group.members.search.all")}),r.jsx("option",{value:"1",children:f("group.members.search.admins")}),r.jsx("option",{value:"2",children:f("group.members.search.pending")})]})]})]}),r.jsx(_t,{columnCount:2,overflow:"auto",className:"nitro-group-members-list-grid",children:n.result.map((N,P)=>r.jsxs(M,{gap:2,alignItems:"center",overflow:"hidden",className:"member-list-item bg-white rounded p-2",children:[r.jsx("div",{className:"avatar-head cursor-pointer",onClick:()=>rr(N.id),children:r.jsx(ls,{figure:N.figure,headOnly:!0,direction:2})}),r.jsxs(A,{grow:!0,gap:1,children:[r.jsx(O,{bold:!0,small:!0,pointer:!0,onClick:B=>rr(N.id),children:N.name}),N.rank!==Ei.REQUESTED&&r.jsx(O,{small:!0,italics:!0,variant:"muted",children:f("group.members.since",["date"],[N.joinedAt])})]}),r.jsxs(A,{gap:1,children:[N.rank!==Ei.REQUESTED&&r.jsx(M,{center:!0,children:r.jsx(H,{pointer:n.admin,className:`icon icon-group-small-${N.rank===Ei.OWNER?"owner":N.rank===Ei.ADMIN?"admin":n.admin&&N.rank===Ei.MEMBER?"not-admin":""}`,title:f(p(N)),onClick:B=>R(N)})}),n.admin&&N.rank===Ei.REQUESTED&&r.jsx(M,{alignItems:"center",children:r.jsx(H,{pointer:!0,className:"nitro-friends-spritesheet icon-accept",title:f("group.members.accept"),onClick:B=>S(N)})}),n.admin&&N.rank!==Ei.OWNER&&N.id!==q().userId&&r.jsx(M,{alignItems:"center",children:r.jsx(H,{pointer:!0,className:"nitro-friends-spritesheet icon-deny",title:f(N.rank===Ei.REQUESTED?"group.members.reject":"group.members.kick"),onClick:B=>b(N)})})]})]},P))}),r.jsxs(M,{gap:1,justifyContent:"between",alignItems:"center",children:[r.jsx(V,{disabled:n.pageIndex===0,onClick:N=>c(P=>P-1),children:r.jsx(pr,{className:"fa-icon"})}),r.jsx(O,{small:!0,children:f("group.members.pageinfo",["amount","page","totalPages"],[n.totalMembersCount.toString(),(n.pageIndex+1).toString(),u.toString()])}),r.jsx(V,{disabled:n.pageIndex===u-1,onClick:N=>c(P=>P+1),children:r.jsx(Ir,{className:"fa-icon"})})]})]})]})},x$=a=>{const[t,e]=_.useState(!1);return y_(),Y(hM,s=>{const i=s.getParser();e(!1),Yr(i.roomId)}),_.useEffect(()=>{const s={linkReceived:i=>{const n=i.split("/");if(!(n.length<2))switch(n[1]){case"create":e(!0);return;case"manage":if(!n[2])return;e(!1),k(new Sv(Number(n[2])));return}},eventUrlPrefix:"groups/"};return Os(s),()=>Cs(s)},[]),r.jsxs(r.Fragment,{children:[t&&r.jsx(I$,{onClose:()=>e(!1)}),!t&&r.jsx(A$,{}),r.jsx(N$,{}),r.jsx(R$,{})]})},M$=a=>{const{helpRequestDescription:t=null,helpRequestAverageTime:e=0}=a,s=i=>k(new Fv(i));return r.jsxs(A,{children:[r.jsxs(A,{gap:0,className:"bg-muted p-2 rounded",children:[r.jsx(O,{bold:!0,children:f("guide.help.request.guide.accept.request.title")}),r.jsx(O,{variant:"muted",children:f("guide.help.request.type.1")}),r.jsx(O,{wrap:!0,textBreak:!0,children:t})]}),r.jsxs(A,{gap:1,children:[r.jsx(V,{variant:"success",onClick:i=>s(!0),children:f("guide.help.request.guide.accept.accept.button")}),r.jsx(V,{variant:"danger",onClick:i=>s(!1),children:f("guide.help.request.guide.accept.skip.link")})]})]})},y$=a=>{const{isOnDuty:t=!1,isHandlingGuideRequests:e=!1,setIsHandlingGuideRequests:s=null,isHandlingHelpRequests:i=!1,setIsHandlingHelpRequests:n=null,isHandlingBullyReports:o=!1,setIsHandlingBullyReports:l=null,guidesOnDuty:c=0,helpersOnDuty:u=0,guardiansOnDuty:h=0,processAction:d=null}=a;return r.jsxs(A,{children:[r.jsxs(M,{alignItems:"center",gap:2,className:"bg-muted p-2 rounded",children:[r.jsx(H,{className:"duty-switch"+(t?"":" off"),onClick:g=>d("toggle_duty")}),r.jsxs(A,{gap:0,children:[r.jsx(O,{bold:!0,children:f("guide.help.guide.tool.yourstatus")}),r.jsx(O,{children:f(`guide.help.guide.tool.duty.${t?"on":"off"}`)})]})]}),r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("guide.help.guide.tool.tickettypeselection.caption")}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",disabled:t,type:"checkbox",checked:e,onChange:g=>s(g.target.checked)}),r.jsx(O,{children:f("guide.help.guide.tool.tickettypeselection.guiderequests")})]}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",disabled:t,type:"checkbox",checked:i,onChange:g=>n(g.target.checked)}),r.jsx(O,{children:f("guide.help.guide.tool.tickettypeselection.onlyhelprequests")})]}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",disabled:t,type:"checkbox",checked:o,onChange:g=>l(g.target.checked)}),r.jsx(O,{children:f("guide.help.guide.tool.tickettypeselection.bullyreports")})]})]}),r.jsx("hr",{className:"bg-dark m-0"}),r.jsxs(M,{center:!0,gap:2,children:[r.jsx(H,{className:"info-icon"}),r.jsxs(A,{gap:1,children:[r.jsx(H,{dangerouslySetInnerHTML:{__html:f("guide.help.guide.tool.guidesonduty",["amount"],[c.toString()])}}),r.jsx(H,{dangerouslySetInnerHTML:{__html:f("guide.help.guide.tool.helpersonduty",["amount"],[u.toString()])}}),r.jsx(H,{dangerouslySetInnerHTML:{__html:f("guide.help.guide.tool.guardiansonduty",["amount"],[h.toString()])}})]})]}),r.jsx("hr",{className:"bg-dark m-0"}),r.jsxs(M,{justifyContent:"between",gap:2,children:[r.jsx(V,{disabled:!0,onClick:g=>d("forum_link"),children:f("guide.help.guide.tool.forum.link")}),r.jsx(V,{disabled:!0,children:f("guide.help.guide.tool.skill.link")})]})]})},D$=a=>{const t=_.useRef(null),{isGuide:e=!1,userId:s=0,userName:i=null,userFigure:n=null,isTyping:o=!1,messageGroups:l=[]}=a,[c,u]=_.useState("");_.useEffect(()=>{var p;(p=t.current)==null||p.scrollIntoView({block:"end",behavior:"smooth"})},[l]);const h=_.useCallback(()=>{k(new wv)},[]),d=_.useCallback(()=>{k(new Gv)},[]),g=_.useCallback(()=>{k(new Vv)},[]);Y(NM,p=>{const T=p.getParser();Yr(T.requesterRoomId)});const E=_.useCallback(()=>{!c||!c.length||(k(new Bv(c)),u(""))},[c]),m=_.useCallback(p=>{p.key==="Enter"&&E()},[E]),I=_.useCallback(p=>p===q().userId,[]);return r.jsxs(A,{fullHeight:!0,children:[r.jsxs(M,{alignItems:"center",justifyContent:"between",gap:1,className:"bg-muted p-2 rounded",children:[e&&r.jsxs(Da,{children:[r.jsx(V,{onClick:h,children:f("guide.help.request.guide.ongoing.visit.button")}),r.jsx(V,{onClick:d,children:f("guide.help.request.guide.ongoing.invite.button")})]}),!e&&r.jsxs(A,{gap:0,children:[r.jsx(O,{bold:!0,children:i}),r.jsx(O,{children:f("guide.help.request.user.ongoing.guide.desc")})]}),r.jsx(V,{variant:"danger",disabled:!0,children:f("guide.help.common.report.link")})]}),r.jsx(A,{overflow:"hidden",gap:1,className:"bg-muted rounded chat-messages p-2",children:r.jsxs(A,{overflow:"auto",children:[l.map((p,T)=>r.jsxs(M,{fullWidth:!0,justifyContent:I(p.userId)?"end":"start",gap:2,children:[r.jsx(H,{shrink:!0,className:"message-avatar",children:!I(p.userId)&&r.jsx(ls,{figure:n,direction:2})}),r.jsxs(H,{className:"bg-light text-black border-radius mb-2 rounded py-1 px-2 messages-group-"+(I(p.userId)?"right":"left"),children:[r.jsxs(O,{bold:!0,children:[I(p.userId)&&q().userName,!I(p.userId)&&i]}),p.messages.map((R,S)=>r.jsx(H,{pointer:!!R.roomId,className:R.roomId?"text-break text-underline":"text-break",onClick:()=>R.roomId?Yr(R.roomId):null,children:R.message},S))]}),I(p.userId)&&r.jsx(H,{className:"message-avatar flex-shrink-0",children:r.jsx(ls,{figure:q().figure,direction:4})})]},T)),r.jsx("div",{ref:t})]})}),r.jsxs(A,{gap:1,children:[r.jsxs(M,{gap:1,children:[r.jsx("input",{type:"text",className:"form-control form-control-sm",placeholder:f("guide.help.request.guide.ongoing.input.empty",["name"],[i]),value:c,onChange:p=>u(p.target.value),onKeyDown:m}),r.jsx(V,{variant:"success",onClick:E,children:f("widgets.chatinput.say")})]}),o&&r.jsx(O,{variant:"muted",children:f("guide.help.common.typing")})]}),r.jsx(V,{fullWidth:!0,variant:"success",onClick:g,children:f("guide.help.request."+(e?"guide":"user")+".ongoing.close.link")})]})},b$=15,v$=a=>{const{userRequest:t="",setUserRequest:e=null}=a,[s,i]=_.useState(!1),n=()=>{i(!0),k(new Uv(1,t))};return r.jsxs(A,{children:[r.jsx(O,{children:f("guide.help.request.user.create.help")}),r.jsx("textarea",{className:"request-message",maxLength:140,value:t,onChange:o=>e(o.target.value),placeholder:f("guide.help.request.user.create.input.help")}),r.jsx(V,{fullWidth:!0,variant:"success",disabled:t.length<b$||s,onClick:n,children:f("guide.help.request.user.create.input.button")})]})},L$=a=>{const{userName:t=null}=a,e=s=>k(new jv(s));return r.jsxs(A,{children:[r.jsxs(M,{justifyContent:"between",gap:1,className:"bg-muted p-2 rounded",children:[r.jsxs(A,{gap:0,children:[r.jsx(O,{bold:!0,children:t}),r.jsx(O,{children:f("guide.help.request.user.feedback.guide.desc")})]}),r.jsx(V,{variant:"danger",disabled:!0,children:f("guide.help.common.report.link")})]}),r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("guide.help.request.user.feedback.closed.title")}),r.jsx(O,{children:f("guide.help.request.user.feedback.closed.desc")})]}),t&&t.length>0&&r.jsxs(r.Fragment,{children:[r.jsx("hr",{className:"bg-dark m-0 mt-auto"}),r.jsxs(A,{children:[r.jsx(O,{center:!0,bold:!0,children:f("guide.help.request.user.feedback.question")}),r.jsxs(M,{gap:1,children:[r.jsx(V,{fullWidth:!0,variant:"success",onClick:s=>e(!0),children:f("guide.help.request.user.feedback.positive.button")}),r.jsx(V,{fullWidth:!0,variant:"danger",onClick:s=>e(!1),children:f("guide.help.request.user.feedback.negative.button")})]})]})]})]})},P$=a=>r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("guide.help.request.no_tour_guides.title")}),r.jsx(O,{children:f("guide.help.request.no_tour_guides.message")})]}),U$=a=>{const{helpRequestDescription:t=null,helpRequestAverageTime:e=0}=a,s=()=>k(new kv);return r.jsxs(A,{children:[r.jsxs(A,{gap:0,className:"bg-muted rounded p-2",children:[r.jsx(O,{bold:!0,children:f("guide.help.request.guide.accept.request.title")}),r.jsx(O,{variant:"muted",children:f("guide.help.request.type.1")}),r.jsx(O,{wrap:!0,textBreak:!0,children:t})]}),r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("guide.help.request.user.pending.info.title")}),r.jsx(O,{children:f("guide.help.request.user.pending.info.message")}),r.jsx(O,{children:f("guide.help.request.user.pending.info.waiting",["waitingtime"],[e.toString()])})]}),r.jsx(V,{variant:"danger",onClick:s,children:f("guide.help.request.user.pending.cancel.button")})]})},j$=a=>r.jsx(A,{gap:1,children:r.jsx(O,{children:f("guide.help.request.user.guide.disconnected.error.desc")})}),w$=a=>r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("guide.help.request.user.thanks.info.title")}),r.jsx(O,{children:f("guide.help.request.user.thanks.info.desc")})]}),F$=a=>{const[t,e]=_.useState(!1),[s,i]=_.useState(f("guide.help.guide.tool.title")),[n,o]=_.useState(!1),[l,c]=_.useState(Ae.GUIDE_TOOL_MENU),[u,h]=_.useState(!1),[d,g]=_.useState(!1),[E,m]=_.useState(!1),[I,p]=_.useState(!1),[T,R]=_.useState(0),[S,b]=_.useState(0),[N,P]=_.useState(0),[B,F]=_.useState(""),[w,U]=_.useState(null),[G,K]=_.useState(0),[z,et]=_.useState(0),[rt,J]=_.useState(null),[Ct,At]=_.useState(null),[se,ve]=_.useState(!1),[ss,qe]=_.useState([]),{simpleAlert:ni=null}=He(),ge=_.useCallback((pe,Wt)=>{switch(pe){case Ae.GUIDE_TOOL_MENU:i(f("guide.help.guide.tool.title")),o(!1);break;case Ae.GUIDE_ACCEPT:i(f("guide.help.request.guide.accept.title")),o(!0);break;case Ae.GUIDE_ONGOING:i(f("guide.help.request.guide.ongoing.title",["name"],[Wt])),o(!0);break;case Ae.USER_CREATE:i(f("guide.help.request.user.create.title")),o(!1);break;case Ae.USER_PENDING:i(f("guide.help.request.user.pending.title")),o(!0);break;case Ae.USER_ONGOING:i(f("guide.help.request.user.ongoing.title",["name"],[Wt])),o(!0);break;case Ae.USER_FEEDBACK:i(f("guide.help.request.user.feedback.title")),o(!0);break;case Ae.USER_THANKS:i(f("guide.help.request.user.thanks.title")),o(!1);break;case Ae.USER_NO_HELPERS:i(f("guide.help.request.no_tour_guides.heading")),o(!1);break;case Ae.USER_SOMETHING_WRONG:i(f("guide.help.request.user.guide.disconnected.error.heading")),o(!1);break}c(pe),e(!0)},[]),Rs=_.useCallback(pe=>{switch(pe.type){case Er.SHOW_GUIDE_TOOL:e(!0);return;case Er.HIDE_GUIDE_TOOL:e(!1);return;case Er.TOGGLE_GUIDE_TOOL:e(Wt=>!Wt);return;case Er.CREATE_HELP_REQUEST:ge(Ae.USER_CREATE);return}},[ge]);Is(Er.SHOW_GUIDE_TOOL,Rs),Is(Er.HIDE_GUIDE_TOOL,Rs),Is(Er.TOGGLE_GUIDE_TOOL,Rs),Is(Er.CREATE_HELP_REQUEST,Rs),Y(VS,pe=>{!pe.getParser().isAllowed(Vg.USE_GUIDE_TOOL)&&u&&(h(!1),k(new wT(!1,!1,!1,!1)))}),Y(TM,pe=>{const Wt=pe.getParser();h(Wt.onDuty),b(Wt.guidesOnDuty),R(Wt.helpersOnDuty),P(Wt.guardiansOnDuty)}),Y(RM,pe=>{const Wt=pe.getParser();U(Wt.helpRequestDescription),K(Wt.roleSpecificWaitTime),Wt.asGuide&&u&&ge(Ae.GUIDE_ACCEPT),Wt.asGuide||ge(Ae.USER_PENDING)}),Y(jS,pe=>{const Wt=pe.getParser();u?(et(Wt.requesterUserId),J(Wt.requesterName),At(Wt.requesterFigure),ge(Ae.GUIDE_ONGOING,Wt.requesterName)):(et(Wt.guideUserId),J(Wt.guideName),At(Wt.guideFigure),ge(Ae.USER_ONGOING,Wt.guideName))}),Y(AM,pe=>{const Wt=pe.getParser();ve(Wt.isTyping)}),Y(CM,pe=>{const Wt=pe.getParser(),We=[...ss];let Be=We[We.length-1];(!Be||Be.userId!==Wt.senderId)&&(Be=new pA(Wt.senderId),We.push(Be)),Be.addChat(new EA(Wt.chatMessage)),qe(We)}),Y(OM,pe=>{const Wt=pe.getParser();if(Wt.roomId!==0){const We=[...ss];let Be=We[We.length-1];const In=u?q().userId:z;(!Be||Be.userId!==In)&&(Be=new pA(In),We.push(Be)),Be.addChat(new EA(Wt.roomName,Wt.roomId)),qe(We)}}),Y(PS,pe=>{u?(et(0),J(null),At(null),ve(!1),qe([]),ge(Ae.GUIDE_TOOL_MENU)):ge(Ae.USER_FEEDBACK)}),Y(US,pe=>{switch(pe.getParser().errorCode){case 0:ge(Ae.USER_SOMETHING_WRONG);break;case 1:case 2:ge(Ae.USER_NO_HELPERS);break}}),Y(SM,pe=>{et(0),J(null),At(null),ve(!1),qe([]),ge(u?Ae.GUIDE_TOOL_MENU:Ae.USER_THANKS)}),_.useEffect(()=>{const pe={linkReceived:Wt=>{const We=Wt.split("/");if(!(We.length<2))switch(We[1]){case"tour":return}},eventUrlPrefix:"help/"};return Os(pe),()=>Cs(pe)},[]);const mi=_.useCallback(pe=>{switch(pe){case"close":e(!1),F(""),c(Ae.GUIDE_TOOL_MENU);return;case"toggle_duty":if(!d&&!E&&!I){ni(f("guide.help.guide.tool.noqueueselected.message"),null,null,null,f("guide.help.guide.tool.noqueueselected.caption"),null);return}h(We=>(k(new wT(!We,We?!1:E,We?!1:I,We?!1:d)),!We));return;case"forum_link":const Wt=it("group.homepage.url","").replace("%groupid%",it("guide.help.alpha.groupid","0"));window.open(Wt);return}},[d,E,I,ni]);return t?r.jsxs(Ot,{className:"nitro-guide-tool",children:[r.jsx(St,{headerText:s,onCloseClick:pe=>mi("close"),noCloseButton:n}),r.jsxs(pt,{className:"text-black",children:[l===Ae.GUIDE_TOOL_MENU&&r.jsx(y$,{isOnDuty:u,isHandlingGuideRequests:E,setIsHandlingGuideRequests:m,isHandlingHelpRequests:I,setIsHandlingHelpRequests:p,isHandlingBullyReports:d,setIsHandlingBullyReports:g,guidesOnDuty:S,helpersOnDuty:T,guardiansOnDuty:N,processAction:mi}),l===Ae.GUIDE_ACCEPT&&r.jsx(M$,{helpRequestDescription:w,helpRequestAverageTime:G}),[Ae.GUIDE_ONGOING,Ae.USER_ONGOING].includes(l)&&r.jsx(D$,{isGuide:u,userId:z,userName:rt,userFigure:Ct,isTyping:se,messageGroups:ss}),l===Ae.USER_CREATE&&r.jsx(v$,{userRequest:B,setUserRequest:F}),l===Ae.USER_PENDING&&r.jsx(U$,{helpRequestDescription:w,helpRequestAverageTime:G}),l===Ae.USER_FEEDBACK&&r.jsx(L$,{userName:rt}),l===Ae.USER_THANKS&&r.jsx(w$,{}),l===Ae.USER_NO_HELPERS&&r.jsx(P$,{}),l===Ae.USER_SOMETHING_WRONG&&r.jsx(j$,{})]})]}):null},G$=a=>{const[t,e]=_.useState(!1),[s,i]=_.useState(null),[n,o]=_.useState(0),[l,c]=_.useState(null),{userFigure:u=null}=Oo(),{purse:h=null,clubStatus:d=null}=kc(),{badgeCodes:g=[],activate:E=null,deactivate:m=null}=fp(),I=()=>h.clubDays<=0?f("purse.clubdays.zero.amount.text"):h.minutesUntilExpiration>-1&&h.minutesUntilExpiration<60*24?Vr.shortFormat(h.minutesUntilExpiration*60):Vr.shortFormat((h.clubPeriods*31+h.clubDays)*86400),p=()=>{switch(d){case Sa.ACTIVE:return f(`hccenter.status.${d}.info`,["timeleft","joindate","streakduration"],[I(),s==null?void 0:s.firstSubscriptionDate,Vr.shortFormat((s==null?void 0:s.currentHcStreak)*86400)]);case Sa.EXPIRED:return f(`hccenter.status.${d}.info`,["joindate"],[s==null?void 0:s.firstSubscriptionDate]);default:return f(`hccenter.status.${d}.info`)}},T=()=>!s||s.timeUntilPayday<60?f("hccenter.special.time.soon"):Vr.shortFormat(s.timeUntilPayday*60),R=()=>f("hccenter.special.sum",["credits"],[((s==null?void 0:s.creditRewardForStreakBonus)+(s==null?void 0:s.creditRewardForMonthlySpent)).toString()]);if(Y(MS,b=>{const N=b.getParser();o(N.giftsAvailable)}),Y(db,b=>{const N=b.getParser();i(N.data)}),_.useEffect(()=>{const b={linkReceived:N=>{const P=N.split("/");if(!(P.length<2))switch(P[1]){case"open":if(P.length>2)switch(P[2]){case"hccenter":e(!0);break}return}},eventUrlPrefix:"habboUI/"};return Os(b),()=>Cs(b)},[]),_.useEffect(()=>{c(Q7(g))},[g]),_.useEffect(()=>{if(!t)return;const b=E();return()=>m(b)},[t,E,m]),_.useEffect(()=>{k(new JS),k(new IU)},[]),!t)return null;const S=r.jsx(Sc,{id:"popover-basic",children:r.jsxs(Sc.Body,{className:"text-black py-2 px-3",children:[r.jsx("h5",{children:f("hccenter.breakdown.title")}),r.jsx("div",{children:f("hccenter.breakdown.creditsspent",["credits"],[s==null?void 0:s.totalCreditsSpent.toString()])}),r.jsx("div",{children:f("hccenter.breakdown.paydayfactor.percent",["percent"],[((s==null?void 0:s.kickbackPercentage)*100).toString()])}),r.jsx("div",{children:f("hccenter.breakdown.streakbonus",["credits"],[s==null?void 0:s.creditRewardForStreakBonus.toString()])}),r.jsx("hr",{className:"w-100 text-black my-1"}),r.jsx("div",{children:f("hccenter.breakdown.total",["credits","actual"],[R(),(((s==null?void 0:s.kickbackPercentage)*(s==null?void 0:s.totalCreditsSpent)+(s==null?void 0:s.creditRewardForStreakBonus))*100/100).toString()])}),r.jsx("div",{className:"btn btn-link text-primary p-0",onClick:()=>ut("habbopages/"+it("hc.center")["payday.habbopage"]),children:f("hccenter.special.infolink")})]})});return r.jsxs(Ot,{className:"nitro-hc-center",children:[r.jsx(St,{headerText:f("generic.hccenter"),onCloseClick:()=>e(!1)}),r.jsxs(M,{position:"relative",className:"bg-muted p-2",children:[r.jsxs(A,{gap:1,children:[r.jsx("div",{className:"hc-logo"}),r.jsx(M,{children:r.jsx(V,{variant:"success",onClick:b=>ut("catalog/open/"+it("catalog.links")["hc.buy_hc"]),children:f(d===Sa.ACTIVE?"hccenter.btn.extend":"hccenter.btn.buy")})})]}),r.jsx(H,{position:"absolute",className:"end-0 p-4 top-0 habbo-avatar",children:r.jsx(ls,{figure:u,direction:4,scale:2})})]}),r.jsxs(pt,{children:[r.jsxs(M,{gap:2,children:[r.jsx(Ge,{badgeCode:l,className:"align-self-center flex-shrink-0 me-1"}),r.jsxs(A,{size:5,className:"streak-info",gap:0,children:[r.jsx(O,{children:f("hccenter.status."+d)}),r.jsx(O,{dangerouslySetInnerHTML:{__html:p()}})]})]}),it("hc.center")["payday.info"]&&r.jsxs(M,{alignItems:"center",children:[r.jsxs(A,{className:"rounded-start bg-primary p-2 payday-special mb-1",children:[r.jsx("h4",{className:"mb-1",children:f("hccenter.special.title")}),r.jsx("div",{children:f("hccenter.special.info")}),r.jsx("div",{className:"btn btn-link text-white p-0 mt-auto align-self-baseline",onClick:()=>ut("habbopages/"+it("hc.center")["payday.habbopage"]),children:f("hccenter.special.infolink")})]}),r.jsxs("div",{className:"payday flex-shrink-0 p-2",children:[r.jsx("h5",{className:"mb-2 ms-2",children:f("hccenter.special.time.title")}),r.jsxs("div",{className:"d-flex flex-row mb-2",children:[r.jsx("div",{className:"clock me-2"}),r.jsx("h6",{className:"mb-0 align-self-center",children:T()})]}),d===Sa.ACTIVE&&r.jsxs("div",{className:"pe-3",children:[r.jsx("h5",{className:"ms-2 mb-1 bolder",children:f("hccenter.special.amount.title")}),r.jsxs("div",{className:"d-flex flex-column",children:[r.jsx("div",{className:"w-100 text-center ms-4n",children:R()}),r.jsx(uS,{trigger:["hover","focus"],placement:"left",overlay:S,children:r.jsx("div",{className:"btn btn-link align-self-end text-primary",children:f("hccenter.breakdown.infolink")})})]})]})]})]}),it("hc.center")["gift.info"]&&r.jsxs("div",{className:"rounded bg-success p-2 d-flex flex-row mb-0",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"mb-1",children:f("hccenter.gift.title")}),r.jsx("div",{dangerouslySetInnerHTML:{__html:n>0?f("hccenter.unclaimedgifts",["unclaimedgifts"],[n.toString()]):f("hccenter.gift.info")}})]}),r.jsx("button",{className:"btn btn-primary btn-lg align-self-center ms-auto",onClick:()=>ut("catalog/open/"+it("catalog.links")["hc.hc_gifts"]),children:f(d===Sa.ACTIVE?"hccenter.btn.gifts.redeem":"hccenter.btn.gifts.view")})]}),it("hc.center")["benefits.info"]&&r.jsxs("div",{className:"benefits text-black py-2",children:[r.jsx("h5",{className:"mb-1 text-primary",children:f("hccenter.general.title")}),r.jsx("div",{className:"mb-2",dangerouslySetInnerHTML:{__html:f("hccenter.general.info")}}),r.jsx("button",{className:"btn btn-link p-0 text-primary",onClick:()=>ut("habbopages/"+it("hc.center")["benefits.habbopage"]),children:f("hccenter.general.infolink")})]})]})]})},B$=a=>{const[t,e]=_.useState(""),{activeReport:s=null,setActiveReport:i=null}=En(),n=()=>{t.length<15||i(l=>{const c=Ci.REPORT_SUMMARY;return{...l,message:t,currentStep:c}})},o=()=>{i(l=>({...l,currentStep:l.currentStep-1}))};return r.jsxs(r.Fragment,{children:[r.jsxs(A,{gap:1,children:[r.jsx(O,{fontSize:4,children:f("help.emergency.chat_report.subtitle")}),r.jsx(O,{children:f("help.cfh.input.text")})]}),r.jsx("textarea",{className:"form-control h-100",value:t,onChange:l=>e(l.target.value)}),r.jsxs(M,{gap:2,justifyContent:"between",children:[r.jsx(V,{variant:"secondary",disabled:!(s.reportType===as.BULLY||s.reportType===as.EMERGENCY),onClick:o,children:f("generic.back")}),r.jsx(V,{disabled:t.length<15,onClick:n,children:f("help.emergency.main.submit.button")})]})]})},k$=a=>{const{setActiveReport:t=null}=En(),e=()=>{t(s=>{const i=Ci.SELECT_USER,n=as.BULLY;return{...s,currentStep:i,reportType:n}})};return r.jsxs(r.Fragment,{children:[r.jsxs(A,{grow:!0,center:!0,gap:1,children:[r.jsx(O,{fontSize:3,children:f("help.main.frame.title")}),r.jsx(O,{children:f("help.main.self.description")})]}),r.jsxs(A,{gap:1,children:[r.jsx(V,{onClick:e,children:f("help.main.bully.subtitle")}),r.jsx(V,{onClick:()=>Fs(new Er(Er.CREATE_HELP_REQUEST)),disabled:!it("guides.enabled"),children:f("help.main.help.title")}),r.jsx(V,{onClick:()=>window.open("https://help.bobbahotel.it/","_blank"),children:f("help.main.self.tips.title")})]}),r.jsx(V,{variant:"link",textColor:"black"})]})},V$=a=>{const{username:t="",onAction:e=null}=a,[s,i]=_.useState(!1),n=()=>{s||(i(!0),k(new Eb(t)))};return Y($E,o=>{const l=o.getParser();l&&l.webId===q().userId&&e("close")}),r.jsxs("div",{className:"d-flex flex-column gap-4 h-100",children:[r.jsx("div",{className:"bg-muted rounded p-2 text-center",children:f("tutorial.name_change.info.confirm")}),r.jsxs("div",{className:"d-flex flex-column align-items-center gap-1 h-100",children:[r.jsx("div",{children:f("tutorial.name_change.confirm")}),r.jsx("div",{className:"fw-bold",children:t})]}),r.jsxs("div",{className:"d-flex gap-2",children:[r.jsx("button",{className:"btn btn-success w-100",disabled:s,onClick:n,children:f("generic.ok")}),r.jsx("button",{className:"btn btn-primary w-100",onClick:()=>e("close"),children:f("cancel")})]})]})},H$=a=>{const{onAction:t=null}=a;return r.jsxs("div",{className:"d-flex flex-column gap-4 h-100",children:[r.jsx("div",{className:"bg-muted rounded p-2 text-center",children:f("tutorial.name_change.info.main")}),r.jsx("div",{className:"fw-bold d-flex align-items-center justify-content-center h-100 w-100",children:f("tutorial.name_change.current",["name"],[q().userName])}),r.jsxs("div",{className:"d-flex gap-2",children:[r.jsx("button",{className:"btn btn-success w-100",onClick:()=>t("start"),children:f("tutorial.name_change.change")}),r.jsx("button",{className:"btn btn-primary w-100",onClick:()=>t("confirmation",q().userName),children:f("tutorial.name_change.keep")})]})]})},W$=0,Y$=2,z$=3,K$=4,X$=5,q$=6,Q$=a=>{const{onAction:t=null}=a,[e,s]=_.useState(""),[i,n]=_.useState(!1),[o,l]=_.useState(!1),[c,u]=_.useState(null),[h,d]=_.useState([]),g=()=>{e!==""&&(n(!1),d([]),u(null),l(!0),k(new pb(e)))},E=m=>{n(!1),d([]),u(null),s(m)};return Y(fx,m=>{l(!1);const I=m.getParser();if(I)switch(I.resultCode){case W$:n(!0);break;case Y$:u("short");break;case z$:u("long");break;case K$:u("invalid");break;case X$:d(I.nameSuggestions),u("taken");break;case q$:u("change_not_allowed")}}),r.jsxs("div",{className:"d-flex flex-column gap-3 h-100",children:[r.jsx("div",{children:f("tutorial.name_change.info.select")}),r.jsxs("div",{className:"d-flex gap-2",children:[r.jsx("input",{type:"text",className:"form-control form-control-sm",value:e,onChange:m=>E(m.target.value)}),r.jsx("button",{className:"btn btn-primary",disabled:e===""||o,onClick:g,children:f("tutorial.name_change.check")})]}),!c&&!i&&r.jsx("div",{className:"bg-muted rounded p-2 text-center",children:f("help.tutorial.name.info")}),c&&r.jsx("div",{className:"bg-danger rounded p-2 text-center text-white",children:f(`help.tutorial.name.${c}`,["name"],[e])}),i&&r.jsx("div",{className:"bg-success rounded p-2 text-center text-white",children:f("help.tutorial.name.available",["name"],[e])}),h&&r.jsx("div",{className:"d-flex flex-column gap-2",children:h.map((m,I)=>r.jsx("div",{className:"col bg-muted rounded p-1 cursor-pointer",onClick:()=>E(m),children:m},I))}),r.jsxs("div",{className:"d-flex gap-2",children:[r.jsx("button",{className:"btn btn-success w-100",disabled:!i,onClick:()=>t("confirmation",e),children:f("tutorial.name_change.pick")}),r.jsx("button",{className:"btn btn-primary w-100",onClick:()=>t("close"),children:f("cancel")})]})]})},q_="INIT",Pp="INPUT",Up="CONFIRMATION",J$=a=>{const[t,e]=_.useState(!1),[s,i]=_.useState(q_),[n,o]=_.useState(""),l=(u,h)=>{switch(u){case"start":i(Pp);break;case"confirmation":o(h),i(Up);break;case"close":o(""),e(!1);break}},c=_.useMemo(()=>{switch(s){case q_:return"tutorial.name_change.title.main";case Pp:return"tutorial.name_change.title.select";case Up:return"tutorial.name_change.title.confirm"}},[s]);return Is(m_.INIT,u=>{i(q_),e(!0)}),t?r.jsxs(Ot,{className:"nitro-change-username",children:[r.jsx(St,{headerText:f(c),onCloseClick:()=>l("close")}),r.jsxs(pt,{className:"text-black",children:[s===q_&&r.jsx(H$,{onAction:l}),s===Pp&&r.jsx(Q$,{onAction:l}),s===Up&&r.jsx(V$,{username:n,onAction:l})]})]}):null},$$=a=>{const{activeReport:t=null,setActiveReport:e=null}=En(),s=()=>{const i=[];switch(t.reportType){case as.BULLY:case as.EMERGENCY:case as.ROOM:{const n=t.roomId<=0?t.reportedChats[0].roomId:t.roomId;t.reportedChats.forEach(o=>i.push(o.webId,o.message)),k(new vv(t.message,t.cfhTopic,t.reportedUserId,n,i));break}case as.IM:t.reportedChats.forEach(n=>i.push(n.webId,n.message)),k(new Dv(t.message,t.cfhTopic,t.reportedUserId,i));break;case as.THREAD:k(new yv(t.groupId,t.threadId,t.cfhTopic,t.message));break;case as.MESSAGE:k(new Mv(t.groupId,t.threadId,t.messageId,t.cfhTopic,t.message));break;case as.PHOTO:k(new bv(t.extraData,t.roomId,t.reportedUserId,t.cfhTopic,t.roomObjectId));break}e(null)};return r.jsxs(r.Fragment,{children:[r.jsxs(A,{gap:1,children:[r.jsx(O,{fontSize:4,children:f("help.cfh.button.send")}),r.jsx(O,{children:f("help.main.summary")})]}),r.jsx(V,{variant:"success",onClick:s,children:f("guide.help.request.emergency.submit.button")})]})},Z$=a=>{const{sanctionInfo:t=null,setSanctionInfo:e=null}=En(),s=(i,n,o)=>{let l=`help.sanction.${i}`;switch(n){case"ALERT":l=l+".alert";break;case"MUTE":l=l+".mute";break;case"BAN_PERMANENT":l=l+".permban";break;default:if(l=l+".ban",o>24)return l=l+".days",f(l,["days"],[(o/24).toString()])}return f(l,["hours"],[o.toString()])};return t?r.jsxs(Ot,{className:"nitro-help",children:[r.jsx(St,{headerText:f("help.sanction.info.title"),onCloseClick:()=>e(null)}),r.jsx(pt,{className:"text-black",children:r.jsxs(_t,{children:[r.jsx(A,{center:!0,size:5,overflow:"hidden",children:r.jsx(H,{className:"index-image"})}),r.jsxs(A,{justifyContent:"between",size:7,overflow:"hidden",children:[t.sanctionReason==="cfh.reason.EMPTY"?r.jsx("div",{className:"col-12 fw-bold",children:f("help.sanction.current.none")}):r.jsxs(r.Fragment,{children:[(t.probationHoursLeft>0||t.isSanctionActive)&&r.jsx("div",{className:"col-12 fw-bold",children:f("help.sanction.probation.reminder")}),r.jsxs("div",{className:`col-12 fw-bold ${t.isSanctionNew?"text-danger":""}`,children:[f("help.sanction.last.sanction")," ",s("current",t.sanctionName,t.sanctionLengthHours)]}),r.jsxs("div",{className:"col-12",children:[f("generic.start.time")," ",t.sanctionCreationTime]}),r.jsxs("div",{className:"col-12",children:[f("generic.reason")," ",t.sanctionReason]}),r.jsxs("div",{className:"col-12",children:[f("help.sanction.probation.days.left")," ",Math.trunc(t.probationHoursLeft/24)+1]})]}),t.hasCustomMute&&!t.isSanctionActive&&r.jsx("div",{className:"col-12 fw-bold",children:f("help.sanction.custom.mute")}),t.tradeLockExpiryTime&&t.tradeLockExpiryTime.length>0&&r.jsxs("div",{className:"col-12 fw-bold",children:[f("trade.locked.until")," ",t.tradeLockExpiryTime]}),r.jsx("div",{className:"col-12",children:s("next",t.nextSanctionName,t.nextSanctionLengthHours)}),r.jsx(V,{variant:"success",onClick:i=>e(null),children:f("habbo.way.ok.button")})]})]})})]}):null},tZ=a=>{const[t,e]=_.useState([]),{activeReport:s=null,setActiveReport:i=null}=En(),{chatHistory:n=[],messengerHistory:o=[]}=dp(),l=_.useMemo(()=>{switch(s.reportType){case as.BULLY:case as.EMERGENCY:return n.filter(d=>d.type===Bn.TYPE_CHAT&&d.webId===s.reportedUserId&&d.entityType===be.USER);case as.IM:return o.filter(d=>d.webId===s.reportedUserId&&d.type===Bn.TYPE_IM)}return[]},[s,n,o]),c=d=>{e(g=>{const E=[...g],m=E.indexOf(d);return m>=0?E.splice(m,1):E.push(d),E})},u=()=>{!t||t.length<=0||i(d=>({...d,reportedChats:t,currentStep:Ci.SELECT_TOPICS}))},h=()=>{i(d=>({...d,currentStep:d.currentStep-1}))};return r.jsxs(r.Fragment,{children:[r.jsxs(A,{gap:1,children:[r.jsx(O,{fontSize:4,children:f("help.emergency.chat_report.subtitle")}),r.jsx(O,{children:f("help.emergency.chat_report.description")})]}),r.jsxs(A,{gap:1,overflow:"hidden",children:[!l||!l.length&&r.jsx(O,{children:f("help.cfh.error.no_user_data")}),l.length>0&&r.jsx(Ce,{gap:1,columnCount:1,columnMinHeight:25,overflow:"auto",children:l.map((d,g)=>r.jsx(ee,{onClick:E=>c(d),itemActive:t.indexOf(d)>=0,children:r.jsx(O,{children:d.message})},d.id))})]}),r.jsxs(M,{gap:2,justifyContent:"between",children:[r.jsx(V,{variant:"secondary",onClick:h,disabled:s.reportType===as.IM,children:f("generic.back")}),r.jsx(V,{disabled:t.length<=0,onClick:u,children:f("help.emergency.main.submit.button")})]})]})},eZ=a=>{const[t,e]=_.useState(-1),{chatHistory:s=[]}=dp(),{activeReport:i=null,setActiveReport:n=null}=En(),o=_.useMemo(()=>{const h=new Map;return s.forEach(d=>{d.type===Bn.TYPE_CHAT&&d.entityType===be.USER&&d.webId!==q().userId&&!h.has(d.webId)&&h.set(d.webId,{id:d.webId,username:d.name})}),Array.from(h.values())},[s]),l=h=>{h<=0||n(d=>({...d,reportedUserId:h,currentStep:Ci.SELECT_CHATS}))},c=h=>{e(d=>h===d?-1:h)},u=()=>{n(h=>({...h,currentStep:h.currentStep-1}))};return r.jsxs(r.Fragment,{children:[r.jsxs(A,{gap:1,children:[r.jsx(O,{fontSize:4,children:f("help.emergency.main.step.two.title")}),o.length>0&&r.jsx(O,{children:f("report.user.pick.user")})]}),r.jsxs(A,{gap:1,overflow:"hidden",children:[!o.length&&r.jsx(O,{children:f("report.user.error.nolist")}),o.length>0&&r.jsx(Ce,{columnCount:1,columnMinHeight:25,gap:1,children:o.map((h,d)=>r.jsx(ee,{onClick:g=>c(h.id),itemActive:t===h.id,children:r.jsx("span",{dangerouslySetInnerHTML:{__html:h.username}})},h.id))})]}),r.jsxs(M,{gap:2,justifyContent:"between",children:[r.jsx(V,{variant:"secondary",onClick:u,children:f("generic.back")}),r.jsx(V,{disabled:t<=0,onClick:()=>l(t),children:f("help.emergency.main.submit.button")})]})]})},sZ=a=>{const[t,e]=_.useState(-1),[s,i]=_.useState(-1),{setActiveReport:n=null}=En(),{cfhCategories:o=[]}=Ih(),l=()=>{t<0||s<0||n(u=>({...u,cfhCategory:t,cfhTopic:o[t].topics[s].id,currentStep:Ci.INPUT_REPORT_MESSAGE}))},c=()=>{n(u=>({...u,currentStep:u.currentStep-1}))};return r.jsxs(r.Fragment,{children:[r.jsxs(A,{gap:1,children:[r.jsx(O,{fontSize:4,children:f("help.emergency.chat_report.subtitle")}),r.jsx(O,{children:f("help.cfh.pick.topic")})]}),r.jsxs(A,{gap:1,overflow:"auto",children:[t<0&&o.map((u,h)=>r.jsx(V,{variant:"danger",onClick:d=>e(h),children:f(`help.cfh.reason.${u.name}`)},h)),t>=0&&o[t].topics.map((u,h)=>r.jsx(V,{variant:"danger",onClick:d=>i(h),active:s===h,children:f(`help.cfh.topic.${u.id}`)},h))]}),r.jsxs(M,{gap:2,justifyContent:"between",children:[r.jsx(V,{variant:"secondary",onClick:c,children:f("generic.back")}),r.jsx(V,{disabled:s<0,onClick:l,children:f("help.emergency.main.submit.button")})]})]})},iZ=a=>{const[t,e]=_.useState(!1),{activeReport:s=null,setActiveReport:i=null,report:n=null}=En(),o=()=>{i(null),e(!1)};_.useEffect(()=>{const c={linkReceived:u=>{const h=u.split("/");if(!(h.length<2))switch(h[1]){case"show":e(!0);return;case"hide":e(!1);return;case"toggle":e(d=>!d);return;case"tour":return;case"report":h.length>=5&&h[2]==="room"&&(parseInt(h[3]),unescape(h.splice(4).join("/")));return}},eventUrlPrefix:"help/"};return Os(c),()=>Cs(c)},[]),_.useEffect(()=>{s&&e(!0)},[s]);const l=()=>{if(s)switch(s.currentStep){case Ci.SELECT_USER:return r.jsx(eZ,{});case Ci.SELECT_CHATS:return r.jsx(tZ,{});case Ci.SELECT_TOPICS:return r.jsx(sZ,{});case Ci.INPUT_REPORT_MESSAGE:return r.jsx(B$,{});case Ci.REPORT_SUMMARY:return r.jsx($$,{})}return r.jsx(k$,{})};return r.jsxs(r.Fragment,{children:[t&&r.jsxs(Ot,{className:"nitro-help",children:[r.jsx(St,{headerText:f("help.button.cfh"),onCloseClick:o}),r.jsx(pt,{className:"text-black",children:r.jsxs(_t,{children:[r.jsx(A,{center:!0,size:5,overflow:"hidden",children:r.jsx(H,{className:"index-image"})}),r.jsx(A,{justifyContent:"between",size:7,overflow:"hidden",children:r.jsx(l,{})})]})})]}),r.jsx(Z$,{}),r.jsx(J$,{})]})},rZ=a=>{const[t,e]=_.useState(null),[s,i]=_.useState(null),[n,o]=_.useState(null),[l,c]=_.useState(null);return Y(Mx,u=>{const h=u.getParser();e(h.productType),i(h.productClassId),o(h.totalCoinsForBonus),c(h.coinsStillRequiredToBuy)}),_.useEffect(()=>{k(new yb)},[]),t?r.jsxs("div",{className:"bonus-rare widget d-flex",children:[t,r.jsxs("div",{className:"bg-light-dark rounded overflow-hidden position-relative bonus-bar-container",children:[r.jsx("div",{className:"d-flex justify-content-center align-items-center w-100 h-100 position-absolute small top-0",children:n-l+"/"+n}),r.jsx("div",{className:"small bg-info rounded position-absolute top-0 h-100",style:{width:(n-l)/n*100+"%"}})]})]}):null},nZ=a=>{const{data:t=null,level:e=0}=a;return r.jsxs("div",{className:"hof-user-container",children:[r.jsxs("div",{className:"hof-tooltip",children:[r.jsxs("div",{className:"hof-header",children:[e,". ",t.userName," ",r.jsx(Cr,{userId:t.userId})]}),r.jsx("div",{className:"small text-center text-white",children:f("landing.view.competition.hof.points",["points"],[Nf(t.currentScore).toString()])})]}),r.jsx(ls,{figure:t.figure,direction:2})]})},aZ=a=>{const{slot:t=-1,conf:e=null}=a,[s,i]=_.useState(null);return Y(aD,n=>{const o=n.getParser();i(o.data)}),_.useEffect(()=>{const n=e?e.campaign:"";k(new HL(n))},[e]),s?r.jsx("div",{className:"hall-of-fame d-flex",children:s.hof&&s.hof.length>0&&s.hof.map((n,o)=>r.jsx(nZ,{data:n,level:o+1},o))}):null},oZ=a=>{const[t,e]=_.useState(null),[s,i]=_.useState(0);return Y(JM,n=>{const o=n.getParser();e(o.articles)}),_.useEffect(()=>{k(new sL)},[]),t?r.jsxs("div",{className:"promo-articles widget mb-2",children:[r.jsxs("div",{className:"d-flex flex-row align-items-center w-100 mb-1",children:[r.jsx("small",{className:"flex-shrink-0 pe-1",children:f("landing.view.promo.article.header")}),r.jsx("hr",{className:"w-100 my-0"})]}),r.jsx("div",{className:"d-flex flex-row mb-1",children:t&&t.length>0&&t.map((n,o)=>r.jsx("div",{className:"promo-articles-bullet cursor-pointer "+(n===t[s]?"promo-articles-bullet-active":""),onClick:l=>i(o)},n.id))}),t&&t[s]&&r.jsxs("div",{className:"promo-article d-flex flex-row row mx-0",children:[r.jsx("div",{className:"promo-article-image",style:{backgroundImage:`url(${t[s].imageUrl})`}}),r.jsxs("div",{className:"col-3 d-flex flex-column h-100",children:[r.jsx("h3",{className:"my-0",children:t[s].title}),r.jsx("b",{children:t[s].bodyText}),r.jsx("button",{className:"btn btn-sm mt-auto btn-gainsboro",onClick:n=>wc(t[s].linkContent),children:t[s].buttonText})]})]})]}):null},lZ=a=>{const{conf:t=null}=a,e=s=>{const i=t[s];if(!i)return null;switch(s){case"image":return Dt.interpolate(i)}return i};return r.jsxs("div",{className:"widgetcontainer widget d-flex flex-row overflow-hidden",children:[r.jsx("div",{className:"widgetcontainer-image flex-shrink-0",style:{backgroundImage:`url(${e("image")})`}}),r.jsxs("div",{className:"d-flex flex-column align-self-center",children:[r.jsx("h3",{className:"my-0",children:f(`landing.view.${e("texts")}.header`)}),r.jsx("i",{children:f(`landing.view.${e("texts")}.body`)}),r.jsx("button",{className:"btn btn-sm btn-gainsboro align-self-start px-3 mt-auto",onClick:s=>wc(e("btnLink")),children:f(`landing.view.${e("texts")}.button`)})]})]})},cZ=a=>{switch(a.widgetType){case"promoarticle":return r.jsx(oZ,{});case"achievementcompetition_hall_of_fame":return r.jsx(aZ,{slot:a.slot,conf:a.widgetConf});case"bonusrare":return r.jsx(rZ,{});case"widgetcontainer":return r.jsx(lZ,{conf:a.widgetConf});default:return null}},Ml=a=>{const{widgetType:t=null,widgetSlot:e=0,widgetConf:s=null,className:i="",...n}=a;return r.jsx("div",{className:`widget-slot slot-${e} ${i||""}`,...n,children:r.jsx(cZ,{widgetType:t,slot:e,widgetConf:s})})},uZ=a=>{const[t,e]=_.useState(!0),{userFigure:s=null}=Oo();if(we([Mt.CREATED,Mt.ENDED],h=>{switch(h.type){case Mt.CREATED:e(!1);return;case Mt.ENDED:e(h.openLandingView);return}}),!t)return null;it("hotelview").images["background.colour"];const i=Dt.interpolate(it("hotelview").images.background),n=Dt.interpolate(it("hotelview").images.sun),o=Dt.interpolate(it("hotelview").images.drape),l=Dt.interpolate(it("hotelview").images.left),c=Dt.interpolate(it("hotelview").images["right.repeat"]),u=Dt.interpolate(it("hotelview").images.right);return r.jsxs("div",{className:"nitro-hotel-view",style:i&&i.length?{backgroundImage:`url(${i})`}:{},children:[r.jsx("div",{className:"container h-100 py-3 overflow-hidden landing-widgets",children:r.jsxs("div",{className:"row h-100",children:[r.jsxs("div",{className:"col-9 h-100 d-flex flex-column",children:[r.jsx(Ml,{widgetSlot:1,widgetType:it("hotelview").widgets["slot.1.widget"],widgetConf:it("hotelview").widgets["slot.1.conf"],className:"col-6"}),r.jsxs("div",{className:"col-12 row mx-0",children:[r.jsx(Ml,{widgetSlot:2,widgetType:it("hotelview").widgets["slot.2.widget"],widgetConf:it("hotelview").widgets["slot.2.conf"],className:"col-7"}),r.jsx(Ml,{widgetSlot:3,widgetType:it("hotelview").widgets["slot.3.widget"],widgetConf:it("hotelview").widgets["slot.3.conf"],className:"col-5"}),r.jsx(Ml,{widgetSlot:4,widgetType:it("hotelview").widgets["slot.4.widget"],widgetConf:it("hotelview").widgets["slot.4.conf"],className:"col-7"}),r.jsx(Ml,{widgetSlot:5,widgetType:it("hotelview").widgets["slot.5.widget"],widgetConf:it("hotelview").widgets["slot.5.conf"],className:"col-5"})]}),r.jsx(Ml,{widgetSlot:6,widgetType:it("hotelview").widgets["slot.6.widget"],widgetConf:it("hotelview").widgets["slot.6.conf"],className:"mt-auto"})]}),r.jsx("div",{className:"col-3 h-100",children:r.jsx(Ml,{widgetSlot:7,widgetType:it("hotelview").widgets["slot.7.widget"],widgetConf:it("hotelview").widgets["slot.7.conf"]})})]})}),r.jsx("div",{className:"sun position-absolute",style:n&&n.length?{backgroundImage:`url(${n})`}:{}}),r.jsx("div",{className:"drape position-absolute",style:o&&o.length?{backgroundImage:`url(${o})`}:{}}),r.jsx("div",{className:"left position-absolute",style:l&&l.length?{backgroundImage:`url(${l})`}:{}}),r.jsx("div",{className:"right-repeat position-absolute",style:c&&c.length?{backgroundImage:`url(${c})`}:{}}),r.jsx("div",{className:"right position-absolute",style:u&&u.length?{backgroundImage:`url(${u})`}:{}}),it("hotelview")["show.avatar"]&&r.jsx("div",{className:"avatar-image",children:r.jsx(ls,{figure:s,direction:2})})]})},WA=a=>{const{badgeCode:t=null,children:e=null,...s}=a,{selectedBadgeCode:i=null,setSelectedBadgeCode:n=null,toggleBadge:o=null,getBadgeId:l=null}=fp(),{isUnseen:c=null}=Kr(),u=c(os.BADGE,l(t));return r.jsxs(ee,{itemActive:i===t,itemUnseen:u,onMouseDown:h=>n(t),onDoubleClick:h=>o(i),...s,children:[r.jsx(Ge,{badgeCode:t}),e]})},hZ=a=>{const[t,e]=_.useState(!1),{badgeCodes:s=[],activeBadgeCodes:i=[],selectedBadgeCode:n=null,isWearingBadge:o=null,canWearBadges:l=null,toggleBadge:c=null,getBadgeId:u=null,activate:h=null,deactivate:d=null}=fp(),{isUnseen:g=null,removeUnseen:E=null}=Kr(),[m,I]=_.useState(""),[p,T]=_.useState(s);return _.useEffect(()=>{!n||!g(os.BADGE,u(n))||E(os.BADGE,u(n))},[n,g,E,u]),_.useEffect(()=>{if(!t)return;const R=h();return()=>d(R)},[t,h,d]),_.useEffect(()=>(e(!0),()=>e(!1)),[]),_.useEffect(()=>{let R=[...s];if(m&&m.length){const S=m.toLocaleLowerCase();R=s.filter(b=>{var N=gh(b);return S&&S.length&&N.toLocaleLowerCase().includes(S)?b:null})}T(R)},[s,T,m]),r.jsxs(_t,{children:[r.jsxs(A,{size:7,overflow:"hidden",children:[r.jsxs(M,{gap:1,children:[r.jsx("input",{type:"text",className:"form-control form-control-sm",placeholder:f("generic.search"),value:m,onChange:R=>I(R.target.value)}),r.jsx(V,{variant:"primary",children:r.jsx(YE,{className:"fa-icon"})})]}),r.jsx(Ce,{columnCount:4,children:p&&p.length>0&&p.map((R,S)=>o(R)?null:r.jsx(WA,{badgeCode:R},S))})]}),r.jsxs(A,{className:"justify-content-between",size:5,overflow:"auto",children:[r.jsxs(A,{overflow:"hidden",gap:2,children:[r.jsx(O,{children:f("inventory.badges.activebadges")}),r.jsx(Ce,{columnCount:3,children:i&&i.length>0&&i.map((R,S)=>r.jsx(WA,{badgeCode:R},S))})]}),!!n&&r.jsxs(A,{grow:!0,justifyContent:"end",gap:2,children:[r.jsxs(M,{alignItems:"center",gap:2,children:[r.jsx(Ge,{shrink:!0,badgeCode:n}),r.jsx(O,{children:gh(n)})]}),r.jsx(V,{variant:o(n)?"danger":"success",disabled:!o(n)&&!l(),onClick:R=>c(n),children:f(o(n)?"inventory.badges.clearbadge":"inventory.badges.wearbadge")})]})]})]})},HO=a=>{const{title:t="",desc:e="",children:s=null,...i}=a;return r.jsxs(_t,{...i,children:[r.jsx(A,{center:!0,size:5,overflow:"hidden",children:r.jsx("div",{className:"empty-image"})}),r.jsxs(A,{justifyContent:"center",size:7,overflow:"hidden",children:[r.jsx(O,{fontWeight:"bold",fontSize:5,overflow:"unset",truncate:!0,children:t}),r.jsx(O,{overflow:"auto",children:e})]}),s]})},dZ=a=>{const{botItem:t=null,children:e=null,...s}=a,[i,n]=_.useState(!1),{selectedBot:o=null,setSelectedBot:l=null}=U0(),{isUnseen:c=null}=Kr(),u=c(os.BOT,t.botData.id),h=d=>{switch(d.type){case at.MOUSE_DOWN:l(t),n(!0);return;case at.MOUSE_UP:n(!1);return;case at.ROLL_OUT:if(!i||o!==t)return;QR(t);return;case"dblclick":QR(t);return}};return r.jsxs(ee,{itemActive:o===t,itemUnseen:u,onMouseDown:h,onMouseUp:h,onMouseOut:h,onDoubleClick:h,...s,children:[r.jsx(ls,{figure:t.botData.figure,direction:3,headOnly:!0}),e]})},_Z=a=>{const{roomSession:t=null,roomPreviewer:e=null}=a,[s,i]=_.useState(!1),{botItems:n=[],selectedBot:o=null,activate:l=null,deactivate:c=null}=U0(),{isUnseen:u=null,removeUnseen:h=null}=Kr();return _.useEffect(()=>{if(!o||!e)return;const d=o.botData,g=tt();let E=g.getRoomInstanceVariable(g.activeRoomId,C.ROOM_WALL_TYPE),m=g.getRoomInstanceVariable(g.activeRoomId,C.ROOM_FLOOR_TYPE),I=g.getRoomInstanceVariable(g.activeRoomId,C.ROOM_LANDSCAPE_TYPE);E=E&&E.length?E:"101",m=m&&m.length?m:"101",I=I&&I.length?I:"1.1",e.reset(!1),e.updateRoomWallsAndFloorVisibility(!0,!0),e.updateObjectRoom(m,E,I),e.addAvatarIntoRoom(d.figure,0)},[e,o]),_.useEffect(()=>{!o||!u(os.BOT,o.botData.id)||h(os.BOT,o.botData.id)},[o,u,h]),_.useEffect(()=>{if(!s)return;const d=l();return()=>c(d)},[s,l,c]),_.useEffect(()=>(i(!0),()=>i(!1)),[]),!n||!n.length?r.jsx(HO,{title:f("inventory.empty.bots.title"),desc:f("inventory.empty.bots.desc")}):r.jsxs(_t,{children:[r.jsx(A,{size:7,overflow:"hidden",children:r.jsx(Ce,{columnCount:5,children:n&&n.length>0&&n.map(d=>r.jsx(dZ,{botItem:d},d.botData.id))})}),r.jsxs(A,{size:5,overflow:"auto",children:[r.jsx(A,{overflow:"hidden",position:"relative",children:r.jsx(op,{roomPreviewer:e,height:140})}),o&&r.jsxs(A,{grow:!0,justifyContent:"between",gap:2,children:[r.jsx(O,{grow:!0,truncate:!0,children:o.botData.name}),!!t&&r.jsx(V,{variant:"success",onClick:d=>QR(o),children:f("inventory.furni.placetoroom")})]})]})]})},gZ=a=>{const{groupItem:t=null,...e}=a,[s,i]=_.useState(!1),{selectedItem:n=null,setSelectedItem:o=null}=Bc(),l=u=>{switch(u.type){case at.MOUSE_DOWN:o(t),i(!0);return;case at.MOUSE_UP:i(!1);return;case at.ROLL_OUT:if(!s||t!==n)return;mh(t);return;case"dblclick":mh(t);return}},c=t.getUnlockedCount();return r.jsx(ee,{className:c?"":"opacity-0-5 ",itemImage:t.iconUrl,itemCount:t.getUnlockedCount(),itemActive:t===n,itemUniqueNumber:t.stuffData.uniqueNumber,itemUnseen:t.hasUnseenItems,onMouseDown:l,onMouseUp:l,onMouseOut:l,onDoubleClick:l,...e})},aj=a=>{const{groupItems:t=[],setGroupItems:e=null}=a,[s,i]=_.useState("");return _.useEffect(()=>{let n=[...t];if(s&&s.length){const o=s.toLocaleLowerCase();n=t.filter(l=>o&&o.length&&l.name.toLocaleLowerCase().includes(o)?l:null)}e(n)},[t,e,s]),r.jsxs(M,{gap:1,children:[r.jsx("input",{type:"text",className:"form-control form-control-sm",placeholder:f("generic.search"),value:s,onChange:n=>i(n.target.value)}),r.jsx(V,{variant:"primary",children:r.jsx(YE,{className:"fa-icon"})})]})},fZ=a=>{const t=a.getLastItem();if(!t||!t.sellable)return!1;Fs(new Pf(t))},mZ=a=>{const{roomSession:t=null,roomPreviewer:e=null}=a,[s,i]=_.useState(!1),[n,o]=_.useState([]),{groupItems:l=[],selectedItem:c=null,activate:u=null,deactivate:h=null}=Bc(),{resetItems:d=null}=Kr();return _.useEffect(()=>{if(!c||!e)return;const g=c.getLastItem();if(!g)return;const E=tt();let m=E.getRoomInstanceVariable(E.activeRoomId,C.ROOM_WALL_TYPE),I=E.getRoomInstanceVariable(E.activeRoomId,C.ROOM_FLOOR_TYPE),p=E.getRoomInstanceVariable(E.activeRoomId,C.ROOM_LANDSCAPE_TYPE);if(m=m&&m.length?m:"101",I=I&&I.length?I:"101",p=p&&p.length?p:"1.1",e.reset(!1),e.updateObjectRoom(I,m,p),e.updateRoomWallsAndFloorVisibility(!0,!0),g.category===vt.WALL_PAPER||g.category===vt.FLOOR||g.category===vt.LANDSCAPE){if(I=g.category===vt.FLOOR?c.stuffData.getLegacyString():I,m=g.category===vt.WALL_PAPER?c.stuffData.getLegacyString():m,p=g.category===vt.LANDSCAPE?c.stuffData.getLegacyString():p,e.updateObjectRoom(I,m,p),g.category===vt.LANDSCAPE){const T=q().getWallItemDataByName("window_double_default");T&&e.addWallItemIntoRoom(T.id,new j(90,0,0),T.customParams)}}else c.isWallItem?e.addWallItemIntoRoom(c.type,new j(90),g.stuffData.getLegacyString()):e.addFurnitureIntoRoom(c.type,new j(90),c.stuffData,g.extra.toString())},[e,c]),_.useEffect(()=>{!c||!c.hasUnseenItems||(d(os.FURNI,c.items.map(g=>g.id)),c.hasUnseenItems=!1)},[c,d]),_.useEffect(()=>{if(!s)return;const g=u();return()=>h(g)},[s,u,h]),_.useEffect(()=>(i(!0),()=>i(!1)),[]),!l||!l.length?r.jsx(HO,{title:f("inventory.empty.title"),desc:f("inventory.empty.desc")}):r.jsxs(_t,{children:[r.jsxs(A,{size:7,overflow:"hidden",children:[r.jsx(aj,{groupItems:l,setGroupItems:o}),r.jsx(Ce,{columnCount:5,children:n&&n.length>0&&n.map((g,E)=>r.jsx(gZ,{groupItem:g},E))})]}),r.jsxs(A,{size:5,overflow:"auto",children:[r.jsxs(A,{overflow:"hidden",position:"relative",children:[r.jsx(op,{roomPreviewer:e,height:140}),c&&c.stuffData.isUnique&&r.jsx(y0,{className:"top-2 end-2",position:"absolute",uniqueNumber:c.stuffData.uniqueNumber,uniqueSeries:c.stuffData.uniqueSeries}),c&&c.stuffData.rarityLevel>-1&&r.jsx(wO,{className:"top-2 end-2",position:"absolute",level:c.stuffData.rarityLevel})]}),c&&r.jsxs(A,{grow:!0,justifyContent:"between",gap:2,children:[r.jsx(O,{grow:!0,truncate:!0,children:c.name}),r.jsxs(A,{gap:1,children:[!!t&&r.jsx(V,{variant:"success",onClick:g=>mh(c),children:f("inventory.furni.placetoroom")}),c&&c.isSellable&&r.jsx(V,{onClick:g=>fZ(c),children:f("inventory.marketplace.sell")})]})]})]})]})},jp=9,EZ=a=>{const{cancelTrade:t=null}=a,[e,s]=_.useState(null),[i,n]=_.useState(null),[o,l]=_.useState(null),[c,u]=_.useState(null),[h,d]=_.useState(3),[g,E]=_.useState(1),{ownUser:m=null,otherUser:I=null,groupItems:p=[],tradeState:T=Ps.TRADING_STATE_READY,progressTrade:R=null,removeItem:S=null,setTradeState:b=null}=w0(),{simpleAlert:N=null}=He(),P=(G,K,z,et,rt)=>{if(!m||m.accepts||!m.userItems)return!1;if(m.userItems.length<jp)return!0;if(!et)return!1;let J=K.toString();return z===vt.POSTER?J=J+"poster"+rt.getLegacyString():z===vt.GUILD_FURNI?J=N7(K,rt):J=(G?"I":"S")+J,!!m.userItems.getValue(J)},B=G=>{if(!e)return;const K=e.getTradeItems(G);if(!K||!K.length)return;let z=null;const et=[];for(const J of K)et.push(J.id),z||(z=J);if(m.userItems.length+et.length<=1500)if(!z.isGroupable&&et.length)k(new BT(et.pop()));else{const J=[];for(const Ct of et)P(z.isWallItem,z.type,z.category,z.isGroupable,z.stuffData)&&J.push(Ct);J.length&&(J.length===1?k(new BT(J.pop())):k(new Qv(...J)))}else N(f("trading.items.too_many_items.desc"),Bt.DEFAULT,null,null,f("trading.items.too_many_items.title"))},F=G=>G?r.jsx(jN,{className:"text-success fa-icon"}):r.jsx(Wj,{className:"text-danger fa-icon"}),w=(G,K)=>{(isNaN(Number(G))||Number(G)<0||!G)&&(G=1),G=Math.max(Number(G),1),G=Math.min(Number(G),K),G!==g&&E(G)},U=G=>{w(g,G),B(g)};return _.useEffect(()=>{E(1)},[e]),_.useEffect(()=>{if(T!==Ps.TRADING_STATE_COUNTDOWN)return;d(3);const G=setInterval(()=>{d(K=>{const z=K-1;return z===0&&clearInterval(G),z})},1e3);return()=>clearInterval(G)},[T,b]),_.useEffect(()=>{h===0&&b(Ps.TRADING_STATE_CONFIRMING)},[h,b]),T===Ps.TRADING_STATE_READY||!m||!I?null:r.jsxs(_t,{children:[r.jsxs(A,{size:4,overflow:"hidden",children:[r.jsx(aj,{groupItems:p,setGroupItems:u}),r.jsxs(M,{column:!0,fullHeight:!0,justifyContent:"between",overflow:"hidden",gap:2,children:[r.jsx(Ce,{columnCount:3,children:c&&c.length>0&&c.map((G,K)=>{const z=G.getUnlockedCount();return r.jsx(ee,{className:z?"":"opacity-0-5 ",itemImage:G.iconUrl,itemCount:z,itemActive:e===G,itemUniqueNumber:G.stuffData.uniqueNumber,onClick:et=>z&&s(G),onDoubleClick:et=>B(1),children:z>0&&e===G&&r.jsx(V,{position:"absolute",variant:"success",className:"trade-button bottom-1 end-1",onClick:et=>B(1),children:r.jsx(Ir,{className:"fa-icon"})})},K)})}),r.jsxs(A,{gap:1,alignItems:"end",children:[r.jsxs(_t,{overflow:"hidden",children:[r.jsx(A,{size:6,overflow:"hidden",children:r.jsx("input",{type:"number",className:"form-control form-control-sm quantity-input",placeholder:f("catalog.bundlewidget.spinner.select.amount"),disabled:!e,value:g,onChange:G=>E(G.target.valueAsNumber)})}),r.jsx(A,{size:6,overflow:"hidden",children:r.jsx(V,{variant:"secondary",disabled:!e,onClick:G=>U(e.getUnlockedCount()),children:f("inventory.trading.areoffering")})})]}),r.jsx(H,{fullWidth:!0,className:"badge bg-muted",children:e?e.name:f("catalog_selectproduct")})]})]})]}),r.jsxs(A,{size:8,overflow:"hidden",children:[r.jsxs(_t,{overflow:"hidden",children:[r.jsxs(A,{size:6,overflow:"hidden",children:[r.jsxs(M,{justifyContent:"between",alignItems:"center",children:[r.jsxs(O,{children:[f("inventory.trading.you")," ",f("inventory.trading.areoffering"),":"]}),F(m.accepts)]}),r.jsx(Ce,{columnCount:3,children:Array.from(Array(jp),(G,K)=>{const z=m.userItems.getWithIndex(K)||null;return z?r.jsx(ee,{itemActive:i===z,itemImage:z.iconUrl,itemCount:z.getTotalCount(),itemUniqueNumber:z.stuffData.uniqueNumber,onClick:et=>n(z),onDoubleClick:et=>S(z),children:i===z&&r.jsx(V,{position:"absolute",variant:"danger",className:"trade-button bottom-1 start-1",onClick:et=>S(z),children:r.jsx(pr,{className:"fa-icon"})})},K):r.jsx(ee,{},K)})}),r.jsx(H,{fullWidth:!0,className:"badge bg-muted",children:i?i.name:f("catalog_selectproduct")})]}),r.jsxs(A,{size:6,overflow:"hidden",children:[r.jsxs(M,{justifyContent:"between",alignItems:"center",children:[r.jsxs(O,{children:[I.userName," ",f("inventory.trading.isoffering"),":"]}),F(I.accepts)]}),r.jsx(Ce,{columnCount:3,children:Array.from(Array(jp),(G,K)=>{const z=I.userItems.getWithIndex(K)||null;return z?r.jsx(ee,{itemActive:o===z,itemImage:z.iconUrl,itemCount:z.getTotalCount(),itemUniqueNumber:z.stuffData.uniqueNumber,onClick:et=>l(z)},K):r.jsx(ee,{},K)})}),r.jsx(H,{fullWidth:!0,className:"badge bg-muted w-100",children:o?o.name:f("catalog_selectproduct")})]})]}),r.jsxs(M,{grow:!0,justifyContent:"between",children:[r.jsx(V,{variant:"danger",onClick:t,children:f("generic.cancel")}),T===Ps.TRADING_STATE_READY&&r.jsx(V,{variant:"secondary",disabled:!m.itemCount&&!I.itemCount,onClick:R,children:f("inventory.trading.accept")}),T===Ps.TRADING_STATE_RUNNING&&r.jsx(V,{variant:"secondary",disabled:!m.itemCount&&!I.itemCount,onClick:R,children:f(m.accepts?"inventory.trading.modify":"inventory.trading.accept")}),T===Ps.TRADING_STATE_COUNTDOWN&&r.jsx(V,{variant:"secondary",disabled:!0,children:f("inventory.trading.countdown",["counter"],[h.toString()])}),T===Ps.TRADING_STATE_CONFIRMING&&r.jsx(V,{variant:"secondary",onClick:R,children:f("inventory.trading.button.restore")}),T===Ps.TRADING_STATE_CONFIRMED&&r.jsx(V,{variant:"secondary",children:f("inventory.trading.info.waiting")})]})]})]})},pZ=a=>{const{petItem:t=null,children:e=null,...s}=a,[i,n]=_.useState(!1),{selectedPet:o=null,setSelectedPet:l=null}=j0(),{isUnseen:c}=Kr(),u=c(os.PET,t.petData.id),h=d=>{switch(d.type){case at.MOUSE_DOWN:l(t),n(!0);return;case at.MOUSE_UP:n(!1);return;case at.ROLL_OUT:if(!i||t!==o)return;qR(t);return;case"dblclick":qR(t);return}};return r.jsxs(ee,{itemActive:t===o,itemUnseen:u,onMouseDown:h,onMouseUp:h,onMouseOut:h,onDoubleClick:h,...s,children:[r.jsx(Ca,{figure:t.petData.figureData.figuredata,direction:3,headOnly:!0}),e]})},IZ=a=>{const{roomSession:t=null,roomPreviewer:e=null}=a,[s,i]=_.useState(!1),{petItems:n=null,selectedPet:o=null,activate:l=null,deactivate:c=null}=j0(),{isUnseen:u=null,removeUnseen:h=null}=Kr();return _.useEffect(()=>{if(!o||!e)return;const d=o.petData,g=tt();let E=g.getRoomInstanceVariable(g.activeRoomId,C.ROOM_WALL_TYPE),m=g.getRoomInstanceVariable(g.activeRoomId,C.ROOM_FLOOR_TYPE),I=g.getRoomInstanceVariable(g.activeRoomId,C.ROOM_LANDSCAPE_TYPE);E=E&&E.length?E:"101",m=m&&m.length?m:"101",I=I&&I.length?I:"1.1",e.reset(!1),e.updateRoomWallsAndFloorVisibility(!0,!0),e.updateObjectRoom(m,E,I),e.addPetIntoRoom(d.figureString)},[e,o]),_.useEffect(()=>{!o||!u(os.PET,o.petData.id)||h(os.PET,o.petData.id)},[o,u,h]),_.useEffect(()=>{if(!s)return;const d=l();return()=>c(d)},[s,l,c]),_.useEffect(()=>(i(!0),()=>i(!1)),[]),!n||!n.length?r.jsx(HO,{title:f("inventory.empty.pets.title"),desc:f("inventory.empty.pets.desc")}):r.jsxs(_t,{children:[r.jsx(A,{size:7,overflow:"hidden",children:r.jsx(Ce,{columnCount:5,children:n&&n.length>0&&n.map(d=>r.jsx(pZ,{petItem:d},d.petData.id))})}),r.jsxs(A,{size:5,overflow:"auto",children:[r.jsx(A,{overflow:"hidden",position:"relative",children:r.jsx(op,{roomPreviewer:e,height:140})}),o&&o.petData&&r.jsxs(A,{grow:!0,justifyContent:"between",gap:2,children:[r.jsx(O,{grow:!0,truncate:!0,children:o.petData.name}),!!t&&r.jsx(V,{variant:"success",onClick:d=>qR(o),children:f("inventory.furni.placetoroom")})]})]})]})},oj="inventory.furni",lj="inventory.bots",cj="inventory.furni.tab.pets",uj="inventory.badges",YA=[oj,lj,cj,uj],TZ=[os.FURNI,os.BOT,os.PET,os.BADGE],RZ=a=>{const[t,e]=_.useState(!1),[s,i]=_.useState(YA[0]),[n,o]=_.useState(null),[l,c]=_.useState(null),{isTrading:u=!1,stopTrading:h=null}=w0(),{getCount:d=null,resetCategory:g=null}=Kr(),E=()=>{u&&h(),e(!1)};return ne(Rt.PLACED,m=>{S7()&&(O_(!1),m.placedInRoom||e(!0))}),we([Mt.CREATED,Mt.ENDED],m=>{switch(m.type){case Mt.CREATED:o(m.session);return;case Mt.ENDED:o(null),e(!1);return}}),Y(wS,m=>{const I=m.getParser();for(const p of I.data)a0().setBadgePointLimit(p.badgeId,p.limit)}),_.useEffect(()=>{const m={linkReceived:I=>{const p=I.split("/");if(!(p.length<2))switch(p[1]){case"show":e(!0);return;case"hide":e(!1);return;case"toggle":e(T=>!T);return}},eventUrlPrefix:"inventory/"};return Os(m),()=>Cs(m)},[]),_.useEffect(()=>(c(new dh(tt(),++dh.PREVIEW_COUNTER)),()=>{c(m=>(m.dispose(),null))}),[]),_.useEffect(()=>{!t&&u&&e(!0)},[t,u]),t?r.jsxs(Ot,{uniqueKey:"inventory",className:"nitro-inventory",theme:u?"primary-slim":"",children:[r.jsx(St,{headerText:f("inventory.title"),onCloseClick:E}),!u&&r.jsxs(r.Fragment,{children:[r.jsx(Ro,{children:YA.map((m,I)=>r.jsx(Wn,{isActive:s===m,onClick:p=>i(m),count:d(TZ[I]),children:f(m)},I))}),r.jsxs(pt,{children:[s===oj&&r.jsx(mZ,{roomSession:n,roomPreviewer:l}),s===lj&&r.jsx(_Z,{roomSession:n,roomPreviewer:l}),s===cj&&r.jsx(IZ,{roomSession:n,roomPreviewer:l}),s===uj&&r.jsx(hZ,{})]})]}),u&&r.jsx(pt,{children:r.jsx(EZ,{cancelTrade:E})})]}):null},WO=a=>{const{records:t=null}=a,{openRoomInfo:e=null}=Ih(),s=_.useMemo(()=>{const n=[];return t.forEach(o=>{n.push({isRoomInfo:!0,roomId:o.roomId,roomName:o.roomName}),o.chatlog.forEach(l=>{n.push({timestamp:l.timestamp,habboId:l.userId,username:l.userName,hasHighlighting:l.hasHighlighting,message:l.message,isRoomInfo:!1})})}),n},[t]),i=n=>r.jsxs(M,{gap:2,alignItems:"center",justifyContent:"between",className:"bg-muted rounded p-1",children:[r.jsxs(M,{gap:1,children:[r.jsx(O,{bold:!0,children:"Nome stanza:"}),r.jsx(O,{children:n.roomName})]}),r.jsxs(M,{gap:1,children:[r.jsx(V,{onClick:o=>Yr(n.roomId),children:"Visita stanza"}),r.jsx(V,{onClick:o=>e(n.roomId),children:"Strumenti stanza"})]})]});return r.jsx(r.Fragment,{children:r.jsxs(A,{fit:!0,gap:0,overflow:"hidden",children:[r.jsx(A,{gap:2,children:r.jsxs(_t,{gap:1,className:"text-black fw-bold border-bottom pb-1",children:[r.jsx(H,{className:"g-col-2",children:"Ora"}),r.jsx(H,{className:"g-col-3",children:"Utente"}),r.jsx(H,{className:"g-col-7",children:"Messaggio"})]})}),t&&t.length>0&&r.jsx(cp,{rows:s,rowRender:n=>{var o="log-entry py-1 border-bottom";return n.hasHighlighting&&(o+=" bg-warning"),r.jsxs(r.Fragment,{children:[n.isRoomInfo&&r.jsx(i,{roomId:n.roomId,roomName:n.roomName}),!n.isRoomInfo&&r.jsxs(_t,{fullHeight:!1,gap:1,alignItems:"center",className:o,children:[r.jsx(O,{className:"g-col-2",children:n.timestamp}),r.jsx(O,{className:"g-col-3",bold:!0,underline:!0,pointer:!0,onClick:l=>ut(`mod-tools/open-user-info/${n.habboId}`),children:n.username}),r.jsx(O,{textBreak:!0,wrap:!0,className:"g-col-7",children:n.message})]})]})}})]})})},SZ=a=>{const{roomId:t=null,onCloseClick:e=null}=a,[s,i]=_.useState(null);return Y(fy,n=>{const o=n.getParser();!o||o.data.roomId!==t||i(o.data)}),_.useEffect(()=>{k(new _L(t))},[t]),s?r.jsxs(Ot,{className:"nitro-mod-tools-chatlog",windowPosition:ri.TOP_LEFT,children:[r.jsx(St,{headerText:`Chatlog stanza: ${s.roomName}`,onCloseClick:e}),r.jsx(pt,{className:"text-black",overflow:"hidden",children:s&&r.jsx(WO,{records:[s]})})]}):null},OZ=a=>{const{roomId:t=null,onCloseClick:e=null}=a,[s,i]=_.useState(!1),[n,o]=_.useState(null),[l,c]=_.useState(null),[u,h]=_.useState(null),[d,g]=_.useState(null),[E,m]=_.useState(!1),[I,p]=_.useState(0),[T,R]=_.useState(!1),[S,b]=_.useState(!1),[N,P]=_.useState(!1),[B,F]=_.useState(""),w=(U,G)=>{if(U)switch(U){case"alert_only":if(B.trim().length===0)return;k(new hc(hc.ACTION_ALERT,B,"")),k(new VT(t,S?1:0,N?1:0,T?1:0));return;case"send_message":if(B.trim().length===0)return;k(new hc(hc.ACTION_MESSAGE,B,"")),k(new VT(t,S?1:0,N?1:0,T?1:0));return}};return Y(dy,U=>{const G=U.getParser();!G||G.data.flatId!==t||(o(G.data.flatId),c(G.data.room.name),h(G.data.ownerId),g(G.data.ownerName),m(G.data.ownerInRoom),p(G.data.userCount))}),_.useEffect(()=>{s||(k(new hL(t)),i(!0))},[t,s,i]),r.jsxs(Ot,{className:"nitro-mod-tools-room",windowPosition:ri.TOP_LEFT,children:[r.jsx(St,{headerText:"Info stanza",onCloseClick:U=>e()}),r.jsxs(pt,{className:"text-black",children:[r.jsxs(M,{gap:2,children:[r.jsxs(A,{justifyContent:"center",grow:!0,gap:1,children:[r.jsxs(M,{alignItems:"center",gap:2,children:[r.jsx(O,{bold:!0,align:"end",className:"col-7",children:"Nome stanza:"}),r.jsx(O,{underline:!0,pointer:!0,truncate:!0,children:l})]}),r.jsxs(M,{alignItems:"center",gap:2,children:[r.jsx(O,{bold:!0,align:"end",className:"col-7",children:"Proprietario:"}),r.jsx(O,{underline:!0,pointer:!0,truncate:!0,children:d})]}),r.jsxs(M,{alignItems:"center",gap:2,children:[r.jsx(O,{bold:!0,align:"end",className:"col-7",children:"Utenti in stanza:"}),r.jsx(O,{children:I})]}),r.jsxs(M,{alignItems:"center",gap:2,children:[r.jsx(O,{bold:!0,align:"end",className:"col-7",children:"Proprietario in stanza:"}),r.jsx(O,{children:E?"Si":"No"})]})]}),r.jsxs(A,{gap:1,children:[r.jsx(V,{onClick:U=>Yr(t),children:"Visita stanza"}),r.jsx(V,{onClick:U=>ut(`mod-tools/open-room-chatlog/${t}`),children:"Chatlog"})]})]}),r.jsxs(A,{className:"bg-muted rounded p-2",gap:1,children:[r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"checkbox",checked:T,onChange:U=>R(U.target.checked)}),r.jsx(O,{small:!0,children:"Caccia tutti gli utenti"})]}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"checkbox",checked:S,onChange:U=>b(U.target.checked)}),r.jsx(O,{small:!0,children:"Abilita il campanello"})]}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"checkbox",checked:N,onChange:U=>P(U.target.checked)}),r.jsx(O,{small:!0,children:'Cambia nome stanza come "inappropriato"'})]})]}),r.jsx("textarea",{className:"form-control",placeholder:"Scrivi un messaggio da inviare agli utenti in stanza...",value:B,onChange:U=>F(U.target.value)}),r.jsxs(M,{justifyContent:"between",children:[r.jsx(V,{variant:"danger",onClick:U=>w("send_message"),children:"Invia sanzione"}),r.jsx(V,{onClick:U=>w("alert_only"),children:"Invia alert"})]})]})]})},CZ=a=>{const{onCloseClick:t=null,issueId:e=null}=a,[s,i]=_.useState(null);return Y(ry,n=>{const o=n.getParser();!o||o.data.issueId!==e||i(o.data)}),_.useEffect(()=>{k(new uL(e))},[e]),r.jsxs(Ot,{className:"nitro-mod-tools-chatlog",children:[r.jsx(St,{headerText:"Issue Chatlog",onCloseClick:t}),r.jsx(pt,{className:"text-black",children:s&&r.jsx(WO,{records:[s.chatRecord]})})]})},AZ=a=>{const{issueId:t=null,onIssueInfoClosed:e=null}=a,[s,i]=_.useState(!1),{tickets:n=[],openUserInfo:o=null}=Ih(),l=n.find(h=>h.issueId===t),c=h=>{k(new eO([h])),e(h)},u=h=>{k(new uc([t],h)),e(t)};return r.jsxs(r.Fragment,{children:[r.jsxs(Ot,{className:"nitro-mod-tools-handle-issue",children:[r.jsx(St,{headerText:"Resolving issue "+t,onCloseClick:()=>e(t)}),r.jsxs(pt,{className:"text-black",children:[r.jsx(O,{fontSize:4,children:"Issue Information"}),r.jsxs(_t,{overflow:"auto",children:[r.jsx(A,{size:8,children:r.jsx("table",{className:"table table-striped table-sm table-text-small text-black m-0",children:r.jsxs("tbody",{children:[r.jsxs("tr",{children:[r.jsx("th",{children:"Source"}),r.jsx("td",{children:$7(l.categoryId)})]}),r.jsxs("tr",{children:[r.jsx("th",{children:"Category"}),r.jsx("td",{className:"text-break",children:f("help.cfh.topic."+l.reportedCategoryId)})]}),r.jsxs("tr",{children:[r.jsx("th",{children:"Description"}),r.jsx("td",{className:"text-break",children:l.message})]}),r.jsxs("tr",{children:[r.jsx("th",{children:"Caller"}),r.jsx("td",{children:r.jsx(O,{bold:!0,underline:!0,pointer:!0,onClick:h=>o(l.reporterUserId),children:l.reporterUserName})})]}),r.jsxs("tr",{children:[r.jsx("th",{children:"Reported User"}),r.jsx("td",{children:r.jsx(O,{bold:!0,underline:!0,pointer:!0,onClick:h=>o(l.reportedUserId),children:l.reportedUserName})})]})]})})}),r.jsxs(A,{size:4,gap:1,children:[r.jsx(V,{variant:"secondary",onClick:()=>i(!s),children:"Chatlog"}),r.jsx(V,{onClick:h=>u(uc.RESOLUTION_USELESS),children:"Close as useless"}),r.jsx(V,{variant:"danger",onClick:h=>u(uc.RESOLUTION_ABUSIVE),children:"Close as abusive"}),r.jsx(V,{variant:"success",onClick:h=>u(uc.RESOLUTION_RESOLVED),children:"Close as resolved"}),r.jsx(V,{variant:"secondary",onClick:h=>c(t),children:"Release"})]})]})]})]}),s&&r.jsx(CZ,{issueId:t,onCloseClick:()=>i(!1)})]})},NZ=a=>{const{myIssues:t=null,handleIssue:e=null}=a;return r.jsxs(A,{gap:0,overflow:"hidden",children:[r.jsx(A,{gap:2,children:r.jsxs(_t,{gap:1,className:"text-black fw-bold border-bottom pb-1",children:[r.jsx(H,{className:"g-col-2",children:"Categoria"}),r.jsx(H,{className:"g-col-3",children:"Stanza/Player"}),r.jsx(H,{className:"g-col-3",children:"Ora"}),r.jsx(H,{className:"g-col-2"}),r.jsx(H,{className:"g-col-2"})]})}),r.jsx(A,{overflow:"auto",className:"striped-children",gap:0,children:t&&t.length>0&&t.map(s=>r.jsxs(_t,{gap:1,alignItems:"center",className:"text-black py-1 border-bottom",children:[r.jsx(H,{className:"g-col-2",children:s.categoryId}),r.jsx(H,{className:"g-col-3",children:s.reportedUserName}),r.jsx(H,{className:"g-col-3",children:new Date(s.issueAgeInMilliseconds*1e3).toLocaleTimeString()}),r.jsx(H,{className:"g-col-2",children:r.jsx(V,{variant:"primary",onClick:i=>e(s.issueId),children:"Gestisci"})}),r.jsx(H,{className:"g-col-2",children:r.jsx(V,{variant:"danger",onClick:i=>k(new eO([s.issueId])),children:"Rilascia"})})]},s.issueId))})]})},xZ=a=>{const{openIssues:t=null}=a;return r.jsxs(A,{gap:0,overflow:"hidden",children:[r.jsx(A,{gap:2,children:r.jsxs(_t,{gap:1,className:"text-black fw-bold border-bottom pb-1",children:[r.jsx(H,{className:"g-col-2",children:"Categoria"}),r.jsx(H,{className:"g-col-3",children:"Stanza/Player"}),r.jsx(H,{className:"g-col-4",children:"Ora"}),r.jsx(H,{className:"g-col-3"})]})}),r.jsx(A,{overflow:"auto",className:"striped-children",gap:0,children:t&&t.length>0&&t.map(e=>r.jsxs(_t,{gap:1,alignItems:"center",className:"text-black py-1 border-bottom",children:[r.jsx(H,{className:"g-col-2",children:e.categoryId}),r.jsx(H,{className:"g-col-3",children:e.reportedUserName}),r.jsx(H,{className:"g-col-4",children:new Date(e.issueAgeInMilliseconds*1e3).toLocaleTimeString()}),r.jsx(H,{className:"g-col-3",children:r.jsx(V,{variant:"success",onClick:s=>k(new TL([e.issueId],!1,0,"pick issue button")),children:"Prendi in carico"})})]},e.issueId))})]})},MZ=a=>{const{pickedIssues:t=null}=a;return r.jsxs(A,{gap:0,overflow:"hidden",children:[r.jsx(A,{gap:2,children:r.jsxs(_t,{gap:1,className:"text-black fw-bold border-bottom pb-1",children:[r.jsx(H,{className:"g-col-2",children:"Categoria"}),r.jsx(H,{className:"g-col-3",children:"Stanza/Player"}),r.jsx(H,{className:"g-col-4",children:"Ora"}),r.jsx(H,{className:"g-col-3",children:"Gestore"})]})}),r.jsx(A,{overflow:"auto",className:"striped-children",gap:0,children:t&&t.length>0&&t.map(e=>r.jsxs(_t,{gap:1,alignItems:"center",className:"text-black py-1 border-bottom",children:[r.jsx(H,{className:"g-col-2",children:e.categoryId}),r.jsx(H,{className:"g-col-3",children:e.reportedUserName}),r.jsx(H,{className:"g-col-4",children:new Date(e.issueAgeInMilliseconds*1e3).toLocaleTimeString()}),r.jsx(H,{className:"g-col-3",children:e.pickerUserName})]},e.issueId))})]})},yZ=["Richieste aperte","Mie richieste","Richieste in carico"],DZ=a=>{const{onCloseClick:t=null}=a,[e,s]=_.useState(0),[i,n]=_.useState([]),{tickets:o=[]}=Ih(),l=o.filter(E=>E.state===Ec.STATE_OPEN),c=o.filter(E=>E.state===Ec.STATE_PICKED&&E.pickerUserId===q().userId),u=o.filter(E=>E.state===Ec.STATE_PICKED),h=E=>{n(m=>{const I=[...m],p=I.indexOf(E);return p>=0&&I.splice(p,1),I})},d=E=>{n(m=>{const I=[...m],p=I.indexOf(E);return p===-1?I.push(E):I.splice(p,1),I})},g=()=>{switch(e){case 0:return r.jsx(xZ,{openIssues:l});case 1:return r.jsx(NZ,{myIssues:c,handleIssue:d});case 2:return r.jsx(MZ,{pickedIssues:u})}return null};return r.jsxs(r.Fragment,{children:[r.jsxs(Ot,{className:"nitro-mod-tools-tickets",children:[r.jsx(St,{headerText:"Richieste di aiuto",onCloseClick:t}),r.jsx(Ro,{children:yZ.map((E,m)=>r.jsx(Wn,{isActive:e===m,onClick:I=>s(m),children:E},m))}),r.jsx(pt,{gap:1,children:r.jsx(g,{})})]}),i&&i.length>0&&i.map(E=>r.jsx(AZ,{issueId:E,onIssueInfoClosed:h},E))]})},bZ=a=>{const{userId:t=null,onCloseClick:e=null}=a,[s,i]=_.useState(null),[n,o]=_.useState(null);return Y(py,l=>{const c=l.getParser();!c||c.data.userId!==t||(o(c.data.username),i(c.data.roomChatlogs))}),_.useEffect(()=>{k(new fL(t))},[t]),r.jsxs(Ot,{className:"nitro-mod-tools-chatlog",windowPosition:ri.TOP_LEFT,children:[r.jsx(St,{headerText:`User Chatlog: ${n||""}`,onCloseClick:e}),r.jsx(pt,{className:"text-black h-100",children:s&&r.jsx(WO,{records:s})})]})},zA=[new Pe(1,"Alert",Pe.ALERT,1,0),new Pe(2,"Mute 1h",Pe.MUTE,2,0),new Pe(3,"Ban 18h",Pe.BAN,3,0),new Pe(4,"Ban 7 days",Pe.BAN,4,0),new Pe(5,"Ban 30 days (step 1)",Pe.BAN,5,0),new Pe(7,"Ban 30 days (step 2)",Pe.BAN,7,0),new Pe(6,"Ban 100 years",Pe.BAN,6,0),new Pe(106,"Ban avatar-only 100 years",Pe.BAN,6,0),new Pe(101,"Kick",Pe.KICK,0,0),new Pe(102,"Lock trade 1 week",Pe.TRADE_LOCK,0,168),new Pe(104,"Lock trade permanent",Pe.TRADE_LOCK,0,876e3),new Pe(105,"Message",Pe.MESSAGE,0,0)],vZ=a=>{const{user:t=null,onCloseClick:e=null}=a,[s,i]=_.useState(-1),[n,o]=_.useState(-1),[l,c]=_.useState(""),{cfhCategories:u=null,settings:h=null}=Ih(),{simpleAlert:d=null}=He(),g=_.useMemo(()=>{const p=[];if(u&&u.length)for(const T of u)for(const R of T.topics)p.push(R);return p},[u]),E=p=>d(p,Bt.DEFAULT,null,null,"Error"),m=()=>{let p=null;const T=g[s];if(s===-1&&(p="You must select a CFH topic"),p)return E(p);const R=l.trim().length===0?f(`help.cfh.topic.${T.id}`):l;k(new cL(t.userId,s,R)),e()},I=()=>{let p=null;const T=g[s],R=zA[n];if(s===-1||n===-1?p="You must select a CFH topic and Sanction":!h||!h.cfhPermission?p="You do not have permission to do this":T?R||(p="You must select a sanction"):p="You must select a CFH topic",p){E(p);return}const S=l.trim().length===0?f(`help.cfh.topic.${T.id}`):l;switch(R.actionType){case Pe.ALERT:{if(!h.alertPermission){E("You have insufficient permissions");return}k(new mL(t.userId,S,T.id));break}case Pe.MUTE:k(new pL(t.userId,S,T.id));break;case Pe.BAN:{if(!h.banPermission){E("You have insufficient permissions");return}k(new va(t.userId,S,T.id,n,R.actionId===106));break}case Pe.KICK:{if(!h.kickPermission){E("You have insufficient permissions");return}k(new EL(t.userId,S,T.id));break}case Pe.TRADE_LOCK:{const b=R.actionLengthHours*60;k(new IL(t.userId,S,b,T.id));break}case Pe.MESSAGE:{if(l.trim().length===0){E("Please write a message to user");return}k(new tO(t.userId,l,T.id));break}}e()};return t?r.jsxs(Ot,{className:"nitro-mod-tools-user-action",windowPosition:ri.TOP_LEFT,children:[r.jsx(St,{headerText:"Mod Action: "+(t?t.username:""),onCloseClick:()=>e()}),r.jsxs(pt,{className:"text-black",children:[r.jsxs("select",{className:"form-select form-select-sm",value:s,onChange:p=>i(parseInt(p.target.value)),children:[r.jsx("option",{value:-1,disabled:!0,children:"CFH Topic"}),g.map((p,T)=>r.jsx("option",{value:T,children:f("help.cfh.topic."+p.id)},T))]}),r.jsxs("select",{className:"form-select form-select-sm",value:n,onChange:p=>o(parseInt(p.target.value)),children:[r.jsx("option",{value:-1,disabled:!0,children:"Sanction Type"}),zA.map((p,T)=>r.jsx("option",{value:T,children:p.name},T))]}),r.jsxs(A,{gap:1,children:[r.jsx(O,{small:!0,children:"Optional message type, overrides default"}),r.jsx("textarea",{className:"form-control",value:l,onChange:p=>c(p.target.value)})]}),r.jsxs(M,{justifyContent:"between",gap:1,children:[r.jsx(V,{variant:"primary",onClick:m,children:"Default Sanction"}),r.jsx(V,{variant:"success",onClick:I,children:"Sanction"})]})]})]}):null},LZ=a=>{const{userId:t=null,onCloseClick:e=null}=a,[s,i]=_.useState(null);return Y(my,n=>{const o=n.getParser();o.data.userId===t&&i(o.data)}),_.useEffect(()=>{k(new gL(t))},[t]),t?r.jsxs(Ot,{className:"nitro-mod-tools-user-visits",windowPosition:ri.TOP_LEFT,children:[r.jsx(St,{headerText:"User Visits",onCloseClick:e}),r.jsx(pt,{className:"text-black",gap:1,children:r.jsxs(A,{fullHeight:!0,gap:0,overflow:"hidden",children:[r.jsx(A,{gap:2,children:r.jsxs(_t,{gap:1,className:"text-black fw-bold border-bottom pb-1",children:[r.jsx(H,{className:"g-col-2",children:"Time"}),r.jsx(H,{className:"g-col-7",children:"Room name"}),r.jsx(H,{className:"g-col-3",children:"Visit"})]})}),r.jsx(cp,{rows:(s==null?void 0:s.rooms)??[],rowRender:n=>r.jsxs(_t,{fullHeight:!1,gap:1,alignItems:"center",className:"text-black py-1 border-bottom",children:[r.jsxs(O,{className:"g-col-2",children:[n.enterHour.toString().padStart(2,"0"),": ",n.enterMinute.toString().padStart(2,"0")]}),r.jsx(O,{className:"g-col-7",children:n.roomName}),r.jsx(O,{bold:!0,underline:!0,pointer:!0,variant:"primary",className:"g-col-3",onClick:o=>Yr(n.roomId),children:"Visit Room"})]})})]})})]}):null},PZ=a=>{const{user:t=null,onCloseClick:e=null}=a,[s,i]=_.useState(""),{simpleAlert:n=null}=He();if(!t)return null;const o=()=>{if(s.trim().length===0){n("Please write a message to user.",null,null,null,"Error",null);return}k(new tO(t.userId,s,-999)),e()};return r.jsxs(Ot,{className:"nitro-mod-tools-user-message",windowPosition:ri.TOP_LEFT,children:[r.jsx(St,{headerText:"Send Message",onCloseClick:()=>e()}),r.jsxs(pt,{className:"text-black",children:[r.jsxs(O,{children:["Message To: ",t.username]}),r.jsx("textarea",{className:"form-control",value:s,onChange:l=>i(l.target.value)}),r.jsx(V,{fullWidth:!0,onClick:o,children:"Send message"})]})]})},UZ=a=>{const{onCloseClick:t=null,userId:e=null}=a,[s,i]=_.useState(null),[n,o]=_.useState(!1),[l,c]=_.useState(!1),[u,h]=_.useState(!1),d=_.useMemo(()=>s?[{localeKey:"modtools.userinfo.userName",value:s.userName,showOnline:!0},{localeKey:"modtools.userinfo.cfhCount",value:s.cfhCount.toString()},{localeKey:"modtools.userinfo.abusiveCfhCount",value:s.abusiveCfhCount.toString()},{localeKey:"modtools.userinfo.cautionCount",value:s.cautionCount.toString()},{localeKey:"modtools.userinfo.banCount",value:s.banCount.toString()},{localeKey:"modtools.userinfo.lastSanctionTime",value:s.lastSanctionTime},{localeKey:"modtools.userinfo.tradingLockCount",value:s.tradingLockCount.toString()},{localeKey:"modtools.userinfo.tradingExpiryDate",value:s.tradingExpiryDate},{localeKey:"modtools.userinfo.minutesSinceLastLogin",value:Vr.format(s.minutesSinceLastLogin*60,".ago",2)},{localeKey:"modtools.userinfo.lastPurchaseDate",value:s.lastPurchaseDate},{localeKey:"modtools.userinfo.identityRelatedBanCount",value:s.identityRelatedBanCount.toString()},{localeKey:"modtools.userinfo.registrationAgeInMinutes",value:Vr.format(s.registrationAgeInMinutes*60,".ago",2)},{localeKey:"modtools.userinfo.userClassification",value:s.userClassification}]:null,[s]);return Y(gy,g=>{const E=g.getParser();!E||E.data.userId!==e||i(E.data)}),_.useEffect(()=>{k(new dL(e))},[e]),s?r.jsxs(r.Fragment,{children:[r.jsxs(Ot,{className:"nitro-mod-tools-user",windowPosition:ri.TOP_LEFT,children:[r.jsx(St,{headerText:f("modtools.userinfo.title",["username"],[s.userName]),onCloseClick:()=>t()}),r.jsx(pt,{className:"text-black",children:r.jsxs(_t,{overflow:"hidden",children:[r.jsx(A,{size:8,overflow:"auto",children:r.jsx("table",{className:"table table-striped table-sm table-text-small text-black m-0",children:r.jsx("tbody",{children:d.map((g,E)=>r.jsxs("tr",{children:[r.jsx("th",{scope:"row",children:f(g.localeKey)}),r.jsxs("td",{children:[g.value,g.showOnline&&r.jsx("i",{className:`icon icon-pf-${s.online?"online":"offline"} ms-2`})]})]},E))})})}),r.jsxs(A,{size:4,gap:1,children:[r.jsx(V,{onClick:g=>ut(`mod-tools/open-user-chatlog/${e}`),children:"Chatlog utente"}),r.jsx(V,{onClick:g=>o(!n),children:"Invia alert"}),r.jsx(V,{onClick:g=>h(!u),children:"Stanze visitate"}),r.jsx(V,{onClick:g=>c(!l),children:"Azioni moderatore"})]})]})})]}),n&&r.jsx(PZ,{user:{userId:e,username:s.userName},onCloseClick:()=>o(!1)}),l&&r.jsx(vZ,{user:{userId:e,username:s.userName},onCloseClick:()=>c(!1)}),u&&r.jsx(LZ,{userId:e,onCloseClick:()=>h(!1)})]}):null},jZ=a=>{const[t,e]=_.useState(!1),[s,i]=_.useState(-1),[n,o]=_.useState(null),[l,c]=_.useState(!1),{openRooms:u=[],openRoomChatlogs:h=[],openUserChatlogs:d=[],openUserInfos:g=[],openRoomInfo:E=null,closeRoomInfo:m=null,toggleRoomInfo:I=null,openRoomChatlog:p=null,closeRoomChatlog:T=null,toggleRoomChatlog:R=null,openUserInfo:S=null,closeUserInfo:b=null,toggleUserInfo:N=null,openUserChatlog:P=null,closeUserChatlog:B=null,toggleUserChatlog:F=null}=Ih(),w=_.useRef(null);return ne([te.INITIALIZED,te.DISPOSED],U=>{if(!wn.isRoomPreviewerId(U.roomId))switch(U.type){case te.INITIALIZED:i(U.roomId);return;case te.DISPOSED:i(-1);return}}),FO(U=>{if(U.category!==W.UNIT)return;const G=ie();if(!G)return;const K=G.userDataManager.getUserDataByIndex(U.id);!K||K.type!==be.USER||o({userId:K.webID,username:K.name})}),_.useEffect(()=>{const U={linkReceived:G=>{const K=G.split("/");if(!(K.length<2))switch(K[1]){case"show":e(!0);return;case"hide":e(!1);return;case"toggle":e(z=>!z);return;case"open-room-info":E(Number(K[2]));return;case"close-room-info":m(Number(K[2]));return;case"toggle-room-info":I(Number(K[2]));return;case"open-room-chatlog":p(Number(K[2]));return;case"close-room-chatlog":T(Number(K[2]));return;case"toggle-room-chatlog":R(Number(K[2]));return;case"open-user-info":S(Number(K[2]));return;case"close-user-info":b(Number(K[2]));return;case"toggle-user-info":N(Number(K[2]));return;case"open-user-chatlog":P(Number(K[2]));return;case"close-user-chatlog":B(Number(K[2]));return;case"toggle-user-chatlog":F(Number(K[2]));return}},eventUrlPrefix:"mod-tools/"};return Os(U),()=>Cs(U)},[E,m,I,p,T,R,S,b,N,P,B,F]),r.jsxs(r.Fragment,{children:[t&&r.jsxs(Ot,{uniqueKey:"mod-tools",className:"nitro-mod-tools",windowPosition:ri.TOP_LEFT,children:[r.jsx(St,{headerText:"Mod Tools",onCloseClick:U=>e(!1)}),r.jsxs(pt,{className:"text-black",gap:1,children:[r.jsxs(V,{gap:1,onClick:U=>ut(`mod-tools/toggle-room-info/${s}`),disabled:s<=0,className:"position-relative",children:[r.jsx(H,{className:"icon icon-small-room position-absolute start-1"})," Strumenti stanza"]}),r.jsxs(V,{innerRef:w,gap:1,onClick:U=>ut(`mod-tools/toggle-room-chatlog/${s}`),disabled:s<=0,className:"position-relative",children:[r.jsx(H,{className:"icon icon-chat-history position-absolute start-1"})," Chatlog stanza"]}),r.jsxs(V,{gap:1,onClick:()=>ut(`mod-tools/toggle-user-info/${n.userId}`),disabled:!n,className:"position-relative",children:[r.jsx(H,{className:"icon icon-user position-absolute start-1"})," Info Utente: ",n?n.username:""]}),r.jsxs(V,{gap:1,onClick:()=>c(U=>!U),className:"position-relative",children:[r.jsx(H,{className:"icon icon-tickets position-absolute start-1"})," Richieste di aiuto"]})]})]}),u.length>0&&u.map(U=>r.jsx(OZ,{roomId:U,onCloseClick:()=>ut(`mod-tools/close-room-info/${U}`)},U)),h.length>0&&h.map(U=>r.jsx(SZ,{roomId:U,onCloseClick:()=>ut(`mod-tools/close-room-chatlog/${U}`)},U)),g.length>0&&g.map(U=>r.jsx(UZ,{userId:U,onCloseClick:()=>ut(`mod-tools/close-user-info/${U}`)},U)),d.length>0&&d.map(U=>r.jsx(bZ,{userId:U,onCloseClick:()=>ut(`mod-tools/close-user-chatlog/${U}`)},U)),l&&r.jsx(DZ,{onCloseClick:()=>c(!1)})]})},wZ=[Fe.START_DOORBELL,Fe.STATE_WAITING,Fe.STATE_NO_ANSWER,Fe.START_PASSWORD,Fe.STATE_WRONG_PASSWORD],FZ=[Fe.START_DOORBELL,Fe.STATE_WAITING,Fe.STATE_NO_ANSWER],GZ=a=>{const[t,e]=_.useState(""),{doorData:s=null,setDoorData:i=null}=pn(),n=()=>{s&&s.state===Fe.STATE_WAITING&&KR(),i(null)},o=()=>{!s||!s.roomInfo||(gc(s.roomInfo.roomId),i(u=>{const h={...u};return h.state=Fe.STATE_PENDING_SERVER,h}))},l=()=>{!s||!s.roomInfo||(gc(s.roomInfo.roomId,t),i(u=>{const h={...u};return h.state=Fe.STATE_PENDING_SERVER,h}))};if(_.useEffect(()=>{!s||s.state!==Fe.STATE_NO_ANSWER||KR()},[s]),!s||s.state===Fe.NONE||wZ.indexOf(s.state)===-1)return null;const c=FZ.indexOf(s.state)>=0;return r.jsxs(Ot,{className:"nitro-navigator-doorbell",children:[r.jsx(St,{headerText:f(c?"navigator.doorbell.title":"navigator.password.title"),onCloseClick:n}),r.jsxs(pt,{children:[r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:s&&s.roomInfo&&s.roomInfo.roomName}),s.state===Fe.START_DOORBELL&&r.jsx(O,{children:f("navigator.doorbell.info")}),s.state===Fe.STATE_WAITING&&r.jsx(O,{children:f("navigator.doorbell.waiting")}),s.state===Fe.STATE_NO_ANSWER&&r.jsx(O,{children:f("navigator.doorbell.no.answer")}),s.state===Fe.START_PASSWORD&&r.jsx(O,{children:f("navigator.password.info")}),s.state===Fe.STATE_WRONG_PASSWORD&&r.jsx(O,{children:f("navigator.password.retryinfo")})]}),c&&r.jsxs(A,{gap:1,children:[s.state===Fe.START_DOORBELL&&r.jsx(V,{variant:"success",onClick:o,children:f("navigator.doorbell.button.ring")}),r.jsx(V,{variant:"danger",onClick:n,children:f("generic.cancel")})]}),!c&&r.jsxs(r.Fragment,{children:[r.jsxs(A,{gap:1,children:[r.jsx(O,{children:f("navigator.password.enter")}),r.jsx("input",{type:"password",className:"form-control form-control-sm",onChange:u=>e(u.target.value)})]}),r.jsxs(A,{gap:1,children:[r.jsx(V,{variant:"success",onClick:l,children:f("navigator.password.button.try")}),r.jsx(V,{variant:"danger",onClick:n,children:f("generic.cancel")})]})]})]})]})},BZ=a=>{const[t,e]=_.useState(null),[s,i]=_.useState(null),[n,o]=_.useState(null),[l,c]=_.useState(null),[u,h]=_.useState(null),[d,g]=_.useState(0),[E,m]=_.useState([]),[I,p]=_.useState(""),{categories:T=null}=pn(),R=it("hc.disabled",!1),S=P=>it("images.url")+`/navigator/models/model_${P}.png`,b=(P,B)=>{!P||P.clubLevel>Wr()||p(E[B].name)},N=()=>{k(new OL(s,n,"model_"+I,Number(l),Number(u),d))};return _.useEffect(()=>{if(!t){const P=[];for(let B=10;B<=100;B=B+10)P.push(B);e(P),h(P[0])}},[t]),_.useEffect(()=>{T&&T.length&&c(T[0].id)},[T]),_.useEffect(()=>{const P=it("navigator.room.models");P&&P.length&&(m(P),p(P[0].name))},[]),r.jsxs(A,{overflow:"hidden",children:[r.jsxs(_t,{overflow:"hidden",children:[r.jsxs(A,{size:6,gap:1,overflow:"auto",children:[r.jsxs(A,{gap:1,children:[r.jsx(O,{children:f("navigator.createroom.roomnameinfo")}),r.jsx("input",{type:"text",className:"form-control form-control-sm",maxLength:60,onChange:P=>i(P.target.value),placeholder:f("navigator.createroom.roomnameinfo")})]}),r.jsxs(A,{grow:!0,gap:1,children:[r.jsx(O,{children:f("navigator.createroom.roomdescinfo")}),r.jsx("textarea",{className:"flex-grow-1 form-control form-control-sm w-100",maxLength:255,onChange:P=>o(P.target.value),placeholder:f("navigator.createroom.roomdescinfo")})]}),r.jsxs(A,{gap:1,children:[r.jsx(O,{children:f("navigator.category")}),r.jsx("select",{className:"form-select form-select-sm",onChange:P=>c(Number(P.target.value)),children:T&&T.length>0&&T.map(P=>r.jsx("option",{value:P.id,children:f(P.name)},P.id))})]}),r.jsxs(A,{gap:1,children:[r.jsx(O,{children:f("navigator.maxvisitors")}),r.jsx("select",{className:"form-select form-select-sm",onChange:P=>h(Number(P.target.value)),children:t&&t.map(P=>r.jsx("option",{value:P,children:P},P))})]}),r.jsxs(A,{gap:1,children:[r.jsx(O,{children:f("navigator.tradesettings")}),r.jsxs("select",{className:"form-select form-select-sm",onChange:P=>g(Number(P.target.value)),children:[r.jsx("option",{value:"0",children:f("navigator.roomsettings.trade_not_allowed")}),r.jsx("option",{value:"1",children:f("navigator.roomsettings.trade_not_with_Controller")}),r.jsx("option",{value:"2",children:f("navigator.roomsettings.trade_allowed")})]})]})]}),r.jsx(A,{size:6,gap:1,overflow:"auto",children:E.map((P,B)=>r.jsxs(ee,{fullHeight:!0,onClick:()=>b(P,B),itemActive:I===P.name,overflow:"unset",gap:0,className:"p-1",disabled:Wr()<P.clubLevel,children:[r.jsx(M,{fullHeight:!0,center:!0,overflow:"hidden",children:r.jsx("img",{alt:"",src:S(P.name)})}),r.jsxs(O,{bold:!0,children:[P.tileSize," ",f("navigator.createroom.tilesize")]}),!R&&P.clubLevel>Fi.NO_CLUB&&r.jsx(ps,{position:"absolute",className:"top-1 end-1",type:"hc"})]},P.name))})]}),r.jsx(V,{fullWidth:!0,variant:!s||s.length<3?"danger":"success",onClick:N,disabled:!s||s.length<3,children:f("navigator.createroom.create")})]})},kZ=a=>{const{onCloseClick:t=null}=a,[e,s]=_.useState(!1),[i,n]=_.useState(!1),{report:o=null}=En(),{navigatorData:l=null}=pn(),c=h=>{switch(h){case"settings":return q().userId===l.enteredGuestRoom.ownerId||q().isModerator;case"staff_pick":return q().securityLevel>=Cc.COMMUNITY;default:return!1}},u=(h,d)=>{if(!(!l||!l.enteredGuestRoom))switch(h){case"set_home_room":let g=-1;l.homeRoomId!==l.enteredGuestRoom.roomId&&(g=l.enteredGuestRoom.roomId),g>0&&k(new DL(g));return;case"navigator_search_tag":ut(`navigator/search/${d}`),k(new Nc("hotel_view",`tag:${d}`));return;case"open_room_thumbnail_camera":Fs(new Ra(Ra.TOGGLE_THUMBNAIL));return;case"open_group_info":C_(l.enteredGuestRoom.habboGroupId);return;case"toggle_room_link":ut("navigator/toggle-room-link");return;case"open_room_settings":k(new aO(l.enteredGuestRoom.roomId));return;case"toggle_pick":s(E=>!E),k(new yL(l.enteredGuestRoom.roomId));return;case"toggle_mute":n(E=>!E),k(new $P);return;case"room_filter":k(new AL(l.enteredGuestRoom.roomId));return;case"open_floorplan_editor":ut("floor-editor/toggle");return;case"report_room":o(as.ROOM,{roomId:l.enteredGuestRoom.roomId,roomName:l.enteredGuestRoom.roomName});return;case"close":t();return}};return _.useEffect(()=>{l&&(s(l.currentRoomIsStaffPick),l.enteredGuestRoom&&n(l.enteredGuestRoom.allInRoomMuted))},[l]),l.enteredGuestRoom?r.jsxs(Ot,{className:"nitro-room-info",children:[r.jsx(St,{headerText:f("navigator.roomsettings.roominfo"),onCloseClick:()=>u("close")}),r.jsx(pt,{className:"text-black",children:l.enteredGuestRoom&&r.jsxs(r.Fragment,{children:[r.jsxs(M,{gap:2,overflow:"hidden",children:[r.jsx(lp,{roomId:l.enteredGuestRoom.roomId,customUrl:l.enteredGuestRoom.officialRoomPicRef,children:c("settings")&&r.jsx("i",{className:"icon icon-camera-small position-absolute b-0 r-0 m-1 cursor-pointer top-0",onClick:()=>u("open_room_thumbnail_camera")})}),r.jsxs(A,{grow:!0,gap:1,overflow:"hidden",children:[r.jsxs(M,{gap:1,children:[r.jsxs(A,{grow:!0,gap:1,overflow:"hidden",children:[r.jsxs(M,{gap:1,children:[r.jsx("i",{onClick:()=>u("set_home_room"),className:qs("flex-shrink-0 icon icon-house-small cursor-pointer",l.homeRoomId!==l.enteredGuestRoom.roomId&&"gray")}),r.jsx(O,{bold:!0,truncate:!0,children:l.enteredGuestRoom.roomName})]}),l.enteredGuestRoom.showOwner&&r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx(O,{variant:"muted",children:f("navigator.roomownercaption")}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx(Cr,{userId:l.enteredGuestRoom.ownerId}),r.jsx(O,{children:l.enteredGuestRoom.ownerName})]})]}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx(O,{variant:"muted",children:f("navigator.roomrating")}),r.jsx(O,{children:l.currentRoomRating})]}),l.enteredGuestRoom.tags.length>0&&r.jsx(M,{alignItems:"center",gap:1,children:l.enteredGuestRoom.tags.map(h=>r.jsxs(O,{pointer:!0,className:"bg-muted rounded p-1",onClick:d=>u("navigator_search_tag",h),children:["#",h]},h))})]}),r.jsxs(A,{alignItems:"center",gap:1,children:[c("settings")&&r.jsx("i",{className:"icon icon-cog cursor-pointer",title:f("navigator.room.popup.info.room.settings"),onClick:h=>u("open_room_settings")}),r.jsx(Yj,{title:f("navigator.embed.caption"),className:"cursor-pointer fa-icon",onClick:h=>ut("navigator/toggle-room-link")})]})]}),r.jsx(O,{overflow:"auto",style:{maxHeight:50},children:l.enteredGuestRoom.description}),l.enteredGuestRoom.habboGroupId>0&&r.jsxs(M,{pointer:!0,alignItems:"center",gap:1,onClick:()=>u("open_group_info"),children:[r.jsx(Ge,{className:"flex-none",badgeCode:l.enteredGuestRoom.groupBadgeCode,isGroup:!0}),r.jsx(O,{underline:!0,children:f("navigator.guildbase",["groupName"],[l.enteredGuestRoom.groupName])})]})]})]}),r.jsxs(A,{gap:1,children:[c("staff_pick")&&r.jsx(V,{onClick:()=>u("toggle_pick"),children:f(e?"navigator.staffpicks.unpick":"navigator.staffpicks.pick")}),r.jsx(V,{variant:"danger",onClick:()=>u("report_room"),children:f("help.emergency.main.report.room")}),c("settings")&&r.jsxs(r.Fragment,{children:[r.jsx(V,{onClick:()=>u("toggle_mute"),children:f(i?"navigator.muteall_on":"navigator.muteall_off")}),r.jsx(V,{onClick:()=>u("room_filter"),children:f("navigator.roomsettings.roomfilter")}),r.jsx(V,{onClick:()=>u("open_floorplan_editor"),children:f("open.floor.plan.editor")})]})]})]})})]}):null},VZ=a=>{const{onCloseClick:t=null}=a,{navigatorData:e=null}=pn();return e.enteredGuestRoom?r.jsxs(Ot,{className:"nitro-room-link",children:[r.jsx(St,{headerText:f("navigator.embed.title"),onCloseClick:t}),r.jsx(pt,{className:"text-black d-flex align-items-center",children:r.jsxs(M,{gap:2,children:[r.jsx(lp,{roomId:e.enteredGuestRoom.roomId,customUrl:e.enteredGuestRoom.officialRoomPicRef}),r.jsxs(A,{children:[r.jsx(O,{bold:!0,fontSize:5,children:f("navigator.embed.headline")}),r.jsx(O,{children:f("navigator.embed.info")}),r.jsx("input",{type:"text",readOnly:!0,className:"form-control form-control-sm",value:f("navigator.embed.src",["roomId"],[e.enteredGuestRoom.roomId.toString()]).replace("${url.prefix}",it("url.prefix",""))})]})]})})]}):null},HZ=a=>{const{roomData:t=null,handleChange:e=null}=a,[s,i]=_.useState(""),[n,o]=_.useState(""),[l,c]=_.useState(!1),u=()=>{!l||s.length<=0||n.length<=0||s!==n||e("password",s)};return _.useEffect(()=>{i(""),o(""),c(!1)},[t]),r.jsxs(r.Fragment,{children:[r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("navigator.roomsettings.roomaccess.caption")}),r.jsx(O,{children:f("navigator.roomsettings.roomaccess.info")})]}),r.jsxs(A,{overflow:"auto",children:[r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("navigator.roomsettings.doormode")}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"radio",name:"lockState",checked:t.lockState===De.OPEN_STATE&&!l,onChange:h=>e("lock_state",De.OPEN_STATE)}),r.jsx(O,{children:f("navigator.roomsettings.doormode.open")})]}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"radio",name:"lockState",checked:t.lockState===De.DOORBELL_STATE&&!l,onChange:h=>e("lock_state",De.DOORBELL_STATE)}),r.jsx(O,{children:f("navigator.roomsettings.doormode.doorbell")})]}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"radio",name:"lockState",checked:t.lockState===De.INVISIBLE_STATE&&!l,onChange:h=>e("lock_state",De.INVISIBLE_STATE)}),r.jsx(O,{children:f("navigator.roomsettings.doormode.invisible")})]}),r.jsxs(M,{fullWidth:!0,gap:1,children:[r.jsx("input",{className:"form-check-input",type:"radio",name:"lockState",checked:t.lockState===De.PASSWORD_STATE||l,onChange:h=>c(h.target.checked)}),!l&&t.lockState!==De.PASSWORD_STATE&&r.jsx(O,{children:f("navigator.roomsettings.doormode.password")}),(l||t.lockState===De.PASSWORD_STATE)&&r.jsxs(A,{gap:1,children:[r.jsx(O,{children:f("navigator.roomsettings.doormode.password")}),r.jsx("input",{type:"password",className:"form-control form-control-sm col-4",value:s,onChange:h=>i(h.target.value),placeholder:f("navigator.roomsettings.password"),onFocus:h=>c(!0)}),l&&s.length<=0&&r.jsx(O,{bold:!0,small:!0,variant:"danger",children:f("navigator.roomsettings.passwordismandatory")}),r.jsx("input",{type:"password",className:"form-control form-control-sm col-4",value:n,onChange:h=>o(h.target.value),onBlur:u,placeholder:f("navigator.roomsettings.passwordconfirm")}),l&&s.length>0&&s!==n&&r.jsx(O,{bold:!0,small:!0,variant:"danger",children:f("navigator.roomsettings.invalidconfirm")})]})]})]}),r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("navigator.roomsettings.pets")}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"checkbox",checked:t.allowPets,onChange:h=>e("allow_pets",h.target.checked)}),r.jsx(O,{children:f("navigator.roomsettings.allowpets")})]}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"checkbox",checked:t.allowPetsEat,onChange:h=>e("allow_pets_eat",h.target.checked)}),r.jsx(O,{children:f("navigator.roomsettings.allowfoodconsume")})]})]})]})]})},KA=3,XA=60,qA=255,Q_=15,WZ=a=>{const{roomData:t=null,handleChange:e=null,onClose:s=null}=a,[i,n]=_.useState(""),[o,l]=_.useState(""),[c,u]=_.useState(""),[h,d]=_.useState(""),[g,E]=_.useState(0),[m,I]=_.useState(""),{showConfirm:p=null}=He(),{categories:T=null}=pn();Y(HD,P=>{const B=P.getParser();if(B)switch(B.code){case Xd.ERROR_INVALID_TAG:I("navigator.roomsettings.unacceptablewords");case Xd.ERROR_NON_USER_CHOOSABLE_TAG:I("navigator.roomsettings.nonuserchoosabletag");break;default:I("");break}});const R=()=>{p(f("navigator.roomsettings.deleteroom.confirm.message",["room_name"],[t.roomName]),()=>{k(new qL(t.roomId)),s&&s(),ut("navigator/search/myworld_view")},null,null,null,f("navigator.roomsettings.deleteroom.confirm.title"))},S=()=>{i===t.roomName||i.length<KA||i.length>XA||e("name",i)},b=()=>{o===t.roomDescription||o.length>qA||e("description",o)},N=P=>{P===0&&c===t.tags[0]||c.length>Q_||P===1&&h===t.tags[1]||h.length>Q_||(c===""&&h!==""&&d(""),I(""),E(P),e("tags",c===""&&h!==""?[h]:[c,h]))};return _.useEffect(()=>{n(t.roomName),l(t.roomDescription),u(t.tags.length>0&&t.tags[0]?t.tags[0]:""),d(t.tags.length>0&&t.tags[1]?t.tags[1]:"")},[t]),r.jsxs(r.Fragment,{children:[r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx(O,{className:"col-3",children:f("navigator.roomname")}),r.jsxs(A,{fullWidth:!0,gap:0,children:[r.jsx("input",{className:"form-control form-control-sm",value:i,maxLength:XA,onChange:P=>n(P.target.value),onBlur:S}),i.length<KA&&r.jsx(O,{bold:!0,small:!0,variant:"danger",children:f("navigator.roomsettings.roomnameismandatory")})]})]}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx(O,{className:"col-3",children:f("navigator.roomsettings.desc")}),r.jsx("textarea",{className:"form-control form-control-sm",value:o,maxLength:qA,onChange:P=>l(P.target.value),onBlur:b})]}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx(O,{className:"col-3",children:f("navigator.category")}),r.jsx("select",{className:"form-select form-select-sm",value:t.categoryId,onChange:P=>e("category",P.target.value),children:T&&T.map(P=>r.jsx("option",{value:P.id,children:f(P.name)},P.id))})]}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx(O,{className:"col-3",children:f("navigator.maxvisitors")}),r.jsx("select",{className:"form-select form-select-sm",value:t.userCount,onChange:P=>e("max_visitors",P.target.value),children:IA&&IA.map(P=>r.jsx("option",{value:P,children:P},P))})]}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx(O,{className:"col-3",children:f("navigator.tradesettings")}),r.jsxs("select",{className:"form-select form-select-sm",value:t.tradeState,onChange:P=>e("trade_state",P.target.value),children:[r.jsx("option",{value:"0",children:f("navigator.roomsettings.trade_not_allowed")}),r.jsx("option",{value:"1",children:f("navigator.roomsettings.trade_not_with_Controller")}),r.jsx("option",{value:"2",children:f("navigator.roomsettings.trade_allowed")})]})]}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx(O,{className:"col-3",children:f("navigator.tags")}),r.jsxs(A,{fullWidth:!0,gap:0,children:[r.jsx("input",{className:"form-control form-control-sm",value:c,onChange:P=>u(P.target.value),onBlur:()=>N(0)}),c.length>Q_&&r.jsx(O,{bold:!0,small:!0,variant:"danger",children:f("navigator.roomsettings.toomanycharacters")}),g===0&&m!=""&&r.jsx(O,{bold:!0,small:!0,variant:"danger",children:f(m)})]}),r.jsxs(A,{fullWidth:!0,gap:0,children:[r.jsx("input",{className:"form-control form-control-sm",value:h,onChange:P=>d(P.target.value),onBlur:()=>N(1)}),h.length>Q_&&r.jsx(O,{bold:!0,small:!0,variant:"danger",children:f("navigator.roomsettings.toomanycharacters")}),g===1&&m!=""&&r.jsx(O,{bold:!0,small:!0,variant:"danger",children:f(m)})]})]}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx(H,{className:"col-3"}),r.jsx("input",{className:"form-check-input",type:"checkbox",checked:t.allowWalkthrough,onChange:P=>e("allow_walkthrough",P.target.checked)}),r.jsx(O,{children:f("navigator.roomsettings.allow_walk_through")})]}),r.jsxs(O,{variant:"danger",underline:!0,bold:!0,pointer:!0,className:"d-flex justify-content-center align-items-center gap-1",onClick:R,children:[r.jsx(zr,{className:"fa-icon"}),f("navigator.roomsettings.delete")]})]})},YZ=a=>{var c;const{roomData:t=null,handleChange:e=null}=a,[s,i]=_.useState(-1),[n,o]=_.useState([]),l=u=>{o(h=>{const d=[...h],g=d.findIndex(E=>E.userId===u);return g>=0&&d.splice(g,1),d}),k(new $L(u,t.roomId)),i(-1)};return Y(FD,u=>{const h=u.getParser();!t||t.roomId!==h.roomId||o(h.bannedUsers)}),_.useEffect(()=>{k(new nO(t.roomId))},[t.roomId]),r.jsxs(_t,{overflow:"auto",children:[r.jsxs(A,{size:6,children:[r.jsxs(O,{bold:!0,children:[f("navigator.roomsettings.moderation.banned.users")," (",n.length,")"]}),r.jsx(M,{overflow:"hidden",className:"bg-white rounded list-container p-2",children:r.jsx(A,{fullWidth:!0,overflow:"auto",gap:1,children:n&&n.length>0&&n.map((u,h)=>r.jsxs(M,{shrink:!0,alignItems:"center",gap:1,overflow:"hidden",children:[r.jsx(Cr,{userName:u.userName}),r.jsxs(O,{pointer:!0,grow:!0,onClick:d=>i(u.userId),children:[" ",u.userName]})]},h))})}),r.jsxs(V,{disabled:s<=0,onClick:u=>l(s),children:[f("navigator.roomsettings.moderation.unban")," ",s>0&&((c=n.find(u=>u.userId===s))==null?void 0:c.userName)]})]}),r.jsxs(A,{size:6,children:[r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("navigator.roomsettings.moderation.mute.header")}),r.jsx(M,{alignItems:"center",gap:1,children:r.jsxs("select",{className:"form-select form-select-sm",value:t.moderationSettings.allowMute,onChange:u=>e("moderation_mute",u.target.value),children:[r.jsx("option",{value:tr.MODERATION_LEVEL_NONE,children:f("navigator.roomsettings.moderation.none")}),r.jsx("option",{value:tr.MODERATION_LEVEL_USER_WITH_RIGHTS,children:f("navigator.roomsettings.moderation.rights")})]})})]}),r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("navigator.roomsettings.moderation.kick.header")}),r.jsx(M,{alignItems:"center",gap:1,children:r.jsxs("select",{className:"form-select form-select-sm",value:t.moderationSettings.allowKick,onChange:u=>e("moderation_kick",u.target.value),children:[r.jsx("option",{value:tr.MODERATION_LEVEL_NONE,children:f("navigator.roomsettings.moderation.none")}),r.jsx("option",{value:tr.MODERATION_LEVEL_USER_WITH_RIGHTS,children:f("navigator.roomsettings.moderation.rights")}),r.jsx("option",{value:tr.MODERATION_LEVEL_ALL,children:f("navigator.roomsettings.moderation.all")})]})})]}),r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("navigator.roomsettings.moderation.ban.header")}),r.jsx(M,{alignItems:"center",gap:1,children:r.jsxs("select",{className:"form-select form-select-sm",value:t.moderationSettings.allowBan,onChange:u=>e("moderation_ban",u.target.value),children:[r.jsx("option",{value:tr.MODERATION_LEVEL_NONE,children:f("navigator.roomsettings.moderation.none")}),r.jsx("option",{value:tr.MODERATION_LEVEL_USER_WITH_RIGHTS,children:f("navigator.roomsettings.moderation.rights")})]})})]})]})]})},zZ=a=>{const{roomData:t=null}=a,[e,s]=_.useState(new Map),{friends:i=[]}=ar();Y(kD,o=>{const l=o.getParser();!t||t.roomId!==l.roomId||s(l.users)}),Y(GD,o=>{const l=o.getParser();!t||t.roomId!==l.roomId||s(c=>{const u=new Map(c);return u.set(l.data.userId,l.data.userName),u})}),Y(BD,o=>{const l=o.getParser();!t||t.roomId!==l.roomId||s(c=>{const u=new Map(c);return u.delete(l.userId),u})}),_.useEffect(()=>{k(new tP(t.roomId))},[t.roomId]);const n=i.map(o=>o).filter(o=>o.id!==-1&&!Array.from(e.keys()).includes(o.id));return r.jsxs(_t,{children:[r.jsxs(A,{size:6,children:[r.jsx(O,{bold:!0,children:f("navigator.flatctrls.userswithrights",["displayed","total"],[e.size.toString(),e.size.toString()])}),r.jsx(M,{overflow:"hidden",className:"bg-white rounded list-container p-2",children:r.jsx(A,{fullWidth:!0,overflow:"auto",gap:1,children:Array.from(e.entries()).map(([o,l],c)=>r.jsxs(M,{shrink:!0,alignItems:"center",gap:1,overflow:"hidden",children:[r.jsx(Cr,{userId:o}),r.jsxs(O,{pointer:!0,grow:!0,onClick:u=>k(new rO(o)),children:[" ",l]})]},c))})}),r.jsx(A,{children:r.jsx(V,{variant:"danger",disabled:!e.size,onClick:o=>k(new zL(t.roomId)),children:f("navigator.flatctrls.clear")})})]}),r.jsxs(A,{size:6,children:[r.jsx(O,{bold:!0,children:f("navigator.flatctrls.friends",["displayed","total"],[n.length.toString(),n.length.toString()])}),r.jsx(M,{overflow:"hidden",className:"bg-white rounded list-container p-2",children:r.jsx(A,{fullWidth:!0,overflow:"auto",gap:1,children:n&&n.map((o,l)=>r.jsxs(M,{shrink:!0,alignItems:"center",gap:1,overflow:"hidden",children:[r.jsx(Cr,{userId:o.id}),r.jsxs(O,{pointer:!0,grow:!0,onClick:c=>k(new iO(o.id)),children:[" ",o.name]})]},l))})})]})]})},KZ=a=>{const{roomData:t=null,handleChange:e=null}=a,[s,i]=_.useState(0);return _.useEffect(()=>{i(t.chatSettings.distance)},[t.chatSettings]),r.jsxs(r.Fragment,{children:[r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("navigator.roomsettings.vip.caption")}),r.jsx(O,{children:f("navigator.roomsettings.vip.info")})]}),r.jsxs(_t,{overflow:"auto",children:[r.jsxs(A,{size:6,gap:1,children:[r.jsx(O,{bold:!0,children:f("navigator.roomsettings.chat_settings")}),r.jsx(O,{children:f("navigator.roomsettings.chat_settings.info")}),r.jsxs("select",{className:"form-select form-select-sm",value:t.chatSettings.mode,onChange:n=>e("bubble_mode",n.target.value),children:[r.jsx("option",{value:ns.CHAT_MODE_FREE_FLOW,children:f("navigator.roomsettings.chat.mode.free.flow")}),r.jsx("option",{value:ns.CHAT_MODE_LINE_BY_LINE,children:f("navigator.roomsettings.chat.mode.line.by.line")})]}),r.jsxs("select",{className:"form-select form-select-sm",value:t.chatSettings.weight,onChange:n=>e("chat_weight",n.target.value),children:[r.jsx("option",{value:ns.CHAT_BUBBLE_WIDTH_NORMAL,children:f("navigator.roomsettings.chat.bubbles.width.normal")}),r.jsx("option",{value:ns.CHAT_BUBBLE_WIDTH_THIN,children:f("navigator.roomsettings.chat.bubbles.width.thin")}),r.jsx("option",{value:ns.CHAT_BUBBLE_WIDTH_WIDE,children:f("navigator.roomsettings.chat.bubbles.width.wide")})]}),r.jsxs("select",{className:"form-select form-select-sm",value:t.chatSettings.speed,onChange:n=>e("bubble_speed",n.target.value),children:[r.jsx("option",{value:ns.CHAT_SCROLL_SPEED_FAST,children:f("navigator.roomsettings.chat.speed.fast")}),r.jsx("option",{value:ns.CHAT_SCROLL_SPEED_NORMAL,children:f("navigator.roomsettings.chat.speed.normal")}),r.jsx("option",{value:ns.CHAT_SCROLL_SPEED_SLOW,children:f("navigator.roomsettings.chat.speed.slow")})]}),r.jsxs("select",{className:"form-select form-select-sm",value:t.chatSettings.protection,onChange:n=>e("flood_protection",n.target.value),children:[r.jsx("option",{value:ns.FLOOD_FILTER_LOOSE,children:f("navigator.roomsettings.chat.flood.loose")}),r.jsx("option",{value:ns.FLOOD_FILTER_NORMAL,children:f("navigator.roomsettings.chat.flood.normal")}),r.jsx("option",{value:ns.FLOOD_FILTER_STRICT,children:f("navigator.roomsettings.chat.flood.strict")})]}),r.jsx(O,{children:f("navigator.roomsettings.chat_settings.hearing.distance")}),r.jsx("input",{type:"number",min:"0",className:"form-control form-control-sm",value:s,onChange:n=>i(n.target.valueAsNumber),onBlur:n=>e("chat_distance",s)})]}),r.jsxs(A,{size:6,gap:1,children:[r.jsx(O,{bold:!0,children:f("navigator.roomsettings.vip_settings")}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"checkbox",checked:t.hideWalls,onChange:n=>e("hide_walls",n.target.checked)}),r.jsx(O,{children:f("navigator.roomsettings.hide_walls")})]}),r.jsxs("select",{className:"form-select form-select-sm",value:t.wallThickness,onChange:n=>e("wall_thickness",n.target.value),children:[r.jsx("option",{value:"0",children:f("navigator.roomsettings.wall_thickness.normal")}),r.jsx("option",{value:"1",children:f("navigator.roomsettings.wall_thickness.thick")}),r.jsx("option",{value:"-1",children:f("navigator.roomsettings.wall_thickness.thin")}),r.jsx("option",{value:"-2",children:f("navigator.roomsettings.wall_thickness.thinnest")})]}),r.jsxs("select",{className:"form-select form-select-sm",value:t.floorThickness,onChange:n=>e("floor_thickness",n.target.value),children:[r.jsx("option",{value:"0",children:f("navigator.roomsettings.floor_thickness.normal")}),r.jsx("option",{value:"1",children:f("navigator.roomsettings.floor_thickness.thick")}),r.jsx("option",{value:"-1",children:f("navigator.roomsettings.floor_thickness.thin")}),r.jsx("option",{value:"-2",children:f("navigator.roomsettings.floor_thickness.thinnest")})]})]})]})]})},xo=["navigator.roomsettings.tab.1","navigator.roomsettings.tab.2","navigator.roomsettings.tab.3","navigator.roomsettings.tab.4","navigator.roomsettings.tab.5"],XZ=a=>{const[t,e]=_.useState(null),[s,i]=_.useState(xo[0]);Y(VD,l=>{const c=l.getParser();if(!c)return;const u=c.data;e({roomId:u.roomId,roomName:u.name,roomDescription:u.description,categoryId:u.categoryId,userCount:u.maximumVisitorsLimit,tags:u.tags,tradeState:u.tradeMode,allowWalkthrough:u.allowWalkThrough,lockState:u.doorMode,password:null,allowPets:u.allowPets,allowPetsEat:u.allowFoodConsume,hideWalls:u.hideWalls,wallThickness:u.wallThickness,floorThickness:u.floorThickness,chatSettings:{mode:u.chatSettings.mode,weight:u.chatSettings.weight,speed:u.chatSettings.speed,distance:u.chatSettings.distance,protection:u.chatSettings.protection},moderationSettings:{allowMute:u.roomModerationSettings.allowMute,allowKick:u.roomModerationSettings.allowKick,allowBan:u.roomModerationSettings.allowBan}}),k(new nO(u.roomId))});const n=()=>{e(null),i(xo[0])},o=(l,c)=>{e(u=>{const h={...u};switch(l){case"name":h.roomName=String(c);break;case"description":h.roomDescription=String(c);break;case"category":h.categoryId=Number(c);break;case"max_visitors":h.userCount=Number(c);break;case"trade_state":h.tradeState=Number(c);break;case"tags":h.tags=c;break;case"allow_walkthrough":h.allowWalkthrough=!!c;break;case"allow_pets":h.allowPets=!!c;break;case"allow_pets_eat":h.allowPetsEat=!!c;break;case"hide_walls":h.hideWalls=!!c;break;case"wall_thickness":h.wallThickness=Number(c);break;case"floor_thickness":h.floorThickness=Number(c);break;case"lock_state":h.lockState=Number(c);break;case"password":h.lockState=De.PASSWORD_STATE,h.password=String(c);break;case"moderation_mute":h.moderationSettings.allowMute=Number(c);break;case"moderation_kick":h.moderationSettings.allowKick=Number(c);break;case"moderation_ban":h.moderationSettings.allowBan=Number(c);break;case"bubble_mode":h.chatSettings.mode=Number(c);break;case"chat_weight":h.chatSettings.weight=Number(c);break;case"bubble_speed":h.chatSettings.speed=Number(c);break;case"flood_protection":h.chatSettings.protection=Number(c);break;case"chat_distance":h.chatSettings.distance=Number(c);break}return k(new eP(h.roomId,h.roomName,h.roomDescription,h.lockState,h.password,h.userCount,h.categoryId,h.tags.length,h.tags,h.tradeState,h.allowPets,h.allowPetsEat,h.allowWalkthrough,h.hideWalls,h.wallThickness,h.floorThickness,h.moderationSettings.allowMute,h.moderationSettings.allowKick,h.moderationSettings.allowBan,h.chatSettings.mode,h.chatSettings.weight,h.chatSettings.speed,h.chatSettings.distance,h.chatSettings.protection)),h})};return t?r.jsxs(Ot,{uniqueKey:"nitro-room-settings",className:"nitro-room-settings",children:[r.jsx(St,{headerText:f("navigator.roomsettings"),onCloseClick:n}),r.jsx(Ro,{children:xo.map(l=>r.jsx(Wn,{isActive:s===l,onClick:c=>i(l),children:f(l)},l))}),r.jsxs(pt,{children:[s===xo[0]&&r.jsx(WZ,{roomData:t,handleChange:o,onClose:n}),s===xo[1]&&r.jsx(HZ,{roomData:t,handleChange:o}),s===xo[2]&&r.jsx(zZ,{roomData:t,handleChange:o}),s===xo[3]&&r.jsx(KZ,{roomData:t,handleChange:o}),s===xo[4]&&r.jsx(YZ,{roomData:t,handleChange:o})]})]}):null},QA=a=>{const{roomData:t=null}=a,[e,s]=_.useState(!1),i=_.useRef(),n=()=>{const o=100*(t.userCount/t.maxUserCount);let l="bg-primary";return o>=92?l="bg-danger":o>=50?l="bg-warning":o>0&&(l="bg-success"),l};return r.jsxs(r.Fragment,{children:[r.jsx(H,{pointer:!0,innerRef:i,className:"icon icon-navigator-info",onMouseOver:o=>s(!0),onMouseLeave:o=>s(!1)}),r.jsx(hS,{show:e,target:i.current,placement:"right",children:r.jsx(Sc,{children:r.jsx(pt,{overflow:"hidden",className:"room-info image-rendering-pixelated bg-transparent",children:r.jsxs(M,{gap:2,overflow:"hidden",children:[r.jsxs(lp,{roomId:t.roomId,customUrl:t.officialRoomPicRef,className:"d-flex flex-column align-items-center justify-content-end mb-1",children:[t.habboGroupId>0&&r.jsx(Ge,{badgeCode:t.groupBadgeCode,isGroup:!0,className:"position-absolute top-0 start-0 m-1 "}),t.doorMode!==De.OPEN_STATE&&r.jsx("i",{className:"position-absolute end-0 mb-1 me-1 icon icon-navigator-room-"+(t.doorMode===De.DOORBELL_STATE?"locked":t.doorMode===De.PASSWORD_STATE?"password":t.doorMode===De.INVISIBLE_STATE?"invisible":"")})]}),r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,truncate:!0,className:"flex-grow-1",style:{maxHeight:13},children:t.roomName}),r.jsxs(M,{gap:2,children:[r.jsx(O,{italics:!0,variant:"muted",children:f("navigator.roomownercaption")}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx(Cr,{userId:t.ownerId}),r.jsx(O,{italics:!0,children:t.ownerName})]})]}),r.jsx(O,{className:"flex-grow-1",children:t.description}),r.jsxs(M,{className:"badge p-1 position-absolute m-1 bottom-0 end-0 m-2 "+n(),gap:1,children:[r.jsx($p,{className:"fa-icon"}),t.userCount]})]})]})})})})]})},JA=a=>{const{roomData:t=null,children:e=null,thumbnail:s=!1,...i}=a,{setDoorData:n=null}=pn(),o=()=>{const c=100*(t.userCount/t.maxUserCount);let u="bg-primary";return c>=92?u="bg-danger":c>=50?u="bg-warning":c>0&&(u="bg-success"),u},l=c=>{if(t.ownerId!==q().userId){if(t.habboGroupId!==0){Yr(t.roomId);return}switch(t.doorMode){case De.DOORBELL_STATE:n(u=>{const h={...u};return h.roomInfo=t,h.state=Fe.START_DOORBELL,h});return;case De.PASSWORD_STATE:n(u=>{const h={...u};return h.roomInfo=t,h.state=Fe.START_PASSWORD,h});return}}gc(t.roomId)};return s?r.jsxs(A,{pointer:!0,overflow:"hidden",alignItems:"center",onClick:l,gap:0,className:"navigator-item p-1 bg-light rounded-3 small mb-1 flex-column border border-muted",...i,children:[r.jsxs(lp,{roomId:t.roomId,customUrl:t.officialRoomPicRef,className:"d-flex flex-column align-items-center justify-content-end mb-1",children:[t.habboGroupId>0&&r.jsx(Ge,{badgeCode:t.groupBadgeCode,isGroup:!0,className:"position-absolute top-0 start-0 m-1"}),r.jsxs(M,{center:!0,className:"badge p-1 position-absolute m-1 "+o(),gap:1,children:[r.jsx($p,{className:"fa-icon"}),t.userCount]}),t.doorMode!==De.OPEN_STATE&&r.jsx("i",{className:"position-absolute end-0 mb-1 me-1 icon icon-navigator-room-"+(t.doorMode===De.DOORBELL_STATE?"locked":t.doorMode===De.PASSWORD_STATE?"password":t.doorMode===De.INVISIBLE_STATE?"invisible":"")})]}),r.jsxs(M,{className:"w-100",children:[r.jsx(O,{truncate:!0,className:"flex-grow-1",children:t.roomName}),r.jsx(M,{reverse:!0,alignItems:"center",gap:1,children:r.jsx(QA,{roomData:t})}),e]})]}):r.jsxs(M,{pointer:!0,overflow:"hidden",alignItems:"center",onClick:l,gap:2,className:"navigator-item px-2 py-1 small",...i,children:[r.jsxs(M,{center:!0,className:"badge p-1 "+o(),gap:1,children:[r.jsx($p,{className:"fa-icon"}),t.userCount]}),r.jsx(O,{truncate:!0,grow:!0,children:t.roomName}),r.jsxs(M,{reverse:!0,alignItems:"center",gap:1,children:[r.jsx(QA,{roomData:t}),t.habboGroupId>0&&r.jsx("i",{className:"icon icon-navigator-room-group"}),t.doorMode!==De.OPEN_STATE&&r.jsx("i",{className:"icon icon-navigator-room-"+(t.doorMode===De.DOORBELL_STATE?"locked":t.doorMode===De.PASSWORD_STATE?"password":t.doorMode===De.INVISIBLE_STATE?"invisible":"")})]}),e]})},qZ=a=>{const{searchResult:t=null,...e}=a,[s,i]=_.useState(!0),[n,o]=_.useState(0),{topLevelContext:l=null}=pn(),c=()=>{let g=t.code;return!g||!g.length||f("navigator.searchcode.title."+g)=="navigator.searchcode.title."+g?t.data:g.startsWith("${")?g.slice(2,g.length-1):"navigator.searchcode.title."+g},u=()=>{o(g=>g===yo.LIST?yo.THUMBNAILS:yo.LIST)},h=()=>{t.action==1?k(new Nc(t.code,"")):t.action==2&&l&&k(new Nc(l.code,""))};_.useEffect(()=>{t&&(i(!t.closed),o(t.mode))},[t]);const d=n>=yo.THUMBNAILS;return r.jsxs(A,{className:"bg-white rounded border border-muted",gap:0,children:[r.jsxs(M,{fullWidth:!0,alignItems:"center",justifyContent:"between",className:"px-2 py-1",children:[r.jsxs(M,{grow:!0,pointer:!0,alignItems:"center",gap:1,onClick:g=>i(E=>!E),children:[s&&r.jsx(zj,{className:"text-secondary fa-icon"}),!s&&r.jsx(p_,{className:"text-secondary fa-icon"}),r.jsx(O,{children:f(c())})]}),r.jsxs(M,{gap:2,children:[n===yo.LIST&&r.jsx(Kj,{className:"text-secondary fa-icon",onClick:u}),n>=yo.THUMBNAILS&&r.jsx(Xj,{className:"text-secondary fa-icon",onClick:u}),t.action>0&&t.action===1&&r.jsx(qj,{className:"text-secondary fa-icon",onClick:h}),t.action>0&&t.action!==1&&r.jsx(Qj,{className:"text-secondary fa-icon",onClick:h})]})]})," ",s&&r.jsx(r.Fragment,{children:d?r.jsx(Ce,{columnCount:3,...e,columnMinWidth:110,columnMinHeight:130,className:"mx-2",children:t.rooms.length>0&&t.rooms.map((g,E)=>r.jsx(JA,{roomData:g,thumbnail:!0},E))}):r.jsx(_t,{columnCount:1,className:"navigator-grid",gap:0,children:t.rooms.length>0&&t.rooms.map((g,E)=>r.jsx(JA,{roomData:g},E))})})]})},QZ=a=>{const{sendSearch:t=null}=a,[e,s]=_.useState(0),[i,n]=_.useState(""),{topLevelContext:o=null,searchResult:l=null}=pn(),c=()=>{if(!o)return;let h=Wc[e];h||(h=Wc[0]);const d=(h.query?h.query+":":"")+i;t(d||"",o.code)},u=h=>{h.key==="Enter"&&c()};return _.useEffect(()=>{if(!l)return;const h=l.data.split(":");let d=null,g="";if(h.length>=2){const[E,...m]=h;d=Wc.find(I=>I.query===E),g=m.join(":")}else g=l.data;d||(d=Wc[0]),s(Wc.findIndex(E=>E===d)),n(g)},[l]),r.jsxs(M,{fullWidth:!0,gap:1,children:[r.jsx(M,{shrink:!0,children:r.jsx("select",{className:"form-select form-select-sm",value:e,onChange:h=>s(parseInt(h.target.value)),children:Wc.map((h,d)=>r.jsx("option",{value:d,children:f("navigator.filter."+h.name)},d))})}),r.jsxs(M,{fullWidth:!0,gap:1,children:[r.jsx("input",{type:"text",className:"form-control form-control-sm",placeholder:f("navigator.filter.input.placeholder"),value:i,onChange:h=>n(h.target.value),onKeyDown:h=>u(h)}),r.jsx(V,{variant:"primary",onClick:c,children:r.jsx(YE,{className:"fa-icon"})})]})]})},JZ=a=>{const[t,e]=_.useState(!1),[s,i]=_.useState(!1),[n,o]=_.useState(!1),[l,c]=_.useState(!1),[u,h]=_.useState(!1),[d,g]=_.useState(!1),[E,m]=_.useState(!0),[I,p]=_.useState(!1),{searchResult:T=null,topLevelContext:R=null,topLevelContexts:S=null,navigatorData:b=null}=pn(),N=_.useRef(null),P=_.useRef();we(Mt.CREATED,w=>{e(!1),o(!1)});const B=_.useCallback((w,U)=>{o(!1),k(new Nc(U,w)),g(!0)},[]),F=_.useCallback(()=>{if(!s){p(!0);return}if(N.current){B(N.current.value,N.current.code),N.current=null;return}if(T){B(T.data,T.code);return}R&&B("",R.code)},[s,T,R,B]);return _.useEffect(()=>{const w={linkReceived:U=>{const G=U.split("/");if(!(G.length<2))switch(G[1]){case"show":{e(!0),p(!0);return}case"hide":e(!1);return;case"toggle":{if(t){e(!1);return}e(!0),p(!0);return}case"toggle-room-info":c(K=>!K);return;case"toggle-room-link":h(K=>!K);return;case"goto":if(G.length<=2)return;switch(G[2]){case"home":if(b.homeRoomId<=0)return;Yr(b.homeRoomId);break;default:{const K=parseInt(G[2]);Yr(K)}}return;case"create":e(!0),o(!0);return;case"search":if(G.length>2){const K=G[2];let z="";G.length>3&&(z=G[3]),N.current={value:z,code:K},e(!0),p(!0)}return}},eventUrlPrefix:"navigator/"};return Os(w),()=>Cs(w)},[t,b]),_.useEffect(()=>{T&&(g(!1),P&&P.current&&(P.current.scrollTop=0))},[T]),_.useEffect(()=>{!t||!s||!I||(F(),p(!1))},[t,s,I,F]),_.useEffect(()=>{s||!R||i(!0)},[s,R]),_.useEffect(()=>{!t||!E||(k(new xL),m(!1))},[t,E]),_.useEffect(()=>{Zt.addCallback(Hn.OPENROOM,(w,U=!1,G=null)=>k(new SL(w)))},[]),r.jsxs(r.Fragment,{children:[t&&r.jsxs(Ot,{uniqueKey:"navigator",className:"nitro-navigator",children:[r.jsx(St,{headerText:f(n?"navigator.createroom.title":"navigator.title"),onCloseClick:w=>e(!1)}),r.jsxs(Ro,{children:[S&&S.length>0&&S.map((w,U)=>r.jsx(Wn,{isActive:R===w&&!n,onClick:G=>B("",w.code),children:f("navigator.toplevelview."+w.code)},U)),r.jsx(Wn,{isActive:n,onClick:w=>o(!0),children:r.jsx(p_,{className:"fa-icon"})})]}),r.jsxs(pt,{position:"relative",children:[d&&r.jsx(H,{fit:!0,position:"absolute",className:"top-0 start-0 z-index-1 bg-muted opacity-0-5"}),!n&&r.jsxs(r.Fragment,{children:[r.jsx(QZ,{sendSearch:B}),r.jsx(A,{innerRef:P,overflow:"auto",children:T&&T.results.map((w,U)=>r.jsx(qZ,{searchResult:w},U))})]}),n&&r.jsx(BZ,{})]})]}),r.jsx(GZ,{}),l&&r.jsx(kZ,{onCloseClick:()=>c(!1)}),u&&r.jsx(VZ,{onCloseClick:()=>h(!1)}),r.jsx(XZ,{})]})},$Z=/\n\r|\n|\r/mg,ZZ=a=>{const[t,e]=_.useState(null),[s,i]=_.useState(""),[n,o]=_.useState(null),l=_.useRef(null);return _.useEffect(()=>{const c=async h=>{try{const d=await fetch(h);if(!d)return;const E=(await d.text()).split($Z),m=E.shift().split("|");i(m[0]),o(I=>m[1]&&m[1].split(";").length===2?{width:parseInt(m[1].split(";")[0]),height:parseInt(m[1].split(";")[1])}:null),e(E.join(""))}catch{dt.error(`Failed to fetch ${h}`)}},u={linkReceived:h=>{const d=h.split("/");d.length<2||(d.shift(),c(it("habbopages.url")+d.join("/")))},eventUrlPrefix:"habbopages/"};return Os(u),()=>Cs(u)},[]),_.useEffect(()=>{const c=u=>{if(!(u.target instanceof HTMLAnchorElement))return;u.preventDefault();const h=u.target.href;!h||!h.length||wc(h)};return document.addEventListener("click",c),()=>{document.removeEventListener("click",c)}},[]),t?r.jsxs(Ot,{className:"nitropedia",style:n?{width:n.width,height:n.height}:{},children:[r.jsx(St,{headerText:s,onCloseClick:()=>e(null)}),r.jsx(pt,{children:r.jsx(H,{fit:!0,innerRef:l,className:"text-black",dangerouslySetInnerHTML:{__html:t}})})]}):null},ttt=a=>{const{offer:t=null,setOpen:e=null}=a;if(t)return r.jsxs(UO,{fadesOut:!1,onClose:null,onClick:s=>e(!0),gap:2,children:[r.jsx(H,{className:"nitro-targeted-offer-icon",style:{backgroundImage:`url(${it("image.library.url")+t.iconImageUrl})`}}),r.jsx(O,{variant:"light",className:"ubuntu-bold",children:t.title})]})},ett=a=>{const{offer:t=null,setOpen:e=null}=a,{getCurrencyAmount:s}=kc(),[i,n]=_.useState(1),o=_.useMemo(()=>{let u=!1,h=!1,d=!1;return t.priceInCredits>0&&(u=s(-1)>=t.priceInCredits),t.priceInActivityPoints>0?h=s(t.activityPointType)>=t.priceInActivityPoints:h=!0,t.purchaseLimit>0&&(d=!0),u&&h&&d},[t,s]),l=()=>{let u=Math.max(0,(t.expirationTime-Date.now())/1e3);return Vr.format(u)},c=()=>{k(new Gb(t.id,i)),k(new $S)};if(t)return r.jsxs(Ot,{uniqueKey:"targeted-offer",className:"nitro-targeted-offer",children:[r.jsx(St,{headerText:f(t.title),onCloseClick:u=>e(!1)}),r.jsx(N0,{position:"relative",className:"justify-content-center align-items-center cursor-pointer",variant:"danger",gap:3,children:f("targeted.offer.timeleft",["timeleft"],[l()])}),r.jsxs(pt,{gap:1,children:[r.jsxs(M,{gap:1,fullHeight:!0,children:[r.jsxs(M,{gap:1,column:!0,className:"w-75 text-black",children:[r.jsxs(A,{className:"bg-warning p-2",fullHeight:!0,children:[r.jsx("h4",{children:f(t.title)}),r.jsx(H,{dangerouslySetInnerHTML:{__html:t.description}})]}),r.jsxs(M,{alignSelf:"center",alignItems:"center",justifyContent:"center",gap:2,children:[t.purchaseLimit>1&&r.jsxs(M,{gap:1,children:[r.jsx(O,{variant:"muted",children:f("catalog.bundlewidget.quantity")}),r.jsx("input",{type:"number",value:i,onChange:u=>n(parseInt(u.target.value)),min:1,max:t.purchaseLimit})]}),r.jsx(V,{variant:"primary",disabled:!o,onClick:()=>c(),children:f("targeted.offer.button.buy")})]})]}),r.jsx(H,{className:"w-50",fullHeight:!0,style:{background:`url(${it("image.library.url")+t.imageUrl}) no-repeat center`}})]}),r.jsxs(M,{className:"price-ray position-absolute",alignItems:"center",justifyContent:"center",column:!0,children:[r.jsx(O,{children:f("targeted.offer.price.label")}),t.priceInCredits>0&&r.jsxs(M,{gap:1,children:[r.jsx(O,{variant:"light",children:t.priceInCredits}),r.jsx(ps,{type:-1})]}),t.priceInActivityPoints>0&&r.jsxs(M,{gap:1,children:[r.jsxs(O,{className:"ubuntu-bold",variant:"light",children:["+",t.priceInActivityPoints]})," ",r.jsx(ps,{type:t.activityPointType})]})]})]})]})},stt=()=>{const[a,t]=_.useState(null),[e,s]=_.useState(!1);if(Y(Yx,i=>{let n=i.getParser();n&&t(n.data)}),H0(()=>{k(new $S)}),!!a)return r.jsx(r.Fragment,{children:e?r.jsx(ett,{offer:a,setOpen:s}):r.jsx(ttt,{offer:a,setOpen:s})})},itt=a=>{const[t,e]=_.useState(0),[s,i]=_.useState(null),[n,o]=_.useState(!0),{showConfirm:l=null}=He();Y($d,g=>{e(0),i(null)}),Y(HS,g=>{e(0),i(null)}),Y(po,g=>{const E=g.getParser();E.roomEnter&&(E.data.habboGroupId>0?(e(E.data.habboGroupId),k(new ch(E.data.habboGroupId,!1))):(e(0),i(null)))}),Y(_M,g=>{const E=g.getParser();!s||E.groupId!==s.id&&E.groupId!==t||(e(0),i(null))}),Y(ph,g=>{const E=g.getParser();E.id===t&&i(E)});const c=()=>{l(f("group.leaveconfirm.desc"),()=>{k(new tp(s.id,q().userId))},null)},u=s&&s.ownerName===q().userName,h=()=>{if(u)return"group.manage";if(s.type===Fr.PRIVATE)return"";if(s.membershipType===Qs.MEMBER)return"group.leave";if(s.membershipType===Qs.NOT_MEMBER&&s.type===Fr.REGULAR)return"group.join";if(s.membershipType===Qs.REQUEST_PENDING)return"group.membershippending";if(s.membershipType===Qs.NOT_MEMBER&&s.type===Fr.EXCLUSIVE)return"group.requestmembership"},d=()=>{if(u)return T0(s.id);if(!(s.type===Fr.PRIVATE&&s.membershipType===Qs.NOT_MEMBER)){if(s.membershipType===Qs.MEMBER){c();return}bO(s.id)}};return s?r.jsx(H,{className:"nitro-notification-bubble rounded",children:r.jsxs(A,{children:[r.jsxs(M,{alignItems:"center",justifyContent:"between",pointer:!0,onClick:g=>o(E=>!E),children:[r.jsx(O,{variant:"white",children:f("group.homeroominfo.title")}),n&&r.jsx(dS,{className:"fa-icon"}),!n&&r.jsx(_S,{className:"fa-icon"})]}),n&&r.jsxs(r.Fragment,{children:[r.jsxs(M,{pointer:!0,alignItems:"center",gap:2,onClick:g=>C_(s.id),children:[r.jsx(H,{className:"group-badge",children:r.jsx(Ge,{badgeCode:s.badge,isGroup:!0})}),r.jsx(O,{variant:"white",children:s.title})]}),(s.type!==Fr.PRIVATE||u)&&r.jsx(V,{fullWidth:!0,variant:"success",disabled:s.membershipType===Qs.REQUEST_PENDING,onClick:d,children:f(h())})]})]})}):null},rtt=a=>{const{item:t=null,title:e=a.item&&a.item.title||"",onClose:s=null,...i}=a;return r.jsxs(x_,{fullWidth:!0,title:e,onClose:s,...i,children:[r.jsx(A,{fullHeight:!0,className:"py-1",overflow:"hidden",children:r.jsxs(M,{column:!0,fullWidth:!0,children:[r.jsx(M,{fullWidth:!0,style:{borderBottom:"1px solid #e0e0e0",fontWeight:"bold"},children:t.columns.map((n,o)=>r.jsx("div",{style:{flex:1,padding:"8px"},children:n},o))}),Array.from(t.rows.entries()).map(([n,o])=>r.jsx(M,{fullWidth:!0,style:{minHeight:"40px",borderBottom:"1px solid #f0f0f0"},children:Array.from(o.entries()).sort(([l],[c])=>l-c).map(([l,c])=>r.jsx("div",{style:{flex:1,textAlign:"center",padding:"8px"},children:c},l))},n)),Array.from(t.rows.entries()).map(([n,o])=>r.jsx("div",{style:{display:"flex",width:"100%",minHeight:"40px",alignItems:"center",borderBottom:"1px solid #f0f0f0"}},n))]})}),r.jsx("hr",{className:"my-2"}),r.jsx(A,{alignItems:"center",center:!0,gap:1,children:r.jsx(V,{onClick:s,children:f("generic.close")})})]})},ntt=a=>{const{title:t="Nitro",onClose:e=null,...s}=a;return r.jsxs(x_,{title:t,onClose:e,...s,children:[r.jsxs(_t,{children:[r.jsx(A,{center:!0,size:5,children:r.jsx("object",{data:"https://assets.nitrodev.co/logos/nitro-n-dark.svg",width:"100",height:"100",children:" "})}),r.jsxs(A,{size:7,children:[r.jsxs(A,{alignItems:"center",gap:0,children:[r.jsx(O,{bold:!0,fontSize:4,children:"Nitro React"}),r.jsxs(O,{children:["v",I0()]})]}),r.jsxs(A,{alignItems:"center",children:[r.jsxs(O,{children:[r.jsx("b",{children:"Renderer:"})," v",z7()]}),r.jsxs(A,{fullWidth:!0,gap:1,children:[r.jsx(V,{fullWidth:!0,variant:"success",onClick:i=>window.open("https://discord.nitrodev.co"),children:"Discord"}),r.jsxs(M,{gap:1,children:[r.jsx(V,{fullWidth:!0,onClick:i=>window.open("https://git.krews.org/nitro/nitro-react"),children:"Git"}),r.jsx(V,{fullWidth:!0,onClick:i=>window.open("https://git.krews.org/nitro/nitro-react/-/issues"),children:"Bug Report"})]})]})]})]})]}),r.jsx("hr",{className:"bg-dark"}),r.jsxs(_t,{children:[r.jsx(A,{center:!0,size:5,children:r.jsx("img",{src:"https://bobbahotel.it/template/img/favicon/favicon-96x96.png",width:"96",height:"96"})}),r.jsxs(A,{size:7,children:[r.jsxs(A,{alignItems:"center",gap:0,children:[r.jsx(O,{bold:!0,fontSize:4,children:"BoBBa Nitro"}),r.jsx(O,{children:"Developed by RealCosis & Violet02"})]}),r.jsx(A,{fullWidth:!0,gap:1,alignItems:"center",children:r.jsx(V,{fullWidth:!0,variant:"success",onClick:i=>window.open("https://discord.gg/bobba-hotel-365543584205897728"),children:"Discord di BoBBa"})})]})]})]})},att=a=>{const{item:t=null,title:e=a.item&&a.item.title||"",onClose:s=null,...i}=a,[n,o]=_.useState(!1),l=()=>{wc(t.clickUrl),s()},c=t.alertType===Bt.DEFAULT;return r.jsxs(x_,{title:e,onClose:s,...i,type:c?Bt.DEFAULT:t.alertType,children:[r.jsxs(M,{fullHeight:!0,overflow:"auto",gap:c||t.imageUrl&&!n?2:0,children:[c&&!t.imageUrl&&r.jsx(H,{className:"notification-frank flex-shrink-0"}),t.imageUrl&&!n&&r.jsx("img",{src:t.imageUrl,alt:t.title,onError:()=>{o(!0)},className:"align-self-baseline"}),r.jsxs(H,{classNames:["notification-text overflow-y-auto d-flex flex-column w-100",t.clickUrl&&!c?"justify-content-center":""],children:[t.messages.length>0&&t.messages.map((u,h)=>{const d=u.replace(/\r\n|\r|\n/g,"<br />");return r.jsx(H,{dangerouslySetInnerHTML:{__html:d}},h)}),t.clickUrl&&t.clickUrl.length>0&&t.imageUrl&&!n&&r.jsxs(r.Fragment,{children:[r.jsx("hr",{className:"my-2 w-100"}),r.jsx(V,{onClick:l,className:"align-self-center px-3",children:f(t.clickUrlText)})]})]})]}),(!t.imageUrl||t.imageUrl&&n)&&r.jsx(r.Fragment,{children:r.jsxs(A,{alignItems:"center",center:!0,gap:0,children:[r.jsx("hr",{className:"my-2 w-100"}),!t.clickUrl&&r.jsx(V,{onClick:s,children:f("generic.close")}),t.clickUrl&&t.clickUrl.length>0&&r.jsx(V,{onClick:l,children:f(t.clickUrlText)})]})})]})},ott=a=>{const{item:t=null,title:e=a.item&&a.item.title||"",onClose:s=null,...i}=a,[n,o]=_.useState(""),[l,c]=_.useState([]),u=()=>{wc(t.clickUrl),s()},h=g=>{let E=JSON.parse(t.messages[0]);c(E.filter(m=>m.includes(g))),o(g)};_.useEffect(()=>{c(JSON.parse(t.messages[0]))},[t]);const d=t.clickUrl&&t.clickUrl.startsWith("event:");return r.jsxs(x_,{title:e,onClose:s,...i,children:[r.jsx(M,{fullWidth:!0,alignItems:"center",position:"relative",children:r.jsx("input",{type:"text",className:"form-control form-control-sm",placeholder:f("generic.search"),value:n,onChange:g=>h(g.target.value)})}),r.jsx(A,{fullHeight:!0,className:"py-1",overflow:"hidden",children:r.jsx(Ce,{gap:1,columnCount:1,children:l&&l.map((g,E)=>r.jsx("span",{children:g},E))})}),r.jsx("hr",{className:"my-2"}),r.jsxs(A,{alignItems:"center",center:!0,gap:1,children:[!d&&!t.clickUrl&&r.jsx(V,{onClick:s,children:f("generic.close")}),t.clickUrl&&t.clickUrl.length>0&&r.jsx(V,{onClick:u,children:f(t.clickUrlText)})]})]})},ltt=(a,t)=>{if(!a)return null;const e={key:a.id,item:a,onClose:t};switch(a.alertType){case Bt.NITRO:return r.jsx(ntt,{...e});case Bt.TABLE:return r.jsx(rtt,{...e});case Bt.SEARCH:return r.jsx(ott,{...e});default:return r.jsx(att,{...e})}},ctt=a=>{const{item:t=null,onClose:e=null,...s}=a;return r.jsxs(UO,{fadesOut:!1,className:"flex-column club-gift",onClose:e,...s,children:[r.jsxs("div",{className:"d-flex align-items-center gap-2 mb-2",children:[r.jsx(ps,{type:"hc",className:"flex-shrink-0"}),r.jsx("span",{className:"ms-1",children:f("notifications.text.club_gift")})]}),r.jsxs("div",{className:"d-flex align-items-center justify-content-end gap-2",children:[r.jsx("button",{type:"button",className:"btn btn-success w-100 btn-sm",onClick:()=>wc(t.linkUrl),children:f("notifications.button.show_gift_list")}),r.jsx("span",{className:"text-decoration-underline cursor-pointer text-nowrap",onClick:e,children:f("notifications.button.later")})]})]})},utt=a=>{const{item:t=null,onClose:e=null,...s}=a,i=t.message.replace(/\r\n|\r|\n/g,"<br />");return r.jsxs(UO,{style:{backgroundColor:t.color},onClose:e,gap:2,alignItems:"center",onClick:n=>t.linkUrl&&t.linkUrl.length&&wc(t.linkUrl),...s,children:[r.jsx(M,{center:!0,className:"bubble-image-container",children:t.iconUrl&&t.iconUrl.length&&r.jsx("img",{className:"no-select",src:t.iconUrl,alt:""})}),r.jsx(O,{wrap:!0,variant:"white",dangerouslySetInnerHTML:{__html:i}})]})},htt=(a,t)=>{if(!a)return null;const e={key:a.id,item:a,onClose:t};switch(a.notificationType){case bi.CLUBGIFT:return r.jsx(ctt,{...e});default:return r.jsx(utt,{...e})}},dtt=a=>{const{item:t=null,onClose:e=null,...s}=a,{message:i=null,onConfirm:n=null,onCancel:o=null,confirmText:l=null,cancelText:c=null,title:u=null}=t,h=()=>{n&&n(),e()},d=()=>{o&&o(),e()};return r.jsxs(x_,{title:u,onClose:e,...s,type:Bt.ALERT,children:[r.jsx(M,{grow:!0,center:!0,children:r.jsx(O,{children:i})}),r.jsxs(M,{gap:1,children:[r.jsx(V,{fullWidth:!0,variant:"danger",onClick:d,children:c}),r.jsx(V,{fullWidth:!0,onClick:h,children:l})]})]})},_tt=(a,t)=>{if(!a)return null;const e={key:a.id,item:a,onClose:t};switch(a.confirmType){default:return r.jsx(dtt,{...e})}},gtt=a=>{const{alerts:t=[],bubbleAlerts:e=[],confirms:s=[],closeAlert:i=null,closeBubbleAlert:n=null,closeConfirm:o=null}=He(),l=_.useMemo(()=>{if(!t||!t.length)return null;const h=[];for(const d of t){const g=ltt(d,()=>i(d));h.push(g)}return h},[t,i]),c=_.useMemo(()=>{if(!e||!e.length)return null;const h=[];for(const d of e){const g=htt(d,()=>n(d));if(d.notificationType===bi.CLUBGIFT){h.unshift(g);continue}h.push(g)}return h},[e,n]),u=_.useMemo(()=>{if(!s||!s.length)return null;const h=[];for(const d of s){const g=_tt(d,()=>o(d));h.push(g)}return h},[s,o]);return r.jsxs(r.Fragment,{children:[r.jsx(A,{gap:1,children:c}),u,l]})},$A=a=>{const{type:t=-1,amount:e=-1,short:s=!1}=a,i=_.useMemo(()=>r.jsxs(M,{justifyContent:"end",pointer:!0,gap:1,className:"nitro-purse-button rounded",children:[r.jsx(O,{truncate:!0,textEnd:!0,variant:"white",grow:!0,children:s?m7(e):Nf(e)}),r.jsx(ps,{type:t})]}),[e,s,t]);return s?r.jsx(uS,{placement:"left",overlay:r.jsx(Jj,{id:`tooltip-${t}`,children:Nf(e)}),children:i}):i},ftt=a=>{const{type:t=-1,amount:e=-1}=a;return r.jsxs(M,{fullWidth:!0,justifyContent:"between",className:"nitro-purse-seasonal-currency p-2 rounded",children:[r.jsx(O,{variant:"white",children:f(`purse.seasonal.currency.${t}`)}),r.jsxs(M,{gap:1,children:[r.jsx(O,{variant:"white",children:Nf(e)}),r.jsx(ps,{type:t})]})]})},mtt=a=>{const{purse:t=null,hcDisabled:e=!1}=kc(),s=_.useMemo(()=>it("system.currency.types",[]),[]),i=_.useMemo(()=>it("currency.display.number.short",!1),[]),n=(()=>{if(!t)return null;const l=t.clubPeriods*31+t.clubDays,c=t.minutesUntilExpiration;return t.clubLevel===Fi.NO_CLUB?f("purse.clubdays.zero.amount.text"):c>-1&&c<60*24?Vr.shortFormat(c*60):Vr.shortFormat(l*86400)})(),o=(l,c=-1,u=!1)=>{if(!t||!t.activityPoints||!t.activityPoints.size)return null;const h=Array.from(t.activityPoints.keys()).filter(E=>s.indexOf(E)>=0);let d=0;for(;d<l;)h.shift(),d++;d=0;const g=[];for(const E of h){if(c>-1&&d===c)break;u?g.push(r.jsx(ftt,{type:E,amount:t.activityPoints.get(E)},E)):g.push(r.jsx($A,{type:E,amount:t.activityPoints.get(E),short:i},E)),d++}return g};return t?r.jsxs(A,{alignItems:"end",className:"nitro-purse-container",gap:1,children:[r.jsx(M,{className:"nitro-purse rounded-bottom p-1",children:r.jsxs(_t,{fullWidth:!0,gap:1,children:[r.jsxs(A,{justifyContent:"center",size:e?10:6,gap:0,children:[r.jsx($A,{type:-1,amount:t.credits,short:i}),o(0,2)]}),!e&&r.jsxs(A,{center:!0,pointer:!0,size:4,gap:1,className:"nitro-purse-subscription rounded",onClick:l=>ut("habboUI/open/hccenter"),children:[r.jsx(ps,{type:"hc"}),r.jsx(O,{variant:"white",children:n})]}),r.jsxs(A,{justifyContent:"center",size:2,gap:0,children:[r.jsx(M,{center:!0,pointer:!0,fullHeight:!0,className:"nitro-purse-button p-1 rounded",onClick:l=>ut("help/show"),children:r.jsx("i",{className:"icon icon-help"})}),r.jsx(M,{center:!0,pointer:!0,fullHeight:!0,className:"nitro-purse-button p-1 rounded",onClick:l=>ut("user-settings/toggle"),children:r.jsx("i",{className:"icon icon-cog"})})]})]})}),o(2,-1,!0)]}):null},Ett={purple:9452386,blue:3891856,green:6459451,yellow:10658089,lilac:6897548,orange:10841125,turquoise:2661026,red:10104881},ptt=a=>{const[t,e]=_.useState(!0),[s,i]=_.useState(""),[n,o]=_.useState("");x8(Rg.MYSTERY_BOX_KEYS_UPDATE,c=>{i(c.keyColor),o(c.boxColor)});const l=c=>{const u=Ett[c];return ir.int2rgb(u)};return s===""&&n===""?null:r.jsx(H,{className:"nitro-notification-bubble rounded mysterybox-extension",children:r.jsxs(A,{children:[r.jsxs(M,{alignItems:"center",justifyContent:"between",pointer:!0,onClick:c=>e(u=>!u),children:[r.jsx(O,{variant:"white",children:f("mysterybox.tracker.title")}),t&&r.jsx(dS,{className:"fa-icon"}),!t&&r.jsx(_S,{className:"fa-icon"})]}),t&&r.jsxs(r.Fragment,{children:[r.jsx(O,{variant:"white",children:f("mysterybox.tracker.description")}),r.jsxs(M,{justifyContent:"center",alignItems:"center",gap:2,children:[r.jsx(ee,{className:"mysterybox-container",children:r.jsx("div",{className:"box-image flex-shrink-0",style:{backgroundColor:l(n)},children:r.jsx("div",{className:"chain-overlay-image"})})}),r.jsx(ee,{className:"mysterybox-container",children:r.jsx("div",{className:"key-image flex-shrink-0",style:{backgroundColor:l(s)},children:r.jsx("div",{className:"key-overlay-image"})})})]})]})]})})},Itt=a=>{const{eventId:t=-1,eventName:e="",eventDescription:s="",setIsEditingPromote:i=null}=a,[n,o]=_.useState(e),[l,c]=_.useState(s),u=()=>{k(new CL(t,n,l)),i(!1)};return r.jsxs(Ot,{className:"nitro-guide-tool",children:[r.jsx(St,{headerText:f("navigator.eventsettings.editcaption"),onCloseClick:()=>i(!1)}),r.jsxs(pt,{className:"text-black",children:[r.jsxs(A,{children:[r.jsx(O,{bold:!0,children:f("navigator.eventsettings.name")}),r.jsx("input",{type:"text",className:"form-control form-control-sm",placeholder:f("navigator.eventsettings.name"),maxLength:64,value:n,onChange:h=>o(h.target.value)})]}),r.jsxs(A,{children:[r.jsx(O,{bold:!0,children:f("navigator.eventsettings.desc")}),r.jsx("textarea",{className:"form-control form-control-sm",placeholder:f("navigator.eventsettings.desc"),maxLength:64,value:l,onChange:h=>c(h.target.value)})]}),r.jsx(A,{children:r.jsx(V,{fullWidth:!0,disabled:!n||!l,variant:!n||!l?"danger":"success",onClick:h=>u(),children:f("navigator.eventsettings.edit")})})]})]})},Ttt=a=>{const{eventDescription:t="",setIsEditingPromote:e=null}=a,{setIsExtended:s}=GO(),i=()=>{s(!0),ut("catalog/open/room_event")};return r.jsxs(r.Fragment,{children:[r.jsx(M,{alignItems:"center",gap:2,style:{overflowWrap:"anywhere"},children:r.jsx(O,{variant:"white",children:t})}),r.jsx("br",{}),r.jsx("br",{}),r.jsxs(_t,{className:"d-flex align-items-center justify-content-end gap-2",children:[r.jsx(V,{className:"btn btn-primary w-100 btn-sm",onClick:n=>e(!0),children:f("navigator.roominfo.editevent")}),r.jsx(V,{className:"btn btn-success w-100 btn-sm",onClick:n=>i(),children:f("roomad.extend.event")})]})]})},Rtt=a=>{const{eventDescription:t=""}=a;return r.jsxs(r.Fragment,{children:[r.jsx(M,{alignItems:"center",gap:2,style:{overflowWrap:"anywhere"},children:r.jsx(O,{variant:"white",children:t})}),r.jsx("br",{}),r.jsx("br",{}),r.jsx(A,{alignItems:"center",gap:1,children:r.jsxs(H,{fullWidth:!0,overflow:"hidden",position:"relative",className:"bg-light-dark rounded",children:[r.jsx(M,{fit:!0,center:!0,position:"absolute",children:r.jsx(O,{variant:"white",center:!0,children:f("navigator.eventinprogress")})}),r.jsx(O,{children:" "})]})})]})},Stt=a=>{const[t,e]=_.useState(!1),[s,i]=_.useState(!0),{promoteInformation:n,setPromoteInformation:o}=GO();return Y($d,l=>{o(null)}),n?r.jsx(r.Fragment,{children:n.data.adId!==-1&&r.jsx(H,{className:"nitro-notification-bubble rounded",children:r.jsxs(A,{children:[r.jsxs(M,{alignItems:"center",justifyContent:"between",pointer:!0,onClick:l=>i(c=>!c),children:[r.jsx(O,{variant:"white",overflow:"hidden",children:n.data.eventName}),s&&r.jsx(dS,{className:"fa-icon"}),!s&&r.jsx(_S,{className:"fa-icon"})]}),s&&q().userId!==n.data.ownerAvatarId&&r.jsx(Rtt,{eventDescription:n.data.eventDescription}),s&&q().userId===n.data.ownerAvatarId&&r.jsx(Ttt,{eventDescription:n.data.eventDescription,setIsEditingPromote:()=>e(!0)}),t&&r.jsx(Itt,{eventId:n.data.adId,eventName:n.data.eventName,eventDescription:n.data.eventDescription,setIsEditingPromote:()=>e(!1)})]})})}):null},Ott=a=>r.jsx("div",{className:"nitro-right-side",children:r.jsxs(A,{position:"relative",gap:1,children:[r.jsx(mtt,{}),r.jsx(itt,{}),r.jsx(ptt,{}),r.jsx(stt,{}),r.jsx(Stt,{}),r.jsx(gtt,{})]})}),Ctt=a=>r.jsx("div",{className:"room-spectator"}),Att=a=>{const[t,e]=_.useState(null),[s,i]=_.useState(null),{chatStyleId:n=0}=Oo(),{roomSession:o=null}=ye();Y(Jy,c=>{const u=c.getParser();if(!u)return;const h=o.userDataManager.getPetData(u.petId);h&&(e(h),i(u))});const l=(c,u)=>{!c||!u||o==null||o.sendChatMessage(`${c} ${u}`,n)};return!t||!s?null:r.jsxs(Ot,{uniqueKey:"user-settings",className:"user-settings-window no-resize",children:[r.jsx(St,{headerText:f("widgets.pet.commands.title"),onCloseClick:()=>i(null)}),r.jsxs(pt,{className:"text-black",children:[r.jsx(M,{alignItems:"center",justifyContent:"center",gap:2,children:r.jsxs(_t,{columnCount:2,children:[r.jsx(A,{fullWidth:!0,overflow:"hidden",className:"body-image pet p-1",children:r.jsx(Ca,{figure:t.figure,posture:"std",direction:2})}),r.jsx(O,{variant:"black",small:!0,wrap:!0,children:t.name})]})}),r.jsx(_t,{columnCount:2,children:s.commands&&s.commands.length>0&&s.commands.map((c,u)=>r.jsx(V,{disabled:!s.enabledCommands.includes(c),onClick:()=>l(t.name,f(`pet.command.${c}`)),children:f(`pet.command.${c}`)},u))})]})]})},Pi=a=>{const{justifyContent:t="center",alignItems:e="center",classNames:s=[],...i}=a,n=_.useMemo(()=>{const o=["menu-header","p-1"];return s.length&&o.push(...s),o},[s]);return r.jsx(M,{justifyContent:t,alignItems:e,classNames:n,...i})},Ntt=a=>{const{chatEvent:t=null,onClose:e=null}=a,[s,i]=_.useState(t.chat==="${bot.skill.chatter.configuration.text.placeholder}"?"":t.chat),[n,o]=_.useState(t.automaticChat),[l,c]=_.useState(t.mixSentences),[u,h]=_.useState(t.chatDelay),d=_.useMemo(()=>NO(ie().roomId,t.objectId,t.category,1),[t]),g=m=>m.replace(/;#;/g," ").replace(/\r\n|\r|\n/g,"\r"),E=()=>{const m=g(s)+";#;"+n+";#;"+u+";#;"+l;k(new Xn(t.botId,Ke.SETUP_CHAT,m)),e()};return r.jsx(ml,{windowPosition:ri.NOTHING,handleSelector:".drag-handler",dragStyle:{top:d.y,left:d.x},children:r.jsxs(H,{className:"nitro-context-menu bot-chat",children:[r.jsx(Pi,{className:"drag-handler",children:f("bot.skill.chatter.configuration.title")}),r.jsxs(A,{className:"p-1",children:[r.jsxs(A,{gap:1,children:[r.jsx(O,{variant:"white",children:f("bot.skill.chatter.configuration.chat.text")}),r.jsx("textarea",{className:"form-control form-control-sm",placeholder:f("bot.skill.chatter.configuration.text.placeholder"),value:s,rows:7,onChange:m=>i(m.target.value)})]}),r.jsxs(A,{gap:1,children:[r.jsxs(M,{gap:1,alignItems:"center",justifyContent:"between",children:[r.jsx(O,{fullWidth:!0,variant:"white",children:f("bot.skill.chatter.configuration.automatic.chat")}),r.jsx("input",{type:"checkbox",className:"form-check-input",checked:n,onChange:m=>o(m.target.checked)})]}),r.jsxs(M,{gap:1,alignItems:"center",justifyContent:"between",children:[r.jsx(O,{fullWidth:!0,variant:"white",children:f("bot.skill.chatter.configuration.markov")}),r.jsx("input",{type:"checkbox",className:"form-check-input",checked:l,onChange:m=>c(m.target.checked)})]}),r.jsxs(M,{gap:1,alignItems:"center",justifyContent:"between",children:[r.jsx(O,{fullWidth:!0,variant:"white",children:f("bot.skill.chatter.configuration.chat.delay")}),r.jsx("input",{type:"number",className:"form-control form-control-sm",value:u,onChange:m=>h(m.target.valueAsNumber)})]})]}),r.jsxs(M,{alignItems:"center",justifyContent:"between",gap:1,children:[r.jsx(V,{fullWidth:!0,variant:"primary",onClick:e,children:f("cancel")}),r.jsx(V,{fullWidth:!0,variant:"success",onClick:E,children:f("save")})]})]})]})})},ZA=-1,tN=0,eN=1,sN=2,iN=3,rN=4,nN=5,aN=6,xtt=a=>{const{item:t=null,onClose:e=null}=a,[s,i]=_.useState(ZA),[n,o]=_.useState(null),[l,c]=_.useState(null),{roomSession:u=null}=ye(),h=()=>{n&&tt().selectRoomObject(u.roomId,n.roomIndex,W.UNIT)},d=()=>{u.usePetProduct(t.requestRoomObjectId,n.webID),e()},g=_.useMemo(()=>{if(!n||!l)return null;const E=new La(n.figure),m=l.customParams.split(" "),I=parseInt(m[0]);switch(l.specialType){case vt.PET_SHAMPOO:{if(m.length<2)return null;const p=tt().getPetColorResult(I,E.paletteId),T=tt().getPetColorResultsForTag(I,m[1]);let R=-1;for(const S of T)if(S.breed===p.breed){R=parseInt(S.id);break}return r.jsx(Ca,{typeId:E.typeId,paletteId:R,petColor:E.color,customParts:E.customParts,direction:2})}case vt.PET_CUSTOM_PART:{if(m.length<4)return null;const p=[],T=m[1].split(",").map(N=>parseInt(N)),R=m[2].split(",").map(N=>parseInt(N)),S=m[3].split(",").map(N=>parseInt(N));let b=0;for(;b<T.length;){const N=T[b],P=E.getCustomPart(N);let B=S[b];P!=null&&(B=P.paletteId),p.push(new ng(N,R[b],B)),b++}return r.jsx(Ca,{typeId:E.typeId,paletteId:E.paletteId,petColor:E.color,customParts:p,direction:2})}case vt.PET_CUSTOM_PART_SHAMPOO:{if(m.length<3)return null;const p=[],T=m[1].split(",").map(b=>parseInt(b)),R=m[2].split(",").map(b=>parseInt(b));let S=0;for(;S<T.length;){const b=T[S],N=E.getCustomPart(b);let P=-1;N!=null&&(P=N.partId),p.push(new ng(T[S],P,R[S])),S++}return r.jsx(Ca,{typeId:E.typeId,paletteId:E.paletteId,petColor:E.color,customParts:p,direction:2})}case vt.PET_SADDLE:{if(m.length<4)return null;const p=[],T=m[1].split(",").map(N=>parseInt(N)),R=m[2].split(",").map(N=>parseInt(N)),S=m[3].split(",").map(N=>parseInt(N));let b=0;for(;b<T.length;)p.push(new ng(T[b],R[b],S[b])),b++;for(const N of E.customParts)T.indexOf(N.layerId)===-1&&p.push(N);return r.jsx(Ca,{typeId:E.typeId,paletteId:E.paletteId,petColor:E.color,customParts:p,direction:2})}case vt.MONSTERPLANT_REBREED:case vt.MONSTERPLANT_REVIVAL:case vt.MONSTERPLANT_FERTILIZE:{let p="rip";const T=tt().getRoomObject(u.roomId,n.roomIndex,W.UNIT);if(T&&(p=T.model.getValue(C.FIGURE_POSTURE),p==="rip")){const R=n.petLevel;R<7?p=`grw${R}`:p="std"}return r.jsx(Ca,{typeId:E.typeId,paletteId:E.paletteId,petColor:E.color,customParts:E.customParts,posture:p,direction:2})}}},[n,l,u]);return _.useEffect(()=>{const E=u.userDataManager.getUserDataByIndex(t.id);o(E);const m=ip(u.roomId,t.requestRoomObjectId,W.FLOOR);if(!m)return;c(m);let I=ZA;switch(m.specialType){case vt.PET_SHAMPOO:I=tN;break;case vt.PET_CUSTOM_PART:I=eN;break;case vt.PET_CUSTOM_PART_SHAMPOO:I=sN;break;case vt.PET_SADDLE:I=iN;break;case vt.MONSTERPLANT_REVIVAL:I=rN;break;case vt.MONSTERPLANT_REBREED:I=nN;break;case vt.MONSTERPLANT_FERTILIZE:I=aN;break}i(I)},[u,t]),n?r.jsxs(Ot,{className:"nitro-use-product-confirmation",children:[r.jsx(St,{headerText:f("useproduct.widget.title",["name"],[n.name]),onCloseClick:e}),r.jsx(pt,{center:!0,children:r.jsxs(M,{gap:2,overflow:"hidden",children:[r.jsx(A,{children:r.jsx(H,{pointer:!0,className:"product-preview",onClick:h,children:g})}),r.jsxs(A,{justifyContent:"between",overflow:"auto",children:[r.jsxs(A,{gap:2,children:[s===tN&&r.jsxs(r.Fragment,{children:[r.jsx(O,{children:f("useproduct.widget.text.shampoo",["productName"],[l.name])}),r.jsx(O,{children:f("useproduct.widget.info.shampoo")})]}),s===eN&&r.jsxs(r.Fragment,{children:[r.jsx(O,{children:f("useproduct.widget.text.custompart",["productName"],[l.name])}),r.jsx(O,{children:f("useproduct.widget.info.custompart")})]}),s===sN&&r.jsxs(r.Fragment,{children:[r.jsx(O,{children:f("useproduct.widget.text.custompartshampoo",["productName"],[l.name])}),r.jsx(O,{children:f("useproduct.widget.info.custompartshampoo")})]}),s===iN&&r.jsxs(r.Fragment,{children:[r.jsx(O,{children:f("useproduct.widget.text.saddle",["productName"],[l.name])}),r.jsx(O,{children:f("useproduct.widget.info.saddle")})]}),s===rN&&r.jsxs(r.Fragment,{children:[r.jsx(O,{children:f("useproduct.widget.text.revive_monsterplant",["productName"],[l.name])}),r.jsx(O,{children:f("useproduct.widget.info.revive_monsterplant")})]}),s===nN&&r.jsxs(r.Fragment,{children:[r.jsx(O,{children:f("useproduct.widget.text.rebreed_monsterplant",["productName"],[l.name])}),r.jsx(O,{children:f("useproduct.widget.info.rebreed_monsterplant")})]}),s===aN&&r.jsxs(r.Fragment,{children:[r.jsx(O,{children:f("useproduct.widget.text.fertilize_monsterplant",["productName"],[l.name])}),r.jsx(O,{children:f("useproduct.widget.info.fertilize_monsterplant")})]})]}),r.jsxs(M,{alignItems:"center",justifyContent:"between",children:[r.jsx(V,{variant:"danger",onClick:e,children:f("useproduct.widget.cancel")}),r.jsx(V,{variant:"success",onClick:d,children:f("useproduct.widget.use")})]})]})]})})]}):null},Z=a=>{const{disabled:t=!1,fullWidth:e=!0,justifyContent:s="center",alignItems:i="center",classNames:n=[],onClick:o=null,...l}=a,c=h=>{t||o&&o(h)},u=_.useMemo(()=>{const h=["menu-item","list-item"];return t&&h.push("disabled"),n.length&&h.push(...n),h},[t,n]);return r.jsx(M,{fullWidth:e,justifyContent:s,alignItems:i,classNames:u,onClick:c,...l})},Mtt=a=>{const{justifyContent:t="center",alignItems:e="center",classNames:s=[],collapsed:i=!0,...n}=a,o=_.useMemo(()=>{const l=["menu-footer"];return s.length&&l.push(...s),l},[s]);return r.jsxs(M,{justifyContent:t,alignItems:e,classNames:o,...n,children:[!i&&r.jsx(oS,{className:"fa-icon align-self-center"}),i&&r.jsx(aS,{className:"fa-icon align-self-center"})]})},ytt=25,oN=3,Dtt=5e3,btt=75,Kc=10;let wp=!1,J_=null,$_=-1e6,Fp=1;const Ba=a=>{const{objectId:t=-1,category:e=-1,userType:s=-1,fades:i=!1,onClose:n=null,position:o="absolute",classNames:l=[],style:c={},children:u=null,collapsable:h=!1,...d}=a,[g,E]=_.useState({x:null,y:null}),[m,I]=_.useState(1),[p,T]=_.useState(!1),[R,S]=_.useState(wp),b=_.useRef(),N=_.useCallback(w=>{if(!p)return;Fp+=w;let U=(1-Fp/btt)*1;if(U<=0)return n(),!1;I(U)},[p,n]),P=_.useCallback((w,U)=>{if(!w||!U||!J_)return;let G=-b.current.offsetHeight;s>-1&&(s===be.USER||s===be.BOT||s===be.RENTABLE_BOT)?G=G+(w.height>50?15:0):G=G-14,J_.addValue(U.y-w.top);let K=J_.getMax();K<$_-oN&&(K=$_-oN),$_=K;const z=U.y-K;let et=~~(U.x-b.current.offsetWidth/2),rt=~~(z+G);const J=Jt().width-b.current.offsetWidth-Kc,Ct=Jt().height-b.current.offsetHeight-Kc;et<Kc?et=Kc:et>J&&(et=J),rt<Kc?rt=Kc:rt>Ct&&(rt=Ct),E({x:et,y:rt})},[s]),B=_.useMemo(()=>{const w=["nitro-context-menu"];return R&&w.push("menu-hidden"),w.push(g.x!==null?"visible":"invisible"),l.length&&w.push(...l),w},[g,l,R]),F=_.useMemo(()=>{let w={};return w.left=g.x||0,w.top=g.y||0,w.opacity=m,Object.keys(c).length&&(w={...w,...c}),w},[g,m,c]);return _.useEffect(()=>{if(!b.current)return;const w=U=>{if(!b.current)return;N(U);const G=NO(ie().roomId,t,e),K=c0(ie().roomId,t,e);P(G,K)};return fi().add(w),()=>{fi().remove(w)}},[t,e,N,P]),_.useEffect(()=>{if(!i)return;const w=setTimeout(()=>T(!0),Dtt);return()=>clearTimeout(w)},[i]),_.useEffect(()=>{wp=R},[R]),_.useEffect(()=>{J_=new Kw(ytt),$_=-1e6,Fp=1},[]),r.jsxs(H,{innerRef:b,position:o,classNames:B,style:F,...d,children:[!(h&&wp)&&u,h&&r.jsx(Mtt,{onClick:()=>S(!R),collapsed:R})]})},lN=0,cN=1,uN=2,hN=3,dN=4,_N=5,gN=6,fN=7,vtt=a=>{const{item:t=null,updateConfirmingProduct:e=null,onClose:s=null}=a,[i,n]=_.useState(0),{roomSession:o=null}=ye(),l=c=>{if(c)switch(c){case"use_product":case"use_product_shampoo":case"use_product_custom_part":case"use_product_custom_part_shampoo":case"use_product_saddle":case"replace_product_saddle":case"revive_monsterplant":case"rebreed_monsterplant":case"fertilize_monsterplant":e(t);break}};return _.useEffect(()=>{if(!t)return;const c=ip(o.roomId,t.requestRoomObjectId,W.FLOOR);if(!c)return;let u=lN;switch(c.specialType){case vt.PET_SHAMPOO:u=cN;break;case vt.PET_CUSTOM_PART:u=uN;break;case vt.PET_CUSTOM_PART_SHAMPOO:u=hN;break;case vt.PET_SADDLE:u=dN;break;case vt.MONSTERPLANT_REVIVAL:u=_N;break;case vt.MONSTERPLANT_REBREED:u=gN;break;case vt.MONSTERPLANT_FERTILIZE:u=fN;break}n(u)},[o,t]),r.jsxs(Ba,{objectId:t.id,category:W.UNIT,userType:be.PET,onClose:s,collapsable:!0,children:[r.jsx(Pi,{children:t.name}),i===lN&&r.jsx(Z,{onClick:c=>l("use_product"),children:f("infostand.button.useproduct")}),i===cN&&r.jsx(Z,{onClick:c=>l("use_product_shampoo"),children:f("infostand.button.useproduct_shampoo")}),i===uN&&r.jsx(Z,{onClick:c=>l("use_product_custom_part"),children:f("infostand.button.useproduct_custom_part")}),i===hN&&r.jsx(Z,{onClick:c=>l("use_product_custom_part_shampoo"),children:f("infostand.button.useproduct_custom_part_shampoo")}),i===dN&&r.jsxs(r.Fragment,{children:[t.replace&&r.jsx(Z,{onClick:c=>l("replace_product_saddle"),children:f("infostand.button.replaceproduct_saddle")}),!t.replace&&r.jsx(Z,{onClick:c=>l("use_product_saddle"),children:f("infostand.button.useproduct_saddle")})]}),i===_N&&r.jsx(Z,{onClick:c=>l("revive_monsterplant"),children:f("infostand.button.revive_monsterplant")}),i===gN&&r.jsx(Z,{onClick:c=>l("rebreed_monsterplant"),children:f("infostand.button.rebreed_monsterplant")}),i===fN&&r.jsx(Z,{onClick:c=>l("fertilize_monsterplant"),children:f("infostand.button.fertilize_monsterplant")})]})},Ltt=a=>{const{avatarInfo:t=null,onClose:e=null}=a;return t?r.jsx(A,{className:"nitro-infostand rounded",children:r.jsxs(A,{overflow:"visible",className:"container-fluid content-area",gap:1,children:[r.jsxs(A,{gap:1,children:[r.jsxs(M,{alignItems:"center",justifyContent:"between",gap:1,children:[r.jsx(O,{variant:"white",small:!0,wrap:!0,children:t.name}),r.jsx(zr,{className:"cursor-pointer fa-icon",onClick:e})]}),r.jsx("hr",{className:"m-0"})]}),r.jsxs(A,{gap:1,children:[r.jsxs(M,{gap:1,children:[r.jsx(A,{fullWidth:!0,className:"body-image bot",children:r.jsx(ls,{figure:t.figure,direction:4})}),r.jsx(A,{grow:!0,center:!0,gap:0,children:t.badges.length>0&&t.badges.map(s=>r.jsx(Ge,{badgeCode:s,showInfo:!0},s))})]}),r.jsx("hr",{className:"m-0"})]}),r.jsx(M,{alignItems:"center",className:"bg-light-dark rounded py-1 px-2",children:r.jsx(O,{fullWidth:!0,wrap:!0,textBreak:!0,variant:"white",small:!0,className:"motto-content",children:t.motto})}),t.carryItem>0&&r.jsxs(A,{gap:1,children:[r.jsx("hr",{className:"m-0"}),r.jsx(O,{variant:"white",small:!0,wrap:!0,children:f("infostand.text.handitem",["item"],[f("handitem"+t.carryItem)])})]})]})}):null},Gp=0,mN=1,EN=2,Ptt=a=>{const{avatarInfo:t=null,onClose:e=null}=a,{roomSession:s=null}=ye(),[i,n]=_.useState(0),[o,l]=_.useState(!1),[c,u]=_.useState(!1),[h,d]=_.useState(!1),[g,E]=_.useState([]),[m,I]=_.useState([]),[p,T]=_.useState([]),[R,S]=_.useState([]),[b,N]=_.useState(!1),[P,B]=_.useState(0),[F,w]=_.useState(0),[U,G]=_.useState(!1),[K,z]=_.useState(!1),[et,rt]=_.useState(null),[J,Ct]=_.useState(!1),[At,se]=_.useState(!1),[ve,ss]=_.useState(-1),[qe,ni]=_.useState(""),[ge,Rs]=_.useState(""),{showNotification:mi=null}=He();Pl(xa.NPE_SONG_CHANGED,Ut=>{ss(Ut.id)},J||At),Pl(bc.SIR_TRAX_SONG_INFO_RECEIVED,Ut=>{if(Ut.id!==ve)return;const It=Jt().soundManager.musicController.getSongInfo(Ut.id);It&&(ni(It.name),Rs(It.creator))},J||At),_.useEffect(()=>{let Ut=Gp,It=!1,jt=!1,Vs=!1,xr=[],Ai=[],b_=[],Rh=[],Sh=!1,Il=0,Vc=0,Tl=!1,Rl=!1,Oh=!1,Sl=!1,Ao=-1;const Ol=t.roomControllerLevel>=Oe.GUEST;if((Ol||t.isOwner||t.isRoomOwner||t.isAnyRoomController)&&(It=!0,jt=!t.isWallItem,t.roomControllerLevel>=Oe.MODERATOR&&(Tl=!0)),t.isAnyRoomController&&(Rl=!0),(t.usagePolicy===Eg.EVERYBODY||t.usagePolicy===Eg.CONTROLLER&&Ol||t.extraParam===Ms.JUKEBOX&&Ol||t.extraParam===Ms.USABLE_PRODUCT&&Ol)&&(Vs=!0),t.extraParam){if(t.extraParam===Ms.CRACKABLE_FURNI){const Bi=t.stuffData;Vs=!0,Sh=!0,Il=Bi.hits,Vc=Bi.target}else if(t.extraParam===Ms.JUKEBOX){const Bi=Jt().soundManager.musicController.getRoomItemPlaylist();Bi&&(Ao=Bi.nowPlayingSongId),Oh=!0}else t.extraParam.indexOf(Ms.SONGDISK)===0&&(Ao=parseInt(t.extraParam.substr(Ms.SONGDISK.length)),Sl=!0);if(Tl){const Bi=t.extraParam.substr(Ms.BRANDING_OPTIONS.length);if(Bi){const Cl=Bi.split("	");for(const Mr of Cl){const yr=Mr.split("=");yr&&yr.length===2&&(xr.push(yr[0]),Ai.push(yr[1]))}}}}if(Tl){const Bi=tt().getRoomObject(s.roomId,t.id,t.isWallItem?W.WALL:W.FLOOR);if(Bi){const Cl=Bi.model.getValue(C.FURNITURE_CUSTOM_VARIABLES),Mr=Bi.model.getValue(C.FURNITURE_DATA);if(Cl&&Cl.length)for(const yr of Cl)b_.push(yr),Rh.push(Mr[yr]||"")}}t.isOwner||t.isAnyRoomController?Ut=EN:(t.isRoomOwner||t.roomControllerLevel>=Oe.GUILD_ADMIN)&&(Ut=mN),t.isStickie&&(Ut=Gp),n(Ut),l(It),u(jt),d(Vs),E(xr),I(Ai),T(b_),S(Rh),N(Sh),B(Il),w(Vc),G(Tl),z(Rl),rt(null),Ct(Oh),se(Sl),ss(Ao),t.groupId&&k(new ch(t.groupId,!1))},[s,t]),Y(ph,Ut=>{const It=Ut.getParser();!t||t.groupId!==It.id||It.flag||(et&&rt(null),rt(It.title))}),_.useEffect(()=>{const Ut=Jt().soundManager.musicController.getSongInfo(ve);ni((Ut==null?void 0:Ut.name)??""),Rs((Ut==null?void 0:Ut.creator)??"")},[ve]);const pe=_.useCallback((Ut,It)=>{const jt=Array.from(m);jt[Ut]=It,I(jt)},[m]),Wt=_.useCallback((Ut,It)=>{const jt=Array.from(R);jt[Ut]=It,S(jt)},[R]),We=_.useCallback(()=>{if(g.length===0||m.length===0)return"";let Ut="",It=0;for(;It<g.length;){const jt=g[It],Vs=m[It];Ut=Ut+(jt+"="+Vs+"	"),It++}return Ut},[g,m]),Be=_.useCallback(Ut=>{if(!(!Ut||Ut===""))switch(Ut){case"buy_one":ut(`catalog/open/offerId/${t.purchaseOfferId}`);return;case"move":tt().processRoomObjectOperation(t.id,t.category,Ft.OBJECT_MOVE);break;case"rotate":tt().processRoomObjectOperation(t.id,t.category,Ft.OBJECT_ROTATE_POSITIVE);break;case"pickup":i===EN?tt().processRoomObjectOperation(t.id,t.category,Ft.OBJECT_PICKUP):tt().processRoomObjectOperation(t.id,t.category,Ft.OBJECT_EJECT);break;case"use":tt().useRoomObject(t.id,t.category);break;case"save_branding_configuration":{const It=new Map,jt=We().split("	");if(jt)for(const Vs of jt){const[xr,Ai]=Vs.split("=",2);It.set(xr,Ai)}tt().modifyRoomObjectDataWithMap(t.id,t.category,Ft.OBJECT_SAVE_STUFF_DATA,It);break}case"save_custom_variables":{const It=new Map;for(let jt=0;jt<p.length;jt++){const Vs=p[jt],xr=R[jt];Vs&&Vs.length&&xr&&xr.length&&It.set(Vs,xr)}k(new oO(t.id,It));break}}},[t,i,p,R,We]),In=_.useCallback(()=>{const Ut=t.stuffData;return!Ut||!(Ut instanceof Vn)?null:Ut.getValue(2)},[t]);if(!t)return null;const pl=()=>{navigator.clipboard.writeText(t.id.toString()).then(()=>{var Ut=new Map;Ut.set("display","BUBBLE"),Ut.set("message","L'id del furno è stato copiato!"),Ut.set("color","#185D79"),Ut.set("sound","copy"),mi("generic",Ut)})},Th=r.jsx(Sc,{id:"popover-basic",children:r.jsx(Sc.Body,{className:"text-black py-2 px-3",children:r.jsx("h5",{children:t.winReason})})});return r.jsxs(A,{gap:1,alignItems:"end",children:[r.jsx(A,{className:"nitro-infostand rounded",children:r.jsxs(A,{overflow:"visible",className:"container-fluid content-area",gap:1,children:[r.jsxs(A,{gap:1,children:[r.jsxs(M,{alignItems:"center",justifyContent:"between",gap:1,children:[r.jsx(O,{variant:"white",small:!0,wrap:!0,children:t.name}),r.jsx(zr,{className:"cursor-pointer fa-icon",onClick:e})]}),r.jsx("hr",{className:"m-0"})]}),r.jsxs(A,{gap:1,children:[r.jsxs(M,{position:"relative",gap:1,children:[t.stuffData.isUnique&&r.jsx("div",{className:"position-absolute end-0",children:r.jsx(y0,{uniqueNumber:t.stuffData.uniqueNumber,uniqueSeries:t.stuffData.uniqueSeries})}),t.stuffData.rarityLevel>-1&&r.jsx("div",{className:"position-absolute end-0",children:r.jsx(wO,{level:t.stuffData.rarityLevel})}),t.image&&t.image.src.length&&r.jsx("img",{className:"d-block mx-auto",src:t.image.src,alt:""})]}),r.jsx("hr",{className:"m-0"})]}),r.jsxs(A,{gap:1,children:[r.jsx(O,{fullWidth:!0,wrap:!0,textBreak:!0,variant:"white",small:!0,children:t.description}),r.jsx("hr",{className:"m-0"})]}),r.jsxs(A,{gap:1,children:[r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx(Cr,{userId:t.ownerId}),r.jsx(O,{variant:"white",small:!0,wrap:!0,children:f("furni.owner",["name"],[t.ownerName])})]}),t.purchaseOfferId>0&&r.jsx(M,{children:r.jsx(O,{variant:"white",small:!0,underline:!0,pointer:!0,onClick:Ut=>Be("buy_one"),children:f("infostand.button.buy")})})]}),(J||At)&&r.jsxs(A,{gap:1,children:[r.jsx("hr",{className:"m-0"}),ve===-1&&r.jsx(O,{variant:"white",small:!0,wrap:!0,children:f("infostand.jukebox.text.not.playing")}),!!qe.length&&r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx(H,{className:"icon disk-icon"}),r.jsx(O,{variant:"white",small:!0,wrap:!0,children:qe})]}),!!ge.length&&r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx(H,{className:"icon disk-creator"}),r.jsx(O,{variant:"white",small:!0,wrap:!0,children:ge})]})]}),r.jsxs(A,{gap:1,children:[b&&r.jsxs(r.Fragment,{children:[r.jsx("hr",{className:"m-0"}),r.jsx(O,{variant:"white",small:!0,wrap:!0,children:f("infostand.crackable_furni.hits_remaining",["hits","target"],[P.toString(),F.toString()])})]}),t.groupId>0&&r.jsxs(r.Fragment,{children:[r.jsx("hr",{className:"m-0"}),r.jsxs(M,{pointer:!0,alignItems:"center",gap:2,onClick:()=>C_(t.groupId),children:[r.jsx(Ge,{badgeCode:In(),isGroup:!0}),r.jsx(O,{variant:"white",underline:!0,children:et})]})]}),r.jsx("hr",{className:"m-0"}),t.rareValue!==0&&r.jsxs(M,{gap:1,children:[r.jsx(O,{small:!0,wrap:!0,variant:"white",children:"Valore del raro:"}),r.jsxs(O,{small:!0,wrap:!0,variant:"info",fontWeight:"extraBold",children:[t.rareValue," crystals"]})]}),U&&r.jsxs(r.Fragment,{children:[r.jsx("hr",{className:"m-0"}),K&&r.jsxs(M,{gap:1,children:[r.jsx(O,{onClick:Ut=>pl(),small:!0,wrap:!0,variant:"white",children:"ID:"}),r.jsx(O,{onClick:Ut=>pl(),small:!0,wrap:!0,fontWeight:"extraBold",variant:"warning",children:t.id})]}),r.jsx("hr",{className:"m-0"}),K&&t.rareValue!==0&&r.jsxs(M,{gap:1,children:[r.jsx(O,{small:!0,wrap:!0,variant:"white",children:"Raro:"}),t.validRare&&r.jsx(uS,{trigger:["hover","focus"],placement:"left",overlay:Th,children:r.jsx("div",{children:r.jsx(O,{small:!0,wrap:!0,fontWeight:"extraBold",variant:"green",children:"REGOLARE"})})}),!t.validRare&&r.jsx(O,{small:!0,wrap:!0,fontWeight:"extraBold",variant:"red",children:"IRREGOLARE"})]}),g.length>0&&r.jsxs(r.Fragment,{children:[r.jsx("hr",{className:"m-0"}),r.jsx(A,{gap:1,children:g.map((Ut,It)=>r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx(O,{small:!0,wrap:!0,align:"end",variant:"white",className:"col-4",children:Ut}),r.jsx("input",{type:"text",className:"form-control form-control-sm",value:m[It],onChange:jt=>pe(It,jt.target.value)})]},It))})]})]}),p.length>0&&r.jsxs(r.Fragment,{children:[r.jsx("hr",{className:"m-0 my-1"}),r.jsx(A,{gap:1,children:p.map((Ut,It)=>r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx(O,{small:!0,wrap:!0,align:"end",variant:"white",className:"col-4",children:Ut}),r.jsx("input",{type:"text",className:"form-control form-control-sm",value:R[It],onChange:jt=>Wt(It,jt.target.value)})]},It))})]})]})]})}),r.jsxs(M,{gap:1,justifyContent:"end",children:[o&&r.jsx(V,{variant:"dark",onClick:Ut=>Be("move"),children:f("infostand.button.move")}),c&&r.jsx(V,{variant:"dark",onClick:Ut=>Be("rotate"),children:f("infostand.button.rotate")}),i!==Gp&&r.jsx(V,{variant:"dark",onClick:Ut=>Be("pickup"),children:f(i===mN?"infostand.button.eject":"infostand.button.pickup")}),h&&r.jsx(V,{variant:"dark",onClick:Ut=>Be("use"),children:f("infostand.button.use")}),g.length>0&&m.length>0&&g.length===m.length&&r.jsx(V,{variant:"dark",onClick:()=>Be("save_branding_configuration"),children:f("save")}),p.length>0&&R.length>0&&p.length===R.length&&r.jsx(V,{variant:"dark",onClick:()=>Be("save_custom_variables"),children:f("save")})]})]})},Utt=a=>{const{avatarInfo:t=null,onClose:e=null}=a,[s,i]=_.useState(0),[n,o]=_.useState(0),{roomSession:l=null}=ye(),{petRespectRemaining:c=0,respectPet:u=null}=Oo();if(_.useEffect(()=>{i(t.remainingGrowTime),o(t.remainingTimeToLive)},[t]),_.useEffect(()=>{if(t.petType!==xs.MONSTERPLANT||t.dead)return;const d=setInterval(()=>{i(g=>g-1),o(g=>g-1)},1e3);return()=>clearInterval(d)},[t]),!t)return null;const h=d=>{let g=!0;if(!(!d||d=="")){switch(d){case"respect":u(t.id),c-1>=1&&(g=!1);break;case"buyfood":ut("catalog/open/"+it("catalog.links")["pets.buy_food"]);break;case"train":l==null||l.requestPetCommands(t.id);break;case"treat":k(new S_(t.id));break;case"compost":l==null||l.compostPlant(t.id);break;case"pick_up":l==null||l.pickupPet(t.id);break}g&&e()}};return r.jsxs(A,{gap:1,alignItems:"end",children:[r.jsx(A,{className:"nitro-infostand rounded",children:r.jsxs(A,{overflow:"visible",className:"container-fluid content-area",gap:1,children:[r.jsxs(A,{gap:1,children:[r.jsxs(M,{alignItems:"center",justifyContent:"between",gap:1,children:[r.jsx(O,{variant:"white",small:!0,wrap:!0,children:t.name}),r.jsx(zr,{className:"cursor-pointer fa-icon",onClick:e})]}),r.jsx(O,{variant:"white",small:!0,wrap:!0,children:f(`pet.breed.${t.petType}.${t.petBreed}`)}),r.jsx("hr",{className:"m-0"})]}),t.petType===xs.MONSTERPLANT&&r.jsxs(r.Fragment,{children:[r.jsxs(A,{center:!0,gap:1,children:[r.jsx(Ca,{figure:t.petFigure,posture:t.posture,direction:4}),r.jsx("hr",{className:"m-0"})]}),r.jsxs(A,{gap:2,children:[!t.dead&&r.jsx(A,{alignItems:"center",gap:1,children:r.jsx(O,{variant:"white",center:!0,small:!0,wrap:!0,children:f("pet.level",["level","maxlevel"],[t.level.toString(),t.maximumLevel.toString()])})}),r.jsxs(A,{alignItems:"center",gap:1,children:[r.jsx(O,{variant:"white",small:!0,truncate:!0,children:f("infostand.pet.text.wellbeing")}),r.jsxs(H,{fullWidth:!0,overflow:"hidden",position:"relative",className:"bg-light-dark rounded",children:[r.jsx(M,{fit:!0,center:!0,position:"absolute",children:r.jsx(O,{variant:"white",small:!0,children:t.dead?"00:00:00":Nl(n==0?t.remainingTimeToLive:n).split(":")[1]+":"+Nl(n==null||n==null?0:n).split(":")[2]+":"+Nl(n==null||n==null?0:n).split(":")[3]})}),r.jsx(H,{className:"bg-success rounded pet-stats",style:{width:t.dead?"0":Math.round(t.maximumTimeToLive*100/n).toString()}})]})]}),s!=0&&s>0&&r.jsxs(A,{alignItems:"center",gap:1,children:[r.jsx(O,{variant:"white",small:!0,truncate:!0,children:f("infostand.pet.text.growth")}),r.jsx(p8,{className:"top-2 end-2",day:Nl(s).split(":")[0],hour:Nl(s).split(":")[1],minutes:Nl(s).split(":")[2],seconds:Nl(s).split(":")[3]})]}),r.jsxs(A,{alignItems:"center",gap:1,children:[r.jsx(O,{variant:"white",small:!0,truncate:!0,children:f("infostand.pet.text.raritylevel",["level"],[f(`infostand.pet.raritylevel.${t.rarityLevel}`)])}),r.jsx(wO,{className:"top-2 end-2",level:t.rarityLevel})]}),r.jsx("hr",{className:"m-0"})]}),r.jsxs(A,{gap:1,children:[r.jsx(O,{variant:"white",small:!0,wrap:!0,children:f("pet.age",["age"],[t.age.toString()])}),r.jsx("hr",{className:"m-0"})]})]}),t.petType!==xs.MONSTERPLANT&&r.jsxs(r.Fragment,{children:[r.jsxs(A,{gap:1,children:[r.jsxs(M,{gap:1,children:[r.jsx(A,{fullWidth:!0,overflow:"hidden",className:"body-image pet p-1",children:r.jsx(Ca,{figure:t.petFigure,posture:t.posture,direction:4})}),r.jsxs(A,{grow:!0,gap:1,children:[r.jsx(O,{variant:"white",center:!0,small:!0,wrap:!0,children:f("pet.level",["level","maxlevel"],[t.level.toString(),t.maximumLevel.toString()])}),r.jsxs(A,{alignItems:"center",gap:1,children:[r.jsx(O,{variant:"white",small:!0,truncate:!0,children:f("infostand.pet.text.happiness")}),r.jsxs(H,{fullWidth:!0,overflow:"hidden",position:"relative",className:"bg-light-dark rounded",children:[r.jsx(M,{fit:!0,center:!0,position:"absolute",children:r.jsx(O,{variant:"white",small:!0,children:t.happyness+"/"+t.maximumHappyness})}),r.jsx(H,{className:"bg-info rounded pet-stats",style:{width:t.happyness/t.maximumHappyness*100+"%"}})]})]}),r.jsxs(A,{alignItems:"center",gap:1,children:[r.jsx(O,{variant:"white",small:!0,truncate:!0,children:f("infostand.pet.text.experience")}),r.jsxs(H,{fullWidth:!0,overflow:"hidden",position:"relative",className:"bg-light-dark rounded",children:[r.jsx(M,{fit:!0,center:!0,position:"absolute",children:r.jsx(O,{variant:"white",small:!0,children:t.experience+"/"+t.levelExperienceGoal})}),r.jsx(H,{className:"bg-purple rounded pet-stats",style:{width:t.experience/t.levelExperienceGoal*100+"%"}})]})]}),r.jsxs(A,{alignItems:"center",gap:1,children:[r.jsx(O,{variant:"white",small:!0,truncate:!0,children:f("infostand.pet.text.energy")}),r.jsxs(H,{fullWidth:!0,overflow:"hidden",position:"relative",className:"bg-light-dark rounded",children:[r.jsx(M,{fit:!0,center:!0,position:"absolute",children:r.jsx(O,{variant:"white",small:!0,children:t.energy+"/"+t.maximumEnergy})}),r.jsx(H,{className:"bg-success rounded pet-stats",style:{width:t.energy/t.maximumEnergy*100+"%"}})]})]})]})]}),r.jsx("hr",{className:"m-0"})]}),r.jsxs(A,{gap:1,children:[t.petType!==xs.MONSTERPLANT&&r.jsx(O,{variant:"white",small:!0,wrap:!0,children:f("infostand.text.petrespect",["count"],[t.respect.toString()])}),r.jsx(O,{variant:"white",small:!0,wrap:!0,children:f("pet.age",["age"],[t.age.toString()])}),r.jsx("hr",{className:"m-0"})]})]}),r.jsx(A,{gap:1,children:r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx(Cr,{userId:t.ownerId}),r.jsx(O,{variant:"white",small:!0,wrap:!0,children:f("infostand.text.petowner",["name"],[t.ownerName])})]})})]})}),r.jsxs(M,{gap:1,justifyContent:"end",children:[t.petType!==xs.MONSTERPLANT&&r.jsx(V,{variant:"dark",onClick:d=>h("buyfood"),children:f("infostand.button.buyfood")}),t.isOwner&&t.petType!==xs.MONSTERPLANT&&r.jsx(V,{variant:"dark",onClick:d=>h("train"),children:f("infostand.button.train")}),!t.dead&&t.energy/t.maximumEnergy<.98&&t.petType===xs.MONSTERPLANT&&r.jsx(V,{variant:"dark",onClick:d=>h("treat"),children:f("infostand.button.pettreat")}),(l==null?void 0:l.isRoomOwner)&&t.petType===xs.MONSTERPLANT&&r.jsx(V,{variant:"dark",onClick:d=>h("compost"),children:f("infostand.button.compost")}),t.isOwner&&r.jsx(V,{variant:"dark",onClick:d=>h("pick_up"),children:f("inventory.pets.pickup")}),c>0&&t.petType!==xs.MONSTERPLANT&&r.jsx(V,{variant:"dark",onClick:d=>h("respect"),children:f("infostand.button.petrespect",["count"],[c.toString()])})]})]})},jtt=a=>{const{avatarInfo:t=null,onClose:e=null}=a,s=_.useMemo(()=>!(t.botSkills.indexOf(Ke.NO_PICK_UP)>=0||!t.amIOwner&&!t.amIAnyRoomController),[t]),i=()=>k(new ep(t.webID));if(t)return r.jsxs(A,{gap:1,children:[r.jsx(A,{className:"nitro-infostand rounded",children:r.jsxs(A,{overflow:"visible",className:"container-fluid content-area",gap:1,children:[r.jsxs(A,{gap:1,children:[r.jsxs(M,{alignItems:"center",justifyContent:"between",gap:1,children:[r.jsx(O,{variant:"white",small:!0,wrap:!0,children:t.name}),r.jsx(zr,{className:"cursor-pointer fa-icon",onClick:e})]}),r.jsx("hr",{className:"m-0"})]}),r.jsxs(A,{gap:1,children:[r.jsxs(M,{gap:1,children:[r.jsx(A,{fullWidth:!0,className:"body-image bot",children:r.jsx(ls,{figure:t.figure,direction:4})}),r.jsx(A,{grow:!0,center:!0,gap:0,children:t.badges.length>0&&t.badges.map(n=>r.jsx(Ge,{badgeCode:n,showInfo:!0},n))})]}),r.jsx("hr",{className:"m-0"})]}),r.jsxs(A,{gap:1,children:[r.jsx(M,{alignItems:"center",className:"bg-light-dark rounded py-1 px-2",children:r.jsx(O,{fullWidth:!0,wrap:!0,textBreak:!0,variant:"white",small:!0,className:"motto-content",children:t.motto})}),r.jsx("hr",{className:"m-0"})]}),r.jsxs(A,{gap:1,children:[r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx(Cr,{userId:t.ownerId}),r.jsx(O,{variant:"white",small:!0,wrap:!0,children:f("infostand.text.botowner",["name"],[t.ownerName])})]}),t.carryItem>0&&r.jsxs(r.Fragment,{children:[r.jsx("hr",{className:"m-0"}),r.jsx(O,{variant:"white",small:!0,wrap:!0,children:f("infostand.text.handitem",["item"],[f("handitem"+t.carryItem)])})]})]})]})}),s&&r.jsx(M,{justifyContent:"end",children:r.jsx(V,{variant:"dark",onClick:i,children:f("infostand.button.pickup")})})]})},Bp=a=>{const{type:t=-1,relationship:e=null}=a;if(!e)return null;const s=Tr.RELATIONSHIP_NAMES[t].toLocaleLowerCase();return r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("i",{className:`nitro-friends-spritesheet icon-${s}`}),r.jsx(M,{alignItems:"center",gap:0,children:r.jsxs(O,{small:!0,variant:"white",onClick:i=>rr(e.randomFriendId),children:[r.jsx("u",{children:e.randomFriendName}),e.friendCount>1&&" "+f(`extendedprofile.relstatus.others.${s}`,["count"],[(e.friendCount-1).toString()])]})})]})},wtt=a=>{const{relationships:t=null}=a;return!t||!t.relationshipStatusMap.length?null:r.jsxs(r.Fragment,{children:[r.jsx(Bp,{type:Tr.HEART,relationship:t.relationshipStatusMap.getValue(Tr.HEART)}),r.jsx(Bp,{type:Tr.SMILE,relationship:t.relationshipStatusMap.getValue(Tr.SMILE)}),r.jsx(Bp,{type:Tr.BOBBA,relationship:t.relationshipStatusMap.getValue(Tr.BOBBA)})]})},Ftt=a=>{ut(`navigator/search/${a}`),k(new Nc("hotel_view",`tag:${a}`))},Gtt=a=>{const{tags:t=null}=a;return!t||!t.length?null:r.jsxs(r.Fragment,{children:[r.jsx("hr",{className:"m-0"}),r.jsx(M,{className:"flex-tags",children:t&&t.length>0&&t.map((e,s)=>r.jsx(O,{variant:"white",className:"text-tags",onClick:i=>Ftt(e),children:e},s))})]})},Btt=a=>{const{avatarInfo:t=null,setAvatarInfo:e=null,onClose:s=null}=a,[i,n]=_.useState(null),[o,l]=_.useState(!1),[c,u]=_.useState(null),{roomSession:h=null}=ye(),d=m=>{!o||m.length>it("motto.max.length",38)||(h.sendMottoMessage(m),l(!1))},g=m=>d(m.target.value),E=m=>{switch(m.stopPropagation(),m.key){case"Enter":d(m.target.value);return}};return we(Mg.RSUBE_BADGES,m=>{!t||t.webID!==m.userId||t.badges.join("")===m.badges.join("")||e(p=>{const T=ji(p);return T.badges=m.badges,T})}),we(Dg.USER_FIGURE,m=>{!t||t.roomIndex!==m.roomIndex||e(I=>{const p=ji(I);return p.figure=m.figure,p.motto=m.customInfo,p.achievementScore=m.activityPoints,p})}),we(Og.FAVOURITE_GROUP_UPDATE,m=>{!t||t.roomIndex!==m.roomIndex||e(I=>{const p=ji(I),T=m.status===-1||m.habboGroupId<=0;return p.groupId=T?-1:m.habboGroupId,p.groupName=T?null:m.habboGroupName,p.groupBadgeId=T?null:q().getGroupBadge(m.habboGroupId),p})}),Y(zS,m=>{const I=m.getParser();!t||t.webID!==I.userId||u(I)}),_.useEffect(()=>(l(!1),n(t.motto),k(new mO(t.webID)),()=>{l(!1),n(null),u(null)}),[t]),t?r.jsx(A,{className:"nitro-infostand rounded",children:r.jsxs(A,{overflow:"visible",className:"container-fluid content-area",gap:1,children:[r.jsxs(A,{gap:1,children:[r.jsxs(M,{alignItems:"center",justifyContent:"between",children:[r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx(Cr,{userId:t.webID}),r.jsx(O,{variant:"white",small:!0,wrap:!0,children:t.name})]}),r.jsx(zr,{className:"cursor-pointer fa-icon",onClick:s})]}),r.jsx("hr",{className:"m-0"})]}),r.jsxs(A,{gap:1,children:[r.jsxs(M,{gap:1,children:[r.jsx(A,{fullWidth:!0,className:"body-image",onClick:m=>rr(t.webID),children:r.jsx(ls,{figure:t.figure,direction:4})}),r.jsxs(A,{grow:!0,alignItems:"center",gap:0,children:[r.jsxs(M,{gap:1,children:[r.jsx(M,{center:!0,className:"badge-image",children:t.badges[0]&&r.jsx(Ge,{badgeCode:t.badges[0],showInfo:!0})}),r.jsx(M,{center:!0,pointer:t.groupId>0,className:"badge-image",onClick:m=>C_(t.groupId),children:t.groupId>0&&r.jsx(Ge,{badgeCode:t.groupBadgeId,isGroup:!0,showInfo:!0,customTitle:t.groupName})})]}),r.jsxs(M,{center:!0,gap:1,children:[r.jsx(M,{center:!0,className:"badge-image",children:t.badges[1]&&r.jsx(Ge,{badgeCode:t.badges[1],showInfo:!0})}),r.jsx(M,{center:!0,className:"badge-image",children:t.badges[2]&&r.jsx(Ge,{badgeCode:t.badges[2],showInfo:!0})})]}),r.jsxs(M,{center:!0,gap:1,children:[r.jsx(M,{center:!0,className:"badge-image",children:t.badges[3]&&r.jsx(Ge,{badgeCode:t.badges[3],showInfo:!0})}),r.jsx(M,{center:!0,className:"badge-image",children:t.badges[4]&&r.jsx(Ge,{badgeCode:t.badges[4],showInfo:!0})})]})]})]}),r.jsx("hr",{className:"m-0"})]}),r.jsxs(A,{gap:1,children:[r.jsxs(M,{alignItems:"center",className:"bg-light-dark rounded py-1 px-2",children:[t.type!==Ls.OWN_USER&&r.jsx(M,{grow:!0,alignItems:"center",className:"motto-content",children:r.jsx(O,{fullWidth:!0,pointer:!0,wrap:!0,textBreak:!0,small:!0,variant:"white",children:i})}),t.type===Ls.OWN_USER&&r.jsxs(M,{grow:!0,alignItems:"center",gap:2,children:[r.jsx($j,{className:"small fa-icon"}),r.jsxs(M,{grow:!0,alignItems:"center",className:"motto-content",children:[!o&&r.jsxs(O,{fullWidth:!0,pointer:!0,wrap:!0,textBreak:!0,small:!0,variant:"white",onClick:m=>l(!0),children:[i," "]}),o&&r.jsx("input",{type:"text",className:"motto-input",maxLength:it("motto.max.length",38),value:i,onChange:m=>n(m.target.value),onBlur:g,onKeyDown:E,autoFocus:!0})]})]})]}),r.jsx("hr",{className:"m-0"})]}),r.jsxs(A,{gap:1,children:[r.jsx(O,{variant:"white",small:!0,wrap:!0,children:f("infostand.text.achievement_score")+" "+t.achievementScore}),t.carryItem>0&&r.jsxs(r.Fragment,{children:[r.jsx("hr",{className:"m-0"}),r.jsx(O,{variant:"white",small:!0,wrap:!0,children:f("infostand.text.handitem",["item"],[f("handitem"+t.carryItem)])})]})]}),r.jsx(A,{gap:1,children:r.jsx(wtt,{relationships:c})}),it("user.tags.enabled")&&r.jsx(A,{gap:1,className:"mt-1",children:r.jsx(Gtt,{tags:q().tags})})]})}):null},Z_=0,kp=1,pN=2,IN=3,Vp=4,TN=5,RN=6,ktt=a=>{const{avatarInfo:t=null,onClose:e=null}=a,[s,i]=_.useState(Z_),{canRequestFriend:n=null}=ar(),{report:o=null}=En(),{roomSession:l=null}=ye(),{userRespectRemaining:c=0,respectUser:u=null}=Oo(),h=_.useMemo(()=>t.amIOwner&&t.targetRoomControllerLevel<Oe.GUEST&&!t.isGuildRoom,[t]),d=_.useMemo(()=>t.amIOwner&&t.targetRoomControllerLevel===Oe.GUEST&&!t.isGuildRoom,[t]),g=_.useMemo(()=>t.canBeKicked||t.canBeBanned||t.canBeMuted||h||d,[h,d,t]),E=_.useMemo(()=>{let I=!1;const p=Gc();if(p){const T=p.model.getValue(C.FIGURE_CARRY_OBJECT);T>0&&T<999999&&(I=!0)}return I},[]),m=I=>{let p=!0;if(I)switch(I){case"moderate":p=!1,i(kp);break;case"ban":p=!1,i(pN);break;case"mute":p=!1,i(IN);break;case"ambassador":p=!1,i(Vp);break;case"ambassador_mute":p=!1,i(TN);break;case"back_moderate":p=!1,i(kp);break;case"back_ambassador":p=!1,i(Vp);break;case"back":p=!1,i(Z_);break;case"whisper":Fs(new Ic(Ic.WHISPER,t.name));break;case"friend":ut(`friends/request/${t.webID}/${t.name}`);break;case"relationship":p=!1,i(RN);break;case"respect":{u(t.webID),c-1>=1&&(p=!1);break}case"ignore":q().ignoreUser(t.name);break;case"unignore":q().unignoreUser(t.name);break;case"kick":l.sendKickMessage(t.webID);break;case"ban_hour":l.sendBanMessage(t.webID,"RWUAM_BAN_USER_HOUR");break;case"ban_day":l.sendBanMessage(t.webID,"RWUAM_BAN_USER_DAY");break;case"perm_ban":l.sendBanMessage(t.webID,"RWUAM_BAN_USER_PERM");break;case"mute_2min":l.sendMuteMessage(t.webID,2);break;case"mute_5min":l.sendMuteMessage(t.webID,5);break;case"mute_10min":l.sendMuteMessage(t.webID,10);break;case"give_rights":l.sendGiveRightsMessage(t.webID);break;case"remove_rights":l.sendTakeRightsMessage(t.webID);break;case"trade":k(new $v(t.roomIndex));break;case"report":o(as.BULLY,{reportedUserId:t.webID});break;case"pass_hand_item":k(new KP(t.webID));break;case"ambassador_alert":l.sendAmbassadorAlertMessage(t.webID);break;case"ambassador_kick":l.sendKickMessage(t.webID);break;case"ambassador_mute_2min":l.sendMuteMessage(t.webID,2);break;case"ambassador_mute_10min":l.sendMuteMessage(t.webID,10);break;case"ambassador_mute_60min":l.sendMuteMessage(t.webID,60);break;case"ambassador_mute_18hour":l.sendMuteMessage(t.webID,1080);break;case"rship_heart":k(new tu(t.webID,er.RELATIONSHIP_HEART));break;case"rship_smile":k(new tu(t.webID,er.RELATIONSHIP_SMILE));break;case"rship_bobba":k(new tu(t.webID,er.RELATIONSHIP_BOBBA));break;case"rship_none":k(new tu(t.webID,er.RELATIONSHIP_NONE));break}p&&e()};return _.useEffect(()=>{i(Z_)},[t]),r.jsxs(Ba,{objectId:t.roomIndex,category:W.UNIT,userType:t.userType,onClose:e,collapsable:!0,children:[r.jsx(Pi,{className:"cursor-pointer",onClick:I=>rr(t.webID),children:t.name}),s===Z_&&r.jsxs(r.Fragment,{children:[n(t.webID)&&r.jsx(Z,{onClick:I=>m("friend"),children:f("infostand.button.friend")}),r.jsx(Z,{onClick:I=>m("trade"),children:f("infostand.button.trade")}),r.jsx(Z,{onClick:I=>m("whisper"),children:f("infostand.button.whisper")}),c>0&&r.jsx(Z,{onClick:I=>m("respect"),children:f("infostand.button.respect",["count"],[c.toString()])}),!n(t.webID)&&r.jsxs(Z,{onClick:I=>m("relationship"),children:[f("infostand.link.relationship"),r.jsx(Ir,{className:"right fa-icon"})]}),!t.isIgnored&&r.jsx(Z,{onClick:I=>m("ignore"),children:f("infostand.button.ignore")}),t.isIgnored&&r.jsx(Z,{onClick:I=>m("unignore"),children:f("infostand.button.unignore")}),r.jsx(Z,{onClick:I=>m("report"),children:f("infostand.button.report")}),g&&r.jsxs(Z,{onClick:I=>m("moderate"),children:[r.jsx(Ir,{className:"right fa-icon"}),f("infostand.link.moderate")]}),t.isAmbassador&&r.jsxs(Z,{onClick:I=>m("ambassador"),children:[r.jsx(Ir,{className:"right fa-icon"}),f("infostand.link.ambassador")]}),E&&r.jsx(Z,{onClick:I=>m("pass_hand_item"),children:f("avatar.widget.pass_hand_item")})]}),s===kp&&r.jsxs(r.Fragment,{children:[r.jsx(Z,{onClick:I=>m("kick"),children:f("infostand.button.kick")}),r.jsxs(Z,{onClick:I=>m("mute"),children:[r.jsx(Ir,{className:"right fa-icon"}),f("infostand.button.mute")]}),r.jsxs(Z,{onClick:I=>m("ban"),children:[r.jsx(Ir,{className:"right fa-icon"}),f("infostand.button.ban")]}),h&&r.jsx(Z,{onClick:I=>m("give_rights"),children:f("infostand.button.giverights")}),d&&r.jsx(Z,{onClick:I=>m("remove_rights"),children:f("infostand.button.removerights")}),r.jsxs(Z,{onClick:I=>m("back"),children:[r.jsx(pr,{className:"left fa-icon"}),f("generic.back")]})]}),s===pN&&r.jsxs(r.Fragment,{children:[r.jsx(Z,{onClick:I=>m("ban_hour"),children:f("infostand.button.ban_hour")}),r.jsx(Z,{onClick:I=>m("ban_day"),children:f("infostand.button.ban_day")}),r.jsx(Z,{onClick:I=>m("perm_ban"),children:f("infostand.button.perm_ban")}),r.jsxs(Z,{onClick:I=>m("back_moderate"),children:[r.jsx(pr,{className:"left fa-icon"}),f("generic.back")]})]}),s===IN&&r.jsxs(r.Fragment,{children:[r.jsx(Z,{onClick:I=>m("mute_2min"),children:f("infostand.button.mute_2min")}),r.jsx(Z,{onClick:I=>m("mute_5min"),children:f("infostand.button.mute_5min")}),r.jsx(Z,{onClick:I=>m("mute_10min"),children:f("infostand.button.mute_10min")}),r.jsxs(Z,{onClick:I=>m("back_moderate"),children:[r.jsx(pr,{className:"left fa-icon"}),f("generic.back")]})]}),s===Vp&&r.jsxs(r.Fragment,{children:[r.jsx(Z,{onClick:I=>m("ambassador_alert"),children:f("infostand.button.alert")}),r.jsx(Z,{onClick:I=>m("ambassador_kick"),children:f("infostand.button.kick")}),r.jsxs(Z,{onClick:I=>m("ambassador_mute"),children:[f("infostand.button.mute"),r.jsx(Ir,{className:"right fa-icon"})]}),r.jsxs(Z,{onClick:I=>m("back"),children:[r.jsx(pr,{className:"left fa-icon"}),f("generic.back")]})]}),s===TN&&r.jsxs(r.Fragment,{children:[r.jsx(Z,{onClick:I=>m("ambassador_mute_2min"),children:f("infostand.button.mute_2min")}),r.jsx(Z,{onClick:I=>m("ambassador_mute_10min"),children:f("infostand.button.mute_10min")}),r.jsx(Z,{onClick:I=>m("ambassador_mute_60min"),children:f("infostand.button.mute_60min")}),r.jsx(Z,{onClick:I=>m("ambassador_mute_18hr"),children:f("infostand.button.mute_18hour")}),r.jsxs(Z,{onClick:I=>m("back_ambassador"),children:[r.jsx(pr,{className:"left fa-icon"}),f("generic.back")]})]}),s===RN&&r.jsxs(r.Fragment,{children:[r.jsxs(M,{className:"menu-list-split-3",children:[r.jsx(Z,{onClick:I=>m("rship_heart"),children:r.jsx(H,{pointer:!0,className:"nitro-friends-spritesheet icon-heart"})}),r.jsx(Z,{onClick:I=>m("rship_smile"),children:r.jsx(H,{pointer:!0,className:"nitro-friends-spritesheet icon-smile"})}),r.jsx(Z,{onClick:I=>m("rship_bobba"),children:r.jsx(H,{pointer:!0,className:"nitro-friends-spritesheet icon-bobba"})})]}),r.jsx(Z,{onClick:I=>m("rship_none"),children:f("avatar.widget.clear_relationship")}),r.jsxs(Z,{onClick:I=>m("back"),children:[r.jsx(pr,{className:"left fa-icon"}),f("generic.back")]})]})]})},hj=a=>{const{classNames:t=[],...e}=a,s=_.useMemo(()=>{const i=["menu-list"];return t.length&&i.push(...t),i},[t]);return r.jsx(A,{classNames:s,...e})},Vtt=a=>{const{userId:t=-1,userName:e="",roomIndex:s=-1,setIsDecorating:i=null}=a;return r.jsx(Ba,{objectId:s,category:W.UNIT,onClose:null,children:r.jsx(hj,{children:r.jsx(Z,{onClick:n=>i(!1),children:f("widget.avatar.stop_decorating")})})})},Htt=a=>{const{avatarInfo:t=null,onClose:e=null}=a,s=i=>{if(i)switch(i){case"move":ru(t.id,t.category,Ft.OBJECT_MOVE);break;case"rotate":ru(t.id,t.category,Ft.OBJECT_ROTATE_POSITIVE);break;case"pickup":ru(t.id,t.category,Ft.OBJECT_PICKUP);break;case"eject":ru(t.id,t.category,Ft.OBJECT_EJECT);break}};return r.jsxs(Ba,{objectId:t.id,category:t.category,onClose:e,collapsable:!0,children:[r.jsx(Pi,{children:t.name}),r.jsxs(M,{className:"menu-list-split-3",children:[r.jsx(Z,{onClick:i=>s("move"),children:r.jsx(Zj,{className:"center fa-icon"})}),r.jsx(Z,{onClick:i=>s("rotate"),disabled:t.isWallItem,children:r.jsx(tw,{className:"center fa-icon"})}),(t.isOwner||t.isAnyRoomController)&&r.jsx(Z,{onClick:i=>s("pickup"),children:r.jsx(yC,{className:"center fa-icon"})}),!t.isOwner&&!t.isAnyRoomController&&(t.isRoomOwner||t.roomControllerLevel>=Oe.GUILD_ADMIN)&&r.jsx(Z,{onClick:i=>s("eject"),children:r.jsx(yC,{className:"center fa-icon"})})]})]})},SN=a=>{const{nameInfo:t=null,onClose:e=null}=a,s=_.useMemo(()=>{const i=["name-only"];return t.isFriend&&i.push("is-friend"),i},[t]);return r.jsx(Ba,{objectId:t.roomIndex,category:t.category,userType:t.userType,fades:t.id!==q().userId,classNames:s,onClose:e,children:r.jsx("div",{className:"text-shadow",children:t.name})})},Hp=0,Wp=1,ON=3,CN=4,Wtt=a=>{const{avatarInfo:t=null,isDancing:e=!1,setIsDecorating:s=null,onClose:i=null}=a,[n,o]=_.useState(e&&fc()?Wp:Hp),{roomSession:l=null}=ye(),c=d=>{let g=!0;if(d)if(d.startsWith("sign_")){const E=parseInt(d.split("_")[1]);l.sendSignMessage(E)}else switch(d){case"decorate":s(!0);break;case"change_name":Fs(new m_(m_.INIT));break;case"change_looks":ut("avatar-editor/show");break;case"expressions":g=!1,o(ON);break;case"sit":l.sendPostureMessage(Df.POSTURE_SIT);break;case"stand":l.sendPostureMessage(Df.POSTURE_STAND);break;case"wave":l.sendExpressionMessage(cn.WAVE.ordinal);break;case"blow":l.sendExpressionMessage(cn.BLOW.ordinal);break;case"laugh":l.sendExpressionMessage(cn.LAUGH.ordinal);break;case"idle":l.sendExpressionMessage(cn.IDLE.ordinal);break;case"dance_menu":g=!1,o(Wp);break;case"dance":l.sendDanceMessage(1);break;case"dance_stop":l.sendDanceMessage(0);break;case"dance_1":case"dance_2":case"dance_3":case"dance_4":l.sendDanceMessage(parseInt(d.charAt(d.length-1)));break;case"signs":g=!1,o(CN);break;case"back":g=!1,o(Hp);break;case"drop_carry_item":k(new zP);break}g&&i()},u=()=>t.amIOwner||t.amIAnyRoomController||t.roomControllerLevel>Oe.GUEST,h=u7();return r.jsxs(Ba,{objectId:t.roomIndex,category:W.UNIT,userType:t.userType,onClose:i,collapsable:!0,children:[r.jsx(Pi,{className:"cursor-pointer",onClick:d=>rr(t.webID),children:t.name}),n===Hp&&r.jsxs(r.Fragment,{children:[t.allowNameChange&&r.jsx(Z,{onClick:d=>c("change_name"),children:f("widget.avatar.change_name")}),u()&&r.jsx(Z,{onClick:d=>c("decorate"),children:f("widget.avatar.decorate")}),r.jsx(Z,{onClick:d=>c("change_looks"),children:f("widget.memenu.myclothes")}),fc()&&!h&&r.jsxs(Z,{onClick:d=>c("dance_menu"),children:[r.jsx(Ir,{className:"right fa-icon"}),f("widget.memenu.dance")]}),!e&&!fc()&&!h&&r.jsx(Z,{onClick:d=>c("dance"),children:f("widget.memenu.dance")}),e&&!fc()&&!h&&r.jsx(Z,{onClick:d=>c("dance_stop"),children:f("widget.memenu.dance.stop")}),r.jsxs(Z,{onClick:d=>c("expressions"),children:[r.jsx(Ir,{className:"right fa-icon"}),f("infostand.link.expressions")]}),r.jsxs(Z,{onClick:d=>c("signs"),children:[r.jsx(Ir,{className:"right fa-icon"}),f("infostand.show.signs")]}),t.carryItem>0&&r.jsx(Z,{onClick:d=>c("drop_carry_item"),children:f("avatar.widget.drop_hand_item")})]}),n===Wp&&r.jsxs(r.Fragment,{children:[e&&r.jsx(Z,{onClick:d=>c("dance_stop"),children:f("widget.memenu.dance.stop")}),r.jsx(Z,{onClick:d=>c("dance_1"),children:f("widget.memenu.dance1")}),r.jsx(Z,{onClick:d=>c("dance_2"),children:f("widget.memenu.dance2")}),r.jsx(Z,{onClick:d=>c("dance_3"),children:f("widget.memenu.dance3")}),r.jsx(Z,{onClick:d=>c("dance_4"),children:f("widget.memenu.dance4")}),r.jsxs(Z,{onClick:d=>c("back"),children:[r.jsx(pr,{className:"left fa-icon"}),f("generic.back")]})]}),n===ON&&r.jsxs(r.Fragment,{children:[l7()===mt.POSTURE_STAND&&r.jsx(Z,{onClick:d=>c("sit"),children:f("widget.memenu.sit")}),Qq()&&r.jsx(Z,{onClick:d=>c("stand"),children:f("widget.memenu.stand")}),yp()&&r.jsx(Z,{onClick:d=>c("wave"),children:f("widget.memenu.wave")}),yp()&&r.jsxs(Z,{disabled:!k_(),onClick:d=>c("laugh"),children:[!k_()&&r.jsx(ps,{type:"hc"}),f("widget.memenu.laugh")]}),yp()&&r.jsxs(Z,{disabled:!k_(),onClick:d=>c("blow"),children:[!k_()&&r.jsx(ps,{type:"hc"}),f("widget.memenu.blow")]}),r.jsx(Z,{onClick:d=>c("idle"),children:f("widget.memenu.idle")}),r.jsxs(Z,{onClick:d=>c("back"),children:[r.jsx(pr,{className:"left fa-icon"}),f("generic.back")]})]}),n===CN&&r.jsxs(r.Fragment,{children:[r.jsxs(M,{className:"menu-list-split-3",children:[r.jsx(Z,{onClick:d=>c("sign_1"),children:"1"}),r.jsx(Z,{onClick:d=>c("sign_2"),children:"2"}),r.jsx(Z,{onClick:d=>c("sign_3"),children:"3"})]}),r.jsxs(M,{className:"menu-list-split-3",children:[r.jsx(Z,{onClick:d=>c("sign_4"),children:"4"}),r.jsx(Z,{onClick:d=>c("sign_5"),children:"5"}),r.jsx(Z,{onClick:d=>c("sign_6"),children:"6"})]}),r.jsxs(M,{className:"menu-list-split-3",children:[r.jsx(Z,{onClick:d=>c("sign_7"),children:"7"}),r.jsx(Z,{onClick:d=>c("sign_8"),children:"8"}),r.jsx(Z,{onClick:d=>c("sign_9"),children:"9"})]}),r.jsxs(M,{className:"menu-list-split-3",children:[r.jsx(Z,{onClick:d=>c("sign_10"),children:"10"}),r.jsx(Z,{onClick:d=>c("sign_11"),children:r.jsx("i",{className:"icon icon-sign-heart"})}),r.jsx(Z,{onClick:d=>c("sign_12"),children:r.jsx("i",{className:"icon icon-sign-skull"})})]}),r.jsxs(M,{className:"menu-list-split-3",children:[r.jsx(Z,{onClick:d=>c("sign_0"),children:"0"}),r.jsx(Z,{onClick:d=>c("sign_13"),children:r.jsx("i",{className:"icon icon-sign-exclamation"})}),r.jsx(Z,{onClick:d=>c("sign_15"),children:r.jsx("i",{className:"icon icon-sign-smile"})})]}),r.jsxs(M,{className:"menu-list-split-3",children:[r.jsx(Z,{onClick:d=>c("sign_14"),children:r.jsx("i",{className:"icon icon-sign-soccer"})}),r.jsx(Z,{onClick:d=>c("sign_17"),children:r.jsx("i",{className:"icon icon-sign-yellow"})}),r.jsx(Z,{onClick:d=>c("sign_16"),children:r.jsx("i",{className:"icon icon-sign-red"})})]}),r.jsxs(Z,{onClick:d=>c("back"),children:[r.jsx(pr,{className:"left fa-icon"}),f("generic.back")]})]})]})},Yp=0,AN=1,NN=2,xN=3,Ytt=a=>{const{avatarInfo:t=null,onClose:e=null}=a,[s,i]=_.useState(Yp),{roomSession:n=null}=ye(),{petRespectRemaining:o=0,respectPet:l=null}=Oo(),c=_.useMemo(()=>{let h=!1;const d=Gc();if(d){const g=d.model.getValue(C.FIGURE_CARRY_OBJECT);g>0&&g<999999&&(h=!0)}return h},[]),u=h=>{let d=!0;if(h)switch(h){case"respect":l(t.id),o-1>=1&&(d=!1);break;case"treat":k(new S_(t.id));break;case"pass_handitem":k(new dO(t.id));break;case"train":n.requestPetCommands(t.id);break;case"pick_up":n.pickupPet(t.id);break;case"mount":n.mountPet(t.id);break;case"toggle_riding_permission":n.togglePetRiding(t.id);break;case"toggle_breeding_permission":n.togglePetBreeding(t.id);break;case"dismount":n.dismountPet(t.id);break;case"saddle_off":n.removePetSaddle(t.id);break;case"breed":break;case"harvest":n.harvestPet(t.id);break;case"revive":break;case"compost":n.compostPlant(t.id);break;case"buy_saddle":ut("catalog/open/"+it("catalog.links")["pets.buy_saddle"]);break}d&&e()};return _.useEffect(()=>{i(h=>t.petType===xs.MONSTERPLANT?xN:t.saddle&&!t.rider?AN:t.rider?NN:Yp)},[t]),r.jsxs(Ba,{objectId:t.roomIndex,category:W.UNIT,userType:be.PET,onClose:e,collapsable:!0,children:[r.jsx(Pi,{children:t.name}),s===Yp&&r.jsxs(r.Fragment,{children:[o>0&&r.jsx(Z,{onClick:h=>u("respect"),children:f("infostand.button.petrespect",["count"],[o.toString()])}),r.jsx(Z,{onClick:h=>u("train"),children:f("infostand.button.train")}),r.jsx(Z,{onClick:h=>u("pick_up"),children:f("infostand.button.pickup")}),t.petType===xs.HORSE&&r.jsx(Z,{onClick:h=>u("buy_saddle"),children:f("infostand.button.buy_saddle")}),[xs.BEAR,xs.TERRIER,xs.CAT,xs.DOG,xs.PIG].indexOf(t.petType)>-1&&r.jsx(Z,{onClick:h=>u("breed"),children:f("infostand.button.breed")})]}),s===AN&&r.jsxs(r.Fragment,{children:[r.jsx(Z,{onClick:h=>u("mount"),children:f("infostand.button.mount")}),r.jsxs(Z,{onClick:h=>u("toggle_riding_permission"),gap:1,children:[r.jsx("input",{type:"checkbox",checked:!!t.publiclyRideable,readOnly:!0}),f("infostand.button.toggle_riding_permission")]}),o>0&&r.jsx(Z,{onClick:h=>u("respect"),children:f("infostand.button.petrespect",["count"],[o.toString()])}),r.jsx(Z,{onClick:h=>u("train"),children:f("infostand.button.train")}),r.jsx(Z,{onClick:h=>u("pick_up"),children:f("infostand.button.pickup")}),r.jsx(Z,{onClick:h=>u("saddle_off"),children:f("infostand.button.saddleoff")})]}),s===NN&&r.jsxs(r.Fragment,{children:[r.jsx(Z,{onClick:h=>u("dismount"),children:f("infostand.button.dismount")}),o>0&&r.jsx(Z,{onClick:h=>u("respect"),children:f("infostand.button.petrespect",["count"],[o.toString()])})]}),s===xN&&r.jsxs(r.Fragment,{children:[r.jsx(Z,{onClick:h=>u("pick_up"),children:f("infostand.button.pickup")}),t.dead&&r.jsx(Z,{onClick:h=>u("revive"),children:f("infostand.button.revive")}),n.isRoomOwner&&r.jsx(Z,{onClick:h=>u("compost"),children:f("infostand.button.compost")}),!t.dead&&t.energy/t.maximumEnergy<.98&&r.jsx(Z,{onClick:h=>u("treat"),children:f("infostand.button.pettreat")}),!t.dead&&t.level===t.maximumLevel&&t.breedable&&r.jsxs(r.Fragment,{children:[r.jsxs(Z,{onClick:h=>u("toggle_breeding_permission"),gap:1,children:[r.jsx("input",{type:"checkbox",checked:t.publiclyBreedable,readOnly:!0}),f("infostand.button.toggle_breeding_permission")]}),r.jsx(Z,{onClick:h=>u("breed"),children:f("infostand.button.breed")})]})]}),c&&r.jsx(Z,{onClick:h=>u("pass_hand_item"),children:f("infostand.button.pass_hand_item")})]})},zp=0,MN=1,yN=2,DN=3,ztt=a=>{const{avatarInfo:t=null,onClose:e=null}=a,[s,i]=_.useState(zp),{roomSession:n=null}=ye(),{petRespectRemaining:o=0,respectPet:l=null}=Oo(),c=_.useMemo(()=>n.isRoomOwner||n.controllerLevel>=Oe.GUEST||q().isModerator,[n]),u=_.useMemo(()=>{let d=!1;const g=Gc();if(g){const E=g.model.getValue(C.FIGURE_CARRY_OBJECT);E>0&&E<999999&&(d=!0)}return d},[]),h=d=>{let g=!0;if(d)switch(d){case"respect":l(t.id),o-1>=1&&(g=!1);break;case"treat":k(new S_(t.id));break;case"pass_handitem":k(new dO(t.id));break;case"pick_up":n.pickupPet(t.id);break;case"mount":n.mountPet(t.id);break;case"dismount":n.dismountPet(t.id);break}g&&e()};return _.useEffect(()=>{i(d=>t.petType===xs.MONSTERPLANT?DN:t.saddle&&!t.rider?MN:t.rider?yN:zp)},[t]),r.jsxs(Ba,{objectId:t.roomIndex,category:W.UNIT,userType:be.PET,onClose:e,collapsable:!0,children:[r.jsx(Pi,{children:t.name}),s===zp&&o>0&&r.jsx(Z,{onClick:d=>h("respect"),children:f("infostand.button.petrespect",["count"],[o.toString()])}),s===MN&&r.jsxs(r.Fragment,{children:[!!t.publiclyRideable&&r.jsx(Z,{onClick:d=>h("mount"),children:f("infostand.button.mount")}),o>0&&r.jsx(Z,{onClick:d=>h("respect"),children:f("infostand.button.petrespect",["count"],[o.toString()])})]}),s===yN&&r.jsxs(r.Fragment,{children:[r.jsx(Z,{onClick:d=>h("dismount"),children:f("infostand.button.dismount")}),o>0&&r.jsx(Z,{onClick:d=>h("respect"),children:f("infostand.button.petrespect",["count"],[o.toString()])})]}),s===DN&&!t.dead&&t.energy/t.maximumEnergy<.98&&r.jsx(Z,{onClick:d=>h("treat"),children:f("infostand.button.pettreat")}),c&&r.jsx(Z,{onClick:d=>h("pick_up"),children:f("infostand.button.pickup")}),u&&r.jsx(Z,{onClick:d=>h("pass_hand_item"),children:f("infostand.button.pass_hand_item")})]})},Kp=0,bN=1,vN=2,Ktt=a=>{const{avatarInfo:t=null,onClose:e=null}=a,[s,i]=_.useState(Kp),[n,o]=_.useState(""),[l,c]=_.useState("");Y(cD,g=>{const E=g.getParser();if(E.botId===t.webID)switch(E.commandId){case Ke.CHANGE_BOT_NAME:o(E.data),i(bN);return;case Ke.CHANGE_BOT_MOTTO:c(E.data),i(vN);return;case Ke.SETUP_CHAT:{const m=E.data,I=m.split(m.indexOf(";#;")===-1?";":";#;");(I.length===3||I.length===4)&&(Fs(new yf(t.roomIndex,W.UNIT,t.webID,I[0],I[1].toLowerCase()==="true"||I[1]==="1",parseInt(I[2]),I[3]?I[3].toLowerCase()==="true"||I[3]==="1":!1)),e());return}}});const u=g=>k(new ZL(t.webID,g)),h=g=>{let E=!0;if(g)switch(g){case"donate_to_all":u(Ke.DONATE_TO_ALL),k(new Xn(t.webID,Ke.DONATE_TO_ALL,""));break;case"donate_to_user":u(Ke.DONATE_TO_USER),k(new Xn(t.webID,Ke.DONATE_TO_USER,""));break;case"change_bot_name":u(Ke.CHANGE_BOT_NAME),E=!1;break;case"save_bot_name":k(new Xn(t.webID,Ke.CHANGE_BOT_NAME,n));break;case"change_bot_motto":u(Ke.CHANGE_BOT_MOTTO),E=!1;break;case"save_bot_motto":k(new Xn(t.webID,Ke.CHANGE_BOT_MOTTO,l));break;case"dress_up":k(new Xn(t.webID,Ke.DRESS_UP,""));break;case"random_walk":k(new Xn(t.webID,Ke.RANDOM_WALK,""));break;case"setup_chat":u(Ke.SETUP_CHAT),E=!1;break;case"dance":k(new Xn(t.webID,Ke.DANCE,""));break;case"nux_take_tour":Jt().createLinkEvent("help/tour"),k(new Xn(t.webID,Ke.NUX_TAKE_TOUR,""));break;case"pick":k(new ep(t.webID));break}E&&e()};_.useEffect(()=>{i(Kp)},[t]);const d=t.amIOwner||t.amIAnyRoomController;return r.jsxs(Ba,{objectId:t.roomIndex,category:W.UNIT,userType:be.RENTABLE_BOT,onClose:e,collapsable:!0,children:[r.jsx(Pi,{children:t.name}),s===Kp&&d&&r.jsxs(r.Fragment,{children:[t.botSkills.indexOf(Ke.DONATE_TO_ALL)>=0&&r.jsx(Z,{onClick:g=>h("donate_to_all"),children:f("avatar.widget.donate_to_all")}),t.botSkills.indexOf(Ke.DONATE_TO_USER)>=0&&r.jsx(Z,{onClick:g=>h("donate_to_user"),children:f("avatar.widget.donate_to_user")}),t.botSkills.indexOf(Ke.CHANGE_BOT_NAME)>=0&&r.jsx(Z,{onClick:g=>h("change_bot_name"),children:f("avatar.widget.change_bot_name")}),t.botSkills.indexOf(Ke.CHANGE_BOT_MOTTO)>=0&&r.jsx(Z,{onClick:g=>h("change_bot_motto"),children:f("avatar.widget.change_bot_motto")}),t.botSkills.indexOf(Ke.DRESS_UP)>=0&&r.jsx(Z,{onClick:g=>h("dress_up"),children:f("avatar.widget.dress_up")}),t.botSkills.indexOf(Ke.RANDOM_WALK)>=0&&r.jsx(Z,{onClick:g=>h("random_walk"),children:f("avatar.widget.random_walk")}),t.botSkills.indexOf(Ke.SETUP_CHAT)>=0&&r.jsx(Z,{onClick:g=>h("setup_chat"),children:f("avatar.widget.setup_chat")}),t.botSkills.indexOf(Ke.DANCE)>=0&&r.jsx(Z,{onClick:g=>h("dance"),children:f("avatar.widget.dance")}),t.botSkills.indexOf(Ke.NO_PICK_UP)===-1&&r.jsx(Z,{onClick:g=>h("pick"),children:f("avatar.widget.pick_up")})]}),s===bN&&r.jsxs(A,{className:"menu-item",onClick:null,gap:1,children:[r.jsx(O,{variant:"white",children:f("bot.skill.name.configuration.new.name")}),r.jsx("input",{type:"text",className:"form-control form-control-sm",value:n,maxLength:it("bot.name.max.length",15),onChange:g=>o(g.target.value)}),r.jsxs(M,{alignItems:"center",justifyContent:"between",gap:1,children:[r.jsx(V,{fullWidth:!0,variant:"secondary",onClick:g=>h(null),children:f("cancel")}),r.jsx(V,{fullWidth:!0,variant:"success",onClick:g=>h("save_bot_name"),children:f("save")})]})]}),s===vN&&r.jsxs(A,{className:"menu-item",onClick:null,gap:1,children:[r.jsx(O,{variant:"white",children:f("bot.skill.name.configuration.new.motto")}),r.jsx("input",{type:"text",className:"form-control form-control-sm",value:l,maxLength:it("motto.max.length",38),onChange:g=>c(g.target.value)}),r.jsxs(M,{alignItems:"center",justifyContent:"between",gap:1,children:[r.jsx(V,{fullWidth:!0,variant:"secondary",onClick:g=>h(null),children:f("cancel")}),r.jsx(V,{fullWidth:!0,variant:"success",onClick:g=>h("save_bot_motto"),children:f("save")})]})]})]})},Xtt=a=>{const[t,e]=_.useState(!1),[s,i]=_.useState(!1),[n,o]=_.useState(null),{avatarInfo:l=null,setAvatarInfo:c=null,activeNameBubble:u=null,setActiveNameBubble:h=null,nameBubbles:d=[],removeNameBubble:g=null,productBubbles:E=[],confirmingProduct:m=null,updateConfirmingProduct:I=null,removeProductBubble:p=null,isDecorating:T=!1,setIsDecorating:R=null}=V0(),{roomSession:S=null}=ye();ne(te.NORMAL_MODE,P=>{t&&e(!1)}),ne(te.GAME_MODE,P=>{t||e(!0)}),we(Sg.RSDE_DANCE,P=>{P.roomIndex===S.ownRoomIndex&&i(P.danceId!==0)}),Is(yf.UPDATE_CHAT,P=>o(P));const b=()=>{if(!S||t)return null;if(u)return r.jsx(SN,{nameInfo:u,onClose:()=>h(null)});if(l)switch(l.type){case vc.FURNI:{const P=l;return T?r.jsx(Htt,{avatarInfo:P,onClose:()=>c(null)}):null}case Ls.OWN_USER:case Ls.PEER:{const P=l;return it("user.tags.enabled")&&q().getUserTags(P.roomIndex),P.isSpectatorMode?null:P.isOwnUser?Br.isRunning()?null:r.jsx(Wtt,{avatarInfo:P,isDancing:s,setIsDecorating:R,onClose:()=>c(null)}):r.jsx(ktt,{avatarInfo:P,onClose:()=>c(null)})}case Lc.PET_INFO:{const P=l;return P.isOwner?r.jsx(Ytt,{avatarInfo:P,onClose:()=>c(null)}):r.jsx(ztt,{avatarInfo:P,onClose:()=>c(null)})}case Pc.RENTABLE_BOT:return r.jsx(Ktt,{avatarInfo:l,onClose:()=>c(null)})}return null},N=()=>{if(!l)return null;switch(l.type){case vc.FURNI:return r.jsx(Ptt,{avatarInfo:l,onClose:()=>c(null)});case Ls.OWN_USER:case Ls.PEER:return r.jsx(Btt,{avatarInfo:l,setAvatarInfo:c,onClose:()=>c(null)});case Ls.BOT:return r.jsx(Ltt,{avatarInfo:l,onClose:()=>c(null)});case Pc.RENTABLE_BOT:return r.jsx(jtt,{avatarInfo:l,onClose:()=>c(null)});case Lc.PET_INFO:return r.jsx(Utt,{avatarInfo:l,onClose:()=>c(null)})}};return r.jsxs(r.Fragment,{children:[T&&r.jsx(Vtt,{userId:q().userId,userName:q().userName,roomIndex:S.ownRoomIndex,setIsDecorating:R}),b(),l&&r.jsx(A,{alignItems:"end",className:"nitro-infostand-container",children:N()}),d.length>0&&d.map((P,B)=>r.jsx(SN,{nameInfo:P,onClose:()=>g(B)},B)),E.length>0&&E.map((P,B)=>r.jsx(vtt,{item:P,updateConfirmingProduct:I,onClose:()=>p(B)},P.id)),n&&r.jsx(Ntt,{chatEvent:n,onClose:()=>o(null)}),m&&r.jsx(xtt,{item:m,onClose:()=>I(null)}),r.jsx(Att,{})]})},qtt=a=>{const{chatStyleId:t=0,chatStyleIds:e=null,selectChatStyleId:s=null}=a,[i,n]=_.useState(null),[o,l]=_.useState(!1),c=h=>{s(h),l(!1)},u=h=>{let d=!1;l(g=>(d=!g,d)),d&&n(h.target)};return _.useEffect(()=>{o||n(null)},[o]),r.jsxs(r.Fragment,{children:[r.jsx(H,{pointer:!0,className:"icon chatstyles-icon",onClick:u}),r.jsx(hS,{show:o,target:i,placement:"top",children:r.jsx(Sc,{className:"nitro-chat-style-selector-container image-rendering-pixelated",children:r.jsx(pt,{overflow:"hidden",className:"bg-transparent",children:r.jsx(_t,{columnCount:3,overflow:"auto",children:e&&e.length>0&&e.map(h=>r.jsx(M,{center:!0,pointer:!0,className:"bubble-parent-container",onClick:d=>c(h),children:r.jsx(H,{className:"bubble-container",children:r.jsx(H,{className:`chat-bubble bubble-${h}`,children:" "})},h)},h))})})})})]})},Qtt=a=>{const[t,e]=_.useState(null),[s,i]=_.useState(!1),n=l=>{k(new gb(l))},o=l=>{let c=!1;i(u=>(c=!u,c)),c&&e(l.target)};return _.useEffect(()=>{s||e(null)},[s]),r.jsxs(r.Fragment,{children:[r.jsx(H,{pointer:!0,className:"icon soundboard-icon",onClick:o}),r.jsx(hS,{show:s,target:t,placement:"top",children:r.jsx(Sc,{className:"nitro-soundboard-selector-container image-rendering-pixelated",children:r.jsxs(pt,{overflow:"hidden",className:"bg-transparent",children:[r.jsx(O,{pointer:!1,classNames:["soundboard-title"],children:f("widget.memenu.settings.volume.soundboard")}),r.jsxs(_t,{fullHeight:!1,columnCount:1,fullWidth:!0,overflow:"auto",children:[q().categories&&q().categories.length>0&&q().categories.map(l=>r.jsxs(H,{children:[r.jsxs(M,{gap:1,center:!0,pointer:!1,children:[r.jsx(O,{style:{lineHeight:"2"},children:l.icon}),r.jsx(O,{bold:!0,style:{lineHeight:"2",letterSpacing:"1px"},children:l.name})]}),r.jsx("hr",{className:"mb-2 mt-2 bg-dark"}),r.jsx(Ce,{columnCount:3,columnMinWidth:100,columnMinHeight:30,children:q().sounds&&q().sounds.length>0&&q().sounds.filter(c=>c.categoryId==l.id).map(c=>r.jsxs(M,{justifyContent:"start",alignItems:"center",gap:1,column:!1,className:"bubble-parent-container",onClick:u=>n(c.id),children:[r.jsx(O,{classNames:["sound-title"],children:c.icon}),r.jsx(O,{classNames:["sound-title"],children:c.name})]},c.id))})]},l.id)),q().categories&&q().categories.length==0&&r.jsxs(M,{gap:2,center:!0,children:[r.jsx(H,{style:{backgroundImage:"url(https://bobbahotel.it/template/img/franksearch.gif)",width:"270px",height:"180px"}}),r.jsxs(M,{column:!0,gap:3,children:[r.jsx(O,{fontSize:5,pointer:!1,bold:!0,style:{lineHeight:"2",letterSpacing:"1px"},children:f("soundboard.nosound.title")}),r.jsxs(O,{children:[f("soundboard.nosound.text.1"),r.jsx("br",{}),f("soundboard.nosound.text.2")]})]})]})]})]})})})]})},Jtt=a=>{const[t,e]=_.useState(""),{chatStyleId:s=0,updateChatStyleId:i=null}=Oo(),{selectedUsername:n="",floodBlocked:o=!1,floodBlockedSeconds:l=0,setIsTyping:c=null,setIsIdle:u=null,sendChat:h=null}=lQ(),{roomSession:d=null}=ye(),g=_.useRef(),E=_.useMemo(()=>f("widgets.chatinput.mode.whisper"),[]),m=_.useMemo(()=>f("widgets.chatinput.mode.shout"),[]),I=_.useMemo(()=>f("widgets.chatinput.mode.speak"),[]),p=_.useMemo(()=>it("chat.input.maxlength",100),[]),T=_.useCallback(()=>{const F=document.activeElement;return!(!F||g&&g.current===F||!(F instanceof HTMLInputElement)&&!(F instanceof HTMLTextAreaElement))},[g]),R=_.useCallback(()=>{g.current.focus(),g.current.setSelectionRange(g.current.value.length*2,g.current.value.length*2)},[g]),S=_.useCallback(()=>{e(F=>F!==E||!n.length?F:`${F} ${n}`)},[n,E]),b=_.useCallback((F,w=!1)=>{if(!F||F==="")return;let U=w?Oa.CHAT_SHOUT:Oa.CHAT_DEFAULT,G=F;const K=G.split(" ");let z="",et="";switch(K[0]){case E:U=Oa.CHAT_WHISPER,z=K[1],et=E+" "+z+" ",K.shift(),K.shift();break;case m:U=Oa.CHAT_SHOUT,K.shift();break;case I:U=Oa.CHAT_DEFAULT,K.shift();break}G=K.join(" "),c(!1),u(!1),G.length<=p&&(/%CC%/g.test(encodeURIComponent(G))?e(""):(e(""),h(G,U,z,s))),e(et)},[E,m,I,p,s,c,u,h]),N=_.useCallback(F=>{!F||!F.length?c(!1):(c(!0),u(!0)),e(F)},[c,u]),P=_.useCallback(F=>{if(o||!g.current||T())return;document.activeElement!==g.current&&R();const w=F.target.value;switch(F.key){case" ":case"Space":S();return;case"NumpadEnter":case"Enter":b(w,F.shiftKey);return;case"Backspace":if(w){const U=w.split(" ");U[0]===E&&U.length===3&&U[2]===""&&e("")}return}},[o,g,E,T,R,S,b]);Is(Ic.CHAT_INPUT_CONTENT,F=>{switch(F.chatMode){case Ic.WHISPER:{e(`${E} ${F.userName} `);return}case Ic.SHOUT:return}});const B=_.useMemo(()=>{let F=[];const w=it("chat.styles");for(const U of w)if(U){if(U.minRank>0){q().hasSecurity(U.minRank)&&F.push(U.styleId);continue}if(U.isSystemStyle&&q().hasSecurity(Oe.MODERATOR)){F.push(U.styleId);continue}if(!(it("chat.styles.disabled").indexOf(U.styleId)>=0)){if(U.isHcOnly&&Wr()>=Fi.CLUB){F.push(U.styleId);continue}if(U.isAmbassadorOnly&&q().isAmbassador){F.push(U.styleId);continue}!U.isHcOnly&&!U.isAmbassadorOnly&&F.push(U.styleId)}}return F},[]);return _.useEffect(()=>(document.body.addEventListener("keydown",P),()=>{document.body.removeEventListener("keydown",P)}),[P]),_.useEffect(()=>{g.current&&(g.current.parentElement.dataset.value=t)},[t]),!d||d.isSpectator?null:lS.createPortal(r.jsxs("div",{className:"nitro-chat-input-container",children:[r.jsxs("div",{className:"input-sizer align-items-center",children:[!o&&r.jsx("input",{ref:g,type:"text",className:"chat-input",placeholder:f("widgets.chatinput.default"),value:t,maxLength:p,onChange:F=>N(F.target.value),onMouseDown:F=>R()}),o&&r.jsxs(O,{variant:"danger",children:[f("chat.input.alert.flood",["time"],[l.toString()])," "]})]}),r.jsxs(M,{gap:2,children:[r.jsx(qtt,{chatStyleId:s,chatStyleIds:B,selectChatStyleId:i}),r.jsx(Qtt,{})]})]}),document.getElementById("toolbar-chat-input-container"))},$tt=()=>{let a=null;self.onmessage=t=>{if(!t)return;const e=t.data;switch(e.action){case"START":a=setInterval(()=>postMessage(null),e.content);break;case"STOP":a&&(clearInterval(a),a=null);break}}};class Ztt extends Worker{constructor(t){const e=t.toString(),s=new Blob([`(${e})()`]);super(URL.createObjectURL(s))}}const tet=a=>{const{chat:t=null,makeRoom:e=null,bubbleWidth:s=ns.CHAT_BUBBLE_WIDTH_NORMAL}=a,[i,n]=_.useState(!1),[o,l]=_.useState(!1),c=_.useRef(),u=_.useMemo(()=>{switch(s){case ns.CHAT_BUBBLE_WIDTH_NORMAL:return 350;case ns.CHAT_BUBBLE_WIDTH_THIN:return 240;case ns.CHAT_BUBBLE_WIDTH_WIDE:return 2e3}},[s]);return _.useEffect(()=>{n(!1);const h=c.current;if(!h)return;const d=h.offsetWidth,g=h.offsetHeight;t.width=d,t.height=g,t.elementRef=h;let E=t.left,m=t.top;return!E&&!m&&(E=t.location.x-d/2,m=h.parentElement.offsetHeight-g,t.left=E,t.top=m),l(!0),()=>{t.elementRef=null,l(!1)}},[t]),_.useEffect(()=>{!o||!t||i||(e&&e(t),n(!0))},[t,o,i,e]),r.jsxs("div",{ref:c,className:`bubble-container ${i?"visible":"invisible"}`,onClick:h=>tt().selectRoomObject(t.roomId,t.senderId,W.UNIT),children:[t.styleId===0&&r.jsx("div",{className:"user-container-bg",style:{backgroundColor:t.color}}),r.jsxs("div",{className:`chat-bubble bubble-${t.styleId} type-${t.type}`,style:{maxWidth:u},children:[r.jsx("div",{className:"user-container",children:t.imageUrl&&t.imageUrl.length>0&&r.jsx("div",{className:"user-image",style:{backgroundImage:`url(${t.imageUrl})`}})}),r.jsxs("div",{className:"chat-content",children:[r.jsx("b",{className:"username mr-1",dangerouslySetInnerHTML:{__html:`${t.username}: `}}),r.jsx("span",{className:"message",dangerouslySetInnerHTML:{__html:`${t.formattedText}`}})]}),r.jsx("div",{className:"pointer"})]})]})},eet=a=>{const{chatMessages:t=[],setChatMessages:e=null,chatSettings:s=null,getScrollSpeed:i=6e3}=uQ(),n=_.useRef(),o=_.useCallback(()=>{e(u=>{if(u){const h=u.filter(d=>d.top>-d.height*2);if(h.length!==u.length)return h}return u})},[e]),l=_.useCallback((u,h,d)=>{for(let g=t.indexOf(u)-1;g>=0;g--){const E=t[g];if(!(!E||u===E||d.indexOf(E)>=0||E.top+E.height-h>u.top+u.height)&&t8(u,E,-h,0)){const m=Math.abs(E.top+E.height-u.top);d.push(E),E.top-=m,E.skipMovement=!0,l(E,m,d)}}},[t]),c=_.useCallback(u=>{u.skipMovement=!0,l(u,0,[u]),o()},[s,l,o,e]);return _.useEffect(()=>{const u=(h=null)=>{if(!n||!n.current)return;const d=n.current.offsetHeight,g=Math.round(document.body.offsetHeight*it("chat.viewer.height.percentage"));n.current.style.height=`${g}px`,e(E=>(E&&E.forEach(m=>m.top-=d-g),E))};return window.addEventListener("resize",u),u(),()=>{window.removeEventListener("resize",u)}},[e]),_.useEffect(()=>{const u=d=>{e(g=>(g.forEach(E=>{if(E.skipMovement){E.skipMovement=!1;return}E.top-=d}),g)),o()},h=new Ztt($tt);return h.onmessage=()=>u(15),h.postMessage({action:"START",content:i}),()=>{h.postMessage({action:"STOP"})}},[i,o,e]),r.jsx("div",{ref:n,className:"nitro-chat-widget",children:t.map(u=>r.jsx(tet,{chat:u,makeRoom:c,bubbleWidth:s.weight},u.id))})},dj=a=>{const{title:t=null,items:e=[],selectItem:s=null,onClose:i=null}=a,[n,o]=_.useState(null),[l,c]=_.useState(""),u=q().isModerator,h=_.useMemo(()=>{const d=l.toLocaleLowerCase();return e.filter(g=>{var E;return(E=g.name)==null?void 0:E.toLocaleLowerCase().includes(d)})},[e,l]);return _.useEffect(()=>{n&&s(n)},[n,s]),r.jsxs(Ot,{className:"nitro-chooser-widget",children:[r.jsx(St,{headerText:t,onCloseClick:i}),r.jsxs(pt,{overflow:"hidden",gap:2,children:[r.jsx("input",{type:"text",className:"form-control form-control-sm",placeholder:f("generic.search"),value:l,onChange:d=>c(d.target.value)}),r.jsx(cp,{rows:h,rowRender:d=>r.jsx(M,{alignItems:"center",className:qs("rounded p-1",n===d&&"bg-muted"),pointer:!0,onClick:g=>o(d),children:r.jsxs(O,{truncate:!0,children:[d.name," ",u&&" - "+d.id]})})})]})]})},set=a=>{const{items:t=null,onClose:e=null,selectItem:s=null,populateChooser:i=null}=pQ();return _.useEffect(()=>{const n={linkReceived:o=>{o.split("/"),i()},eventUrlPrefix:"furni-chooser/"};return Os(n),()=>Cs(n)},[i]),t?r.jsx(dj,{title:f("widget.chooser.furni.title"),items:t,selectItem:s,onClose:e}):null},iet=a=>{const{items:t=null,onClose:e=null,selectItem:s=null,populateChooser:i=null}=CQ();return _.useEffect(()=>{const n={linkReceived:o=>{o.split("/"),i()},eventUrlPrefix:"user-chooser/"};return Os(n),()=>Cs(n)},[i]),t?r.jsx(dj,{title:f("widget.chooser.user.title"),items:t,selectItem:s,onClose:e}):null},ret=a=>{const[t,e]=_.useState(!1),{users:s=[],answer:i=null}=dQ();return _.useEffect(()=>{e(!!s.length)},[s]),t?r.jsxs(Ot,{className:"nitro-widget-doorbell",windowPosition:ri.TOP_LEFT,children:[r.jsx(St,{headerText:f("navigator.doorbell.title"),onCloseClick:n=>e(!1)}),r.jsxs(pt,{overflow:"hidden",gap:0,children:[r.jsx(A,{gap:2,children:r.jsxs(_t,{gap:1,className:"text-black fw-bold border-bottom px-1 pb-1",children:[r.jsx(H,{className:"g-col-6",children:f("generic.username")}),r.jsx(H,{className:"g-col-6"})]})}),r.jsx(A,{overflow:"auto",className:"striped-children",gap:0,children:s&&s.length>0&&s.map(n=>r.jsxs(_t,{gap:1,alignItems:"center",className:"text-black border-bottom p-1",children:[r.jsx(H,{className:"g-col-6",children:n}),r.jsx(H,{className:"g-col-6",children:r.jsxs(M,{alignItems:"center",justifyContent:"end",gap:1,children:[r.jsx(V,{variant:"success",onClick:()=>i(n,!0),children:f("generic.accept")}),r.jsx(V,{variant:"danger",onClick:()=>i(n,!1),children:f("generic.deny")})]})})]},n))})]})]}):null},YO=a=>{const{objectId:t=-1,category:e=-1,noFollow:s=!1,position:i="absolute",...n}=a,[o,l]=_.useState({x:-1,y:-1}),c=_.useRef();return _.useEffect(()=>{let u=!1;const h=()=>{const g=ie();return NO(g.roomId,t,e,1)},d=()=>{const g=h();!g||!c.current||l({x:Math.round(g.left+g.width/2-c.current.offsetWidth/2),y:Math.round(g.top-c.current.offsetHeight+10)})};return s?d():(u=!0,fi().add(d)),()=>{u&&fi().remove(d)}},[t,e,s]),r.jsx(H,{innerRef:c,position:i,visible:o.x+(c.current?c.current.offsetWidth:0)>-1,className:"object-location",style:{left:o.x,top:o.y},...n})},net=a=>{const{roomIndex:t=-1,request:e=null,hideFriendRequest:s=null,requestResponse:i=null}=a;return r.jsx(YO,{objectId:t,category:W.UNIT,children:r.jsx(H,{className:"nitro-friend-request-dialog nitro-context-menu p-2",children:r.jsxs(A,{children:[r.jsxs(M,{alignItems:"center",justifyContent:"between",gap:2,children:[r.jsx(O,{variant:"white",fontSize:6,children:f("widget.friendrequest.from",["username"],[e.name])}),r.jsx(zr,{className:"cursor-pointer fa-icon",onClick:n=>s(e.requesterUserId)})]}),r.jsxs(M,{justifyContent:"end",gap:1,children:[r.jsx(V,{variant:"danger",onClick:n=>i(e.requesterUserId,!1),children:f("widget.friendrequest.decline")}),r.jsx(V,{variant:"success",onClick:n=>i(e.requesterUserId,!0),children:f("widget.friendrequest.accept")})]})]})})})},aet=a=>{const{displayedRequests:t=[],hideFriendRequest:e=null}=mQ(),{requestResponse:s=null}=ar();return t.length?r.jsx(r.Fragment,{children:t.map((i,n)=>r.jsx(net,{roomIndex:i.roomIndex,request:i.request,hideFriendRequest:e,requestResponse:s},n))}):null},oet=a=>{const{productType:t=Yt.FLOOR,classId:e=-1,extraParam:s=void 0}=a;switch(t){case Yt.WALL:case Yt.FLOOR:return r.jsx(LO,{productType:t,productClassId:e});case Yt.BADGE:return r.jsx(Ge,{badgeCode:s});case Yt.HABBO_CLUB:return r.jsx(ps,{type:"hc"})}return null},cet=a=>{const{ownerId:t=-1}=a,[e,s]=_.useState(0),[i,n]=_.useState(void 0),o=()=>{e===1&&k(new RL(t)),s(0),n(void 0)};Y(Sy,c=>{s(1)}),Y(Iy,c=>{s(0),n(void 0)}),Y(Ty,c=>{const u=c.getParser();n({contentType:u.contentType,classId:u.classId}),s(2)});const l=q().userId===t;return e===0?null:r.jsxs(Ot,{className:"nitro-mysterybox-dialog",children:[r.jsx(St,{headerText:f(e===1?`mysterybox.dialog.${l?"owner":"other"}.title`:"mysterybox.reward.title"),onCloseClick:o}),r.jsxs(pt,{children:[e===1&&r.jsxs(r.Fragment,{children:[r.jsxs(O,{variant:"primary",children:[" ",f(`mysterybox.dialog.${l?"owner":"other"}.subtitle`)," "]}),r.jsxs(O,{children:[" ",f(`mysterybox.dialog.${l?"owner":"other"}.description`)," "]}),r.jsxs(O,{children:[" ",f(`mysterybox.dialog.${l?"owner":"other"}.waiting`)]}),r.jsxs(V,{variant:"danger",onClick:o,className:"mt-auto",children:[" ",f(`mysterybox.dialog.${l?"owner":"other"}.cancel`)," "]})]}),e===2&&i&&r.jsxs(r.Fragment,{children:[r.jsxs(O,{variant:"black",children:[" ",f("mysterybox.reward.text")," "]}),r.jsx(M,{className:"prize-container justify-content-center mx-auto",children:r.jsx(oet,{classId:i.classId,productType:i.contentType})}),r.jsxs(V,{variant:"success",onClick:o,className:"mt-auto",children:[" ",f("mysterybox.reward.close")," "]})]})]})]})},uet=a=>{const{objectId:t=-1,onClose:e=null}=a,[s,i]=_.useState(""),n=()=>{k(new yP(t,s)),e()};return t===-1?null:r.jsxs(Ot,{className:"nitro-mysterytrophy-dialog no-resize",children:[r.jsx(St,{center:!0,headerText:f("mysterytrophy.header.title"),onCloseClick:e}),r.jsxs(pt,{children:[r.jsxs(M,{className:"mysterytrophy-dialog-top p-3",children:[r.jsx("div",{className:"mysterytrophy-image flex-shrink-0"}),r.jsx("div",{className:"m-2",children:r.jsx(O,{variant:"white",className:"mysterytrophy-text-big",children:f("mysterytrophy.header.description")})})]}),r.jsx(M,{className:"mysterytrophy-dialog-bottom p-2",children:r.jsxs(A,{gap:1,children:[r.jsxs(M,{alignItems:"center",className:"bg-white rounded py-1 px-2 input-mysterytrophy-dialog",children:[r.jsx("textarea",{className:"form-control form-control-sm input-mysterytrophy",value:s,onChange:o=>i(o.target.value)}),r.jsx("div",{className:"mysterytrophy-pencil-image flex-shrink-0 small fa-icon"})]}),r.jsxs(M,{className:"mt-2",gap:5,display:"flex",justifyContent:"center",alignItems:"center",children:[r.jsx(O,{pointer:!0,className:"text-decoration",onClick:()=>e(),children:f("cancel")}),r.jsx(V,{variant:"success",onClick:()=>n(),children:f("generic.ok")})]})]})})]})]})},het=a=>{const{objectId:t=-1,onClose:e=null}=a,{roomSession:s=null}=ye(),i=()=>{s.useMultistateItem(t),e()};return r.jsxs(Ot,{className:"nitro-use-product-confirmation",children:[r.jsx(St,{headerText:f("effectbox.header.title"),onCloseClick:e}),r.jsx(pt,{center:!0,children:r.jsx(M,{gap:2,children:r.jsxs(A,{justifyContent:"between",children:[r.jsx(O,{children:f("effectbox.header.description")}),r.jsxs(M,{alignItems:"center",justifyContent:"between",children:[r.jsx(V,{variant:"danger",onClick:e,children:f("generic.cancel")}),r.jsx(V,{variant:"success",onClick:i,children:f("generic.ok")})]})]})})})]})},tg=-1,det=0,_et=a=>{const{objectId:t=-1,onClose:e=null}=a,[s,i]=_.useState(null),[n,o]=_.useState(tg),{roomSession:l=null}=ye(),c=()=>{l.useMultistateItem(t),e()};return _.useEffect(()=>{if(!l||t===-1)return;const u=ip(l.roomId,t,W.FLOOR);if(!u)return;i(u);let h=tg;switch(u.specialType){case vt.MONSTERPLANT_SEED:h=det;break}if(h===tg){e();return}o(h)},[l,t,e]),n===tg?null:r.jsxs(Ot,{className:"nitro-use-product-confirmation",children:[r.jsx(St,{headerText:f("useproduct.widget.title.plant_seed",["name"],[s.name]),onCloseClick:e}),r.jsx(pt,{center:!0,children:r.jsxs(M,{gap:2,overflow:"hidden",children:[r.jsx(A,{children:r.jsx(H,{className:"product-preview",children:r.jsx(H,{className:"monsterplant-image"})})}),r.jsxs(A,{justifyContent:"between",overflow:"auto",children:[r.jsxs(A,{gap:2,children:[r.jsx(O,{children:f("useproduct.widget.text.plant_seed",["productName"],[s.name])}),r.jsx(O,{children:f("useproduct.widget.info.plant_seed")})]}),r.jsxs(M,{alignItems:"center",justifyContent:"between",children:[r.jsx(V,{variant:"danger",onClick:e,children:f("useproduct.widget.cancel")}),r.jsx(V,{variant:"success",onClick:c,children:f("widget.monsterplant_seed.button.use")})]})]})]})})]})},eg=-1,get=0,fet=a=>{const{objectId:t=-1,onClose:e=null}=a,[s,i]=_.useState(eg),[n,o]=_.useState(ce.MALE),[l,c]=_.useState(null),{roomSession:u=null}=ye(),h=()=>{YR().send(new jP(t)),YR().send(new fO(n,l)),e()};return _.useEffect(()=>{let d=eg;const g=q().figure,E=q().gender,m=[];if(u&&t>=0){const I=ip(u.roomId,t,W.FLOOR);if(I)switch(I.specialType){case vt.FIGURE_PURCHASABLE_SET:d=get;const p=I.customParams.split(",").map(T=>parseInt(T));for(const T of p)Gs().isValidFigureSetForGender(T,E)&&m.push(T);break}}if(d===eg){e();return}o(E),c(Gs().getFigureStringWithFigureIds(g,E,m)),i(d)},[u,t,e]),s===eg?null:r.jsxs(Ot,{className:"nitro-use-product-confirmation",children:[r.jsx(St,{headerText:f("useproduct.widget.title.bind_clothing"),onCloseClick:e}),r.jsx(pt,{center:!0,children:r.jsxs(M,{gap:2,overflow:"hidden",children:[r.jsx(A,{children:r.jsx(H,{className:"mannequin-preview",children:r.jsx(ls,{figure:l,direction:2})})}),r.jsxs(A,{justifyContent:"between",overflow:"auto",children:[r.jsxs(A,{gap:2,children:[r.jsx(O,{children:f("useproduct.widget.text.bind_clothing")}),r.jsx(O,{children:f("useproduct.widget.info.bind_clothing")})]}),r.jsxs(M,{alignItems:"center",justifyContent:"between",children:[r.jsx(V,{variant:"danger",onClick:e,children:f("useproduct.widget.cancel")}),r.jsx(V,{variant:"success",onClick:h,children:f("useproduct.widget.bind_clothing")})]})]})]})})]})},met=a=>{const{closeConfirm:t=null,processAction:e=null,onClose:s=null,objectId:i=-1,mode:n=null,confirmMode:o=null,confirmingObjectId:l=-1,groupData:c=null,isGroupMember:u=!1,objectOwnerId:h=-1}=m9(),{simpleAlert:d=null}=He();Y(_D,E=>{const m=E.getParser();if(m)switch(m.count){case 1:d(f("costumehopper.costumerequired.bodytext"),null,"catalog/open/temporary_effects",f("costumehopper.costumerequired.buy"),f("costumehopper.costumerequired.header"),null);break;case 2:d(f("viphopper.viprequired.bodytext"),null,"catalog/open/habbo_club",f("viprequired.buy.vip"),f("viprequired.header"),null);break;case 3:d(f("gate.viprequired.bodytext"),null,"catalog/open/habbo_club",f("viprequired.buy.vip"),f("gate.viprequired.title"),null);break}});const g=q().userId===h;return r.jsxs(r.Fragment,{children:[o===eS&&r.jsx(_et,{objectId:l,onClose:t}),o===sS&&r.jsx(fet,{objectId:l,onClose:t}),o===k0&&r.jsx(het,{objectId:l,onClose:t}),o===iS&&r.jsx(uet,{objectId:l,onClose:t}),r.jsx(cet,{ownerId:h}),i>=0&&n&&r.jsxs(Ba,{objectId:i,category:W.FLOOR,onClose:s,fades:!0,children:[n===ts.FRIEND_FURNITURE&&r.jsxs(r.Fragment,{children:[r.jsx(Pi,{children:f("friendfurni.context.title")}),r.jsx(Z,{onClick:E=>e("use_friend_furni"),children:f("friendfurni.context.use")})]}),n===ts.MONSTERPLANT_SEED&&r.jsxs(r.Fragment,{children:[r.jsx(Pi,{children:f("furni.mnstr_seed.name")}),r.jsx(Z,{onClick:E=>e("use_monsterplant_seed"),children:f("widget.monsterplant_seed.button.use")})]}),n===ts.RANDOM_TELEPORT&&r.jsxs(r.Fragment,{children:[r.jsx(Pi,{children:f("furni.random_teleport.name")}),r.jsx(Z,{onClick:E=>e("use_random_teleport"),children:f("widget.random_teleport.button.use")})]}),n===ts.PURCHASABLE_CLOTHING&&r.jsxs(r.Fragment,{children:[r.jsx(Pi,{children:f("furni.generic_usable.name")}),r.jsx(Z,{onClick:E=>e("use_purchaseable_clothing"),children:f("widget.generic_usable.button.use")})]}),n===ts.MYSTERY_BOX&&r.jsxs(r.Fragment,{children:[r.jsx(Pi,{children:f("mysterybox.context.title")}),r.jsx(Z,{onClick:E=>e("use_mystery_box"),children:f("mysterybox.context."+(g?"owner":"other")+".use")})]}),n===ts.MYSTERY_TROPHY&&r.jsxs(r.Fragment,{children:[r.jsx(Pi,{children:f("mysterytrophy.header.title")}),r.jsx(Z,{onClick:E=>e("use_mystery_trophy"),children:f("friendfurni.context.use")})]}),n===B0&&c&&r.jsxs(r.Fragment,{children:[r.jsx(Pi,{className:"cursor-pointer text-truncate",onClick:()=>C_(c.guildId),children:c.guildName}),!u&&r.jsx(Z,{onClick:E=>e("join_group"),children:f("widget.furniture.button.join.group")}),r.jsx(Z,{onClick:E=>e("go_to_group_homeroom"),children:f("widget.furniture.button.go.to.group.home.room")}),c.guildHasReadableForum&&r.jsx(Z,{onClick:E=>e("open_forum"),children:f("widget.furniture.button.open_group_forum")})]})]})]})},Eet=a=>{const{objectId:t=-1,color:e=0,setColor:s=null,applyToner:i=null,toggleToner:n=null,onClose:o=null}=d9();return t===-1?null:r.jsxs(Ot,{className:"nitro-room-widget-toner",children:[r.jsx(St,{headerText:f("widget.backgroundcolor.title"),onCloseClick:o}),r.jsxs(pt,{overflow:"hidden",justifyContent:"between",children:[r.jsx(A,{overflow:"auto",gap:1,children:r.jsx("input",{type:"color",className:"form-control",value:ir.makeColorNumberHex(e),onChange:l=>s(ir.convertFromHex(l.target.value))})}),r.jsxs(A,{gap:1,children:[r.jsx(V,{fullWidth:!0,variant:"primary",onClick:n,children:f("widget.backgroundcolor.button.on")}),r.jsx(V,{fullWidth:!0,variant:"primary",onClick:i,children:f("widget.backgroundcolor.button.apply")})]})]})]})},pet=a=>{const{objectId:t=-1,color:e="1",badgeName:s="",badgeDesc:i="",date:n="",senderName:o="",onClose:l=null}=g9();return t===-1?null:r.jsx(D0,{color:e,message:i,date:n,senderName:o,customTitle:s,onCloseClick:l})},Iet=a=>{const{objectId:t=-1,recipes:e=[],ingredients:s=[],selectedRecipe:i=null,requiredIngredients:n=null,isCrafting:o=!1,craft:l=null,selectRecipe:c=null,onClose:u=null}=p9(),{roomSession:h=null}=ye(),[d,g]=_.useState(!1),E=_.useMemo(()=>{const p=tt().getRoomObject(h.roomId,t,W.FLOOR);return Oi(p)},[t,h.roomId]),m=_.useMemo(()=>{if(!n||!n.length)return!1;for(const p of n){const T=s.find(R=>R.name===p.itemName);if(!T||T.count<p.count)return!1}return!0},[s,n]),I=()=>{if(!d){g(!0);return}l(),g(!1)};return _.useEffect(()=>{g(!1)},[i]),t===-1?null:r.jsxs(Ot,{className:"nitro-widget-crafting",children:[r.jsx(St,{headerText:f("crafting.title"),onCloseClick:u}),r.jsx(pt,{children:r.jsxs(M,{grow:!0,overflow:"hidden",gap:2,children:[r.jsxs(M,{column:!0,fullWidth:!0,gap:2,children:[r.jsxs(A,{overflow:"hidden",fullHeight:!0,children:[r.jsx("div",{className:"bg-muted rounded py-1 text-center",children:f("crafting.title.products")}),r.jsx(Ce,{columnCount:5,children:e.length>0&&e.map(p=>r.jsx(ee,{itemImage:p.iconUrl,itemActive:i&&i.name===p.name,onClick:()=>c(p)},p.name))})]}),r.jsxs(A,{overflow:"hidden",fullHeight:!0,children:[r.jsx("div",{className:"bg-muted rounded py-1 text-center",children:f("crafting.title.mixer")}),r.jsx(Ce,{columnCount:5,children:s.length>0&&s.map(p=>r.jsx(ee,{itemImage:p.iconUrl,itemCount:p.count,itemCountMinimum:0,className:(p.count?"":"opacity-0-5 ")+"cursor-default"},p.name))})]})]}),r.jsxs(M,{column:!0,fullWidth:!0,gap:2,children:[!i&&r.jsx(A,{center:!0,fullHeight:!0,className:"text-black text-center",children:f("crafting.info.start")}),i&&r.jsxs(r.Fragment,{children:[r.jsxs(A,{overflow:"hidden",fullHeight:!0,children:[r.jsx("div",{className:"bg-muted rounded py-1 text-center",children:f("crafting.current_recipe")}),r.jsx(Ce,{columnCount:5,children:!!n&&n.length>0&&n.map(p=>{const T=s.find(S=>S.name===p.itemName),R=[];for(let S=0;S<p.count;S++)R.push(r.jsx(ee,{itemImage:T.iconUrl,className:(T.count-S<=0?"opacity-0-5 ":"")+"cursor-default"},S));return R})})]}),r.jsxs(M,{gap:2,column:!0,fullHeight:!0,children:[r.jsxs(M,{gap:2,className:"bg-muted rounded",column:!0,fullHeight:!0,children:[r.jsx("div",{className:"py-1 text-center",children:f("crafting.result")}),r.jsxs(M,{gap:1,center:!0,column:!0,fullHeight:!0,className:"pb-1",children:[r.jsx(A,{fullHeight:!0,children:r.jsx("img",{src:i.iconUrl})}),r.jsx("div",{className:"text-black",children:i.localizedName})]})]}),r.jsxs(V,{variant:!E||!m?"danger":d?"warning":o?"primary":"success",disabled:!E||!m||o,onClick:I,children:[!o&&f(E?m?d?"generic.confirm":"crafting.btn.craft":"crafting.status.recipe.incomplete":"crafting.btn.notowner"),o&&r.jsx(PO,{})]})]})]})]})]})})]})},Tet=a=>{const[t,e]=_.useState(!1),{presets:s=[],dimmerState:i=0,selectedPresetId:n=0,color:o=16777215,brightness:l=255,effectId:c=0,selectedColor:u=0,setSelectedColor:h=null,selectedBrightness:d=0,setSelectedBrightness:g=null,selectedEffectId:E=0,setSelectedEffectId:m=null,selectPresetId:I=null,applyChanges:p}=T9(),T=()=>{on.previewDimmer(o,l,c===2),e(!1)};ne(nt.REMOVE_DIMMER,S=>e(!1)),_.useEffect(()=>{!s||!s.length||e(!0)},[s]);const R=_.useMemo(()=>it("widget.dimmer.colorwheel",!1),[]);return t?r.jsxs(Ot,{className:"nitro-room-widget-dimmer",children:[r.jsx(St,{headerText:f("widget.dimmer.title"),onCloseClick:T}),i===1&&r.jsx(Ro,{children:s.map(S=>r.jsx(Wn,{isActive:n===S.id,onClick:b=>I(S.id),children:f(`widget.dimmer.tab.${S.id}`)},S.id))}),r.jsxs(pt,{children:[i===0&&r.jsxs(A,{alignItems:"center",children:[r.jsx(H,{className:"dimmer-banner"}),r.jsx(O,{center:!0,className:"bg-muted rounded p-1",children:f("widget.dimmer.info.off")}),r.jsx(V,{fullWidth:!0,variant:"success",onClick:()=>on.changeState(),children:f("widget.dimmer.button.on")})]}),i===1&&r.jsxs(r.Fragment,{children:[r.jsxs(A,{gap:1,children:[r.jsx(O,{fontWeight:"bold",children:f("widget.backgroundcolor.hue")}),R&&r.jsx("input",{type:"color",className:"form-control",value:ir.makeColorNumberHex(u),onChange:S=>h(ir.convertFromHex(S.target.value))}),!R&&r.jsx(_t,{gap:1,columnCount:7,children:on.AVAILABLE_COLORS.map((S,b)=>r.jsx(A,{fullWidth:!0,pointer:!0,className:qs("color-swatch rounded",S===u&&"active"),onClick:()=>h(S),style:{backgroundColor:on.HTML_COLORS[b]}},b))})]}),r.jsxs(A,{gap:1,children:[r.jsx(O,{fontWeight:"bold",children:f("widget.backgroundcolor.lightness")}),r.jsx(Js,{className:"nitro-slider",min:on.MIN_BRIGHTNESS,max:on.MAX_BRIGHTNESS,value:d,onChange:S=>g(S),thumbClassName:"thumb percent",renderThumb:(S,b)=>r.jsx("div",{...S,children:on.scaleBrightness(b.valueNow)})})]}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"checkbox",checked:E===2,onChange:S=>m(S.target.checked?2:1)}),r.jsx(O,{children:f("widget.dimmer.type.checkbox")})]}),r.jsxs(M,{gap:1,children:[r.jsx(V,{fullWidth:!0,variant:"danger",onClick:()=>on.changeState(),children:f("widget.dimmer.button.off")}),r.jsx(V,{fullWidth:!0,variant:"success",onClick:p,children:f("widget.dimmer.button.apply")})]})]})]})]}):null},Ret=a=>{const{objectId:t=-1,value:e=0,onClose:s=null,redeem:i=null}=S9();return t===-1?null:r.jsxs(Ot,{className:"nitro-widget-exchange-credit",children:[r.jsx(St,{headerText:f("catalog.redeem.dialog.title"),onCloseClick:s}),r.jsx(pt,{center:!0,children:r.jsxs(M,{overflow:"hidden",gap:2,children:[r.jsx(A,{center:!0,children:r.jsx(H,{className:"exchange-image"})}),r.jsxs(A,{grow:!0,justifyContent:"between",overflow:"hidden",children:[r.jsxs(A,{gap:1,overflow:"auto",children:[r.jsx(O,{fontWeight:"bold",children:f("creditfurni.description",["credits"],[e.toString()])}),r.jsx(O,{children:f("creditfurni.prompt")})]}),r.jsx(V,{variant:"success",onClick:i,children:f("catalog.redeem.dialog.button.exchange")})]})]})})]})},Oet=a=>{const{currentIndex:t=-1,currentPhotos:e=null}=a,[s,i]=_.useState(0),n=e&&e.length?e[s]:null,o=()=>{i(c=>{let u=c+1;return u>=e.length&&(u=0),u})},l=()=>{i(c=>{let u=c-1;return u<0&&(u=e.length-1),u})};return _.useEffect(()=>{i(t)},[t]),n?r.jsxs(_t,{style:{display:"flex",flexDirection:"column"},children:[r.jsx(M,{center:!0,className:"picture-preview border border-black",style:n.w?{backgroundImage:"url("+n.w+")"}:{},children:!n.w&&r.jsx(O,{bold:!0,children:f("camera.loading")})}),n.m&&n.m.length&&r.jsx(O,{center:!0,children:n.m}),r.jsxs(M,{alignItems:"center",justifyContent:"between",children:[r.jsx(O,{children:n.n||""}),r.jsx(O,{children:new Date(n.t*1e3).toLocaleDateString()})]}),e.length>1&&r.jsxs(M,{className:"picture-preview-buttons",children:[r.jsx(BN,{className:"cursor-pointer picture-preview-buttons-previous fa-icon",onClick:l}),r.jsx(O,{underline:!0,className:"cursor-pointer",onClick:c=>rr(n.oi),children:n.o}),r.jsx(kN,{className:"cursor-pointer picture-preview-buttons-next fa-icon",onClick:o})]})]}):null},Cet=a=>{const{objectId:t=-1,currentPhotoIndex:e=-1,currentPhotos:s=null,onClose:i=null}=C9(),{report:n=null}=En();return t===-1||e===-1?null:r.jsxs(Ot,{className:"nitro-external-image-widget",children:[r.jsx(St,{headerText:"",isGalleryPhoto:!0,onReportPhoto:()=>n(as.PHOTO,{extraData:s[e].w,roomId:s[e].s,reportedUserId:q().userId,roomObjectId:Number(s[e].u)}),onCloseClick:i}),r.jsx(pt,{children:r.jsx(Oet,{currentIndex:e,currentPhotos:s})})]})},Aet=a=>{const{objectId:t=-1,type:e=0,stage:s=0,usernames:i=[],figures:n=[],date:o=null,onClose:l=null,respond:c=null}=N9();if(t===-1)return null;if(s>0)return r.jsxs(Ot,{className:"nitro-engraving-lock",children:[r.jsx(St,{headerText:f("friend.furniture.confirm.lock.caption"),onCloseClick:l}),r.jsxs(pt,{children:[r.jsx("h5",{className:"text-black text-center fw-bold mt-2 mb-2",children:f("friend.furniture.confirm.lock.subtitle")}),r.jsx("div",{className:"d-flex justify-content-center mb-2",children:r.jsx("div",{className:`engraving-lock-stage-${s}`})}),s===2&&r.jsx("div",{className:"text-small text-black text-center mb-2",children:f("friend.furniture.confirm.lock.other.locked")}),r.jsxs(M,{gap:1,children:[r.jsx(V,{fullWidth:!0,onClick:u=>c(!1),children:f("friend.furniture.confirm.lock.button.cancel")}),r.jsx(V,{fullWidth:!0,variant:"success",onClick:u=>c(!0),children:f("friend.furniture.confirm.lock.button.confirm")})]})]})]});if(i.length>0)return r.jsx(ml,{handleSelector:".nitro-engraving-lock-view",children:r.jsxs("div",{className:`nitro-engraving-lock-view engraving-lock-${e}`,children:[r.jsx("div",{className:"engraving-lock-close",onClick:l}),r.jsxs(M,{justifyContent:"center",children:[r.jsx("div",{className:"engraving-lock-avatar",children:r.jsx(ls,{figure:n[0],direction:2})}),r.jsx("div",{className:"engraving-lock-avatar",children:r.jsx(ls,{figure:n[1],direction:4})})]}),r.jsxs(A,{justifyContent:"between",className:"mt-1",children:[r.jsxs(A,{alignItems:"center",justifyContent:"center",gap:1,children:[r.jsxs("div",{children:[e===0&&f("lovelock.engraving.caption"),e===3&&f("wildwest.engraving.caption")]}),r.jsx("div",{children:o})]}),r.jsxs(M,{justifyContent:"center",gap:4,children:[r.jsx("div",{children:i[0]}),r.jsx("div",{children:i[1]})]})]})]})})},Net=a=>{const{objectId:t=-1,classId:e=-1,itemType:s=null,text:i=null,isOwnerOfFurniture:n=!1,senderName:o=null,senderFigure:l=null,placedItemId:c=-1,placedItemType:u=null,placedInRoom:h=!1,imageUrl:d=null,openPresent:g=null,onClose:E=null}=k9(),{groupItems:m=[]}=Bc();if(t===-1)return null;const I=p=>{const T=m.find(R=>{var S;return((S=R.getItemById(p))==null?void 0:S.id)===p});T&&mh(T),E()};return r.jsxs(Ot,{className:"nitro-gift-opening",children:[r.jsx(St,{headerText:f(o?"widget.furni.present.window.title_from":"widget.furni.present.window.title",["name"],[o]),onCloseClick:E}),r.jsxs(pt,{children:[c===-1&&r.jsxs(A,{overflow:"hidden",children:[r.jsx(M,{center:!0,overflow:"auto",children:r.jsx(M0,{userName:o,figure:l,message:i})}),n&&r.jsxs(M,{gap:1,children:[o&&r.jsx(V,{fullWidth:!0,onClick:p=>ut("catalog/open"),children:f("widget.furni.present.give_gift",["name"],[o])}),r.jsx(V,{fullWidth:!0,variant:"success",onClick:g,children:f("widget.furni.present.open_gift")})]})]}),c>-1&&r.jsxs(M,{gap:2,overflow:"hidden",children:[r.jsx(A,{center:!0,className:"p-2",children:r.jsx(Ga,{imageUrl:d})}),r.jsxs(A,{grow:!0,children:[r.jsxs(A,{center:!0,gap:1,children:[r.jsx(O,{wrap:!0,small:!0,children:f("widget.furni.present.message_opened")}),r.jsx(O,{bold:!0,fontSize:5,children:i})]}),r.jsxs(A,{grow:!0,gap:1,children:[r.jsxs(M,{gap:1,children:[h&&r.jsx(V,{fullWidth:!0,onClick:null,children:f("widget.furni.present.put_in_inventory")}),r.jsx(V,{fullWidth:!0,variant:"success",onClick:p=>I(c),children:f(h?"widget.furni.present.keep_in_room":"widget.furni.present.place_in_room")})]}),o&&o.length&&r.jsx(V,{fullWidth:!0,onClick:p=>ut("catalog/open"),children:f("widget.furni.present.give_gift",["name"],[o])})]})]})]})]})]})},xet=a=>{const{stuffDatas:t=null,getScoreType:e=null,getClearType:s=null}=D9();return!t||!t.size?null:r.jsx(r.Fragment,{children:Array.from(t.entries()).map(([i,n],o)=>r.jsx(YO,{objectId:i,category:W.FLOOR,children:r.jsxs(A,{className:"nitro-widget-high-score nitro-context-menu",gap:0,children:[r.jsx(Pi,{children:f("high.score.display.caption",["scoretype","cleartype"],[f(`high.score.display.scoretype.${e(n.scoreType)}`),f(`high.score.display.cleartype.${s(n.clearType)}`)])}),r.jsxs(hj,{overflow:"hidden",gap:1,className:"h-100",children:[r.jsxs(A,{gap:1,children:[r.jsxs(M,{alignItems:"center",children:[r.jsx(O,{center:!0,bold:!0,variant:"white",className:"col-8",children:f("high.score.display.users.header")}),r.jsx(O,{center:!0,bold:!0,variant:"white",className:"col-4",children:f("high.score.display.score.header")})]}),r.jsx("hr",{className:"m-0"})]}),r.jsx(A,{overflow:"auto",gap:1,className:"overflow-y-scroll",children:n.entries.map((l,c)=>r.jsxs(M,{alignItems:"center",children:[r.jsx(O,{center:!0,variant:"white",className:"col-8",children:l.users.join(", ")}),r.jsx(O,{center:!0,variant:"white",className:"col-4",children:l.score})]},c))})]})]})},o))})},Met=a=>(L9(),null),yet=-1,sg=0,Xp=1,ig=2,qp=3,LN=4,Det=a=>{const[t,e]=_.useState(null),[s,i]=_.useState(yet),{objectId:n=-1,figure:o=null,gender:l=null,clubLevel:c=Fi.NO_CLUB,name:u=null,setName:h=null,saveFigure:d=null,wearFigure:g=null,saveName:E=null,onClose:m=null}=U9();return _.useEffect(()=>{if(n===-1)return;const I=ie();if(I.isRoomOwner||I.controllerLevel>=Oe.GUEST||q().isModerator){i(sg);return}if(q().gender.toLowerCase()!==l.toLowerCase()){i(ig);return}if(Wr()<c){i(qp);return}i(ig)},[n,l,c]),_.useEffect(()=>{switch(s){case sg:case LN:{const I=Gs().createFigureContainer(o);eh.transformAsMannequinFigure(I),e(I.getFigureString());break}case Xp:{const I=Gs().createFigureContainer(q().figure);eh.transformAsMannequinFigure(I),e(I.getFigureString());break}case ig:case qp:{const I=eh.getMergedMannequinFigureContainer(q().figure,o);e(I.getFigureString());break}}},[s,o,c]),n===-1?null:r.jsxs(Ot,{className:"nitro-mannequin no-resize",children:[r.jsx(St,{headerText:f("mannequin.widget.title"),onCloseClick:m}),r.jsx(pt,{center:!0,children:r.jsxs(M,{fullWidth:!0,gap:2,overflow:"hidden",children:[r.jsx(A,{children:r.jsxs(H,{position:"relative",className:"mannequin-preview",children:[r.jsx(ls,{position:"absolute",figure:t,direction:2}),c>0&&r.jsx(ps,{className:"position-absolute end-2 bottom-2",type:"hc"})]})}),r.jsxs(A,{grow:!0,justifyContent:"between",overflow:"auto",children:[s===sg&&r.jsxs(r.Fragment,{children:[r.jsx("input",{type:"text",className:"form-control form-control-sm",value:u,onChange:I=>h(I.target.value),onBlur:E}),r.jsxs(A,{gap:1,children:[r.jsx(V,{variant:"success",onClick:I=>i(Xp),children:f("mannequin.widget.style")}),r.jsx(V,{variant:"success",onClick:g,children:f("mannequin.widget.wear")})]})]}),s===Xp&&r.jsxs(r.Fragment,{children:[r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:u}),r.jsx(O,{wrap:!0,children:f("mannequin.widget.savetext")})]}),r.jsxs(M,{alignItems:"center",justifyContent:"between",children:[r.jsx(O,{underline:!0,pointer:!0,onClick:I=>i(sg),children:f("mannequin.widget.back")}),r.jsx(V,{variant:"success",onClick:d,children:f("mannequin.widget.save")})]})]}),s===ig&&r.jsxs(r.Fragment,{children:[r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:u}),r.jsx(O,{children:f("mannequin.widget.weartext")})]}),r.jsx(V,{variant:"success",onClick:g,children:f("mannequin.widget.wear")})]}),s===qp&&r.jsx(M,{center:!0,grow:!0,children:r.jsx(O,{children:f("mannequin.widget.clubnotification")})}),s===LN&&r.jsx(O,{children:f("mannequin.widget.wronggender")})]})]})})]})},bet=a=>(W9(),null),_j=["9CCEFF","FF9CFF","9CFF9C","FFFF33"],vet=["blue","pink","green","yellow"],Let=a=>{let t=_j.indexOf(a);return t===-1&&(t=0),vet[t]},Pet=a=>{const{objectId:t=-1,color:e="0",setColor:s=null,text:i="",setText:n=null,canModify:o=!1,onClose:l=null}=z9();return t===-1?null:r.jsx(ml,{handleSelector:".drag-handler",windowPosition:ri.TOP_LEFT,children:r.jsxs("div",{className:"nitro-stickie nitro-stickie-image stickie-"+Let(e),children:[r.jsxs("div",{className:"d-flex align-items-center stickie-header drag-handler",children:[r.jsx("div",{className:"d-flex align-items-center flex-grow-1 h-100",children:o&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"nitro-stickie-image stickie-trash header-trash",onClick:l}),_j.map(c=>r.jsx("div",{className:"stickie-color ms-1",onClick:u=>s(c),style:{backgroundColor:ir.makeColorHex(c)}},c))]})}),r.jsx("div",{className:"d-flex align-items-center nitro-stickie-image stickie-close header-close",onClick:l})]}),r.jsx("div",{className:"stickie-context",children:r.jsx("textarea",{className:"context-text",value:i,onChange:c=>n(c.target.value),tabIndex:0,autoFocus:!0})})]})})},Uet=a=>{const{objectId:t=-1,height:e=0,maxHeight:s=60,onClose:i=null,updateHeight:n=null}=X9(),[o,l]=_.useState(""),c=u=>{l(u);const h=parseFloat(u);isNaN(h)||h===e||n(h)};return _.useEffect(()=>{l(e.toString())},[e]),t===-1?null:r.jsxs(Ot,{className:"nitro-widget-custom-stack-height",children:[r.jsx(St,{headerText:f("widget.custom.stack.height.title"),onCloseClick:i}),r.jsxs(pt,{justifyContent:"between",children:[r.jsx(O,{children:f("widget.custom.stack.height.text")}),r.jsxs(M,{gap:2,children:[r.jsx(Js,{className:"nitro-slider",min:0,max:s,step:.01,value:e,onChange:u=>n(u),renderThumb:(u,h)=>r.jsx("div",{...u,children:h.valueNow})}),r.jsx("input",{className:"show-number-arrows",style:{width:50},type:"number",min:0,max:s,value:o,onChange:u=>c(u.target.value)})]}),r.jsxs(A,{gap:1,children:[r.jsx(V,{onClick:u=>k(new af(t,-100)),children:f("furniture.above.stack")}),r.jsx(V,{onClick:u=>k(new af(t,0)),children:f("furniture.floor.level")})]})]})]})},gj=["9CCEFF","FF9CFF","9CFF9C","FFFF33"],jet=["blue","pink","green","yellow"],wet=["post_it","post_it_shakesp","post_it_dreams","post_it_xmas","post_it_vd","post_it_juninas"],Fet=["post_it","shakesp","dreams","christmas","heart","juninas"],Get=a=>{let t=gj.indexOf(a);return t===-1&&(t=0),jet[t]},Bet=a=>{let t=wet.indexOf(a);return t===-1&&(t=0),Fet[t]},ket=a=>{const{objectId:t=-1,color:e="0",text:s="",type:i="",canModify:n=!1,updateColor:o=null,updateText:l=null,trash:c=null,onClose:u=null}=Q9(),[h,d]=_.useState(!1);return _.useEffect(()=>{d(!1)},[t,e,s,i]),t===-1?null:r.jsx(ml,{handleSelector:".drag-handler",windowPosition:ri.TOP_LEFT,children:r.jsxs("div",{className:"nitro-stickie nitro-stickie-image stickie-"+(i=="post_it"?Get(e):Bet(i)),children:[r.jsxs("div",{className:"d-flex align-items-center stickie-header drag-handler",children:[r.jsx("div",{className:"d-flex align-items-center flex-grow-1 h-100",children:n&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"nitro-stickie-image stickie-trash header-trash",onClick:c}),i=="post_it"&&r.jsx(r.Fragment,{children:gj.map(g=>r.jsx("div",{className:"stickie-color ms-1",onClick:E=>o(g),style:{backgroundColor:ir.makeColorHex(g)}},g))})]})}),r.jsx("div",{className:"d-flex align-items-center nitro-stickie-image stickie-close header-close",onClick:u})]}),r.jsx("div",{className:"stickie-context",children:!h||!n?r.jsx("div",{className:"context-text",onClick:g=>n&&d(!0),children:s}):r.jsx("textarea",{className:"context-text",defaultValue:s,tabIndex:0,onBlur:g=>l(g.target.value),autoFocus:!0})})]})})},Vet=a=>{const{objectId:t=-1,color:e="1",senderName:s="",date:i="",message:n="",onClose:o=null}=$9();return t===-1?null:r.jsx(D0,{color:e,message:n,date:i,senderName:s,onCloseClick:o})},Het=a=>{const[t,e]=_.useState(null),{objectId:s=-1,videoId:i=null,videoStart:n=0,videoEnd:o=0,currentVideoState:l=null,selectedVideo:c=null,playlists:u=[],onClose:h=null,previous:d=null,next:g=null,pause:E=null,play:m=null,selectVideo:I=null}=rQ(),p=R=>{if(e(R.target),s!==-1)switch(R.target.getPlayerState()){case-1:case 1:l!==1&&m();return;case 2:l!==2&&E()}};if(_.useEffect(()=>{if(!(l===null||!t)){if(l===sl.PLAYING&&t.getPlayerState()!==sl.PLAYING){t.playVideo();return}if(l===sl.PAUSED&&t.getPlayerState()!==sl.PAUSED){t.pauseVideo();return}}},[l,t]),s===-1)return null;const T={height:"375",width:"500",playerVars:{autoplay:1,disablekb:1,controls:0,origin:window.origin,modestbranding:1,start:n,end:o}};return r.jsxs(Ot,{className:"youtube-tv-widget",children:[r.jsx(St,{headerText:f("catalog.page.youtube_tvs"),onCloseClick:h}),r.jsx(pt,{children:r.jsxs("div",{className:"row w-100 h-100",children:[r.jsxs("div",{className:"youtube-video-container col-9 overflow-hidden",children:[i&&i.length>0&&r.jsx(ew,{videoId:i,opts:T,onReady:R=>e(R.target),onStateChange:p,containerClassName:"youtubeContainer"}),(!i||i.length===0)&&r.jsx("div",{className:"empty-video w-100 h-100 justify-content-center align-items-center d-flex",children:f("widget.furni.video_viewer.no_videos")})]}),r.jsxs("div",{className:"playlist-container col-3 d-flex flex-column",children:[r.jsxs("span",{className:"playlist-controls justify-content-center d-flex",children:[r.jsx("i",{className:"icon icon-youtube-prev cursor-pointer",onClick:d}),r.jsx("i",{className:"icon icon-youtube-next cursor-pointer",onClick:g})]}),r.jsx("div",{className:"mb-1",children:f("widget.furni.video_viewer.playlists")}),r.jsx(Ce,{columnCount:1,columnMinWidth:80,columnMinHeight:100,className:"mb-1",overflow:"auto",children:u&&u.map((R,S)=>r.jsx(ee,{onClick:b=>I(R.video),itemActive:R.video===c,children:r.jsx("b",{children:R.title})},S))})]})]})})]})},Wet=a=>{const{diskInventory:t=null,addToPlaylist:e=null}=a,[s,i]=_.useState(-1),[n,o]=_.useState(-1),l=_.useCallback((h,d)=>{h.stopPropagation(),o(g=>g===d?-1:d)},[]),c=_.useCallback((h,d)=>{var g,E;h.stopPropagation(),e(d,(E=(g=Jt().soundManager.musicController)==null?void 0:g.getRoomItemPlaylist())==null?void 0:E.length)},[e]),u=()=>{ut("catalog/open/"+Of.TRAX_SONGS)};return _.useEffect(()=>{var h;if(n!==-1)return(h=Jt().soundManager.musicController)==null||h.playSong(n,di.PRIORITY_SONG_PLAY,0,0,0,0),()=>{var d;(d=Jt().soundManager.musicController)==null||d.stop(di.PRIORITY_SONG_PLAY)}},[n]),_.useEffect(()=>()=>o(-1),[]),r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"bg-success py-3 container-fluid justify-content-center d-flex rounded",children:[r.jsx("img",{src:it("image.library.url")+"playlist/title_mymusic.gif",className:"my-music"}),r.jsx("h2",{className:"ms-4",children:f("playlist.editor.my.music")})]}),r.jsx("div",{className:"h-100 overflow-y-scroll mt-4 py-2",children:r.jsx(Ce,{columnCount:3,columnMinWidth:95,gap:1,children:t&&t.getKeys().map((h,d)=>{var I;const g=t.getKey(d),E=t.getWithIndex(d),m=(I=Jt().soundManager.musicController)==null?void 0:I.getSongInfo(E);return r.jsxs(ee,{itemActive:s===d,onClick:()=>i(p=>p===d?-1:d),classNames:["text-black"],children:[r.jsx("div",{className:"disk-image flex-shrink-0 mb-n2",style:{backgroundColor:S0(m==null?void 0:m.songData)}}),r.jsx(O,{truncate:!0,fullWidth:!0,className:"text-center",children:m==null?void 0:m.name}),s===d&&r.jsxs(M,{position:"absolute",className:"bottom-0 mb-1 bg-secondary p-1 rounded",alignItems:"center",justifyContent:"center",gap:2,children:[r.jsx(V,{onClick:p=>l(p,E),variant:"light",children:r.jsx(H,{className:n===E?"pause-btn":"preview-song"})}),r.jsx(V,{onClick:p=>c(p,g),variant:"light",children:r.jsx(H,{className:"move-disk"})})]})]},d)})})}),r.jsxs("div",{className:"playlist-bottom text-black p-1",children:[r.jsx("h5",{children:f("playlist.editor.text.get.more.music")}),r.jsx("div",{children:f("playlist.editor.text.you.have.no.songdisks.available")}),r.jsx("div",{children:f("playlist.editor.text.you.can.buy.some.from.the.catalogue")}),r.jsx("button",{className:"btn btn-primary btn-sm",onClick:()=>u(),children:f("playlist.editor.button.open.catalogue")})]}),r.jsx("img",{src:it("image.library.url")+"playlist/background_get_more_music.gif",className:"get-more"})]})},Yet=a=>{var h,d;const{furniId:t=-1,playlist:e=null,currentPlayingIndex:s=-1,removeFromPlaylist:i=null,togglePlayPause:n=null}=a,[o,l]=_.useState(-1),c=g=>{o===g&&i(g)},u=(g,E)=>{n(g,E!==-1?E:0)};return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"bg-primary py-3 container-fluid justify-content-center d-flex rounded",children:[r.jsx("img",{src:it("image.library.url")+"playlist/title_playlist.gif",className:"playlist-img"}),r.jsx("h2",{className:"ms-4",children:f("playlist.editor.playlist")})]}),r.jsx("div",{className:"h-100 overflow-y-scroll py-2",children:r.jsx(M,{column:!0,gap:2,children:e&&e.map((g,E)=>r.jsxs(M,{gap:1,className:"text-black cursor-pointer "+(o===E?"border border-muted border-2 rounded":"border-2"),alignItems:"center",onClick:()=>l(m=>m===E?-1:E),children:[r.jsx(H,{onClick:()=>c(E),className:"disk-2 "+(o===E?"selected-song":""),style:{backgroundColor:o===E?"":S0(g.songData)}}),g.name]},E))})}),(!e||e.length===0)&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"playlist-bottom text-black p-1 ms-5",children:[r.jsx("h5",{children:f("playlist.editor.add.songs.to.your.playlist")}),r.jsx("div",{children:f("playlist.editor.text.click.song.to.choose.click.again.to.move")})]}),r.jsx("img",{src:it("image.library.url")+"playlist/background_add_songs.gif",className:"add-songs"})]}),e&&e.length>0&&r.jsxs(r.Fragment,{children:[s===-1&&r.jsx(V,{variant:"success",size:"lg",onClick:()=>u(t,o),children:f("playlist.editor.button.play.now")}),s!==-1&&r.jsxs(M,{gap:1,children:[r.jsx(V,{variant:"danger",onClick:()=>u(t,o),children:r.jsx(H,{className:"pause-song"})}),r.jsxs(M,{column:!0,children:[r.jsx(O,{bold:!0,display:"block",children:f("playlist.editor.text.now.playing.in.your.room")}),r.jsx(O,{children:((h=e[s])==null?void 0:h.name)+" - "+((d=e[s])==null?void 0:d.creator)})]})]})]})]})},zet=a=>{const{objectId:t=-1,currentPlayingIndex:e=-1,playlist:s=null,diskInventory:i=null,onClose:n=null,togglePlayPause:o=null,removeFromPlaylist:l=null,addToPlaylist:c=null}=w9();return t===-1?null:r.jsxs(Ot,{className:"nitro-playlist-editor-widget",children:[r.jsx(St,{headerText:f("playlist.editor.title"),onCloseClick:n}),r.jsx(pt,{children:r.jsxs("div",{className:"d-flex flex-row gap-1 h-100",children:[r.jsx("div",{className:"w-50 position-relative overflow-hidden h-100 rounded d-flex flex-column",children:r.jsx(Wet,{addToPlaylist:c,diskInventory:i})}),r.jsx("div",{className:"w-50 position-relative overflow-hidden h-100 rounded d-flex flex-column",children:r.jsx(Yet,{furniId:t,removeFromPlaylist:l,playlist:s,togglePlayPause:o,currentPlayingIndex:e})})]})})]})},Ket=a=>r.jsxs(H,{fit:!0,position:"absolute",className:"nitro-room-widgets top-0 start-0",children:[r.jsx(Eet,{}),r.jsx(pet,{}),r.jsx(Iet,{}),r.jsx(Tet,{}),r.jsx(Ret,{}),r.jsx(Cet,{}),r.jsx(Aet,{}),r.jsx(Net,{}),r.jsx(xet,{}),r.jsx(Met,{}),r.jsx(Det,{}),r.jsx(zet,{}),r.jsx(bet,{}),r.jsx(Pet,{}),r.jsx(Uet,{}),r.jsx(ket,{}),r.jsx(Vet,{}),r.jsx(met,{}),r.jsx(Het,{})]}),Xet=a=>{const{isVisible:t=!1,errorResult:e=null,petName:s=null,objectType:i=null,onChangePetName:n=null,onConfirm:o=null,onClose:l=null}=TQ();return r.jsx(r.Fragment,{children:t&&r.jsxs(Ot,{className:"nitro-pet-package no-resize",children:[r.jsx(St,{center:!0,headerText:f(i==="gnome_box"?"widgets.gnomepackage.name.title":"furni.petpackage.open"),onCloseClick:()=>l()}),r.jsxs(pt,{children:[r.jsxs(M,{className:"pet-package-container-top p-3",children:[r.jsx("div",{className:`package-image-${i} flex-shrink-0`}),r.jsx("div",{className:"m-2",children:r.jsx(O,{variant:"white",className:"package-text-big",children:f(i==="gnome_box"?"widgets.gnomepackage.name.title":"furni.petpackage")})})]}),r.jsx(M,{className:"pet-package-container-bottom p-2",children:r.jsxs(A,{gap:1,children:[r.jsxs(M,{alignItems:"center",className:"bg-white rounded py-1 px-2 input-pet-package-container",children:[r.jsx("input",{type:"text",className:"form-control form-control-sm input-pet-package",maxLength:it("pet.package.name.max.length"),placeholder:f(i==="gnome_box"?"widgets.gnomepackage.name.select":"widgets.petpackage.name.title"),value:s,onChange:c=>n(c.target.value)}),r.jsx("div",{className:"package-pencil-image flex-shrink-0 small fa-icon"})]}),e.length>0&&r.jsx(H,{className:"invalid-feedback d-block m-0",children:e}),r.jsxs(M,{className:"mt-2",gap:5,display:"flex",justifyContent:"center",alignItems:"center",children:[r.jsx(O,{pointer:!0,className:"text-decoration",onClick:()=>l(),children:f("cancel")}),r.jsx(sw,{variant:s.length<3?"danger":"success",disabled:s.length<3,onClick:()=>o(),children:f(i==="gnome_box"?"widgets.gnomepackage.name.pick":"furni.petpackage.confirm")})]})]})})]})]})})},qet=a=>{const[t,e]=_.useState("bobba"),[s,i]=_.useState(""),[n,o]=_.useState(!1),{wordsFilter:l=[],isVisible:c=null,setWordsFilter:u,onClose:h=null}=gQ(),{navigatorData:d=null}=pn(),g=I=>{(n?!s:!t)||(k(new bL(d.enteredGuestRoom.roomId,I,n?s:t)),i(""),e("bobba"),o(!1),!(I&&l.includes(n?s:t))&&u(p=>{const T=[...p];return I?T.push(n?s:t):T.splice(T.indexOf(n?s:t),1),T}))},E=I=>{e(I),o(!1)},m=I=>{i(I),o(!0)};return c?r.jsxs(Ot,{className:"nitro-guide-tool no-resize",children:[r.jsx(St,{headerText:f("navigator.roomsettings.roomfilter"),onCloseClick:()=>h()}),r.jsxs(pt,{className:"text-black",children:[r.jsxs(_t,{className:"d-flex align-items-center justify-content-end gap-2",children:[r.jsx("input",{type:"text",className:"form-control form-control-sm",maxLength:255,value:t,onChange:I=>E(I.target.value)}),r.jsx(V,{onClick:()=>g(!0),children:f("navigator.roomsettings.roomfilter.addword")})]}),r.jsx(A,{overflow:"auto",gap:0,className:"form-control form-control-sm",style:{height:"100px"},children:l&&l.length>0&&l.map((I,p)=>r.jsx(M,{alignItems:"center",className:qs("rounded p-1",s===I&&"bg-muted"),pointer:!0,onClick:T=>m(I),children:r.jsx(O,{truncate:!0,children:I})},p))}),r.jsx(_t,{className:"d-flex align-items-center justify-content-end gap-2",children:r.jsx(V,{variant:"danger",onClick:()=>g(!1),disabled:l.length===0||!n,children:f("navigator.roomsettings.roomfilter.removeword")})})]})]}):null},Qet=a=>{const[t,e]=_.useState(!1),{roomSession:s=null}=ye();Is([Ra.SHOW_THUMBNAIL,Ra.HIDE_THUMBNAIL,Ra.TOGGLE_THUMBNAIL],n=>{switch(n.type){case Ra.SHOW_THUMBNAIL:e(!0);return;case Ra.HIDE_THUMBNAIL:e(!1);return;case Ra.TOGGLE_THUMBNAIL:e(o=>!o);return}});const i=n=>{tt().saveTextureAsScreenshot(n,!0),e(!1)};return t?r.jsx(T8,{roomId:s.roomId,textureReceiver:i,onClose:()=>e(!1)}):null},Jet=a=>{const[t,e]=_.useState(!1),[s,i]=_.useState(null),[n,o]=_.useState(null),[l,c]=_.useState(null),[u,h]=_.useState(!1),{navigatorData:d=null}=pn(),{roomSession:g=null}=ye(),E=(m,I)=>{switch(m){case"settings":ut("navigator/toggle-room-info");return;case"zoom":e(p=>{let T=tt().getRoomInstanceRenderingCanvasScale(g.roomId,1);return p?T*=2:T/=2,tt().setRoomInstanceRenderingCanvasScale(g.roomId,1,T),!p});return;case"change_language":ut("change-language/toggle");return;case"chat_history":ut("chat-history/toggle");return;case"like_room":k(new ML(1));return;case"toggle_room_link":ut("navigator/toggle-room-link");return;case"navigator_search_tag":ut(`navigator/search/${I}`),k(new Nc("hotel_view",`tag:${I}`));return}};return Y(po,m=>{const I=m.getParser();!I.roomEnter||I.data.roomId!==g.roomId||(s!==I.data.roomName&&i(I.data.roomName),n!==I.data.ownerName&&o(I.data.ownerName),l!==I.data.tags&&c(I.data.tags))}),_.useEffect(()=>{h(!0);const m=setTimeout(()=>h(!1),5e3);return()=>clearTimeout(m)},[s,n,l]),r.jsxs(M,{className:"nitro-room-tools-container",gap:2,children:[r.jsxs(A,{center:!0,className:"nitro-room-tools p-2",children:[r.jsx(H,{pointer:!0,title:f("room.settings.button.text"),className:"icon icon-cog",onClick:()=>E("settings")}),r.jsx(H,{pointer:!0,title:f("room.zoom.button.text"),onClick:()=>E("zoom"),className:qs("icon",!t&&"icon-zoom-less",t&&"icon-zoom-more")}),r.jsx(H,{pointer:!0,title:f("room.chathistory.button.text"),onClick:()=>E("chat_history"),className:"icon icon-chat-history"}),r.jsx(H,{pointer:!0,title:f("room.language.change"),onClick:()=>E("change_language"),className:"icon icon-change-language"}),d.canRate&&r.jsx(H,{pointer:!0,title:f("room.like.button.text"),onClick:()=>E("like_room"),className:"icon icon-like-room"})]}),r.jsx(A,{justifyContent:"center",children:r.jsx(M_,{type:$i.SLIDE_LEFT,inProp:u,timeout:300,children:r.jsx(A,{center:!0,children:r.jsxs(A,{className:"nitro-room-tools-info rounded py-2 px-3",children:[r.jsxs(A,{gap:1,children:[r.jsx(O,{wrap:!0,variant:"white",fontSize:4,children:s}),r.jsx(O,{variant:"muted",fontSize:5,children:n})]}),l&&l.length>0&&r.jsx(M,{gap:2,children:l.map((m,I)=>r.jsxs(O,{small:!0,pointer:!0,variant:"white",className:"rounded bg-primary p-1",onClick:()=>E("navigator_search_tag",m),children:["#",m]},I))})]})})})})]})},$et=a=>{const{question:t=null,canVote:e=null,vote:s=null,noVotes:i=null,yesVotes:n=null}=a;return r.jsxs(A,{gap:2,className:"wordquiz-question p-2",children:[!e&&r.jsxs(M,{fullWidth:!0,alignItems:"center",gap:2,children:[r.jsx(M,{center:!0,pointer:!0,className:"bg-danger rounded p-2",children:r.jsx(O,{variant:"white",children:i})}),r.jsx(O,{variant:"white",center:!0,textBreak:!0,children:t}),r.jsx(M,{center:!0,pointer:!0,className:"bg-success rounded p-2",children:r.jsx(O,{variant:"white",children:n})})]}),e&&r.jsxs(A,{children:[r.jsx(O,{variant:"white",center:!0,textBreak:!0,children:t}),r.jsxs(M,{fullWidth:!0,justifyContent:"center",gap:1,children:[r.jsx(M,{center:!0,pointer:!0,className:"bg-danger rounded p-1",onClick:o=>s(bf),children:r.jsx(H,{className:"word-quiz-dislike"})}),r.jsx(M,{center:!0,pointer:!0,className:"bg-success rounded p-1",onClick:o=>s(O0),children:r.jsx(H,{className:"word-quiz-like"})})]})]})]})},Zet=a=>{const{userIndex:t=null,vote:e=null,...s}=a;return r.jsx(YO,{objectId:t,category:W.UNIT,...s,children:r.jsx(M,{center:!0,pointer:!0,className:`bg-${e===bf?"danger":"success"} rounded p-1`,children:r.jsx(H,{className:`word-quiz-${e===bf?"dislike":"like"}-sm`})})})},tst=a=>{const{question:t=null,answerSent:e=!1,answerCounts:s=null,userAnswers:i=null,vote:n=null}=xQ();return r.jsxs(r.Fragment,{children:[t&&r.jsx($et,{question:t.content,canVote:!e,vote:n,noVotes:s.get(bf)||0,yesVotes:s.get(O0)||0}),i&&Array.from(i.entries()).map(([o,l],c)=>r.jsx(Zet,{userIndex:o,vote:l.value},c))]})},est=a=>{const{roomSession:t=null}=ye(),{simpleAlert:e=null}=He();return ne(Ac.ROOM_ZOOM,s=>tt().setRoomInstanceRenderingCanvasScale(s.roomId,1,s.level,null,null,!1,s.asDelta)),ne([nt.REQUEST_TEASER,nt.REQUEST_ECOTRONBOX,nt.REQUEST_CLOTHING_CHANGE,nt.REQUEST_PLAYLIST_EDITOR,nt.OPEN_WIDGET,nt.CLOSE_WIDGET,Na.FURNI_CLICK,Na.FURNI_DOUBLE_CLICK,Na.TOOLTIP_SHOW,Na.TOOLTIP_HIDE],s=>{if(t)switch(s.objectId,s.category,s.type){}}),we([le.RSEME_KICKED,le.RSEME_PETS_FORBIDDEN_IN_HOTEL,le.RSEME_PETS_FORBIDDEN_IN_FLAT,le.RSEME_MAX_PETS,le.RSEME_MAX_NUMBER_OF_OWN_PETS,le.RSEME_NO_FREE_TILES_FOR_PET,le.RSEME_SELECTED_TILE_NOT_FREE_FOR_PET,le.RSEME_BOTS_FORBIDDEN_IN_HOTEL,le.RSEME_BOTS_FORBIDDEN_IN_FLAT,le.RSEME_BOT_LIMIT_REACHED,le.RSEME_SELECTED_TILE_NOT_FREE_FOR_BOT,le.RSEME_BOT_NAME_NOT_ACCEPTED],s=>{let i=f("error.title"),n="";switch(s.type){case le.RSEME_MAX_PETS:n=f("room.error.max_pets");break;case le.RSEME_MAX_NUMBER_OF_OWN_PETS:n=f("room.error.max_own_pets");break;case le.RSEME_KICKED:n=f("room.error.kicked"),i=f("generic.alert.title");break;case le.RSEME_PETS_FORBIDDEN_IN_HOTEL:n=f("room.error.pets.forbidden_in_hotel");break;case le.RSEME_PETS_FORBIDDEN_IN_FLAT:n=f("room.error.pets.forbidden_in_flat");break;case le.RSEME_NO_FREE_TILES_FOR_PET:n=f("room.error.pets.no_free_tiles");break;case le.RSEME_SELECTED_TILE_NOT_FREE_FOR_PET:n=f("room.error.pets.selected_tile_not_free");break;case le.RSEME_BOTS_FORBIDDEN_IN_HOTEL:n=f("room.error.bots.forbidden_in_hotel");break;case le.RSEME_BOTS_FORBIDDEN_IN_FLAT:n=f("room.error.bots.forbidden_in_flat");break;case le.RSEME_BOT_LIMIT_REACHED:n=f("room.error.max_bots");break;case le.RSEME_SELECTED_TILE_NOT_FREE_FOR_BOT:n=f("room.error.bots.selected_tile_not_free");break;case le.RSEME_BOT_NAME_NOT_ACCEPTED:n=f("room.error.bots.name.not.accepted");break;default:return}e(n,Bt.DEFAULT,null,null,i)}),r.jsxs(r.Fragment,{children:[r.jsx(Xtt,{}),r.jsx(eet,{}),r.jsx(Jtt,{}),r.jsx(ret,{}),r.jsx(Ket,{}),r.jsx(Jet,{}),r.jsx(qet,{}),r.jsx(Qet,{}),r.jsx(set,{}),r.jsx(Xet,{}),r.jsx(iet,{}),r.jsx(tst,{}),r.jsx(aet,{})]})},sst=a=>{const{roomSession:t=null}=ye(),e=_.useRef();return _.useEffect(()=>{const s=Jt().application.renderer.view;if(!s)return;s.onclick=n=>w_(n),s.onmousemove=n=>w_(n),s.onmousedown=n=>w_(n),s.onmouseup=n=>w_(n),s.ontouchstart=n=>B_(n),s.ontouchmove=n=>B_(n),s.ontouchend=n=>B_(n),s.ontouchcancel=n=>B_(n);const i=e.current;i&&i.appendChild(s)},[]),r.jsx(H,{fit:!0,innerRef:e,className:!t&&"d-none",children:t&&r.jsxs(r.Fragment,{children:[r.jsx(est,{}),t.isSpectator&&r.jsx(Ctt,{})]})})},ist=a=>{const{useGuideTool:t=!1,unseenAchievementCount:e=0,setMeExpanded:s=null,children:i=null,...n}=a,o=_.useRef();return _.useEffect(()=>{const l=ie();l&&tt().selectRoomObject(l.roomId,l.ownRoomIndex,W.UNIT)},[]),_.useEffect(()=>{const l=c=>s(!1);return document.addEventListener("click",l),()=>document.removeEventListener(at.MOUSE_CLICK,l)},[s]),r.jsxs(M,{innerRef:o,alignItems:"center",className:"nitro-toolbar-me p-2",gap:2,children:[it("guides.enabled")&&t&&r.jsx(H,{pointer:!0,className:"navigation-item icon icon-me-helper-tool",onClick:l=>Fs(new Er(Er.TOGGLE_GUIDE_TOOL))}),r.jsx(H,{pointer:!0,className:"navigation-item icon icon-me-achievements",onClick:l=>ut("achievements/toggle"),children:e>0&&r.jsx(cl,{count:e})}),r.jsx(H,{pointer:!0,className:"navigation-item icon icon-me-profile",onClick:l=>rr(q().userId)}),r.jsx(H,{pointer:!0,className:"navigation-item icon icon-me-rooms",onClick:l=>ut("navigator/search/myworld_view")}),r.jsx(H,{pointer:!0,className:"navigation-item icon icon-me-clothing",onClick:l=>ut("avatar-editor/toggle")}),r.jsx(H,{pointer:!0,className:"navigation-item icon icon-me-settings",onClick:l=>ut("user-settings/toggle")}),i]})},rst=a=>{const{isInRoom:t}=a,[e,s]=_.useState(!1),[i,n]=_.useState(!1),{userFigure:o=null}=Oo(),{getFullCount:l=0}=Kr(),{getTotalUnseen:c=0}=up(),{requests:u=[]}=ar(),{iconState:h=Ma.HIDDEN}=P0(),d=q().isModerator;return Y(VS,g=>{const E=g.getParser();n(E.isAllowed(Vg.USE_GUIDE_TOOL))}),ne(kd.ANIMATE_ICON,g=>{((m,I,p,T)=>{const R=document.body.getElementsByClassName(m)[0];if(!R)return;I.className="toolbar-icon-animation",I.style.visibility="visible",I.style.left=p+"px",I.style.top=T+"px",document.body.append(I);const S=R.getBoundingClientRect(),b=I.getBoundingClientRect(),N=b.x-S.x,P=b.y-S.y,B=Math.sqrt(N*N+P*P),F=500-Math.abs(1/B*100*500*.5),w=20,U=`ToolbarBouncing[${m}]`;Ph.getMotionByTag(U)||(Ph.runMotion(new iA(new Kq(F+8),new Vq(R,400,12))).tag=U);const G=new iA(new Yq(new zq(I,F,S.x-b.x+w,S.y-b.y,100,1),1),new kq(I));Ph.runMotion(G)})("icon-inventory",g.image,g.x,g.y)}),r.jsxs(r.Fragment,{children:[r.jsx(M_,{type:$i.FADE_IN,inProp:e,timeout:300,children:r.jsx(ist,{useGuideTool:i,unseenAchievementCount:c,setMeExpanded:s})}),r.jsxs(M,{alignItems:"center",justifyContent:"between",gap:2,className:"nitro-toolbar py-1 px-3",children:[r.jsxs(M,{gap:2,alignItems:"center",children:[r.jsxs(M,{alignItems:"center",gap:2,children:[r.jsxs(M,{center:!0,pointer:!0,className:"navigation-item item-avatar "+(e?"active ":""),onClick:g=>s(!e),children:[r.jsx(ls,{figure:o,direction:2,position:"absolute"}),c>0&&r.jsx(cl,{count:c})]}),t&&r.jsx(H,{pointer:!0,className:"navigation-item icon icon-habbo",onClick:g=>AO()}),!t&&r.jsx(H,{pointer:!0,className:"navigation-item icon icon-house",onClick:g=>ut("navigator/goto/home")}),r.jsx(H,{pointer:!0,className:"navigation-item icon icon-rooms",onClick:g=>ut("navigator/toggle")}),it("game.center.enabled")&&r.jsx(H,{pointer:!0,className:"navigation-item icon icon-game",onClick:g=>ut("games/toggle")}),r.jsx(H,{pointer:!0,className:"navigation-item icon icon-catalog",onClick:g=>ut("catalog/toggle")}),r.jsx(H,{pointer:!0,className:"navigation-item icon icon-inventory",onClick:g=>ut("inventory/toggle"),children:l>0&&r.jsx(cl,{count:l})}),t&&r.jsx(H,{pointer:!0,className:"navigation-item icon icon-camera",onClick:g=>ut("camera/toggle")}),d&&r.jsx(H,{pointer:!0,className:"navigation-item icon icon-modtools",onClick:g=>ut("mod-tools/toggle")})]}),r.jsx(M,{alignItems:"center",id:"toolbar-chat-input-container"})]}),r.jsxs(M,{alignItems:"center",gap:2,children:[r.jsxs(M,{gap:2,children:[r.jsx(H,{pointer:!0,className:"navigation-item icon icon-friendall",onClick:g=>ut("friends/toggle"),children:u.length>0&&r.jsx(cl,{count:u.length})}),(h===Ma.SHOW||h===Ma.UNREAD)&&r.jsx(H,{pointer:!0,className:`navigation-item icon icon-message ${h===Ma.UNREAD&&"is-unseen"}`,onClick:g=>ap()})]}),r.jsx(H,{id:"toolbar-friend-bar-container",className:"d-none d-lg-block"})]})]})]})},nst=a=>{const{badges:t=null,gap:e=1,justifyContent:s="between",...i}=a;return r.jsx(r.Fragment,{children:t&&t.length>0&&t.map((n,o)=>r.jsx(A,{center:!0,children:r.jsx(Ge,{badgeCode:n},n)},n))})},ast=a=>{const{relationships:t=null}=a,e=({type:s})=>{const i=t&&t.relationshipStatusMap.hasKey(s)?t.relationshipStatusMap.getValue(s):null,n=Tr.RELATIONSHIP_NAMES[s].toLocaleLowerCase();return r.jsxs(M,{fullWidth:!0,gap:1,children:[r.jsx(M,{center:!0,className:"user-relationship",children:r.jsx("i",{className:`nitro-friends-spritesheet icon-${n}`})}),r.jsxs(A,{grow:!0,gap:0,children:[r.jsxs(M,{alignItems:"center",justifyContent:"between",className:"bg-white rounded px-2 py-1 user-relationship",children:[r.jsxs(O,{small:!0,underline:!0,pointer:!0,onClick:o=>i&&i.randomFriendId>=1&&rr(i.randomFriendId),children:[(!i||i.friendCount===0)&&f("extendedprofile.add.friends"),i&&i.friendCount>=1&&i.randomFriendName]}),i&&i.friendCount>=1&&r.jsx(M,{center:!0,position:"relative",className:"avatar-image-container",children:r.jsx(ls,{figure:i.randomFriendFigure,headOnly:!0,direction:4})})]}),r.jsxs(O,{small:!0,italics:!0,className:"user-relationship-count",children:[(!i||i.friendCount===0)&&f("extendedprofile.no.friends.in.this.category"),i&&i.friendCount>1&&f(`extendedprofile.relstatus.others.${n}`,["count"],[(i.friendCount-1).toString()])," "]})]})]})};return r.jsxs(r.Fragment,{children:[r.jsx(e,{type:Tr.HEART}),r.jsx(e,{type:Tr.SMILE}),r.jsx(e,{type:Tr.BOBBA})]})},ost=a=>{const{relationships:t=null,friendsCount:e=null}=a;return r.jsxs(A,{gap:1,children:[r.jsxs(O,{small:!0,children:[r.jsx("b",{children:f("extendedprofile.friends.count")})," ",e]}),r.jsx(O,{bold:!0,small:!0,children:f("extendedprofile.relstatus")}),r.jsx(A,{children:r.jsx(ast,{relationships:t})})]})},lst=a=>{const{itsMe:t=null,groups:e=null,onLeaveGroup:s=null,overflow:i="hidden",gap:n=2,...o}=a,[l,c]=_.useState(null),[u,h]=_.useState(null);return Y(ph,d=>{const g=d.getParser();!l||l!==g.id||g.flag||h(g)}),_.useEffect(()=>{l&&k(new ch(l,!1))},[l]),_.useEffect(()=>{h(null),e.length>0&&c(d=>(d===e[0].groupId&&k(new ch(e[0].groupId,!1)),e[0].groupId))},[e]),!e||!e.length?r.jsx(A,{center:!0,fullHeight:!0,children:r.jsxs(M,{justifyContent:"center",gap:2,children:[r.jsx(H,{className:"no-group-spritesheet image-1"}),r.jsx(H,{className:"no-group-spritesheet image-2"}),r.jsx(H,{className:"no-group-spritesheet image-3"})]})}):r.jsxs(_t,{overflow:i,gap:2,...o,children:[r.jsx(A,{alignItems:"center",size:2,overflow:"auto",children:r.jsx(Ce,{overflow:null,columnCount:1,columnMinHeight:50,className:"user-groups-container",children:e.map((d,g)=>r.jsxs(ee,{overflow:"unset",itemActive:l===d.groupId,onClick:()=>c(d.groupId),className:"p-1",children:[t&&r.jsx("i",{className:"position-absolute end-0 top-0 z-index-1 icon icon-group-"+(d.favourite?"favorite":"not-favorite"),onClick:()=>K7(d)}),r.jsx(Ge,{badgeCode:d.badgeCode,isGroup:!0})]},g))})}),r.jsx(A,{size:10,overflow:"hidden",children:u&&r.jsx(nj,{groupInformation:u,onClose:s})})]})},cst=a=>{const{userProfile:t=null}=a,[e,s]=_.useState(t.requestSent),i=t.id===q().userId,n=!e&&!i&&!t.isMyFriend&&!t.requestSent,o=()=>{s(!0),k(new ZS(t.username))};return _.useEffect(()=>{s(t.requestSent)},[t]),r.jsxs(M,{gap:2,children:[r.jsx(A,{center:!0,className:"avatar-container",children:r.jsx(ls,{figure:t.figure,direction:2})}),r.jsxs(A,{children:[r.jsxs(A,{gap:0,children:[r.jsx(O,{bold:!0,children:t.username}),r.jsxs(O,{italics:!0,textBreak:!0,small:!0,children:[t.motto," "]})]}),r.jsxs(A,{gap:1,children:[r.jsxs(O,{small:!0,children:[r.jsx("b",{children:f("extendedprofile.created")})," ",t.registration]}),r.jsxs(O,{small:!0,children:[r.jsx("b",{children:f("extendedprofile.last.login")})," ",Vr.format(t.secondsSinceLastVisit,".ago",2)]}),r.jsxs(O,{small:!0,children:[r.jsx("b",{children:f("extendedprofile.achievementscore")})," ",t.achievementPoints]})]}),r.jsxs(M,{gap:1,children:[t.isOnline&&r.jsx("i",{className:"icon icon-pf-online"}),!t.isOnline&&r.jsx("i",{className:"icon icon-pf-offline"}),r.jsxs(M,{alignItems:"center",gap:1,children:[n&&r.jsx(O,{small:!0,underline:!0,pointer:!0,onClick:o,children:f("extendedprofile.addasafriend")}),!n&&r.jsxs(r.Fragment,{children:[r.jsx("i",{className:"icon icon-pf-tick"}),i&&r.jsx(O,{children:f("extendedprofile.me")}),t.isMyFriend&&r.jsx(O,{children:f("extendedprofile.friend")}),(e||t.requestSent)&&r.jsx(O,{children:f("extendedprofile.friendrequestsent")})]})]})]})]})]})},ust=a=>{const[t,e]=_.useState(null),[s,i]=_.useState([]),[n,o]=_.useState(null),l=()=>{e(null),i([]),o(null)},c=()=>{!t||t.id!==q().userId||rr(t.id)};return Y(KS,u=>{const h=u.getParser();!t||h.userId!==t.id||i(h.badges)}),Y(zS,u=>{const h=u.getParser();!t||h.userId!==t.id||o(h)}),Y(ZD,u=>{const h=u.getParser();let d=!1;e(g=>(g&&g.id&&(d=g.id===h.id),h)),d||(i([]),o(null)),k(new gO(h.id)),k(new mO(h.id))}),Y(sb,u=>{const h=u.getParser();h.userId==(t==null?void 0:t.id)&&rr(h.userId)}),ne(Rt.SELECTED,u=>{if(!t||u.category!==W.UNIT)return;const h=ie().userDataManager.getUserDataByIndex(u.objectId);h.type===be.USER&&rr(h.webID)}),t?r.jsxs(Ot,{uniqueKey:"nitro-user-profile",className:"user-profile",children:[r.jsx(St,{headerText:f("extendedprofile.caption"),onCloseClick:l}),r.jsxs(pt,{overflow:"hidden",children:[r.jsxs(_t,{fullHeight:!1,gap:2,children:[r.jsxs(A,{size:7,gap:1,className:"user-container pe-2",children:[r.jsx(cst,{userProfile:t}),r.jsx(_t,{columnCount:5,fullHeight:!0,className:"bg-muted rounded px-2 py-1",children:r.jsx(nst,{fullWidth:!0,center:!0,badges:s})})]}),r.jsx(A,{size:5,children:n&&r.jsx(ost,{relationships:n,friendsCount:t.friendsCount})})]}),r.jsx(M,{alignItems:"center",className:"rooms-button-container px-2 py-1",children:r.jsxs(M,{alignItems:"center",gap:1,onClick:u=>ut(`navigator/search/hotel_view/owner:${t.username}`),children:[r.jsx("i",{className:"icon icon-rooms"}),r.jsx(O,{bold:!0,underline:!0,pointer:!0,children:f("extendedprofile.rooms")})]})}),r.jsx(lst,{fullWidth:!0,itsMe:t.id===q().userId,groups:t.groups,onLeaveGroup:c})]})]}):null},hst=a=>{const[t,e]=_.useState(!1),[s,i]=_.useState(null);v0(),L0();const n=(l,c)=>{let u=!0;const h=s.clone();switch(l){case"close_view":e(!1),u=!1;return;case"oldchat":h.oldChat=c,k(new RU(h.oldChat));break;case"room_invites":h.roomInvites=c,k(new SU(h.roomInvites));break;case"camera_follow":h.cameraFollow=c,k(new TU(h.cameraFollow));break;case"system_volume":h.volumeSystem=c,h.volumeSystem=Math.max(0,h.volumeSystem),h.volumeSystem=Math.min(100,h.volumeSystem);break;case"furni_volume":h.volumeFurni=c,h.volumeFurni=Math.max(0,h.volumeFurni),h.volumeFurni=Math.min(100,h.volumeFurni);break;case"trax_volume":h.volumeTrax=c,h.volumeTrax=Math.max(0,h.volumeTrax),h.volumeTrax=Math.min(100,h.volumeTrax);break;case"soundboard_volume":h.volumeSoundboard=c,h.volumeSoundboard=Math.max(0,h.volumeSoundboard),h.volumeSoundboard=Math.min(100,h.volumeSoundboard);break}u&&i(h),XR(h)},o=l=>{switch(l){case"volume":k(new OU(Math.round(s.volumeSystem),Math.round(s.volumeFurni),Math.round(s.volumeTrax),Math.round(s.volumeSoundboard)));break}};return Y(XS,l=>{const c=l.getParser(),u=new il;u.volumeSystem=c.volumeSystem,u.volumeFurni=c.volumeFurni,u.volumeTrax=c.volumeTrax,u.volumeSoundboard=c.volumeSoundboard,u.oldChat=c.oldChat,u.roomInvites=c.roomInvites,u.cameraFollow=c.cameraFollow,u.flags=c.flags,u.chatType=c.chatType,i(u),XR(u)}),_.useEffect(()=>{const l={linkReceived:c=>{const u=c.split("/");if(!(u.length<2))switch(u[1]){case"show":e(!0);return;case"hide":e(!1);return;case"toggle":e(h=>!h);return}},eventUrlPrefix:"user-settings/"};return Os(l),()=>Cs(l)},[]),_.useEffect(()=>{s&&Fs(s)},[s]),!t||!s?null:r.jsxs(Ot,{uniqueKey:"user-settings",className:"user-settings-window",children:[r.jsx(St,{headerText:f("widget.memenu.settings.title"),onCloseClick:l=>n("close_view")}),r.jsxs(pt,{className:"text-black",children:[r.jsxs(A,{gap:1,children:[r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"checkbox",checked:s.oldChat,onChange:l=>n("oldchat",l.target.checked)}),r.jsx(O,{children:f("memenu.settings.chat.prefer.old.chat")})]}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"checkbox",checked:s.roomInvites,onChange:l=>n("room_invites",l.target.checked)}),r.jsx(O,{children:f("memenu.settings.other.ignore.room.invites")})]}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"checkbox",checked:s.cameraFollow,onChange:l=>n("camera_follow",l.target.checked)}),r.jsx(O,{children:f("memenu.settings.other.disable.room.camera.follow")})]})]}),r.jsxs(A,{children:[r.jsx(O,{bold:!0,children:f("widget.memenu.settings.volume")}),r.jsxs(A,{gap:1,children:[r.jsx(O,{children:f("widget.memenu.settings.volume.ui")}),r.jsxs(M,{alignItems:"center",gap:1,children:[s.volumeSystem===0&&r.jsx(v_,{className:qs(s.volumeSystem>=50&&"text-muted","fa-icon")}),s.volumeSystem>0&&r.jsx(L_,{className:qs(s.volumeSystem>=50&&"text-muted","fa-icon")}),r.jsx("input",{type:"range",className:"custom-range w-100",min:"0",max:"100",step:"1",id:"volumeSystem",value:s.volumeSystem,onChange:l=>n("system_volume",l.target.value),onMouseUp:()=>o("volume")}),r.jsx(P_,{className:qs(s.volumeSystem<50&&"text-muted","fa-icon")})]})]}),r.jsxs(A,{gap:1,children:[r.jsx(O,{children:f("widget.memenu.settings.volume.furni")}),r.jsxs(M,{alignItems:"center",gap:1,children:[s.volumeFurni===0&&r.jsx(v_,{className:qs(s.volumeFurni>=50&&"text-muted","fa-icon")}),s.volumeFurni>0&&r.jsx(L_,{className:qs(s.volumeFurni>=50&&"text-muted","fa-icon")}),r.jsx("input",{type:"range",className:"custom-range w-100",min:"0",max:"100",step:"1",id:"volumeFurni",value:s.volumeFurni,onChange:l=>n("furni_volume",l.target.value),onMouseUp:()=>o("volume")}),r.jsx(P_,{className:qs(s.volumeFurni<50&&"text-muted","fa-icon")})]})]}),r.jsxs(A,{gap:1,children:[r.jsx(O,{children:f("widget.memenu.settings.volume.trax")}),r.jsxs(M,{alignItems:"center",gap:1,children:[s.volumeTrax===0&&r.jsx(v_,{className:qs(s.volumeTrax>=50&&"text-muted","fa-icon")}),s.volumeTrax>0&&r.jsx(L_,{className:qs(s.volumeTrax>=50&&"text-muted","fa-icon")}),r.jsx("input",{type:"range",className:"custom-range w-100",min:"0",max:"100",step:"1",id:"volumeTrax",value:s.volumeTrax,onChange:l=>n("trax_volume",l.target.value),onMouseUp:()=>o("volume")}),r.jsx(P_,{className:qs(s.volumeTrax<50&&"text-muted","fa-icon")})]})]}),r.jsxs(A,{gap:1,children:[r.jsx(O,{children:f("widget.memenu.settings.volume.soundboard")}),r.jsxs(M,{alignItems:"center",gap:1,children:[s.volumeSoundboard===0&&r.jsx(v_,{className:qs(s.volumeSoundboard>=50&&"text-muted","fa-icon")}),s.volumeSoundboard>0&&r.jsx(L_,{className:qs(s.volumeSoundboard>=50&&"text-muted","fa-icon")}),r.jsx("input",{type:"range",className:"custom-range w-100",min:"0",max:"100",step:"1",id:"volumeTrax",value:s.volumeSoundboard,onChange:l=>n("soundboard_volume",l.target.value),onMouseUp:()=>o("volume")}),r.jsx(P_,{className:qs(s.volumeSoundboard<50&&"text-muted","fa-icon")})]})]})]})]})]})},dst=a=>{const{trigger:t=null,furniIds:e=[]}=Xt();return r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.pickfurnis.caption",["count","limit"],[e.length.toString(),t.maximumItemSelectionCount.toString()])}),r.jsx(O,{small:!0,children:f("wiredfurni.pickfurnis.desc")})]})},zO=a=>{const{wiredType:t="",requiresFurni:e=xt.STUFF_SELECTION_OPTION_NONE,save:s=null,validate:i=null,children:n=null,hasSpecialInput:o=!1}=a,[l,c]=_.useState(null),[u,h]=_.useState(null),[d,g]=_.useState(!1),{trigger:E=null,setTrigger:m=null,setIntParams:I=null,setStringParam:p=null,setFurniIds:T=null,setAllowsFurni:R=null,saveWired:S=null}=Xt(),b=()=>m(null),N=()=>{i&&!i()||(s&&s(),g(!0))};return _.useEffect(()=>{d&&(S(),g(!1))},[d,S]),_.useEffect(()=>{if(!E)return;const P=E.spriteId||-1,B=q().getFloorItemData(P);B?(c(B.name),h(B.description)):(c("NAME: "+P),h("NAME: "+P)),o&&(I(E.intData),p(E.stringData)),e>xt.STUFF_SELECTION_OPTION_NONE&&T(F=>(F&&F.length&&Tc.clearSelectionShaderFromFurni(F),E.selectedItems&&E.selectedItems.length?(Tc.applySelectionShaderToFurni(E.selectedItems),E.selectedItems):[])),R(e)},[E,o,e,I,p,T,R]),r.jsxs(Ot,{uniqueKey:"nitro-wired",className:"nitro-wired",children:[r.jsx(St,{headerText:f("wiredfurni.title"),onCloseClick:b}),r.jsxs(pt,{children:[r.jsxs(A,{gap:1,children:[r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("i",{className:`icon icon-wired-${t}`}),r.jsx(O,{bold:!0,children:l})]}),r.jsx(O,{small:!0,children:u})]}),!!n&&r.jsx("hr",{className:"m-0 bg-dark"}),n,e>xt.STUFF_SELECTION_OPTION_NONE&&r.jsxs(r.Fragment,{children:[r.jsx("hr",{className:"m-0 bg-dark"}),r.jsx(dst,{})]}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx(V,{fullWidth:!0,variant:"success",onClick:N,children:f("wiredfurni.ready")}),r.jsx(V,{fullWidth:!0,variant:"secondary",onClick:b,children:f("cancel")})]})]})]})},es=a=>{const{requiresFurni:t=xt.STUFF_SELECTION_OPTION_NONE,save:e=null,hasSpecialInput:s=!1,children:i=null}=a,{trigger:n=null,actionDelay:o=0,setActionDelay:l=null}=Xt();return _.useEffect(()=>{l(n.delayInPulses)},[n,l]),r.jsxs(zO,{wiredType:"action",requiresFurni:t,save:e,hasSpecialInput:s,children:[i,!!i&&r.jsx("hr",{className:"m-0 bg-dark"}),r.jsxs(A,{children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.delay",["seconds"],[N_(o)])}),r.jsx(Js,{className:"nitro-slider",min:0,max:20,value:o,onChange:c=>l(c)})]})]})},_st="hd-180-1.ch-210-66.lg-270-82.sh-290-81",gst=a=>{const[t,e]=_.useState(""),[s,i]=_.useState(""),{trigger:n=null,setStringParam:o=null}=Xt(),l=()=>o(t+Eh+s);return _.useEffect(()=>{const c=n.stringData.split(Eh);c.length>0&&e(c[0]),c.length>1&&i(c[1].length>0?c[1]:_st)},[n]),r.jsxs(es,{requiresFurni:xt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:l,children:[r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.bot.name")}),r.jsx("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:t,onChange:c=>e(c.target.value)})]}),r.jsxs(M,{center:!0,children:[r.jsx(ls,{figure:s,direction:4}),r.jsx(V,{onClick:c=>i(q().figure),children:f("wiredfurni.params.capture.figure")})]})]})},fst=a=>{const[t,e]=_.useState(""),[s,i]=_.useState(-1),{trigger:n=null,setStringParam:o=null,setIntParams:l=null}=Xt(),c=()=>{o(t),l([s])};return _.useEffect(()=>{e(n.stringData),i(n.intData.length>0?n.intData[0]:0)},[n]),r.jsxs(es,{requiresFurni:xt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:c,children:[r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.bot.name")}),r.jsx("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:t,onChange:u=>e(u.target.value)})]}),r.jsxs(A,{gap:1,children:[r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"radio",name:"followMode",id:"followMode1",checked:s===1,onChange:u=>i(1)}),r.jsx(O,{children:f("wiredfurni.params.start.following")})]}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"radio",name:"followMode",id:"followMode2",checked:s===0,onChange:u=>i(0)}),r.jsx(O,{children:f("wiredfurni.params.stop.following")})]})]})]})},mst=[2,5,7,8,9,10,27],Est=a=>{const[t,e]=_.useState(""),[s,i]=_.useState(-1),{trigger:n=null,setStringParam:o=null,setIntParams:l=null}=Xt(),c=()=>{o(t),l([s])};return _.useEffect(()=>{e(n.stringData),i(n.intData.length>0?n.intData[0]:0)},[n]),r.jsxs(es,{requiresFurni:xt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:c,children:[r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.bot.name")}),r.jsx("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:t,onChange:u=>e(u.target.value)})]}),r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.handitem")}),r.jsxs("select",{className:"form-select form-select-sm",value:s,onChange:u=>i(parseInt(u.target.value)),children:[r.jsx("option",{value:"0",children:"------"}),mst.map(u=>r.jsx("option",{value:u,children:f(`handitem${u}`)},u))]})]})]})},pst=a=>{const[t,e]=_.useState(""),{trigger:s=null,setStringParam:i=null}=Xt(),n=()=>i(t);return _.useEffect(()=>{e(s.stringData)},[s]),r.jsx(es,{requiresFurni:xt.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:n,children:r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.bot.name")}),r.jsx("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:t,onChange:o=>e(o.target.value)})]})})},Ist=a=>{const[t,e]=_.useState(""),[s,i]=_.useState(""),[n,o]=_.useState(-1),{trigger:l=null,setStringParam:c=null,setIntParams:u=null}=Xt(),h=()=>{c(t+Eh+s),u([n])};return _.useEffect(()=>{const d=l.stringData.split(Eh);d.length>0&&e(d[0]),d.length>1&&i(d[1].length>0?d[1]:""),o(l.intData.length>0?l.intData[0]:0)},[l]),r.jsxs(es,{requiresFurni:xt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:h,children:[r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.bot.name")}),r.jsx("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:t,onChange:d=>e(d.target.value)})]}),r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.message")}),r.jsx("input",{type:"text",className:"form-control form-control-sm",maxLength:it("wired.action.bot.talk.to.avatar.max.length",64),value:s,onChange:d=>i(d.target.value)})]}),r.jsxs(A,{gap:1,children:[r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"radio",name:"talkMode",id:"talkMode1",checked:n===0,onChange:d=>o(0)}),r.jsx(O,{children:f("wiredfurni.params.talk")})]}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"radio",name:"talkMode",id:"talkMode2",checked:n===1,onChange:d=>o(1)}),r.jsx(O,{children:f("wiredfurni.params.whisper")})]})]})]})},Tst=a=>{const[t,e]=_.useState(""),[s,i]=_.useState(""),[n,o]=_.useState(-1),{trigger:l=null,setStringParam:c=null,setIntParams:u=null}=Xt(),h=()=>{c(t+Eh+s),u([n])};return _.useEffect(()=>{const d=l.stringData.split(Eh);d.length>0&&e(d[0]),d.length>1&&i(d[1].length>0?d[1]:""),o(l.intData.length>0?l.intData[0]:0)},[l]),r.jsxs(es,{requiresFurni:xt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:h,children:[r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.bot.name")}),r.jsx("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:t,onChange:d=>e(d.target.value)})]}),r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.message")}),r.jsx("input",{type:"text",className:"form-control form-control-sm",maxLength:it("wired.action.bot.talk.max.length",64),value:s,onChange:d=>i(d.target.value)})]}),r.jsxs(A,{gap:1,children:[r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"radio",name:"talkMode",id:"talkMode1",checked:n===0,onChange:d=>o(0)}),r.jsx(O,{children:f("wiredfurni.params.talk")})]}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"radio",name:"talkMode",id:"talkMode2",checked:n===1,onChange:d=>o(1)}),r.jsx(O,{children:f("wiredfurni.params.shout")})]})]})]})},Rst=a=>{const[t,e]=_.useState(""),{trigger:s=null,setStringParam:i=null}=Xt(),n=()=>i(t);return _.useEffect(()=>{e(s.stringData)},[s]),r.jsx(es,{requiresFurni:xt.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:n,children:r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.bot.name")}),r.jsx("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:t,onChange:o=>e(o.target.value)})]})})},Sst=a=>r.jsx(es,{requiresFurni:xt.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!1,save:null}),Ost=a=>r.jsx(es,{requiresFurni:xt.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!1,save:null}),Cst=[0,1],Ast=a=>{const[t,e]=_.useState(""),[s,i]=_.useState(0),{trigger:n=null,setStringParam:o=null,setIntParams:l=null}=Xt(),c=()=>{o(t),l([s])};return _.useEffect(()=>{e(n.stringData),i(n.intData[0])},[n]),r.jsxs(es,{requiresFurni:xt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:c,children:[r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.message")}),r.jsx("input",{type:"text",className:"form-control form-control-sm",value:t,onChange:u=>e(u.target.value),maxLength:it("wired.action.chat.max.length",100)})]}),r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.settimesingame")}),Cst.map(u=>r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"radio",name:"rotation",id:`rotation${u}`,checked:s===u,onChange:h=>i(u)}),r.jsx(O,{children:f(`wiredfurni.params.talk.${u}`)})]},u))]})]})},Nst=a=>r.jsx(es,{requiresFurni:xt.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!1,save:null}),xst=[0,1],Mst=a=>{const[t,e]=_.useState(1),{trigger:s=null,setIntParams:i=null}=Xt(),n=()=>i([t]);return _.useEffect(()=>{s.intData.length>=1?e(s.intData[0]):e(0)},[s]),r.jsx(es,{requiresFurni:xt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.settimesingame")}),xst.map(o=>r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"radio",name:"rotation",id:`rotation${o}`,checked:t===o,onChange:l=>e(o)}),r.jsx(O,{children:f(`wiredfurni.params.freeze.${o}`)})]},o))]})})},yst=a=>{const[t,e]=_.useState(""),{trigger:s=null,setStringParam:i=null}=Xt(),n=()=>{i(t)};return _.useEffect(()=>{e(s.stringData)},[s]),r.jsx(es,{requiresFurni:xt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.message")}),r.jsx("input",{type:"text",className:"form-control form-control-sm",value:t,onChange:o=>e(o.target.value),maxLength:it("wired.action.chat.max.length",100)})]})})},Dst=a=>{const[t,e]=_.useState(!1),[s,i]=_.useState(1),[n,o]=_.useState(!1),[l,c]=_.useState(1),[u,h]=_.useState(1),[d,g]=_.useState([]),{trigger:E=null,setIntParams:m=null,setStringParam:I=null}=Xt(),p=()=>g(b=>[...b,{isBadge:!1,itemCode:"",probability:null}]),T=b=>{g(N=>{const P=Array.from(N);return P.splice(b,1),P})},R=(b,N,P,B)=>{const F=Array.from(d),w=F[b];w&&(w.isBadge=N,w.itemCode=P,w.probability=B,g(F))},S=()=>{let b=[];for(const N of d){if(!N.itemCode)continue;const P=[N.isBadge?"0":"1",N.itemCode,N.probability.toString()];b.push(P.join(","))}b.length>0&&(I(b.join(";")),m([s,n?1:0,l,u]))};return _.useEffect(()=>{const b=[];if(E.stringData.length>0&&E.stringData.includes(";")){const N=E.stringData.split(";");for(const P of N){const B=P.split(",");B.length===3&&b.push({isBadge:B[0]==="0",itemCode:B[1],probability:Number(B[2])})}}b.length===0&&b.push({isBadge:!1,itemCode:"",probability:null}),i(E.intData.length>0?E.intData[0]:0),o(E.intData.length>1?E.intData[1]===1:!1),c(E.intData.length>2?E.intData[2]:0),h(E.intData.length>3?E.intData[3]:0),e(E.intData.length>3?E.intData[3]>0:!1),g(b)},[E]),r.jsxs(es,{requiresFurni:xt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:S,children:[r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"checkbox",id:"limitEnabled",onChange:b=>e(b.target.checked)}),r.jsx(O,{children:f("wiredfurni.params.prizelimit",["amount"],[t?l.toString():""])})]}),!t&&r.jsx(O,{center:!0,small:!0,className:"bg-muted rounded p-1",children:"Reward limit not set. Make sure rewards are badges or non-tradeable items."}),t&&r.jsx(Js,{className:"nitro-slider",min:1,max:1e3,value:l,onChange:b=>c(b)}),r.jsx("hr",{className:"m-0 bg-dark"}),r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:"How often can a user be rewarded?"}),r.jsxs(M,{gap:1,children:[r.jsxs("select",{className:"form-select form-select-sm w-100",value:s,onChange:b=>i(Number(b.target.value)),children:[r.jsx("option",{value:"0",children:"Once"}),r.jsxs("option",{value:"3",children:["Once every ",u," minutes"]}),r.jsxs("option",{value:"2",children:["Once every ",u," hours"]}),r.jsxs("option",{value:"1",children:["Once every ",u," days"]})]}),s>0&&r.jsx("input",{type:"number",className:"form-control form-control-sm",value:u,onChange:b=>h(Number(b.target.value))})]})]}),r.jsx("hr",{className:"m-0 bg-dark"}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"checkbox",id:"uniqueRewards",checked:n,onChange:b=>o(b.target.checked)}),r.jsx(O,{children:"Unique rewards"})]}),r.jsx(O,{center:!0,small:!0,className:"bg-muted rounded p-1",children:"If checked each reward will be given once to each user. This will disable the probabilities option."}),r.jsx("hr",{className:"m-0 bg-dark"}),r.jsxs(M,{justifyContent:"between",alignItems:"center",children:[r.jsx(O,{bold:!0,children:"Rewards"}),r.jsx(V,{variant:"success",onClick:p,children:r.jsx(p_,{className:"fa-icon"})})]}),r.jsx(A,{gap:1,children:d&&d.map((b,N)=>r.jsxs(M,{gap:1,children:[r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"checkbox",checked:b.isBadge,onChange:P=>R(N,P.target.checked,b.itemCode,b.probability)}),r.jsx(O,{small:!0,children:"Badge?"})]}),r.jsx("input",{type:"text",className:"form-control form-control-sm",value:b.itemCode,onChange:P=>R(N,b.isBadge,P.target.value,b.probability),placeholder:"Item Code"}),r.jsx("input",{type:"number",className:"form-control form-control-sm",value:b.probability,onChange:P=>R(N,b.isBadge,b.itemCode,Number(P.target.value)),placeholder:"Probability"}),N>0&&r.jsx(V,{variant:"danger",onClick:P=>T(N),children:r.jsx(cS,{className:"fa-icon"})})]},N))})]})},bst=[0,1],vst=a=>{const[t,e]=_.useState(1),[s,i]=_.useState(1),{trigger:n=null,setIntParams:o=null}=Xt(),l=()=>o([t,s]);return _.useEffect(()=>{n.intData.length>=2?(e(n.intData[0]),i(n.intData[1])):(e(1),i(1))},[n]),r.jsxs(es,{requiresFurni:xt.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!0,save:l,children:[r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.setpoints",["points"],[t.toString()])}),r.jsx(Js,{className:"nitro-slider",min:1,max:100,value:t,onChange:c=>e(c)})]}),r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.settimesingame")}),bst.map(c=>r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"radio",name:"rotation",id:`rotation${c}`,checked:s===c,onChange:u=>i(c)}),r.jsx(O,{children:f(`wiredfurni.params.type.${c}`)})]},c))]})]})},Lst=[0,1],Pst=a=>{const[t,e]=_.useState(1),[s,i]=_.useState(1),[n,o]=_.useState(1),{trigger:l=null,setIntParams:c=null}=Xt(),u=()=>c([t,s,n]);return _.useEffect(()=>{l.intData.length>=2?(e(l.intData[0]),i(l.intData[1]),o(l.intData[2])):(e(1),i(1),o(1))},[l]),r.jsxs(es,{requiresFurni:xt.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!0,save:u,children:[r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.setpoints",["points"],[t.toString()])}),r.jsx(Js,{className:"nitro-slider",min:1,max:100,value:t,onChange:h=>e(h)})]}),r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.settimesingame")}),Lst.map(h=>r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"radio",name:"rotation",id:`rotation${h}`,checked:s===h,onChange:d=>i(h)}),r.jsx(O,{children:f(`wiredfurni.params.type.${h}`)})]},h))]}),r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.team")}),[1,2,3,4,5,6,7,8,9].map(h=>r.jsxs(M,{gap:1,children:[r.jsx("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:`selectedTeam${h}`,checked:n===h,onChange:d=>o(h)}),r.jsx(O,{children:f("wiredfurni.params.team."+h)})]},h))]})]})},Ust=a=>{const[t,e]=_.useState(1),[s,i]=_.useState(1),{trigger:n=null,setIntParams:o=null}=Xt(),l=()=>o([t,s]);return _.useEffect(()=>{n.intData.length>=2?(e(n.intData[0]),i(n.intData[1])):(e(1),i(1))},[n]),r.jsxs(es,{requiresFurni:xt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:l,children:[r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.setpoints",["points"],[t.toString()])}),r.jsx(Js,{className:"nitro-slider",min:1,max:100,value:t,onChange:c=>e(c)})]}),r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.settimesingame",["times"],[s.toString()])}),r.jsx(Js,{className:"nitro-slider",min:1,max:10,value:s,onChange:c=>i(c)})]})]})},jst=a=>{const[t,e]=_.useState(-1),{trigger:s=null,setIntParams:i=null}=Xt(),n=()=>i([t]);return _.useEffect(()=>{e(s.intData.length>0?s.intData[0]:0)},[s]),r.jsx(es,{requiresFurni:xt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.team")}),[1,2,3,4,5,6,7,8,9].map(o=>r.jsxs(M,{gap:1,children:[r.jsx("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:`selectedTeam${o}`,checked:t===o,onChange:l=>e(o)}),r.jsx(O,{children:f(`wiredfurni.params.team.${o}`)})]},o))]})})},wst=a=>{const[t,e]=_.useState(""),{trigger:s=null,setStringParam:i=null}=Xt(),n=()=>i(t);return _.useEffect(()=>{e(s.stringData)},[s]),r.jsx(es,{requiresFurni:xt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.message")}),r.jsx("input",{type:"text",className:"form-control form-control-sm",value:t,onChange:o=>e(o.target.value),maxLength:it("wired.action.kick.from.room.max.length",100)})]})})},Fst=a=>r.jsx(es,{requiresFurni:xt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),Gst=[{value:0,icon:"ne"},{value:2,icon:"se"},{value:4,icon:"sw"},{value:6,icon:"nw"}],Bst=[0,1,2,3,4,5,6],kst=a=>{const[t,e]=_.useState(-1),[s,i]=_.useState(-1),{trigger:n=null,setIntParams:o=null}=Xt(),l=()=>o([t,s]);return _.useEffect(()=>{n.intData.length>=2?(e(n.intData[0]),i(n.intData[1])):(e(-1),i(-1))},[n]),r.jsxs(es,{requiresFurni:xt.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!0,save:l,children:[r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.startdir")}),r.jsx(M,{gap:1,children:Gst.map(c=>r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"radio",name:"movement",id:`movement${c.value}`,checked:t===c.value,onChange:u=>e(c.value)}),r.jsx(O,{children:r.jsx("i",{className:`icon icon-${c.icon}`})})]},c.value))})]}),r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.turn")}),Bst.map(c=>r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"radio",name:"rotation",id:`rotation${c}`,checked:s===c,onChange:u=>i(c)}),r.jsx(O,{children:f(`wiredfurni.params.turn.${c}`)})]},c))]})]})},Vst=[{value:0,icon:"ne"},{value:2,icon:"se"},{value:4,icon:"sw"},{value:6,icon:"nw"}],Hst=a=>{const[t,e]=_.useState(-1),[s,i]=_.useState(-1),{trigger:n=null,setIntParams:o=null}=Xt(),l=()=>o([s,t]);return _.useEffect(()=>{n.intData.length>=2?(e(n.intData[1]),i(n.intData[0])):(e(-1),i(-1))},[n]),r.jsxs(es,{requiresFurni:xt.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!0,save:l,children:[r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.emptytiles",["tiles"],[t.toString()])}),r.jsx(Js,{className:"nitro-slider",min:1,max:5,value:t,onChange:c=>e(c)})]}),r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.startdir")}),r.jsx(M,{gap:1,children:Vst.map(c=>r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"radio",name:"movement",id:`movement${c.value}`,checked:s===c.value,onChange:u=>i(c.value)}),r.jsx(O,{children:r.jsx("i",{className:`icon icon-${c.icon}`})})]},c.value))})]})]})},Wst=[{value:4,icon:"ne"},{value:5,icon:"se"},{value:6,icon:"sw"},{value:7,icon:"nw"},{value:2,icon:"mv-2"},{value:3,icon:"mv-3"},{value:1,icon:"mv-1"}],Yst=[0,1,2,3],zst=a=>{const[t,e]=_.useState(-1),[s,i]=_.useState(-1),{trigger:n=null,setIntParams:o=null}=Xt(),l=()=>o([t,s]);return _.useEffect(()=>{n.intData.length>=2?(e(n.intData[0]),i(n.intData[1])):(e(-1),i(-1))},[n]),r.jsxs(es,{requiresFurni:xt.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!0,save:l,children:[r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.movefurni")}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:"movement0",checked:t===0,onChange:c=>e(0)}),r.jsx(O,{children:f("wiredfurni.params.movefurni.0")})]}),r.jsxs(M,{gap:1,children:[Wst.map(c=>r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"radio",name:"movement",id:`movement${c.value}`,checked:t===c.value,onChange:u=>e(c.value)}),r.jsx("i",{className:`icon icon-${c.icon}`})]},c.value)),r.jsx("div",{className:"col"})]})]}),r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.rotatefurni")}),Yst.map(c=>r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"radio",name:"rotation",id:`rotation${c}`,checked:s===c,onChange:u=>i(c)}),r.jsxs(O,{children:[[1,2].includes(c)&&r.jsx("i",{className:`icon icon-rot-${c}`}),f(`wiredfurni.params.rotatefurni.${c}`)]})]},c))]})]})},Kst=a=>{const[t,e]=_.useState(-1),[s,i]=_.useState(""),{trigger:n=null,setIntParams:o=null,setStringParam:l=null}=Xt(),c=()=>{o([t]),l(s)};return _.useEffect(()=>{e(n.intData.length>0?n.intData[0]:0),i(n.stringData)},[n]),r.jsxs(es,{requiresFurni:xt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:c,children:[r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.length.minutes",["minutes"],[t.toString()])}),r.jsx(Js,{className:"nitro-slider",min:1,max:10,value:t,onChange:u=>e(u)})]}),r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.message")}),r.jsx("input",{type:"text",className:"form-control form-control-sm",value:s,onChange:u=>i(u.target.value),maxLength:it("wired.action.mute.user.max.length",100)})]})]})},Xst=a=>r.jsx(es,{requiresFurni:xt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),qst=a=>{const[t,e]=_.useState(0),[s,i]=_.useState(0),[n,o]=_.useState(0),[l,c]=_.useState(0),{trigger:u=null,setIntParams:h=null}=Xt(),d=()=>h([t,s,n,l]);return _.useEffect(()=>{e(u.getBoolean(0)?1:0),i(u.getBoolean(1)?1:0),o(u.getBoolean(2)?1:0),c(u.getBoolean(3)?1:0)},[u]),r.jsx(es,{requiresFurni:xt.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:d,children:r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.conditions")}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"checkbox",id:"stateFlag",checked:!!t,onChange:g=>e(g.target.checked?1:0)}),r.jsx(O,{children:f("wiredfurni.params.condition.state")})]}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"checkbox",id:"directionFlag",checked:!!s,onChange:g=>i(g.target.checked?1:0)}),r.jsx(O,{children:f("wiredfurni.params.condition.direction")})]}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"checkbox",id:"positionFlag",checked:!!n,onChange:g=>o(g.target.checked?1:0)}),r.jsx(O,{children:f("wiredfurni.params.condition.position")})]}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"checkbox",id:"altitudeFlag",checked:!!l,onChange:g=>c(g.target.checked?1:0)}),r.jsx(O,{children:f("wiredfurni.params.condition.altitude")})]})]})})},Qst=a=>r.jsx(es,{requiresFurni:xt.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!1,save:null}),Jst=[0,1],$st=a=>{const[t,e]=_.useState(1),{trigger:s=null,setIntParams:i=null}=Xt(),n=()=>i([t]);return _.useEffect(()=>{s.intData.length>=1?e(s.intData[0]):e(0)},[s]),r.jsx(es,{requiresFurni:xt.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!1,save:n,children:r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.status")}),Jst.map(o=>r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"radio",name:"rotation",id:`rotation${o}`,checked:t===o,onChange:l=>e(o)}),r.jsx(O,{children:f(`wiredfurni.params.status.${o}`)})]},o))]})})},Zst=a=>{switch(a){case ke.BOT_CHANGE_FIGURE:return r.jsx(gst,{});case ke.BOT_FOLLOW_AVATAR:return r.jsx(fst,{});case ke.BOT_GIVE_HAND_ITEM:return r.jsx(Est,{});case ke.BOT_MOVE:return r.jsx(pst,{});case ke.BOT_TALK:return r.jsx(Tst,{});case ke.BOT_TALK_DIRECT_TO_AVTR:return r.jsx(Ist,{});case ke.BOT_TELEPORT:return r.jsx(Rst,{});case ke.CALL_ANOTHER_STACK:return r.jsx(Sst,{});case ke.CHASE:return r.jsx(Ost,{});case ke.CHAT:return r.jsx(Ast,{});case ke.FLEE:return r.jsx(Nst,{});case ke.GIVE_REWARD:return r.jsx(Dst,{});case ke.GIVE_SCORE:return r.jsx(Ust,{});case ke.GIVE_SCORE_TO_PREDEFINED_TEAM:return r.jsx(Pst,{});case ke.JOIN_TEAM:return r.jsx(jst,{});case ke.KICK_FROM_ROOM:return r.jsx(wst,{});case ke.LEAVE_TEAM:return r.jsx(Fst,{});case ke.MOVE_FURNI:return r.jsx(zst,{});case ke.MOVE_AND_ROTATE_FURNI:return r.jsx(kst,{});case ke.MOVE_FURNI_TO:return r.jsx(Hst,{});case ke.MUTE_USER:return r.jsx(Kst,{});case ke.RESET:return r.jsx(Xst,{});case ke.SET_FURNI_STATE:return r.jsx(qst,{});case ke.TELEPORT:return r.jsx(Qst,{});case ke.TOGGLE_FURNI_STATE:return r.jsx($st,{});case ke.GIVE_SCORE_CUSTOM:return r.jsx(vst,{});case ke.FREEZE:return r.jsx(Mst,{});case ke.GIVE_REWARD_CUSTOM:return r.jsx(yst,{})}return null},Gi=a=>{const{requiresFurni:t=xt.STUFF_SELECTION_OPTION_NONE,save:e=null,hasSpecialInput:s=!1,children:i=null}=a,n=()=>e&&e();return r.jsx(zO,{wiredType:"condition",requiresFurni:t,hasSpecialInput:s,save:n,children:i})},tit=[2,5,7,8,9,10,27],eit=a=>{const[t,e]=_.useState(-1),{trigger:s=null,setIntParams:i=null}=Xt(),n=()=>i([t]);return _.useEffect(()=>{e(s.intData.length>0?s.intData[0]:0)},[s]),r.jsx(Gi,{requiresFurni:xt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.handitem")}),r.jsx("select",{className:"form-select form-select-sm",value:t,onChange:o=>e(parseInt(o.target.value)),children:tit.map(o=>r.jsx("option",{value:o,children:f(`handitem${o}`)},o))})]})})},sit=a=>r.jsx(Gi,{requiresFurni:xt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),iit=a=>r.jsx(Gi,{requiresFurni:xt.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!1,save:null}),rit=[1,2,3,4,5,6,7,8,9],nit=a=>{const[t,e]=_.useState(-1),{trigger:s=null,setIntParams:i=null}=Xt(),n=()=>i([t]);return _.useEffect(()=>{e(s.intData.length>0?s.intData[0]:0)},[s]),r.jsx(Gi,{requiresFurni:xt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.team")}),rit.map(o=>r.jsxs(M,{gap:1,alignItems:"center",children:[r.jsx("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:`selectedTeam${o}`,checked:t===o,onChange:l=>e(o)}),r.jsx(O,{children:f(`wiredfurni.params.team.${o}`)})]},o))]})})},ait=a=>{const[t,e]=_.useState(""),{trigger:s=null,setStringParam:i=null}=Xt(),n=()=>i(t);return _.useEffect(()=>{e(s.stringData)},[s]),r.jsx(Gi,{requiresFurni:xt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.badgecode")}),r.jsx("input",{type:"text",className:"form-control form-control-sm",value:t,onChange:o=>e(o.target.value)})]})})},oit=a=>{const[t,e]=_.useState(-1),{trigger:s=null,setIntParams:i=null}=Xt(),n=()=>i([t]);return _.useEffect(()=>{e((s==null?void 0:s.intData[0])??0)},[s]),r.jsx(Gi,{requiresFurni:xt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.tooltip.effectid")}),r.jsx("input",{type:"number",className:"form-control form-control-sm",value:t,onChange:o=>e(parseInt(o.target.value))})]})})},lit=a=>{const[t,e]=_.useState(""),[s,i]=_.useState(""),{trigger:n=null,setIntParams:o=null}=Xt(),l=()=>{let c=0,u=0;const h=new Date(t),d=new Date(s);h&&d&&(c=h.getTime()/1e3,u=d.getTime()/1e3),o([c,u])};return _.useEffect(()=>{if(n.intData.length>=2){let c=new Date,u=new Date;n.intData[0]>0&&(c=new Date(n.intData[0]*1e3)),n.intData[1]>0&&(u=new Date(n.intData[1]*1e3)),e(OA(c)),i(OA(u))}},[n]),r.jsxs(Gi,{requiresFurni:xt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:l,children:[r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.startdate")}),r.jsx("input",{type:"text",className:"form-control form-control-sm",value:t,onChange:c=>e(c.target.value)})]}),r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.enddate")}),r.jsx("input",{type:"text",className:"form-control form-control-sm",value:s,onChange:c=>i(c.target.value)})]})]})},cit=a=>r.jsx(Gi,{requiresFurni:xt.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!1,save:null}),uit=a=>{const[t,e]=_.useState(-1),{trigger:s=null,setIntParams:i=null}=Xt(),n=()=>i([t]);return _.useEffect(()=>{e(s.intData.length>0?s.intData[0]:0)},[s]),r.jsx(Gi,{requiresFurni:xt.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:n,children:r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.requireall")}),[0,1].map(o=>r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"radio",name:"requireAll",id:`requireAll${o}`,checked:t===o,onChange:l=>e(o)}),r.jsx(O,{children:f("wiredfurni.params.requireall."+o)})]},o))]})})},hit=a=>{const[t,e]=_.useState(-1),{trigger:s=null,setIntParams:i=null}=Xt(),n=()=>i([t]);return _.useEffect(()=>{e(s.intData.length>0?s.intData[0]:0)},[s]),r.jsx(Gi,{requiresFurni:xt.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:n,children:r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.not_requireall")}),[0,1].map(o=>r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"radio",name:"requireAll",id:`requireAll${o}`,checked:t===o,onChange:l=>e(o)}),r.jsx(O,{children:f(`wiredfurni.params.not_requireall.${o}`)})]},o))]})})},dit=a=>r.jsx(Gi,{requiresFurni:xt.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!1,save:null}),_it=a=>{const[t,e]=_.useState(0),[s,i]=_.useState(0),[n,o]=_.useState(0),{trigger:l=null,setIntParams:c=null}=Xt(),u=()=>c([t,s,n]);return _.useEffect(()=>{e(l.getBoolean(0)?1:0),i(l.getBoolean(1)?1:0),o(l.getBoolean(2)?1:0)},[l]),r.jsx(Gi,{requiresFurni:xt.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:u,children:r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.conditions")}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"checkbox",id:"stateFlag",checked:!!t,onChange:h=>e(h.target.checked?1:0)}),r.jsx(O,{children:f("wiredfurni.params.condition.state")})]}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"checkbox",id:"directionFlag",checked:!!s,onChange:h=>i(h.target.checked?1:0)}),r.jsx(O,{children:f("wiredfurni.params.condition.direction")})]}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"checkbox",id:"positionFlag",checked:!!n,onChange:h=>o(h.target.checked?1:0)}),r.jsx(O,{children:f("wiredfurni.params.condition.position")})]})]})})},git=a=>r.jsx(Gi,{requiresFurni:xt.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!1,save:null}),fit=a=>{const[t,e]=_.useState(-1),{trigger:s=null,setIntParams:i=null}=Xt(),n=()=>i([t]);return _.useEffect(()=>{e(s.intData.length>0?s.intData[0]:0)},[s]),r.jsx(Gi,{requiresFurni:xt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.allowbefore",["seconds"],[N_(t)])}),r.jsx(Js,{className:"nitro-slider",min:1,max:1200,value:t,onChange:o=>e(o)})]})})},mit=a=>{const[t,e]=_.useState(-1),{trigger:s=null,setIntParams:i=null}=Xt(),n=()=>i([t]);return _.useEffect(()=>{e(s.intData.length>0?s.intData[0]:0)},[s]),r.jsx(Gi,{requiresFurni:xt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.allowafter",["seconds"],[N_(t)])}),r.jsx(Js,{className:"nitro-slider",min:1,max:1200,value:t,onChange:o=>e(o)})]})})},Eit=a=>{const[t,e]=_.useState(1),[s,i]=_.useState(1),{trigger:n=null,setIntParams:o=null}=Xt(),l=()=>o([t,s]);return _.useEffect(()=>{n.intData.length>=2?(e(n.intData[0]),i(n.intData[1])):(e(1),i(1))},[n]),r.jsxs(Gi,{requiresFurni:xt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:l,children:[r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.usercountmin",["value"],[t.toString()])}),r.jsx(Js,{className:"nitro-slider",min:1,max:50,value:t,onChange:c=>e(c)})]}),r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.usercountmax",["value"],[s.toString()])}),r.jsx(Js,{className:"nitro-slider",min:1,max:50,value:s,onChange:c=>i(c)})]})]})},pit=a=>{switch(a){case is.ACTOR_HAS_HANDITEM:return r.jsx(eit,{});case is.ACTOR_IS_GROUP_MEMBER:case is.NOT_ACTOR_IN_GROUP:return r.jsx(sit,{});case is.ACTOR_IS_ON_FURNI:case is.NOT_ACTOR_ON_FURNI:return r.jsx(iit,{});case is.ACTOR_IS_IN_TEAM:case is.NOT_ACTOR_IN_TEAM:return r.jsx(nit,{});case is.ACTOR_IS_WEARING_BADGE:case is.NOT_ACTOR_WEARS_BADGE:return r.jsx(ait,{});case is.ACTOR_IS_WEARING_EFFECT:case is.NOT_ACTOR_WEARING_EFFECT:return r.jsx(oit,{});case is.DATE_RANGE_ACTIVE:return r.jsx(lit,{});case is.FURNIS_HAVE_AVATARS:case is.FURNI_NOT_HAVE_HABBO:return r.jsx(cit,{});case is.HAS_STACKED_FURNIS:return r.jsx(uit,{});case is.NOT_HAS_STACKED_FURNIS:return r.jsx(hit,{});case is.STUFF_TYPE_MATCHES:case is.NOT_FURNI_IS_OF_TYPE:return r.jsx(dit,{});case is.STATES_MATCH:case is.NOT_STATES_MATCH:return r.jsx(_it,{});case is.TIME_ELAPSED_LESS:return r.jsx(fit,{});case is.TIME_ELAPSED_MORE:return r.jsx(mit,{});case is.USER_COUNT_IN:case is.NOT_USER_COUNT_IN:return r.jsx(Eit,{});case is.ONE_CONDITION_TRUE:return r.jsx(git,{})}return null},Nr=a=>{const{requiresFurni:t=xt.STUFF_SELECTION_OPTION_NONE,save:e=null,hasSpecialInput:s=!1,children:i=null}=a,n=()=>e&&e();return r.jsx(zO,{wiredType:"trigger",requiresFurni:t,hasSpecialInput:s,save:n,children:i})},Iit=a=>{const[t,e]=_.useState(""),[s,i]=_.useState(0),{trigger:n=null,setStringParam:o=null}=Xt(),l=()=>o(s===1?t:"");return _.useEffect(()=>{e(n.stringData),i(n.stringData?1:0)},[n]),r.jsx(Nr,{requiresFurni:xt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:l,children:r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.picktriggerer")}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"radio",name:"avatarMode",id:"avatarMode0",checked:s===0,onChange:c=>i(0)}),r.jsx(O,{children:f("wiredfurni.params.anyavatar")})]}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"radio",name:"avatarMode",id:"avatarMode1",checked:s===1,onChange:c=>i(1)}),r.jsx(O,{children:f("wiredfurni.params.certainavatar")})]}),s===1&&r.jsx("input",{type:"text",className:"form-control form-control-sm",value:t,onChange:c=>e(c.target.value)})]})})},Tit=[0,1],Rit=a=>{const[t,e]=_.useState(""),[s,i]=_.useState(-1),[n,o]=_.useState(0),{trigger:l=null,setStringParam:c=null,setIntParams:u=null}=Xt(),h=()=>{c(t),u([s,n])};return _.useEffect(()=>{e(l.stringData),i(l.intData.length>0?l.intData[0]:0),o(l.intData.length>1?l.intData[1]:0)},[l]),r.jsxs(Nr,{requiresFurni:xt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:h,children:[r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.whatissaid")}),r.jsx("input",{type:"text",className:"form-control form-control-sm",value:t,onChange:d=>e(d.target.value)})]}),r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.settimesingame")}),Tit.map(d=>r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"radio",name:"rotation",id:`rotation${d}`,checked:n===d,onChange:g=>o(d)}),r.jsx(O,{children:f(`wiredfurni.params.sendtype.${d}`)})]},d))]}),r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.picktriggerer")}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"radio",name:"triggererAvatar",id:"triggererAvatar0",checked:s===0,onChange:d=>i(0)}),r.jsx(O,{children:f("wiredfurni.params.anyavatar")})]}),r.jsxs(M,{alignItems:"center",gap:1,children:[r.jsx("input",{className:"form-check-input",type:"radio",name:"triggererAvatar",id:"triggererAvatar1",checked:s===1,onChange:d=>i(1)}),r.jsx(O,{children:q().userName})]})]})]})},Sit=a=>r.jsx(Nr,{requiresFurni:xt.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!1,save:null}),Oit=a=>r.jsx(Nr,{requiresFurni:xt.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!1,save:null}),Cit=a=>{const[t,e]=_.useState(""),{trigger:s=null,setStringParam:i=null}=Xt(),n=()=>i(t);return _.useEffect(()=>{e(s.stringData)},[s]),r.jsx(Nr,{requiresFurni:xt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.bot.name")}),r.jsx("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:t,onChange:o=>e(o.target.value)})]})})},Ait=a=>{const[t,e]=_.useState(""),{trigger:s=null,setStringParam:i=null}=Xt(),n=()=>i(t);return _.useEffect(()=>{e(s.stringData)},[s]),r.jsx(Nr,{requiresFurni:xt.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!0,save:n,children:r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.bot.name")}),r.jsx("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:t,onChange:o=>e(o.target.value)})]})})},Nit=a=>r.jsx(Nr,{requiresFurni:xt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),xit=a=>{const[t,e]=_.useState(1),{trigger:s=null,setIntParams:i=null}=Xt(),n=()=>i([t]);return _.useEffect(()=>{e(s.intData.length>0?s.intData[0]:0)},[s]),r.jsx(Nr,{requiresFurni:xt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.settime",["seconds"],[N_(t)])}),r.jsx(Js,{className:"nitro-slider",min:1,max:1200,value:t,onChange:o=>e(o)})]})})},Mit=a=>{const[t,e]=_.useState(1),{trigger:s=null,setIntParams:i=null}=Xt(),n=()=>i([t]);return _.useEffect(()=>{e(s.intData.length>0?s.intData[0]:0)},[s]),r.jsx(Nr,{requiresFurni:xt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.setlongtime",["time"],[Vr.format(t*5).toString()])}),r.jsx(Js,{className:"nitro-slider",min:1,max:120,value:t,onChange:o=>e(o)})]})})},yit=a=>{const[t,e]=_.useState(1),{trigger:s=null,setIntParams:i=null}=Xt(),n=()=>i([t]);return _.useEffect(()=>{e(s.intData.length>0?s.intData[0]:0)},[s]),r.jsx(Nr,{requiresFurni:xt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.settime",["seconds"],[N_(t)])}),r.jsx(Js,{className:"nitro-slider",min:1,max:60,value:t,onChange:o=>e(o)})]})})},Dit=a=>r.jsx(Nr,{requiresFurni:xt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),bit=a=>r.jsx(Nr,{requiresFurni:xt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),vit=a=>{const[t,e]=_.useState(1),{trigger:s=null,setIntParams:i=null}=Xt(),n=()=>i([t]);return _.useEffect(()=>{e(s.intData.length>0?s.intData[0]:0)},[s]),r.jsx(Nr,{requiresFurni:xt.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:r.jsxs(A,{gap:1,children:[r.jsx(O,{bold:!0,children:f("wiredfurni.params.setscore",["points"],[t.toString()])}),r.jsx(Js,{className:"nitro-slider",min:1,max:1e3,value:t,onChange:o=>e(o)})]})})},Lit=a=>r.jsx(Nr,{requiresFurni:xt.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!1,save:null}),Pit=a=>{switch(a){case Ni.AVATAR_ENTERS_ROOM:return r.jsx(Iit,{});case Ni.AVATAR_SAYS_SOMETHING:return r.jsx(Rit,{});case Ni.AVATAR_WALKS_OFF_FURNI:return r.jsx(Sit,{});case Ni.AVATAR_WALKS_ON_FURNI:return r.jsx(Oit,{});case Ni.BOT_REACHED_AVATAR:return r.jsx(Cit,{});case Ni.BOT_REACHED_STUFF:return r.jsx(Ait,{});case Ni.COLLISION:return r.jsx(Nit,{});case Ni.EXECUTE_ONCE:return r.jsx(xit,{});case Ni.EXECUTE_PERIODICALLY:return r.jsx(yit,{});case Ni.EXECUTE_PERIODICALLY_LONG:return r.jsx(Mit,{});case Ni.GAME_ENDS:return r.jsx(Dit,{});case Ni.GAME_STARTS:return r.jsx(bit,{});case Ni.SCORE_ACHIEVED:return r.jsx(vit,{});case Ni.TOGGLE_FURNI:return r.jsx(Lit,{})}return null},Uit=a=>{const{trigger:t=null}=Xt();return t?t instanceof NS?Zst(t.code):t instanceof AS?Pit(t.code):t instanceof CS?pit(t.code):null:null},jit=a=>{const[t,e]=_.useState(!1),[s,i]=_.useState(!0);return we(Mt.CREATED,n=>i(!1)),we(Mt.ENDED,n=>i(n.openLandingView)),_.useEffect(()=>{e(!0),n_().connection.onReady()},[]),_.useEffect(()=>{const n={linkReceived:o=>{const l=o.split("/");if(!(l.length<2))switch(l[1]){case"open":if(l.length>2)switch(l[2]){case"credits":break;default:{const c=l[2];Hn.openHabblet(c)}}return}},eventUrlPrefix:"habblet/"};return Os(n),()=>Cs(n)},[]),r.jsxs(H,{fit:!0,children:[r.jsx(M_,{type:$i.FADE_IN,inProp:s,timeout:300,children:r.jsx(uZ,{})}),r.jsx(rst,{isInRoom:!s}),r.jsx(jZ,{}),r.jsx(sst,{}),r.jsx(kJ,{}),r.jsx(BJ,{}),r.jsx(Uit,{}),r.jsx(YQ,{}),r.jsx(jQ,{}),r.jsx(JZ,{}),r.jsx(RZ,{}),r.jsx(GJ,{}),r.jsx(u$,{}),r.jsx(Ott,{}),r.jsx(hst,{}),r.jsx(ust,{}),r.jsx(x$,{}),r.jsx($Q,{}),r.jsx(iZ,{}),r.jsx(ZZ,{}),r.jsx(F$,{}),r.jsx(G$,{}),r.jsx(eJ,{}),r.jsx(g$,{}),r.jsx(JJ,{})]})};rh.UI_VERSION=I0();const wit=a=>{const[t,e]=_.useState(!1),[s,i]=_.useState(!1),[n,o]=_.useState("Getting Ready"),[l,c]=_.useState(0),[u,h]=_.useState(!0);if(_.useState(null),!Jt()){if(!NitroConfig)throw new Error("NitroConfig is not defined!");Et.bootstrap()}const d=_.useCallback(async g=>{switch(g.type){case dn.LOADED:Jt().localization.init(),c(E=>E+20);return;case dn.FAILED:i(!0),o("Configuration Failed");return;case Et.WEBGL_UNAVAILABLE:i(!0),o("WebGL Required");return;case Et.WEBGL_CONTEXT_LOST:i(!0),o("WebGL Context Lost - Reloading"),setTimeout(()=>window.location.reload(),1500);return;case Us.CONNECTION_HANDSHAKING:c(E=>E+20);return;case Us.CONNECTION_HANDSHAKE_FAILED:i(!0),o("Handshake Failed");return;case Us.CONNECTION_AUTHENTICATED:c(E=>E+20),Jt().init(),Zt.available&&Zt.call("legacyTrack","authentication","authok",[]);return;case Us.CONNECTION_ERROR:i(!0),o("Connection Error");return;case Us.CONNECTION_CLOSED:o("Connection Error"),Hn.send(-1,"client.init.handshake.fail");return;case te.ENGINE_INITIALIZED:c(E=>E+20),setTimeout(()=>e(!0),300);return;case $o.LOADED:{const E=it("preload.assets.urls"),m=[];if(E&&E.length)for(const p of E)m.push(Dt.interpolate(p));await Rr().downloadAssets(m)?(n_().init(),c(p=>p+20)):(i(!0),o("Assets Failed"));return}}},[]);return xl(Et.WEBGL_UNAVAILABLE,d),xl(Et.WEBGL_CONTEXT_LOST,d),xl(Us.CONNECTION_HANDSHAKING,d),xl(Us.CONNECTION_HANDSHAKE_FAILED,d),xl(Us.CONNECTION_AUTHENTICATED,d),xl(Us.CONNECTION_ERROR,d),xl(Us.CONNECTION_CLOSED,d),ne(te.ENGINE_INITIALIZED,d),N8($o.LOADED,d),NA(dn.LOADED,d),NA(dn.FAILED,d),we(Mt.STARTED,()=>{if(!(ie()==null||tt()==null)){var g=1,E=document.getElementsByTagName("canvas");for(var m of E)m.addEventListener("wheel",I=>{g>=10&&(g=10),g<=1&&(g=1),I.deltaY<0?tt().events.dispatchEvent(new Ac(ie().roomId,g++,!1)):tt().events.dispatchEvent(new Ac(ie().roomId,g--,!1))})}}),_.useEffect(()=>{Jt().core.configuration.init();const g=E=>h(!(window.devicePixelRatio%1));return window.addEventListener("resize",g),g(),()=>{window.removeEventListener("resize",g)}},[]),r.jsxs(H,{fit:!0,overflow:"hidden",className:u&&"image-rendering-pixelated",children:[(!t||s)&&r.jsx(C8,{isError:s,message:n,percent:l}),r.jsx(M_,{type:$i.FADE_IN,inProp:t,children:r.jsx(jit,{})}),r.jsx(H,{id:"draggable-windows-container"})]})};iw(document.getElementById("root")).render(r.jsx(wit,{}));
